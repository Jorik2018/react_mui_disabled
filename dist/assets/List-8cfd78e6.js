import{s as R,r as d,i as B,l as D,n as M,k as O,j as e,o as _,B as x,C as T,q as w}from"./index-98cf31d0.js";import{T as c,t as S,a as b,d as L,b as U,A as G,c as J,e as K,f as Q,g as V,h as X}from"./Edit-0166362f.js";import{T as Y}from"./TableContainer-77b3fa50.js";import{F as Z,T as p}from"./TextField-4e8958de.js";import"./MenuItem-21f050f2.js";import"./createSvgIcon-0e2d6dd8.js";const h=R(c)(({theme:r})=>({[`&.${S.head}`]:{backgroundColor:r.palette.common.black,textAlign:"center",color:r.palette.common.white},[`&.${S.body}`]:{fontSize:14}})),ee=R(b)(({theme:r})=>({"&:nth-of-type(odd)":{backgroundColor:r.palette.action.hover},"&:last-child td, &:last-child th":{border:0}})),ie=()=>{const r=d.useRef(),m=B(),f=D(),[y,{defaultProps:j}]=M(d.useState,{name:""}),[n,C]=d.useState({page:0,rowsPerPage:50}),[i,N]=d.useState({size:0,data:[]}),[s,g]=d.useState([]),q=t=>s.indexOf(t)!==-1,v=t=>{if(t.target.checked){const l=i.data.map(a=>a.uid);g(l);return}g([])},$=(t,l)=>{const a=s.indexOf(l);let o=[];a===-1?o=o.concat(s,l):a===0?o=o.concat(s.slice(1)):a===s.length-1?o=o.concat(s.slice(0,-1)):a>0&&(o=o.concat(s.slice(0,a),s.slice(a+1))),g(o)},E=(t,l)=>{C({...n,page:l})},I=t=>{C({...n,rowsPerPage:t.target.value})},P=()=>{g([]),k(n.page)},k=async t=>{const l={query:`query{
          users(offset:${t*n.rowsPerPage} limit:${n.rowsPerPage} roleName:"" name:"${y.name||""}" fullName:"${y.fullName||""}") {
            data{
              uid
              name
              directoryId
              people{
                fullName
              }
              status
              mail
            }
            size
          }
        }`};w.gql("/api/admin/graphql",l).then(a=>{a&&a.users&&N(a.users)})};O(({height:t,width:l})=>{document.querySelector(".MuiToolbar-root");const a=document.querySelector(".MuiTableContainer-root"),o=document.querySelector(".MuiTablePagination-root"),u=document.querySelector(".Toolbar-table");a&&(a.style.width=l+"px",a.style.height=t-u.offsetHeight-o.offsetHeight+"px")},r),d.useEffect(()=>{m({type:"title",title:"Usuarios"}),k(n.page)},[n.page,n.rowsPerPage]);const z=()=>{f("/user/create")},F=()=>{f("/user/"+s[0]+"/edit")},H=()=>{m({type:"confirm",msg:"Esta seguro de eliminar el registro seleccionado?",cb:t=>{t&&w.delete("/api/admin/user/"+s.join(",")).then(l=>{m({type:"snack",msg:"Registro"+(s.length>1?"s":"")+" eliminado!"}),P()})}})};function A(t,l){for(t=t.toString();t.length<l;)t="0"+t;return t}const W=i.data&&i.data.length;return e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"Toolbar-table",direction:"row",children:e.jsxs("div",{style:{float:"none",marginLeft:"auto",marginRight:"auto"},children:[e.jsx(x,{disabled:!s.length,startIcon:e.jsx(L,{}),onClick:F,children:"Editar"}),e.jsx(x,{disabled:!s.length,startIcon:e.jsx(U,{}),onClick:H,children:"Eliminar"}),e.jsx(x,{onClick:P,endIcon:e.jsx(G,{})})]})}),e.jsxs(Y,{sx:{maxHeight:"100%"},ref:r,children:[e.jsx(Z,{color:"primary","aria-label":"add",onClick:z,style:{position:"absolute",bottom:72,right:24},children:e.jsx(J,{})}),e.jsxs(K,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(Q,{children:e.jsxs(b,{children:[e.jsx(h,{padding:"checkbox",children:e.jsx(T,{style:{color:"white"},indeterminate:s.length>0&&s.length<i.data.length,checked:i&&i.data.length>0&&s.length===i.data.length,onChange:v,inputProps:{"aria-label":"select all desserts"}})}),e.jsxs(h,{style:{minWidth:20},children:["#",e.jsx(p,{style:{padding:0,marginTop:"5px !important"}})]}),e.jsxs(h,{style:{minWidth:90},children:["Nombre",e.jsx(p,{...j("name"),style:{padding:0,marginTop:"5px !important"}})]}),e.jsxs(h,{style:{minWidth:260},children:["Nombre Completo",e.jsx(p,{...j("fullName"),style:{padding:0,marginTop:"5px !important"}})]}),e.jsxs(h,{style:{minWidth:260},children:["Correo",e.jsx(p,{style:{padding:0,marginTop:"5px !important"}})]})]})}),e.jsxs(V,{children:[(i&&i.data&&i.data.length?i.data:[]).map((t,l)=>{var o;const a=q(t.uid);return e.jsxs(ee,{hover:!0,onClick:u=>$(u,t.uid),role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,children:[e.jsx(c,{padding:"checkbox",children:e.jsx(T,{color:"primary",checked:a})}),e.jsx(c,{style:{width:20},align:"center",children:A(1+l+n.page*n.rowsPerPage,4)}),e.jsx(c,{style:{width:90},align:"center",children:t.name}),e.jsx(c,{style:{width:260},children:(o=t.people)==null?void 0:o.fullName}),e.jsx(c,{style:{width:260},children:t.mail})]},l+" "+t.uid)}),!W&&e.jsx(b,{style:{height:53},children:e.jsx(c,{colSpan:5,children:"No data"})})]})]})]}),e.jsx(X,{rowsPerPageOptions:[10,20,50],component:"div",count:i.size,rowsPerPage:n.rowsPerPage,page:n.page,onPageChange:E,onRowsPerPageChange:I})]})};export{ie as default};
