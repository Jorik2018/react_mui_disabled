import{r as z0,e as Ao,h as F0}from"./index-98cf31d0.js";var Sh={},O0={get exports(){return Sh},set exports(no){Sh=no}},B0="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",N0=B0,U0=N0;function Nv(){}function Uv(){}Uv.resetWarningCache=Nv;var H0=function(){function no(ee,te,A,g,S,M){if(M!==U0){var e=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw e.name="Invariant Violation",e}}no.isRequired=no;function rl(){return no}var y={array:no,bigint:no,bool:no,func:no,number:no,object:no,string:no,symbol:no,any:no,arrayOf:rl,element:no,elementType:no,instanceOf:rl,node:no,objectOf:rl,oneOf:rl,oneOfType:rl,shape:rl,exact:rl,checkPropTypes:Uv,resetWarningCache:Nv};return y.PropTypes=y,y};O0.exports=H0();function jc(no){throw new Error('Could not dynamically require "'+no+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Hv={},Vv={};(function(no){function rl(d){return rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},rl(d)}Object.defineProperty(no,"__esModule",{value:!0}),no.default=f;var y=g(z0),ee=te(Sh);function te(d){return d&&d.__esModule?d:{default:d}}function A(d){if(typeof WeakMap!="function")return null;var o=new WeakMap,m=new WeakMap;return(A=function(w){return w?m:o})(d)}function g(d,o){if(!o&&d&&d.__esModule)return d;if(d===null||rl(d)!=="object"&&typeof d!="function")return{default:d};var m=A(o);if(m&&m.has(d))return m.get(d);var l={},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in d)if(_!=="default"&&Object.prototype.hasOwnProperty.call(d,_)){var c=w?Object.getOwnPropertyDescriptor(d,_):null;c&&(c.get||c.set)?Object.defineProperty(l,_,c):l[_]=d[_]}return l.default=d,m&&m.set(d,l),l}function S(d,o){if(!(d instanceof o))throw new TypeError("Cannot call a class as a function")}function M(d,o){for(var m=0;m<o.length;m++){var l=o[m];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(d,l.key,l)}}function e(d,o,m){return o&&M(d.prototype,o),m&&M(d,m),Object.defineProperty(d,"prototype",{writable:!1}),d}function a(d,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(o&&o.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),Object.defineProperty(d,"prototype",{writable:!1}),o&&n(d,o)}function n(d,o){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,w){return l.__proto__=w,l},n(d,o)}function r(d){var o=s();return function(){var l=i(d),w;if(o){var _=i(this).constructor;w=Reflect.construct(l,arguments,_)}else w=l.apply(this,arguments);return t(this,w)}}function t(d,o){if(o&&(rl(o)==="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(d)}function h(d){if(d===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d}function s(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i(d){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(m){return m.__proto__||Object.getPrototypeOf(m)},i(d)}var x=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","BeforeHover","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Relayouting","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","SunburstClick","Transitioning","TransitionInterrupted","Unhover","WebGlContextLost"],p=["plotly_restyle","plotly_redraw","plotly_relayout","plotly_relayouting","plotly_doubleclick","plotly_animated","plotly_sunburstclick"],v=typeof window<"u";function f(d){var o=function(m){a(w,m);var l=r(w);function w(_){var c;return S(this,w),c=l.call(this,_),c.p=Promise.resolve(),c.resizeHandler=null,c.handlers={},c.syncWindowResize=c.syncWindowResize.bind(h(c)),c.syncEventHandlers=c.syncEventHandlers.bind(h(c)),c.attachUpdateEvents=c.attachUpdateEvents.bind(h(c)),c.getRef=c.getRef.bind(h(c)),c.handleUpdate=c.handleUpdate.bind(h(c)),c.figureCallback=c.figureCallback.bind(h(c)),c.updatePlotly=c.updatePlotly.bind(h(c)),c}return e(w,[{key:"updatePlotly",value:function(c,b,u){var L=this;this.p=this.p.then(function(){if(!L.unmounting){if(!L.el)throw new Error("Missing element reference");return d.react(L.el,{data:L.props.data,layout:L.props.layout,config:L.props.config,frames:L.props.frames})}}).then(function(){L.unmounting||(L.syncWindowResize(c),L.syncEventHandlers(),L.figureCallback(b),u&&L.attachUpdateEvents())}).catch(function(T){L.props.onError&&L.props.onError(T)})}},{key:"componentDidMount",value:function(){this.unmounting=!1,this.updatePlotly(!0,this.props.onInitialized,!0)}},{key:"componentDidUpdate",value:function(c){this.unmounting=!1;var b=c.frames&&c.frames.length?c.frames.length:0,u=this.props.frames&&this.props.frames.length?this.props.frames.length:0,L=!(c.layout===this.props.layout&&c.data===this.props.data&&c.config===this.props.config&&u===b),T=c.revision!==void 0,k=c.revision!==this.props.revision;!L&&(!T||T&&!k)||this.updatePlotly(!1,this.props.onUpdate,!1)}},{key:"componentWillUnmount",value:function(){this.unmounting=!0,this.figureCallback(this.props.onPurge),this.resizeHandler&&v&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.removeUpdateEvents(),d.purge(this.el)}},{key:"attachUpdateEvents",value:function(){var c=this;!this.el||!this.el.removeListener||p.forEach(function(b){c.el.on(b,c.handleUpdate)})}},{key:"removeUpdateEvents",value:function(){var c=this;!this.el||!this.el.removeListener||p.forEach(function(b){c.el.removeListener(b,c.handleUpdate)})}},{key:"handleUpdate",value:function(){this.figureCallback(this.props.onUpdate)}},{key:"figureCallback",value:function(c){if(typeof c=="function"){var b=this.el,u=b.data,L=b.layout,T=this.el._transitionData?this.el._transitionData._frames:null,k={data:u,layout:L,frames:T};c(k,this.el)}}},{key:"syncWindowResize",value:function(c){var b=this;v&&(this.props.useResizeHandler&&!this.resizeHandler?(this.resizeHandler=function(){return d.Plots.resize(b.el)},window.addEventListener("resize",this.resizeHandler),c&&this.resizeHandler()):!this.props.useResizeHandler&&this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null))}},{key:"getRef",value:function(c){this.el=c,this.props.debug&&v&&(window.gd=this.el)}},{key:"syncEventHandlers",value:function(){var c=this;x.forEach(function(b){var u=c.props["on"+b],L=c.handlers[b],T=!!L;u&&!T?c.addEventHandler(b,u):!u&&T?c.removeEventHandler(b):u&&T&&u!==L&&(c.removeEventHandler(b),c.addEventHandler(b,u))})}},{key:"addEventHandler",value:function(c,b){this.handlers[c]=b,this.el.on(this.getPlotlyEventName(c),this.handlers[c])}},{key:"removeEventHandler",value:function(c){this.el.removeListener(this.getPlotlyEventName(c),this.handlers[c]),delete this.handlers[c]}},{key:"getPlotlyEventName",value:function(c){return"plotly_"+c.toLowerCase()}},{key:"render",value:function(){return y.default.createElement("div",{id:this.props.divId,style:this.props.style,ref:this.getRef,className:this.props.className})}}]),w}(y.Component);return o.propTypes={data:ee.default.arrayOf(ee.default.object),config:ee.default.object,layout:ee.default.object,frames:ee.default.arrayOf(ee.default.object),revision:ee.default.number,onInitialized:ee.default.func,onPurge:ee.default.func,onError:ee.default.func,onUpdate:ee.default.func,debug:ee.default.bool,style:ee.default.object,className:ee.default.string,useResizeHandler:ee.default.bool,divId:ee.default.string},x.forEach(function(m){o.propTypes["on"+m]=ee.default.func}),o.defaultProps={debug:!1,useResizeHandler:!1,data:[],style:{position:"relative",display:"inline-block"}},o}})(Vv);var kh={},V0={get exports(){return kh},set exports(no){kh=no}};(function(no,rl){(function(y){no.exports=y()})(function(){return function(){function y(ee,te,A){function g(e,a){if(!te[e]){if(!ee[e]){var n=typeof jc=="function"&&jc;if(!a&&n)return n(e,!0);if(S)return S(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var t=te[e]={exports:{}};ee[e][0].call(t.exports,function(h){var s=ee[e][1][h];return g(s||h)},t,t.exports,y,ee,te,A)}return te[e].exports}for(var S=typeof jc=="function"&&jc,M=0;M<A.length;M++)g(A[M]);return g}return y}()({1:[function(y,ee,te){var A=y("../src/lib"),g={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var S in g){var M=S.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");A.addStyleRule(M,g[S])}},{"../src/lib":515}],2:[function(y,ee,te){ee.exports=y("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(y,ee,te){ee.exports=y("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(y,ee,te){ee.exports=y("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(y,ee,te){ee.exports=y("../src/traces/box")},{"../src/traces/box":688}],6:[function(y,ee,te){ee.exports=y("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(y,ee,te){ee.exports=y("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(y,ee,te){ee.exports=y("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(y,ee,te){ee.exports=y("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(y,ee,te){ee.exports=y("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(y,ee,te){ee.exports=y("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(y,ee,te){ee.exports=y("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(y,ee,te){ee.exports=y("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(y,ee,te){ee.exports=y("../src/core")},{"../src/core":493}],15:[function(y,ee,te){ee.exports=y("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(y,ee,te){ee.exports=y("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(y,ee,te){ee.exports=y("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(y,ee,te){ee.exports=y("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(y,ee,te){ee.exports=y("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(y,ee,te){ee.exports=y("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(y,ee,te){ee.exports=y("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(y,ee,te){ee.exports=y("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(y,ee,te){ee.exports=y("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(y,ee,te){ee.exports=y("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(y,ee,te){ee.exports=y("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(y,ee,te){ee.exports=y("../src/traces/image")},{"../src/traces/image":861}],27:[function(y,ee,te){var A=y("./core");A.register([y("./bar"),y("./box"),y("./heatmap"),y("./histogram"),y("./histogram2d"),y("./histogram2dcontour"),y("./contour"),y("./scatterternary"),y("./violin"),y("./funnel"),y("./waterfall"),y("./image"),y("./pie"),y("./sunburst"),y("./treemap"),y("./icicle"),y("./funnelarea"),y("./scatter3d"),y("./surface"),y("./isosurface"),y("./volume"),y("./mesh3d"),y("./cone"),y("./streamtube"),y("./scattergeo"),y("./choropleth"),y("./scattergl"),y("./splom"),y("./pointcloud"),y("./heatmapgl"),y("./parcoords"),y("./parcats"),y("./scattermapbox"),y("./choroplethmapbox"),y("./densitymapbox"),y("./sankey"),y("./indicator"),y("./table"),y("./carpet"),y("./scattercarpet"),y("./contourcarpet"),y("./ohlc"),y("./candlestick"),y("./scatterpolar"),y("./scatterpolargl"),y("./barpolar"),y("./scattersmith"),y("./aggregate"),y("./filter"),y("./groupby"),y("./sort"),y("./calendars")]),ee.exports=A},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(y,ee,te){ee.exports=y("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(y,ee,te){ee.exports=y("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(y,ee,te){ee.exports=y("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(y,ee,te){ee.exports=y("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(y,ee,te){ee.exports=y("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(y,ee,te){ee.exports=y("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(y,ee,te){ee.exports=y("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(y,ee,te){ee.exports=y("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(y,ee,te){ee.exports=y("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(y,ee,te){ee.exports=y("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(y,ee,te){ee.exports=y("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(y,ee,te){ee.exports=y("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(y,ee,te){ee.exports=y("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(y,ee,te){ee.exports=y("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(y,ee,te){ee.exports=y("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(y,ee,te){ee.exports=y("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(y,ee,te){ee.exports=y("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(y,ee,te){ee.exports=y("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(y,ee,te){ee.exports=y("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(y,ee,te){ee.exports=y("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(y,ee,te){ee.exports=y("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(y,ee,te){ee.exports=y("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(y,ee,te){ee.exports=y("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(y,ee,te){ee.exports=y("../src/traces/table")},{"../src/traces/table":1082}],52:[function(y,ee,te){ee.exports=y("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(y,ee,te){ee.exports=y("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(y,ee,te){ee.exports=y("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(y,ee,te){ee.exports=y("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,y("d3-array"),y("d3-collection"),y("d3-shape"),y("elementary-circuits-directed-graph")):g(A.d3=A.d3||{},A.d3,A.d3,A.d3,null)})(this,function(A,g,S,M,e){e=e&&e.hasOwnProperty("default")?e.default:e;function a(ce){return ce.target.depth}function n(ce){return ce.depth}function r(ce,de){return de-1-ce.height}function t(ce,de){return ce.sourceLinks.length?ce.depth:de-1}function h(ce){return ce.targetLinks.length?ce.depth:ce.sourceLinks.length?g.min(ce.sourceLinks,a)-1:0}function s(ce){return function(){return ce}}var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ce){return typeof ce}:function(ce){return ce&&typeof Symbol=="function"&&ce.constructor===Symbol&&ce!==Symbol.prototype?"symbol":typeof ce};function x(ce,de){return v(ce.source,de.source)||ce.index-de.index}function p(ce,de){return v(ce.target,de.target)||ce.index-de.index}function v(ce,de){return ce.partOfCycle===de.partOfCycle?ce.y0-de.y0:ce.circularLinkType==="top"||de.circularLinkType==="bottom"?-1:1}function f(ce){return ce.value}function d(ce){return(ce.y0+ce.y1)/2}function o(ce){return d(ce.source)}function m(ce){return d(ce.target)}function l(ce){return ce.index}function w(ce){return ce.nodes}function _(ce){return ce.links}function c(ce,de){var ye=ce.get(de);if(!ye)throw new Error("missing: "+de);return ye}function b(ce,de){return de(ce)}var u=25,L=10,T=.3;function k(){var ce=0,de=0,ye=1,ge=1,me=24,Ee,Pe=l,Ue=t,we=w,ke=_,Xe=32,Ve=2,Ie,De=null;function Ye(){var At={nodes:we.apply(null,arguments),links:ke.apply(null,arguments)};vt(At),P(At,Pe,De),Dt(At),Mt(At),z(At,Pe),Xt(At,Xe,Pe),It(At);for(var Ge=4,tt=0;tt<Ge;tt++)Q(At,ge,Pe),ie(At,ge,Pe),$(At,de,ge,Pe),Q(At,ge,Pe),ie(At,ge,Pe);return be(At,de,ge),N(At,Ve,ge,Pe),At}Ye.nodeId=function(At){return arguments.length?(Pe=typeof At=="function"?At:s(At),Ye):Pe},Ye.nodeAlign=function(At){return arguments.length?(Ue=typeof At=="function"?At:s(At),Ye):Ue},Ye.nodeWidth=function(At){return arguments.length?(me=+At,Ye):me},Ye.nodePadding=function(At){return arguments.length?(Ee=+At,Ye):Ee},Ye.nodes=function(At){return arguments.length?(we=typeof At=="function"?At:s(At),Ye):we},Ye.links=function(At){return arguments.length?(ke=typeof At=="function"?At:s(At),Ye):ke},Ye.size=function(At){return arguments.length?(ce=de=0,ye=+At[0],ge=+At[1],Ye):[ye-ce,ge-de]},Ye.extent=function(At){return arguments.length?(ce=+At[0][0],ye=+At[1][0],de=+At[0][1],ge=+At[1][1],Ye):[[ce,de],[ye,ge]]},Ye.iterations=function(At){return arguments.length?(Xe=+At,Ye):Xe},Ye.circularLinkGap=function(At){return arguments.length?(Ve=+At,Ye):Ve},Ye.nodePaddingRatio=function(At){return arguments.length?(Ie=+At,Ye):Ie},Ye.sortNodes=function(At){return arguments.length?(De=At,Ye):De},Ye.update=function(At){return z(At,Pe),It(At),At.links.forEach(function(Ge){Ge.circular&&(Ge.circularLinkType=Ge.y0+Ge.y1<ge?"top":"bottom",Ge.source.circularLinkType=Ge.circularLinkType,Ge.target.circularLinkType=Ge.circularLinkType)}),Q(At,ge,Pe,!1),ie(At,ge,Pe),N(At,Ve,ge,Pe),At};function vt(At){At.nodes.forEach(function(tt,He){tt.index=He,tt.sourceLinks=[],tt.targetLinks=[]});var Ge=S.map(At.nodes,Pe);return At.links.forEach(function(tt,He){tt.index=He;var Ae=tt.source,Ne=tt.target;(typeof Ae>"u"?"undefined":i(Ae))!=="object"&&(Ae=tt.source=c(Ge,Ae)),(typeof Ne>"u"?"undefined":i(Ne))!=="object"&&(Ne=tt.target=c(Ge,Ne)),Ae.sourceLinks.push(tt),Ne.targetLinks.push(tt)}),At}function Dt(At){At.nodes.forEach(function(Ge){Ge.partOfCycle=!1,Ge.value=Math.max(g.sum(Ge.sourceLinks,f),g.sum(Ge.targetLinks,f)),Ge.sourceLinks.forEach(function(tt){tt.circular&&(Ge.partOfCycle=!0,Ge.circularLinkType=tt.circularLinkType)}),Ge.targetLinks.forEach(function(tt){tt.circular&&(Ge.partOfCycle=!0,Ge.circularLinkType=tt.circularLinkType)})})}function Kt(At){var Ge=0,tt=0,He=0,Ae=0,Ne=g.max(At.nodes,function(Ze){return Ze.column});return At.links.forEach(function(Ze){Ze.circular&&(Ze.circularLinkType=="top"?Ge=Ge+Ze.width:tt=tt+Ze.width,Ze.target.column==0&&(Ae=Ae+Ze.width),Ze.source.column==Ne&&(He=He+Ze.width))}),Ge=Ge>0?Ge+u+L:Ge,tt=tt>0?tt+u+L:tt,He=He>0?He+u+L:He,Ae=Ae>0?Ae+u+L:Ae,{top:Ge,bottom:tt,left:Ae,right:He}}function Ft(At,Ge){var tt=g.max(At.nodes,function(dt){return dt.column}),He=ye-ce,Ae=ge-de,Ne=He+Ge.right+Ge.left,Ze=Ae+Ge.top+Ge.bottom,Qe=He/Ne,bt=Ae/Ze;return ce=ce*Qe+Ge.left,ye=Ge.right==0?ye:ye*Qe,de=de*bt+Ge.top,ge=ge*bt,At.nodes.forEach(function(dt){dt.x0=ce+dt.column*((ye-ce-me)/tt),dt.x1=dt.x0+me}),bt}function Mt(At){var Ge,tt,He;for(Ge=At.nodes,tt=[],He=0;Ge.length;++He,Ge=tt,tt=[])Ge.forEach(function(Ae){Ae.depth=He,Ae.sourceLinks.forEach(function(Ne){tt.indexOf(Ne.target)<0&&!Ne.circular&&tt.push(Ne.target)})});for(Ge=At.nodes,tt=[],He=0;Ge.length;++He,Ge=tt,tt=[])Ge.forEach(function(Ae){Ae.height=He,Ae.targetLinks.forEach(function(Ne){tt.indexOf(Ne.source)<0&&!Ne.circular&&tt.push(Ne.source)})});At.nodes.forEach(function(Ae){Ae.column=Math.floor(Ue.call(null,Ae,He))})}function Xt(At,Ge,tt){var He=S.nest().key(function(dt){return dt.column}).sortKeys(g.ascending).entries(At.nodes).map(function(dt){return dt.values});Ze(tt),bt();for(var Ae=1,Ne=Ge;Ne>0;--Ne)Qe(Ae*=.99,tt),bt();function Ze(dt){if(Ie){var wt=1/0;He.forEach(function(Wt){var Vt=ge*Ie/(Wt.length+1);wt=Vt<wt?Vt:wt}),Ee=wt}var Ut=g.min(He,function(Wt){return(ge-de-(Wt.length-1)*Ee)/g.sum(Wt,f)});Ut=Ut*T,At.links.forEach(function(Wt){Wt.width=Wt.value*Ut});var Rt=Kt(At),Nt=Ft(At,Rt);Ut=Ut*Nt,At.links.forEach(function(Wt){Wt.width=Wt.value*Ut}),He.forEach(function(Wt){var Vt=Wt.length;Wt.forEach(function(ir,Hr){ir.depth==He.length-1&&Vt==1||ir.depth==0&&Vt==1?(ir.y0=ge/2-ir.value*Ut,ir.y1=ir.y0+ir.value*Ut):ir.partOfCycle?R(ir,dt)==0?(ir.y0=ge/2+Hr,ir.y1=ir.y0+ir.value*Ut):ir.circularLinkType=="top"?(ir.y0=de+Hr,ir.y1=ir.y0+ir.value*Ut):(ir.y0=ge-ir.value*Ut-Hr,ir.y1=ir.y0+ir.value*Ut):Rt.top==0||Rt.bottom==0?(ir.y0=(ge-de)/Vt*Hr,ir.y1=ir.y0+ir.value*Ut):(ir.y0=(ge-de)/2-Vt/2+Hr,ir.y1=ir.y0+ir.value*Ut)})})}function Qe(dt,wt){var Ut=He.length;He.forEach(function(Rt){var Nt=Rt.length,Wt=Rt[0].depth;Rt.forEach(function(Vt){var ir;if((Vt.sourceLinks.length||Vt.targetLinks.length)&&!(Vt.partOfCycle&&R(Vt,wt)>0))if(Wt==0&&Nt==1)ir=Vt.y1-Vt.y0,Vt.y0=ge/2-ir/2,Vt.y1=ge/2+ir/2;else if(Wt==Ut-1&&Nt==1)ir=Vt.y1-Vt.y0,Vt.y0=ge/2-ir/2,Vt.y1=ge/2+ir/2;else{var Hr=0,sn=g.mean(Vt.sourceLinks,m),jr=g.mean(Vt.targetLinks,o);sn&&jr?Hr=(sn+jr)/2:Hr=sn||jr;var at=(Hr-d(Vt))*dt;Vt.y0+=at,Vt.y1+=at}})})}function bt(){He.forEach(function(dt){var wt,Ut,Rt=de,Nt=dt.length,Wt;for(dt.sort(v),Wt=0;Wt<Nt;++Wt)wt=dt[Wt],Ut=Rt-wt.y0,Ut>0&&(wt.y0+=Ut,wt.y1+=Ut),Rt=wt.y1+Ee;if(Ut=Rt-Ee-ge,Ut>0)for(Rt=wt.y0-=Ut,wt.y1-=Ut,Wt=Nt-2;Wt>=0;--Wt)wt=dt[Wt],Ut=wt.y1+Ee-Rt,Ut>0&&(wt.y0-=Ut,wt.y1-=Ut),Rt=wt.y0})}}function It(At){At.nodes.forEach(function(Ge){Ge.sourceLinks.sort(p),Ge.targetLinks.sort(x)}),At.nodes.forEach(function(Ge){var tt=Ge.y0,He=tt,Ae=Ge.y1,Ne=Ae;Ge.sourceLinks.forEach(function(Ze){Ze.circular?(Ze.y0=Ae-Ze.width/2,Ae=Ae-Ze.width):(Ze.y0=tt+Ze.width/2,tt+=Ze.width)}),Ge.targetLinks.forEach(function(Ze){Ze.circular?(Ze.y1=Ne-Ze.width/2,Ne=Ne-Ze.width):(Ze.y1=He+Ze.width/2,He+=Ze.width)})})}return Ye}function P(ce,de,ye){var ge=0;if(ye===null){for(var me=[],Ee=0;Ee<ce.links.length;Ee++){var Pe=ce.links[Ee],Ue=Pe.source.index,we=Pe.target.index;me[Ue]||(me[Ue]=[]),me[we]||(me[we]=[]),me[Ue].indexOf(we)===-1&&me[Ue].push(we)}var ke=e(me);ke.sort(function(De,Ye){return De.length-Ye.length});var Xe={};for(Ee=0;Ee<ke.length;Ee++){var Ve=ke[Ee],Ie=Ve.slice(-2);Xe[Ie[0]]||(Xe[Ie[0]]={}),Xe[Ie[0]][Ie[1]]=!0}ce.links.forEach(function(De){var Ye=De.target.index,vt=De.source.index;Ye===vt||Xe[vt]&&Xe[vt][Ye]?(De.circular=!0,De.circularLinkID=ge,ge=ge+1):De.circular=!1})}else ce.links.forEach(function(De){De.source[ye]<De.target[ye]?De.circular=!1:(De.circular=!0,De.circularLinkID=ge,ge=ge+1)})}function z(ce,de){var ye=0,ge=0;ce.links.forEach(function(me){me.circular&&(me.source.circularLinkType||me.target.circularLinkType?me.circularLinkType=me.source.circularLinkType?me.source.circularLinkType:me.target.circularLinkType:me.circularLinkType=ye<ge?"top":"bottom",me.circularLinkType=="top"?ye=ye+1:ge=ge+1,ce.nodes.forEach(function(Ee){(b(Ee,de)==b(me.source,de)||b(Ee,de)==b(me.target,de))&&(Ee.circularLinkType=me.circularLinkType)}))}),ce.links.forEach(function(me){me.circular&&(me.source.circularLinkType==me.target.circularLinkType&&(me.circularLinkType=me.source.circularLinkType),oe(me,de)&&(me.circularLinkType=me.source.circularLinkType))})}function I(ce){var de=Math.abs(ce.y1-ce.y0),ye=Math.abs(ce.target.x0-ce.source.x1);return Math.atan(ye/de)}function D(ce,de){return ce.source.column<de.target.column?!1:!(ce.target.column>de.source.column)}function R(ce,de){var ye=0;ce.sourceLinks.forEach(function(me){ye=me.circular&&!oe(me,de)?ye+1:ye});var ge=0;return ce.targetLinks.forEach(function(me){ge=me.circular&&!oe(me,de)?ge+1:ge}),ye+ge}function O(ce){var de=ce.source.sourceLinks,ye=0;de.forEach(function(Ee){ye=Ee.circular?ye+1:ye});var ge=ce.target.targetLinks,me=0;return ge.forEach(function(Ee){me=Ee.circular?me+1:me}),!(ye>1||me>1)}function F(ce,de,ye){return ce.sort(K),ce.forEach(function(ge,me){var Ee=0;if(oe(ge,ye)&&O(ge))ge.circularPathData.verticalBuffer=Ee+ge.width/2;else{var Pe=0;for(Pe;Pe<me;Pe++)if(D(ce[me],ce[Pe])){var Ue=ce[Pe].circularPathData.verticalBuffer+ce[Pe].width/2+de;Ee=Ue>Ee?Ue:Ee}ge.circularPathData.verticalBuffer=Ee+ge.width/2}}),ce}function N(ce,de,ye,ge){var me=5,Ee=g.min(ce.links,function(we){return we.source.y0});ce.links.forEach(function(we){we.circular&&(we.circularPathData={})});var Pe=ce.links.filter(function(we){return we.circularLinkType=="top"});F(Pe,de,ge);var Ue=ce.links.filter(function(we){return we.circularLinkType=="bottom"});F(Ue,de,ge),ce.links.forEach(function(we){if(we.circular){if(we.circularPathData.arcRadius=we.width+L,we.circularPathData.leftNodeBuffer=me,we.circularPathData.rightNodeBuffer=me,we.circularPathData.sourceWidth=we.source.x1-we.source.x0,we.circularPathData.sourceX=we.source.x0+we.circularPathData.sourceWidth,we.circularPathData.targetX=we.target.x0,we.circularPathData.sourceY=we.y0,we.circularPathData.targetY=we.y1,oe(we,ge)&&O(we))we.circularPathData.leftSmallArcRadius=L+we.width/2,we.circularPathData.leftLargeArcRadius=L+we.width/2,we.circularPathData.rightSmallArcRadius=L+we.width/2,we.circularPathData.rightLargeArcRadius=L+we.width/2,we.circularLinkType=="bottom"?(we.circularPathData.verticalFullExtent=we.source.y1+u+we.circularPathData.verticalBuffer,we.circularPathData.verticalLeftInnerExtent=we.circularPathData.verticalFullExtent-we.circularPathData.leftLargeArcRadius,we.circularPathData.verticalRightInnerExtent=we.circularPathData.verticalFullExtent-we.circularPathData.rightLargeArcRadius):(we.circularPathData.verticalFullExtent=we.source.y0-u-we.circularPathData.verticalBuffer,we.circularPathData.verticalLeftInnerExtent=we.circularPathData.verticalFullExtent+we.circularPathData.leftLargeArcRadius,we.circularPathData.verticalRightInnerExtent=we.circularPathData.verticalFullExtent+we.circularPathData.rightLargeArcRadius);else{var ke=we.source.column,Xe=we.circularLinkType,Ve=ce.links.filter(function(Ye){return Ye.source.column==ke&&Ye.circularLinkType==Xe});we.circularLinkType=="bottom"?Ve.sort(Y):Ve.sort(W);var Ie=0;Ve.forEach(function(Ye,vt){Ye.circularLinkID==we.circularLinkID&&(we.circularPathData.leftSmallArcRadius=L+we.width/2+Ie,we.circularPathData.leftLargeArcRadius=L+we.width/2+vt*de+Ie),Ie=Ie+Ye.width}),ke=we.target.column,Ve=ce.links.filter(function(Ye){return Ye.target.column==ke&&Ye.circularLinkType==Xe}),we.circularLinkType=="bottom"?Ve.sort(ue):Ve.sort(re),Ie=0,Ve.forEach(function(Ye,vt){Ye.circularLinkID==we.circularLinkID&&(we.circularPathData.rightSmallArcRadius=L+we.width/2+Ie,we.circularPathData.rightLargeArcRadius=L+we.width/2+vt*de+Ie),Ie=Ie+Ye.width}),we.circularLinkType=="bottom"?(we.circularPathData.verticalFullExtent=Math.max(ye,we.source.y1,we.target.y1)+u+we.circularPathData.verticalBuffer,we.circularPathData.verticalLeftInnerExtent=we.circularPathData.verticalFullExtent-we.circularPathData.leftLargeArcRadius,we.circularPathData.verticalRightInnerExtent=we.circularPathData.verticalFullExtent-we.circularPathData.rightLargeArcRadius):(we.circularPathData.verticalFullExtent=Ee-u-we.circularPathData.verticalBuffer,we.circularPathData.verticalLeftInnerExtent=we.circularPathData.verticalFullExtent+we.circularPathData.leftLargeArcRadius,we.circularPathData.verticalRightInnerExtent=we.circularPathData.verticalFullExtent+we.circularPathData.rightLargeArcRadius)}we.circularPathData.leftInnerExtent=we.circularPathData.sourceX+we.circularPathData.leftNodeBuffer,we.circularPathData.rightInnerExtent=we.circularPathData.targetX-we.circularPathData.rightNodeBuffer,we.circularPathData.leftFullExtent=we.circularPathData.sourceX+we.circularPathData.leftLargeArcRadius+we.circularPathData.leftNodeBuffer,we.circularPathData.rightFullExtent=we.circularPathData.targetX-we.circularPathData.rightLargeArcRadius-we.circularPathData.rightNodeBuffer}if(we.circular)we.path=G(we);else{var De=M.linkHorizontal().source(function(Ye){var vt=Ye.source.x0+(Ye.source.x1-Ye.source.x0),Dt=Ye.y0;return[vt,Dt]}).target(function(Ye){var vt=Ye.target.x0,Dt=Ye.y1;return[vt,Dt]});we.path=De(we)}})}function G(ce){var de="";return ce.circularLinkType=="top"?de="M"+ce.circularPathData.sourceX+" "+ce.circularPathData.sourceY+" L"+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.sourceY+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftSmallArcRadius+" 0 0 0 "+ce.circularPathData.leftFullExtent+" "+(ce.circularPathData.sourceY-ce.circularPathData.leftSmallArcRadius)+" L"+ce.circularPathData.leftFullExtent+" "+ce.circularPathData.verticalLeftInnerExtent+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftLargeArcRadius+" 0 0 0 "+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.verticalFullExtent+" L"+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.verticalFullExtent+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightLargeArcRadius+" 0 0 0 "+ce.circularPathData.rightFullExtent+" "+ce.circularPathData.verticalRightInnerExtent+" L"+ce.circularPathData.rightFullExtent+" "+(ce.circularPathData.targetY-ce.circularPathData.rightSmallArcRadius)+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightSmallArcRadius+" 0 0 0 "+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.targetY+" L"+ce.circularPathData.targetX+" "+ce.circularPathData.targetY:de="M"+ce.circularPathData.sourceX+" "+ce.circularPathData.sourceY+" L"+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.sourceY+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftSmallArcRadius+" 0 0 1 "+ce.circularPathData.leftFullExtent+" "+(ce.circularPathData.sourceY+ce.circularPathData.leftSmallArcRadius)+" L"+ce.circularPathData.leftFullExtent+" "+ce.circularPathData.verticalLeftInnerExtent+" A"+ce.circularPathData.leftLargeArcRadius+" "+ce.circularPathData.leftLargeArcRadius+" 0 0 1 "+ce.circularPathData.leftInnerExtent+" "+ce.circularPathData.verticalFullExtent+" L"+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.verticalFullExtent+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightLargeArcRadius+" 0 0 1 "+ce.circularPathData.rightFullExtent+" "+ce.circularPathData.verticalRightInnerExtent+" L"+ce.circularPathData.rightFullExtent+" "+(ce.circularPathData.targetY+ce.circularPathData.rightSmallArcRadius)+" A"+ce.circularPathData.rightLargeArcRadius+" "+ce.circularPathData.rightSmallArcRadius+" 0 0 1 "+ce.circularPathData.rightInnerExtent+" "+ce.circularPathData.targetY+" L"+ce.circularPathData.targetX+" "+ce.circularPathData.targetY,de}function K(ce,de){return j(ce)==j(de)?ce.circularLinkType=="bottom"?Y(ce,de):W(ce,de):j(de)-j(ce)}function W(ce,de){return ce.y0-de.y0}function Y(ce,de){return de.y0-ce.y0}function re(ce,de){return ce.y1-de.y1}function ue(ce,de){return de.y1-ce.y1}function j(ce){return ce.target.column-ce.source.column}function q(ce){return ce.target.x0-ce.source.x1}function H(ce,de){var ye=I(ce),ge=q(de)/Math.tan(ye),me=ae(ce)=="up"?ce.y1+ge:ce.y1-ge;return me}function U(ce,de){var ye=I(ce),ge=q(de)/Math.tan(ye),me=ae(ce)=="up"?ce.y1-ge:ce.y1+ge;return me}function $(ce,de,ye,ge){ce.links.forEach(function(me){if(!me.circular&&me.target.column-me.source.column>1){var Ee=me.source.column+1,Pe=me.target.column-1,Ue=1,we=Pe-Ee+1;for(Ue=1;Ee<=Pe;Ee++,Ue++)ce.nodes.forEach(function(ke){if(ke.column==Ee){var Xe=Ue/(we+1),Ve=Math.pow(1-Xe,3),Ie=3*Xe*Math.pow(1-Xe,2),De=3*Math.pow(Xe,2)*(1-Xe),Ye=Math.pow(Xe,3),vt=Ve*me.y0+Ie*me.y0+De*me.y1+Ye*me.y1,Dt=vt-me.width/2,Kt=vt+me.width/2,Ft;Dt>ke.y0&&Dt<ke.y1?(Ft=ke.y1-Dt+10,Ft=ke.circularLinkType=="bottom"?Ft:-Ft,ke=X(ke,Ft,de,ye),ce.nodes.forEach(function(Mt){b(Mt,ge)==b(ke,ge)||Mt.column!=ke.column||ne(ke,Mt)&&X(Mt,Ft,de,ye)})):Kt>ke.y0&&Kt<ke.y1?(Ft=Kt-ke.y0+10,ke=X(ke,Ft,de,ye),ce.nodes.forEach(function(Mt){b(Mt,ge)==b(ke,ge)||Mt.column!=ke.column||Mt.y0<ke.y1&&Mt.y1>ke.y1&&X(Mt,Ft,de,ye)})):Dt<ke.y0&&Kt>ke.y1&&(Ft=Kt-ke.y0+10,ke=X(ke,Ft,de,ye),ce.nodes.forEach(function(Mt){b(Mt,ge)==b(ke,ge)||Mt.column!=ke.column||Mt.y0<ke.y1&&Mt.y1>ke.y1&&X(Mt,Ft,de,ye)}))}})}})}function ne(ce,de){return ce.y0>de.y0&&ce.y0<de.y1||ce.y1>de.y0&&ce.y1<de.y1?!0:ce.y0<de.y0&&ce.y1>de.y1}function X(ce,de,ye,ge){return ce.y0+de>=ye&&ce.y1+de<=ge&&(ce.y0=ce.y0+de,ce.y1=ce.y1+de,ce.targetLinks.forEach(function(me){me.y1=me.y1+de}),ce.sourceLinks.forEach(function(me){me.y0=me.y0+de})),ce}function Q(ce,de,ye,ge){ce.nodes.forEach(function(me){ge&&me.y+(me.y1-me.y0)>de&&(me.y=me.y-(me.y+(me.y1-me.y0)-de));var Ee=ce.links.filter(function(we){return b(we.source,ye)==b(me,ye)}),Pe=Ee.length;Pe>1&&Ee.sort(function(we,ke){if(!we.circular&&!ke.circular){if(we.target.column==ke.target.column)return we.y1-ke.y1;if(se(we,ke)){if(we.target.column>ke.target.column){var Xe=U(ke,we);return we.y1-Xe}if(ke.target.column>we.target.column){var Ve=U(we,ke);return Ve-ke.y1}}else return we.y1-ke.y1}if(we.circular&&!ke.circular)return we.circularLinkType=="top"?-1:1;if(ke.circular&&!we.circular)return ke.circularLinkType=="top"?1:-1;if(we.circular&&ke.circular)return we.circularLinkType===ke.circularLinkType&&we.circularLinkType=="top"?we.target.column===ke.target.column?we.target.y1-ke.target.y1:ke.target.column-we.target.column:we.circularLinkType===ke.circularLinkType&&we.circularLinkType=="bottom"?we.target.column===ke.target.column?ke.target.y1-we.target.y1:we.target.column-ke.target.column:we.circularLinkType=="top"?-1:1});var Ue=me.y0;Ee.forEach(function(we){we.y0=Ue+we.width/2,Ue=Ue+we.width}),Ee.forEach(function(we,ke){if(we.circularLinkType=="bottom"){var Xe=ke+1,Ve=0;for(Xe;Xe<Pe;Xe++)Ve=Ve+Ee[Xe].width;we.y0=me.y1-Ve-we.width/2}})})}function ie(ce,de,ye){ce.nodes.forEach(function(ge){var me=ce.links.filter(function(Ue){return b(Ue.target,ye)==b(ge,ye)}),Ee=me.length;Ee>1&&me.sort(function(Ue,we){if(!Ue.circular&&!we.circular){if(Ue.source.column==we.source.column)return Ue.y0-we.y0;if(se(Ue,we)){if(we.source.column<Ue.source.column){var ke=H(we,Ue);return Ue.y0-ke}if(Ue.source.column<we.source.column){var Xe=H(Ue,we);return Xe-we.y0}}else return Ue.y0-we.y0}if(Ue.circular&&!we.circular)return Ue.circularLinkType=="top"?-1:1;if(we.circular&&!Ue.circular)return we.circularLinkType=="top"?1:-1;if(Ue.circular&&we.circular)return Ue.circularLinkType===we.circularLinkType&&Ue.circularLinkType=="top"?Ue.source.column===we.source.column?Ue.source.y1-we.source.y1:Ue.source.column-we.source.column:Ue.circularLinkType===we.circularLinkType&&Ue.circularLinkType=="bottom"?Ue.source.column===we.source.column?Ue.source.y1-we.source.y1:we.source.column-Ue.source.column:Ue.circularLinkType=="top"?-1:1});var Pe=ge.y0;me.forEach(function(Ue){Ue.y1=Pe+Ue.width/2,Pe=Pe+Ue.width}),me.forEach(function(Ue,we){if(Ue.circularLinkType=="bottom"){var ke=we+1,Xe=0;for(ke;ke<Ee;ke++)Xe=Xe+me[ke].width;Ue.y1=ge.y1-Xe-Ue.width/2}})})}function se(ce,de){return ae(ce)==ae(de)}function ae(ce){return ce.y0-ce.y1>0?"up":"down"}function oe(ce,de){return b(ce.source,de)==b(ce.target,de)}function be(ce,de,ye){var ge=ce.nodes,me=ce.links,Ee=!1,Pe=!1;if(me.forEach(function(Ie){Ie.circularLinkType=="top"?Ee=!0:Ie.circularLinkType=="bottom"&&(Pe=!0)}),Ee==!1||Pe==!1){var Ue=g.min(ge,function(Ie){return Ie.y0}),we=g.max(ge,function(Ie){return Ie.y1}),ke=we-Ue,Xe=ye-de,Ve=Xe/ke;ge.forEach(function(Ie){var De=(Ie.y1-Ie.y0)*Ve;Ie.y0=(Ie.y0-Ue)*Ve,Ie.y1=Ie.y0+De}),me.forEach(function(Ie){Ie.y0=(Ie.y0-Ue)*Ve,Ie.y1=(Ie.y1-Ue)*Ve,Ie.width=Ie.width*Ve})}}A.sankeyCircular=k,A.sankeyCenter=h,A.sankeyLeft=n,A.sankeyRight=r,A.sankeyJustify=t,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,y("d3-array"),y("d3-collection"),y("d3-shape")):g(A.d3=A.d3||{},A.d3,A.d3,A.d3)})(this,function(A,g,S,M){function e(L){return L.target.depth}function a(L){return L.depth}function n(L,T){return T-1-L.height}function r(L,T){return L.sourceLinks.length?L.depth:T-1}function t(L){return L.targetLinks.length?L.depth:L.sourceLinks.length?g.min(L.sourceLinks,e)-1:0}function h(L){return function(){return L}}function s(L,T){return x(L.source,T.source)||L.index-T.index}function i(L,T){return x(L.target,T.target)||L.index-T.index}function x(L,T){return L.y0-T.y0}function p(L){return L.value}function v(L){return(L.y0+L.y1)/2}function f(L){return v(L.source)*L.value}function d(L){return v(L.target)*L.value}function o(L){return L.index}function m(L){return L.nodes}function l(L){return L.links}function w(L,T){var k=L.get(T);if(!k)throw new Error("missing: "+T);return k}var _=function(){var L=0,T=0,k=1,P=1,z=24,I=8,D=o,R=r,O=m,F=l,N=32,G=2/3;function K(){var q={nodes:O.apply(null,arguments),links:F.apply(null,arguments)};return W(q),Y(q),re(q),ue(q),j(q),q}K.update=function(q){return j(q),q},K.nodeId=function(q){return arguments.length?(D=typeof q=="function"?q:h(q),K):D},K.nodeAlign=function(q){return arguments.length?(R=typeof q=="function"?q:h(q),K):R},K.nodeWidth=function(q){return arguments.length?(z=+q,K):z},K.nodePadding=function(q){return arguments.length?(I=+q,K):I},K.nodes=function(q){return arguments.length?(O=typeof q=="function"?q:h(q),K):O},K.links=function(q){return arguments.length?(F=typeof q=="function"?q:h(q),K):F},K.size=function(q){return arguments.length?(L=T=0,k=+q[0],P=+q[1],K):[k-L,P-T]},K.extent=function(q){return arguments.length?(L=+q[0][0],k=+q[1][0],T=+q[0][1],P=+q[1][1],K):[[L,T],[k,P]]},K.iterations=function(q){return arguments.length?(N=+q,K):N};function W(q){q.nodes.forEach(function(U,$){U.index=$,U.sourceLinks=[],U.targetLinks=[]});var H=S.map(q.nodes,D);q.links.forEach(function(U,$){U.index=$;var ne=U.source,X=U.target;typeof ne!="object"&&(ne=U.source=w(H,ne)),typeof X!="object"&&(X=U.target=w(H,X)),ne.sourceLinks.push(U),X.targetLinks.push(U)})}function Y(q){q.nodes.forEach(function(H){H.value=Math.max(g.sum(H.sourceLinks,p),g.sum(H.targetLinks,p))})}function re(q){var H,U,$;for(H=q.nodes,U=[],$=0;H.length;++$,H=U,U=[])H.forEach(function(X){X.depth=$,X.sourceLinks.forEach(function(Q){U.indexOf(Q.target)<0&&U.push(Q.target)})});for(H=q.nodes,U=[],$=0;H.length;++$,H=U,U=[])H.forEach(function(X){X.height=$,X.targetLinks.forEach(function(Q){U.indexOf(Q.source)<0&&U.push(Q.source)})});var ne=(k-L-z)/($-1);q.nodes.forEach(function(X){X.x1=(X.x0=L+Math.max(0,Math.min($-1,Math.floor(R.call(null,X,$))))*ne)+z})}function ue(q){var H=S.nest().key(function(se){return se.x0}).sortKeys(g.ascending).entries(q.nodes).map(function(se){return se.values});ne(),ie();for(var U=1,$=N;$>0;--$)Q(U*=.99),ie(),X(U),ie();function ne(){var se=g.max(H,function(be){return be.length}),ae=G*(P-T)/(se-1);I>ae&&(I=ae);var oe=g.min(H,function(be){return(P-T-(be.length-1)*I)/g.sum(be,p)});H.forEach(function(be){be.forEach(function(ce,de){ce.y1=(ce.y0=de)+ce.value*oe})}),q.links.forEach(function(be){be.width=be.value*oe})}function X(se){H.forEach(function(ae){ae.forEach(function(oe){if(oe.targetLinks.length){var be=(g.sum(oe.targetLinks,f)/g.sum(oe.targetLinks,p)-v(oe))*se;oe.y0+=be,oe.y1+=be}})})}function Q(se){H.slice().reverse().forEach(function(ae){ae.forEach(function(oe){if(oe.sourceLinks.length){var be=(g.sum(oe.sourceLinks,d)/g.sum(oe.sourceLinks,p)-v(oe))*se;oe.y0+=be,oe.y1+=be}})})}function ie(){H.forEach(function(se){var ae,oe,be=T,ce=se.length,de;for(se.sort(x),de=0;de<ce;++de)ae=se[de],oe=be-ae.y0,oe>0&&(ae.y0+=oe,ae.y1+=oe),be=ae.y1+I;if(oe=be-I-P,oe>0)for(be=ae.y0-=oe,ae.y1-=oe,de=ce-2;de>=0;--de)ae=se[de],oe=ae.y1+I-be,oe>0&&(ae.y0-=oe,ae.y1-=oe),be=ae.y0})}}function j(q){q.nodes.forEach(function(H){H.sourceLinks.sort(i),H.targetLinks.sort(s)}),q.nodes.forEach(function(H){var U=H.y0,$=U;H.sourceLinks.forEach(function(ne){ne.y0=U+ne.width/2,U+=ne.width}),H.targetLinks.forEach(function(ne){ne.y1=$+ne.width/2,$+=ne.width})})}return K};function c(L){return[L.source.x1,L.y0]}function b(L){return[L.target.x0,L.y1]}var u=function(){return M.linkHorizontal().source(c).target(b)};A.sankey=_,A.sankeyCenter=t,A.sankeyLeft=a,A.sankeyRight=n,A.sankeyJustify=r,A.sankeyLinkHorizontal=u,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(y,ee,te){(function(){var A={version:"3.8.0"},g=[].slice,S=function(le){return g.call(le)},M=self.document;function e(le){return le&&(le.ownerDocument||le.document||le).documentElement}function a(le){return le&&(le.ownerDocument&&le.ownerDocument.defaultView||le.document&&le||le.defaultView)}if(M)try{S(M.documentElement.childNodes)[0].nodeType}catch{S=function(_e){for(var Le=_e.length,Be=new Array(Le);Le--;)Be[Le]=_e[Le];return Be}}if(Date.now||(Date.now=function(){return+new Date}),M)try{M.createElement("DIV").style.setProperty("opacity",0,"")}catch{var n=this.Element.prototype,r=n.setAttribute,t=n.setAttributeNS,h=this.CSSStyleDeclaration.prototype,s=h.setProperty;n.setAttribute=function(_e,Le){r.call(this,_e,Le+"")},n.setAttributeNS=function(_e,Le,Be){t.call(this,_e,Le,Be+"")},h.setProperty=function(_e,Le,Be){s.call(this,_e,Le+"",Be)}}A.ascending=i;function i(le,_e){return le<_e?-1:le>_e?1:le>=_e?0:NaN}A.descending=function(le,_e){return _e<le?-1:_e>le?1:_e>=le?0:NaN},A.min=function(le,_e){var Le=-1,Be=le.length,Oe,Ke;if(arguments.length===1){for(;++Le<Be;)if((Ke=le[Le])!=null&&Ke>=Ke){Oe=Ke;break}for(;++Le<Be;)(Ke=le[Le])!=null&&Oe>Ke&&(Oe=Ke)}else{for(;++Le<Be;)if((Ke=_e.call(le,le[Le],Le))!=null&&Ke>=Ke){Oe=Ke;break}for(;++Le<Be;)(Ke=_e.call(le,le[Le],Le))!=null&&Oe>Ke&&(Oe=Ke)}return Oe},A.max=function(le,_e){var Le=-1,Be=le.length,Oe,Ke;if(arguments.length===1){for(;++Le<Be;)if((Ke=le[Le])!=null&&Ke>=Ke){Oe=Ke;break}for(;++Le<Be;)(Ke=le[Le])!=null&&Ke>Oe&&(Oe=Ke)}else{for(;++Le<Be;)if((Ke=_e.call(le,le[Le],Le))!=null&&Ke>=Ke){Oe=Ke;break}for(;++Le<Be;)(Ke=_e.call(le,le[Le],Le))!=null&&Ke>Oe&&(Oe=Ke)}return Oe},A.extent=function(le,_e){var Le=-1,Be=le.length,Oe,Ke,xt;if(arguments.length===1){for(;++Le<Be;)if((Ke=le[Le])!=null&&Ke>=Ke){Oe=xt=Ke;break}for(;++Le<Be;)(Ke=le[Le])!=null&&(Oe>Ke&&(Oe=Ke),xt<Ke&&(xt=Ke))}else{for(;++Le<Be;)if((Ke=_e.call(le,le[Le],Le))!=null&&Ke>=Ke){Oe=xt=Ke;break}for(;++Le<Be;)(Ke=_e.call(le,le[Le],Le))!=null&&(Oe>Ke&&(Oe=Ke),xt<Ke&&(xt=Ke))}return[Oe,xt]};function x(le){return le===null?NaN:+le}function p(le){return!isNaN(le)}A.sum=function(le,_e){var Le=0,Be=le.length,Oe,Ke=-1;if(arguments.length===1)for(;++Ke<Be;)p(Oe=+le[Ke])&&(Le+=Oe);else for(;++Ke<Be;)p(Oe=+_e.call(le,le[Ke],Ke))&&(Le+=Oe);return Le},A.mean=function(le,_e){var Le=0,Be=le.length,Oe,Ke=-1,xt=Be;if(arguments.length===1)for(;++Ke<Be;)p(Oe=x(le[Ke]))?Le+=Oe:--xt;else for(;++Ke<Be;)p(Oe=x(_e.call(le,le[Ke],Ke)))?Le+=Oe:--xt;if(xt)return Le/xt},A.quantile=function(le,_e){var Le=(le.length-1)*_e+1,Be=Math.floor(Le),Oe=+le[Be-1],Ke=Le-Be;return Ke?Oe+Ke*(le[Be]-Oe):Oe},A.median=function(le,_e){var Le=[],Be=le.length,Oe,Ke=-1;if(arguments.length===1)for(;++Ke<Be;)p(Oe=x(le[Ke]))&&Le.push(Oe);else for(;++Ke<Be;)p(Oe=x(_e.call(le,le[Ke],Ke)))&&Le.push(Oe);if(Le.length)return A.quantile(Le.sort(i),.5)},A.variance=function(le,_e){var Le=le.length,Be=0,Oe,Ke,xt=0,ht=-1,Pt=0;if(arguments.length===1)for(;++ht<Le;)p(Oe=x(le[ht]))&&(Ke=Oe-Be,Be+=Ke/++Pt,xt+=Ke*(Oe-Be));else for(;++ht<Le;)p(Oe=x(_e.call(le,le[ht],ht)))&&(Ke=Oe-Be,Be+=Ke/++Pt,xt+=Ke*(Oe-Be));if(Pt>1)return xt/(Pt-1)},A.deviation=function(){var le=A.variance.apply(this,arguments);return le&&Math.sqrt(le)};function v(le){return{left:function(_e,Le,Be,Oe){for(arguments.length<3&&(Be=0),arguments.length<4&&(Oe=_e.length);Be<Oe;){var Ke=Be+Oe>>>1;le(_e[Ke],Le)<0?Be=Ke+1:Oe=Ke}return Be},right:function(_e,Le,Be,Oe){for(arguments.length<3&&(Be=0),arguments.length<4&&(Oe=_e.length);Be<Oe;){var Ke=Be+Oe>>>1;le(_e[Ke],Le)>0?Oe=Ke:Be=Ke+1}return Be}}}var f=v(i);A.bisectLeft=f.left,A.bisect=A.bisectRight=f.right,A.bisector=function(le){return v(le.length===1?function(_e,Le){return i(le(_e),Le)}:le)},A.shuffle=function(le,_e,Le){(Be=arguments.length)<3&&(Le=le.length,Be<2&&(_e=0));for(var Be=Le-_e,Oe,Ke;Be;)Ke=Math.random()*Be--|0,Oe=le[Be+_e],le[Be+_e]=le[Ke+_e],le[Ke+_e]=Oe;return le},A.permute=function(le,_e){for(var Le=_e.length,Be=new Array(Le);Le--;)Be[Le]=le[_e[Le]];return Be},A.pairs=function(le){for(var _e=0,Le=le.length-1,Be=le[0],Oe=new Array(Le<0?0:Le);_e<Le;)Oe[_e]=[Be,Be=le[++_e]];return Oe},A.transpose=function(le){if(!(Ke=le.length))return[];for(var _e=-1,Le=A.min(le,d),Be=new Array(Le);++_e<Le;)for(var Oe=-1,Ke,xt=Be[_e]=new Array(Ke);++Oe<Ke;)xt[Oe]=le[Oe][_e];return Be};function d(le){return le.length}A.zip=function(){return A.transpose(arguments)},A.keys=function(le){var _e=[];for(var Le in le)_e.push(Le);return _e},A.values=function(le){var _e=[];for(var Le in le)_e.push(le[Le]);return _e},A.entries=function(le){var _e=[];for(var Le in le)_e.push({key:Le,value:le[Le]});return _e},A.merge=function(le){for(var _e=le.length,Le,Be=-1,Oe=0,Ke,xt;++Be<_e;)Oe+=le[Be].length;for(Ke=new Array(Oe);--_e>=0;)for(xt=le[_e],Le=xt.length;--Le>=0;)Ke[--Oe]=xt[Le];return Ke};var o=Math.abs;A.range=function(le,_e,Le){if(arguments.length<3&&(Le=1,arguments.length<2&&(_e=le,le=0)),(_e-le)/Le===1/0)throw new Error("infinite range");var Be=[],Oe=m(o(Le)),Ke=-1,xt;if(le*=Oe,_e*=Oe,Le*=Oe,Le<0)for(;(xt=le+Le*++Ke)>_e;)Be.push(xt/Oe);else for(;(xt=le+Le*++Ke)<_e;)Be.push(xt/Oe);return Be};function m(le){for(var _e=1;le*_e%1;)_e*=10;return _e}function l(le,_e){for(var Le in _e)Object.defineProperty(le.prototype,Le,{value:_e[Le],enumerable:!1})}A.map=function(le,_e){var Le=new w;if(le instanceof w)le.forEach(function(ht,Pt){Le.set(ht,Pt)});else if(Array.isArray(le)){var Be=-1,Oe=le.length,Ke;if(arguments.length===1)for(;++Be<Oe;)Le.set(Be,le[Be]);else for(;++Be<Oe;)Le.set(_e.call(le,Ke=le[Be],Be),Ke)}else for(var xt in le)Le.set(xt,le[xt]);return Le};function w(){this._=Object.create(null)}var _="__proto__",c="\0";l(w,{has:L,get:function(le){return this._[b(le)]},set:function(le,_e){return this._[b(le)]=_e},remove:T,keys:k,values:function(){var le=[];for(var _e in this._)le.push(this._[_e]);return le},entries:function(){var le=[];for(var _e in this._)le.push({key:u(_e),value:this._[_e]});return le},size:P,empty:z,forEach:function(le){for(var _e in this._)le.call(this,u(_e),this._[_e])}});function b(le){return(le+="")===_||le[0]===c?c+le:le}function u(le){return(le+="")[0]===c?le.slice(1):le}function L(le){return b(le)in this._}function T(le){return(le=b(le))in this._&&delete this._[le]}function k(){var le=[];for(var _e in this._)le.push(u(_e));return le}function P(){var le=0;for(var _e in this._)++le;return le}function z(){for(var le in this._)return!1;return!0}A.nest=function(){var le={},_e=[],Le=[],Be,Oe;function Ke(ht,Pt,jt){if(jt>=_e.length)return Oe?Oe.call(le,Pt):Be?Pt.sort(Be):Pt;for(var er=-1,tr=Pt.length,Ar=_e[jt++],Qr,ln,Lr,Nr=new w,Zr;++er<tr;)(Zr=Nr.get(Qr=Ar(ln=Pt[er])))?Zr.push(ln):Nr.set(Qr,[ln]);return ht?(ln=ht(),Lr=function(nn,on){ln.set(nn,Ke(ht,on,jt))}):(ln={},Lr=function(nn,on){ln[nn]=Ke(ht,on,jt)}),Nr.forEach(Lr),ln}function xt(ht,Pt){if(Pt>=_e.length)return ht;var jt=[],er=Le[Pt++];return ht.forEach(function(tr,Ar){jt.push({key:tr,values:xt(Ar,Pt)})}),er?jt.sort(function(tr,Ar){return er(tr.key,Ar.key)}):jt}return le.map=function(ht,Pt){return Ke(Pt,ht,0)},le.entries=function(ht){return xt(Ke(A.map,ht,0),0)},le.key=function(ht){return _e.push(ht),le},le.sortKeys=function(ht){return Le[_e.length-1]=ht,le},le.sortValues=function(ht){return Be=ht,le},le.rollup=function(ht){return Oe=ht,le},le},A.set=function(le){var _e=new I;if(le)for(var Le=0,Be=le.length;Le<Be;++Le)_e.add(le[Le]);return _e};function I(){this._=Object.create(null)}l(I,{has:L,add:function(le){return this._[b(le+="")]=!0,le},remove:T,values:k,size:P,empty:z,forEach:function(le){for(var _e in this._)le.call(this,u(_e))}}),A.behavior={};function D(le){return le}A.rebind=function(le,_e){for(var Le=1,Be=arguments.length,Oe;++Le<Be;)le[Oe=arguments[Le]]=R(le,_e,_e[Oe]);return le};function R(le,_e,Le){return function(){var Be=Le.apply(_e,arguments);return Be===_e?le:Be}}function O(le,_e){if(_e in le)return _e;_e=_e.charAt(0).toUpperCase()+_e.slice(1);for(var Le=0,Be=F.length;Le<Be;++Le){var Oe=F[Le]+_e;if(Oe in le)return Oe}}var F=["webkit","ms","moz","Moz","o","O"];function N(){}A.dispatch=function(){for(var le=new G,_e=-1,Le=arguments.length;++_e<Le;)le[arguments[_e]]=K(le);return le};function G(){}G.prototype.on=function(le,_e){var Le=le.indexOf("."),Be="";if(Le>=0&&(Be=le.slice(Le+1),le=le.slice(0,Le)),le)return arguments.length<2?this[le].on(Be):this[le].on(Be,_e);if(arguments.length===2){if(_e==null)for(le in this)this.hasOwnProperty(le)&&this[le].on(Be,null);return this}};function K(le){var _e=[],Le=new w;function Be(){for(var Oe=_e,Ke=-1,xt=Oe.length,ht;++Ke<xt;)(ht=Oe[Ke].on)&&ht.apply(this,arguments);return le}return Be.on=function(Oe,Ke){var xt=Le.get(Oe),ht;return arguments.length<2?xt&&xt.on:(xt&&(xt.on=null,_e=_e.slice(0,ht=_e.indexOf(xt)).concat(_e.slice(ht+1)),Le.remove(Oe)),Ke&&_e.push(Le.set(Oe,{on:Ke})),le)},Be}A.event=null;function W(){A.event.preventDefault()}function Y(){for(var le=A.event,_e;_e=le.sourceEvent;)le=_e;return le}function re(le){for(var _e=new G,Le=0,Be=arguments.length;++Le<Be;)_e[arguments[Le]]=K(_e);return _e.of=function(Oe,Ke){return function(xt){try{var ht=xt.sourceEvent=A.event;xt.target=le,A.event=xt,_e[xt.type].apply(Oe,Ke)}finally{A.event=ht}}},_e}A.requote=function(le){return le.replace(ue,"\\$&")};var ue=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,j={}.__proto__?function(le,_e){le.__proto__=_e}:function(le,_e){for(var Le in _e)le[Le]=_e[Le]};function q(le){return j(le,ne),le}var H=function(le,_e){return _e.querySelector(le)},U=function(le,_e){return _e.querySelectorAll(le)},$=function(le,_e){var Le=le.matches||le[O(le,"matchesSelector")];return $=function(Be,Oe){return Le.call(Be,Oe)},$(le,_e)};typeof Sizzle=="function"&&(H=function(le,_e){return Sizzle(le,_e)[0]||null},U=Sizzle,$=Sizzle.matchesSelector),A.selection=function(){return A.select(M.documentElement)};var ne=A.selection.prototype=[];ne.select=function(le){var _e=[],Le,Be,Oe,Ke;le=X(le);for(var xt=-1,ht=this.length;++xt<ht;){_e.push(Le=[]),Le.parentNode=(Oe=this[xt]).parentNode;for(var Pt=-1,jt=Oe.length;++Pt<jt;)(Ke=Oe[Pt])?(Le.push(Be=le.call(Ke,Ke.__data__,Pt,xt)),Be&&"__data__"in Ke&&(Be.__data__=Ke.__data__)):Le.push(null)}return q(_e)};function X(le){return typeof le=="function"?le:function(){return H(le,this)}}ne.selectAll=function(le){var _e=[],Le,Be;le=Q(le);for(var Oe=-1,Ke=this.length;++Oe<Ke;)for(var xt=this[Oe],ht=-1,Pt=xt.length;++ht<Pt;)(Be=xt[ht])&&(_e.push(Le=S(le.call(Be,Be.__data__,ht,Oe))),Le.parentNode=Be);return q(_e)};function Q(le){return typeof le=="function"?le:function(){return U(le,this)}}var ie="http://www.w3.org/1999/xhtml",se={svg:"http://www.w3.org/2000/svg",xhtml:ie,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};A.ns={prefix:se,qualify:function(le){var _e=le.indexOf(":"),Le=le;return _e>=0&&(Le=le.slice(0,_e))!=="xmlns"&&(le=le.slice(_e+1)),se.hasOwnProperty(Le)?{space:se[Le],local:le}:le}},ne.attr=function(le,_e){if(arguments.length<2){if(typeof le=="string"){var Le=this.node();return le=A.ns.qualify(le),le.local?Le.getAttributeNS(le.space,le.local):Le.getAttribute(le)}for(_e in le)this.each(ae(_e,le[_e]));return this}return this.each(ae(le,_e))};function ae(le,_e){le=A.ns.qualify(le);function Le(){this.removeAttribute(le)}function Be(){this.removeAttributeNS(le.space,le.local)}function Oe(){this.setAttribute(le,_e)}function Ke(){this.setAttributeNS(le.space,le.local,_e)}function xt(){var Pt=_e.apply(this,arguments);Pt==null?this.removeAttribute(le):this.setAttribute(le,Pt)}function ht(){var Pt=_e.apply(this,arguments);Pt==null?this.removeAttributeNS(le.space,le.local):this.setAttributeNS(le.space,le.local,Pt)}return _e==null?le.local?Be:Le:typeof _e=="function"?le.local?ht:xt:le.local?Ke:Oe}function oe(le){return le.trim().replace(/\s+/g," ")}ne.classed=function(le,_e){if(arguments.length<2){if(typeof le=="string"){var Le=this.node(),Be=(le=ce(le)).length,Oe=-1;if(_e=Le.classList){for(;++Oe<Be;)if(!_e.contains(le[Oe]))return!1}else for(_e=Le.getAttribute("class");++Oe<Be;)if(!be(le[Oe]).test(_e))return!1;return!0}for(_e in le)this.each(de(_e,le[_e]));return this}return this.each(de(le,_e))};function be(le){return new RegExp("(?:^|\\s+)"+A.requote(le)+"(?:\\s+|$)","g")}function ce(le){return(le+"").trim().split(/^|\s+/)}function de(le,_e){le=ce(le).map(ye);var Le=le.length;function Be(){for(var Ke=-1;++Ke<Le;)le[Ke](this,_e)}function Oe(){for(var Ke=-1,xt=_e.apply(this,arguments);++Ke<Le;)le[Ke](this,xt)}return typeof _e=="function"?Oe:Be}function ye(le){var _e=be(le);return function(Le,Be){if(Oe=Le.classList)return Be?Oe.add(le):Oe.remove(le);var Oe=Le.getAttribute("class")||"";Be?(_e.lastIndex=0,_e.test(Oe)||Le.setAttribute("class",oe(Oe+" "+le))):Le.setAttribute("class",oe(Oe.replace(_e," ")))}}ne.style=function(le,_e,Le){var Be=arguments.length;if(Be<3){if(typeof le!="string"){Be<2&&(_e="");for(Le in le)this.each(ge(Le,le[Le],_e));return this}if(Be<2){var Oe=this.node();return a(Oe).getComputedStyle(Oe,null).getPropertyValue(le)}Le=""}return this.each(ge(le,_e,Le))};function ge(le,_e,Le){function Be(){this.style.removeProperty(le)}function Oe(){this.style.setProperty(le,_e,Le)}function Ke(){var xt=_e.apply(this,arguments);xt==null?this.style.removeProperty(le):this.style.setProperty(le,xt,Le)}return _e==null?Be:typeof _e=="function"?Ke:Oe}ne.property=function(le,_e){if(arguments.length<2){if(typeof le=="string")return this.node()[le];for(_e in le)this.each(me(_e,le[_e]));return this}return this.each(me(le,_e))};function me(le,_e){function Le(){delete this[le]}function Be(){this[le]=_e}function Oe(){var Ke=_e.apply(this,arguments);Ke==null?delete this[le]:this[le]=Ke}return _e==null?Le:typeof _e=="function"?Oe:Be}ne.text=function(le){return arguments.length?this.each(typeof le=="function"?function(){var _e=le.apply(this,arguments);this.textContent=_e??""}:le==null?function(){this.textContent=""}:function(){this.textContent=le}):this.node().textContent},ne.html=function(le){return arguments.length?this.each(typeof le=="function"?function(){var _e=le.apply(this,arguments);this.innerHTML=_e??""}:le==null?function(){this.innerHTML=""}:function(){this.innerHTML=le}):this.node().innerHTML},ne.append=function(le){return le=Ee(le),this.select(function(){return this.appendChild(le.apply(this,arguments))})};function Ee(le){function _e(){var Be=this.ownerDocument,Oe=this.namespaceURI;return Oe===ie&&Be.documentElement.namespaceURI===ie?Be.createElement(le):Be.createElementNS(Oe,le)}function Le(){return this.ownerDocument.createElementNS(le.space,le.local)}return typeof le=="function"?le:(le=A.ns.qualify(le)).local?Le:_e}ne.insert=function(le,_e){return le=Ee(le),_e=X(_e),this.select(function(){return this.insertBefore(le.apply(this,arguments),_e.apply(this,arguments)||null)})},ne.remove=function(){return this.each(Pe)};function Pe(){var le=this.parentNode;le&&le.removeChild(this)}ne.data=function(le,_e){var Le=-1,Be=this.length,Oe,Ke;if(!arguments.length){for(le=new Array(Be=(Oe=this[0]).length);++Le<Be;)(Ke=Oe[Le])&&(le[Le]=Ke.__data__);return le}function xt(er,tr){var Ar,Qr=er.length,ln=tr.length,Lr=Math.min(Qr,ln),Nr=new Array(ln),Zr=new Array(ln),nn=new Array(Qr),on,Kr;if(_e){var Un=new w,ra=new Array(Qr),_a;for(Ar=-1;++Ar<Qr;)(on=er[Ar])&&(Un.has(_a=_e.call(on,on.__data__,Ar))?nn[Ar]=on:Un.set(_a,on),ra[Ar]=_a);for(Ar=-1;++Ar<ln;)(on=Un.get(_a=_e.call(tr,Kr=tr[Ar],Ar)))?on!==!0&&(Nr[Ar]=on,on.__data__=Kr):Zr[Ar]=Ue(Kr),Un.set(_a,!0);for(Ar=-1;++Ar<Qr;)Ar in ra&&Un.get(ra[Ar])!==!0&&(nn[Ar]=er[Ar])}else{for(Ar=-1;++Ar<Lr;)on=er[Ar],Kr=tr[Ar],on?(on.__data__=Kr,Nr[Ar]=on):Zr[Ar]=Ue(Kr);for(;Ar<ln;++Ar)Zr[Ar]=Ue(tr[Ar]);for(;Ar<Qr;++Ar)nn[Ar]=er[Ar]}Zr.update=Nr,Zr.parentNode=Nr.parentNode=nn.parentNode=er.parentNode,ht.push(Zr),Pt.push(Nr),jt.push(nn)}var ht=Ve([]),Pt=q([]),jt=q([]);if(typeof le=="function")for(;++Le<Be;)xt(Oe=this[Le],le.call(Oe,Oe.parentNode.__data__,Le));else for(;++Le<Be;)xt(Oe=this[Le],le);return Pt.enter=function(){return ht},Pt.exit=function(){return jt},Pt};function Ue(le){return{__data__:le}}ne.datum=function(le){return arguments.length?this.property("__data__",le):this.property("__data__")},ne.filter=function(le){var _e=[],Le,Be,Oe;typeof le!="function"&&(le=we(le));for(var Ke=0,xt=this.length;Ke<xt;Ke++){_e.push(Le=[]),Le.parentNode=(Be=this[Ke]).parentNode;for(var ht=0,Pt=Be.length;ht<Pt;ht++)(Oe=Be[ht])&&le.call(Oe,Oe.__data__,ht,Ke)&&Le.push(Oe)}return q(_e)};function we(le){return function(){return $(this,le)}}ne.order=function(){for(var le=-1,_e=this.length;++le<_e;)for(var Le=this[le],Be=Le.length-1,Oe=Le[Be],Ke;--Be>=0;)(Ke=Le[Be])&&(Oe&&Oe!==Ke.nextSibling&&Oe.parentNode.insertBefore(Ke,Oe),Oe=Ke);return this},ne.sort=function(le){le=ke.apply(this,arguments);for(var _e=-1,Le=this.length;++_e<Le;)this[_e].sort(le);return this.order()};function ke(le){return arguments.length||(le=i),function(_e,Le){return _e&&Le?le(_e.__data__,Le.__data__):!_e-!Le}}ne.each=function(le){return Xe(this,function(_e,Le,Be){le.call(_e,_e.__data__,Le,Be)})};function Xe(le,_e){for(var Le=0,Be=le.length;Le<Be;Le++)for(var Oe=le[Le],Ke=0,xt=Oe.length,ht;Ke<xt;Ke++)(ht=Oe[Ke])&&_e(ht,Ke,Le);return le}ne.call=function(le){var _e=S(arguments);return le.apply(_e[0]=this,_e),this},ne.empty=function(){return!this.node()},ne.node=function(){for(var le=0,_e=this.length;le<_e;le++)for(var Le=this[le],Be=0,Oe=Le.length;Be<Oe;Be++){var Ke=Le[Be];if(Ke)return Ke}return null},ne.size=function(){var le=0;return Xe(this,function(){++le}),le};function Ve(le){return j(le,Ie),le}var Ie=[];A.selection.enter=Ve,A.selection.enter.prototype=Ie,Ie.append=ne.append,Ie.empty=ne.empty,Ie.node=ne.node,Ie.call=ne.call,Ie.size=ne.size,Ie.select=function(le){for(var _e=[],Le,Be,Oe,Ke,xt,ht=-1,Pt=this.length;++ht<Pt;){Oe=(Ke=this[ht]).update,_e.push(Le=[]),Le.parentNode=Ke.parentNode;for(var jt=-1,er=Ke.length;++jt<er;)(xt=Ke[jt])?(Le.push(Oe[jt]=Be=le.call(Ke.parentNode,xt.__data__,jt,ht)),Be.__data__=xt.__data__):Le.push(null)}return q(_e)},Ie.insert=function(le,_e){return arguments.length<2&&(_e=De(this)),ne.insert.call(this,le,_e)};function De(le){var _e,Le;return function(Be,Oe,Ke){var xt=le[Ke].update,ht=xt.length,Pt;for(Ke!=Le&&(Le=Ke,_e=0),Oe>=_e&&(_e=Oe+1);!(Pt=xt[_e])&&++_e<ht;);return Pt}}A.select=function(le){var _e;return typeof le=="string"?(_e=[H(le,M)],_e.parentNode=M.documentElement):(_e=[le],_e.parentNode=e(le)),q([_e])},A.selectAll=function(le){var _e;return typeof le=="string"?(_e=S(U(le,M)),_e.parentNode=M.documentElement):(_e=S(le),_e.parentNode=null),q([_e])},ne.on=function(le,_e,Le){var Be=arguments.length;if(Be<3){if(typeof le!="string"){Be<2&&(_e=!1);for(Le in le)this.each(Ye(Le,le[Le],_e));return this}if(Be<2)return(Be=this.node()["__on"+le])&&Be._;Le=!1}return this.each(Ye(le,_e,Le))};function Ye(le,_e,Le){var Be="__on"+le,Oe=le.indexOf("."),Ke=Dt;Oe>0&&(le=le.slice(0,Oe));var xt=vt.get(le);xt&&(le=xt,Ke=Kt);function ht(){var er=this[Be];er&&(this.removeEventListener(le,er,er.$),delete this[Be])}function Pt(){var er=Ke(_e,S(arguments));ht.call(this),this.addEventListener(le,this[Be]=er,er.$=Le),er._=_e}function jt(){var er=new RegExp("^__on([^.]+)"+A.requote(le)+"$"),tr;for(var Ar in this)if(tr=Ar.match(er)){var Qr=this[Ar];this.removeEventListener(tr[1],Qr,Qr.$),delete this[Ar]}}return Oe?_e?Pt:ht:_e?N:jt}var vt=A.map({mouseenter:"mouseover",mouseleave:"mouseout"});M&&vt.forEach(function(le){"on"+le in M&&vt.remove(le)});function Dt(le,_e){return function(Le){var Be=A.event;A.event=Le,_e[0]=this.__data__;try{le.apply(this,_e)}finally{A.event=Be}}}function Kt(le,_e){var Le=Dt(le,_e);return function(Be){var Oe=this,Ke=Be.relatedTarget;(!Ke||Ke!==Oe&&!(Ke.compareDocumentPosition(Oe)&8))&&Le.call(Oe,Be)}}var Ft,Mt=0;function Xt(le){var _e=".dragsuppress-"+ ++Mt,Le="click"+_e,Be=A.select(a(le)).on("touchmove"+_e,W).on("dragstart"+_e,W).on("selectstart"+_e,W);if(Ft==null&&(Ft="onselectstart"in le?!1:O(le.style,"userSelect")),Ft){var Oe=e(le).style,Ke=Oe[Ft];Oe[Ft]="none"}return function(xt){if(Be.on(_e,null),Ft&&(Oe[Ft]=Ke),xt){var ht=function(){Be.on(Le,null)};Be.on(Le,function(){W(),ht()},!0),setTimeout(ht,0)}}}A.mouse=function(le){return At(le,Y())};var It=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function At(le,_e){_e.changedTouches&&(_e=_e.changedTouches[0]);var Le=le.ownerSVGElement||le;if(Le.createSVGPoint){var Be=Le.createSVGPoint();if(It<0){var Oe=a(le);if(Oe.scrollX||Oe.scrollY){Le=A.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var Ke=Le[0][0].getScreenCTM();It=!(Ke.f||Ke.e),Le.remove()}}return It?(Be.x=_e.pageX,Be.y=_e.pageY):(Be.x=_e.clientX,Be.y=_e.clientY),Be=Be.matrixTransform(le.getScreenCTM().inverse()),[Be.x,Be.y]}var xt=le.getBoundingClientRect();return[_e.clientX-xt.left-le.clientLeft,_e.clientY-xt.top-le.clientTop]}A.touch=function(le,_e,Le){if(arguments.length<3&&(Le=_e,_e=Y().changedTouches),_e){for(var Be=0,Oe=_e.length,Ke;Be<Oe;++Be)if((Ke=_e[Be]).identifier===Le)return At(le,Ke)}},A.behavior.drag=function(){var le=re(Oe,"drag","dragstart","dragend"),_e=null,Le=Ke(N,A.mouse,a,"mousemove","mouseup"),Be=Ke(Ge,A.touch,D,"touchmove","touchend");function Oe(){this.on("mousedown.drag",Le).on("touchstart.drag",Be)}function Ke(xt,ht,Pt,jt,er){return function(){var tr=this,Ar=A.event.target.correspondingElement||A.event.target,Qr=tr.parentNode,ln=le.of(tr,arguments),Lr=0,Nr=xt(),Zr=".drag"+(Nr==null?"":"-"+Nr),nn,on=A.select(Pt(Ar)).on(jt+Zr,ra).on(er+Zr,_a),Kr=Xt(Ar),Un=ht(Qr,Nr);_e?(nn=_e.apply(tr,arguments),nn=[nn.x-Un[0],nn.y-Un[1]]):nn=[0,0],ln({type:"dragstart"});function ra(){var ia=ht(Qr,Nr),ka,la;ia&&(ka=ia[0]-Un[0],la=ia[1]-Un[1],Lr|=ka|la,Un=ia,ln({type:"drag",x:ia[0]+nn[0],y:ia[1]+nn[1],dx:ka,dy:la}))}function _a(){ht(Qr,Nr)&&(on.on(jt+Zr,null).on(er+Zr,null),Kr(Lr),ln({type:"dragend"}))}}}return Oe.origin=function(xt){return arguments.length?(_e=xt,Oe):_e},A.rebind(Oe,le,"on")};function Ge(){return A.event.changedTouches[0].identifier}A.touches=function(le,_e){return arguments.length<2&&(_e=Y().touches),_e?S(_e).map(function(Le){var Be=At(le,Le);return Be.identifier=Le.identifier,Be}):[]};var tt=1e-6,He=tt*tt,Ae=Math.PI,Ne=2*Ae,Ze=Ne-tt,Qe=Ae/2,bt=Ae/180,dt=180/Ae;function wt(le,_e,Le){return(_e[0]-le[0])*(Le[1]-le[1])-(_e[1]-le[1])*(Le[0]-le[0])}function Ut(le){return le>1?Qe:le<-1?-Qe:Math.asin(le)}function Rt(le){return((le=Math.exp(le))-1/le)/2}function Nt(le){return((le=Math.exp(le))+1/le)/2}function Wt(le){return((le=Math.exp(2*le))-1)/(le+1)}var Vt=Math.SQRT2,ir=2,Hr=4;A.interpolateZoom=function(le,_e){var Le=le[0],Be=le[1],Oe=le[2],Ke=_e[0],xt=_e[1],ht=_e[2],Pt=Ke-Le,jt=xt-Be,er=Pt*Pt+jt*jt,tr,Ar;if(er<He)Ar=Math.log(ht/Oe)/Vt,tr=function(nn){return[Le+nn*Pt,Be+nn*jt,Oe*Math.exp(Vt*nn*Ar)]};else{var Qr=Math.sqrt(er),ln=(ht*ht-Oe*Oe+Hr*er)/(2*Oe*ir*Qr),Lr=(ht*ht-Oe*Oe-Hr*er)/(2*ht*ir*Qr),Nr=Math.log(Math.sqrt(ln*ln+1)-ln),Zr=Math.log(Math.sqrt(Lr*Lr+1)-Lr);Ar=(Zr-Nr)/Vt,tr=function(nn){var on=nn*Ar,Kr=Nt(Nr),Un=Oe/(ir*Qr)*(Kr*Wt(Vt*on+Nr)-Rt(Nr));return[Le+Un*Pt,Be+Un*jt,Oe*Kr/Nt(Vt*on+Nr)]}}return tr.duration=Ar*1e3,tr},A.behavior.zoom=function(){var le={x:0,y:0,k:1},_e,Le,Be,Oe=[960,500],Ke=sn,xt=250,ht=0,Pt="mousedown.zoom",jt="mousemove.zoom",er="mouseup.zoom",tr,Ar="touchstart.zoom",Qr,ln=re(on,"zoomstart","zoom","zoomend"),Lr,Nr,Zr,nn;at||(at="onwheel"in M?(jr=function(){return-A.event.deltaY*(A.event.deltaMode?120:1)},"wheel"):"onmousewheel"in M?(jr=function(){return A.event.wheelDelta},"mousewheel"):(jr=function(){return-A.event.detail},"MozMousePixelScroll"));function on(fa){fa.on(Pt,$a).on(at+".zoom",co).on("dblclick.zoom",Ii).on(Ar,yi)}on.event=function(fa){fa.each(function(){var ai=ln.of(this,arguments),Xa=le;Ya?A.select(this).transition().each("start.zoom",function(){le=this.__chart__||{x:0,y:0,k:1},la(ai)}).tween("zoom:zoom",function(){var Si=Oe[0],si=Oe[1],oo=Le?Le[0]:Si/2,Qi=Le?Le[1]:si/2,yo=A.interpolateZoom([(oo-le.x)/le.k,(Qi-le.y)/le.k,Si/le.k],[(oo-Xa.x)/Xa.k,(Qi-Xa.y)/Xa.k,Si/Xa.k]);return function(Yo){var Oo=yo(Yo),Wo=Si/Oo[2];this.__chart__=le={x:oo-Oo[0]*Wo,y:Qi-Oo[1]*Wo,k:Wo},Na(ai)}}).each("interrupt.zoom",function(){Pa(ai)}).each("end.zoom",function(){Pa(ai)}):(this.__chart__=le,la(ai),Na(ai),Pa(ai))})},on.translate=function(fa){return arguments.length?(le={x:+fa[0],y:+fa[1],k:le.k},ka(),on):[le.x,le.y]},on.scale=function(fa){return arguments.length?(le={x:le.x,y:le.y,k:null},ra(+fa),ka(),on):le.k},on.scaleExtent=function(fa){return arguments.length?(Ke=fa==null?sn:[+fa[0],+fa[1]],on):Ke},on.center=function(fa){return arguments.length?(Be=fa&&[+fa[0],+fa[1]],on):Be},on.size=function(fa){return arguments.length?(Oe=fa&&[+fa[0],+fa[1]],on):Oe},on.duration=function(fa){return arguments.length?(xt=+fa,on):xt},on.x=function(fa){return arguments.length?(Nr=fa,Lr=fa.copy(),le={x:0,y:0,k:1},on):Nr},on.y=function(fa){return arguments.length?(nn=fa,Zr=fa.copy(),le={x:0,y:0,k:1},on):nn};function Kr(fa){return[(fa[0]-le.x)/le.k,(fa[1]-le.y)/le.k]}function Un(fa){return[fa[0]*le.k+le.x,fa[1]*le.k+le.y]}function ra(fa){le.k=Math.max(Ke[0],Math.min(Ke[1],fa))}function _a(fa,ai){ai=Un(ai),le.x+=fa[0]-ai[0],le.y+=fa[1]-ai[1]}function ia(fa,ai,Xa,Si){fa.__chart__={x:le.x,y:le.y,k:le.k},ra(Math.pow(2,Si)),_a(Le=ai,Xa),fa=A.select(fa),xt>0&&(fa=fa.transition().duration(xt)),fa.call(on.event)}function ka(){Nr&&Nr.domain(Lr.range().map(function(fa){return(fa-le.x)/le.k}).map(Lr.invert)),nn&&nn.domain(Zr.range().map(function(fa){return(fa-le.y)/le.k}).map(Zr.invert))}function la(fa){ht++||fa({type:"zoomstart"})}function Na(fa){ka(),fa({type:"zoom",scale:le.k,translate:[le.x,le.y]})}function Pa(fa){--ht||(fa({type:"zoomend"}),Le=null)}function $a(){var fa=this,ai=ln.of(fa,arguments),Xa=0,Si=A.select(a(fa)).on(jt,Qi).on(er,yo),si=Kr(A.mouse(fa)),oo=Xt(fa);Dn.call(fa),la(ai);function Qi(){Xa=1,_a(A.mouse(fa),si),Na(ai)}function yo(){Si.on(jt,null).on(er,null),oo(Xa),Pa(ai)}}function yi(){var fa=this,ai=ln.of(fa,arguments),Xa={},Si=0,si,oo=".zoom-"+A.event.changedTouches[0].identifier,Qi="touchmove"+oo,yo="touchend"+oo,Yo=[],Oo=A.select(fa),Wo=Xt(fa);Bi(),la(ai),Oo.on(Pt,null).on(Ar,Bi);function Gi(){var bo=A.touches(fa);return si=le.k,bo.forEach(function(eo){eo.identifier in Xa&&(Xa[eo.identifier]=Kr(eo))}),bo}function Bi(){var bo=A.event.target;A.select(bo).on(Qi,Ia).on(yo,Za),Yo.push(bo);for(var eo=A.event.changedTouches,Do=0,Xi=eo.length;Do<Xi;++Do)Xa[eo[Do].identifier]=null;var Xo=Gi(),xs=Date.now();if(Xo.length===1){if(xs-Qr<500){var Ul=Xo[0];ia(fa,Ul,Xa[Ul.identifier],Math.floor(Math.log(le.k)/Math.LN2)+1),W()}Qr=xs}else if(Xo.length>1){var Ul=Xo[0],Zi=Xo[1],qu=Ul[0]-Zi[0],Ml=Ul[1]-Zi[1];Si=qu*qu+Ml*Ml}}function Ia(){var bo=A.touches(fa),eo,Do,Xi,Xo;Dn.call(fa);for(var xs=0,Ul=bo.length;xs<Ul;++xs,Xo=null)if(Xi=bo[xs],Xo=Xa[Xi.identifier]){if(Do)break;eo=Xi,Do=Xo}if(Xo){var Zi=(Zi=Xi[0]-eo[0])*Zi+(Zi=Xi[1]-eo[1])*Zi,qu=Si&&Math.sqrt(Zi/Si);eo=[(eo[0]+Xi[0])/2,(eo[1]+Xi[1])/2],Do=[(Do[0]+Xo[0])/2,(Do[1]+Xo[1])/2],ra(qu*si)}Qr=null,_a(eo,Do),Na(ai)}function Za(){if(A.event.touches.length){for(var bo=A.event.changedTouches,eo=0,Do=bo.length;eo<Do;++eo)delete Xa[bo[eo].identifier];for(var Xi in Xa)return void Gi()}A.selectAll(Yo).on(oo,null),Oo.on(Pt,$a).on(Ar,yi),Wo(),Pa(ai)}}function co(){var fa=ln.of(this,arguments);tr?clearTimeout(tr):(Dn.call(this),_e=Kr(Le=Be||A.mouse(this)),la(fa)),tr=setTimeout(function(){tr=null,Pa(fa)},50),W(),ra(Math.pow(2,jr()*.002)*le.k),_a(Le,_e),Na(fa)}function Ii(){var fa=A.mouse(this),ai=Math.log(le.k)/Math.LN2;ia(this,fa,Kr(fa),A.event.shiftKey?Math.ceil(ai)-1:Math.floor(ai)+1)}return A.rebind(on,ln,"on")};var sn=[0,1/0],jr,at;A.color=$t;function $t(){}$t.prototype.toString=function(){return this.rgb()+""},A.hsl=Jt;function Jt(le,_e,Le){return this instanceof Jt?(this.h=+le,this.s=+_e,void(this.l=+Le)):arguments.length<2?le instanceof Jt?new Jt(le.h,le.s,le.l):Yr(""+le,nr,Jt):new Jt(le,_e,Le)}var Gt=Jt.prototype=new $t;Gt.brighter=function(le){return le=Math.pow(.7,arguments.length?le:1),new Jt(this.h,this.s,this.l/le)},Gt.darker=function(le){return le=Math.pow(.7,arguments.length?le:1),new Jt(this.h,this.s,le*this.l)},Gt.rgb=function(){return _r(this.h,this.s,this.l)};function _r(le,_e,Le){var Be,Oe;le=isNaN(le)?0:(le%=360)<0?le+360:le,_e=isNaN(_e)||_e<0?0:_e>1?1:_e,Le=Le<0?0:Le>1?1:Le,Oe=Le<=.5?Le*(1+_e):Le+_e-Le*_e,Be=2*Le-Oe;function Ke(ht){return ht>360?ht-=360:ht<0&&(ht+=360),ht<60?Be+(Oe-Be)*ht/60:ht<180?Oe:ht<240?Be+(Oe-Be)*(240-ht)/60:Be}function xt(ht){return Math.round(Ke(ht)*255)}return new Yt(xt(le+120),xt(le),xt(le-120))}A.hcl=rt;function rt(le,_e,Le){return this instanceof rt?(this.h=+le,this.c=+_e,void(this.l=+Le)):arguments.length<2?le instanceof rt?new rt(le.h,le.c,le.l):le instanceof lt?ct(le.l,le.a,le.b):ct((le=gr((le=A.rgb(le)).r,le.g,le.b)).l,le.a,le.b):new rt(le,_e,Le)}var Je=rt.prototype=new $t;Je.brighter=function(le){return new rt(this.h,this.c,Math.min(100,this.l+Tt*(arguments.length?le:1)))},Je.darker=function(le){return new rt(this.h,this.c,Math.max(0,this.l-Tt*(arguments.length?le:1)))},Je.rgb=function(){return st(this.h,this.c,this.l).rgb()};function st(le,_e,Le){return isNaN(le)&&(le=0),isNaN(_e)&&(_e=0),new lt(Le,Math.cos(le*=bt)*_e,Math.sin(le)*_e)}A.lab=lt;function lt(le,_e,Le){return this instanceof lt?(this.l=+le,this.a=+_e,void(this.b=+Le)):arguments.length<2?le instanceof lt?new lt(le.l,le.a,le.b):le instanceof rt?st(le.h,le.c,le.l):gr((le=Yt(le)).r,le.g,le.b):new lt(le,_e,Le)}var Tt=18,zt=.95047,Ce=1,Se=1.08883,nt=lt.prototype=new $t;nt.brighter=function(le){return new lt(Math.min(100,this.l+Tt*(arguments.length?le:1)),this.a,this.b)},nt.darker=function(le){return new lt(Math.max(0,this.l-Tt*(arguments.length?le:1)),this.a,this.b)},nt.rgb=function(){return it(this.l,this.a,this.b)};function it(le,_e,Le){var Be=(le+16)/116,Oe=Be+_e/500,Ke=Be-Le/200;return Oe=kt(Oe)*zt,Be=kt(Be)*Ce,Ke=kt(Ke)*Se,new Yt(St(3.2404542*Oe-1.5371385*Be-.4985314*Ke),St(-.969266*Oe+1.8760108*Be+.041556*Ke),St(.0556434*Oe-.2040259*Be+1.0572252*Ke))}function ct(le,_e,Le){return le>0?new rt(Math.atan2(Le,_e)*dt,Math.sqrt(_e*_e+Le*Le),le):new rt(NaN,NaN,le)}function kt(le){return le>.206893034?le*le*le:(le-4/29)/7.787037}function gt(le){return le>.008856?Math.pow(le,1/3):7.787037*le+4/29}function St(le){return Math.round(255*(le<=.00304?12.92*le:1.055*Math.pow(le,1/2.4)-.055))}A.rgb=Yt;function Yt(le,_e,Le){return this instanceof Yt?(this.r=~~le,this.g=~~_e,void(this.b=~~Le)):arguments.length<2?le instanceof Yt?new Yt(le.r,le.g,le.b):Yr(""+le,Yt,_r):new Yt(le,_e,Le)}function ar(le){return new Yt(le>>16,le>>8&255,le&255)}function kr(le){return ar(le)+""}var br=Yt.prototype=new $t;br.brighter=function(le){le=Math.pow(.7,arguments.length?le:1);var _e=this.r,Le=this.g,Be=this.b,Oe=30;return!_e&&!Le&&!Be?new Yt(Oe,Oe,Oe):(_e&&_e<Oe&&(_e=Oe),Le&&Le<Oe&&(Le=Oe),Be&&Be<Oe&&(Be=Oe),new Yt(Math.min(255,_e/le),Math.min(255,Le/le),Math.min(255,Be/le)))},br.darker=function(le){return le=Math.pow(.7,arguments.length?le:1),new Yt(le*this.r,le*this.g,le*this.b)},br.hsl=function(){return nr(this.r,this.g,this.b)},br.toString=function(){return"#"+Mr(this.r)+Mr(this.g)+Mr(this.b)};function Mr(le){return le<16?"0"+Math.max(0,le).toString(16):Math.min(255,le).toString(16)}function Yr(le,_e,Le){var Be=0,Oe=0,Ke=0,xt,ht,Pt;if(xt=/([a-z]+)\((.*)\)/.exec(le=le.toLowerCase()),xt)switch(ht=xt[2].split(","),xt[1]){case"hsl":return Le(parseFloat(ht[0]),parseFloat(ht[1])/100,parseFloat(ht[2])/100);case"rgb":return _e(Br(ht[0]),Br(ht[1]),Br(ht[2]))}return(Pt=Sr.get(le))?_e(Pt.r,Pt.g,Pt.b):(le!=null&&le.charAt(0)==="#"&&!isNaN(Pt=parseInt(le.slice(1),16))&&(le.length===4?(Be=(Pt&3840)>>4,Be=Be>>4|Be,Oe=Pt&240,Oe=Oe>>4|Oe,Ke=Pt&15,Ke=Ke<<4|Ke):le.length===7&&(Be=(Pt&16711680)>>16,Oe=(Pt&65280)>>8,Ke=Pt&255)),_e(Be,Oe,Ke))}function nr(le,_e,Le){var Be=Math.min(le/=255,_e/=255,Le/=255),Oe=Math.max(le,_e,Le),Ke=Oe-Be,xt,ht,Pt=(Oe+Be)/2;return Ke?(ht=Pt<.5?Ke/(Oe+Be):Ke/(2-Oe-Be),le==Oe?xt=(_e-Le)/Ke+(_e<Le?6:0):_e==Oe?xt=(Le-le)/Ke+2:xt=(le-_e)/Ke+4,xt*=60):(xt=NaN,ht=Pt>0&&Pt<1?0:xt),new Jt(xt,ht,Pt)}function gr(le,_e,Le){le=Rr(le),_e=Rr(_e),Le=Rr(Le);var Be=gt((.4124564*le+.3575761*_e+.1804375*Le)/zt),Oe=gt((.2126729*le+.7151522*_e+.072175*Le)/Ce),Ke=gt((.0193339*le+.119192*_e+.9503041*Le)/Se);return lt(116*Oe-16,500*(Be-Oe),200*(Oe-Ke))}function Rr(le){return(le/=255)<=.04045?le/12.92:Math.pow((le+.055)/1.055,2.4)}function Br(le){var _e=parseFloat(le);return le.charAt(le.length-1)==="%"?Math.round(_e*2.55):_e}var Sr=A.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Sr.forEach(function(le,_e){Sr.set(le,ar(_e))});function et(le){return typeof le=="function"?le:function(){return le}}A.functor=et,A.xhr=Lt(D);function Lt(le){return function(_e,Le,Be){return arguments.length===2&&typeof Le=="function"&&(Be=Le,Le=null),Zt(_e,Le,le,Be)}}function Zt(le,_e,Le,Be){var Oe={},Ke=A.dispatch("beforesend","progress","load","error"),xt={},ht=new XMLHttpRequest,Pt=null;self.XDomainRequest&&!("withCredentials"in ht)&&/^(http(s)?:)?\/\//.test(le)&&(ht=new XDomainRequest),"onload"in ht?ht.onload=ht.onerror=jt:ht.onreadystatechange=function(){ht.readyState>3&&jt()};function jt(){var er=ht.status,tr;if(!er&&Ir(ht)||er>=200&&er<300||er===304){try{tr=Le.call(Oe,ht)}catch(Ar){Ke.error.call(Oe,Ar);return}Ke.load.call(Oe,tr)}else Ke.error.call(Oe,ht)}return ht.onprogress=function(er){var tr=A.event;A.event=er;try{Ke.progress.call(Oe,ht)}finally{A.event=tr}},Oe.header=function(er,tr){return er=(er+"").toLowerCase(),arguments.length<2?xt[er]:(tr==null?delete xt[er]:xt[er]=tr+"",Oe)},Oe.mimeType=function(er){return arguments.length?(_e=er==null?null:er+"",Oe):_e},Oe.responseType=function(er){return arguments.length?(Pt=er,Oe):Pt},Oe.response=function(er){return Le=er,Oe},["get","post"].forEach(function(er){Oe[er]=function(){return Oe.send.apply(Oe,[er].concat(S(arguments)))}}),Oe.send=function(er,tr,Ar){if(arguments.length===2&&typeof tr=="function"&&(Ar=tr,tr=null),ht.open(er,le,!0),_e!=null&&!("accept"in xt)&&(xt.accept=_e+",*/*"),ht.setRequestHeader)for(var Qr in xt)ht.setRequestHeader(Qr,xt[Qr]);return _e!=null&&ht.overrideMimeType&&ht.overrideMimeType(_e),Pt!=null&&(ht.responseType=Pt),Ar!=null&&Oe.on("error",Ar).on("load",function(ln){Ar(null,ln)}),Ke.beforesend.call(Oe,ht),ht.send(tr??null),Oe},Oe.abort=function(){return ht.abort(),Oe},A.rebind(Oe,Ke,"on"),Be==null?Oe:Oe.get(or(Be))}function or(le){return le.length===1?function(_e,Le){le(_e==null?Le:null)}:le}function Ir(le){var _e=le.responseType;return _e&&_e!=="text"?le.response:le.responseText}A.dsv=function(le,_e){var Le=new RegExp('["'+le+`
]`),Be=le.charCodeAt(0);function Oe(jt,er,tr){arguments.length<3&&(tr=er,er=null);var Ar=Zt(jt,_e,er==null?Ke:xt(er),tr);return Ar.row=function(Qr){return arguments.length?Ar.response((er=Qr)==null?Ke:xt(Qr)):er},Ar}function Ke(jt){return Oe.parse(jt.responseText)}function xt(jt){return function(er){return Oe.parse(er.responseText,jt)}}Oe.parse=function(jt,er){var tr;return Oe.parseRows(jt,function(Ar,Qr){if(tr)return tr(Ar,Qr-1);var ln=function(Lr){for(var Nr={},Zr=Ar.length,nn=0;nn<Zr;++nn)Nr[Ar[nn]]=Lr[nn];return Nr};tr=er?function(Lr,Nr){return er(ln(Lr),Nr)}:ln})},Oe.parseRows=function(jt,er){var tr={},Ar={},Qr=[],ln=jt.length,Lr=0,Nr=0,Zr,nn;function on(){if(Lr>=ln)return Ar;if(nn)return nn=!1,tr;var Un=Lr;if(jt.charCodeAt(Un)===34){for(var ra=Un;ra++<ln;)if(jt.charCodeAt(ra)===34){if(jt.charCodeAt(ra+1)!==34)break;++ra}Lr=ra+2;var _a=jt.charCodeAt(ra+1);return _a===13?(nn=!0,jt.charCodeAt(ra+2)===10&&++Lr):_a===10&&(nn=!0),jt.slice(Un+1,ra).replace(/""/g,'"')}for(;Lr<ln;){var _a=jt.charCodeAt(Lr++),ia=1;if(_a===10)nn=!0;else if(_a===13)nn=!0,jt.charCodeAt(Lr)===10&&(++Lr,++ia);else if(_a!==Be)continue;return jt.slice(Un,Lr-ia)}return jt.slice(Un)}for(;(Zr=on())!==Ar;){for(var Kr=[];Zr!==tr&&Zr!==Ar;)Kr.push(Zr),Zr=on();er&&(Kr=er(Kr,Nr++))==null||Qr.push(Kr)}return Qr},Oe.format=function(jt){if(Array.isArray(jt[0]))return Oe.formatRows(jt);var er=new I,tr=[];return jt.forEach(function(Ar){for(var Qr in Ar)er.has(Qr)||tr.push(er.add(Qr))}),[tr.map(Pt).join(le)].concat(jt.map(function(Ar){return tr.map(function(Qr){return Pt(Ar[Qr])}).join(le)})).join(`
`)},Oe.formatRows=function(jt){return jt.map(ht).join(`
`)};function ht(jt){return jt.map(Pt).join(le)}function Pt(jt){return Le.test(jt)?'"'+jt.replace(/\"/g,'""')+'"':jt}return Oe},A.csv=A.dsv(",","text/csv"),A.tsv=A.dsv("	","text/tab-separated-values");var Or,Er,wr,Gr,wn=this[O(this,"requestAnimationFrame")]||function(le){setTimeout(le,17)};A.timer=function(){cn.apply(this,arguments)};function cn(le,_e,Le){var Be=arguments.length;Be<2&&(_e=0),Be<3&&(Le=Date.now());var Oe=Le+_e,Ke={c:le,t:Oe,n:null};return Er?Er.n=Ke:Or=Ke,Er=Ke,wr||(Gr=clearTimeout(Gr),wr=1,wn(Bn)),Ke}function Bn(){var le=En(),_e=Yn()-le;_e>24?(isFinite(_e)&&(clearTimeout(Gr),Gr=setTimeout(Bn,_e)),wr=0):(wr=1,wn(Bn))}A.timer.flush=function(){En(),Yn()};function En(){for(var le=Date.now(),_e=Or;_e;)le>=_e.t&&_e.c(le-_e.t)&&(_e.c=null),_e=_e.n;return le}function Yn(){for(var le,_e=Or,Le=1/0;_e;)_e.c?(_e.t<Le&&(Le=_e.t),_e=(le=_e).n):_e=le?le.n=_e.n:Or=_e.n;return Er=le,Le}A.round=function(le,_e){return _e?Math.round(le*(_e=Math.pow(10,_e)))/_e:Math.round(le)},A.geom={};function Vn(le){return le[0]}function pa(le){return le[1]}A.geom.hull=function(le){var _e=Vn,Le=pa;if(arguments.length)return Be(le);function Be(Oe){if(Oe.length<3)return[];var Ke=et(_e),xt=et(Le),ht,Pt=Oe.length,jt=[],er=[];for(ht=0;ht<Pt;ht++)jt.push([+Ke.call(this,Oe[ht],ht),+xt.call(this,Oe[ht],ht),ht]);for(jt.sort(ci),ht=0;ht<Pt;ht++)er.push([jt[ht][0],-jt[ht][1]]);var tr=Ma(jt),Ar=Ma(er),Qr=Ar[0]===tr[0],ln=Ar[Ar.length-1]===tr[tr.length-1],Lr=[];for(ht=tr.length-1;ht>=0;--ht)Lr.push(Oe[jt[tr[ht]][2]]);for(ht=+Qr;ht<Ar.length-ln;++ht)Lr.push(Oe[jt[Ar[ht]][2]]);return Lr}return Be.x=function(Oe){return arguments.length?(_e=Oe,Be):_e},Be.y=function(Oe){return arguments.length?(Le=Oe,Be):Le},Be};function Ma(le){for(var _e=le.length,Le=[0,1],Be=2,Oe=2;Oe<_e;Oe++){for(;Be>1&&wt(le[Le[Be-2]],le[Le[Be-1]],le[Oe])<=0;)--Be;Le[Be++]=Oe}return Le.slice(0,Be)}function ci(le,_e){return le[0]-_e[0]||le[1]-_e[1]}A.geom.polygon=function(le){return j(le,Va),le};var Va=A.geom.polygon.prototype=[];Va.area=function(){for(var le=-1,_e=this.length,Le,Be=this[_e-1],Oe=0;++le<_e;)Le=Be,Be=this[le],Oe+=Le[1]*Be[0]-Le[0]*Be[1];return Oe*.5},Va.centroid=function(le){var _e=-1,Le=this.length,Be=0,Oe=0,Ke,xt=this[Le-1],ht;for(arguments.length||(le=-1/(6*this.area()));++_e<Le;)Ke=xt,xt=this[_e],ht=Ke[0]*xt[1]-xt[0]*Ke[1],Be+=(Ke[0]+xt[0])*ht,Oe+=(Ke[1]+xt[1])*ht;return[Be*le,Oe*le]},Va.clip=function(le){for(var _e,Le=Tr(le),Be=-1,Oe=this.length-Tr(this),Ke,xt,ht=this[Oe-1],Pt,jt,er;++Be<Oe;){for(_e=le.slice(),le.length=0,Pt=this[Be],jt=_e[(xt=_e.length-Le)-1],Ke=-1;++Ke<xt;)er=_e[Ke],ja(er,ht,Pt)?(ja(jt,ht,Pt)||le.push(Wa(jt,er,ht,Pt)),le.push(er)):ja(jt,ht,Pt)&&le.push(Wa(jt,er,ht,Pt)),jt=er;Le&&le.push(le[0]),ht=Pt}return le};function ja(le,_e,Le){return(Le[0]-_e[0])*(le[1]-_e[1])<(Le[1]-_e[1])*(le[0]-_e[0])}function Wa(le,_e,Le,Be){var Oe=le[0],Ke=Le[0],xt=_e[0]-Oe,ht=Be[0]-Ke,Pt=le[1],jt=Le[1],er=_e[1]-Pt,tr=Be[1]-jt,Ar=(ht*(Pt-jt)-tr*(Oe-Ke))/(tr*xt-ht*er);return[Oe+Ar*xt,Pt+Ar*er]}function Tr(le){var _e=le[0],Le=le[le.length-1];return!(_e[0]-Le[0]||_e[1]-Le[1])}var pn,fn,An,Zn=[],ua,ea,Rn=[];function Xn(){sa(this),this.edge=this.site=this.circle=null}function Ua(le){var _e=Zn.pop()||new Xn;return _e.site=le,_e}function li(le){mr(le),An.remove(le),Zn.push(le),sa(le)}function Ht(le){var _e=le.circle,Le=_e.x,Be=_e.cy,Oe={x:Le,y:Be},Ke=le.P,xt=le.N,ht=[le];li(le);for(var Pt=Ke;Pt.circle&&o(Le-Pt.circle.x)<tt&&o(Be-Pt.circle.cy)<tt;)Ke=Pt.P,ht.unshift(Pt),li(Pt),Pt=Ke;ht.unshift(Pt),mr(Pt);for(var jt=xt;jt.circle&&o(Le-jt.circle.x)<tt&&o(Be-jt.circle.cy)<tt;)xt=jt.N,ht.push(jt),li(jt),jt=xt;ht.push(jt),mr(jt);var er=ht.length,tr;for(tr=1;tr<er;++tr)jt=ht[tr],Pt=ht[tr-1],aa(jt.edge,Pt.site,jt.site,Oe);Pt=ht[0],jt=ht[er-1],jt.edge=_n(Pt.site,jt.site,null,Oe),yr(Pt),yr(jt)}function hr(le){for(var _e=le.x,Le=le.y,Be,Oe,Ke,xt,ht=An._;ht;)if(Ke=rn(ht,Le)-_e,Ke>tt)ht=ht.L;else if(xt=_e-vn(ht,Le),xt>tt){if(!ht.R){Be=ht;break}ht=ht.R}else{Ke>-tt?(Be=ht.P,Oe=ht):xt>-tt?(Be=ht,Oe=ht.N):Be=Oe=ht;break}var Pt=Ua(le);if(An.insert(Be,Pt),!(!Be&&!Oe)){if(Be===Oe){mr(Be),Oe=Ua(Be.site),An.insert(Pt,Oe),Pt.edge=Oe.edge=_n(Be.site,Pt.site),yr(Be),yr(Oe);return}if(!Oe){Pt.edge=_n(Be.site,Pt.site);return}mr(Be),mr(Oe);var jt=Be.site,er=jt.x,tr=jt.y,Ar=le.x-er,Qr=le.y-tr,ln=Oe.site,Lr=ln.x-er,Nr=ln.y-tr,Zr=2*(Ar*Nr-Qr*Lr),nn=Ar*Ar+Qr*Qr,on=Lr*Lr+Nr*Nr,Kr={x:(Nr*nn-Qr*on)/Zr+er,y:(Ar*on-Lr*nn)/Zr+tr};aa(Oe.edge,jt,ln,Kr),Pt.edge=_n(jt,le,null,Kr),Oe.edge=_n(le,ln,null,Kr),yr(Be),yr(Oe)}}function rn(le,_e){var Le=le.site,Be=Le.x,Oe=Le.y,Ke=Oe-_e;if(!Ke)return Be;var xt=le.P;if(!xt)return-1/0;Le=xt.site;var ht=Le.x,Pt=Le.y,jt=Pt-_e;if(!jt)return ht;var er=ht-Be,tr=1/Ke-1/jt,Ar=er/jt;return tr?(-Ar+Math.sqrt(Ar*Ar-2*tr*(er*er/(-2*jt)-Pt+jt/2+Oe-Ke/2)))/tr+Be:(Be+ht)/2}function vn(le,_e){var Le=le.N;if(Le)return rn(Le,_e);var Be=le.site;return Be.y===_e?Be.x:1/0}function en(le){this.site=le,this.edges=[]}en.prototype.prepare=function(){for(var le=this.edges,_e=le.length,Le;_e--;)Le=le[_e].edge,(!Le.b||!Le.a)&&le.splice(_e,1);return le.sort(xn),le.length};function Tn(le){for(var _e=le[0][0],Le=le[1][0],Be=le[0][1],Oe=le[1][1],Ke,xt,ht,Pt,jt=fn,er=jt.length,tr,Ar,Qr,ln,Lr,Nr;er--;)if(tr=jt[er],!(!tr||!tr.prepare()))for(Qr=tr.edges,ln=Qr.length,Ar=0;Ar<ln;)Nr=Qr[Ar].end(),ht=Nr.x,Pt=Nr.y,Lr=Qr[++Ar%ln].start(),Ke=Lr.x,xt=Lr.y,(o(ht-Ke)>tt||o(Pt-xt)>tt)&&(Qr.splice(Ar,0,new da(jn(tr.site,Nr,o(ht-_e)<tt&&Oe-Pt>tt?{x:_e,y:o(Ke-_e)<tt?xt:Oe}:o(Pt-Oe)<tt&&Le-ht>tt?{x:o(xt-Oe)<tt?Ke:Le,y:Oe}:o(ht-Le)<tt&&Pt-Be>tt?{x:Le,y:o(Ke-Le)<tt?xt:Be}:o(Pt-Be)<tt&&ht-_e>tt?{x:o(xt-Be)<tt?Ke:_e,y:Be}:null),tr.site,null)),++ln)}function xn(le,_e){return _e.angle-le.angle}function un(){sa(this),this.x=this.y=this.arc=this.site=this.cy=null}function yr(le){var _e=le.P,Le=le.N;if(!(!_e||!Le)){var Be=_e.site,Oe=le.site,Ke=Le.site;if(Be!==Ke){var xt=Oe.x,ht=Oe.y,Pt=Be.x-xt,jt=Be.y-ht,er=Ke.x-xt,Nr=Ke.y-ht,tr=2*(Pt*Nr-jt*er);if(!(tr>=-He)){var Ar=Pt*Pt+jt*jt,Qr=er*er+Nr*Nr,ln=(Nr*Ar-jt*Qr)/tr,Lr=(Pt*Qr-er*Ar)/tr,Nr=Lr+ht,Zr=Rn.pop()||new un;Zr.arc=le,Zr.site=Oe,Zr.x=ln+xt,Zr.y=Nr+Math.sqrt(ln*ln+Lr*Lr),Zr.cy=Nr,le.circle=Zr;for(var nn=null,on=ea._;on;)if(Zr.y<on.y||Zr.y===on.y&&Zr.x<=on.x)if(on.L)on=on.L;else{nn=on.P;break}else if(on.R)on=on.R;else{nn=on;break}ea.insert(nn,Zr),nn||(ua=Zr)}}}}function mr(le){var _e=le.circle;_e&&(_e.P||(ua=_e.N),ea.remove(_e),Rn.push(_e),sa(_e),le.circle=null)}function zr(le,_e,Le,Be){return function(Oe){var Ke=Oe.a,xt=Oe.b,ht=Ke.x,Pt=Ke.y,jt=xt.x,er=xt.y,tr=0,Ar=1,Qr=jt-ht,ln=er-Pt,Lr;if(Lr=le-ht,!(!Qr&&Lr>0)){if(Lr/=Qr,Qr<0){if(Lr<tr)return;Lr<Ar&&(Ar=Lr)}else if(Qr>0){if(Lr>Ar)return;Lr>tr&&(tr=Lr)}if(Lr=Le-ht,!(!Qr&&Lr<0)){if(Lr/=Qr,Qr<0){if(Lr>Ar)return;Lr>tr&&(tr=Lr)}else if(Qr>0){if(Lr<tr)return;Lr<Ar&&(Ar=Lr)}if(Lr=_e-Pt,!(!ln&&Lr>0)){if(Lr/=ln,ln<0){if(Lr<tr)return;Lr<Ar&&(Ar=Lr)}else if(ln>0){if(Lr>Ar)return;Lr>tr&&(tr=Lr)}if(Lr=Be-Pt,!(!ln&&Lr<0)){if(Lr/=ln,ln<0){if(Lr>Ar)return;Lr>tr&&(tr=Lr)}else if(ln>0){if(Lr<tr)return;Lr<Ar&&(Ar=Lr)}return tr>0&&(Oe.a={x:ht+tr*Qr,y:Pt+tr*ln}),Ar<1&&(Oe.b={x:ht+Ar*Qr,y:Pt+Ar*ln}),Oe}}}}}}function gn(le){for(var _e=pn,Le=zr(le[0][0],le[0][1],le[1][0],le[1][1]),Be=_e.length,Oe;Be--;)Oe=_e[Be],(!On(Oe,le)||!Le(Oe)||o(Oe.a.x-Oe.b.x)<tt&&o(Oe.a.y-Oe.b.y)<tt)&&(Oe.a=Oe.b=null,_e.splice(Be,1))}function On(le,_e){var Le=le.b;if(Le)return!0;var Be=le.a,Oe=_e[0][0],Ke=_e[1][0],xt=_e[0][1],ht=_e[1][1],Pt=le.l,jt=le.r,er=Pt.x,tr=Pt.y,Ar=jt.x,Qr=jt.y,ln=(er+Ar)/2,Lr=(tr+Qr)/2,Nr,Zr;if(Qr===tr){if(ln<Oe||ln>=Ke)return;if(er>Ar){if(!Be)Be={x:ln,y:xt};else if(Be.y>=ht)return;Le={x:ln,y:ht}}else{if(!Be)Be={x:ln,y:ht};else if(Be.y<xt)return;Le={x:ln,y:xt}}}else if(Nr=(er-Ar)/(Qr-tr),Zr=Lr-Nr*ln,Nr<-1||Nr>1)if(er>Ar){if(!Be)Be={x:(xt-Zr)/Nr,y:xt};else if(Be.y>=ht)return;Le={x:(ht-Zr)/Nr,y:ht}}else{if(!Be)Be={x:(ht-Zr)/Nr,y:ht};else if(Be.y<xt)return;Le={x:(xt-Zr)/Nr,y:xt}}else if(tr<Qr){if(!Be)Be={x:Oe,y:Nr*Oe+Zr};else if(Be.x>=Ke)return;Le={x:Ke,y:Nr*Ke+Zr}}else{if(!Be)Be={x:Ke,y:Nr*Ke+Zr};else if(Be.x<Oe)return;Le={x:Oe,y:Nr*Oe+Zr}}return le.a=Be,le.b=Le,!0}function ta(le,_e){this.l=le,this.r=_e,this.a=this.b=null}function _n(le,_e,Le,Be){var Oe=new ta(le,_e);return pn.push(Oe),Le&&aa(Oe,le,_e,Le),Be&&aa(Oe,_e,le,Be),fn[le.i].edges.push(new da(Oe,le,_e)),fn[_e.i].edges.push(new da(Oe,_e,le)),Oe}function jn(le,_e,Le){var Be=new ta(le,null);return Be.a=_e,Be.b=Le,pn.push(Be),Be}function aa(le,_e,Le,Be){!le.a&&!le.b?(le.a=Be,le.l=_e,le.r=Le):le.l===Le?le.b=Be:le.a=Be}function da(le,_e,Le){var Be=le.a,Oe=le.b;this.edge=le,this.site=_e,this.angle=Le?Math.atan2(Le.y-_e.y,Le.x-_e.x):le.l===_e?Math.atan2(Oe.x-Be.x,Be.y-Oe.y):Math.atan2(Be.x-Oe.x,Oe.y-Be.y)}da.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function ma(){this._=null}function sa(le){le.U=le.C=le.L=le.R=le.P=le.N=null}ma.prototype={insert:function(le,_e){var Le,Be,Oe;if(le){if(_e.P=le,_e.N=le.N,le.N&&(le.N.P=_e),le.N=_e,le.R){for(le=le.R;le.L;)le=le.L;le.L=_e}else le.R=_e;Le=le}else this._?(le=Io(this._),_e.P=null,_e.N=le,le.P=le.L=_e,Le=le):(_e.P=_e.N=null,this._=_e,Le=null);for(_e.L=_e.R=null,_e.U=Le,_e.C=!0,le=_e;Le&&Le.C;)Be=Le.U,Le===Be.L?(Oe=Be.R,Oe&&Oe.C?(Le.C=Oe.C=!1,Be.C=!0,le=Be):(le===Le.R&&(Aa(this,Le),le=Le,Le=le.U),Le.C=!1,Be.C=!0,vo(this,Be))):(Oe=Be.L,Oe&&Oe.C?(Le.C=Oe.C=!1,Be.C=!0,le=Be):(le===Le.L&&(vo(this,Le),le=Le,Le=le.U),Le.C=!1,Be.C=!0,Aa(this,Be))),Le=le.U;this._.C=!1},remove:function(le){le.N&&(le.N.P=le.P),le.P&&(le.P.N=le.N),le.N=le.P=null;var _e=le.U,Le,Be=le.L,Oe=le.R,Ke,xt;if(Be?Oe?Ke=Io(Oe):Ke=Be:Ke=Oe,_e?_e.L===le?_e.L=Ke:_e.R=Ke:this._=Ke,Be&&Oe?(xt=Ke.C,Ke.C=le.C,Ke.L=Be,Be.U=Ke,Ke!==Oe?(_e=Ke.U,Ke.U=le.U,le=Ke.R,_e.L=le,Ke.R=Oe,Oe.U=Ke):(Ke.U=_e,_e=Ke,le=Ke.R)):(xt=le.C,le=Ke),le&&(le.U=_e),!xt){if(le&&le.C){le.C=!1;return}do{if(le===this._)break;if(le===_e.L){if(Le=_e.R,Le.C&&(Le.C=!1,_e.C=!0,Aa(this,_e),Le=_e.R),Le.L&&Le.L.C||Le.R&&Le.R.C){(!Le.R||!Le.R.C)&&(Le.L.C=!1,Le.C=!0,vo(this,Le),Le=_e.R),Le.C=_e.C,_e.C=Le.R.C=!1,Aa(this,_e),le=this._;break}}else if(Le=_e.L,Le.C&&(Le.C=!1,_e.C=!0,vo(this,_e),Le=_e.L),Le.L&&Le.L.C||Le.R&&Le.R.C){(!Le.L||!Le.L.C)&&(Le.R.C=!1,Le.C=!0,Aa(this,Le),Le=_e.L),Le.C=_e.C,_e.C=Le.L.C=!1,vo(this,_e),le=this._;break}Le.C=!0,le=_e,_e=_e.U}while(!le.C);le&&(le.C=!1)}}};function Aa(le,_e){var Le=_e,Be=_e.R,Oe=Le.U;Oe?Oe.L===Le?Oe.L=Be:Oe.R=Be:le._=Be,Be.U=Oe,Le.U=Be,Le.R=Be.L,Le.R&&(Le.R.U=Le),Be.L=Le}function vo(le,_e){var Le=_e,Be=_e.L,Oe=Le.U;Oe?Oe.L===Le?Oe.L=Be:Oe.R=Be:le._=Be,Be.U=Oe,Le.U=Be,Le.L=Be.R,Le.L&&(Le.L.U=Le),Be.R=Le}function Io(le){for(;le.L;)le=le.L;return le}function jo(le,_e){var Le=le.sort(nl).pop(),Be,Oe,Ke;for(pn=[],fn=new Array(le.length),An=new ma,ea=new ma;;)if(Ke=ua,Le&&(!Ke||Le.y<Ke.y||Le.y===Ke.y&&Le.x<Ke.x))(Le.x!==Be||Le.y!==Oe)&&(fn[Le.i]=new en(Le),hr(Le),Be=Le.x,Oe=Le.y),Le=le.pop();else if(Ke)Ht(Ke.arc);else break;_e&&(gn(_e),Tn(_e));var xt={cells:fn,edges:pn};return An=ea=pn=fn=null,xt}function nl(le,_e){return _e.y-le.y||_e.x-le.x}A.geom.voronoi=function(le){var _e=Vn,Le=pa,Be=_e,Oe=Le,Ke=pl;if(le)return xt(le);function xt(Pt){var jt=new Array(Pt.length),er=Ke[0][0],tr=Ke[0][1],Ar=Ke[1][0],Qr=Ke[1][1];return jo(ht(Pt),Ke).cells.forEach(function(ln,Lr){var Nr=ln.edges,Zr=ln.site,nn=jt[Lr]=Nr.length?Nr.map(function(on){var Kr=on.start();return[Kr.x,Kr.y]}):Zr.x>=er&&Zr.x<=Ar&&Zr.y>=tr&&Zr.y<=Qr?[[er,Qr],[Ar,Qr],[Ar,tr],[er,tr]]:[];nn.point=Pt[Lr]}),jt}function ht(Pt){return Pt.map(function(jt,er){return{x:Math.round(Be(jt,er)/tt)*tt,y:Math.round(Oe(jt,er)/tt)*tt,i:er}})}return xt.links=function(Pt){return jo(ht(Pt)).edges.filter(function(jt){return jt.l&&jt.r}).map(function(jt){return{source:Pt[jt.l.i],target:Pt[jt.r.i]}})},xt.triangles=function(Pt){var jt=[];return jo(ht(Pt)).cells.forEach(function(er,tr){for(var Ar=er.site,Qr=er.edges.sort(xn),ln=-1,Lr=Qr.length,Nr,Zr=Qr[Lr-1].edge,nn=Zr.l===Ar?Zr.r:Zr.l;++ln<Lr;)Nr=nn,Zr=Qr[ln].edge,nn=Zr.l===Ar?Zr.r:Zr.l,tr<Nr.i&&tr<nn.i&&Yl(Ar,Nr,nn)<0&&jt.push([Pt[tr],Pt[Nr.i],Pt[nn.i]])}),jt},xt.x=function(Pt){return arguments.length?(Be=et(_e=Pt),xt):_e},xt.y=function(Pt){return arguments.length?(Oe=et(Le=Pt),xt):Le},xt.clipExtent=function(Pt){return arguments.length?(Ke=Pt??pl,xt):Ke===pl?null:Ke},xt.size=function(Pt){return arguments.length?xt.clipExtent(Pt&&[[0,0],Pt]):Ke===pl?null:Ke&&Ke[1]},xt};var pl=[[-1e6,-1e6],[1e6,1e6]];function Yl(le,_e,Le){return(le.x-Le.x)*(_e.y-le.y)-(le.x-_e.x)*(Le.y-le.y)}A.geom.delaunay=function(le){return A.geom.voronoi().triangles(le)},A.geom.quadtree=function(le,_e,Le,Be,Oe){var Ke=Vn,xt=pa,ht;if(ht=arguments.length)return Ke=vi,xt=Vs,ht===3&&(Oe=Le,Be=_e,Le=_e=0),Pt(le);function Pt(jt){var er,tr=et(Ke),Ar=et(xt),Qr,ln,Lr,Nr,Zr,nn,on,Kr;if(_e!=null)Zr=_e,nn=Le,on=Be,Kr=Oe;else if(on=Kr=-(Zr=nn=1/0),Qr=[],ln=[],Nr=jt.length,ht)for(Lr=0;Lr<Nr;++Lr)er=jt[Lr],er.x<Zr&&(Zr=er.x),er.y<nn&&(nn=er.y),er.x>on&&(on=er.x),er.y>Kr&&(Kr=er.y),Qr.push(er.x),ln.push(er.y);else for(Lr=0;Lr<Nr;++Lr){var Un=+tr(er=jt[Lr],Lr),ra=+Ar(er,Lr);Un<Zr&&(Zr=Un),ra<nn&&(nn=ra),Un>on&&(on=Un),ra>Kr&&(Kr=ra),Qr.push(Un),ln.push(ra)}var _a=on-Zr,ia=Kr-nn;_a>ia?Kr=nn+_a:on=Zr+ia;function ka(Pa,$a,yi,co,Ii,fa,ai,Xa){if(!(isNaN(yi)||isNaN(co)))if(Pa.leaf){var Si=Pa.x,si=Pa.y;if(Si!=null)if(o(Si-yi)+o(si-co)<.01)la(Pa,$a,yi,co,Ii,fa,ai,Xa);else{var oo=Pa.point;Pa.x=Pa.y=Pa.point=null,la(Pa,oo,Si,si,Ii,fa,ai,Xa),la(Pa,$a,yi,co,Ii,fa,ai,Xa)}else Pa.x=yi,Pa.y=co,Pa.point=$a}else la(Pa,$a,yi,co,Ii,fa,ai,Xa)}function la(Pa,$a,yi,co,Ii,fa,ai,Xa){var Si=(Ii+ai)*.5,si=(fa+Xa)*.5,oo=yi>=Si,Qi=co>=si,yo=Qi<<1|oo;Pa.leaf=!1,Pa=Pa.nodes[yo]||(Pa.nodes[yo]=Ds()),oo?Ii=Si:ai=Si,Qi?fa=si:Xa=si,ka(Pa,$a,yi,co,Ii,fa,ai,Xa)}var Na=Ds();if(Na.add=function(Pa){ka(Na,Pa,+tr(Pa,++Lr),+Ar(Pa,Lr),Zr,nn,on,Kr)},Na.visit=function(Pa){Ui(Pa,Na,Zr,nn,on,Kr)},Na.find=function(Pa){return Mo(Na,Pa[0],Pa[1],Zr,nn,on,Kr)},Lr=-1,_e==null){for(;++Lr<Nr;)ka(Na,jt[Lr],Qr[Lr],ln[Lr],Zr,nn,on,Kr);--Lr}else jt.forEach(Na.add);return Qr=ln=jt=er=null,Na}return Pt.x=function(jt){return arguments.length?(Ke=jt,Pt):Ke},Pt.y=function(jt){return arguments.length?(xt=jt,Pt):xt},Pt.extent=function(jt){return arguments.length?(jt==null?_e=Le=Be=Oe=null:(_e=+jt[0][0],Le=+jt[0][1],Be=+jt[1][0],Oe=+jt[1][1]),Pt):_e==null?null:[[_e,Le],[Be,Oe]]},Pt.size=function(jt){return arguments.length?(jt==null?_e=Le=Be=Oe=null:(_e=Le=0,Be=+jt[0],Oe=+jt[1]),Pt):_e==null?null:[Be-_e,Oe-Le]},Pt};function vi(le){return le.x}function Vs(le){return le.y}function Ds(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Ui(le,_e,Le,Be,Oe,Ke){if(!le(_e,Le,Be,Oe,Ke)){var xt=(Le+Oe)*.5,ht=(Be+Ke)*.5,Pt=_e.nodes;Pt[0]&&Ui(le,Pt[0],Le,Be,xt,ht),Pt[1]&&Ui(le,Pt[1],xt,Be,Oe,ht),Pt[2]&&Ui(le,Pt[2],Le,ht,xt,Ke),Pt[3]&&Ui(le,Pt[3],xt,ht,Oe,Ke)}}function Mo(le,_e,Le,Be,Oe,Ke,xt){var ht=1/0,Pt;return function jt(er,tr,Ar,Qr,ln){if(!(tr>Ke||Ar>xt||Qr<Be||ln<Oe)){if(Lr=er.point){var Lr,Nr=_e-er.x,Zr=Le-er.y,nn=Nr*Nr+Zr*Zr;if(nn<ht){var on=Math.sqrt(ht=nn);Be=_e-on,Oe=Le-on,Ke=_e+on,xt=Le+on,Pt=Lr}}for(var Kr=er.nodes,Un=(tr+Qr)*.5,ra=(Ar+ln)*.5,_a=_e>=Un,ia=Le>=ra,ka=ia<<1|_a,la=ka+4;ka<la;++ka)if(er=Kr[ka&3])switch(ka&3){case 0:jt(er,tr,Ar,Un,ra);break;case 1:jt(er,Un,Ar,Qr,ra);break;case 2:jt(er,tr,ra,Un,ln);break;case 3:jt(er,Un,ra,Qr,ln);break}}}(le,Be,Oe,Ke,xt),Pt}A.interpolateRgb=dl;function dl(le,_e){le=A.rgb(le),_e=A.rgb(_e);var Le=le.r,Be=le.g,Oe=le.b,Ke=_e.r-Le,xt=_e.g-Be,ht=_e.b-Oe;return function(Pt){return"#"+Mr(Math.round(Le+Ke*Pt))+Mr(Math.round(Be+xt*Pt))+Mr(Math.round(Oe+ht*Pt))}}A.interpolateObject=vs;function vs(le,_e){var Le={},Be={},Oe;for(Oe in le)Oe in _e?Le[Oe]=ao(le[Oe],_e[Oe]):Be[Oe]=le[Oe];for(Oe in _e)Oe in le||(Be[Oe]=_e[Oe]);return function(Ke){for(Oe in Le)Be[Oe]=Le[Oe](Ke);return Be}}A.interpolateNumber=Di;function Di(le,_e){return le=+le,_e=+_e,function(Le){return le*(1-Le)+_e*Le}}A.interpolateString=al;function al(le,_e){var Le=Ki.lastIndex=Fi.lastIndex=0,Be,Oe,Ke,xt=-1,ht=[],Pt=[];for(le=le+"",_e=_e+"";(Be=Ki.exec(le))&&(Oe=Fi.exec(_e));)(Ke=Oe.index)>Le&&(Ke=_e.slice(Le,Ke),ht[xt]?ht[xt]+=Ke:ht[++xt]=Ke),(Be=Be[0])===(Oe=Oe[0])?ht[xt]?ht[xt]+=Oe:ht[++xt]=Oe:(ht[++xt]=null,Pt.push({i:xt,x:Di(Be,Oe)})),Le=Fi.lastIndex;return Le<_e.length&&(Ke=_e.slice(Le),ht[xt]?ht[xt]+=Ke:ht[++xt]=Ke),ht.length<2?Pt[0]?(_e=Pt[0].x,function(jt){return _e(jt)+""}):function(){return _e}:(_e=Pt.length,function(jt){for(var er=0,tr;er<_e;++er)ht[(tr=Pt[er]).i]=tr.x(jt);return ht.join("")})}var Ki=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fi=new RegExp(Ki.source,"g");A.interpolate=ao;function ao(le,_e){for(var Le=A.interpolators.length,Be;--Le>=0&&!(Be=A.interpolators[Le](le,_e)););return Be}A.interpolators=[function(le,_e){var Le=typeof _e;return(Le==="string"?Sr.has(_e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(_e)?dl:al:_e instanceof $t?dl:Array.isArray(_e)?Ji:Le==="object"&&isNaN(_e)?vs:Di)(le,_e)}],A.interpolateArray=Ji;function Ji(le,_e){var Le=[],Be=[],Oe=le.length,Ke=_e.length,xt=Math.min(le.length,_e.length),ht;for(ht=0;ht<xt;++ht)Le.push(ao(le[ht],_e[ht]));for(;ht<Oe;++ht)Be[ht]=le[ht];for(;ht<Ke;++ht)Be[ht]=_e[ht];return function(Pt){for(ht=0;ht<xt;++ht)Be[ht]=Le[ht](Pt);return Be}}var ts=function(){return D},Gs=A.map({linear:ts,poly:_s,quad:function(){return So},cubic:function(){return Mu},sin:function(){return Ll},exp:function(){return Su},circle:function(){return ku},elastic:Ys,back:Pl,bounce:function(){return ws}}),au=A.map({in:D,out:iu,"in-out":Rs,"out-in":function(le){return Rs(iu(le))}});A.ease=function(le){var _e=le.indexOf("-"),Le=_e>=0?le.slice(0,_e):le,Be=_e>=0?le.slice(_e+1):"in";return Le=Gs.get(Le)||ts,Be=au.get(Be)||D,Ko(Be(Le.apply(null,g.call(arguments,1))))};function Ko(le){return function(_e){return _e<=0?0:_e>=1?1:le(_e)}}function iu(le){return function(_e){return 1-le(1-_e)}}function Rs(le){return function(_e){return .5*(_e<.5?le(2*_e):2-le(2-2*_e))}}function So(le){return le*le}function Mu(le){return le*le*le}function Is(le){if(le<=0)return 0;if(le>=1)return 1;var _e=le*le,Le=_e*le;return 4*(le<.5?Le:3*(le-_e)+Le-.75)}function _s(le){return function(_e){return Math.pow(_e,le)}}function Ll(le){return 1-Math.cos(le*Qe)}function Su(le){return Math.pow(2,10*(le-1))}function ku(le){return 1-Math.sqrt(1-le*le)}function Ys(le,_e){var Le;return arguments.length<2&&(_e=.45),arguments.length?Le=_e/Ne*Math.asin(1/le):(le=1,Le=_e/4),function(Be){return 1+le*Math.pow(2,-10*Be)*Math.sin((Be-Le)*Ne/_e)}}function Pl(le){return le||(le=1.70158),function(_e){return _e*_e*((le+1)*_e-le)}}function ws(le){return le<1/2.75?7.5625*le*le:le<2/2.75?7.5625*(le-=1.5/2.75)*le+.75:le<2.5/2.75?7.5625*(le-=2.25/2.75)*le+.9375:7.5625*(le-=2.625/2.75)*le+.984375}A.interpolateHcl=Wl;function Wl(le,_e){le=A.hcl(le),_e=A.hcl(_e);var Le=le.h,Be=le.c,Oe=le.l,Ke=_e.h-Le,xt=_e.c-Be,ht=_e.l-Oe;return isNaN(xt)&&(xt=0,Be=isNaN(Be)?_e.c:Be),isNaN(Ke)?(Ke=0,Le=isNaN(Le)?_e.h:Le):Ke>180?Ke-=360:Ke<-180&&(Ke+=360),function(Pt){return st(Le+Ke*Pt,Be+xt*Pt,Oe+ht*Pt)+""}}A.interpolateHsl=il;function il(le,_e){le=A.hsl(le),_e=A.hsl(_e);var Le=le.h,Be=le.s,Oe=le.l,Ke=_e.h-Le,xt=_e.s-Be,ht=_e.l-Oe;return isNaN(xt)&&(xt=0,Be=isNaN(Be)?_e.s:Be),isNaN(Ke)?(Ke=0,Le=isNaN(Le)?_e.h:Le):Ke>180?Ke-=360:Ke<-180&&(Ke+=360),function(Pt){return _r(Le+Ke*Pt,Be+xt*Pt,Oe+ht*Pt)+""}}A.interpolateLab=Xl;function Xl(le,_e){le=A.lab(le),_e=A.lab(_e);var Le=le.l,Be=le.a,Oe=le.b,Ke=_e.l-Le,xt=_e.a-Be,ht=_e.b-Oe;return function(Pt){return it(Le+Ke*Pt,Be+xt*Pt,Oe+ht*Pt)+""}}A.interpolateRound=ou;function ou(le,_e){return _e-=le,function(Le){return Math.round(le+_e*Le)}}A.transform=function(le){var _e=M.createElementNS(A.ns.prefix.svg,"g");return(A.transform=function(Le){if(Le!=null){_e.setAttribute("transform",Le);var Be=_e.transform.baseVal.consolidate()}return new Dl(Be?Be.matrix:Rl)})(le)};function Dl(le){var _e=[le.a,le.b],Le=[le.c,le.d],Be=Ws(_e),Oe=Eu(_e,Le),Ke=Ws(Zl(Le,_e,-Oe))||0;_e[0]*Le[1]<Le[0]*_e[1]&&(_e[0]*=-1,_e[1]*=-1,Be*=-1,Oe*=-1),this.rotate=(Be?Math.atan2(_e[1],_e[0]):Math.atan2(-Le[0],Le[1]))*dt,this.translate=[le.e,le.f],this.scale=[Be,Ke],this.skew=Ke?Math.atan2(Oe,Ke)*dt:0}Dl.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Eu(le,_e){return le[0]*_e[0]+le[1]*_e[1]}function Ws(le){var _e=Math.sqrt(Eu(le,le));return _e&&(le[0]/=_e,le[1]/=_e),_e}function Zl(le,_e,Le){return le[0]+=Le*_e[0],le[1]+=Le*_e[1],le}var Rl={a:1,b:0,c:0,d:1,e:0,f:0};A.interpolateTransform=Il;function ps(le){return le.length?le.pop()+",":""}function yl(le,_e,Le,Be){if(le[0]!==_e[0]||le[1]!==_e[1]){var Oe=Le.push("translate(",null,",",null,")");Be.push({i:Oe-4,x:Di(le[0],_e[0])},{i:Oe-2,x:Di(le[1],_e[1])})}else(_e[0]||_e[1])&&Le.push("translate("+_e+")")}function jl(le,_e,Le,Be){le!==_e?(le-_e>180?_e+=360:_e-le>180&&(le+=360),Be.push({i:Le.push(ps(Le)+"rotate(",null,")")-2,x:Di(le,_e)})):_e&&Le.push(ps(Le)+"rotate("+_e+")")}function su(le,_e,Le,Be){le!==_e?Be.push({i:Le.push(ps(Le)+"skewX(",null,")")-2,x:Di(le,_e)}):_e&&Le.push(ps(Le)+"skewX("+_e+")")}function lu(le,_e,Le,Be){if(le[0]!==_e[0]||le[1]!==_e[1]){var Oe=Le.push(ps(Le)+"scale(",null,",",null,")");Be.push({i:Oe-4,x:Di(le[0],_e[0])},{i:Oe-2,x:Di(le[1],_e[1])})}else(_e[0]!==1||_e[1]!==1)&&Le.push(ps(Le)+"scale("+_e+")")}function Il(le,_e){var Le=[],Be=[];return le=A.transform(le),_e=A.transform(_e),yl(le.translate,_e.translate,Le,Be),jl(le.rotate,_e.rotate,Le,Be),su(le.skew,_e.skew,Le,Be),lu(le.scale,_e.scale,Le,Be),le=_e=null,function(Oe){for(var Ke=-1,xt=Be.length,ht;++Ke<xt;)Le[(ht=Be[Ke]).i]=ht.x(Oe);return Le.join("")}}function Cu(le,_e){return _e=(_e-=le=+le)||1/_e,function(Le){return(Le-le)/_e}}function uu(le,_e){return _e=(_e-=le=+le)||1/_e,function(Le){return Math.max(0,Math.min(1,(Le-le)/_e))}}A.layout={},A.layout.bundle=function(){return function(le){for(var _e=[],Le=-1,Be=le.length;++Le<Be;)_e.push(Jo(le[Le]));return _e}};function Jo(le){for(var _e=le.source,Le=le.target,Be=sl(_e,Le),Oe=[_e];_e!==Be;)_e=_e.parent,Oe.push(_e);for(var Ke=Oe.length;Le!==Be;)Oe.splice(Ke,0,Le),Le=Le.parent;return Oe}function ol(le){for(var _e=[],Le=le.parent;Le!=null;)_e.push(le),le=Le,Le=Le.parent;return _e.push(le),_e}function sl(le,_e){if(le===_e)return le;for(var Le=ol(le),Be=ol(_e),Oe=Le.pop(),Ke=Be.pop(),xt=null;Oe===Ke;)xt=Oe,Oe=Le.pop(),Ke=Be.pop();return xt}A.layout.chord=function(){var le={},_e,Le,Be,Oe,Ke=0,xt,ht,Pt;function jt(){var tr={},Ar=[],Qr=A.range(Oe),ln=[],Lr,Nr,Zr,nn,on;for(_e=[],Le=[],Lr=0,nn=-1;++nn<Oe;){for(Nr=0,on=-1;++on<Oe;)Nr+=Be[nn][on];Ar.push(Nr),ln.push(A.range(Oe)),Lr+=Nr}for(xt&&Qr.sort(function(Na,Pa){return xt(Ar[Na],Ar[Pa])}),ht&&ln.forEach(function(Na,Pa){Na.sort(function($a,yi){return ht(Be[Pa][$a],Be[Pa][yi])})}),Lr=(Ne-Ke*Oe)/Lr,Nr=0,nn=-1;++nn<Oe;){for(Zr=Nr,on=-1;++on<Oe;){var Kr=Qr[nn],Un=ln[Kr][on],ra=Be[Kr][Un],_a=Nr,ia=Nr+=ra*Lr;tr[Kr+"-"+Un]={index:Kr,subindex:Un,startAngle:_a,endAngle:ia,value:ra}}Le[Kr]={index:Kr,startAngle:Zr,endAngle:Nr,value:Ar[Kr]},Nr+=Ke}for(nn=-1;++nn<Oe;)for(on=nn-1;++on<Oe;){var ka=tr[nn+"-"+on],la=tr[on+"-"+nn];(ka.value||la.value)&&_e.push(ka.value<la.value?{source:la,target:ka}:{source:ka,target:la})}Pt&&er()}function er(){_e.sort(function(tr,Ar){return Pt((tr.source.value+tr.target.value)/2,(Ar.source.value+Ar.target.value)/2)})}return le.matrix=function(tr){return arguments.length?(Oe=(Be=tr)&&Be.length,_e=Le=null,le):Be},le.padding=function(tr){return arguments.length?(Ke=tr,_e=Le=null,le):Ke},le.sortGroups=function(tr){return arguments.length?(xt=tr,_e=Le=null,le):xt},le.sortSubgroups=function(tr){return arguments.length?(ht=tr,_e=null,le):ht},le.sortChords=function(tr){return arguments.length?(Pt=tr,_e&&er(),le):Pt},le.chords=function(){return _e||jt(),_e},le.groups=function(){return Le||jt(),Le},le},A.layout.force=function(){var le={},_e=A.dispatch("start","tick","end"),Le,Be=[1,1],Oe,Ke,xt=.9,ht=As,Pt=so,jt=-30,er=ml,tr=.1,Ar=.64,Qr=[],ln=[],Lr,Nr,Zr;function nn(Kr){return function(Un,ra,_a,ia){if(Un.point!==Kr){var ka=Un.cx-Kr.x,la=Un.cy-Kr.y,Na=ia-ra,Pa=ka*ka+la*la;if(Na*Na/Ar<Pa){if(Pa<er){var $a=Un.charge/Pa;Kr.px-=ka*$a,Kr.py-=la*$a}return!0}if(Un.point&&Pa&&Pa<er){var $a=Un.pointCharge/Pa;Kr.px-=ka*$a,Kr.py-=la*$a}}return!Un.charge}}le.tick=function(){if((Ke*=.99)<.005)return Le=null,_e.end({type:"end",alpha:Ke=0}),!0;var Kr=Qr.length,Un=ln.length,ra,_a,ia,ka,la,Na,Pa,$a,yi;for(_a=0;_a<Un;++_a)ia=ln[_a],ka=ia.source,la=ia.target,$a=la.x-ka.x,yi=la.y-ka.y,(Na=$a*$a+yi*yi)&&(Na=Ke*Nr[_a]*((Na=Math.sqrt(Na))-Lr[_a])/Na,$a*=Na,yi*=Na,la.x-=$a*(Pa=ka.weight+la.weight?ka.weight/(ka.weight+la.weight):.5),la.y-=yi*Pa,ka.x+=$a*(Pa=1-Pa),ka.y+=yi*Pa);if((Pa=Ke*tr)&&($a=Be[0]/2,yi=Be[1]/2,_a=-1,Pa))for(;++_a<Kr;)ia=Qr[_a],ia.x+=($a-ia.x)*Pa,ia.y+=(yi-ia.y)*Pa;if(jt)for(Ts(ra=A.geom.quadtree(Qr),Ke,Zr),_a=-1;++_a<Kr;)(ia=Qr[_a]).fixed||ra.visit(nn(ia));for(_a=-1;++_a<Kr;)ia=Qr[_a],ia.fixed?(ia.x=ia.px,ia.y=ia.py):(ia.x-=(ia.px-(ia.px=ia.x))*xt,ia.y-=(ia.py-(ia.py=ia.y))*xt);_e.tick({type:"tick",alpha:Ke})},le.nodes=function(Kr){return arguments.length?(Qr=Kr,le):Qr},le.links=function(Kr){return arguments.length?(ln=Kr,le):ln},le.size=function(Kr){return arguments.length?(Be=Kr,le):Be},le.linkDistance=function(Kr){return arguments.length?(ht=typeof Kr=="function"?Kr:+Kr,le):ht},le.distance=le.linkDistance,le.linkStrength=function(Kr){return arguments.length?(Pt=typeof Kr=="function"?Kr:+Kr,le):Pt},le.friction=function(Kr){return arguments.length?(xt=+Kr,le):xt},le.charge=function(Kr){return arguments.length?(jt=typeof Kr=="function"?Kr:+Kr,le):jt},le.chargeDistance=function(Kr){return arguments.length?(er=Kr*Kr,le):Math.sqrt(er)},le.gravity=function(Kr){return arguments.length?(tr=+Kr,le):tr},le.theta=function(Kr){return arguments.length?(Ar=Kr*Kr,le):Math.sqrt(Ar)},le.alpha=function(Kr){return arguments.length?(Kr=+Kr,Ke?Kr>0?Ke=Kr:(Le.c=null,Le.t=NaN,Le=null,_e.end({type:"end",alpha:Ke=0})):Kr>0&&(_e.start({type:"start",alpha:Ke=Kr}),Le=cn(le.tick)),le):Ke},le.start=function(){var Kr,Un=Qr.length,ra=ln.length,_a=Be[0],ia=Be[1],ka,la;for(Kr=0;Kr<Un;++Kr)(la=Qr[Kr]).index=Kr,la.weight=0;for(Kr=0;Kr<ra;++Kr)la=ln[Kr],typeof la.source=="number"&&(la.source=Qr[la.source]),typeof la.target=="number"&&(la.target=Qr[la.target]),++la.source.weight,++la.target.weight;for(Kr=0;Kr<Un;++Kr)la=Qr[Kr],isNaN(la.x)&&(la.x=Na("x",_a)),isNaN(la.y)&&(la.y=Na("y",ia)),isNaN(la.px)&&(la.px=la.x),isNaN(la.py)&&(la.py=la.y);if(Lr=[],typeof ht=="function")for(Kr=0;Kr<ra;++Kr)Lr[Kr]=+ht.call(this,ln[Kr],Kr);else for(Kr=0;Kr<ra;++Kr)Lr[Kr]=ht;if(Nr=[],typeof Pt=="function")for(Kr=0;Kr<ra;++Kr)Nr[Kr]=+Pt.call(this,ln[Kr],Kr);else for(Kr=0;Kr<ra;++Kr)Nr[Kr]=Pt;if(Zr=[],typeof jt=="function")for(Kr=0;Kr<Un;++Kr)Zr[Kr]=+jt.call(this,Qr[Kr],Kr);else for(Kr=0;Kr<Un;++Kr)Zr[Kr]=jt;function Na(Pa,$a){if(!ka){for(ka=new Array(Un),Ii=0;Ii<Un;++Ii)ka[Ii]=[];for(Ii=0;Ii<ra;++Ii){var yi=ln[Ii];ka[yi.source.index].push(yi.target),ka[yi.target.index].push(yi.source)}}for(var co=ka[Kr],Ii=-1,fa=co.length,ai;++Ii<fa;)if(!isNaN(ai=co[Ii][Pa]))return ai;return Math.random()*$a}return le.resume()},le.resume=function(){return le.alpha(.1)},le.stop=function(){return le.alpha(0)},le.drag=function(){if(Oe||(Oe=A.behavior.drag().origin(D).on("dragstart.force",Kl).on("drag.force",on).on("dragend.force",ds)),!arguments.length)return Oe;this.on("mouseover.force",ko).on("mouseout.force",zl).call(Oe)};function on(Kr){Kr.px=A.event.x,Kr.py=A.event.y,le.resume()}return A.rebind(le,_e,"on")};function Kl(le){le.fixed|=2}function ds(le){le.fixed&=-7}function ko(le){le.fixed|=4,le.px=le.x,le.py=le.y}function zl(le){le.fixed&=-5}function Ts(le,_e,Le){var Be=0,Oe=0;if(le.charge=0,!le.leaf)for(var Ke=le.nodes,xt=Ke.length,ht=-1,Pt;++ht<xt;)Pt=Ke[ht],Pt!=null&&(Ts(Pt,_e,Le),le.charge+=Pt.charge,Be+=Pt.charge*Pt.cx,Oe+=Pt.charge*Pt.cy);if(le.point){le.leaf||(le.point.x+=Math.random()-.5,le.point.y+=Math.random()-.5);var jt=_e*Le[le.point.index];le.charge+=le.pointCharge=jt,Be+=jt*le.point.x,Oe+=jt*le.point.y}le.cx=Be/le.charge,le.cy=Oe/le.charge}var As=20,so=1,ml=1/0;A.layout.hierarchy=function(){var le=Fl,_e=bl,Le=ll;function Be(Oe){var Ke=[Oe],xt=[],ht;for(Oe.depth=0;(ht=Ke.pop())!=null;)if(xt.push(ht),(jt=_e.call(Be,ht,ht.depth))&&(Pt=jt.length)){for(var Pt,jt,er;--Pt>=0;)Ke.push(er=jt[Pt]),er.parent=ht,er.depth=ht.depth+1;Le&&(ht.value=0),ht.children=jt}else Le&&(ht.value=+Le.call(Be,ht,ht.depth)||0),delete ht.children;return gs(Oe,function(tr){var Ar,Qr;le&&(Ar=tr.children)&&Ar.sort(le),Le&&(Qr=tr.parent)&&(Qr.value+=tr.value)}),xt}return Be.sort=function(Oe){return arguments.length?(le=Oe,Be):le},Be.children=function(Oe){return arguments.length?(_e=Oe,Be):_e},Be.value=function(Oe){return arguments.length?(Le=Oe,Be):Le},Be.revalue=function(Oe){return Le&&(Xs(Oe,function(Ke){Ke.children&&(Ke.value=0)}),gs(Oe,function(Ke){var xt;Ke.children||(Ke.value=+Le.call(Be,Ke,Ke.depth)||0),(xt=Ke.parent)&&(xt.value+=Ke.value)})),Oe},Be};function xl(le,_e){return A.rebind(le,_e,"sort","children","value"),le.nodes=le,le.links=_l,le}function Xs(le,_e){for(var Le=[le];(le=Le.pop())!=null;)if(_e(le),(Oe=le.children)&&(Be=Oe.length))for(var Be,Oe;--Be>=0;)Le.push(Oe[Be])}function gs(le,_e){for(var Le=[le],Be=[];(le=Le.pop())!=null;)if(Be.push(le),(xt=le.children)&&(Ke=xt.length))for(var Oe=-1,Ke,xt;++Oe<Ke;)Le.push(xt[Oe]);for(;(le=Be.pop())!=null;)_e(le)}function bl(le){return le.children}function ll(le){return le.value}function Fl(le,_e){return _e.value-le.value}function _l(le){return A.merge(le.map(function(_e){return(_e.children||[]).map(function(Le){return{source:_e,target:Le}})}))}A.layout.partition=function(){var le=A.layout.hierarchy(),_e=[1,1];function Le(Ke,xt,ht,Pt){var jt=Ke.children;if(Ke.x=xt,Ke.y=Ke.depth*Pt,Ke.dx=ht,Ke.dy=Pt,jt&&(tr=jt.length)){var er=-1,tr,Ar,Qr;for(ht=Ke.value?ht/Ke.value:0;++er<tr;)Le(Ar=jt[er],xt,Qr=Ar.value*ht,Pt),xt+=Qr}}function Be(Ke){var xt=Ke.children,ht=0;if(xt&&(jt=xt.length))for(var Pt=-1,jt;++Pt<jt;)ht=Math.max(ht,Be(xt[Pt]));return 1+ht}function Oe(Ke,xt){var ht=le.call(this,Ke,xt);return Le(ht[0],0,_e[0],_e[1]/Be(ht[0])),ht}return Oe.size=function(Ke){return arguments.length?(_e=Ke,Oe):_e},xl(Oe,le)},A.layout.pie=function(){var le=Number,_e=Zs,Le=0,Be=Ne,Oe=0;function Ke(xt){var ht=xt.length,Pt=xt.map(function(nn,on){return+le.call(Ke,nn,on)}),jt=+(typeof Le=="function"?Le.apply(this,arguments):Le),er=(typeof Be=="function"?Be.apply(this,arguments):Be)-jt,tr=Math.min(Math.abs(er)/ht,+(typeof Oe=="function"?Oe.apply(this,arguments):Oe)),Ar=tr*(er<0?-1:1),Qr=A.sum(Pt),ln=Qr?(er-ht*Ar)/Qr:0,Lr=A.range(ht),Nr=[],Zr;return _e!=null&&Lr.sort(_e===Zs?function(nn,on){return Pt[on]-Pt[nn]}:function(nn,on){return _e(xt[nn],xt[on])}),Lr.forEach(function(nn){Nr[nn]={data:xt[nn],value:Zr=Pt[nn],startAngle:jt,endAngle:jt+=Zr*ln+Ar,padAngle:tr}}),Nr}return Ke.value=function(xt){return arguments.length?(le=xt,Ke):le},Ke.sort=function(xt){return arguments.length?(_e=xt,Ke):_e},Ke.startAngle=function(xt){return arguments.length?(Le=xt,Ke):Le},Ke.endAngle=function(xt){return arguments.length?(Be=xt,Ke):Be},Ke.padAngle=function(xt){return arguments.length?(Oe=xt,Ke):Oe},Ke};var Zs={};A.layout.stack=function(){var le=D,_e=wl,Le=js,Be=Yu,Oe=Lu,Ke=rs;function xt(ht,Pt){if(!(ln=ht.length))return ht;var jt=ht.map(function(nn,on){return le.call(xt,nn,on)}),er=jt.map(function(nn){return nn.map(function(on,Kr){return[Oe.call(xt,on,Kr),Ke.call(xt,on,Kr)]})}),tr=_e.call(xt,er,Pt);jt=A.permute(jt,tr),er=A.permute(er,tr);var Ar=Le.call(xt,er,Pt),Qr=jt[0].length,ln,Lr,Nr,Zr;for(Nr=0;Nr<Qr;++Nr)for(Be.call(xt,jt[0][Nr],Zr=Ar[Nr],er[0][Nr][1]),Lr=1;Lr<ln;++Lr)Be.call(xt,jt[Lr][Nr],Zr+=er[Lr-1][Nr][1],er[Lr][Nr][1]);return ht}return xt.values=function(ht){return arguments.length?(le=ht,xt):le},xt.order=function(ht){return arguments.length?(_e=typeof ht=="function"?ht:Jl.get(ht)||wl,xt):_e},xt.offset=function(ht){return arguments.length?(Le=typeof ht=="function"?ht:ul.get(ht)||js,xt):Le},xt.x=function(ht){return arguments.length?(Oe=ht,xt):Oe},xt.y=function(ht){return arguments.length?(Ke=ht,xt):Ke},xt.out=function(ht){return arguments.length?(Be=ht,xt):Be},xt};function Lu(le){return le.x}function rs(le){return le.y}function Yu(le,_e,Le){le.y0=_e,le.y=Le}var Jl=A.map({"inside-out":function(le){var _e=le.length,Le,Be,Oe=le.map(Tl),Ke=le.map(fu),xt=A.range(_e).sort(function(tr,Ar){return Oe[tr]-Oe[Ar]}),ht=0,Pt=0,jt=[],er=[];for(Le=0;Le<_e;++Le)Be=xt[Le],ht<Pt?(ht+=Ke[Be],jt.push(Be)):(Pt+=Ke[Be],er.push(Be));return er.reverse().concat(jt)},reverse:function(le){return A.range(le.length).reverse()},default:wl}),ul=A.map({silhouette:function(le){var _e=le.length,Le=le[0].length,Be=[],Oe=0,Ke,xt,ht,Pt=[];for(xt=0;xt<Le;++xt){for(Ke=0,ht=0;Ke<_e;Ke++)ht+=le[Ke][xt][1];ht>Oe&&(Oe=ht),Be.push(ht)}for(xt=0;xt<Le;++xt)Pt[xt]=(Oe-Be[xt])/2;return Pt},wiggle:function(le){var _e=le.length,Le=le[0],Be=Le.length,Oe,Ke,xt,ht,Pt,jt,er,tr,Ar,Qr=[];for(Qr[0]=tr=Ar=0,Ke=1;Ke<Be;++Ke){for(Oe=0,ht=0;Oe<_e;++Oe)ht+=le[Oe][Ke][1];for(Oe=0,Pt=0,er=Le[Ke][0]-Le[Ke-1][0];Oe<_e;++Oe){for(xt=0,jt=(le[Oe][Ke][1]-le[Oe][Ke-1][1])/(2*er);xt<Oe;++xt)jt+=(le[xt][Ke][1]-le[xt][Ke-1][1])/er;Pt+=jt*le[Oe][Ke][1]}Qr[Ke]=tr-=ht?Pt/ht*er:0,tr<Ar&&(Ar=tr)}for(Ke=0;Ke<Be;++Ke)Qr[Ke]-=Ar;return Qr},expand:function(le){var _e=le.length,Le=le[0].length,Be=1/_e,Oe,Ke,xt,ht=[];for(Ke=0;Ke<Le;++Ke){for(Oe=0,xt=0;Oe<_e;Oe++)xt+=le[Oe][Ke][1];if(xt)for(Oe=0;Oe<_e;Oe++)le[Oe][Ke][1]/=xt;else for(Oe=0;Oe<_e;Oe++)le[Oe][Ke][1]=Be}for(Ke=0;Ke<Le;++Ke)ht[Ke]=0;return ht},zero:js});function wl(le){return A.range(le.length)}function js(le){for(var _e=-1,Le=le[0].length,Be=[];++_e<Le;)Be[_e]=0;return Be}function Tl(le){for(var _e=1,Le=0,Be=le[0][1],Oe,Ke=le.length;_e<Ke;++_e)(Oe=le[_e][1])>Be&&(Le=_e,Be=Oe);return Le}function fu(le){return le.reduce(cu,0)}function cu(le,_e){return le+_e[1]}A.layout.histogram=function(){var le=!0,_e=Number,Le=fl,Be=Wu;function Oe(Ke,Ar){for(var ht=[],Pt=Ke.map(_e,this),jt=Le.call(this,Pt,Ar),er=Be.call(this,jt,Pt,Ar),tr,Ar=-1,Qr=Pt.length,ln=er.length-1,Lr=le?1:1/Qr,Nr;++Ar<ln;)tr=ht[Ar]=[],tr.dx=er[Ar+1]-(tr.x=er[Ar]),tr.y=0;if(ln>0)for(Ar=-1;++Ar<Qr;)Nr=Pt[Ar],Nr>=jt[0]&&Nr<=jt[1]&&(tr=ht[A.bisect(er,Nr,1,ln)-1],tr.y+=Lr,tr.push(Ke[Ar]));return ht}return Oe.value=function(Ke){return arguments.length?(_e=Ke,Oe):_e},Oe.range=function(Ke){return arguments.length?(Le=et(Ke),Oe):Le},Oe.bins=function(Ke){return arguments.length?(Be=typeof Ke=="number"?function(xt){return Ri(xt,Ke)}:et(Ke),Oe):Be},Oe.frequency=function(Ke){return arguments.length?(le=!!Ke,Oe):le},Oe};function Wu(le,_e){return Ri(le,Math.ceil(Math.log(_e.length)/Math.LN2+1))}function Ri(le,_e){for(var Le=-1,Be=+le[0],Oe=(le[1]-Be)/_e,Ke=[];++Le<=_e;)Ke[Le]=Oe*Le+Be;return Ke}function fl(le){return[A.min(le),A.max(le)]}A.layout.pack=function(){var le=A.layout.hierarchy().sort(Ks),_e=0,Le=[1,1],Be;function Oe(Ke,xt){var ht=le.call(this,Ke,xt),Pt=ht[0],jt=Le[0],er=Le[1],tr=Be==null?Math.sqrt:typeof Be=="function"?Be:function(){return Be};if(Pt.x=Pt.y=0,gs(Pt,function(Qr){Qr.r=+tr(Qr.value)}),gs(Pt,lo),_e){var Ar=_e*(Be?1:Math.max(2*Pt.r/jt,2*Pt.r/er))/2;gs(Pt,function(Qr){Qr.r+=Ar}),gs(Pt,lo),gs(Pt,function(Qr){Qr.r-=Ar})}return zs(Pt,jt/2,er/2,Be?1:1/Math.max(2*Pt.r/jt,2*Pt.r/er)),ht}return Oe.size=function(Ke){return arguments.length?(Le=Ke,Oe):Le},Oe.radius=function(Ke){return arguments.length?(Be=Ke==null||typeof Ke=="function"?Ke:+Ke,Oe):Be},Oe.padding=function(Ke){return arguments.length?(_e=+Ke,Oe):_e},xl(Oe,le)};function Ks(le,_e){return le.value-_e.value}function Qo(le,_e){var Le=le._pack_next;le._pack_next=_e,_e._pack_prev=le,_e._pack_next=Le,Le._pack_prev=_e}function ns(le,_e){le._pack_next=_e,_e._pack_prev=le}function Al(le,_e){var Le=_e.x-le.x,Be=_e.y-le.y,Oe=le.r+_e.r;return .999*Oe*Oe>Le*Le+Be*Be}function lo(le){if(!(_e=le.children)||!(Ar=_e.length))return;var _e,Le=1/0,Be=-1/0,Oe=1/0,Ke=-1/0,xt,ht,Pt,jt,er,tr,Ar;function Qr(Kr){Le=Math.min(Kr.x-Kr.r,Le),Be=Math.max(Kr.x+Kr.r,Be),Oe=Math.min(Kr.y-Kr.r,Oe),Ke=Math.max(Kr.y+Kr.r,Ke)}if(_e.forEach(hu),xt=_e[0],xt.x=-xt.r,xt.y=0,Qr(xt),Ar>1&&(ht=_e[1],ht.x=ht.r,ht.y=0,Qr(ht),Ar>2))for(Pt=_e[2],Fs(xt,ht,Pt),Qr(Pt),Qo(xt,Pt),xt._pack_prev=Pt,Qo(Pt,ht),ht=xt._pack_next,jt=3;jt<Ar;jt++){Fs(xt,ht,Pt=_e[jt]);var ln=0,Lr=1,Nr=1;for(er=ht._pack_next;er!==ht;er=er._pack_next,Lr++)if(Al(er,Pt)){ln=1;break}if(ln==1)for(tr=xt._pack_prev;tr!==er._pack_prev&&!Al(tr,Pt);tr=tr._pack_prev,Nr++);ln?(Lr<Nr||Lr==Nr&&ht.r<xt.r?ns(xt,ht=er):ns(xt=tr,ht),jt--):(Qo(xt,Pt),ht=Pt,Qr(Pt))}var Zr=(Le+Be)/2,nn=(Oe+Ke)/2,on=0;for(jt=0;jt<Ar;jt++)Pt=_e[jt],Pt.x-=Zr,Pt.y-=nn,on=Math.max(on,Pt.r+Math.sqrt(Pt.x*Pt.x+Pt.y*Pt.y));le.r=on,_e.forEach(as)}function hu(le){le._pack_next=le._pack_prev=le}function as(le){delete le._pack_next,delete le._pack_prev}function zs(le,_e,Le,Be){var Oe=le.children;if(le.x=_e+=Be*le.x,le.y=Le+=Be*le.y,le.r*=Be,Oe)for(var Ke=-1,xt=Oe.length;++Ke<xt;)zs(Oe[Ke],_e,Le,Be)}function Fs(le,_e,Le){var Be=le.r+Le.r,Oe=_e.x-le.x,Ke=_e.y-le.y;if(Be&&(Oe||Ke)){var xt=_e.r+Le.r,ht=Oe*Oe+Ke*Ke;xt*=xt,Be*=Be;var Pt=.5+(Be-xt)/(2*ht),jt=Math.sqrt(Math.max(0,2*xt*(Be+ht)-(Be-=ht)*Be-xt*xt))/(2*ht);Le.x=le.x+Pt*Oe+jt*Ke,Le.y=le.y+Pt*Ke-jt*Oe}else Le.x=le.x+Be,Le.y=le.y}A.layout.tree=function(){var le=A.layout.hierarchy().sort(null).value(null),_e=Ms,Le=[1,1],Be=null;function Oe(er,tr){var Ar=le.call(this,er,tr),Qr=Ar[0],ln=Ke(Qr);if(gs(ln,xt),ln.parent.m=-ln.z,Xs(ln,ht),Be)Xs(Qr,jt);else{var Lr=Qr,Nr=Qr,Zr=Qr;Xs(Qr,function(Un){Un.x<Lr.x&&(Lr=Un),Un.x>Nr.x&&(Nr=Un),Un.depth>Zr.depth&&(Zr=Un)});var nn=_e(Lr,Nr)/2-Lr.x,on=Le[0]/(Nr.x+_e(Nr,Lr)/2+nn),Kr=Le[1]/(Zr.depth||1);Xs(Qr,function(Un){Un.x=(Un.x+nn)*on,Un.y=Un.depth*Kr})}return Ar}function Ke(er){for(var tr={A:null,children:[er]},Ar=[tr],Qr;(Qr=Ar.pop())!=null;)for(var ln=Qr.children,Lr,Nr=0,Zr=ln.length;Nr<Zr;++Nr)Ar.push((ln[Nr]=Lr={_:ln[Nr],parent:Qr,children:(Lr=ln[Nr].children)&&Lr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Nr}).a=Lr);return tr.children[0]}function xt(er){var tr=er.children,Ar=er.parent.children,Qr=er.i?Ar[er.i-1]:null;if(tr.length){os(er);var ln=(tr[0].z+tr[tr.length-1].z)/2;Qr?(er.z=Qr.z+_e(er._,Qr._),er.m=er.z-ln):er.z=ln}else Qr&&(er.z=Qr.z+_e(er._,Qr._));er.parent.A=Pt(er,Qr,er.parent.A||Ar[0])}function ht(er){er._.x=er.z+er.parent.m,er.m+=er.parent.m}function Pt(er,tr,Ar){if(tr){for(var Qr=er,ln=er,Lr=tr,Nr=Qr.parent.children[0],Zr=Qr.m,nn=ln.m,on=Lr.m,Kr=Nr.m,Un;Lr=Hi(Lr),Qr=is(Qr),Lr&&Qr;)Nr=is(Nr),ln=Hi(ln),ln.a=er,Un=Lr.z+on-Qr.z-Zr+_e(Lr._,Qr._),Un>0&&(Eo(vu(Lr,er,Ar),er,Un),Zr+=Un,nn+=Un),on+=Lr.m,Zr+=Qr.m,Kr+=Nr.m,nn+=ln.m;Lr&&!Hi(ln)&&(ln.t=Lr,ln.m+=on-nn),Qr&&!is(Nr)&&(Nr.t=Qr,Nr.m+=Zr-Kr,Ar=er)}return Ar}function jt(er){er.x*=Le[0],er.y=er.depth*Le[1]}return Oe.separation=function(er){return arguments.length?(_e=er,Oe):_e},Oe.size=function(er){return arguments.length?(Be=(Le=er)==null?jt:null,Oe):Be?null:Le},Oe.nodeSize=function(er){return arguments.length?(Be=(Le=er)==null?null:jt,Oe):Be?Le:null},xl(Oe,le)};function Ms(le,_e){return le.parent==_e.parent?1:2}function is(le){var _e=le.children;return _e.length?_e[0]:le.t}function Hi(le){var _e=le.children,Le;return(Le=_e.length)?_e[Le-1]:le.t}function Eo(le,_e,Le){var Be=Le/(_e.i-le.i);_e.c-=Be,_e.s+=Le,le.c+=Be,_e.z+=Le,_e.m+=Le}function os(le){for(var _e=0,Le=0,Be=le.children,Oe=Be.length,Ke;--Oe>=0;)Ke=Be[Oe],Ke.z+=_e,Ke.m+=_e,_e+=Ke.s+(Le+=Ke.c)}function vu(le,_e,Le){return le.a.parent===_e.parent?le.a:Le}A.layout.cluster=function(){var le=A.layout.hierarchy().sort(null).value(null),_e=Ms,Le=[1,1],Be=!1;function Oe(Ke,xt){var ht=le.call(this,Ke,xt),Pt=ht[0],jt,er=0;gs(Pt,function(Lr){var Nr=Lr.children;Nr&&Nr.length?(Lr.x=pu(Nr),Lr.y=Ol(Nr)):(Lr.x=jt?er+=_e(Lr,jt):0,Lr.y=0,jt=Lr)});var tr=yt(Pt),Ar=Bt(Pt),Qr=tr.x-_e(tr,Ar)/2,ln=Ar.x+_e(Ar,tr)/2;return gs(Pt,Be?function(Lr){Lr.x=(Lr.x-Pt.x)*Le[0],Lr.y=(Pt.y-Lr.y)*Le[1]}:function(Lr){Lr.x=(Lr.x-Qr)/(ln-Qr)*Le[0],Lr.y=(1-(Pt.y?Lr.y/Pt.y:1))*Le[1]}),ht}return Oe.separation=function(Ke){return arguments.length?(_e=Ke,Oe):_e},Oe.size=function(Ke){return arguments.length?(Be=(Le=Ke)==null,Oe):Be?null:Le},Oe.nodeSize=function(Ke){return arguments.length?(Be=(Le=Ke)!=null,Oe):Be?Le:null},xl(Oe,le)};function Ol(le){return 1+A.max(le,function(_e){return _e.y})}function pu(le){return le.reduce(function(_e,Le){return _e+Le.x},0)/le.length}function yt(le){var _e=le.children;return _e&&_e.length?yt(_e[0]):le}function Bt(le){var _e=le.children,Le;return _e&&(Le=_e.length)?Bt(_e[Le-1]):le}A.layout.treemap=function(){var le=A.layout.hierarchy(),_e=Math.round,Le=[1,1],Be=null,Oe=cr,Ke=!1,xt,ht="squarify",Pt=.5*(1+Math.sqrt(5));function jt(Lr,Nr){for(var Zr=-1,nn=Lr.length,on,Kr;++Zr<nn;)Kr=(on=Lr[Zr]).value*(Nr<0?0:Nr),on.area=isNaN(Kr)||Kr<=0?0:Kr}function er(Lr){var Nr=Lr.children;if(Nr&&Nr.length){var Zr=Oe(Lr),nn=[],on=Nr.slice(),Kr,Un=1/0,ra,_a=ht==="slice"?Zr.dx:ht==="dice"?Zr.dy:ht==="slice-dice"?Lr.depth&1?Zr.dy:Zr.dx:Math.min(Zr.dx,Zr.dy),ia;for(jt(on,Zr.dx*Zr.dy/Lr.value),nn.area=0;(ia=on.length)>0;)nn.push(Kr=on[ia-1]),nn.area+=Kr.area,ht!=="squarify"||(ra=Ar(nn,_a))<=Un?(on.pop(),Un=ra):(nn.area-=nn.pop().area,Qr(nn,_a,Zr,!1),_a=Math.min(Zr.dx,Zr.dy),nn.length=nn.area=0,Un=1/0);nn.length&&(Qr(nn,_a,Zr,!0),nn.length=nn.area=0),Nr.forEach(er)}}function tr(Lr){var Nr=Lr.children;if(Nr&&Nr.length){var Zr=Oe(Lr),nn=Nr.slice(),on,Kr=[];for(jt(nn,Zr.dx*Zr.dy/Lr.value),Kr.area=0;on=nn.pop();)Kr.push(on),Kr.area+=on.area,on.z!=null&&(Qr(Kr,on.z?Zr.dx:Zr.dy,Zr,!nn.length),Kr.length=Kr.area=0);Nr.forEach(tr)}}function Ar(Lr,Nr){for(var Zr=Lr.area,nn,on=0,Kr=1/0,Un=-1,ra=Lr.length;++Un<ra;)(nn=Lr[Un].area)&&(nn<Kr&&(Kr=nn),nn>on&&(on=nn));return Zr*=Zr,Nr*=Nr,Zr?Math.max(Nr*on*Pt/Zr,Zr/(Nr*Kr*Pt)):1/0}function Qr(Lr,Nr,Zr,nn){var on=-1,Kr=Lr.length,Un=Zr.x,ra=Zr.y,_a=Nr?_e(Lr.area/Nr):0,ia;if(Nr==Zr.dx){for((nn||_a>Zr.dy)&&(_a=Zr.dy);++on<Kr;)ia=Lr[on],ia.x=Un,ia.y=ra,ia.dy=_a,Un+=ia.dx=Math.min(Zr.x+Zr.dx-Un,_a?_e(ia.area/_a):0);ia.z=!0,ia.dx+=Zr.x+Zr.dx-Un,Zr.y+=_a,Zr.dy-=_a}else{for((nn||_a>Zr.dx)&&(_a=Zr.dx);++on<Kr;)ia=Lr[on],ia.x=Un,ia.y=ra,ia.dx=_a,ra+=ia.dy=Math.min(Zr.y+Zr.dy-ra,_a?_e(ia.area/_a):0);ia.z=!1,ia.dy+=Zr.y+Zr.dy-ra,Zr.x+=_a,Zr.dx-=_a}}function ln(Lr){var Nr=xt||le(Lr),Zr=Nr[0];return Zr.x=Zr.y=0,Zr.value?(Zr.dx=Le[0],Zr.dy=Le[1]):Zr.dx=Zr.dy=0,xt&&le.revalue(Zr),jt([Zr],Zr.dx*Zr.dy/Zr.value),(xt?tr:er)(Zr),Ke&&(xt=Nr),Nr}return ln.size=function(Lr){return arguments.length?(Le=Lr,ln):Le},ln.padding=function(Lr){if(!arguments.length)return Be;function Nr(on){var Kr=Lr.call(ln,on,on.depth);return Kr==null?cr(on):sr(on,typeof Kr=="number"?[Kr,Kr,Kr,Kr]:Kr)}function Zr(on){return sr(on,Lr)}var nn;return Oe=(Be=Lr)==null?cr:(nn=typeof Lr)=="function"?Nr:(nn==="number"&&(Lr=[Lr,Lr,Lr,Lr]),Zr),ln},ln.round=function(Lr){return arguments.length?(_e=Lr?Math.round:Number,ln):_e!=Number},ln.sticky=function(Lr){return arguments.length?(Ke=Lr,xt=null,ln):Ke},ln.ratio=function(Lr){return arguments.length?(Pt=Lr,ln):Pt},ln.mode=function(Lr){return arguments.length?(ht=Lr+"",ln):ht},xl(ln,le)};function cr(le){return{x:le.x,y:le.y,dx:le.dx,dy:le.dy}}function sr(le,_e){var Le=le.x+_e[3],Be=le.y+_e[0],Oe=le.dx-_e[1]-_e[3],Ke=le.dy-_e[0]-_e[2];return Oe<0&&(Le+=Oe/2,Oe=0),Ke<0&&(Be+=Ke/2,Ke=0),{x:Le,y:Be,dx:Oe,dy:Ke}}A.random={normal:function(le,_e){var Le=arguments.length;return Le<2&&(_e=1),Le<1&&(le=0),function(){var Be,Oe,Ke;do Be=Math.random()*2-1,Oe=Math.random()*2-1,Ke=Be*Be+Oe*Oe;while(!Ke||Ke>1);return le+_e*Be*Math.sqrt(-2*Math.log(Ke)/Ke)}},logNormal:function(){var le=A.random.normal.apply(A,arguments);return function(){return Math.exp(le())}},bates:function(le){var _e=A.random.irwinHall(le);return function(){return _e()/le}},irwinHall:function(le){return function(){for(var _e=0,Le=0;Le<le;Le++)_e+=Math.random();return _e}}},A.scale={};function Dr(le){var _e=le[0],Le=le[le.length-1];return _e<Le?[_e,Le]:[Le,_e]}function tn(le){return le.rangeExtent?le.rangeExtent():Dr(le.range())}function dn(le,_e,Le,Be){var Oe=Le(le[0],le[1]),Ke=Be(_e[0],_e[1]);return function(xt){return Ke(Oe(xt))}}function Mn(le,_e){var Le=0,Be=le.length-1,Oe=le[Le],Ke=le[Be],xt;return Ke<Oe&&(xt=Le,Le=Be,Be=xt,xt=Oe,Oe=Ke,Ke=xt),le[Le]=_e.floor(Oe),le[Be]=_e.ceil(Ke),le}function Ln(le){return le?{floor:function(_e){return Math.floor(_e/le)*le},ceil:function(_e){return Math.ceil(_e/le)*le}}:Nn}var Nn={floor:D,ceil:D};function yn(le,_e,Le,Be){var Oe=[],Ke=[],xt=0,ht=Math.min(le.length,_e.length)-1;for(le[ht]<le[0]&&(le=le.slice().reverse(),_e=_e.slice().reverse());++xt<=ht;)Oe.push(Le(le[xt-1],le[xt])),Ke.push(Be(_e[xt-1],_e[xt]));return function(Pt){var jt=A.bisect(le,Pt,1,ht)-1;return Ke[jt](Oe[jt](Pt))}}A.scale.linear=function(){return zn([0,1],[0,1],ao,!1)};function zn(le,_e,Le,Be){var Oe,Ke;function xt(){var Pt=Math.min(le.length,_e.length)>2?yn:dn,jt=Be?uu:Cu;return Oe=Pt(le,_e,jt,Le),Ke=Pt(_e,le,jt,ao),ht}function ht(Pt){return Oe(Pt)}return ht.invert=function(Pt){return Ke(Pt)},ht.domain=function(Pt){return arguments.length?(le=Pt.map(Number),xt()):le},ht.range=function(Pt){return arguments.length?(_e=Pt,xt()):_e},ht.rangeRound=function(Pt){return ht.range(Pt).interpolate(ou)},ht.clamp=function(Pt){return arguments.length?(Be=Pt,xt()):Be},ht.interpolate=function(Pt){return arguments.length?(Le=Pt,xt()):Le},ht.ticks=function(Pt){return za(le,Pt)},ht.tickFormat=function(Pt,jt){return d3_scale_linearTickFormat(le,Pt,jt)},ht.nice=function(Pt){return Hn(le,Pt),xt()},ht.copy=function(){return zn(le,_e,Le,Be)},xt()}function Pn(le,_e){return A.rebind(le,_e,"range","rangeRound","interpolate","clamp")}function Hn(le,_e){return Mn(le,Ln($n(le,_e)[2])),Mn(le,Ln($n(le,_e)[2])),le}function $n(le,_e){_e==null&&(_e=10);var Le=Dr(le),Be=Le[1]-Le[0],Oe=Math.pow(10,Math.floor(Math.log(Be/_e)/Math.LN10)),Ke=_e/Be*Oe;return Ke<=.15?Oe*=10:Ke<=.35?Oe*=5:Ke<=.75&&(Oe*=2),Le[0]=Math.ceil(Le[0]/Oe)*Oe,Le[1]=Math.floor(Le[1]/Oe)*Oe+Oe*.5,Le[2]=Oe,Le}function za(le,_e){return A.range.apply(A,$n(le,_e))}A.scale.log=function(){return Ea(A.scale.linear().domain([0,1]),10,!0,[1,10])};function Ea(le,_e,Le,Be){function Oe(ht){return(Le?Math.log(ht<0?0:ht):-Math.log(ht>0?0:-ht))/Math.log(_e)}function Ke(ht){return Le?Math.pow(_e,ht):-Math.pow(_e,-ht)}function xt(ht){return le(Oe(ht))}return xt.invert=function(ht){return Ke(le.invert(ht))},xt.domain=function(ht){return arguments.length?(Le=ht[0]>=0,le.domain((Be=ht.map(Number)).map(Oe)),xt):Be},xt.base=function(ht){return arguments.length?(_e=+ht,le.domain(Be.map(Oe)),xt):_e},xt.nice=function(){var ht=Mn(Be.map(Oe),Le?Math:Fa);return le.domain(ht),Be=ht.map(Ke),xt},xt.ticks=function(){var ht=Dr(Be),Pt=[],jt=ht[0],er=ht[1],tr=Math.floor(Oe(jt)),Ar=Math.ceil(Oe(er)),Qr=_e%1?2:_e;if(isFinite(Ar-tr)){if(Le){for(;tr<Ar;tr++)for(var ln=1;ln<Qr;ln++)Pt.push(Ke(tr)*ln);Pt.push(Ke(tr))}else for(Pt.push(Ke(tr));tr++<Ar;)for(var ln=Qr-1;ln>0;ln--)Pt.push(Ke(tr)*ln);for(tr=0;Pt[tr]<jt;tr++);for(Ar=Pt.length;Pt[Ar-1]>er;Ar--);Pt=Pt.slice(tr,Ar)}return Pt},xt.copy=function(){return Ea(le.copy(),_e,Le,Be)},Pn(xt,le)}var Fa={floor:function(le){return-Math.ceil(-le)},ceil:function(le){return-Math.floor(-le)}};A.scale.pow=function(){return Oa(A.scale.linear(),1,[0,1])};function Oa(le,_e,Le){var Be=Jn(_e),Oe=Jn(1/_e);function Ke(xt){return le(Be(xt))}return Ke.invert=function(xt){return Oe(le.invert(xt))},Ke.domain=function(xt){return arguments.length?(le.domain((Le=xt.map(Number)).map(Be)),Ke):Le},Ke.ticks=function(xt){return za(Le,xt)},Ke.tickFormat=function(xt,ht){return d3_scale_linearTickFormat(Le,xt,ht)},Ke.nice=function(xt){return Ke.domain(Hn(Le,xt))},Ke.exponent=function(xt){return arguments.length?(Be=Jn(_e=xt),Oe=Jn(1/_e),le.domain(Le.map(Be)),Ke):_e},Ke.copy=function(){return Oa(le.copy(),_e,Le)},Pn(Ke,le)}function Jn(le){return function(_e){return _e<0?-Math.pow(-_e,le):Math.pow(_e,le)}}A.scale.sqrt=function(){return A.scale.pow().exponent(.5)},A.scale.ordinal=function(){return ha([],{t:"range",a:[[]]})};function ha(le,_e){var Le,Be,Oe;function Ke(ht){return Be[((Le.get(ht)||(_e.t==="range"?Le.set(ht,le.push(ht)):NaN))-1)%Be.length]}function xt(ht,Pt){return A.range(le.length).map(function(jt){return ht+Pt*jt})}return Ke.domain=function(ht){if(!arguments.length)return le;le=[],Le=new w;for(var Pt=-1,jt=ht.length,er;++Pt<jt;)Le.has(er=ht[Pt])||Le.set(er,le.push(er));return Ke[_e.t].apply(Ke,_e.a)},Ke.range=function(ht){return arguments.length?(Be=ht,Oe=0,_e={t:"range",a:arguments},Ke):Be},Ke.rangePoints=function(ht,Pt){arguments.length<2&&(Pt=0);var jt=ht[0],er=ht[1],tr=le.length<2?(jt=(jt+er)/2,0):(er-jt)/(le.length-1+Pt);return Be=xt(jt+tr*Pt/2,tr),Oe=0,_e={t:"rangePoints",a:arguments},Ke},Ke.rangeRoundPoints=function(ht,Pt){arguments.length<2&&(Pt=0);var jt=ht[0],er=ht[1],tr=le.length<2?(jt=er=Math.round((jt+er)/2),0):(er-jt)/(le.length-1+Pt)|0;return Be=xt(jt+Math.round(tr*Pt/2+(er-jt-(le.length-1+Pt)*tr)/2),tr),Oe=0,_e={t:"rangeRoundPoints",a:arguments},Ke},Ke.rangeBands=function(ht,Pt,jt){arguments.length<2&&(Pt=0),arguments.length<3&&(jt=Pt);var er=ht[1]<ht[0],tr=ht[er-0],Ar=ht[1-er],Qr=(Ar-tr)/(le.length-Pt+2*jt);return Be=xt(tr+Qr*jt,Qr),er&&Be.reverse(),Oe=Qr*(1-Pt),_e={t:"rangeBands",a:arguments},Ke},Ke.rangeRoundBands=function(ht,Pt,jt){arguments.length<2&&(Pt=0),arguments.length<3&&(jt=Pt);var er=ht[1]<ht[0],tr=ht[er-0],Ar=ht[1-er],Qr=Math.floor((Ar-tr)/(le.length-Pt+2*jt));return Be=xt(tr+Math.round((Ar-tr-(le.length-Pt)*Qr)/2),Qr),er&&Be.reverse(),Oe=Math.round(Qr*(1-Pt)),_e={t:"rangeRoundBands",a:arguments},Ke},Ke.rangeBand=function(){return Oe},Ke.rangeExtent=function(){return Dr(_e.a[0])},Ke.copy=function(){return ha(le,_e)},Ke.domain(le)}A.scale.category10=function(){return A.scale.ordinal().range(Ga)},A.scale.category20=function(){return A.scale.ordinal().range(Qa)},A.scale.category20b=function(){return A.scale.ordinal().range(di)},A.scale.category20c=function(){return A.scale.ordinal().range(gi)};var Ga=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(kr),Qa=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(kr),di=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(kr),gi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(kr);A.scale.quantile=function(){return mi([],[])};function mi(le,_e){var Le;function Be(){var Ke=0,xt=_e.length;for(Le=[];++Ke<xt;)Le[Ke-1]=A.quantile(le,Ke/xt);return Oe}function Oe(Ke){if(!isNaN(Ke=+Ke))return _e[A.bisect(Le,Ke)]}return Oe.domain=function(Ke){return arguments.length?(le=Ke.map(x).filter(p).sort(i),Be()):le},Oe.range=function(Ke){return arguments.length?(_e=Ke,Be()):_e},Oe.quantiles=function(){return Le},Oe.invertExtent=function(Ke){return Ke=_e.indexOf(Ke),Ke<0?[NaN,NaN]:[Ke>0?Le[Ke-1]:le[0],Ke<Le.length?Le[Ke]:le[le.length-1]]},Oe.copy=function(){return mi(le,_e)},Be()}A.scale.quantize=function(){return Ai(0,1,[0,1])};function Ai(le,_e,Le){var Be,Oe;function Ke(ht){return Le[Math.max(0,Math.min(Oe,Math.floor(Be*(ht-le))))]}function xt(){return Be=Le.length/(_e-le),Oe=Le.length-1,Ke}return Ke.domain=function(ht){return arguments.length?(le=+ht[0],_e=+ht[ht.length-1],xt()):[le,_e]},Ke.range=function(ht){return arguments.length?(Le=ht,xt()):Le},Ke.invertExtent=function(ht){return ht=Le.indexOf(ht),ht=ht<0?NaN:ht/Be+le,[ht,ht+1/Be]},Ke.copy=function(){return Ai(le,_e,Le)},xt()}A.scale.threshold=function(){return oi([.5],[0,1])};function oi(le,_e){function Le(Be){if(Be<=Be)return _e[A.bisect(le,Be)]}return Le.domain=function(Be){return arguments.length?(le=Be,Le):le},Le.range=function(Be){return arguments.length?(_e=Be,Le):_e},Le.invertExtent=function(Be){return Be=_e.indexOf(Be),[le[Be-1],le[Be]]},Le.copy=function(){return oi(le,_e)},Le}A.scale.identity=function(){return mo([0,1])};function mo(le){function _e(Le){return+Le}return _e.invert=_e,_e.domain=_e.range=function(Le){return arguments.length?(le=Le.map(_e),_e):le},_e.ticks=function(Le){return za(le,Le)},_e.tickFormat=function(Le,Be){return d3_scale_linearTickFormat(le,Le,Be)},_e.copy=function(){return mo(le)},_e}A.svg={};function qi(){return 0}A.svg.arc=function(){var le=va,_e=xi,Le=qi,Be=Ja,Oe=uo,Ke=po,xt=ss;function ht(){var jt=Math.max(0,+le.apply(this,arguments)),er=Math.max(0,+_e.apply(this,arguments)),tr=Oe.apply(this,arguments)-Qe,Ar=Ke.apply(this,arguments)-Qe,Qr=Math.abs(Ar-tr),ln=tr>Ar?0:1;if(er<jt&&(Lr=er,er=jt,jt=Lr),Qr>=Ze)return Pt(er,ln)+(jt?Pt(jt,1-ln):"")+"Z";var Lr,Nr,Zr,nn,on=0,Kr=0,Un,ra,_a,ia,ka,la,Na,Pa,$a=[];if((nn=(+xt.apply(this,arguments)||0)/2)&&(Zr=Be===Ja?Math.sqrt(jt*jt+er*er):+Be.apply(this,arguments),ln||(Kr*=-1),er&&(Kr=Ut(Zr/er*Math.sin(nn))),jt&&(on=Ut(Zr/jt*Math.sin(nn)))),er){Un=er*Math.cos(tr+Kr),ra=er*Math.sin(tr+Kr),_a=er*Math.cos(Ar-Kr),ia=er*Math.sin(Ar-Kr);var yi=Math.abs(Ar-tr-2*Kr)<=Ae?0:1;if(Kr&&Ss(Un,ra,_a,ia)===ln^yi){var co=(tr+Ar)/2;Un=er*Math.cos(co),ra=er*Math.sin(co),_a=ia=null}}else Un=ra=0;if(jt){ka=jt*Math.cos(Ar-on),la=jt*Math.sin(Ar-on),Na=jt*Math.cos(tr+on),Pa=jt*Math.sin(tr+on);var Ii=Math.abs(tr-Ar+2*on)<=Ae?0:1;if(on&&Ss(ka,la,Na,Pa)===1-ln^Ii){var fa=(tr+Ar)/2;ka=jt*Math.cos(fa),la=jt*Math.sin(fa),Na=Pa=null}}else ka=la=0;if(Qr>tt&&(Lr=Math.min(Math.abs(er-jt)/2,+Le.apply(this,arguments)))>.001){Nr=jt<er^ln?0:1;var ai=Lr,Xa=Lr;if(Qr<Ae){var Si=Na==null?[ka,la]:_a==null?[Un,ra]:Wa([Un,ra],[Na,Pa],[_a,ia],[ka,la]),si=Un-Si[0],oo=ra-Si[1],Qi=_a-Si[0],yo=ia-Si[1],Yo=1/Math.sin(Math.acos((si*Qi+oo*yo)/(Math.sqrt(si*si+oo*oo)*Math.sqrt(Qi*Qi+yo*yo)))/2),Oo=Math.sqrt(Si[0]*Si[0]+Si[1]*Si[1]);Xa=Math.min(Lr,(jt-Oo)/(Yo-1)),ai=Math.min(Lr,(er-Oo)/(Yo+1))}if(_a!=null){var Wo=zo(Na==null?[ka,la]:[Na,Pa],[Un,ra],er,ai,ln),Gi=zo([_a,ia],[ka,la],er,ai,ln);Lr===ai?$a.push("M",Wo[0],"A",ai,",",ai," 0 0,",Nr," ",Wo[1],"A",er,",",er," 0 ",1-ln^Ss(Wo[1][0],Wo[1][1],Gi[1][0],Gi[1][1]),",",ln," ",Gi[1],"A",ai,",",ai," 0 0,",Nr," ",Gi[0]):$a.push("M",Wo[0],"A",ai,",",ai," 0 1,",Nr," ",Gi[0])}else $a.push("M",Un,",",ra);if(Na!=null){var Bi=zo([Un,ra],[Na,Pa],jt,-Xa,ln),Ia=zo([ka,la],_a==null?[Un,ra]:[_a,ia],jt,-Xa,ln);Lr===Xa?$a.push("L",Ia[0],"A",Xa,",",Xa," 0 0,",Nr," ",Ia[1],"A",jt,",",jt," 0 ",ln^Ss(Ia[1][0],Ia[1][1],Bi[1][0],Bi[1][1]),",",1-ln," ",Bi[1],"A",Xa,",",Xa," 0 0,",Nr," ",Bi[0]):$a.push("L",Ia[0],"A",Xa,",",Xa," 0 0,",Nr," ",Bi[0])}else $a.push("L",ka,",",la)}else $a.push("M",Un,",",ra),_a!=null&&$a.push("A",er,",",er," 0 ",yi,",",ln," ",_a,",",ia),$a.push("L",ka,",",la),Na!=null&&$a.push("A",jt,",",jt," 0 ",Ii,",",1-ln," ",Na,",",Pa);return $a.push("Z"),$a.join("")}function Pt(jt,er){return"M0,"+jt+"A"+jt+","+jt+" 0 1,"+er+" 0,"+-jt+"A"+jt+","+jt+" 0 1,"+er+" 0,"+jt}return ht.innerRadius=function(jt){return arguments.length?(le=et(jt),ht):le},ht.outerRadius=function(jt){return arguments.length?(_e=et(jt),ht):_e},ht.cornerRadius=function(jt){return arguments.length?(Le=et(jt),ht):Le},ht.padRadius=function(jt){return arguments.length?(Be=jt==Ja?Ja:et(jt),ht):Be},ht.startAngle=function(jt){return arguments.length?(Oe=et(jt),ht):Oe},ht.endAngle=function(jt){return arguments.length?(Ke=et(jt),ht):Ke},ht.padAngle=function(jt){return arguments.length?(xt=et(jt),ht):xt},ht.centroid=function(){var jt=(+le.apply(this,arguments)+ +_e.apply(this,arguments))/2,er=(+Oe.apply(this,arguments)+ +Ke.apply(this,arguments))/2-Qe;return[Math.cos(er)*jt,Math.sin(er)*jt]},ht};var Ja="auto";function va(le){return le.innerRadius}function xi(le){return le.outerRadius}function uo(le){return le.startAngle}function po(le){return le.endAngle}function ss(le){return le&&le.padAngle}function Ss(le,_e,Le,Be){return(le-Le)*_e-(_e-Be)*le>0?0:1}function zo(le,_e,Le,Be,Oe){var Ke=le[0]-_e[0],xt=le[1]-_e[1],ht=(Oe?Be:-Be)/Math.sqrt(Ke*Ke+xt*xt),Pt=ht*xt,jt=-ht*Ke,er=le[0]+Pt,tr=le[1]+jt,Ar=_e[0]+Pt,Qr=_e[1]+jt,ln=(er+Ar)/2,Lr=(tr+Qr)/2,Nr=Ar-er,Zr=Qr-tr,nn=Nr*Nr+Zr*Zr,on=Le-Be,Kr=er*Qr-Ar*tr,Un=(Zr<0?-1:1)*Math.sqrt(Math.max(0,on*on*nn-Kr*Kr)),ra=(Kr*Zr-Nr*Un)/nn,_a=(-Kr*Nr-Zr*Un)/nn,ia=(Kr*Zr+Nr*Un)/nn,ka=(-Kr*Nr+Zr*Un)/nn,la=ra-ln,Na=_a-Lr,Pa=ia-ln,$a=ka-Lr;return la*la+Na*Na>Pa*Pa+$a*$a&&(ra=ia,_a=ka),[[ra-Pt,_a-jt],[ra*Le/on,_a*Le/on]]}function Js(){return!0}function ys(le){var _e=Vn,Le=pa,Be=Js,Oe=xo,Ke=Oe.key,xt=.7;function ht(Pt){var jt=[],er=[],tr=-1,Ar=Pt.length,Qr,ln=et(_e),Lr=et(Le);function Nr(){jt.push("M",Oe(le(er),xt))}for(;++tr<Ar;)Be.call(this,Qr=Pt[tr],tr)?er.push([+ln.call(this,Qr,tr),+Lr.call(this,Qr,tr)]):er.length&&(Nr(),er=[]);return er.length&&Nr(),jt.length?jt.join(""):null}return ht.x=function(Pt){return arguments.length?(_e=Pt,ht):_e},ht.y=function(Pt){return arguments.length?(Le=Pt,ht):Le},ht.defined=function(Pt){return arguments.length?(Be=Pt,ht):Be},ht.interpolate=function(Pt){return arguments.length?(typeof Pt=="function"?Ke=Oe=Pt:Ke=(Oe=ls.get(Pt)||xo).key,ht):Ke},ht.tension=function(Pt){return arguments.length?(xt=Pt,ht):xt},ht}A.svg.line=function(){return ys(D)};var ls=A.map({linear:xo,"linear-closed":Bl,step:Ql,"step-before":us,"step-after":du,basis:ks,"basis-open":Xu,"basis-closed":Ru,bundle:Iu,cardinal:Pu,"cardinal-open":Nl,"cardinal-closed":vf,monotone:We});ls.forEach(function(le,_e){_e.key=le,_e.closed=/-closed$/.test(le)});function xo(le){return le.length>1?le.join("L"):le+"Z"}function Bl(le){return le.join("L")+"Z"}function Ql(le){for(var _e=0,Le=le.length,Be=le[0],Oe=[Be[0],",",Be[1]];++_e<Le;)Oe.push("H",(Be[0]+(Be=le[_e])[0])/2,"V",Be[1]);return Le>1&&Oe.push("H",Be[0]),Oe.join("")}function us(le){for(var _e=0,Le=le.length,Be=le[0],Oe=[Be[0],",",Be[1]];++_e<Le;)Oe.push("V",(Be=le[_e])[1],"H",Be[0]);return Oe.join("")}function du(le){for(var _e=0,Le=le.length,Be=le[0],Oe=[Be[0],",",Be[1]];++_e<Le;)Oe.push("H",(Be=le[_e])[0],"V",Be[1]);return Oe.join("")}function Nl(le,_e){return le.length<4?xo(le):le[1]+gu(le.slice(1,-1),Du(le,_e))}function vf(le,_e){return le.length<3?Bl(le):le[0]+gu((le.push(le[0]),le),Du([le[le.length-2]].concat(le,[le[1]]),_e))}function Pu(le,_e){return le.length<3?xo(le):le[0]+gu(le,Du(le,_e))}function gu(le,_e){if(_e.length<1||le.length!=_e.length&&le.length!=_e.length+2)return xo(le);var Le=le.length!=_e.length,Be="",Oe=le[0],Ke=le[1],xt=_e[0],ht=xt,Pt=1;if(Le&&(Be+="Q"+(Ke[0]-xt[0]*2/3)+","+(Ke[1]-xt[1]*2/3)+","+Ke[0]+","+Ke[1],Oe=le[1],Pt=2),_e.length>1){ht=_e[1],Ke=le[Pt],Pt++,Be+="C"+(Oe[0]+xt[0])+","+(Oe[1]+xt[1])+","+(Ke[0]-ht[0])+","+(Ke[1]-ht[1])+","+Ke[0]+","+Ke[1];for(var jt=2;jt<_e.length;jt++,Pt++)Ke=le[Pt],ht=_e[jt],Be+="S"+(Ke[0]-ht[0])+","+(Ke[1]-ht[1])+","+Ke[0]+","+Ke[1]}if(Le){var er=le[Pt];Be+="Q"+(Ke[0]+ht[0]*2/3)+","+(Ke[1]+ht[1]*2/3)+","+er[0]+","+er[1]}return Be}function Du(le,_e){for(var Le=[],Be=(1-_e)/2,Oe,Ke=le[0],xt=le[1],ht=1,Pt=le.length;++ht<Pt;)Oe=Ke,Ke=xt,xt=le[ht],Le.push([Be*(xt[0]-Oe[0]),Be*(xt[1]-Oe[1])]);return Le}function ks(le){if(le.length<3)return xo(le);var _e=1,Le=le.length,Be=le[0],Oe=Be[0],Ke=Be[1],xt=[Oe,Oe,Oe,(Be=le[1])[0]],ht=[Ke,Ke,Ke,Be[1]],Pt=[Oe,",",Ke,"L",Fo(ms,xt),",",Fo(ms,ht)];for(le.push(le[Le-1]);++_e<=Le;)Be=le[_e],xt.shift(),xt.push(Be[0]),ht.shift(),ht.push(Be[1]),yu(Pt,xt,ht);return le.pop(),Pt.push("L",Be),Pt.join("")}function Xu(le){if(le.length<4)return xo(le);for(var _e=[],Le=-1,Be=le.length,Oe,Ke=[0],xt=[0];++Le<3;)Oe=le[Le],Ke.push(Oe[0]),xt.push(Oe[1]);for(_e.push(Fo(ms,Ke)+","+Fo(ms,xt)),--Le;++Le<Be;)Oe=le[Le],Ke.shift(),Ke.push(Oe[0]),xt.shift(),xt.push(Oe[1]),yu(_e,Ke,xt);return _e.join("")}function Ru(le){for(var _e,Le=-1,Be=le.length,Oe=Be+4,Ke,xt=[],ht=[];++Le<4;)Ke=le[Le%Be],xt.push(Ke[0]),ht.push(Ke[1]);for(_e=[Fo(ms,xt),",",Fo(ms,ht)],--Le;++Le<Oe;)Ke=le[Le%Be],xt.shift(),xt.push(Ke[0]),ht.shift(),ht.push(Ke[1]),yu(_e,xt,ht);return _e.join("")}function Iu(le,_e){var Le=le.length-1;if(Le)for(var Be=le[0][0],Oe=le[0][1],Ke=le[Le][0]-Be,xt=le[Le][1]-Oe,ht=-1,Pt,jt;++ht<=Le;)Pt=le[ht],jt=ht/Le,Pt[0]=_e*Pt[0]+(1-_e)*(Be+jt*Ke),Pt[1]=_e*Pt[1]+(1-_e)*(Oe+jt*xt);return ks(le)}function Fo(le,_e){return le[0]*_e[0]+le[1]*_e[1]+le[2]*_e[2]+le[3]*_e[3]}var zu=[0,2/3,1/3,0],$u=[0,1/3,2/3,0],ms=[0,1/6,2/3,1/6];function yu(le,_e,Le){le.push("C",Fo(zu,_e),",",Fo(zu,Le),",",Fo($u,_e),",",Fo($u,Le),",",Fo(ms,_e),",",Fo(ms,Le))}function mu(le,_e){return(_e[1]-le[1])/(_e[0]-le[0])}function Fu(le){for(var _e=0,Le=le.length-1,Be=[],Oe=le[0],Ke=le[1],xt=Be[0]=mu(Oe,Ke);++_e<Le;)Be[_e]=(xt+(xt=mu(Oe=Ke,Ke=le[_e+1])))/2;return Be[_e]=xt,Be}function ze(le){for(var _e=[],Le,Be,Oe,Ke,xt=Fu(le),ht=-1,Pt=le.length-1;++ht<Pt;)Le=mu(le[ht],le[ht+1]),o(Le)<tt?xt[ht]=xt[ht+1]=0:(Be=xt[ht]/Le,Oe=xt[ht+1]/Le,Ke=Be*Be+Oe*Oe,Ke>9&&(Ke=Le*3/Math.sqrt(Ke),xt[ht]=Ke*Be,xt[ht+1]=Ke*Oe));for(ht=-1;++ht<=Pt;)Ke=(le[Math.min(Pt,ht+1)][0]-le[Math.max(0,ht-1)][0])/(6*(1+xt[ht]*xt[ht])),_e.push([Ke||0,xt[ht]*Ke||0]);return _e}function We(le){return le.length<3?xo(le):le[0]+gu(le,ze(le))}A.svg.line.radial=function(){var le=ys(qe);return le.radius=le.x,delete le.x,le.angle=le.y,delete le.y,le};function qe(le){for(var _e,Le=-1,Be=le.length,Oe,Ke;++Le<Be;)_e=le[Le],Oe=_e[0],Ke=_e[1]-Qe,_e[0]=Oe*Math.cos(Ke),_e[1]=Oe*Math.sin(Ke);return le}function ot(le){var _e=Vn,Le=Vn,Be=0,Oe=pa,Ke=Js,xt=xo,ht=xt.key,Pt=xt,jt="L",er=.7;function tr(Ar){var Qr=[],ln=[],Lr=[],Nr=-1,Zr=Ar.length,nn,on=et(_e),Kr=et(Be),Un=_e===Le?function(){return _a}:et(Le),ra=Be===Oe?function(){return ia}:et(Oe),_a,ia;function ka(){Qr.push("M",xt(le(Lr),er),jt,Pt(le(ln.reverse()),er),"Z")}for(;++Nr<Zr;)Ke.call(this,nn=Ar[Nr],Nr)?(ln.push([_a=+on.call(this,nn,Nr),ia=+Kr.call(this,nn,Nr)]),Lr.push([+Un.call(this,nn,Nr),+ra.call(this,nn,Nr)])):ln.length&&(ka(),ln=[],Lr=[]);return ln.length&&ka(),Qr.length?Qr.join(""):null}return tr.x=function(Ar){return arguments.length?(_e=Le=Ar,tr):Le},tr.x0=function(Ar){return arguments.length?(_e=Ar,tr):_e},tr.x1=function(Ar){return arguments.length?(Le=Ar,tr):Le},tr.y=function(Ar){return arguments.length?(Be=Oe=Ar,tr):Oe},tr.y0=function(Ar){return arguments.length?(Be=Ar,tr):Be},tr.y1=function(Ar){return arguments.length?(Oe=Ar,tr):Oe},tr.defined=function(Ar){return arguments.length?(Ke=Ar,tr):Ke},tr.interpolate=function(Ar){return arguments.length?(typeof Ar=="function"?ht=xt=Ar:ht=(xt=ls.get(Ar)||xo).key,Pt=xt.reverse||xt,jt=xt.closed?"M":"L",tr):ht},tr.tension=function(Ar){return arguments.length?(er=Ar,tr):er},tr}us.reverse=du,du.reverse=us,A.svg.area=function(){return ot(D)},A.svg.area.radial=function(){var le=ot(qe);return le.radius=le.x,delete le.x,le.innerRadius=le.x0,delete le.x0,le.outerRadius=le.x1,delete le.x1,le.angle=le.y,delete le.y,le.startAngle=le.y0,delete le.y0,le.endAngle=le.y1,delete le.y1,le};function _t(le){return le.source}function mt(le){return le.target}A.svg.chord=function(){var le=_t,_e=mt,Le=Et,Be=uo,Oe=po;function Ke(er,tr){var Ar=xt(this,le,er,tr),Qr=xt(this,_e,er,tr);return"M"+Ar.p0+Pt(Ar.r,Ar.p1,Ar.a1-Ar.a0)+(ht(Ar,Qr)?jt(Ar.r,Ar.p1,Ar.r,Ar.p0):jt(Ar.r,Ar.p1,Qr.r,Qr.p0)+Pt(Qr.r,Qr.p1,Qr.a1-Qr.a0)+jt(Qr.r,Qr.p1,Ar.r,Ar.p0))+"Z"}function xt(er,tr,Ar,Qr){var ln=tr.call(er,Ar,Qr),Lr=Le.call(er,ln,Qr),Nr=Be.call(er,ln,Qr)-Qe,Zr=Oe.call(er,ln,Qr)-Qe;return{r:Lr,a0:Nr,a1:Zr,p0:[Lr*Math.cos(Nr),Lr*Math.sin(Nr)],p1:[Lr*Math.cos(Zr),Lr*Math.sin(Zr)]}}function ht(er,tr){return er.a0==tr.a0&&er.a1==tr.a1}function Pt(er,tr,Ar){return"A"+er+","+er+" 0 "+ +(Ar>Ae)+",1 "+tr}function jt(er,tr,Ar,Qr){return"Q 0,0 "+Qr}return Ke.radius=function(er){return arguments.length?(Le=et(er),Ke):Le},Ke.source=function(er){return arguments.length?(le=et(er),Ke):le},Ke.target=function(er){return arguments.length?(_e=et(er),Ke):_e},Ke.startAngle=function(er){return arguments.length?(Be=et(er),Ke):Be},Ke.endAngle=function(er){return arguments.length?(Oe=et(er),Ke):Oe},Ke};function Et(le){return le.radius}A.svg.diagonal=function(){var le=_t,_e=mt,Le=fr;function Be(Oe,Ke){var xt=le.call(this,Oe,Ke),ht=_e.call(this,Oe,Ke),Pt=(xt.y+ht.y)/2,jt=[xt,{x:xt.x,y:Pt},{x:ht.x,y:Pt},ht];return jt=jt.map(Le),"M"+jt[0]+"C"+jt[1]+" "+jt[2]+" "+jt[3]}return Be.source=function(Oe){return arguments.length?(le=et(Oe),Be):le},Be.target=function(Oe){return arguments.length?(_e=et(Oe),Be):_e},Be.projection=function(Oe){return arguments.length?(Le=Oe,Be):Le},Be};function fr(le){return[le.x,le.y]}A.svg.diagonal.radial=function(){var le=A.svg.diagonal(),_e=fr,Le=le.projection;return le.projection=function(Be){return arguments.length?Le(pr(_e=Be)):_e},le};function pr(le){return function(){var _e=le.apply(this,arguments),Le=_e[0],Be=_e[1]-Qe;return[Le*Math.cos(Be),Le*Math.sin(Be)]}}A.svg.symbol=function(){var le=xr,_e=lr;function Le(Be,Oe){return(Xr.get(le.call(this,Be,Oe))||Pr)(_e.call(this,Be,Oe))}return Le.type=function(Be){return arguments.length?(le=et(Be),Le):le},Le.size=function(Be){return arguments.length?(_e=et(Be),Le):_e},Le};function lr(){return 64}function xr(){return"circle"}function Pr(le){var _e=Math.sqrt(le/Ae);return"M0,"+_e+"A"+_e+","+_e+" 0 1,1 0,"+-_e+"A"+_e+","+_e+" 0 1,1 0,"+_e+"Z"}var Xr=A.map({circle:Pr,cross:function(le){var _e=Math.sqrt(le/5)/2;return"M"+-3*_e+","+-_e+"H"+-_e+"V"+-3*_e+"H"+_e+"V"+-_e+"H"+3*_e+"V"+_e+"H"+_e+"V"+3*_e+"H"+-_e+"V"+_e+"H"+-3*_e+"Z"},diamond:function(le){var _e=Math.sqrt(le/(2*bn)),Le=_e*bn;return"M0,"+-_e+"L"+Le+",0 0,"+_e+" "+-Le+",0Z"},square:function(le){var _e=Math.sqrt(le)/2;return"M"+-_e+","+-_e+"L"+_e+","+-_e+" "+_e+","+_e+" "+-_e+","+_e+"Z"},"triangle-down":function(le){var _e=Math.sqrt(le/qr),Le=_e*qr/2;return"M0,"+Le+"L"+_e+","+-Le+" "+-_e+","+-Le+"Z"},"triangle-up":function(le){var _e=Math.sqrt(le/qr),Le=_e*qr/2;return"M0,"+-Le+"L"+_e+","+Le+" "+-_e+","+Le+"Z"}});A.svg.symbolTypes=Xr.keys();var qr=Math.sqrt(3),bn=Math.tan(30*bt);ne.transition=function(le){for(var _e=Ya||++Ka,Le=ri(le),Be=[],Oe,Ke,xt=ei||{time:Date.now(),ease:Is,delay:0,duration:250},ht=-1,Pt=this.length;++ht<Pt;){Be.push(Oe=[]);for(var jt=this[ht],er=-1,tr=jt.length;++er<tr;)(Ke=jt[er])&&Vi(Ke,er,Le,_e,xt),Oe.push(Ke)}return ga(Be,Le,_e)},ne.interrupt=function(le){return this.each(le==null?Dn:Wn(ri(le)))};var Dn=Wn(ri());function Wn(le){return function(){var _e,Le,Be;(_e=this[le])&&(Be=_e[Le=_e.active])&&(Be.timer.c=null,Be.timer.t=NaN,--_e.count?delete _e[Le]:delete this[le],_e.active+=.5,Be.event&&Be.event.interrupt.call(this,this.__data__,Be.index))}}function ga(le,_e,Le){return j(le,xa),le.namespace=_e,le.id=Le,le}var xa=[],Ka=0,Ya,ei;xa.call=ne.call,xa.empty=ne.empty,xa.node=ne.node,xa.size=ne.size,A.transition=function(le,_e){return le&&le.transition?Ya?le.transition(_e):le:A.selection().transition(le)},A.transition.prototype=xa,xa.select=function(le){var _e=this.id,Le=this.namespace,Be=[],Oe,Ke,xt;le=X(le);for(var ht=-1,Pt=this.length;++ht<Pt;){Be.push(Oe=[]);for(var jt=this[ht],er=-1,tr=jt.length;++er<tr;)(xt=jt[er])&&(Ke=le.call(xt,xt.__data__,er,ht))?("__data__"in xt&&(Ke.__data__=xt.__data__),Vi(Ke,er,Le,_e,xt[Le][_e]),Oe.push(Ke)):Oe.push(null)}return ga(Be,Le,_e)},xa.selectAll=function(le){var _e=this.id,Le=this.namespace,Be=[],Oe,Ke,xt,ht,Pt;le=Q(le);for(var jt=-1,er=this.length;++jt<er;)for(var tr=this[jt],Ar=-1,Qr=tr.length;++Ar<Qr;)if(xt=tr[Ar]){Pt=xt[Le][_e],Ke=le.call(xt,xt.__data__,Ar,jt),Be.push(Oe=[]);for(var ln=-1,Lr=Ke.length;++ln<Lr;)(ht=Ke[ln])&&Vi(ht,ln,Le,_e,Pt),Oe.push(ht)}return ga(Be,Le,_e)},xa.filter=function(le){var _e=[],Le,Be,Oe;typeof le!="function"&&(le=we(le));for(var Ke=0,xt=this.length;Ke<xt;Ke++){_e.push(Le=[]);for(var Be=this[Ke],ht=0,Pt=Be.length;ht<Pt;ht++)(Oe=Be[ht])&&le.call(Oe,Oe.__data__,ht,Ke)&&Le.push(Oe)}return ga(_e,this.namespace,this.id)},xa.tween=function(le,_e){var Le=this.id,Be=this.namespace;return arguments.length<2?this.node()[Be][Le].tween.get(le):Xe(this,_e==null?function(Oe){Oe[Be][Le].tween.remove(le)}:function(Oe){Oe[Be][Le].tween.set(le,_e)})};function hi(le,_e,Le,Be){var Oe=le.id,Ke=le.namespace;return Xe(le,typeof Le=="function"?function(xt,ht,Pt){xt[Ke][Oe].tween.set(_e,Be(Le.call(xt,xt.__data__,ht,Pt)))}:(Le=Be(Le),function(xt){xt[Ke][Oe].tween.set(_e,Le)}))}xa.attr=function(le,_e){if(arguments.length<2){for(_e in le)this.attr(_e,le[_e]);return this}var Le=le=="transform"?Il:ao,Be=A.ns.qualify(le);function Oe(){this.removeAttribute(Be)}function Ke(){this.removeAttributeNS(Be.space,Be.local)}function xt(Pt){return Pt==null?Oe:(Pt+="",function(){var jt=this.getAttribute(Be),er;return jt!==Pt&&(er=Le(jt,Pt),function(tr){this.setAttribute(Be,er(tr))})})}function ht(Pt){return Pt==null?Ke:(Pt+="",function(){var jt=this.getAttributeNS(Be.space,Be.local),er;return jt!==Pt&&(er=Le(jt,Pt),function(tr){this.setAttributeNS(Be.space,Be.local,er(tr))})})}return hi(this,"attr."+le,_e,Be.local?ht:xt)},xa.attrTween=function(le,_e){var Le=A.ns.qualify(le);function Be(Ke,xt){var ht=_e.call(this,Ke,xt,this.getAttribute(Le));return ht&&function(Pt){this.setAttribute(Le,ht(Pt))}}function Oe(Ke,xt){var ht=_e.call(this,Ke,xt,this.getAttributeNS(Le.space,Le.local));return ht&&function(Pt){this.setAttributeNS(Le.space,Le.local,ht(Pt))}}return this.tween("attr."+le,Le.local?Oe:Be)},xa.style=function(le,_e,Le){var Be=arguments.length;if(Be<3){if(typeof le!="string"){Be<2&&(_e="");for(Le in le)this.style(Le,le[Le],_e);return this}Le=""}function Oe(){this.style.removeProperty(le)}function Ke(xt){return xt==null?Oe:(xt+="",function(){var ht=a(this).getComputedStyle(this,null).getPropertyValue(le),Pt;return ht!==xt&&(Pt=ao(ht,xt),function(jt){this.style.setProperty(le,Pt(jt),Le)})})}return hi(this,"style."+le,_e,Ke)},xa.styleTween=function(le,_e,Le){arguments.length<3&&(Le="");function Be(Oe,Ke){var xt=_e.call(this,Oe,Ke,a(this).getComputedStyle(this,null).getPropertyValue(le));return xt&&function(ht){this.style.setProperty(le,xt(ht),Le)}}return this.tween("style."+le,Be)},xa.text=function(le){return hi(this,"text",le,io)};function io(le){return le==null&&(le=""),function(){this.textContent=le}}xa.remove=function(){var le=this.namespace;return this.each("end.transition",function(){var _e;this[le].count<2&&(_e=this.parentNode)&&_e.removeChild(this)})},xa.ease=function(le){var _e=this.id,Le=this.namespace;return arguments.length<1?this.node()[Le][_e].ease:(typeof le!="function"&&(le=A.ease.apply(A,arguments)),Xe(this,function(Be){Be[Le][_e].ease=le}))},xa.delay=function(le){var _e=this.id,Le=this.namespace;return arguments.length<1?this.node()[Le][_e].delay:Xe(this,typeof le=="function"?function(Be,Oe,Ke){Be[Le][_e].delay=+le.call(Be,Be.__data__,Oe,Ke)}:(le=+le,function(Be){Be[Le][_e].delay=le}))},xa.duration=function(le){var _e=this.id,Le=this.namespace;return arguments.length<1?this.node()[Le][_e].duration:Xe(this,typeof le=="function"?function(Be,Oe,Ke){Be[Le][_e].duration=Math.max(1,le.call(Be,Be.__data__,Oe,Ke))}:(le=Math.max(1,le),function(Be){Be[Le][_e].duration=le}))},xa.each=function(le,_e){var Le=this.id,Be=this.namespace;if(arguments.length<2){var Oe=ei,Ke=Ya;try{Ya=Le,Xe(this,function(xt,ht,Pt){ei=xt[Be][Le],le.call(xt,xt.__data__,ht,Pt)})}finally{ei=Oe,Ya=Ke}}else Xe(this,function(xt){var ht=xt[Be][Le];(ht.event||(ht.event=A.dispatch("start","end","interrupt"))).on(le,_e)});return this},xa.transition=function(){for(var le=this.id,_e=++Ka,Le=this.namespace,Be=[],Oe,Ke,xt,ht,Pt=0,jt=this.length;Pt<jt;Pt++){Be.push(Oe=[]);for(var Ke=this[Pt],er=0,tr=Ke.length;er<tr;er++)(xt=Ke[er])&&(ht=xt[Le][le],Vi(xt,er,Le,_e,{time:ht.time,ease:ht.ease,delay:ht.delay+ht.duration,duration:ht.duration})),Oe.push(xt)}return ga(Be,Le,_e)};function ri(le){return le==null?"__transition__":"__transition_"+le+"__"}function Vi(le,_e,Le,Be,Oe){var Ke=le[Le]||(le[Le]={active:0,count:0}),xt=Ke[Be],ht,Pt,jt,er,tr;function Ar(Lr){var Nr=xt.delay;if(Pt.t=Nr+ht,Nr<=Lr)return Qr(Lr-Nr);Pt.c=Qr}function Qr(Lr){var Nr=Ke.active,Zr=Ke[Nr];Zr&&(Zr.timer.c=null,Zr.timer.t=NaN,--Ke.count,delete Ke[Nr],Zr.event&&Zr.event.interrupt.call(le,le.__data__,Zr.index));for(var nn in Ke)if(+nn<Be){var on=Ke[nn];on.timer.c=null,on.timer.t=NaN,--Ke.count,delete Ke[nn]}Pt.c=ln,cn(function(){return Pt.c&&ln(Lr||1)&&(Pt.c=null,Pt.t=NaN),1},0,ht),Ke.active=Be,xt.event&&xt.event.start.call(le,le.__data__,_e),tr=[],xt.tween.forEach(function(Kr,Un){(Un=Un.call(le,le.__data__,_e))&&tr.push(Un)}),er=xt.ease,jt=xt.duration}function ln(Lr){for(var Nr=Lr/jt,Zr=er(Nr),nn=tr.length;nn>0;)tr[--nn].call(le,Zr);if(Nr>=1)return xt.event&&xt.event.end.call(le,le.__data__,_e),--Ke.count?delete Ke[Be]:delete le[Le],1}xt||(ht=Oe.time,Pt=cn(Ar,0,ht),xt=Ke[Be]={tween:new w,time:ht,timer:Pt,delay:Oe.delay,duration:Oe.duration,ease:Oe.ease,index:_e},Oe=null,++Ke.count)}A.svg.axis=function(){var le=A.scale.linear(),_e=fo,Le=6,Be=6,Oe=3,Ke=[10],xt=null,ht;function Pt(jt){jt.each(function(){var er=A.select(this),tr=this.__chart__||le,Ar=this.__chart__=le.copy(),Qr=xt??(Ar.ticks?Ar.ticks.apply(Ar,Ke):Ar.domain()),ln=ht??(Ar.tickFormat?Ar.tickFormat.apply(Ar,Ke):D),Lr=er.selectAll(".tick").data(Qr,Ar),Nr=Lr.enter().insert("g",".domain").attr("class","tick").style("opacity",tt),Zr=A.transition(Lr.exit()).style("opacity",tt).remove(),nn=A.transition(Lr.order()).style("opacity",1),on=Math.max(Le,0)+Oe,Kr,Un=tn(Ar),ra=er.selectAll(".domain").data([0]),_a=(ra.enter().append("path").attr("class","domain"),A.transition(ra));Nr.append("line"),Nr.append("text");var ia=Nr.select("line"),ka=nn.select("line"),la=Lr.select("text").text(ln),Na=Nr.select("text"),Pa=nn.select("text"),$a=_e==="top"||_e==="left"?-1:1,yi,co,Ii,fa;if(_e==="bottom"||_e==="top"?(Kr=bi,yi="x",Ii="y",co="x2",fa="y2",la.attr("dy",$a<0?"0em":".71em").style("text-anchor","middle"),_a.attr("d","M"+Un[0]+","+$a*Be+"V0H"+Un[1]+"V"+$a*Be)):(Kr=Mi,yi="y",Ii="x",co="y2",fa="x2",la.attr("dy",".32em").style("text-anchor",$a<0?"end":"start"),_a.attr("d","M"+$a*Be+","+Un[0]+"H0V"+Un[1]+"H"+$a*Be)),ia.attr(fa,$a*Le),Na.attr(Ii,$a*on),ka.attr(co,0).attr(fa,$a*Le),Pa.attr(yi,0).attr(Ii,$a*on),Ar.rangeBand){var ai=Ar,Xa=ai.rangeBand()/2;tr=Ar=function(Si){return ai(Si)+Xa}}else tr.rangeBand?tr=Ar:Zr.call(Kr,Ar,tr);Nr.call(Kr,tr,Ar),nn.call(Kr,Ar,Ar)})}return Pt.scale=function(jt){return arguments.length?(le=jt,Pt):le},Pt.orient=function(jt){return arguments.length?(_e=jt in _o?jt+"":fo,Pt):_e},Pt.ticks=function(){return arguments.length?(Ke=S(arguments),Pt):Ke},Pt.tickValues=function(jt){return arguments.length?(xt=jt,Pt):xt},Pt.tickFormat=function(jt){return arguments.length?(ht=jt,Pt):ht},Pt.tickSize=function(jt){var er=arguments.length;return er?(Le=+jt,Be=+arguments[er-1],Pt):Le},Pt.innerTickSize=function(jt){return arguments.length?(Le=+jt,Pt):Le},Pt.outerTickSize=function(jt){return arguments.length?(Be=+jt,Pt):Be},Pt.tickPadding=function(jt){return arguments.length?(Oe=+jt,Pt):Oe},Pt.tickSubdivide=function(){return arguments.length&&Pt},Pt};var fo="bottom",_o={top:1,right:1,bottom:1,left:1};function bi(le,_e,Le){le.attr("transform",function(Be){var Oe=_e(Be);return"translate("+(isFinite(Oe)?Oe:Le(Be))+",0)"})}function Mi(le,_e,Le){le.attr("transform",function(Be){var Oe=_e(Be);return"translate(0,"+(isFinite(Oe)?Oe:Le(Be))+")"})}A.svg.brush=function(){var le=re(er,"brushstart","brush","brushend"),_e=null,Le=null,Be=[0,0],Oe=[0,0],Ke,xt,ht=!0,Pt=!0,jt=go[0];function er(Lr){Lr.each(function(){var Nr=A.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",ln).on("touchstart.brush",ln),Zr=Nr.selectAll(".background").data([0]);Zr.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Nr.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var nn=Nr.selectAll(".resize").data(jt,D);nn.exit().remove(),nn.enter().append("g").attr("class",function(ra){return"resize "+ra}).style("cursor",function(ra){return fs[ra]}).append("rect").attr("x",function(ra){return/[ew]$/.test(ra)?-3:null}).attr("y",function(ra){return/^[ns]/.test(ra)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),nn.style("display",er.empty()?"none":null);var on=A.transition(Nr),Kr=A.transition(Zr),Un;_e&&(Un=tn(_e),Kr.attr("x",Un[0]).attr("width",Un[1]-Un[0]),Ar(on)),Le&&(Un=tn(Le),Kr.attr("y",Un[0]).attr("height",Un[1]-Un[0]),Qr(on)),tr(on)})}er.event=function(Lr){Lr.each(function(){var Nr=le.of(this,arguments),Zr={x:Be,y:Oe,i:Ke,j:xt},nn=this.__chart__||Zr;this.__chart__=Zr,Ya?A.select(this).transition().each("start.brush",function(){Ke=nn.i,xt=nn.j,Be=nn.x,Oe=nn.y,Nr({type:"brushstart"})}).tween("brush:brush",function(){var on=Ji(Be,Zr.x),Kr=Ji(Oe,Zr.y);return Ke=xt=null,function(Un){Be=Zr.x=on(Un),Oe=Zr.y=Kr(Un),Nr({type:"brush",mode:"resize"})}}).each("end.brush",function(){Ke=Zr.i,xt=Zr.j,Nr({type:"brush",mode:"resize"}),Nr({type:"brushend"})}):(Nr({type:"brushstart"}),Nr({type:"brush",mode:"resize"}),Nr({type:"brushend"}))})};function tr(Lr){Lr.selectAll(".resize").attr("transform",function(Nr){return"translate("+Be[+/e$/.test(Nr)]+","+Oe[+/^s/.test(Nr)]+")"})}function Ar(Lr){Lr.select(".extent").attr("x",Be[0]),Lr.selectAll(".extent,.n>rect,.s>rect").attr("width",Be[1]-Be[0])}function Qr(Lr){Lr.select(".extent").attr("y",Oe[0]),Lr.selectAll(".extent,.e>rect,.w>rect").attr("height",Oe[1]-Oe[0])}function ln(){var Lr=this,Nr=A.select(A.event.target),Zr=le.of(Lr,arguments),nn=A.select(Lr),on=Nr.datum(),Kr=!/^(n|s)$/.test(on)&&_e,Un=!/^(e|w)$/.test(on)&&Le,ra=Nr.classed("extent"),_a=Xt(Lr),ia,ka=A.mouse(Lr),la,Na=A.select(a(Lr)).on("keydown.brush",yi).on("keyup.brush",co);if(A.event.changedTouches?Na.on("touchmove.brush",Ii).on("touchend.brush",ai):Na.on("mousemove.brush",Ii).on("mouseup.brush",ai),nn.interrupt().selectAll("*").interrupt(),ra)ka[0]=Be[0]-ka[0],ka[1]=Oe[0]-ka[1];else if(on){var Pa=+/w$/.test(on),$a=+/^n/.test(on);la=[Be[1-Pa]-ka[0],Oe[1-$a]-ka[1]],ka[0]=Be[Pa],ka[1]=Oe[$a]}else A.event.altKey&&(ia=ka.slice());nn.style("pointer-events","none").selectAll(".resize").style("display",null),A.select("body").style("cursor",Nr.style("cursor")),Zr({type:"brushstart"}),Ii();function yi(){A.event.keyCode==32&&(ra||(ia=null,ka[0]-=Be[1],ka[1]-=Oe[1],ra=2),W())}function co(){A.event.keyCode==32&&ra==2&&(ka[0]+=Be[1],ka[1]+=Oe[1],ra=0,W())}function Ii(){var Xa=A.mouse(Lr),Si=!1;la&&(Xa[0]+=la[0],Xa[1]+=la[1]),ra||(A.event.altKey?(ia||(ia=[(Be[0]+Be[1])/2,(Oe[0]+Oe[1])/2]),ka[0]=Be[+(Xa[0]<ia[0])],ka[1]=Oe[+(Xa[1]<ia[1])]):ia=null),Kr&&fa(Xa,_e,0)&&(Ar(nn),Si=!0),Un&&fa(Xa,Le,1)&&(Qr(nn),Si=!0),Si&&(tr(nn),Zr({type:"brush",mode:ra?"move":"resize"}))}function fa(Xa,Si,si){var oo=tn(Si),Qi=oo[0],yo=oo[1],Yo=ka[si],Oo=si?Oe:Be,Wo=Oo[1]-Oo[0],Gi,Bi;if(ra&&(Qi-=Yo,yo-=Wo+Yo),Gi=(si?Pt:ht)?Math.max(Qi,Math.min(yo,Xa[si])):Xa[si],ra?Bi=(Gi+=Yo)+Wo:(ia&&(Yo=Math.max(Qi,Math.min(yo,2*ia[si]-Gi))),Yo<Gi?(Bi=Gi,Gi=Yo):Bi=Yo),Oo[0]!=Gi||Oo[1]!=Bi)return si?xt=null:Ke=null,Oo[0]=Gi,Oo[1]=Bi,!0}function ai(){Ii(),nn.style("pointer-events","all").selectAll(".resize").style("display",er.empty()?"none":null),A.select("body").style("cursor",null),Na.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),_a(),Zr({type:"brushend"})}}return er.x=function(Lr){return arguments.length?(_e=Lr,jt=go[!_e<<1|!Le],er):_e},er.y=function(Lr){return arguments.length?(Le=Lr,jt=go[!_e<<1|!Le],er):Le},er.clamp=function(Lr){return arguments.length?(_e&&Le?(ht=!!Lr[0],Pt=!!Lr[1]):_e?ht=!!Lr:Le&&(Pt=!!Lr),er):_e&&Le?[ht,Pt]:_e?ht:Le?Pt:null},er.extent=function(Lr){var Nr,Zr,nn,on,Kr;return arguments.length?(_e&&(Nr=Lr[0],Zr=Lr[1],Le&&(Nr=Nr[0],Zr=Zr[0]),Ke=[Nr,Zr],_e.invert&&(Nr=_e(Nr),Zr=_e(Zr)),Zr<Nr&&(Kr=Nr,Nr=Zr,Zr=Kr),(Nr!=Be[0]||Zr!=Be[1])&&(Be=[Nr,Zr])),Le&&(nn=Lr[0],on=Lr[1],_e&&(nn=nn[1],on=on[1]),xt=[nn,on],Le.invert&&(nn=Le(nn),on=Le(on)),on<nn&&(Kr=nn,nn=on,on=Kr),(nn!=Oe[0]||on!=Oe[1])&&(Oe=[nn,on])),er):(_e&&(Ke?(Nr=Ke[0],Zr=Ke[1]):(Nr=Be[0],Zr=Be[1],_e.invert&&(Nr=_e.invert(Nr),Zr=_e.invert(Zr)),Zr<Nr&&(Kr=Nr,Nr=Zr,Zr=Kr))),Le&&(xt?(nn=xt[0],on=xt[1]):(nn=Oe[0],on=Oe[1],Le.invert&&(nn=Le.invert(nn),on=Le.invert(on)),on<nn&&(Kr=nn,nn=on,on=Kr))),_e&&Le?[[Nr,nn],[Zr,on]]:_e?[Nr,Zr]:Le&&[nn,on])},er.clear=function(){return er.empty()||(Be=[0,0],Oe=[0,0],Ke=xt=null),er},er.empty=function(){return!!_e&&Be[0]==Be[1]||!!Le&&Oe[0]==Oe[1]},A.rebind(er,le,"on")};var fs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},go=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];A.text=Lt(function(le){return le.responseText}),A.json=function(le,_e){return Zt(le,"application/json",Po,_e)};function Po(le){return JSON.parse(le.responseText)}A.html=function(le,_e){return Zt(le,"text/html",Go,_e)};function Go(le){var _e=M.createRange();return _e.selectNode(M.body),_e.createContextualFragment(le.responseText)}A.xml=Lt(function(le){return le.responseXML}),typeof ee=="object"&&ee.exports?ee.exports=A:this.d3=A}).apply(self)},{}],59:[function(y,ee,te){ee.exports=y("./quad")},{"./quad":60}],60:[function(y,ee,te){var A=y("binary-search-bounds"),g=y("clamp"),S=y("parse-rect"),M=y("array-bounds"),e=y("pick-by-alias"),a=y("defined"),n=y("flatten-vertex-data"),r=y("is-obj"),t=y("dtype"),h=y("math-log2"),s=1073741824;ee.exports=function(p,v){v||(v={}),p=n(p,"float64"),v=e(v,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var f=a(v.maxDepth,255),d=a(v.bounds,M(p,2));d[0]===d[2]&&d[2]++,d[1]===d[3]&&d[3]++;var o=i(p,d),m=p.length>>>1,l;v.dtype||(v.dtype="array"),typeof v.dtype=="string"?l=new(t(v.dtype))(m):v.dtype&&(l=v.dtype,Array.isArray(l)&&(l.length=m));for(var w=0;w<m;++w)l[w]=w;var _=[],c=[],b=[],u=[];D(0,0,1,l,0,1);for(var L=0,T=0;T<_.length;T++){var k=_[T];if(l.set)l.set(k,L);else for(var P=0,z=k.length;P<z;P++)l[P+L]=k[P];var I=L+_[T].length;u[T]=[L,I],L=I}return l.range=R,l;function D(N,G,K,W,Y,re){if(!W.length)return null;var ue=_[Y]||(_[Y]=[]),j=b[Y]||(b[Y]=[]),q=c[Y]||(c[Y]=[]),H=ue.length;if(Y++,Y>f||re>s){for(var U=0;U<W.length;U++)ue.push(W[U]),j.push(re),q.push(null,null,null,null);return H}if(ue.push(W[0]),j.push(re),W.length<=1)return q.push(null,null,null,null),H;for(var $=K*.5,ne=N+$,X=G+$,Q=[],ie=[],se=[],ae=[],oe=1,be=W.length;oe<be;oe++){var ce=W[oe],de=o[ce*2],ye=o[ce*2+1];de<ne?ye<X?Q.push(ce):ie.push(ce):ye<X?se.push(ce):ae.push(ce)}return re<<=2,q.push(D(N,G,$,Q,Y,re),D(N,X,$,ie,Y,re+1),D(ne,G,$,se,Y,re+2),D(ne,X,$,ae,Y,re+3)),H}function R(){for(var N=[],G=arguments.length;G--;)N[G]=arguments[G];var K;if(r(N[N.length-1])){var W=N.pop();!N.length&&(W.x!=null||W.l!=null||W.left!=null)&&(N=[W],K={}),K=e(W,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else K={};N.length||(N=d);var Y=S.apply(void 0,N),re=[Math.min(Y.x,Y.x+Y.width),Math.min(Y.y,Y.y+Y.height),Math.max(Y.x,Y.x+Y.width),Math.max(Y.y,Y.y+Y.height)],ue=re[0],j=re[1],q=re[2],H=re[3],U=i([ue,j,q,H],d),$=U[0],ne=U[1],X=U[2],Q=U[3],ie=a(K.level,_.length);if(K.d!=null){var se;typeof K.d=="number"?se=[K.d,K.d]:K.d.length&&(se=K.d),ie=Math.min(Math.max(Math.ceil(-h(Math.abs(se[0])/(d[2]-d[0]))),Math.ceil(-h(Math.abs(se[1])/(d[3]-d[1])))),ie)}if(ie=Math.min(ie,_.length),K.lod)return O($,ne,X,Q,ie);var ae=[];oe(0,0,1,0,0,1);function oe(ce,de,ye,ge,me,Ee){if(!(me===null||Ee===null)){var Pe=ce+ye,Ue=de+ye;if(!($>Pe||ne>Ue||X<ce||Q<de)&&!(ge>=ie)&&me!==Ee){var we=_[ge];Ee===void 0&&(Ee=we.length);for(var ke=me;ke<Ee;ke++){var Xe=we[ke],Ve=p[Xe*2],Ie=p[Xe*2+1];Ve>=ue&&Ve<=q&&Ie>=j&&Ie<=H&&ae.push(Xe)}var De=c[ge],Ye=De[me*4+0],vt=De[me*4+1],Dt=De[me*4+2],Kt=De[me*4+3],Ft=be(De,me+1),Mt=ye*.5,Xt=ge+1;oe(ce,de,Mt,Xt,Ye,vt||Dt||Kt||Ft),oe(ce,de+Mt,Mt,Xt,vt,Dt||Kt||Ft),oe(ce+Mt,de,Mt,Xt,Dt,Kt||Ft),oe(ce+Mt,de+Mt,Mt,Xt,Kt,Ft)}}}function be(ce,de){for(var ye=null,ge=0;ye===null;)if(ye=ce[de*4+ge],ge++,ge>ce.length)return null;return ye}return ae}function O(N,G,K,W,Y){for(var re=[],ue=0;ue<Y;ue++){var j=b[ue],q=u[ue][0],H=F(N,G,ue),U=F(K,W,ue),$=A.ge(j,H),ne=A.gt(j,U,$,j.length-1);re[ue]=[$+q,ne+q]}return re}function F(N,G,K){for(var W=1,Y=.5,re=.5,ue=.5,j=0;j<K;j++)W<<=2,W+=N<Y?G<re?0:1:G<re?2:3,ue*=.5,Y+=N<Y?-ue:ue,re+=G<re?-ue:ue;return W}};function i(x,p){for(var v=p[0],f=p[1],d=p[2],o=p[3],m=1/(d-v),l=1/(o-f),w=new Array(x.length),_=0,c=x.length/2;_<c;_++)w[2*_]=g((x[2*_]-v)*m,0,1),w[2*_+1]=g((x[2*_+1]-f)*l,0,1);return w}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(y,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=y("@turf/meta"),g=6378137;function S(r){return A.geomReduce(r,function(t,h){return t+M(h)},0)}te.default=S;function M(r){var t=0,h;switch(r.type){case"Polygon":return e(r.coordinates);case"MultiPolygon":for(h=0;h<r.coordinates.length;h++)t+=e(r.coordinates[h]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function e(r){var t=0;if(r&&r.length>0){t+=Math.abs(a(r[0]));for(var h=1;h<r.length;h++)t-=Math.abs(a(r[h]))}return t}function a(r){var t,h,s,i,x,p,v,f=0,d=r.length;if(d>2){for(v=0;v<d;v++)v===d-2?(i=d-2,x=d-1,p=0):v===d-1?(i=d-1,x=0,p=1):(i=v,x=v+1,p=v+2),t=r[i],h=r[x],s=r[p],f+=(n(s[0])-n(t[0]))*Math.sin(n(h[1]));f=f*g*g/2}return f}function n(r){return r*Math.PI/180}},{"@turf/meta":63}],62:[function(y,ee,te){Object.defineProperty(te,"__esModule",{value:!0}),te.earthRadius=63710088e-1,te.factors={centimeters:te.earthRadius*100,centimetres:te.earthRadius*100,degrees:te.earthRadius/111325,feet:te.earthRadius*3.28084,inches:te.earthRadius*39.37,kilometers:te.earthRadius/1e3,kilometres:te.earthRadius/1e3,meters:te.earthRadius,metres:te.earthRadius,miles:te.earthRadius/1609.344,millimeters:te.earthRadius*1e3,millimetres:te.earthRadius*1e3,nauticalmiles:te.earthRadius/1852,radians:1,yards:te.earthRadius*1.0936},te.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/te.earthRadius,yards:1.0936133},te.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function A(T,k,P){P===void 0&&(P={});var z={type:"Feature"};return(P.id===0||P.id)&&(z.id=P.id),P.bbox&&(z.bbox=P.bbox),z.properties=k||{},z.geometry=T,z}te.feature=A;function g(T,k,P){switch(T){case"Point":return S(k).geometry;case"LineString":return n(k).geometry;case"Polygon":return e(k).geometry;case"MultiPoint":return s(k).geometry;case"MultiLineString":return h(k).geometry;case"MultiPolygon":return i(k).geometry;default:throw new Error(T+" is invalid")}}te.geometry=g;function S(T,k,P){if(P===void 0&&(P={}),!T)throw new Error("coordinates is required");if(!Array.isArray(T))throw new Error("coordinates must be an Array");if(T.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!c(T[0])||!c(T[1]))throw new Error("coordinates must contain numbers");var z={type:"Point",coordinates:T};return A(z,k,P)}te.point=S;function M(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return S(z,k)}),P)}te.points=M;function e(T,k,P){P===void 0&&(P={});for(var z=0,I=T;z<I.length;z++){var D=I[z];if(D.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var R=0;R<D[D.length-1].length;R++)if(D[D.length-1][R]!==D[0][R])throw new Error("First and last Position are not equivalent.")}var O={type:"Polygon",coordinates:T};return A(O,k,P)}te.polygon=e;function a(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return e(z,k)}),P)}te.polygons=a;function n(T,k,P){if(P===void 0&&(P={}),T.length<2)throw new Error("coordinates must be an array of two or more positions");var z={type:"LineString",coordinates:T};return A(z,k,P)}te.lineString=n;function r(T,k,P){return P===void 0&&(P={}),t(T.map(function(z){return n(z,k)}),P)}te.lineStrings=r;function t(T,k){k===void 0&&(k={});var P={type:"FeatureCollection"};return k.id&&(P.id=k.id),k.bbox&&(P.bbox=k.bbox),P.features=T,P}te.featureCollection=t;function h(T,k,P){P===void 0&&(P={});var z={type:"MultiLineString",coordinates:T};return A(z,k,P)}te.multiLineString=h;function s(T,k,P){P===void 0&&(P={});var z={type:"MultiPoint",coordinates:T};return A(z,k,P)}te.multiPoint=s;function i(T,k,P){P===void 0&&(P={});var z={type:"MultiPolygon",coordinates:T};return A(z,k,P)}te.multiPolygon=i;function x(T,k,P){P===void 0&&(P={});var z={type:"GeometryCollection",geometries:T};return A(z,k,P)}te.geometryCollection=x;function p(T,k){if(k===void 0&&(k=0),k&&!(k>=0))throw new Error("precision must be a positive number");var P=Math.pow(10,k||0);return Math.round(T*P)/P}te.round=p;function v(T,k){k===void 0&&(k="kilometers");var P=te.factors[k];if(!P)throw new Error(k+" units is invalid");return T*P}te.radiansToLength=v;function f(T,k){k===void 0&&(k="kilometers");var P=te.factors[k];if(!P)throw new Error(k+" units is invalid");return T/P}te.lengthToRadians=f;function d(T,k){return m(f(T,k))}te.lengthToDegrees=d;function o(T){var k=T%360;return k<0&&(k+=360),k}te.bearingToAzimuth=o;function m(T){var k=T%(2*Math.PI);return k*180/Math.PI}te.radiansToDegrees=m;function l(T){var k=T%360;return k*Math.PI/180}te.degreesToRadians=l;function w(T,k,P){if(k===void 0&&(k="kilometers"),P===void 0&&(P="kilometers"),!(T>=0))throw new Error("length must be a positive number");return v(f(T,k),P)}te.convertLength=w;function _(T,k,P){if(k===void 0&&(k="meters"),P===void 0&&(P="kilometers"),!(T>=0))throw new Error("area must be a positive number");var z=te.areaFactors[k];if(!z)throw new Error("invalid original units");var I=te.areaFactors[P];if(!I)throw new Error("invalid final units");return T/z*I}te.convertArea=_;function c(T){return!isNaN(T)&&T!==null&&!Array.isArray(T)}te.isNumber=c;function b(T){return!!T&&T.constructor===Object}te.isObject=b;function u(T){if(!T)throw new Error("bbox is required");if(!Array.isArray(T))throw new Error("bbox must be an Array");if(T.length!==4&&T.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");T.forEach(function(k){if(!c(k))throw new Error("bbox must only contain numbers")})}te.validateBBox=u;function L(T){if(!T)throw new Error("id is required");if(["string","number"].indexOf(typeof T)===-1)throw new Error("id must be a number or a string")}te.validateId=L},{}],63:[function(y,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=y("@turf/helpers");function g(m,l,w){if(m!==null)for(var _,c,b,u,L,T,k,P=0,z=0,I,D=m.type,R=D==="FeatureCollection",O=D==="Feature",F=R?m.features.length:1,N=0;N<F;N++){k=R?m.features[N].geometry:O?m.geometry:m,I=k?k.type==="GeometryCollection":!1,L=I?k.geometries.length:1;for(var G=0;G<L;G++){var K=0,W=0;if(u=I?k.geometries[G]:k,u!==null){T=u.coordinates;var Y=u.type;switch(P=w&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(l(T,z,N,K,W)===!1)return!1;z++,K++;break;case"LineString":case"MultiPoint":for(_=0;_<T.length;_++){if(l(T[_],z,N,K,W)===!1)return!1;z++,Y==="MultiPoint"&&K++}Y==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(_=0;_<T.length;_++){for(c=0;c<T[_].length-P;c++){if(l(T[_][c],z,N,K,W)===!1)return!1;z++}Y==="MultiLineString"&&K++,Y==="Polygon"&&W++}Y==="Polygon"&&K++;break;case"MultiPolygon":for(_=0;_<T.length;_++){for(W=0,c=0;c<T[_].length;c++){for(b=0;b<T[_][c].length-P;b++){if(l(T[_][c][b],z,N,K,W)===!1)return!1;z++}W++}K++}break;case"GeometryCollection":for(_=0;_<u.geometries.length;_++)if(g(u.geometries[_],l,w)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function S(m,l,w,_){var c=w;return g(m,function(b,u,L,T,k){u===0&&w===void 0?c=b:c=l(c,b,u,L,T,k)},_),c}function M(m,l){var w;switch(m.type){case"FeatureCollection":for(w=0;w<m.features.length&&l(m.features[w].properties,w)!==!1;w++);break;case"Feature":l(m.properties,0);break}}function e(m,l,w){var _=w;return M(m,function(c,b){b===0&&w===void 0?_=c:_=l(_,c,b)}),_}function a(m,l){if(m.type==="Feature")l(m,0);else if(m.type==="FeatureCollection")for(var w=0;w<m.features.length&&l(m.features[w],w)!==!1;w++);}function n(m,l,w){var _=w;return a(m,function(c,b){b===0&&w===void 0?_=c:_=l(_,c,b)}),_}function r(m){var l=[];return g(m,function(w){l.push(w)}),l}function t(m,l){var w,_,c,b,u,L,T,k,P,z,I=0,D=m.type==="FeatureCollection",R=m.type==="Feature",O=D?m.features.length:1;for(w=0;w<O;w++){for(L=D?m.features[w].geometry:R?m.geometry:m,k=D?m.features[w].properties:R?m.properties:{},P=D?m.features[w].bbox:R?m.bbox:void 0,z=D?m.features[w].id:R?m.id:void 0,T=L?L.type==="GeometryCollection":!1,u=T?L.geometries.length:1,c=0;c<u;c++){if(b=T?L.geometries[c]:L,b===null){if(l(null,I,k,P,z)===!1)return!1;continue}switch(b.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(b,I,k,P,z)===!1)return!1;break}case"GeometryCollection":{for(_=0;_<b.geometries.length;_++)if(l(b.geometries[_],I,k,P,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function h(m,l,w){var _=w;return t(m,function(c,b,u,L,T){b===0&&w===void 0?_=c:_=l(_,c,b,u,L,T)}),_}function s(m,l){t(m,function(w,_,c,b,u){var L=w===null?null:w.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return l(A.feature(w,c,{bbox:b,id:u}),_,0)===!1?!1:void 0}var T;switch(L){case"MultiPoint":T="Point";break;case"MultiLineString":T="LineString";break;case"MultiPolygon":T="Polygon";break}for(var k=0;k<w.coordinates.length;k++){var P=w.coordinates[k],z={type:T,coordinates:P};if(l(A.feature(z,c),_,k)===!1)return!1}})}function i(m,l,w){var _=w;return s(m,function(c,b,u){b===0&&u===0&&w===void 0?_=c:_=l(_,c,b,u)}),_}function x(m,l){s(m,function(w,_,c){var b=0;if(w.geometry){var u=w.geometry.type;if(!(u==="Point"||u==="MultiPoint")){var L,T=0,k=0,P=0;if(g(w,function(z,I,D,R,O){if(L===void 0||_>T||R>k||O>P){L=z,T=_,k=R,P=O,b=0;return}var F=A.lineString([L,z],w.properties);if(l(F,_,c,O,b)===!1)return!1;b++,L=z})===!1)return!1}}})}function p(m,l,w){var _=w,c=!1;return x(m,function(b,u,L,T,k){c===!1&&w===void 0?_=b:_=l(_,b,u,L,T,k),c=!0}),_}function v(m,l){if(!m)throw new Error("geojson is required");s(m,function(w,_,c){if(w.geometry!==null){var b=w.geometry.type,u=w.geometry.coordinates;switch(b){case"LineString":if(l(w,_,c,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<u.length;L++)if(l(A.lineString(u[L],w.properties),_,c,L)===!1)return!1;break}}})}function f(m,l,w){var _=w;return v(m,function(c,b,u,L){b===0&&w===void 0?_=c:_=l(_,c,b,u,L)}),_}function d(m,l){if(l=l||{},!A.isObject(l))throw new Error("options is invalid");var w=l.featureIndex||0,_=l.multiFeatureIndex||0,c=l.geometryIndex||0,b=l.segmentIndex||0,u=l.properties,L;switch(m.type){case"FeatureCollection":w<0&&(w=m.features.length+w),u=u||m.features[w].properties,L=m.features[w].geometry;break;case"Feature":u=u||m.properties,L=m.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=m;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return b<0&&(b=T.length+b-1),A.lineString([T[b],T[b+1]],u,l);case"Polygon":return c<0&&(c=T.length+c),b<0&&(b=T[c].length+b-1),A.lineString([T[c][b],T[c][b+1]],u,l);case"MultiLineString":return _<0&&(_=T.length+_),b<0&&(b=T[_].length+b-1),A.lineString([T[_][b],T[_][b+1]],u,l);case"MultiPolygon":return _<0&&(_=T.length+_),c<0&&(c=T[_].length+c),b<0&&(b=T[_][c].length-b-1),A.lineString([T[_][c][b],T[_][c][b+1]],u,l)}throw new Error("geojson is invalid")}function o(m,l){if(l=l||{},!A.isObject(l))throw new Error("options is invalid");var w=l.featureIndex||0,_=l.multiFeatureIndex||0,c=l.geometryIndex||0,b=l.coordIndex||0,u=l.properties,L;switch(m.type){case"FeatureCollection":w<0&&(w=m.features.length+w),u=u||m.features[w].properties,L=m.features[w].geometry;break;case"Feature":u=u||m.properties,L=m.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=m;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":return A.point(T,u,l);case"MultiPoint":return _<0&&(_=T.length+_),A.point(T[_],u,l);case"LineString":return b<0&&(b=T.length+b),A.point(T[b],u,l);case"Polygon":return c<0&&(c=T.length+c),b<0&&(b=T[c].length+b),A.point(T[c][b],u,l);case"MultiLineString":return _<0&&(_=T.length+_),b<0&&(b=T[_].length+b),A.point(T[_][b],u,l);case"MultiPolygon":return _<0&&(_=T.length+_),c<0&&(c=T[_].length+c),b<0&&(b=T[_][c].length-b),A.point(T[_][c][b],u,l)}throw new Error("geojson is invalid")}te.coordEach=g,te.coordReduce=S,te.propEach=M,te.propReduce=e,te.featureEach=a,te.featureReduce=n,te.coordAll=r,te.geomEach=t,te.geomReduce=h,te.flattenEach=s,te.flattenReduce=i,te.segmentEach=x,te.segmentReduce=p,te.lineEach=v,te.lineReduce=f,te.findSegment=d,te.findPoint=o},{"@turf/helpers":62}],64:[function(y,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=y("@turf/meta");function g(S){var M=[1/0,1/0,-1/0,-1/0];return A.coordEach(S,function(e){M[0]>e[0]&&(M[0]=e[0]),M[1]>e[1]&&(M[1]=e[1]),M[2]<e[0]&&(M[2]=e[0]),M[3]<e[1]&&(M[3]=e[1])}),M}g.default=g,te.default=g},{"@turf/meta":66}],65:[function(y,ee,te){arguments[4][62][0].apply(te,arguments)},{dup:62}],66:[function(y,ee,te){arguments[4][63][0].apply(te,arguments)},{"@turf/helpers":65,dup:63}],67:[function(y,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=y("@turf/meta"),g=y("@turf/helpers");function S(M,e){e===void 0&&(e={});var a=0,n=0,r=0;return A.coordEach(M,function(t){a+=t[0],n+=t[1],r++}),g.point([a/r,n/r],e.properties)}te.default=S},{"@turf/helpers":68,"@turf/meta":69}],68:[function(y,ee,te){Object.defineProperty(te,"__esModule",{value:!0}),te.earthRadius=63710088e-1,te.factors={centimeters:te.earthRadius*100,centimetres:te.earthRadius*100,degrees:te.earthRadius/111325,feet:te.earthRadius*3.28084,inches:te.earthRadius*39.37,kilometers:te.earthRadius/1e3,kilometres:te.earthRadius/1e3,meters:te.earthRadius,metres:te.earthRadius,miles:te.earthRadius/1609.344,millimeters:te.earthRadius*1e3,millimetres:te.earthRadius*1e3,nauticalmiles:te.earthRadius/1852,radians:1,yards:te.earthRadius/1.0936},te.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/te.earthRadius,yards:1/1.0936},te.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function A(O,F,N){N===void 0&&(N={});var G={type:"Feature"};return(N.id===0||N.id)&&(G.id=N.id),N.bbox&&(G.bbox=N.bbox),G.properties=F||{},G.geometry=O,G}te.feature=A;function g(O,F,N){switch(O){case"Point":return S(F).geometry;case"LineString":return n(F).geometry;case"Polygon":return e(F).geometry;case"MultiPoint":return s(F).geometry;case"MultiLineString":return h(F).geometry;case"MultiPolygon":return i(F).geometry;default:throw new Error(O+" is invalid")}}te.geometry=g;function S(O,F,N){N===void 0&&(N={});var G={type:"Point",coordinates:O};return A(G,F,N)}te.point=S;function M(O,F,N){return N===void 0&&(N={}),t(O.map(function(G){return S(G,F)}),N)}te.points=M;function e(O,F,N){N===void 0&&(N={});for(var G=0,K=O;G<K.length;G++){var W=K[G];if(W.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Y=0;Y<W[W.length-1].length;Y++)if(W[W.length-1][Y]!==W[0][Y])throw new Error("First and last Position are not equivalent.")}var re={type:"Polygon",coordinates:O};return A(re,F,N)}te.polygon=e;function a(O,F,N){return N===void 0&&(N={}),t(O.map(function(G){return e(G,F)}),N)}te.polygons=a;function n(O,F,N){if(N===void 0&&(N={}),O.length<2)throw new Error("coordinates must be an array of two or more positions");var G={type:"LineString",coordinates:O};return A(G,F,N)}te.lineString=n;function r(O,F,N){return N===void 0&&(N={}),t(O.map(function(G){return n(G,F)}),N)}te.lineStrings=r;function t(O,F){F===void 0&&(F={});var N={type:"FeatureCollection"};return F.id&&(N.id=F.id),F.bbox&&(N.bbox=F.bbox),N.features=O,N}te.featureCollection=t;function h(O,F,N){N===void 0&&(N={});var G={type:"MultiLineString",coordinates:O};return A(G,F,N)}te.multiLineString=h;function s(O,F,N){N===void 0&&(N={});var G={type:"MultiPoint",coordinates:O};return A(G,F,N)}te.multiPoint=s;function i(O,F,N){N===void 0&&(N={});var G={type:"MultiPolygon",coordinates:O};return A(G,F,N)}te.multiPolygon=i;function x(O,F,N){N===void 0&&(N={});var G={type:"GeometryCollection",geometries:O};return A(G,F,N)}te.geometryCollection=x;function p(O,F){if(F===void 0&&(F=0),F&&!(F>=0))throw new Error("precision must be a positive number");var N=Math.pow(10,F||0);return Math.round(O*N)/N}te.round=p;function v(O,F){F===void 0&&(F="kilometers");var N=te.factors[F];if(!N)throw new Error(F+" units is invalid");return O*N}te.radiansToLength=v;function f(O,F){F===void 0&&(F="kilometers");var N=te.factors[F];if(!N)throw new Error(F+" units is invalid");return O/N}te.lengthToRadians=f;function d(O,F){return m(f(O,F))}te.lengthToDegrees=d;function o(O){var F=O%360;return F<0&&(F+=360),F}te.bearingToAzimuth=o;function m(O){var F=O%(2*Math.PI);return F*180/Math.PI}te.radiansToDegrees=m;function l(O){var F=O%360;return F*Math.PI/180}te.degreesToRadians=l;function w(O,F,N){if(F===void 0&&(F="kilometers"),N===void 0&&(N="kilometers"),!(O>=0))throw new Error("length must be a positive number");return v(f(O,F),N)}te.convertLength=w;function _(O,F,N){if(F===void 0&&(F="meters"),N===void 0&&(N="kilometers"),!(O>=0))throw new Error("area must be a positive number");var G=te.areaFactors[F];if(!G)throw new Error("invalid original units");var K=te.areaFactors[N];if(!K)throw new Error("invalid final units");return O/G*K}te.convertArea=_;function c(O){return!isNaN(O)&&O!==null&&!Array.isArray(O)&&!/^\s*$/.test(O)}te.isNumber=c;function b(O){return!!O&&O.constructor===Object}te.isObject=b;function u(O){if(!O)throw new Error("bbox is required");if(!Array.isArray(O))throw new Error("bbox must be an Array");if(O.length!==4&&O.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");O.forEach(function(F){if(!c(F))throw new Error("bbox must only contain numbers")})}te.validateBBox=u;function L(O){if(!O)throw new Error("id is required");if(["string","number"].indexOf(typeof O)===-1)throw new Error("id must be a number or a string")}te.validateId=L;function T(){throw new Error("method has been renamed to `radiansToDegrees`")}te.radians2degrees=T;function k(){throw new Error("method has been renamed to `degreesToRadians`")}te.degrees2radians=k;function P(){throw new Error("method has been renamed to `lengthToDegrees`")}te.distanceToDegrees=P;function z(){throw new Error("method has been renamed to `lengthToRadians`")}te.distanceToRadians=z;function I(){throw new Error("method has been renamed to `radiansToLength`")}te.radiansToDistance=I;function D(){throw new Error("method has been renamed to `bearingToAzimuth`")}te.bearingToAngle=D;function R(){throw new Error("method has been renamed to `convertLength`")}te.convertDistance=R},{}],69:[function(y,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=y("@turf/helpers");function g(m,l,w){if(m!==null)for(var _,c,b,u,L,T,k,P=0,z=0,I,D=m.type,R=D==="FeatureCollection",O=D==="Feature",F=R?m.features.length:1,N=0;N<F;N++){k=R?m.features[N].geometry:O?m.geometry:m,I=k?k.type==="GeometryCollection":!1,L=I?k.geometries.length:1;for(var G=0;G<L;G++){var K=0,W=0;if(u=I?k.geometries[G]:k,u!==null){T=u.coordinates;var Y=u.type;switch(P=w&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(l(T,z,N,K,W)===!1)return!1;z++,K++;break;case"LineString":case"MultiPoint":for(_=0;_<T.length;_++){if(l(T[_],z,N,K,W)===!1)return!1;z++,Y==="MultiPoint"&&K++}Y==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(_=0;_<T.length;_++){for(c=0;c<T[_].length-P;c++){if(l(T[_][c],z,N,K,W)===!1)return!1;z++}Y==="MultiLineString"&&K++,Y==="Polygon"&&W++}Y==="Polygon"&&K++;break;case"MultiPolygon":for(_=0;_<T.length;_++){for(W=0,c=0;c<T[_].length;c++){for(b=0;b<T[_][c].length-P;b++){if(l(T[_][c][b],z,N,K,W)===!1)return!1;z++}W++}K++}break;case"GeometryCollection":for(_=0;_<u.geometries.length;_++)if(g(u.geometries[_],l,w)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function S(m,l,w,_){var c=w;return g(m,function(b,u,L,T,k){u===0&&w===void 0?c=b:c=l(c,b,u,L,T,k)},_),c}function M(m,l){var w;switch(m.type){case"FeatureCollection":for(w=0;w<m.features.length&&l(m.features[w].properties,w)!==!1;w++);break;case"Feature":l(m.properties,0);break}}function e(m,l,w){var _=w;return M(m,function(c,b){b===0&&w===void 0?_=c:_=l(_,c,b)}),_}function a(m,l){if(m.type==="Feature")l(m,0);else if(m.type==="FeatureCollection")for(var w=0;w<m.features.length&&l(m.features[w],w)!==!1;w++);}function n(m,l,w){var _=w;return a(m,function(c,b){b===0&&w===void 0?_=c:_=l(_,c,b)}),_}function r(m){var l=[];return g(m,function(w){l.push(w)}),l}function t(m,l){var w,_,c,b,u,L,T,k,P,z,I=0,D=m.type==="FeatureCollection",R=m.type==="Feature",O=D?m.features.length:1;for(w=0;w<O;w++){for(L=D?m.features[w].geometry:R?m.geometry:m,k=D?m.features[w].properties:R?m.properties:{},P=D?m.features[w].bbox:R?m.bbox:void 0,z=D?m.features[w].id:R?m.id:void 0,T=L?L.type==="GeometryCollection":!1,u=T?L.geometries.length:1,c=0;c<u;c++){if(b=T?L.geometries[c]:L,b===null){if(l(null,I,k,P,z)===!1)return!1;continue}switch(b.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(b,I,k,P,z)===!1)return!1;break}case"GeometryCollection":{for(_=0;_<b.geometries.length;_++)if(l(b.geometries[_],I,k,P,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function h(m,l,w){var _=w;return t(m,function(c,b,u,L,T){b===0&&w===void 0?_=c:_=l(_,c,b,u,L,T)}),_}function s(m,l){t(m,function(w,_,c,b,u){var L=w===null?null:w.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return l(A.feature(w,c,{bbox:b,id:u}),_,0)===!1?!1:void 0}var T;switch(L){case"MultiPoint":T="Point";break;case"MultiLineString":T="LineString";break;case"MultiPolygon":T="Polygon";break}for(var k=0;k<w.coordinates.length;k++){var P=w.coordinates[k],z={type:T,coordinates:P};if(l(A.feature(z,c),_,k)===!1)return!1}})}function i(m,l,w){var _=w;return s(m,function(c,b,u){b===0&&u===0&&w===void 0?_=c:_=l(_,c,b,u)}),_}function x(m,l){s(m,function(w,_,c){var b=0;if(w.geometry){var u=w.geometry.type;if(!(u==="Point"||u==="MultiPoint")){var L,T=0,k=0,P=0;if(g(w,function(z,I,D,R,O){if(L===void 0||_>T||R>k||O>P){L=z,T=_,k=R,P=O,b=0;return}var F=A.lineString([L,z],w.properties);if(l(F,_,c,O,b)===!1)return!1;b++,L=z})===!1)return!1}}})}function p(m,l,w){var _=w,c=!1;return x(m,function(b,u,L,T,k){c===!1&&w===void 0?_=b:_=l(_,b,u,L,T,k),c=!0}),_}function v(m,l){if(!m)throw new Error("geojson is required");s(m,function(w,_,c){if(w.geometry!==null){var b=w.geometry.type,u=w.geometry.coordinates;switch(b){case"LineString":if(l(w,_,c,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<u.length;L++)if(l(A.lineString(u[L],w.properties),_,c,L)===!1)return!1;break}}})}function f(m,l,w){var _=w;return v(m,function(c,b,u,L){b===0&&w===void 0?_=c:_=l(_,c,b,u,L)}),_}function d(m,l){if(l=l||{},!A.isObject(l))throw new Error("options is invalid");var w=l.featureIndex||0,_=l.multiFeatureIndex||0,c=l.geometryIndex||0,b=l.segmentIndex||0,u=l.properties,L;switch(m.type){case"FeatureCollection":w<0&&(w=m.features.length+w),u=u||m.features[w].properties,L=m.features[w].geometry;break;case"Feature":u=u||m.properties,L=m.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=m;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return b<0&&(b=T.length+b-1),A.lineString([T[b],T[b+1]],u,l);case"Polygon":return c<0&&(c=T.length+c),b<0&&(b=T[c].length+b-1),A.lineString([T[c][b],T[c][b+1]],u,l);case"MultiLineString":return _<0&&(_=T.length+_),b<0&&(b=T[_].length+b-1),A.lineString([T[_][b],T[_][b+1]],u,l);case"MultiPolygon":return _<0&&(_=T.length+_),c<0&&(c=T[_].length+c),b<0&&(b=T[_][c].length-b-1),A.lineString([T[_][c][b],T[_][c][b+1]],u,l)}throw new Error("geojson is invalid")}function o(m,l){if(l=l||{},!A.isObject(l))throw new Error("options is invalid");var w=l.featureIndex||0,_=l.multiFeatureIndex||0,c=l.geometryIndex||0,b=l.coordIndex||0,u=l.properties,L;switch(m.type){case"FeatureCollection":w<0&&(w=m.features.length+w),u=u||m.features[w].properties,L=m.features[w].geometry;break;case"Feature":u=u||m.properties,L=m.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=m;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var T=L.coordinates;switch(L.type){case"Point":return A.point(T,u,l);case"MultiPoint":return _<0&&(_=T.length+_),A.point(T[_],u,l);case"LineString":return b<0&&(b=T.length+b),A.point(T[b],u,l);case"Polygon":return c<0&&(c=T.length+c),b<0&&(b=T[c].length+b),A.point(T[c][b],u,l);case"MultiLineString":return _<0&&(_=T.length+_),b<0&&(b=T[_].length+b),A.point(T[_][b],u,l);case"MultiPolygon":return _<0&&(_=T.length+_),c<0&&(c=T[_].length+c),b<0&&(b=T[_][c].length-b),A.point(T[_][c][b],u,l)}throw new Error("geojson is invalid")}te.coordEach=g,te.coordReduce=S,te.propEach=M,te.propReduce=e,te.featureEach=a,te.featureReduce=n,te.coordAll=r,te.geomEach=t,te.geomReduce=h,te.flattenEach=s,te.flattenReduce=i,te.segmentEach=x,te.segmentReduce=p,te.lineEach=v,te.lineReduce=f,te.findSegment=d,te.findPoint=o},{"@turf/helpers":68}],70:[function(y,ee,te){ee.exports=A;function A(g){var S=0,M=0,e=0,a=0;return g.map(function(n){n=n.slice();var r=n[0],t=r.toUpperCase();if(r!=t)switch(n[0]=t,r){case"a":n[6]+=e,n[7]+=a;break;case"v":n[1]+=a;break;case"h":n[1]+=e;break;default:for(var h=1;h<n.length;)n[h++]+=e,n[h++]+=a}switch(t){case"Z":e=S,a=M;break;case"H":e=n[1];break;case"V":a=n[1];break;case"M":e=S=n[1],a=M=n[2];break;default:e=n[n.length-2],a=n[n.length-1]}return n})}},{}],71:[function(y,ee,te){ee.exports=A;function A(g,S){if(!g||g.length==null)throw Error("Argument should be an array");S==null?S=1:S=Math.floor(S);for(var M=Array(S*2),e=0;e<S;e++){for(var a=-1/0,n=1/0,r=e,t=g.length;r<t;r+=S)g[r]>a&&(a=g[r]),g[r]<n&&(n=g[r]);M[e]=n,M[S+e]=a}return M}},{}],72:[function(y,ee,te){ee.exports=function(A,g,S){if(typeof Array.prototype.findIndex=="function")return A.findIndex(g,S);if(typeof g!="function")throw new TypeError("predicate must be a function");var M=Object(A),e=M.length;if(e===0)return-1;for(var a=0;a<e;a++)if(g.call(S,M[a],a,M))return a;return-1}},{}],73:[function(y,ee,te){var A=y("array-bounds");ee.exports=g;function g(S,M,e){if(!S||S.length==null)throw Error("Argument should be an array");M==null&&(M=1),e==null&&(e=A(S,M));for(var a=0;a<M;a++){var n=e[M+a],r=e[a],t=a,h=S.length;if(n===1/0&&r===-1/0)for(t=a;t<h;t+=M)S[t]=S[t]===n?1:S[t]===r?0:.5;else if(n===1/0)for(t=a;t<h;t+=M)S[t]=S[t]===n?1:0;else if(r===-1/0)for(t=a;t<h;t+=M)S[t]=S[t]===r?0:1;else{var s=n-r;for(t=a;t<h;t+=M)isNaN(S[t])||(S[t]=s===0?.5:(S[t]-r)/s)}}return S}},{"array-bounds":71}],74:[function(y,ee,te){ee.exports=function(g,S){var M=typeof g=="number",e=typeof S=="number";M&&!e?(S=g,g=0):!M&&!e&&(g=0,S=0),g=g|0,S=S|0;var a=S-g;if(a<0)throw new Error("array length must be positive");for(var n=new Array(a),r=0,t=g;r<a;r++,t++)n[r]=t;return n}},{}],75:[function(y,ee,te){(function(A){(function(){var g=y("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function S(k,P){if(k===P)return 0;for(var z=k.length,I=P.length,D=0,R=Math.min(z,I);D<R;++D)if(k[D]!==P[D]){z=k[D],I=P[D];break}return z<I?-1:I<z?1:0}function M(k){return A.Buffer&&typeof A.Buffer.isBuffer=="function"?A.Buffer.isBuffer(k):!!(k!=null&&k._isBuffer)}var e=y("util/"),a=Object.prototype.hasOwnProperty,n=Array.prototype.slice,r=function(){return function(){}.name==="foo"}();function t(k){return Object.prototype.toString.call(k)}function h(k){return M(k)||typeof A.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(k):k?!!(k instanceof DataView||k.buffer&&k.buffer instanceof ArrayBuffer):!1}var s=ee.exports=o,i=/\s*function\s+([^\(\s]*)\s*/;function x(k){if(e.isFunction(k)){if(r)return k.name;var P=k.toString(),z=P.match(i);return z&&z[1]}}s.AssertionError=function(P){this.name="AssertionError",this.actual=P.actual,this.expected=P.expected,this.operator=P.operator,P.message?(this.message=P.message,this.generatedMessage=!1):(this.message=f(this),this.generatedMessage=!0);var z=P.stackStartFunction||d;if(Error.captureStackTrace)Error.captureStackTrace(this,z);else{var I=new Error;if(I.stack){var D=I.stack,R=x(z),O=D.indexOf(`
`+R);if(O>=0){var F=D.indexOf(`
`,O+1);D=D.substring(F+1)}this.stack=D}}},e.inherits(s.AssertionError,Error);function p(k,P){return typeof k=="string"?k.length<P?k:k.slice(0,P):k}function v(k){if(r||!e.isFunction(k))return e.inspect(k);var P=x(k),z=P?": "+P:"";return"[Function"+z+"]"}function f(k){return p(v(k.actual),128)+" "+k.operator+" "+p(v(k.expected),128)}function d(k,P,z,I,D){throw new s.AssertionError({message:z,actual:k,expected:P,operator:I,stackStartFunction:D})}s.fail=d;function o(k,P){k||d(k,!0,P,"==",s.ok)}s.ok=o,s.equal=function(P,z,I){P!=z&&d(P,z,I,"==",s.equal)},s.notEqual=function(P,z,I){P==z&&d(P,z,I,"!=",s.notEqual)},s.deepEqual=function(P,z,I){m(P,z,!1)||d(P,z,I,"deepEqual",s.deepEqual)},s.deepStrictEqual=function(P,z,I){m(P,z,!0)||d(P,z,I,"deepStrictEqual",s.deepStrictEqual)};function m(k,P,z,I){if(k===P)return!0;if(M(k)&&M(P))return S(k,P)===0;if(e.isDate(k)&&e.isDate(P))return k.getTime()===P.getTime();if(e.isRegExp(k)&&e.isRegExp(P))return k.source===P.source&&k.global===P.global&&k.multiline===P.multiline&&k.lastIndex===P.lastIndex&&k.ignoreCase===P.ignoreCase;if((k===null||typeof k!="object")&&(P===null||typeof P!="object"))return z?k===P:k==P;if(h(k)&&h(P)&&t(k)===t(P)&&!(k instanceof Float32Array||k instanceof Float64Array))return S(new Uint8Array(k.buffer),new Uint8Array(P.buffer))===0;if(M(k)!==M(P))return!1;I=I||{actual:[],expected:[]};var D=I.actual.indexOf(k);return D!==-1&&D===I.expected.indexOf(P)?!0:(I.actual.push(k),I.expected.push(P),w(k,P,z,I))}function l(k){return Object.prototype.toString.call(k)=="[object Arguments]"}function w(k,P,z,I){if(k==null||P===null||P===void 0)return!1;if(e.isPrimitive(k)||e.isPrimitive(P))return k===P;if(z&&Object.getPrototypeOf(k)!==Object.getPrototypeOf(P))return!1;var D=l(k),R=l(P);if(D&&!R||!D&&R)return!1;if(D)return k=n.call(k),P=n.call(P),m(k,P,z);var O=T(k),F=T(P),N,G;if(O.length!==F.length)return!1;for(O.sort(),F.sort(),G=O.length-1;G>=0;G--)if(O[G]!==F[G])return!1;for(G=O.length-1;G>=0;G--)if(N=O[G],!m(k[N],P[N],z,I))return!1;return!0}s.notDeepEqual=function(P,z,I){m(P,z,!1)&&d(P,z,I,"notDeepEqual",s.notDeepEqual)},s.notDeepStrictEqual=_;function _(k,P,z){m(k,P,!0)&&d(k,P,z,"notDeepStrictEqual",_)}s.strictEqual=function(P,z,I){P!==z&&d(P,z,I,"===",s.strictEqual)},s.notStrictEqual=function(P,z,I){P===z&&d(P,z,I,"!==",s.notStrictEqual)};function c(k,P){if(!k||!P)return!1;if(Object.prototype.toString.call(P)=="[object RegExp]")return P.test(k);try{if(k instanceof P)return!0}catch{}return Error.isPrototypeOf(P)?!1:P.call({},k)===!0}function b(k){var P;try{k()}catch(z){P=z}return P}function u(k,P,z,I){var D;if(typeof P!="function")throw new TypeError('"block" argument must be a function');typeof z=="string"&&(I=z,z=null),D=b(P),I=(z&&z.name?" ("+z.name+").":".")+(I?" "+I:"."),k&&!D&&d(D,z,"Missing expected exception"+I);var R=typeof I=="string",O=!k&&e.isError(D),F=!k&&D&&!z;if((O&&R&&c(D,z)||F)&&d(D,z,"Got unwanted exception"+I),k&&D&&z&&!c(D,z)||!k&&D)throw D}s.throws=function(k,P,z){u(!0,k,P,z)},s.doesNotThrow=function(k,P,z){u(!1,k,P,z)},s.ifError=function(k){if(k)throw k};function L(k,P){k||d(k,!0,P,"==",L)}s.strict=g(L,s,{equal:s.strictEqual,deepEqual:s.deepStrictEqual,notEqual:s.notStrictEqual,notDeepEqual:s.notDeepStrictEqual}),s.strict.strict=s.strict;var T=Object.keys||function(k){var P=[];for(var z in k)a.call(k,z)&&P.push(z);return P}}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(y,ee,te){typeof Object.create=="function"?ee.exports=function(g,S){g.super_=S,g.prototype=Object.create(S.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:ee.exports=function(g,S){g.super_=S;var M=function(){};M.prototype=S.prototype,g.prototype=new M,g.prototype.constructor=g}},{}],77:[function(y,ee,te){ee.exports=function(g){return g&&typeof g=="object"&&typeof g.copy=="function"&&typeof g.fill=="function"&&typeof g.readUInt8=="function"}},{}],78:[function(y,ee,te){(function(A,g){(function(){var S=/%[sdj%]/g;te.format=function(F){if(!w(F)){for(var N=[],G=0;G<arguments.length;G++)N.push(a(arguments[G]));return N.join(" ")}for(var G=1,K=arguments,W=K.length,Y=String(F).replace(S,function(ue){if(ue==="%%")return"%";if(G>=W)return ue;switch(ue){case"%s":return String(K[G++]);case"%d":return Number(K[G++]);case"%j":try{return JSON.stringify(K[G++])}catch{return"[Circular]"}default:return ue}}),re=K[G];G<W;re=K[++G])o(re)||!u(re)?Y+=" "+re:Y+=" "+a(re);return Y},te.deprecate=function(F,N){if(c(g.process))return function(){return te.deprecate(F,N).apply(this,arguments)};if(A.noDeprecation===!0)return F;var G=!1;function K(){if(!G){if(A.throwDeprecation)throw new Error(N);A.traceDeprecation?console.trace(N):console.error(N),G=!0}return F.apply(this,arguments)}return K};var M={},e;te.debuglog=function(F){if(c(e)&&(e={}.NODE_DEBUG||""),F=F.toUpperCase(),!M[F])if(new RegExp("\\b"+F+"\\b","i").test(e)){var N=A.pid;M[F]=function(){var G=te.format.apply(te,arguments);console.error("%s %d: %s",F,N,G)}}else M[F]=function(){};return M[F]};function a(F,N){var G={seen:[],stylize:r};return arguments.length>=3&&(G.depth=arguments[2]),arguments.length>=4&&(G.colors=arguments[3]),d(N)?G.showHidden=N:N&&te._extend(G,N),c(G.showHidden)&&(G.showHidden=!1),c(G.depth)&&(G.depth=2),c(G.colors)&&(G.colors=!1),c(G.customInspect)&&(G.customInspect=!0),G.colors&&(G.stylize=n),h(G,F,G.depth)}te.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(F,N){var G=a.styles[N];return G?"\x1B["+a.colors[G][0]+"m"+F+"\x1B["+a.colors[G][1]+"m":F}function r(F,N){return F}function t(F){var N={};return F.forEach(function(G,K){N[G]=!0}),N}function h(F,N,G){if(F.customInspect&&N&&k(N.inspect)&&N.inspect!==te.inspect&&!(N.constructor&&N.constructor.prototype===N)){var K=N.inspect(G,F);return w(K)||(K=h(F,K,G)),K}var W=s(F,N);if(W)return W;var Y=Object.keys(N),re=t(Y);if(F.showHidden&&(Y=Object.getOwnPropertyNames(N)),T(N)&&(Y.indexOf("message")>=0||Y.indexOf("description")>=0))return i(N);if(Y.length===0){if(k(N)){var ue=N.name?": "+N.name:"";return F.stylize("[Function"+ue+"]","special")}if(b(N))return F.stylize(RegExp.prototype.toString.call(N),"regexp");if(L(N))return F.stylize(Date.prototype.toString.call(N),"date");if(T(N))return i(N)}var j="",q=!1,H=["{","}"];if(f(N)&&(q=!0,H=["[","]"]),k(N)){var U=N.name?": "+N.name:"";j=" [Function"+U+"]"}if(b(N)&&(j=" "+RegExp.prototype.toString.call(N)),L(N)&&(j=" "+Date.prototype.toUTCString.call(N)),T(N)&&(j=" "+i(N)),Y.length===0&&(!q||N.length==0))return H[0]+j+H[1];if(G<0)return b(N)?F.stylize(RegExp.prototype.toString.call(N),"regexp"):F.stylize("[Object]","special");F.seen.push(N);var $;return q?$=x(F,N,G,re,Y):$=Y.map(function(ne){return p(F,N,G,re,ne,q)}),F.seen.pop(),v($,j,H)}function s(F,N){if(c(N))return F.stylize("undefined","undefined");if(w(N)){var G="'"+JSON.stringify(N).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return F.stylize(G,"string")}if(l(N))return F.stylize(""+N,"number");if(d(N))return F.stylize(""+N,"boolean");if(o(N))return F.stylize("null","null")}function i(F){return"["+Error.prototype.toString.call(F)+"]"}function x(F,N,G,K,W){for(var Y=[],re=0,ue=N.length;re<ue;++re)O(N,String(re))?Y.push(p(F,N,G,K,String(re),!0)):Y.push("");return W.forEach(function(j){j.match(/^\d+$/)||Y.push(p(F,N,G,K,j,!0))}),Y}function p(F,N,G,K,W,Y){var re,ue,j;if(j=Object.getOwnPropertyDescriptor(N,W)||{value:N[W]},j.get?j.set?ue=F.stylize("[Getter/Setter]","special"):ue=F.stylize("[Getter]","special"):j.set&&(ue=F.stylize("[Setter]","special")),O(K,W)||(re="["+W+"]"),ue||(F.seen.indexOf(j.value)<0?(o(G)?ue=h(F,j.value,null):ue=h(F,j.value,G-1),ue.indexOf(`
`)>-1&&(Y?ue=ue.split(`
`).map(function(q){return"  "+q}).join(`
`).substr(2):ue=`
`+ue.split(`
`).map(function(q){return"   "+q}).join(`
`))):ue=F.stylize("[Circular]","special")),c(re)){if(Y&&W.match(/^\d+$/))return ue;re=JSON.stringify(""+W),re.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(re=re.substr(1,re.length-2),re=F.stylize(re,"name")):(re=re.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),re=F.stylize(re,"string"))}return re+": "+ue}function v(F,N,G){var K=F.reduce(function(W,Y){return Y.indexOf(`
`)>=0,W+Y.replace(/\u001b\[\d\d?m/g,"").length+1},0);return K>60?G[0]+(N===""?"":N+`
 `)+" "+F.join(`,
  `)+" "+G[1]:G[0]+N+" "+F.join(", ")+" "+G[1]}function f(F){return Array.isArray(F)}te.isArray=f;function d(F){return typeof F=="boolean"}te.isBoolean=d;function o(F){return F===null}te.isNull=o;function m(F){return F==null}te.isNullOrUndefined=m;function l(F){return typeof F=="number"}te.isNumber=l;function w(F){return typeof F=="string"}te.isString=w;function _(F){return typeof F=="symbol"}te.isSymbol=_;function c(F){return F===void 0}te.isUndefined=c;function b(F){return u(F)&&z(F)==="[object RegExp]"}te.isRegExp=b;function u(F){return typeof F=="object"&&F!==null}te.isObject=u;function L(F){return u(F)&&z(F)==="[object Date]"}te.isDate=L;function T(F){return u(F)&&(z(F)==="[object Error]"||F instanceof Error)}te.isError=T;function k(F){return typeof F=="function"}te.isFunction=k;function P(F){return F===null||typeof F=="boolean"||typeof F=="number"||typeof F=="string"||typeof F=="symbol"||typeof F>"u"}te.isPrimitive=P,te.isBuffer=y("./support/isBuffer");function z(F){return Object.prototype.toString.call(F)}function I(F){return F<10?"0"+F.toString(10):F.toString(10)}var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var F=new Date,N=[I(F.getHours()),I(F.getMinutes()),I(F.getSeconds())].join(":");return[F.getDate(),D[F.getMonth()],N].join(" ")}te.log=function(){console.log("%s - %s",R(),te.format.apply(te,arguments))},te.inherits=y("inherits"),te._extend=function(F,N){if(!N||!u(N))return F;for(var G=Object.keys(N),K=G.length;K--;)F[G[K]]=N[G[K]];return F};function O(F,N){return Object.prototype.hasOwnProperty.call(F,N)}}).call(this)}).call(this,y("_process"),typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(y,ee,te){te.byteLength=r,te.toByteArray=h,te.fromByteArray=x;for(var A=[],g=[],S=typeof Uint8Array<"u"?Uint8Array:Array,M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,a=M.length;e<a;++e)A[e]=M[e],g[M.charCodeAt(e)]=e;g["-".charCodeAt(0)]=62,g["_".charCodeAt(0)]=63;function n(p){var v=p.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=p.indexOf("=");f===-1&&(f=v);var d=f===v?0:4-f%4;return[f,d]}function r(p){var v=n(p),f=v[0],d=v[1];return(f+d)*3/4-d}function t(p,v,f){return(v+f)*3/4-f}function h(p){var v,f=n(p),d=f[0],o=f[1],m=new S(t(p,d,o)),l=0,w=o>0?d-4:d,_;for(_=0;_<w;_+=4)v=g[p.charCodeAt(_)]<<18|g[p.charCodeAt(_+1)]<<12|g[p.charCodeAt(_+2)]<<6|g[p.charCodeAt(_+3)],m[l++]=v>>16&255,m[l++]=v>>8&255,m[l++]=v&255;return o===2&&(v=g[p.charCodeAt(_)]<<2|g[p.charCodeAt(_+1)]>>4,m[l++]=v&255),o===1&&(v=g[p.charCodeAt(_)]<<10|g[p.charCodeAt(_+1)]<<4|g[p.charCodeAt(_+2)]>>2,m[l++]=v>>8&255,m[l++]=v&255),m}function s(p){return A[p>>18&63]+A[p>>12&63]+A[p>>6&63]+A[p&63]}function i(p,v,f){for(var d,o=[],m=v;m<f;m+=3)d=(p[m]<<16&16711680)+(p[m+1]<<8&65280)+(p[m+2]&255),o.push(s(d));return o.join("")}function x(p){for(var v,f=p.length,d=f%3,o=[],m=16383,l=0,w=f-d;l<w;l+=m)o.push(i(p,l,l+m>w?w:l+m));return d===1?(v=p[f-1],o.push(A[v>>2]+A[v<<4&63]+"==")):d===2&&(v=(p[f-2]<<8)+p[f-1],o.push(A[v>>10]+A[v>>4&63]+A[v<<2&63]+"=")),o.join("")}},{}],80:[function(y,ee,te){function A(n,r,t,h,s){for(var i=s+1;h<=s;){var x=h+s>>>1,p=n[x],v=t!==void 0?t(p,r):p-r;v>=0?(i=x,s=x-1):h=x+1}return i}function g(n,r,t,h,s){for(var i=s+1;h<=s;){var x=h+s>>>1,p=n[x],v=t!==void 0?t(p,r):p-r;v>0?(i=x,s=x-1):h=x+1}return i}function S(n,r,t,h,s){for(var i=h-1;h<=s;){var x=h+s>>>1,p=n[x],v=t!==void 0?t(p,r):p-r;v<0?(i=x,h=x+1):s=x-1}return i}function M(n,r,t,h,s){for(var i=h-1;h<=s;){var x=h+s>>>1,p=n[x],v=t!==void 0?t(p,r):p-r;v<=0?(i=x,h=x+1):s=x-1}return i}function e(n,r,t,h,s){for(;h<=s;){var i=h+s>>>1,x=n[i],p=t!==void 0?t(x,r):x-r;if(p===0)return i;p<=0?h=i+1:s=i-1}return-1}function a(n,r,t,h,s,i){return typeof t=="function"?i(n,r,t,h===void 0?0:h|0,s===void 0?n.length-1:s|0):i(n,r,void 0,t===void 0?0:t|0,h===void 0?n.length-1:h|0)}ee.exports={ge:function(n,r,t,h,s){return a(n,r,t,h,s,A)},gt:function(n,r,t,h,s){return a(n,r,t,h,s,g)},lt:function(n,r,t,h,s){return a(n,r,t,h,s,S)},le:function(n,r,t,h,s){return a(n,r,t,h,s,M)},eq:function(n,r,t,h,s){return a(n,r,t,h,s,e)}}},{}],81:[function(y,ee,te){var A=32;te.INT_BITS=A,te.INT_MAX=2147483647,te.INT_MIN=-1<<A-1,te.sign=function(M){return(M>0)-(M<0)},te.abs=function(M){var e=M>>A-1;return(M^e)-e},te.min=function(M,e){return e^(M^e)&-(M<e)},te.max=function(M,e){return M^(M^e)&-(M<e)},te.isPow2=function(M){return!(M&M-1)&&!!M},te.log2=function(M){var e,a;return e=(M>65535)<<4,M>>>=e,a=(M>255)<<3,M>>>=a,e|=a,a=(M>15)<<2,M>>>=a,e|=a,a=(M>3)<<1,M>>>=a,e|=a,e|M>>1},te.log10=function(M){return M>=1e9?9:M>=1e8?8:M>=1e7?7:M>=1e6?6:M>=1e5?5:M>=1e4?4:M>=1e3?3:M>=100?2:M>=10?1:0},te.popCount=function(M){return M=M-(M>>>1&1431655765),M=(M&858993459)+(M>>>2&858993459),(M+(M>>>4)&252645135)*16843009>>>24};function g(M){var e=32;return M&=-M,M&&e--,M&65535&&(e-=16),M&16711935&&(e-=8),M&252645135&&(e-=4),M&858993459&&(e-=2),M&1431655765&&(e-=1),e}te.countTrailingZeros=g,te.nextPow2=function(M){return M+=M===0,--M,M|=M>>>1,M|=M>>>2,M|=M>>>4,M|=M>>>8,M|=M>>>16,M+1},te.prevPow2=function(M){return M|=M>>>1,M|=M>>>2,M|=M>>>4,M|=M>>>8,M|=M>>>16,M-(M>>>1)},te.parity=function(M){return M^=M>>>16,M^=M>>>8,M^=M>>>4,M&=15,27030>>>M&1};var S=new Array(256);(function(M){for(var e=0;e<256;++e){var a=e,n=e,r=7;for(a>>>=1;a;a>>>=1)n<<=1,n|=a&1,--r;M[e]=n<<r&255}})(S),te.reverse=function(M){return S[M&255]<<24|S[M>>>8&255]<<16|S[M>>>16&255]<<8|S[M>>>24&255]},te.interleave2=function(M,e){return M&=65535,M=(M|M<<8)&16711935,M=(M|M<<4)&252645135,M=(M|M<<2)&858993459,M=(M|M<<1)&1431655765,e&=65535,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,M|e<<1},te.deinterleave2=function(M,e){return M=M>>>e&1431655765,M=(M|M>>>1)&858993459,M=(M|M>>>2)&252645135,M=(M|M>>>4)&16711935,M=(M|M>>>16)&65535,M<<16>>16},te.interleave3=function(M,e,a){return M&=1023,M=(M|M<<16)&4278190335,M=(M|M<<8)&251719695,M=(M|M<<4)&3272356035,M=(M|M<<2)&1227133513,e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,M|=e<<1,a&=1023,a=(a|a<<16)&4278190335,a=(a|a<<8)&251719695,a=(a|a<<4)&3272356035,a=(a|a<<2)&1227133513,M|a<<2},te.deinterleave3=function(M,e){return M=M>>>e&1227133513,M=(M|M>>>2)&3272356035,M=(M|M>>>4)&251719695,M=(M|M>>>8)&4278190335,M=(M|M>>>16)&1023,M<<22>>22},te.nextCombination=function(M){var e=M|M-1;return e+1|(~e&-~e)-1>>>g(M)+1}},{}],82:[function(y,ee,te){var A=y("clamp");ee.exports=S;var g=1e20;function S(a,n){n||(n={});var r=n.cutoff==null?.25:n.cutoff,t=n.radius==null?8:n.radius,h=n.channel||0,s,i,x,p,v,f,d,o,m,l,w;if(ArrayBuffer.isView(a)||Array.isArray(a)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");s=n.width,i=n.height,p=a,n.stride?f=n.stride:f=Math.floor(a.length/s/i)}else window.HTMLCanvasElement&&a instanceof window.HTMLCanvasElement?(o=a,d=o.getContext("2d"),s=o.width,i=o.height,m=d.getImageData(0,0,s,i),p=m.data,f=4):window.CanvasRenderingContext2D&&a instanceof window.CanvasRenderingContext2D?(o=a.canvas,d=a,s=o.width,i=o.height,m=d.getImageData(0,0,s,i),p=m.data,f=4):window.ImageData&&a instanceof window.ImageData&&(m=a,s=a.width,i=a.height,p=m.data,f=4);if(x=Math.max(s,i),window.Uint8ClampedArray&&p instanceof window.Uint8ClampedArray||window.Uint8Array&&p instanceof window.Uint8Array)for(v=p,p=Array(s*i),l=0,w=v.length;l<w;l++)p[l]=v[l*f+h]/255;else if(f!==1)throw Error("Raw data can have only 1 value per pixel");var _=Array(s*i),c=Array(s*i),b=Array(x),u=Array(x),L=Array(x+1),T=Array(x);for(l=0,w=s*i;l<w;l++){var k=p[l];_[l]=k===1?0:k===0?g:Math.pow(Math.max(0,.5-k),2),c[l]=k===1?g:k===0?0:Math.pow(Math.max(0,k-.5),2)}M(_,s,i,b,u,T,L),M(c,s,i,b,u,T,L);var P=window.Float32Array?new Float32Array(s*i):new Array(s*i);for(l=0,w=s*i;l<w;l++)P[l]=A(1-((_[l]-c[l])/t+r),0,1);return P}function M(a,n,r,t,h,s,i){for(var x=0;x<n;x++){for(var p=0;p<r;p++)t[p]=a[p*n+x];for(e(t,h,s,i,r),p=0;p<r;p++)a[p*n+x]=h[p]}for(p=0;p<r;p++){for(x=0;x<n;x++)t[x]=a[p*n+x];for(e(t,h,s,i,n),x=0;x<n;x++)a[p*n+x]=Math.sqrt(h[x])}}function e(a,n,r,t,h){r[0]=0,t[0]=-g,t[1]=+g;for(var s=1,i=0;s<h;s++){for(var x=(a[s]+s*s-(a[r[i]]+r[i]*r[i]))/(2*s-2*r[i]);x<=t[i];)i--,x=(a[s]+s*s-(a[r[i]]+r[i]*r[i]))/(2*s-2*r[i]);i++,r[i]=s,t[i]=x,t[i+1]=+g}for(s=0,i=0;s<h;s++){for(;t[i+1]<s;)i++;n[s]=(s-r[i])*(s-r[i])+a[r[i]]}}},{clamp:86}],83:[function(y,ee,te){},{}],84:[function(y,ee,te){var A=typeof Reflect=="object"?Reflect:null,g=A&&typeof A.apply=="function"?A.apply:function(l,w,_){return Function.prototype.apply.call(l,w,_)},S;A&&typeof A.ownKeys=="function"?S=A.ownKeys:Object.getOwnPropertySymbols?S=function(l){return Object.getOwnPropertyNames(l).concat(Object.getOwnPropertySymbols(l))}:S=function(l){return Object.getOwnPropertyNames(l)};function M(m){console&&console.warn&&console.warn(m)}var e=Number.isNaN||function(l){return l!==l};function a(){a.init.call(this)}ee.exports=a,ee.exports.once=o,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var n=10;function r(m){if(typeof m!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(m){if(typeof m!="number"||m<0||e(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");n=m}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(l){if(typeof l!="number"||l<0||e(l))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+l+".");return this._maxListeners=l,this};function t(m){return m._maxListeners===void 0?a.defaultMaxListeners:m._maxListeners}a.prototype.getMaxListeners=function(){return t(this)},a.prototype.emit=function(l){for(var w=[],_=1;_<arguments.length;_++)w.push(arguments[_]);var c=l==="error",b=this._events;if(b!==void 0)c=c&&b.error===void 0;else if(!c)return!1;if(c){var u;if(w.length>0&&(u=w[0]),u instanceof Error)throw u;var L=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw L.context=u,L}var T=b[l];if(T===void 0)return!1;if(typeof T=="function")g(T,this,w);else for(var k=T.length,P=v(T,k),_=0;_<k;++_)g(P[_],this,w);return!0};function h(m,l,w,_){var c,b,u;if(r(w),b=m._events,b===void 0?(b=m._events=Object.create(null),m._eventsCount=0):(b.newListener!==void 0&&(m.emit("newListener",l,w.listener?w.listener:w),b=m._events),u=b[l]),u===void 0)u=b[l]=w,++m._eventsCount;else if(typeof u=="function"?u=b[l]=_?[w,u]:[u,w]:_?u.unshift(w):u.push(w),c=t(m),c>0&&u.length>c&&!u.warned){u.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(l)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=m,L.type=l,L.count=u.length,M(L)}return m}a.prototype.addListener=function(l,w){return h(this,l,w,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(l,w){return h(this,l,w,!0)};function s(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function i(m,l,w){var _={fired:!1,wrapFn:void 0,target:m,type:l,listener:w},c=s.bind(_);return c.listener=w,_.wrapFn=c,c}a.prototype.once=function(l,w){return r(w),this.on(l,i(this,l,w)),this},a.prototype.prependOnceListener=function(l,w){return r(w),this.prependListener(l,i(this,l,w)),this},a.prototype.removeListener=function(l,w){var _,c,b,u,L;if(r(w),c=this._events,c===void 0)return this;if(_=c[l],_===void 0)return this;if(_===w||_.listener===w)--this._eventsCount===0?this._events=Object.create(null):(delete c[l],c.removeListener&&this.emit("removeListener",l,_.listener||w));else if(typeof _!="function"){for(b=-1,u=_.length-1;u>=0;u--)if(_[u]===w||_[u].listener===w){L=_[u].listener,b=u;break}if(b<0)return this;b===0?_.shift():f(_,b),_.length===1&&(c[l]=_[0]),c.removeListener!==void 0&&this.emit("removeListener",l,L||w)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(l){var w,_,c;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[l]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[l]),this;if(arguments.length===0){var b=Object.keys(_),u;for(c=0;c<b.length;++c)u=b[c],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(w=_[l],typeof w=="function")this.removeListener(l,w);else if(w!==void 0)for(c=w.length-1;c>=0;c--)this.removeListener(l,w[c]);return this};function x(m,l,w){var _=m._events;if(_===void 0)return[];var c=_[l];return c===void 0?[]:typeof c=="function"?w?[c.listener||c]:[c]:w?d(c):v(c,c.length)}a.prototype.listeners=function(l){return x(this,l,!0)},a.prototype.rawListeners=function(l){return x(this,l,!1)},a.listenerCount=function(m,l){return typeof m.listenerCount=="function"?m.listenerCount(l):p.call(m,l)},a.prototype.listenerCount=p;function p(m){var l=this._events;if(l!==void 0){var w=l[m];if(typeof w=="function")return 1;if(w!==void 0)return w.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?S(this._events):[]};function v(m,l){for(var w=new Array(l),_=0;_<l;++_)w[_]=m[_];return w}function f(m,l){for(;l+1<m.length;l++)m[l]=m[l+1];m.pop()}function d(m){for(var l=new Array(m.length),w=0;w<l.length;++w)l[w]=m[w].listener||m[w];return l}function o(m,l){return new Promise(function(w,_){function c(){b!==void 0&&m.removeListener("error",b),w([].slice.call(arguments))}var b;l!=="error"&&(b=function(L){m.removeListener(l,c),_(L)},m.once("error",b)),m.once(l,c)})}},{}],85:[function(y,ee,te){(function(A){(function(){var g=y("base64-js"),S=y("ieee754");te.Buffer=n,te.SlowBuffer=d,te.INSPECT_MAX_BYTES=50;var M=2147483647;te.kMaxLength=M,n.TYPED_ARRAY_SUPPORT=e(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function e(){try{var se=new Uint8Array(1);return se.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},se.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}});function a(se){if(se>M)throw new RangeError('The value "'+se+'" is invalid for option "size"');var ae=new Uint8Array(se);return ae.__proto__=n.prototype,ae}function n(se,ae,oe){if(typeof se=="number"){if(typeof ae=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return s(se)}return r(se,ae,oe)}typeof Symbol<"u"&&Symbol.species!=null&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192;function r(se,ae,oe){if(typeof se=="string")return i(se,ae);if(ArrayBuffer.isView(se))return x(se);if(se==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof se);if(Q(se,ArrayBuffer)||se&&Q(se.buffer,ArrayBuffer))return p(se,ae,oe);if(typeof se=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var be=se.valueOf&&se.valueOf();if(be!=null&&be!==se)return n.from(be,ae,oe);var ce=v(se);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof se[Symbol.toPrimitive]=="function")return n.from(se[Symbol.toPrimitive]("string"),ae,oe);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof se)}n.from=function(se,ae,oe){return r(se,ae,oe)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array;function t(se){if(typeof se!="number")throw new TypeError('"size" argument must be of type number');if(se<0)throw new RangeError('The value "'+se+'" is invalid for option "size"')}function h(se,ae,oe){return t(se),se<=0?a(se):ae!==void 0?typeof oe=="string"?a(se).fill(ae,oe):a(se).fill(ae):a(se)}n.alloc=function(se,ae,oe){return h(se,ae,oe)};function s(se){return t(se),a(se<0?0:f(se)|0)}n.allocUnsafe=function(se){return s(se)},n.allocUnsafeSlow=function(se){return s(se)};function i(se,ae){if((typeof ae!="string"||ae==="")&&(ae="utf8"),!n.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);var oe=o(se,ae)|0,be=a(oe),ce=be.write(se,ae);return ce!==oe&&(be=be.slice(0,ce)),be}function x(se){for(var ae=se.length<0?0:f(se.length)|0,oe=a(ae),be=0;be<ae;be+=1)oe[be]=se[be]&255;return oe}function p(se,ae,oe){if(ae<0||se.byteLength<ae)throw new RangeError('"offset" is outside of buffer bounds');if(se.byteLength<ae+(oe||0))throw new RangeError('"length" is outside of buffer bounds');var be;return ae===void 0&&oe===void 0?be=new Uint8Array(se):oe===void 0?be=new Uint8Array(se,ae):be=new Uint8Array(se,ae,oe),be.__proto__=n.prototype,be}function v(se){if(n.isBuffer(se)){var ae=f(se.length)|0,oe=a(ae);return oe.length===0||se.copy(oe,0,0,ae),oe}if(se.length!==void 0)return typeof se.length!="number"||ie(se.length)?a(0):x(se);if(se.type==="Buffer"&&Array.isArray(se.data))return x(se.data)}function f(se){if(se>=M)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+M.toString(16)+" bytes");return se|0}function d(se){return+se!=se&&(se=0),n.alloc(+se)}n.isBuffer=function(ae){return ae!=null&&ae._isBuffer===!0&&ae!==n.prototype},n.compare=function(ae,oe){if(Q(ae,Uint8Array)&&(ae=n.from(ae,ae.offset,ae.byteLength)),Q(oe,Uint8Array)&&(oe=n.from(oe,oe.offset,oe.byteLength)),!n.isBuffer(ae)||!n.isBuffer(oe))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ae===oe)return 0;for(var be=ae.length,ce=oe.length,de=0,ye=Math.min(be,ce);de<ye;++de)if(ae[de]!==oe[de]){be=ae[de],ce=oe[de];break}return be<ce?-1:ce<be?1:0},n.isEncoding=function(ae){switch(String(ae).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(ae,oe){if(!Array.isArray(ae))throw new TypeError('"list" argument must be an Array of Buffers');if(ae.length===0)return n.alloc(0);var be;if(oe===void 0)for(oe=0,be=0;be<ae.length;++be)oe+=ae[be].length;var ce=n.allocUnsafe(oe),de=0;for(be=0;be<ae.length;++be){var ye=ae[be];if(Q(ye,Uint8Array)&&(ye=n.from(ye)),!n.isBuffer(ye))throw new TypeError('"list" argument must be an Array of Buffers');ye.copy(ce,de),de+=ye.length}return ce};function o(se,ae){if(n.isBuffer(se))return se.length;if(ArrayBuffer.isView(se)||Q(se,ArrayBuffer))return se.byteLength;if(typeof se!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof se);var oe=se.length,be=arguments.length>2&&arguments[2]===!0;if(!be&&oe===0)return 0;for(var ce=!1;;)switch(ae){case"ascii":case"latin1":case"binary":return oe;case"utf8":case"utf-8":return H(se).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe*2;case"hex":return oe>>>1;case"base64":return ne(se).length;default:if(ce)return be?-1:H(se).length;ae=(""+ae).toLowerCase(),ce=!0}}n.byteLength=o;function m(se,ae,oe){var be=!1;if((ae===void 0||ae<0)&&(ae=0),ae>this.length||((oe===void 0||oe>this.length)&&(oe=this.length),oe<=0)||(oe>>>=0,ae>>>=0,oe<=ae))return"";for(se||(se="utf8");;)switch(se){case"hex":return F(this,ae,oe);case"utf8":case"utf-8":return z(this,ae,oe);case"ascii":return R(this,ae,oe);case"latin1":case"binary":return O(this,ae,oe);case"base64":return P(this,ae,oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,ae,oe);default:if(be)throw new TypeError("Unknown encoding: "+se);se=(se+"").toLowerCase(),be=!0}}n.prototype._isBuffer=!0;function l(se,ae,oe){var be=se[ae];se[ae]=se[oe],se[oe]=be}n.prototype.swap16=function(){var ae=this.length;if(ae%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var oe=0;oe<ae;oe+=2)l(this,oe,oe+1);return this},n.prototype.swap32=function(){var ae=this.length;if(ae%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var oe=0;oe<ae;oe+=4)l(this,oe,oe+3),l(this,oe+1,oe+2);return this},n.prototype.swap64=function(){var ae=this.length;if(ae%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var oe=0;oe<ae;oe+=8)l(this,oe,oe+7),l(this,oe+1,oe+6),l(this,oe+2,oe+5),l(this,oe+3,oe+4);return this},n.prototype.toString=function(){var ae=this.length;return ae===0?"":arguments.length===0?z(this,0,ae):m.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(ae){if(!n.isBuffer(ae))throw new TypeError("Argument must be a Buffer");return this===ae?!0:n.compare(this,ae)===0},n.prototype.inspect=function(){var ae="",oe=te.INSPECT_MAX_BYTES;return ae=this.toString("hex",0,oe).replace(/(.{2})/g,"$1 ").trim(),this.length>oe&&(ae+=" ... "),"<Buffer "+ae+">"},n.prototype.compare=function(ae,oe,be,ce,de){if(Q(ae,Uint8Array)&&(ae=n.from(ae,ae.offset,ae.byteLength)),!n.isBuffer(ae))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ae);if(oe===void 0&&(oe=0),be===void 0&&(be=ae?ae.length:0),ce===void 0&&(ce=0),de===void 0&&(de=this.length),oe<0||be>ae.length||ce<0||de>this.length)throw new RangeError("out of range index");if(ce>=de&&oe>=be)return 0;if(ce>=de)return-1;if(oe>=be)return 1;if(oe>>>=0,be>>>=0,ce>>>=0,de>>>=0,this===ae)return 0;for(var ye=de-ce,ge=be-oe,me=Math.min(ye,ge),Ee=this.slice(ce,de),Pe=ae.slice(oe,be),Ue=0;Ue<me;++Ue)if(Ee[Ue]!==Pe[Ue]){ye=Ee[Ue],ge=Pe[Ue];break}return ye<ge?-1:ge<ye?1:0};function w(se,ae,oe,be,ce){if(se.length===0)return-1;if(typeof oe=="string"?(be=oe,oe=0):oe>2147483647?oe=2147483647:oe<-2147483648&&(oe=-2147483648),oe=+oe,ie(oe)&&(oe=ce?0:se.length-1),oe<0&&(oe=se.length+oe),oe>=se.length){if(ce)return-1;oe=se.length-1}else if(oe<0)if(ce)oe=0;else return-1;if(typeof ae=="string"&&(ae=n.from(ae,be)),n.isBuffer(ae))return ae.length===0?-1:_(se,ae,oe,be,ce);if(typeof ae=="number")return ae=ae&255,typeof Uint8Array.prototype.indexOf=="function"?ce?Uint8Array.prototype.indexOf.call(se,ae,oe):Uint8Array.prototype.lastIndexOf.call(se,ae,oe):_(se,[ae],oe,be,ce);throw new TypeError("val must be string, number or Buffer")}function _(se,ae,oe,be,ce){var de=1,ye=se.length,ge=ae.length;if(be!==void 0&&(be=String(be).toLowerCase(),be==="ucs2"||be==="ucs-2"||be==="utf16le"||be==="utf-16le")){if(se.length<2||ae.length<2)return-1;de=2,ye/=2,ge/=2,oe/=2}function me(ke,Xe){return de===1?ke[Xe]:ke.readUInt16BE(Xe*de)}var Ee;if(ce){var Pe=-1;for(Ee=oe;Ee<ye;Ee++)if(me(se,Ee)===me(ae,Pe===-1?0:Ee-Pe)){if(Pe===-1&&(Pe=Ee),Ee-Pe+1===ge)return Pe*de}else Pe!==-1&&(Ee-=Ee-Pe),Pe=-1}else for(oe+ge>ye&&(oe=ye-ge),Ee=oe;Ee>=0;Ee--){for(var Ue=!0,we=0;we<ge;we++)if(me(se,Ee+we)!==me(ae,we)){Ue=!1;break}if(Ue)return Ee}return-1}n.prototype.includes=function(ae,oe,be){return this.indexOf(ae,oe,be)!==-1},n.prototype.indexOf=function(ae,oe,be){return w(this,ae,oe,be,!0)},n.prototype.lastIndexOf=function(ae,oe,be){return w(this,ae,oe,be,!1)};function c(se,ae,oe,be){oe=Number(oe)||0;var ce=se.length-oe;be?(be=Number(be),be>ce&&(be=ce)):be=ce;var de=ae.length;be>de/2&&(be=de/2);for(var ye=0;ye<be;++ye){var ge=parseInt(ae.substr(ye*2,2),16);if(ie(ge))return ye;se[oe+ye]=ge}return ye}function b(se,ae,oe,be){return X(H(ae,se.length-oe),se,oe,be)}function u(se,ae,oe,be){return X(U(ae),se,oe,be)}function L(se,ae,oe,be){return u(se,ae,oe,be)}function T(se,ae,oe,be){return X(ne(ae),se,oe,be)}function k(se,ae,oe,be){return X($(ae,se.length-oe),se,oe,be)}n.prototype.write=function(ae,oe,be,ce){if(oe===void 0)ce="utf8",be=this.length,oe=0;else if(be===void 0&&typeof oe=="string")ce=oe,be=this.length,oe=0;else if(isFinite(oe))oe=oe>>>0,isFinite(be)?(be=be>>>0,ce===void 0&&(ce="utf8")):(ce=be,be=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var de=this.length-oe;if((be===void 0||be>de)&&(be=de),ae.length>0&&(be<0||oe<0)||oe>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");for(var ye=!1;;)switch(ce){case"hex":return c(this,ae,oe,be);case"utf8":case"utf-8":return b(this,ae,oe,be);case"ascii":return u(this,ae,oe,be);case"latin1":case"binary":return L(this,ae,oe,be);case"base64":return T(this,ae,oe,be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,ae,oe,be);default:if(ye)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),ye=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(se,ae,oe){return ae===0&&oe===se.length?g.fromByteArray(se):g.fromByteArray(se.slice(ae,oe))}function z(se,ae,oe){oe=Math.min(se.length,oe);for(var be=[],ce=ae;ce<oe;){var de=se[ce],ye=null,ge=de>239?4:de>223?3:de>191?2:1;if(ce+ge<=oe){var me,Ee,Pe,Ue;switch(ge){case 1:de<128&&(ye=de);break;case 2:me=se[ce+1],(me&192)===128&&(Ue=(de&31)<<6|me&63,Ue>127&&(ye=Ue));break;case 3:me=se[ce+1],Ee=se[ce+2],(me&192)===128&&(Ee&192)===128&&(Ue=(de&15)<<12|(me&63)<<6|Ee&63,Ue>2047&&(Ue<55296||Ue>57343)&&(ye=Ue));break;case 4:me=se[ce+1],Ee=se[ce+2],Pe=se[ce+3],(me&192)===128&&(Ee&192)===128&&(Pe&192)===128&&(Ue=(de&15)<<18|(me&63)<<12|(Ee&63)<<6|Pe&63,Ue>65535&&Ue<1114112&&(ye=Ue))}}ye===null?(ye=65533,ge=1):ye>65535&&(ye-=65536,be.push(ye>>>10&1023|55296),ye=56320|ye&1023),be.push(ye),ce+=ge}return D(be)}var I=4096;function D(se){var ae=se.length;if(ae<=I)return String.fromCharCode.apply(String,se);for(var oe="",be=0;be<ae;)oe+=String.fromCharCode.apply(String,se.slice(be,be+=I));return oe}function R(se,ae,oe){var be="";oe=Math.min(se.length,oe);for(var ce=ae;ce<oe;++ce)be+=String.fromCharCode(se[ce]&127);return be}function O(se,ae,oe){var be="";oe=Math.min(se.length,oe);for(var ce=ae;ce<oe;++ce)be+=String.fromCharCode(se[ce]);return be}function F(se,ae,oe){var be=se.length;(!ae||ae<0)&&(ae=0),(!oe||oe<0||oe>be)&&(oe=be);for(var ce="",de=ae;de<oe;++de)ce+=q(se[de]);return ce}function N(se,ae,oe){for(var be=se.slice(ae,oe),ce="",de=0;de<be.length;de+=2)ce+=String.fromCharCode(be[de]+be[de+1]*256);return ce}n.prototype.slice=function(ae,oe){var be=this.length;ae=~~ae,oe=oe===void 0?be:~~oe,ae<0?(ae+=be,ae<0&&(ae=0)):ae>be&&(ae=be),oe<0?(oe+=be,oe<0&&(oe=0)):oe>be&&(oe=be),oe<ae&&(oe=ae);var ce=this.subarray(ae,oe);return ce.__proto__=n.prototype,ce};function G(se,ae,oe){if(se%1!==0||se<0)throw new RangeError("offset is not uint");if(se+ae>oe)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUIntLE=function(ae,oe,be){ae=ae>>>0,oe=oe>>>0,be||G(ae,oe,this.length);for(var ce=this[ae],de=1,ye=0;++ye<oe&&(de*=256);)ce+=this[ae+ye]*de;return ce},n.prototype.readUIntBE=function(ae,oe,be){ae=ae>>>0,oe=oe>>>0,be||G(ae,oe,this.length);for(var ce=this[ae+--oe],de=1;oe>0&&(de*=256);)ce+=this[ae+--oe]*de;return ce},n.prototype.readUInt8=function(ae,oe){return ae=ae>>>0,oe||G(ae,1,this.length),this[ae]},n.prototype.readUInt16LE=function(ae,oe){return ae=ae>>>0,oe||G(ae,2,this.length),this[ae]|this[ae+1]<<8},n.prototype.readUInt16BE=function(ae,oe){return ae=ae>>>0,oe||G(ae,2,this.length),this[ae]<<8|this[ae+1]},n.prototype.readUInt32LE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),(this[ae]|this[ae+1]<<8|this[ae+2]<<16)+this[ae+3]*16777216},n.prototype.readUInt32BE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),this[ae]*16777216+(this[ae+1]<<16|this[ae+2]<<8|this[ae+3])},n.prototype.readIntLE=function(ae,oe,be){ae=ae>>>0,oe=oe>>>0,be||G(ae,oe,this.length);for(var ce=this[ae],de=1,ye=0;++ye<oe&&(de*=256);)ce+=this[ae+ye]*de;return de*=128,ce>=de&&(ce-=Math.pow(2,8*oe)),ce},n.prototype.readIntBE=function(ae,oe,be){ae=ae>>>0,oe=oe>>>0,be||G(ae,oe,this.length);for(var ce=oe,de=1,ye=this[ae+--ce];ce>0&&(de*=256);)ye+=this[ae+--ce]*de;return de*=128,ye>=de&&(ye-=Math.pow(2,8*oe)),ye},n.prototype.readInt8=function(ae,oe){return ae=ae>>>0,oe||G(ae,1,this.length),this[ae]&128?(255-this[ae]+1)*-1:this[ae]},n.prototype.readInt16LE=function(ae,oe){ae=ae>>>0,oe||G(ae,2,this.length);var be=this[ae]|this[ae+1]<<8;return be&32768?be|4294901760:be},n.prototype.readInt16BE=function(ae,oe){ae=ae>>>0,oe||G(ae,2,this.length);var be=this[ae+1]|this[ae]<<8;return be&32768?be|4294901760:be},n.prototype.readInt32LE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),this[ae]|this[ae+1]<<8|this[ae+2]<<16|this[ae+3]<<24},n.prototype.readInt32BE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),this[ae]<<24|this[ae+1]<<16|this[ae+2]<<8|this[ae+3]},n.prototype.readFloatLE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),S.read(this,ae,!0,23,4)},n.prototype.readFloatBE=function(ae,oe){return ae=ae>>>0,oe||G(ae,4,this.length),S.read(this,ae,!1,23,4)},n.prototype.readDoubleLE=function(ae,oe){return ae=ae>>>0,oe||G(ae,8,this.length),S.read(this,ae,!0,52,8)},n.prototype.readDoubleBE=function(ae,oe){return ae=ae>>>0,oe||G(ae,8,this.length),S.read(this,ae,!1,52,8)};function K(se,ae,oe,be,ce,de){if(!n.isBuffer(se))throw new TypeError('"buffer" argument must be a Buffer instance');if(ae>ce||ae<de)throw new RangeError('"value" argument is out of bounds');if(oe+be>se.length)throw new RangeError("Index out of range")}n.prototype.writeUIntLE=function(ae,oe,be,ce){if(ae=+ae,oe=oe>>>0,be=be>>>0,!ce){var de=Math.pow(2,8*be)-1;K(this,ae,oe,be,de,0)}var ye=1,ge=0;for(this[oe]=ae&255;++ge<be&&(ye*=256);)this[oe+ge]=ae/ye&255;return oe+be},n.prototype.writeUIntBE=function(ae,oe,be,ce){if(ae=+ae,oe=oe>>>0,be=be>>>0,!ce){var de=Math.pow(2,8*be)-1;K(this,ae,oe,be,de,0)}var ye=be-1,ge=1;for(this[oe+ye]=ae&255;--ye>=0&&(ge*=256);)this[oe+ye]=ae/ge&255;return oe+be},n.prototype.writeUInt8=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,1,255,0),this[oe]=ae&255,oe+1},n.prototype.writeUInt16LE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,2,65535,0),this[oe]=ae&255,this[oe+1]=ae>>>8,oe+2},n.prototype.writeUInt16BE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,2,65535,0),this[oe]=ae>>>8,this[oe+1]=ae&255,oe+2},n.prototype.writeUInt32LE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,4,4294967295,0),this[oe+3]=ae>>>24,this[oe+2]=ae>>>16,this[oe+1]=ae>>>8,this[oe]=ae&255,oe+4},n.prototype.writeUInt32BE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,4,4294967295,0),this[oe]=ae>>>24,this[oe+1]=ae>>>16,this[oe+2]=ae>>>8,this[oe+3]=ae&255,oe+4},n.prototype.writeIntLE=function(ae,oe,be,ce){if(ae=+ae,oe=oe>>>0,!ce){var de=Math.pow(2,8*be-1);K(this,ae,oe,be,de-1,-de)}var ye=0,ge=1,me=0;for(this[oe]=ae&255;++ye<be&&(ge*=256);)ae<0&&me===0&&this[oe+ye-1]!==0&&(me=1),this[oe+ye]=(ae/ge>>0)-me&255;return oe+be},n.prototype.writeIntBE=function(ae,oe,be,ce){if(ae=+ae,oe=oe>>>0,!ce){var de=Math.pow(2,8*be-1);K(this,ae,oe,be,de-1,-de)}var ye=be-1,ge=1,me=0;for(this[oe+ye]=ae&255;--ye>=0&&(ge*=256);)ae<0&&me===0&&this[oe+ye+1]!==0&&(me=1),this[oe+ye]=(ae/ge>>0)-me&255;return oe+be},n.prototype.writeInt8=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,1,127,-128),ae<0&&(ae=255+ae+1),this[oe]=ae&255,oe+1},n.prototype.writeInt16LE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,2,32767,-32768),this[oe]=ae&255,this[oe+1]=ae>>>8,oe+2},n.prototype.writeInt16BE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,2,32767,-32768),this[oe]=ae>>>8,this[oe+1]=ae&255,oe+2},n.prototype.writeInt32LE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,4,2147483647,-2147483648),this[oe]=ae&255,this[oe+1]=ae>>>8,this[oe+2]=ae>>>16,this[oe+3]=ae>>>24,oe+4},n.prototype.writeInt32BE=function(ae,oe,be){return ae=+ae,oe=oe>>>0,be||K(this,ae,oe,4,2147483647,-2147483648),ae<0&&(ae=4294967295+ae+1),this[oe]=ae>>>24,this[oe+1]=ae>>>16,this[oe+2]=ae>>>8,this[oe+3]=ae&255,oe+4};function W(se,ae,oe,be,ce,de){if(oe+be>se.length)throw new RangeError("Index out of range");if(oe<0)throw new RangeError("Index out of range")}function Y(se,ae,oe,be,ce){return ae=+ae,oe=oe>>>0,ce||W(se,ae,oe,4),S.write(se,ae,oe,be,23,4),oe+4}n.prototype.writeFloatLE=function(ae,oe,be){return Y(this,ae,oe,!0,be)},n.prototype.writeFloatBE=function(ae,oe,be){return Y(this,ae,oe,!1,be)};function re(se,ae,oe,be,ce){return ae=+ae,oe=oe>>>0,ce||W(se,ae,oe,8),S.write(se,ae,oe,be,52,8),oe+8}n.prototype.writeDoubleLE=function(ae,oe,be){return re(this,ae,oe,!0,be)},n.prototype.writeDoubleBE=function(ae,oe,be){return re(this,ae,oe,!1,be)},n.prototype.copy=function(ae,oe,be,ce){if(!n.isBuffer(ae))throw new TypeError("argument should be a Buffer");if(be||(be=0),!ce&&ce!==0&&(ce=this.length),oe>=ae.length&&(oe=ae.length),oe||(oe=0),ce>0&&ce<be&&(ce=be),ce===be||ae.length===0||this.length===0)return 0;if(oe<0)throw new RangeError("targetStart out of bounds");if(be<0||be>=this.length)throw new RangeError("Index out of range");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),ae.length-oe<ce-be&&(ce=ae.length-oe+be);var de=ce-be;if(this===ae&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(oe,be,ce);else if(this===ae&&be<oe&&oe<ce)for(var ye=de-1;ye>=0;--ye)ae[ye+oe]=this[ye+be];else Uint8Array.prototype.set.call(ae,this.subarray(be,ce),oe);return de},n.prototype.fill=function(ae,oe,be,ce){if(typeof ae=="string"){if(typeof oe=="string"?(ce=oe,oe=0,be=this.length):typeof be=="string"&&(ce=be,be=this.length),ce!==void 0&&typeof ce!="string")throw new TypeError("encoding must be a string");if(typeof ce=="string"&&!n.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);if(ae.length===1){var de=ae.charCodeAt(0);(ce==="utf8"&&de<128||ce==="latin1")&&(ae=de)}}else typeof ae=="number"&&(ae=ae&255);if(oe<0||this.length<oe||this.length<be)throw new RangeError("Out of range index");if(be<=oe)return this;oe=oe>>>0,be=be===void 0?this.length:be>>>0,ae||(ae=0);var ye;if(typeof ae=="number")for(ye=oe;ye<be;++ye)this[ye]=ae;else{var ge=n.isBuffer(ae)?ae:n.from(ae,ce),me=ge.length;if(me===0)throw new TypeError('The value "'+ae+'" is invalid for argument "value"');for(ye=0;ye<be-oe;++ye)this[ye+oe]=ge[ye%me]}return this};var ue=/[^+/0-9A-Za-z-_]/g;function j(se){if(se=se.split("=")[0],se=se.trim().replace(ue,""),se.length<2)return"";for(;se.length%4!==0;)se=se+"=";return se}function q(se){return se<16?"0"+se.toString(16):se.toString(16)}function H(se,ae){ae=ae||1/0;for(var oe,be=se.length,ce=null,de=[],ye=0;ye<be;++ye){if(oe=se.charCodeAt(ye),oe>55295&&oe<57344){if(!ce){if(oe>56319){(ae-=3)>-1&&de.push(239,191,189);continue}else if(ye+1===be){(ae-=3)>-1&&de.push(239,191,189);continue}ce=oe;continue}if(oe<56320){(ae-=3)>-1&&de.push(239,191,189),ce=oe;continue}oe=(ce-55296<<10|oe-56320)+65536}else ce&&(ae-=3)>-1&&de.push(239,191,189);if(ce=null,oe<128){if((ae-=1)<0)break;de.push(oe)}else if(oe<2048){if((ae-=2)<0)break;de.push(oe>>6|192,oe&63|128)}else if(oe<65536){if((ae-=3)<0)break;de.push(oe>>12|224,oe>>6&63|128,oe&63|128)}else if(oe<1114112){if((ae-=4)<0)break;de.push(oe>>18|240,oe>>12&63|128,oe>>6&63|128,oe&63|128)}else throw new Error("Invalid code point")}return de}function U(se){for(var ae=[],oe=0;oe<se.length;++oe)ae.push(se.charCodeAt(oe)&255);return ae}function $(se,ae){for(var oe,be,ce,de=[],ye=0;ye<se.length&&!((ae-=2)<0);++ye)oe=se.charCodeAt(ye),be=oe>>8,ce=oe%256,de.push(ce),de.push(be);return de}function ne(se){return g.toByteArray(j(se))}function X(se,ae,oe,be){for(var ce=0;ce<be&&!(ce+oe>=ae.length||ce>=se.length);++ce)ae[ce+oe]=se[ce];return ce}function Q(se,ae){return se instanceof ae||se!=null&&se.constructor!=null&&se.constructor.name!=null&&se.constructor.name===ae.name}function ie(se){return se!==se}}).call(this)}).call(this,y("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(y,ee,te){ee.exports=A;function A(g,S,M){return S<M?g<S?S:g>M?M:g:g<M?M:g>S?S:g}},{}],87:[function(y,ee,te){var A=y("clamp");ee.exports=g,ee.exports.to=g,ee.exports.from=S;function g(M,e){e==null&&(e=!0);var a=M[0],n=M[1],r=M[2],t=M[3];t==null&&(t=e?1:255),e&&(a*=255,n*=255,r*=255,t*=255),a=A(a,0,255)&255,n=A(n,0,255)&255,r=A(r,0,255)&255,t=A(t,0,255)&255;var h=a*16777216+(n<<16)+(r<<8)+t;return h}function S(M,e){M=+M;var a=M>>>24,n=(M&16711680)>>>16,r=(M&65280)>>>8,t=M&255;return e===!1?[a,n,r,t]:[a/255,n/255,r/255,t/255]}},{clamp:86}],88:[function(y,ee,te){ee.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(y,ee,te){var A=y("color-rgba"),g=y("clamp"),S=y("dtype");ee.exports=function(a,n){(n==="float"||!n)&&(n="array"),n==="uint"&&(n="uint8"),n==="uint_clamped"&&(n="uint8_clamped");var r=S(n),t=new r(4),h=n!=="uint8"&&n!=="uint8_clamped";return(!a.length||typeof a=="string")&&(a=A(a),a[0]/=255,a[1]/=255,a[2]/=255),M(a)?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3]!=null?a[3]:255,h&&(t[0]/=255,t[1]/=255,t[2]/=255,t[3]/=255),t):(h?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3]!=null?a[3]:1):(t[0]=g(Math.floor(a[0]*255),0,255),t[1]=g(Math.floor(a[1]*255),0,255),t[2]=g(Math.floor(a[2]*255),0,255),t[3]=a[3]==null?255:g(Math.floor(a[3]*255),0,255)),t)};function M(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray||Array.isArray(e)&&(e[0]>1||e[0]===0)&&(e[1]>1||e[1]===0)&&(e[2]>1||e[2]===0)&&(!e[3]||e[3]>1))}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(y,ee,te){(function(A){(function(){var g=y("color-name"),S=y("is-plain-obj"),M=y("defined");ee.exports=a;var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function a(n){var r,t=[],h=1,s;if(typeof n=="string")if(g[n])t=g[n].slice(),s="rgb";else if(n==="transparent")h=0,s="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var i=n.slice(1),x=i.length,p=x<=4;h=1,p?(t=[parseInt(i[0]+i[0],16),parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16)],x===4&&(h=parseInt(i[3]+i[3],16)/255)):(t=[parseInt(i[0]+i[1],16),parseInt(i[2]+i[3],16),parseInt(i[4]+i[5],16)],x===8&&(h=parseInt(i[6]+i[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),s="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var v=r[1],f=v==="rgb",i=v.replace(/a$/,"");s=i;var x=i==="cmyk"?4:i==="gray"?1:3;t=r[2].trim().split(/\s*,\s*/).map(function(l,w){if(/%$/.test(l))return w===x?parseFloat(l)/100:i==="rgb"?parseFloat(l)*255/100:parseFloat(l);if(i[w]==="h"){if(/deg$/.test(l))return parseFloat(l);if(e[l]!==void 0)return e[l]}return parseFloat(l)}),v===i&&t.push(1),h=f||t[x]===void 0?1:t[x],t=t.slice(0,x)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(t=n.match(/([0-9]+)/g).map(function(o){return parseFloat(o)}),s=n.match(/([a-z])/ig).join("").toLowerCase());else if(!isNaN(n))s="rgb",t=[n>>>16,(n&65280)>>>8,n&255];else if(S(n)){var d=M(n.r,n.red,n.R,null);d!==null?(s="rgb",t=[d,M(n.g,n.green,n.G),M(n.b,n.blue,n.B)]):(s="hsl",t=[M(n.h,n.hue,n.H),M(n.s,n.saturation,n.S),M(n.l,n.lightness,n.L,n.b,n.brightness)]),h=M(n.a,n.alpha,n.opacity,1),n.opacity!=null&&(h/=100)}else(Array.isArray(n)||A.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(n))&&(t=[n[0],n[1],n[2]],s="rgb",h=n.length===4?n[3]:1);return{space:s,values:t,alpha:h}}}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(y,ee,te){var A=y("color-parse"),g=y("color-space/hsl"),S=y("clamp");ee.exports=function(e){var a,n=A(e);return n.space?(a=Array(3),a[0]=S(n.values[0],0,255),a[1]=S(n.values[1],0,255),a[2]=S(n.values[2],0,255),n.space[0]==="h"&&(a=g.rgb(a)),a.push(S(n.alpha,0,1)),a):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(y,ee,te){var A=y("./rgb");ee.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(g){var S=g[0]/360,M=g[1]/100,e=g[2]/100,a,n,r,t,h;if(M===0)return h=e*255,[h,h,h];e<.5?n=e*(1+M):n=e+M-e*M,a=2*e-n,t=[0,0,0];for(var s=0;s<3;s++)r=S+1/3*-(s-1),r<0?r++:r>1&&r--,6*r<1?h=a+(n-a)*6*r:2*r<1?h=n:3*r<2?h=a+(n-a)*(2/3-r)*6:h=a,t[s]=h*255;return t}},A.hsl=function(g){var S=g[0]/255,M=g[1]/255,e=g[2]/255,a=Math.min(S,M,e),n=Math.max(S,M,e),r=n-a,t,h,s;return n===a?t=0:S===n?t=(M-e)/r:M===n?t=2+(e-S)/r:e===n&&(t=4+(S-M)/r),t=Math.min(t*60,360),t<0&&(t+=360),s=(a+n)/2,n===a?h=0:s<=.5?h=r/(n+a):h=r/(2-n-a),[t,h*100,s*100]}},{"./rgb":93}],93:[function(y,ee,te){ee.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(y,ee,te){ee.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|)o.?tom(e|)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(y,ee,te){ee.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(y,ee,te){ee.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(y,ee,te){ee.exports=["normal","italic","oblique"]},{}],98:[function(y,ee,te){ee.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(y,ee,te){ee.exports={parse:y("./parse"),stringify:y("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(y,ee,te){var A=y("css-font-size-keywords");ee.exports={isSize:function(S){return/^[\d\.]/.test(S)||S.indexOf("/")!==-1||A.indexOf(S)!==-1}}},{"css-font-size-keywords":95}],101:[function(y,ee,te){var A=y("unquote"),g=y("css-global-keywords"),S=y("css-system-font-keywords"),M=y("css-font-weight-keywords"),e=y("css-font-style-keywords"),a=y("css-font-stretch-keywords"),n=y("string-split-by"),r=y("./lib/util").isSize;ee.exports=h;var t=h.cache={};function h(i){if(typeof i!="string")throw new Error("Font argument must be a string.");if(t[i])return t[i];if(i==="")throw new Error("Cannot parse an empty string.");if(S.indexOf(i)!==-1)return t[i]={system:i};for(var x={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},p=n(i,/\s+/),v;v=p.shift();){if(g.indexOf(v)!==-1)return["style","variant","weight","stretch"].forEach(function(d){x[d]=v}),t[i]=x;if(e.indexOf(v)!==-1){x.style=v;continue}if(v==="normal"||v==="small-caps"){x.variant=v;continue}if(a.indexOf(v)!==-1){x.stretch=v;continue}if(M.indexOf(v)!==-1){x.weight=v;continue}if(r(v)){var f=n(v,"/");if(x.size=f[0],f[1]!=null?x.lineHeight=s(f[1]):p[0]==="/"&&(p.shift(),x.lineHeight=s(p.shift())),!p.length)throw new Error("Missing required font-family.");return x.family=n(p.join(" "),/\s*,\s*/).map(A),t[i]=x}throw new Error("Unknown or unsupported font token: "+v)}throw new Error("Missing required font-size.")}function s(i){var x=parseFloat(i);return x.toString()===i?x:i}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(y,ee,te){var A=y("pick-by-alias"),g=y("./lib/util").isSize,S=i(y("css-global-keywords")),M=i(y("css-system-font-keywords")),e=i(y("css-font-weight-keywords")),a=i(y("css-font-style-keywords")),n=i(y("css-font-stretch-keywords")),r={normal:1,"small-caps":1},t={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},h={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};ee.exports=function(p){if(p=A(p,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),p.system)return p.system&&s(p.system,M),p.system;if(s(p.style,a),s(p.variant,r),s(p.weight,e),s(p.stretch,n),p.size==null&&(p.size=h.size),typeof p.size=="number"&&(p.size+="px"),!g)throw Error("Bad size value `"+p.size+"`");p.family||(p.family=h.family),Array.isArray(p.family)&&(p.family.length||(p.family=[h.family]),p.family=p.family.map(function(f){return t[f]?f:'"'+f+'"'}).join(", "));var v=[];return v.push(p.style),p.variant!==p.style&&v.push(p.variant),p.weight!==p.variant&&p.weight!==p.style&&v.push(p.weight),p.stretch!==p.weight&&p.stretch!==p.variant&&p.stretch!==p.style&&v.push(p.stretch),v.push(p.size+(p.lineHeight==null||p.lineHeight==="normal"||p.lineHeight+""=="1"?"":"/"+p.lineHeight)),v.push(p.family),v.filter(Boolean).join(" ")};function s(x,p){if(x&&!p[x]&&!S[x])throw Error("Unknown keyword `"+x+"`");return x}function i(x){for(var p={},v=0;v<x.length;v++)p[x[v]]=1;return p}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(y,ee,te){ee.exports=["inherit","initial","unset"]},{}],104:[function(y,ee,te){ee.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(y,ee,te){var A=y("type/value/is"),g=y("type/value/ensure"),S=y("type/plain-function/ensure"),M=y("es5-ext/object/copy"),e=y("es5-ext/object/normalize-options"),a=y("es5-ext/object/map"),n=Function.prototype.bind,r=Object.defineProperty,t=Object.prototype.hasOwnProperty,h;h=function(s,i,x){var p=g(i)&&S(i.value),v;return v=M(i),delete v.writable,delete v.value,v.get=function(){return!x.overwriteDefinition&&t.call(this,s)?p:(i.value=n.call(p,x.resolveContext?x.resolveContext(this):this),r(this,s,i),this[s])},v},ee.exports=function(s){var i=e(arguments[1]);return A(i.resolveContext)&&S(i.resolveContext),a(s,function(x,p){return h(p,x,i)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(y,ee,te){var A=y("type/value/is"),g=y("type/plain-function/is"),S=y("es5-ext/object/assign"),M=y("es5-ext/object/normalize-options"),e=y("es5-ext/string/#/contains"),a=ee.exports=function(n,r){var t,h,s,i,x;return arguments.length<2||typeof n!="string"?(i=r,r=n,n=null):i=arguments[2],A(n)?(t=e.call(n,"c"),h=e.call(n,"e"),s=e.call(n,"w")):(t=s=!0,h=!1),x={value:r,configurable:t,enumerable:h,writable:s},i?S(M(i),x):x};a.gs=function(n,r,t){var h,s,i,x;return typeof n!="string"?(i=t,t=r,r=n,n=null):i=arguments[3],A(r)?g(r)?A(t)?g(t)||(i=t,t=void 0):t=void 0:(i=r,r=t=void 0):r=void 0,A(n)?(h=e.call(n,"c"),s=e.call(n,"e")):(h=!0,s=!1),x={get:r,set:t,configurable:h,enumerable:s},i?S(M(i),x):x}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(y,ee,te){(function(A,g){g(typeof te=="object"&&typeof ee<"u"?te:A.d3=A.d3||{})})(this,function(A){function g(H,U){return H<U?-1:H>U?1:H>=U?0:NaN}function S(H){return H.length===1&&(H=M(H)),{left:function(U,$,ne,X){for(ne==null&&(ne=0),X==null&&(X=U.length);ne<X;){var Q=ne+X>>>1;H(U[Q],$)<0?ne=Q+1:X=Q}return ne},right:function(U,$,ne,X){for(ne==null&&(ne=0),X==null&&(X=U.length);ne<X;){var Q=ne+X>>>1;H(U[Q],$)>0?X=Q:ne=Q+1}return ne}}}function M(H){return function(U,$){return g(H(U),$)}}var e=S(g),a=e.right,n=e.left;function r(H,U){U==null&&(U=t);for(var $=0,ne=H.length-1,X=H[0],Q=new Array(ne<0?0:ne);$<ne;)Q[$]=U(X,X=H[++$]);return Q}function t(H,U){return[H,U]}function h(H,U,$){var ne=H.length,X=U.length,Q=new Array(ne*X),ie,se,ae,oe;for($==null&&($=t),ie=ae=0;ie<ne;++ie)for(oe=H[ie],se=0;se<X;++se,++ae)Q[ae]=$(oe,U[se]);return Q}function s(H,U){return U<H?-1:U>H?1:U>=H?0:NaN}function i(H){return H===null?NaN:+H}function x(H,U){var $=H.length,ne=0,X=-1,Q=0,ie,se,ae=0;if(U==null)for(;++X<$;)isNaN(ie=i(H[X]))||(se=ie-Q,Q+=se/++ne,ae+=se*(ie-Q));else for(;++X<$;)isNaN(ie=i(U(H[X],X,H)))||(se=ie-Q,Q+=se/++ne,ae+=se*(ie-Q));if(ne>1)return ae/(ne-1)}function p(H,U){var $=x(H,U);return $&&Math.sqrt($)}function v(H,U){var $=H.length,ne=-1,X,Q,ie;if(U==null){for(;++ne<$;)if((X=H[ne])!=null&&X>=X)for(Q=ie=X;++ne<$;)(X=H[ne])!=null&&(Q>X&&(Q=X),ie<X&&(ie=X))}else for(;++ne<$;)if((X=U(H[ne],ne,H))!=null&&X>=X)for(Q=ie=X;++ne<$;)(X=U(H[ne],ne,H))!=null&&(Q>X&&(Q=X),ie<X&&(ie=X));return[Q,ie]}var f=Array.prototype,d=f.slice,o=f.map;function m(H){return function(){return H}}function l(H){return H}function w(H,U,$){H=+H,U=+U,$=(X=arguments.length)<2?(U=H,H=0,1):X<3?1:+$;for(var ne=-1,X=Math.max(0,Math.ceil((U-H)/$))|0,Q=new Array(X);++ne<X;)Q[ne]=H+ne*$;return Q}var _=Math.sqrt(50),c=Math.sqrt(10),b=Math.sqrt(2);function u(H,U,$){var ne,X=-1,Q,ie,se;if(U=+U,H=+H,$=+$,H===U&&$>0)return[H];if((ne=U<H)&&(Q=H,H=U,U=Q),(se=L(H,U,$))===0||!isFinite(se))return[];if(se>0)for(H=Math.ceil(H/se),U=Math.floor(U/se),ie=new Array(Q=Math.ceil(U-H+1));++X<Q;)ie[X]=(H+X)*se;else for(H=Math.floor(H*se),U=Math.ceil(U*se),ie=new Array(Q=Math.ceil(H-U+1));++X<Q;)ie[X]=(H-X)/se;return ne&&ie.reverse(),ie}function L(H,U,$){var ne=(U-H)/Math.max(0,$),X=Math.floor(Math.log(ne)/Math.LN10),Q=ne/Math.pow(10,X);return X>=0?(Q>=_?10:Q>=c?5:Q>=b?2:1)*Math.pow(10,X):-Math.pow(10,-X)/(Q>=_?10:Q>=c?5:Q>=b?2:1)}function T(H,U,$){var ne=Math.abs(U-H)/Math.max(0,$),X=Math.pow(10,Math.floor(Math.log(ne)/Math.LN10)),Q=ne/X;return Q>=_?X*=10:Q>=c?X*=5:Q>=b&&(X*=2),U<H?-X:X}function k(H){return Math.ceil(Math.log(H.length)/Math.LN2)+1}function P(){var H=l,U=v,$=k;function ne(X){var Q,ie=X.length,se,ae=new Array(ie);for(Q=0;Q<ie;++Q)ae[Q]=H(X[Q],Q,X);var oe=U(ae),be=oe[0],ce=oe[1],de=$(ae,be,ce);Array.isArray(de)||(de=T(be,ce,de),de=w(Math.ceil(be/de)*de,ce,de));for(var ye=de.length;de[0]<=be;)de.shift(),--ye;for(;de[ye-1]>ce;)de.pop(),--ye;var ge=new Array(ye+1),me;for(Q=0;Q<=ye;++Q)me=ge[Q]=[],me.x0=Q>0?de[Q-1]:be,me.x1=Q<ye?de[Q]:ce;for(Q=0;Q<ie;++Q)se=ae[Q],be<=se&&se<=ce&&ge[a(de,se,0,ye)].push(X[Q]);return ge}return ne.value=function(X){return arguments.length?(H=typeof X=="function"?X:m(X),ne):H},ne.domain=function(X){return arguments.length?(U=typeof X=="function"?X:m([X[0],X[1]]),ne):U},ne.thresholds=function(X){return arguments.length?($=typeof X=="function"?X:Array.isArray(X)?m(d.call(X)):m(X),ne):$},ne}function z(H,U,$){if($==null&&($=i),!!(ne=H.length)){if((U=+U)<=0||ne<2)return+$(H[0],0,H);if(U>=1)return+$(H[ne-1],ne-1,H);var ne,X=(ne-1)*U,Q=Math.floor(X),ie=+$(H[Q],Q,H),se=+$(H[Q+1],Q+1,H);return ie+(se-ie)*(X-Q)}}function I(H,U,$){return H=o.call(H,i).sort(g),Math.ceil(($-U)/(2*(z(H,.75)-z(H,.25))*Math.pow(H.length,-1/3)))}function D(H,U,$){return Math.ceil(($-U)/(3.5*p(H)*Math.pow(H.length,-1/3)))}function R(H,U){var $=H.length,ne=-1,X,Q;if(U==null){for(;++ne<$;)if((X=H[ne])!=null&&X>=X)for(Q=X;++ne<$;)(X=H[ne])!=null&&X>Q&&(Q=X)}else for(;++ne<$;)if((X=U(H[ne],ne,H))!=null&&X>=X)for(Q=X;++ne<$;)(X=U(H[ne],ne,H))!=null&&X>Q&&(Q=X);return Q}function O(H,U){var $=H.length,ne=$,X=-1,Q,ie=0;if(U==null)for(;++X<$;)isNaN(Q=i(H[X]))?--ne:ie+=Q;else for(;++X<$;)isNaN(Q=i(U(H[X],X,H)))?--ne:ie+=Q;if(ne)return ie/ne}function F(H,U){var $=H.length,ne=-1,X,Q=[];if(U==null)for(;++ne<$;)isNaN(X=i(H[ne]))||Q.push(X);else for(;++ne<$;)isNaN(X=i(U(H[ne],ne,H)))||Q.push(X);return z(Q.sort(g),.5)}function N(H){for(var U=H.length,$,ne=-1,X=0,Q,ie;++ne<U;)X+=H[ne].length;for(Q=new Array(X);--U>=0;)for(ie=H[U],$=ie.length;--$>=0;)Q[--X]=ie[$];return Q}function G(H,U){var $=H.length,ne=-1,X,Q;if(U==null){for(;++ne<$;)if((X=H[ne])!=null&&X>=X)for(Q=X;++ne<$;)(X=H[ne])!=null&&Q>X&&(Q=X)}else for(;++ne<$;)if((X=U(H[ne],ne,H))!=null&&X>=X)for(Q=X;++ne<$;)(X=U(H[ne],ne,H))!=null&&Q>X&&(Q=X);return Q}function K(H,U){for(var $=U.length,ne=new Array($);$--;)ne[$]=H[U[$]];return ne}function W(H,U){if($=H.length){var $,ne=0,X=0,Q,ie=H[X];for(U==null&&(U=g);++ne<$;)(U(Q=H[ne],ie)<0||U(ie,ie)!==0)&&(ie=Q,X=ne);if(U(ie,ie)===0)return X}}function Y(H,U,$){for(var ne=($??H.length)-(U=U==null?0:+U),X,Q;ne;)Q=Math.random()*ne--|0,X=H[ne+U],H[ne+U]=H[Q+U],H[Q+U]=X;return H}function re(H,U){var $=H.length,ne=-1,X,Q=0;if(U==null)for(;++ne<$;)(X=+H[ne])&&(Q+=X);else for(;++ne<$;)(X=+U(H[ne],ne,H))&&(Q+=X);return Q}function ue(H){if(!(Q=H.length))return[];for(var U=-1,$=G(H,j),ne=new Array($);++U<$;)for(var X=-1,Q,ie=ne[U]=new Array(Q);++X<Q;)ie[X]=H[X][U];return ne}function j(H){return H.length}function q(){return ue(arguments)}A.bisect=a,A.bisectRight=a,A.bisectLeft=n,A.ascending=g,A.bisector=S,A.cross=h,A.descending=s,A.deviation=p,A.extent=v,A.histogram=P,A.thresholdFreedmanDiaconis=I,A.thresholdScott=D,A.thresholdSturges=k,A.max=R,A.mean=O,A.median=F,A.merge=N,A.min=G,A.pairs=r,A.permute=K,A.quantile=z,A.range=w,A.scan=W,A.shuffle=Y,A.sum=re,A.ticks=u,A.tickIncrement=L,A.tickStep=T,A.transpose=ue,A.variance=x,A.zip=q,Object.defineProperty(A,"__esModule",{value:!0})})},{}],108:[function(y,ee,te){(function(A,g){g(typeof te=="object"&&typeof ee<"u"?te:A.d3=A.d3||{})})(this,function(A){var g="$";function S(){}S.prototype=M.prototype={constructor:S,has:function(f){return g+f in this},get:function(f){return this[g+f]},set:function(f,d){return this[g+f]=d,this},remove:function(f){var d=g+f;return d in this&&delete this[d]},clear:function(){for(var f in this)f[0]===g&&delete this[f]},keys:function(){var f=[];for(var d in this)d[0]===g&&f.push(d.slice(1));return f},values:function(){var f=[];for(var d in this)d[0]===g&&f.push(this[d]);return f},entries:function(){var f=[];for(var d in this)d[0]===g&&f.push({key:d.slice(1),value:this[d]});return f},size:function(){var f=0;for(var d in this)d[0]===g&&++f;return f},empty:function(){for(var f in this)if(f[0]===g)return!1;return!0},each:function(f){for(var d in this)d[0]===g&&f(this[d],d.slice(1),this)}};function M(f,d){var o=new S;if(f instanceof S)f.each(function(c,b){o.set(b,c)});else if(Array.isArray(f)){var m=-1,l=f.length,w;if(d==null)for(;++m<l;)o.set(m,f[m]);else for(;++m<l;)o.set(d(w=f[m],m,f),w)}else if(f)for(var _ in f)o.set(_,f[_]);return o}function e(){var f=[],d=[],o,m,l;function w(c,b,u,L){if(b>=f.length)return o!=null&&c.sort(o),m!=null?m(c):c;for(var T=-1,k=c.length,P=f[b++],z,I,D=M(),R,O=u();++T<k;)(R=D.get(z=P(I=c[T])+""))?R.push(I):D.set(z,[I]);return D.each(function(F,N){L(O,N,w(F,b,u,L))}),O}function _(c,b){if(++b>f.length)return c;var u,L=d[b-1];return m!=null&&b>=f.length?u=c.entries():(u=[],c.each(function(T,k){u.push({key:k,values:_(T,b)})})),L!=null?u.sort(function(T,k){return L(T.key,k.key)}):u}return l={object:function(c){return w(c,0,a,n)},map:function(c){return w(c,0,r,t)},entries:function(c){return _(w(c,0,r,t),0)},key:function(c){return f.push(c),l},sortKeys:function(c){return d[f.length-1]=c,l},sortValues:function(c){return o=c,l},rollup:function(c){return m=c,l}}}function a(){return{}}function n(f,d,o){f[d]=o}function r(){return M()}function t(f,d,o){f.set(d,o)}function h(){}var s=M.prototype;h.prototype=i.prototype={constructor:h,has:s.has,add:function(f){return f+="",this[g+f]=f,this},remove:s.remove,clear:s.clear,values:s.keys,size:s.size,empty:s.empty,each:s.each};function i(f,d){var o=new h;if(f instanceof h)f.each(function(w){o.add(w)});else if(f){var m=-1,l=f.length;if(d==null)for(;++m<l;)o.add(f[m]);else for(;++m<l;)o.add(d(f[m],m,f))}return o}function x(f){var d=[];for(var o in f)d.push(o);return d}function p(f){var d=[];for(var o in f)d.push(f[o]);return d}function v(f){var d=[];for(var o in f)d.push({key:o,value:f[o]});return d}A.nest=e,A.set=i,A.map=M,A.keys=x,A.values=p,A.entries=v,Object.defineProperty(A,"__esModule",{value:!0})})},{}],109:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){function g(De,Ye,vt){De.prototype=Ye.prototype=vt,vt.constructor=De}function S(De,Ye){var vt=Object.create(De.prototype);for(var Dt in Ye)vt[Dt]=Ye[Dt];return vt}function M(){}var e=.7,a=1/e,n="\\s*([+-]?\\d+)\\s*",r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",h=/^#([0-9a-f]{3,8})$/,s=new RegExp("^rgb\\("+[n,n,n]+"\\)$"),i=new RegExp("^rgb\\("+[t,t,t]+"\\)$"),x=new RegExp("^rgba\\("+[n,n,n,r]+"\\)$"),p=new RegExp("^rgba\\("+[t,t,t,r]+"\\)$"),v=new RegExp("^hsl\\("+[r,t,t]+"\\)$"),f=new RegExp("^hsla\\("+[r,t,t,r]+"\\)$"),d={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};g(M,w,{copy:function(De){return Object.assign(new this.constructor,this,De)},displayable:function(){return this.rgb().displayable()},hex:o,formatHex:o,formatHsl:m,formatRgb:l,toString:l});function o(){return this.rgb().formatHex()}function m(){return I(this).formatHsl()}function l(){return this.rgb().formatRgb()}function w(De){var Ye,vt;return De=(De+"").trim().toLowerCase(),(Ye=h.exec(De))?(vt=Ye[1].length,Ye=parseInt(Ye[1],16),vt===6?_(Ye):vt===3?new L(Ye>>8&15|Ye>>4&240,Ye>>4&15|Ye&240,(Ye&15)<<4|Ye&15,1):vt===8?c(Ye>>24&255,Ye>>16&255,Ye>>8&255,(Ye&255)/255):vt===4?c(Ye>>12&15|Ye>>8&240,Ye>>8&15|Ye>>4&240,Ye>>4&15|Ye&240,((Ye&15)<<4|Ye&15)/255):null):(Ye=s.exec(De))?new L(Ye[1],Ye[2],Ye[3],1):(Ye=i.exec(De))?new L(Ye[1]*255/100,Ye[2]*255/100,Ye[3]*255/100,1):(Ye=x.exec(De))?c(Ye[1],Ye[2],Ye[3],Ye[4]):(Ye=p.exec(De))?c(Ye[1]*255/100,Ye[2]*255/100,Ye[3]*255/100,Ye[4]):(Ye=v.exec(De))?z(Ye[1],Ye[2]/100,Ye[3]/100,1):(Ye=f.exec(De))?z(Ye[1],Ye[2]/100,Ye[3]/100,Ye[4]):d.hasOwnProperty(De)?_(d[De]):De==="transparent"?new L(NaN,NaN,NaN,0):null}function _(De){return new L(De>>16&255,De>>8&255,De&255,1)}function c(De,Ye,vt,Dt){return Dt<=0&&(De=Ye=vt=NaN),new L(De,Ye,vt,Dt)}function b(De){return De instanceof M||(De=w(De)),De?(De=De.rgb(),new L(De.r,De.g,De.b,De.opacity)):new L}function u(De,Ye,vt,Dt){return arguments.length===1?b(De):new L(De,Ye,vt,Dt??1)}function L(De,Ye,vt,Dt){this.r=+De,this.g=+Ye,this.b=+vt,this.opacity=+Dt}g(L,u,S(M,{brighter:function(De){return De=De==null?a:Math.pow(a,De),new L(this.r*De,this.g*De,this.b*De,this.opacity)},darker:function(De){return De=De==null?e:Math.pow(e,De),new L(this.r*De,this.g*De,this.b*De,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T,formatHex:T,formatRgb:k,toString:k}));function T(){return"#"+P(this.r)+P(this.g)+P(this.b)}function k(){var De=this.opacity;return De=isNaN(De)?1:Math.max(0,Math.min(1,De)),(De===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(De===1?")":", "+De+")")}function P(De){return De=Math.max(0,Math.min(255,Math.round(De)||0)),(De<16?"0":"")+De.toString(16)}function z(De,Ye,vt,Dt){return Dt<=0?De=Ye=vt=NaN:vt<=0||vt>=1?De=Ye=NaN:Ye<=0&&(De=NaN),new R(De,Ye,vt,Dt)}function I(De){if(De instanceof R)return new R(De.h,De.s,De.l,De.opacity);if(De instanceof M||(De=w(De)),!De)return new R;if(De instanceof R)return De;De=De.rgb();var Ye=De.r/255,vt=De.g/255,Dt=De.b/255,Kt=Math.min(Ye,vt,Dt),Ft=Math.max(Ye,vt,Dt),Mt=NaN,Xt=Ft-Kt,It=(Ft+Kt)/2;return Xt?(Ye===Ft?Mt=(vt-Dt)/Xt+(vt<Dt)*6:vt===Ft?Mt=(Dt-Ye)/Xt+2:Mt=(Ye-vt)/Xt+4,Xt/=It<.5?Ft+Kt:2-Ft-Kt,Mt*=60):Xt=It>0&&It<1?0:Mt,new R(Mt,Xt,It,De.opacity)}function D(De,Ye,vt,Dt){return arguments.length===1?I(De):new R(De,Ye,vt,Dt??1)}function R(De,Ye,vt,Dt){this.h=+De,this.s=+Ye,this.l=+vt,this.opacity=+Dt}g(R,D,S(M,{brighter:function(De){return De=De==null?a:Math.pow(a,De),new R(this.h,this.s,this.l*De,this.opacity)},darker:function(De){return De=De==null?e:Math.pow(e,De),new R(this.h,this.s,this.l*De,this.opacity)},rgb:function(){var De=this.h%360+(this.h<0)*360,Ye=isNaN(De)||isNaN(this.s)?0:this.s,vt=this.l,Dt=vt+(vt<.5?vt:1-vt)*Ye,Kt=2*vt-Dt;return new L(O(De>=240?De-240:De+120,Kt,Dt),O(De,Kt,Dt),O(De<120?De+240:De-120,Kt,Dt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var De=this.opacity;return De=isNaN(De)?1:Math.max(0,Math.min(1,De)),(De===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(De===1?")":", "+De+")")}}));function O(De,Ye,vt){return(De<60?Ye+(vt-Ye)*De/60:De<180?vt:De<240?Ye+(vt-Ye)*(240-De)/60:Ye)*255}var F=Math.PI/180,N=180/Math.PI,G=18,K=.96422,W=1,Y=.82521,re=4/29,ue=6/29,j=3*ue*ue,q=ue*ue*ue;function H(De){if(De instanceof ne)return new ne(De.l,De.a,De.b,De.opacity);if(De instanceof ce)return de(De);De instanceof L||(De=b(De));var Ye=se(De.r),vt=se(De.g),Dt=se(De.b),Kt=X((.2225045*Ye+.7168786*vt+.0606169*Dt)/W),Ft,Mt;return Ye===vt&&vt===Dt?Ft=Mt=Kt:(Ft=X((.4360747*Ye+.3850649*vt+.1430804*Dt)/K),Mt=X((.0139322*Ye+.0971045*vt+.7141733*Dt)/Y)),new ne(116*Kt-16,500*(Ft-Kt),200*(Kt-Mt),De.opacity)}function U(De,Ye){return new ne(De,0,0,Ye??1)}function $(De,Ye,vt,Dt){return arguments.length===1?H(De):new ne(De,Ye,vt,Dt??1)}function ne(De,Ye,vt,Dt){this.l=+De,this.a=+Ye,this.b=+vt,this.opacity=+Dt}g(ne,$,S(M,{brighter:function(De){return new ne(this.l+G*(De??1),this.a,this.b,this.opacity)},darker:function(De){return new ne(this.l-G*(De??1),this.a,this.b,this.opacity)},rgb:function(){var De=(this.l+16)/116,Ye=isNaN(this.a)?De:De+this.a/500,vt=isNaN(this.b)?De:De-this.b/200;return Ye=K*Q(Ye),De=W*Q(De),vt=Y*Q(vt),new L(ie(3.1338561*Ye-1.6168667*De-.4906146*vt),ie(-.9787684*Ye+1.9161415*De+.033454*vt),ie(.0719453*Ye-.2289914*De+1.4052427*vt),this.opacity)}}));function X(De){return De>q?Math.pow(De,1/3):De/j+re}function Q(De){return De>ue?De*De*De:j*(De-re)}function ie(De){return 255*(De<=.0031308?12.92*De:1.055*Math.pow(De,1/2.4)-.055)}function se(De){return(De/=255)<=.04045?De/12.92:Math.pow((De+.055)/1.055,2.4)}function ae(De){if(De instanceof ce)return new ce(De.h,De.c,De.l,De.opacity);if(De instanceof ne||(De=H(De)),De.a===0&&De.b===0)return new ce(NaN,0<De.l&&De.l<100?0:NaN,De.l,De.opacity);var Ye=Math.atan2(De.b,De.a)*N;return new ce(Ye<0?Ye+360:Ye,Math.sqrt(De.a*De.a+De.b*De.b),De.l,De.opacity)}function oe(De,Ye,vt,Dt){return arguments.length===1?ae(De):new ce(vt,Ye,De,Dt??1)}function be(De,Ye,vt,Dt){return arguments.length===1?ae(De):new ce(De,Ye,vt,Dt??1)}function ce(De,Ye,vt,Dt){this.h=+De,this.c=+Ye,this.l=+vt,this.opacity=+Dt}function de(De){if(isNaN(De.h))return new ne(De.l,0,0,De.opacity);var Ye=De.h*F;return new ne(De.l,Math.cos(Ye)*De.c,Math.sin(Ye)*De.c,De.opacity)}g(ce,be,S(M,{brighter:function(De){return new ce(this.h,this.c,this.l+G*(De??1),this.opacity)},darker:function(De){return new ce(this.h,this.c,this.l-G*(De??1),this.opacity)},rgb:function(){return de(this).rgb()}}));var ye=-.14861,ge=1.78277,me=-.29227,Ee=-.90649,Pe=1.97294,Ue=Pe*Ee,we=Pe*ge,ke=ge*me-Ee*ye;function Xe(De){if(De instanceof Ie)return new Ie(De.h,De.s,De.l,De.opacity);De instanceof L||(De=b(De));var Ye=De.r/255,vt=De.g/255,Dt=De.b/255,Kt=(ke*Dt+Ue*Ye-we*vt)/(ke+Ue-we),Ft=Dt-Kt,Mt=(Pe*(vt-Kt)-me*Ft)/Ee,Xt=Math.sqrt(Mt*Mt+Ft*Ft)/(Pe*Kt*(1-Kt)),It=Xt?Math.atan2(Mt,Ft)*N-120:NaN;return new Ie(It<0?It+360:It,Xt,Kt,De.opacity)}function Ve(De,Ye,vt,Dt){return arguments.length===1?Xe(De):new Ie(De,Ye,vt,Dt??1)}function Ie(De,Ye,vt,Dt){this.h=+De,this.s=+Ye,this.l=+vt,this.opacity=+Dt}g(Ie,Ve,S(M,{brighter:function(De){return De=De==null?a:Math.pow(a,De),new Ie(this.h,this.s,this.l*De,this.opacity)},darker:function(De){return De=De==null?e:Math.pow(e,De),new Ie(this.h,this.s,this.l*De,this.opacity)},rgb:function(){var De=isNaN(this.h)?0:(this.h+120)*F,Ye=+this.l,vt=isNaN(this.s)?0:this.s*Ye*(1-Ye),Dt=Math.cos(De),Kt=Math.sin(De);return new L(255*(Ye+vt*(ye*Dt+ge*Kt)),255*(Ye+vt*(me*Dt+Ee*Kt)),255*(Ye+vt*(Pe*Dt)),this.opacity)}})),A.color=w,A.cubehelix=Ve,A.gray=U,A.hcl=be,A.hsl=D,A.lab=$,A.lch=oe,A.rgb=u,Object.defineProperty(A,"__esModule",{value:!0})})},{}],110:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){var g={value:function(){}};function S(){for(var r=0,t=arguments.length,h={},s;r<t;++r){if(!(s=arguments[r]+"")||s in h||/[\s.]/.test(s))throw new Error("illegal type: "+s);h[s]=[]}return new M(h)}function M(r){this._=r}function e(r,t){return r.trim().split(/^|\s+/).map(function(h){var s="",i=h.indexOf(".");if(i>=0&&(s=h.slice(i+1),h=h.slice(0,i)),h&&!t.hasOwnProperty(h))throw new Error("unknown type: "+h);return{type:h,name:s}})}M.prototype=S.prototype={constructor:M,on:function(r,t){var h=this._,s=e(r+"",h),i,x=-1,p=s.length;if(arguments.length<2){for(;++x<p;)if((i=(r=s[x]).type)&&(i=a(h[i],r.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++x<p;)if(i=(r=s[x]).type)h[i]=n(h[i],r.name,t);else if(t==null)for(i in h)h[i]=n(h[i],r.name,null);return this},copy:function(){var r={},t=this._;for(var h in t)r[h]=t[h].slice();return new M(r)},call:function(r,t){if((i=arguments.length-2)>0)for(var h=new Array(i),s=0,i,x;s<i;++s)h[s]=arguments[s+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(x=this._[r],s=0,i=x.length;s<i;++s)x[s].value.apply(t,h)},apply:function(r,t,h){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var s=this._[r],i=0,x=s.length;i<x;++i)s[i].value.apply(t,h)}};function a(r,t){for(var h=0,s=r.length,i;h<s;++h)if((i=r[h]).name===t)return i.value}function n(r,t,h){for(var s=0,i=r.length;s<i;++s)if(r[s].name===t){r[s]=g,r=r.slice(0,s).concat(r.slice(s+1));break}return h!=null&&r.push({name:t,value:h}),r}A.dispatch=S,Object.defineProperty(A,"__esModule",{value:!0})})},{}],111:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,y("d3-quadtree"),y("d3-collection"),y("d3-dispatch"),y("d3-timer")):g(A.d3=A.d3||{},A.d3,A.d3,A.d3,A.d3)})(this,function(A,g,S,M,e){function a(b,u){var L;b==null&&(b=0),u==null&&(u=0);function T(){var k,P=L.length,z,I=0,D=0;for(k=0;k<P;++k)z=L[k],I+=z.x,D+=z.y;for(I=I/P-b,D=D/P-u,k=0;k<P;++k)z=L[k],z.x-=I,z.y-=D}return T.initialize=function(k){L=k},T.x=function(k){return arguments.length?(b=+k,T):b},T.y=function(k){return arguments.length?(u=+k,T):u},T}function n(b){return function(){return b}}function r(){return(Math.random()-.5)*1e-6}function t(b){return b.x+b.vx}function h(b){return b.y+b.vy}function s(b){var u,L,T=1,k=1;typeof b!="function"&&(b=n(b==null?1:+b));function P(){for(var D,R=u.length,O,F,N,G,K,W,Y=0;Y<k;++Y)for(O=g.quadtree(u,t,h).visitAfter(z),D=0;D<R;++D)F=u[D],K=L[F.index],W=K*K,N=F.x+F.vx,G=F.y+F.vy,O.visit(re);function re(ue,j,q,H,U){var $=ue.data,ne=ue.r,X=K+ne;if($){if($.index>F.index){var Q=N-$.x-$.vx,ie=G-$.y-$.vy,se=Q*Q+ie*ie;se<X*X&&(Q===0&&(Q=r(),se+=Q*Q),ie===0&&(ie=r(),se+=ie*ie),se=(X-(se=Math.sqrt(se)))/se*T,F.vx+=(Q*=se)*(X=(ne*=ne)/(W+ne)),F.vy+=(ie*=se)*X,$.vx-=Q*(X=1-X),$.vy-=ie*X)}return}return j>N+X||H<N-X||q>G+X||U<G-X}}function z(D){if(D.data)return D.r=L[D.data.index];for(var R=D.r=0;R<4;++R)D[R]&&D[R].r>D.r&&(D.r=D[R].r)}function I(){if(u){var D,R=u.length,O;for(L=new Array(R),D=0;D<R;++D)O=u[D],L[O.index]=+b(O,D,u)}}return P.initialize=function(D){u=D,I()},P.iterations=function(D){return arguments.length?(k=+D,P):k},P.strength=function(D){return arguments.length?(T=+D,P):T},P.radius=function(D){return arguments.length?(b=typeof D=="function"?D:n(+D),I(),P):b},P}function i(b){return b.index}function x(b,u){var L=b.get(u);if(!L)throw new Error("missing: "+u);return L}function p(b){var u=i,L=O,T,k=n(30),P,z,I,D,R=1;b==null&&(b=[]);function O(W){return 1/Math.min(I[W.source.index],I[W.target.index])}function F(W){for(var Y=0,re=b.length;Y<R;++Y)for(var ue=0,j,q,H,U,$,ne,X;ue<re;++ue)j=b[ue],q=j.source,H=j.target,U=H.x+H.vx-q.x-q.vx||r(),$=H.y+H.vy-q.y-q.vy||r(),ne=Math.sqrt(U*U+$*$),ne=(ne-P[ue])/ne*W*T[ue],U*=ne,$*=ne,H.vx-=U*(X=D[ue]),H.vy-=$*X,q.vx+=U*(X=1-X),q.vy+=$*X}function N(){if(z){var W,Y=z.length,re=b.length,ue=S.map(z,u),j;for(W=0,I=new Array(Y);W<re;++W)j=b[W],j.index=W,typeof j.source!="object"&&(j.source=x(ue,j.source)),typeof j.target!="object"&&(j.target=x(ue,j.target)),I[j.source.index]=(I[j.source.index]||0)+1,I[j.target.index]=(I[j.target.index]||0)+1;for(W=0,D=new Array(re);W<re;++W)j=b[W],D[W]=I[j.source.index]/(I[j.source.index]+I[j.target.index]);T=new Array(re),G(),P=new Array(re),K()}}function G(){if(z)for(var W=0,Y=b.length;W<Y;++W)T[W]=+L(b[W],W,b)}function K(){if(z)for(var W=0,Y=b.length;W<Y;++W)P[W]=+k(b[W],W,b)}return F.initialize=function(W){z=W,N()},F.links=function(W){return arguments.length?(b=W,N(),F):b},F.id=function(W){return arguments.length?(u=W,F):u},F.iterations=function(W){return arguments.length?(R=+W,F):R},F.strength=function(W){return arguments.length?(L=typeof W=="function"?W:n(+W),G(),F):L},F.distance=function(W){return arguments.length?(k=typeof W=="function"?W:n(+W),K(),F):k},F}function v(b){return b.x}function f(b){return b.y}var d=10,o=Math.PI*(3-Math.sqrt(5));function m(b){var u,L=1,T=.001,k=1-Math.pow(T,1/300),P=0,z=.6,I=S.map(),D=e.timer(O),R=M.dispatch("tick","end");b==null&&(b=[]);function O(){F(),R.call("tick",u),L<T&&(D.stop(),R.call("end",u))}function F(K){var W,Y=b.length,re;K===void 0&&(K=1);for(var ue=0;ue<K;++ue)for(L+=(P-L)*k,I.each(function(j){j(L)}),W=0;W<Y;++W)re=b[W],re.fx==null?re.x+=re.vx*=z:(re.x=re.fx,re.vx=0),re.fy==null?re.y+=re.vy*=z:(re.y=re.fy,re.vy=0);return u}function N(){for(var K=0,W=b.length,Y;K<W;++K){if(Y=b[K],Y.index=K,Y.fx!=null&&(Y.x=Y.fx),Y.fy!=null&&(Y.y=Y.fy),isNaN(Y.x)||isNaN(Y.y)){var re=d*Math.sqrt(K),ue=K*o;Y.x=re*Math.cos(ue),Y.y=re*Math.sin(ue)}(isNaN(Y.vx)||isNaN(Y.vy))&&(Y.vx=Y.vy=0)}}function G(K){return K.initialize&&K.initialize(b),K}return N(),u={tick:F,restart:function(){return D.restart(O),u},stop:function(){return D.stop(),u},nodes:function(K){return arguments.length?(b=K,N(),I.each(G),u):b},alpha:function(K){return arguments.length?(L=+K,u):L},alphaMin:function(K){return arguments.length?(T=+K,u):T},alphaDecay:function(K){return arguments.length?(k=+K,u):+k},alphaTarget:function(K){return arguments.length?(P=+K,u):P},velocityDecay:function(K){return arguments.length?(z=1-K,u):1-z},force:function(K,W){return arguments.length>1?(W==null?I.remove(K):I.set(K,G(W)),u):I.get(K)},find:function(K,W,Y){var re=0,ue=b.length,j,q,H,U,$;for(Y==null?Y=1/0:Y*=Y,re=0;re<ue;++re)U=b[re],j=K-U.x,q=W-U.y,H=j*j+q*q,H<Y&&($=U,Y=H);return $},on:function(K,W){return arguments.length>1?(R.on(K,W),u):R.on(K)}}}function l(){var b,u,L,T=n(-30),k,P=1,z=1/0,I=.81;function D(N){var G,K=b.length,W=g.quadtree(b,v,f).visitAfter(O);for(L=N,G=0;G<K;++G)u=b[G],W.visit(F)}function R(){if(b){var N,G=b.length,K;for(k=new Array(G),N=0;N<G;++N)K=b[N],k[K.index]=+T(K,N,b)}}function O(N){var G=0,K,W,Y=0,re,ue,j;if(N.length){for(re=ue=j=0;j<4;++j)(K=N[j])&&(W=Math.abs(K.value))&&(G+=K.value,Y+=W,re+=W*K.x,ue+=W*K.y);N.x=re/Y,N.y=ue/Y}else{K=N,K.x=K.data.x,K.y=K.data.y;do G+=k[K.data.index];while(K=K.next)}N.value=G}function F(N,G,K,W){if(!N.value)return!0;var Y=N.x-u.x,re=N.y-u.y,ue=W-G,j=Y*Y+re*re;if(ue*ue/I<j)return j<z&&(Y===0&&(Y=r(),j+=Y*Y),re===0&&(re=r(),j+=re*re),j<P&&(j=Math.sqrt(P*j)),u.vx+=Y*N.value*L/j,u.vy+=re*N.value*L/j),!0;if(N.length||j>=z)return;(N.data!==u||N.next)&&(Y===0&&(Y=r(),j+=Y*Y),re===0&&(re=r(),j+=re*re),j<P&&(j=Math.sqrt(P*j)));do N.data!==u&&(ue=k[N.data.index]*L/j,u.vx+=Y*ue,u.vy+=re*ue);while(N=N.next)}return D.initialize=function(N){b=N,R()},D.strength=function(N){return arguments.length?(T=typeof N=="function"?N:n(+N),R(),D):T},D.distanceMin=function(N){return arguments.length?(P=N*N,D):Math.sqrt(P)},D.distanceMax=function(N){return arguments.length?(z=N*N,D):Math.sqrt(z)},D.theta=function(N){return arguments.length?(I=N*N,D):Math.sqrt(I)},D}function w(b,u,L){var T,k=n(.1),P,z;typeof b!="function"&&(b=n(+b)),u==null&&(u=0),L==null&&(L=0);function I(R){for(var O=0,F=T.length;O<F;++O){var N=T[O],G=N.x-u||1e-6,K=N.y-L||1e-6,W=Math.sqrt(G*G+K*K),Y=(z[O]-W)*P[O]*R/W;N.vx+=G*Y,N.vy+=K*Y}}function D(){if(T){var R,O=T.length;for(P=new Array(O),z=new Array(O),R=0;R<O;++R)z[R]=+b(T[R],R,T),P[R]=isNaN(z[R])?0:+k(T[R],R,T)}}return I.initialize=function(R){T=R,D()},I.strength=function(R){return arguments.length?(k=typeof R=="function"?R:n(+R),D(),I):k},I.radius=function(R){return arguments.length?(b=typeof R=="function"?R:n(+R),D(),I):b},I.x=function(R){return arguments.length?(u=+R,I):u},I.y=function(R){return arguments.length?(L=+R,I):L},I}function _(b){var u=n(.1),L,T,k;typeof b!="function"&&(b=n(b==null?0:+b));function P(I){for(var D=0,R=L.length,O;D<R;++D)O=L[D],O.vx+=(k[D]-O.x)*T[D]*I}function z(){if(L){var I,D=L.length;for(T=new Array(D),k=new Array(D),I=0;I<D;++I)T[I]=isNaN(k[I]=+b(L[I],I,L))?0:+u(L[I],I,L)}}return P.initialize=function(I){L=I,z()},P.strength=function(I){return arguments.length?(u=typeof I=="function"?I:n(+I),z(),P):u},P.x=function(I){return arguments.length?(b=typeof I=="function"?I:n(+I),z(),P):b},P}function c(b){var u=n(.1),L,T,k;typeof b!="function"&&(b=n(b==null?0:+b));function P(I){for(var D=0,R=L.length,O;D<R;++D)O=L[D],O.vy+=(k[D]-O.y)*T[D]*I}function z(){if(L){var I,D=L.length;for(T=new Array(D),k=new Array(D),I=0;I<D;++I)T[I]=isNaN(k[I]=+b(L[I],I,L))?0:+u(L[I],I,L)}}return P.initialize=function(I){L=I,z()},P.strength=function(I){return arguments.length?(u=typeof I=="function"?I:n(+I),z(),P):u},P.y=function(I){return arguments.length?(b=typeof I=="function"?I:n(+I),z(),P):b},P}A.forceCenter=a,A.forceCollide=s,A.forceLink=p,A.forceManyBody=l,A.forceRadial=w,A.forceSimulation=m,A.forceX=_,A.forceY=c,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=typeof globalThis<"u"?globalThis:A||self,g(A.d3=A.d3||{}))})(this,function(A){function g(b){return Math.abs(b=Math.round(b))>=1e21?b.toLocaleString("en").replace(/,/g,""):b.toString(10)}function S(b,u){if((L=(b=u?b.toExponential(u-1):b.toExponential()).indexOf("e"))<0)return null;var L,T=b.slice(0,L);return[T.length>1?T[0]+T.slice(2):T,+b.slice(L+1)]}function M(b){return b=S(Math.abs(b)),b?b[1]:NaN}function e(b,u){return function(L,T){for(var k=L.length,P=[],z=0,I=b[0],D=0;k>0&&I>0&&(D+I+1>T&&(I=Math.max(1,T-D)),P.push(L.substring(k-=I,k+I)),!((D+=I+1)>T));)I=b[z=(z+1)%b.length];return P.reverse().join(u)}}function a(b){return function(u){return u.replace(/[0-9]/g,function(L){return b[+L]})}}var n=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(b){if(!(u=n.exec(b)))throw new Error("invalid format: "+b);var u;return new t({fill:u[1],align:u[2],sign:u[3],symbol:u[4],zero:u[5],width:u[6],comma:u[7],precision:u[8]&&u[8].slice(1),trim:u[9],type:u[10]})}r.prototype=t.prototype;function t(b){this.fill=b.fill===void 0?" ":b.fill+"",this.align=b.align===void 0?">":b.align+"",this.sign=b.sign===void 0?"-":b.sign+"",this.symbol=b.symbol===void 0?"":b.symbol+"",this.zero=!!b.zero,this.width=b.width===void 0?void 0:+b.width,this.comma=!!b.comma,this.precision=b.precision===void 0?void 0:+b.precision,this.trim=!!b.trim,this.type=b.type===void 0?"":b.type+""}t.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function h(b){e:for(var u=b.length,L=1,T=-1,k;L<u;++L)switch(b[L]){case".":T=k=L;break;case"0":T===0&&(T=L),k=L;break;default:if(!+b[L])break e;T>0&&(T=0);break}return T>0?b.slice(0,T)+b.slice(k+1):b}var s;function i(b,u){var L=S(b,u);if(!L)return b+"";var T=L[0],k=L[1],P=k-(s=Math.max(-8,Math.min(8,Math.floor(k/3)))*3)+1,z=T.length;return P===z?T:P>z?T+new Array(P-z+1).join("0"):P>0?T.slice(0,P)+"."+T.slice(P):"0."+new Array(1-P).join("0")+S(b,Math.max(0,u+P-1))[0]}function x(b,u){var L=S(b,u);if(!L)return b+"";var T=L[0],k=L[1];return k<0?"0."+new Array(-k).join("0")+T:T.length>k+1?T.slice(0,k+1)+"."+T.slice(k+1):T+new Array(k-T.length+2).join("0")}var p={"%":function(b,u){return(b*100).toFixed(u)},b:function(b){return Math.round(b).toString(2)},c:function(b){return b+""},d:g,e:function(b,u){return b.toExponential(u)},f:function(b,u){return b.toFixed(u)},g:function(b,u){return b.toPrecision(u)},o:function(b){return Math.round(b).toString(8)},p:function(b,u){return x(b*100,u)},r:x,s:i,X:function(b){return Math.round(b).toString(16).toUpperCase()},x:function(b){return Math.round(b).toString(16)}};function v(b){return b}var f=Array.prototype.map,d=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function o(b){var u=b.grouping===void 0||b.thousands===void 0?v:e(f.call(b.grouping,Number),b.thousands+""),L=b.currency===void 0?"":b.currency[0]+"",T=b.currency===void 0?"":b.currency[1]+"",k=b.decimal===void 0?".":b.decimal+"",P=b.numerals===void 0?v:a(f.call(b.numerals,String)),z=b.percent===void 0?"%":b.percent+"",I=b.minus===void 0?"-":b.minus+"",D=b.nan===void 0?"NaN":b.nan+"";function R(F){F=r(F);var N=F.fill,G=F.align,K=F.sign,W=F.symbol,Y=F.zero,re=F.width,ue=F.comma,j=F.precision,q=F.trim,H=F.type;H==="n"?(ue=!0,H="g"):p[H]||(j===void 0&&(j=12),q=!0,H="g"),(Y||N==="0"&&G==="=")&&(Y=!0,N="0",G="=");var U=W==="$"?L:W==="#"&&/[boxX]/.test(H)?"0"+H.toLowerCase():"",$=W==="$"?T:/[%p]/.test(H)?z:"",ne=p[H],X=/[defgprs%]/.test(H);j=j===void 0?6:/[gprs]/.test(H)?Math.max(1,Math.min(21,j)):Math.max(0,Math.min(20,j));function Q(ie){var se=U,ae=$,oe,be,ce;if(H==="c")ae=ne(ie)+ae,ie="";else{ie=+ie;var de=ie<0||1/ie<0;if(ie=isNaN(ie)?D:ne(Math.abs(ie),j),q&&(ie=h(ie)),de&&+ie==0&&K!=="+"&&(de=!1),se=(de?K==="("?K:I:K==="-"||K==="("?"":K)+se,ae=(H==="s"?d[8+s/3]:"")+ae+(de&&K==="("?")":""),X){for(oe=-1,be=ie.length;++oe<be;)if(ce=ie.charCodeAt(oe),48>ce||ce>57){ae=(ce===46?k+ie.slice(oe+1):ie.slice(oe))+ae,ie=ie.slice(0,oe);break}}}ue&&!Y&&(ie=u(ie,1/0));var ye=se.length+ie.length+ae.length,ge=ye<re?new Array(re-ye+1).join(N):"";switch(ue&&Y&&(ie=u(ge+ie,ge.length?re-ae.length:1/0),ge=""),G){case"<":ie=se+ie+ae+ge;break;case"=":ie=se+ge+ie+ae;break;case"^":ie=ge.slice(0,ye=ge.length>>1)+se+ie+ae+ge.slice(ye);break;default:ie=ge+se+ie+ae;break}return P(ie)}return Q.toString=function(){return F+""},Q}function O(F,N){var G=R((F=r(F),F.type="f",F)),K=Math.max(-8,Math.min(8,Math.floor(M(N)/3)))*3,W=Math.pow(10,-K),Y=d[8+K/3];return function(re){return G(W*re)+Y}}return{format:R,formatPrefix:O}}var m;l({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function l(b){return m=o(b),A.format=m.format,A.formatPrefix=m.formatPrefix,m}function w(b){return Math.max(0,-M(Math.abs(b)))}function _(b,u){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(M(u)/3)))*3-M(Math.abs(b)))}function c(b,u){return b=Math.abs(b),u=Math.abs(u)-b,Math.max(0,M(u)-M(b))+1}A.FormatSpecifier=t,A.formatDefaultLocale=l,A.formatLocale=o,A.formatSpecifier=r,A.precisionFixed=w,A.precisionPrefix=_,A.precisionRound=c,Object.defineProperty(A,"__esModule",{value:!0})})},{}],113:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,y("d3-geo"),y("d3-array")):g(A.d3=A.d3||{},A.d3,A.d3)})(this,function(A,g,S){var M=Math.abs,e=Math.atan,a=Math.atan2,n=Math.cos,r=Math.exp,t=Math.floor,h=Math.log,s=Math.max,i=Math.min,x=Math.pow,p=Math.round,v=Math.sign||function(ze){return ze>0?1:ze<0?-1:0},f=Math.sin,d=Math.tan,o=1e-6,m=1e-12,l=Math.PI,w=l/2,_=l/4,c=Math.SQRT1_2,b=D(2),u=D(l),L=l*2,T=180/l,k=l/180;function P(ze){return ze?ze/Math.sin(ze):1}function z(ze){return ze>1?w:ze<-1?-w:Math.asin(ze)}function I(ze){return ze>1?0:ze<-1?l:Math.acos(ze)}function D(ze){return ze>0?Math.sqrt(ze):0}function R(ze){return ze=r(2*ze),(ze-1)/(ze+1)}function O(ze){return(r(ze)-r(-ze))/2}function F(ze){return(r(ze)+r(-ze))/2}function N(ze){return h(ze+D(ze*ze+1))}function G(ze){return h(ze+D(ze*ze-1))}function K(ze){var We=d(ze/2),qe=2*h(n(ze/2))/(We*We);function ot(_t,mt){var Et=n(_t),fr=n(mt),pr=f(mt),lr=fr*Et,xr=-((1-lr?h((1+lr)/2)/(1-lr):-.5)+qe/(1+lr));return[xr*fr*f(_t),xr*pr]}return ot.invert=function(_t,mt){var Et=D(_t*_t+mt*mt),fr=-ze/2,pr=50,lr;if(!Et)return[0,0];do{var xr=fr/2,Pr=n(xr),Xr=f(xr),qr=Xr/Pr,bn=-h(M(Pr));fr-=lr=(2/qr*bn-qe*qr-Et)/(-bn/(Xr*Xr)+1-qe/(2*Pr*Pr))*(Pr<0?.7:1)}while(M(lr)>o&&--pr>0);var Dn=f(fr);return[a(_t*Dn,Et*n(fr)),z(mt*Dn/Et)]},ot}function W(){var ze=w,We=g.geoProjectionMutator(K),qe=We(ze);return qe.radius=function(ot){return arguments.length?We(ze=ot*k):ze*T},qe.scale(179.976).clipAngle(147)}function Y(ze,We){var qe=n(We),ot=P(I(qe*n(ze/=2)));return[2*qe*f(ze)*ot,f(We)*ot]}Y.invert=function(ze,We){if(!(ze*ze+4*We*We>l*l+o)){var qe=ze,ot=We,_t=25;do{var mt=f(qe),Et=f(qe/2),fr=n(qe/2),pr=f(ot),lr=n(ot),xr=f(2*ot),Pr=pr*pr,Xr=lr*lr,qr=Et*Et,bn=1-Xr*fr*fr,Dn=bn?I(lr*fr)*D(Wn=1/bn):Wn=0,Wn,ga=2*Dn*lr*Et-ze,xa=Dn*pr-We,Ka=Wn*(Xr*qr+Dn*lr*fr*Pr),Ya=Wn*(.5*mt*xr-Dn*2*pr*Et),ei=Wn*.25*(xr*Et-Dn*pr*Xr*mt),hi=Wn*(Pr*fr+Dn*qr*lr),io=Ya*ei-hi*Ka;if(!io)break;var ri=(xa*Ya-ga*hi)/io,Vi=(ga*ei-xa*Ka)/io;qe-=ri,ot-=Vi}while((M(ri)>o||M(Vi)>o)&&--_t>0);return[qe,ot]}};function re(){return g.geoProjection(Y).scale(152.63)}function ue(ze){var We=f(ze),qe=n(ze),ot=ze>=0?1:-1,_t=d(ot*ze),mt=(1+We-qe)/2;function Et(fr,pr){var lr=n(pr),xr=n(fr/=2);return[(1+lr)*f(fr),(ot*pr>-a(xr,_t)-.001?0:-ot*10)+mt+f(pr)*qe-(1+lr)*We*xr]}return Et.invert=function(fr,pr){var lr=0,xr=0,Pr=50;do{var Xr=n(lr),qr=f(lr),bn=n(xr),Dn=f(xr),Wn=1+bn,ga=Wn*qr-fr,xa=mt+Dn*qe-Wn*We*Xr-pr,Ka=Wn*Xr/2,Ya=-qr*Dn,ei=We*Wn*qr/2,hi=qe*bn+We*Xr*Dn,io=Ya*ei-hi*Ka,ri=(xa*Ya-ga*hi)/io/2,Vi=(ga*ei-xa*Ka)/io;M(Vi)>2&&(Vi/=2),lr-=ri,xr-=Vi}while((M(ri)>o||M(Vi)>o)&&--Pr>0);return ot*xr>-a(n(lr),_t)-.001?[lr*2,xr]:null},Et}function j(){var ze=20*k,We=ze>=0?1:-1,qe=d(We*ze),ot=g.geoProjectionMutator(ue),_t=ot(ze),mt=_t.stream;return _t.parallel=function(Et){return arguments.length?(qe=d((We=(ze=Et*k)>=0?1:-1)*ze),ot(ze)):ze*T},_t.stream=function(Et){var fr=_t.rotate(),pr=mt(Et),lr=(_t.rotate([0,0]),mt(Et)),xr=_t.precision();return _t.rotate(fr),pr.sphere=function(){lr.polygonStart(),lr.lineStart();for(var Pr=We*-180;We*Pr<180;Pr+=We*90)lr.point(Pr,We*90);if(ze)for(;We*(Pr-=3*We*xr)>=-180;)lr.point(Pr,We*-a(n(Pr*k/2),qe)*T);lr.lineEnd(),lr.polygonEnd()},pr},_t.scale(218.695).center([0,28.0974])}function q(ze,We){var qe=d(We/2),ot=D(1-qe*qe),_t=1+ot*n(ze/=2),mt=f(ze)*ot/_t,Et=qe/_t,fr=mt*mt,pr=Et*Et;return[4/3*mt*(3+fr-3*pr),4/3*Et*(3+3*fr-pr)]}q.invert=function(ze,We){if(ze*=3/8,We*=3/8,!ze&&M(We)>1)return null;var qe=ze*ze,ot=We*We,_t=1+qe+ot,mt=D((_t-D(_t*_t-4*We*We))/2),Et=z(mt)/3,fr=mt?G(M(We/mt))/3:N(M(ze))/3,pr=n(Et),lr=F(fr),xr=lr*lr-pr*pr;return[v(ze)*2*a(O(fr)*pr,.25-xr),v(We)*2*a(lr*f(Et),.25+xr)]};function H(){return g.geoProjection(q).scale(66.1603)}var U=D(8),$=h(1+b);function ne(ze,We){var qe=M(We);return qe<_?[ze,h(d(_+We/2))]:[ze*n(qe)*(2*b-1/f(qe)),v(We)*(2*b*(qe-_)-h(d(qe/2)))]}ne.invert=function(ze,We){if((mt=M(We))<$)return[ze,2*e(r(We))-w];var qe=_,ot=25,_t,mt;do{var Et=n(qe/2),fr=d(qe/2);qe-=_t=(U*(qe-_)-h(fr)-mt)/(U-Et*Et/(2*fr))}while(M(_t)>m&&--ot>0);return[ze/(n(qe)*(U-1/f(qe))),v(We)*qe]};function X(){return g.geoProjection(ne).scale(112.314)}function Q(ze){var We=2*l/ze;function qe(ot,_t){var mt=g.geoAzimuthalEquidistantRaw(ot,_t);if(M(ot)>w){var Et=a(mt[1],mt[0]),fr=D(mt[0]*mt[0]+mt[1]*mt[1]),pr=We*p((Et-w)/We)+w,lr=a(f(Et-=pr),2-n(Et));Et=pr+z(l/fr*f(lr))-lr,mt[0]=fr*n(Et),mt[1]=fr*f(Et)}return mt}return qe.invert=function(ot,_t){var mt=D(ot*ot+_t*_t);if(mt>w){var Et=a(_t,ot),fr=We*p((Et-w)/We)+w,pr=Et>fr?-1:1,lr=mt*n(fr-Et),xr=1/d(pr*I((lr-l)/D(l*(l-2*lr)+mt*mt)));Et=fr+2*e((xr+pr*D(xr*xr-3))/3),ot=mt*n(Et),_t=mt*f(Et)}return g.geoAzimuthalEquidistantRaw.invert(ot,_t)},qe}function ie(){var ze=5,We=g.geoProjectionMutator(Q),qe=We(ze),ot=qe.stream,_t=.01,mt=-n(_t*k),Et=f(_t*k);return qe.lobes=function(fr){return arguments.length?We(ze=+fr):ze},qe.stream=function(fr){var pr=qe.rotate(),lr=ot(fr),xr=(qe.rotate([0,0]),ot(fr));return qe.rotate(pr),lr.sphere=function(){xr.polygonStart(),xr.lineStart();for(var Pr=0,Xr=360/ze,qr=2*l/ze,bn=90-180/ze,Dn=w;Pr<ze;++Pr,bn-=Xr,Dn-=qr)xr.point(a(Et*n(Dn),mt)*T,z(Et*f(Dn))*T),bn<-90?(xr.point(-90,-180-bn-_t),xr.point(-90,-180-bn+_t)):(xr.point(90,bn+_t),xr.point(90,bn-_t));xr.lineEnd(),xr.polygonEnd()},lr},qe.scale(87.8076).center([0,17.1875]).clipAngle(180-.001)}function se(ze,We){if(arguments.length<2&&(We=ze),We===1)return g.geoAzimuthalEqualAreaRaw;if(We===1/0)return ae;function qe(ot,_t){var mt=g.geoAzimuthalEqualAreaRaw(ot/We,_t);return mt[0]*=ze,mt}return qe.invert=function(ot,_t){var mt=g.geoAzimuthalEqualAreaRaw.invert(ot/ze,_t);return mt[0]*=We,mt},qe}function ae(ze,We){return[ze*n(We)/n(We/=2),2*f(We)]}ae.invert=function(ze,We){var qe=2*z(We/2);return[ze*n(qe/2)/n(qe),qe]};function oe(){var ze=2,We=g.geoProjectionMutator(se),qe=We(ze);return qe.coefficient=function(ot){return arguments.length?We(ze=+ot):ze},qe.scale(169.529)}function be(ze,We,qe){var ot=100,_t,mt,Et;qe=qe===void 0?0:+qe,We=+We;do mt=ze(qe),Et=ze(qe+o),mt===Et&&(Et=mt+o),qe-=_t=-1*o*(mt-We)/(mt-Et);while(ot-- >0&&M(_t)>o);return ot<0?NaN:qe}function ce(ze,We,qe){return We===void 0&&(We=40),qe===void 0&&(qe=m),function(ot,_t,mt,Et){var fr,pr,lr;mt=mt===void 0?0:+mt,Et=Et===void 0?0:+Et;for(var xr=0;xr<We;xr++){var Pr=ze(mt,Et),Xr=Pr[0]-ot,qr=Pr[1]-_t;if(M(Xr)<qe&&M(qr)<qe)break;var bn=Xr*Xr+qr*qr;if(bn>fr){mt-=pr/=2,Et-=lr/=2;continue}fr=bn;var Dn=(mt>0?-1:1)*qe,Wn=(Et>0?-1:1)*qe,ga=ze(mt+Dn,Et),xa=ze(mt,Et+Wn),Ka=(ga[0]-Pr[0])/Dn,Ya=(ga[1]-Pr[1])/Dn,ei=(xa[0]-Pr[0])/Wn,hi=(xa[1]-Pr[1])/Wn,io=hi*Ka-Ya*ei,ri=(M(io)<.5?.5:1)/io;if(pr=(qr*ei-Xr*hi)*ri,lr=(Xr*Ya-qr*Ka)*ri,mt+=pr,Et+=lr,M(pr)<qe&&M(lr)<qe)break}return[mt,Et]}}function de(){var ze=se(1.68,2),We=1.4,qe=12;function ot(_t,mt){if(_t+mt<-We){var Et=(_t-mt+1.6)*(_t+mt+We)/8;_t+=Et,mt-=.8*Et*f(mt+l/2)}var fr=ze(_t,mt),pr=(1-n(_t*mt))/qe;return fr[1]<0&&(fr[0]*=1+pr),fr[1]>0&&(fr[1]*=1+pr/1.5*fr[0]*fr[0]),fr}return ot.invert=ce(ot),ot}function ye(){return g.geoProjection(de()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])}function ge(ze,We){var qe=ze*f(We),ot=30,_t;do We-=_t=(We+f(We)-qe)/(1+n(We));while(M(_t)>o&&--ot>0);return We/2}function me(ze,We,qe){function ot(_t,mt){return[ze*_t*n(mt=ge(qe,mt)),We*f(mt)]}return ot.invert=function(_t,mt){return mt=z(mt/We),[_t/(ze*n(mt)),z((2*mt+f(2*mt))/qe)]},ot}var Ee=me(b/w,b,l);function Pe(){return g.geoProjection(Ee).scale(169.529)}var Ue=2.00276,we=1.11072;function ke(ze,We){var qe=ge(l,We);return[Ue*ze/(1/n(We)+we/n(qe)),(We+b*f(qe))/Ue]}ke.invert=function(ze,We){var qe=Ue*We,ot=We<0?-_:_,_t=25,mt,Et;do Et=qe-b*f(ot),ot-=mt=(f(2*ot)+2*ot-l*f(Et))/(2*n(2*ot)+2+l*n(Et)*b*n(ot));while(M(mt)>o&&--_t>0);return Et=qe-b*f(ot),[ze*(1/n(Et)+we/n(ot))/Ue,Et]};function Xe(){return g.geoProjection(ke).scale(160.857)}function Ve(ze){var We=0,qe=g.geoProjectionMutator(ze),ot=qe(We);return ot.parallel=function(_t){return arguments.length?qe(We=_t*k):We*T},ot}function Ie(ze,We){return[ze*n(We),We]}Ie.invert=function(ze,We){return[ze/n(We),We]};function De(){return g.geoProjection(Ie).scale(152.63)}function Ye(ze){if(!ze)return Ie;var We=1/d(ze);function qe(ot,_t){var mt=We+ze-_t,Et=mt&&ot*n(_t)/mt;return[mt*f(Et),We-mt*n(Et)]}return qe.invert=function(ot,_t){var mt=D(ot*ot+(_t=We-_t)*_t),Et=We+ze-mt;return[mt/n(Et)*a(ot,_t),Et]},qe}function vt(){return Ve(Ye).scale(123.082).center([0,26.1441]).parallel(45)}function Dt(ze){function We(qe,ot){var _t=w-ot,mt=_t&&qe*ze*f(_t)/_t;return[_t*f(mt)/ze,w-_t*n(mt)]}return We.invert=function(qe,ot){var _t=qe*ze,mt=w-ot,Et=D(_t*_t+mt*mt),fr=a(_t,mt);return[(Et?Et/f(Et):1)*fr/ze,w-Et]},We}function Kt(){var ze=.5,We=g.geoProjectionMutator(Dt),qe=We(ze);return qe.fraction=function(ot){return arguments.length?We(ze=+ot):ze},qe.scale(158.837)}var Ft=me(1,4/l,l);function Mt(){return g.geoProjection(Ft).scale(152.63)}function Xt(ze,We,qe,ot,_t,mt){var Et=n(mt),fr;if(M(ze)>1||M(mt)>1)fr=I(qe*_t+We*ot*Et);else{var pr=f(ze/2),lr=f(mt/2);fr=2*z(D(pr*pr+We*ot*lr*lr))}return M(fr)>o?[fr,a(ot*f(mt),We*_t-qe*ot*Et)]:[0,0]}function It(ze,We,qe){return I((ze*ze+We*We-qe*qe)/(2*ze*We))}function At(ze){return ze-2*l*t((ze+l)/(2*l))}function Ge(ze,We,qe){for(var ot=[[ze[0],ze[1],f(ze[1]),n(ze[1])],[We[0],We[1],f(We[1]),n(We[1])],[qe[0],qe[1],f(qe[1]),n(qe[1])]],_t=ot[2],mt,Et=0;Et<3;++Et,_t=mt)mt=ot[Et],_t.v=Xt(mt[1]-_t[1],_t[3],_t[2],mt[3],mt[2],mt[0]-_t[0]),_t.point=[0,0];var fr=It(ot[0].v[0],ot[2].v[0],ot[1].v[0]),pr=It(ot[0].v[0],ot[1].v[0],ot[2].v[0]),lr=l-fr;ot[2].point[1]=0,ot[0].point[0]=-(ot[1].point[0]=ot[0].v[0]/2);var xr=[ot[2].point[0]=ot[0].point[0]+ot[2].v[0]*n(fr),2*(ot[0].point[1]=ot[1].point[1]=ot[2].v[0]*f(fr))];function Pr(Xr,qr){var bn=f(qr),Dn=n(qr),Wn=new Array(3),ga;for(ga=0;ga<3;++ga){var xa=ot[ga];if(Wn[ga]=Xt(qr-xa[1],xa[3],xa[2],Dn,bn,Xr-xa[0]),!Wn[ga][0])return xa.point;Wn[ga][1]=At(Wn[ga][1]-xa.v[1])}var Ka=xr.slice();for(ga=0;ga<3;++ga){var Ya=ga==2?0:ga+1,ei=It(ot[ga].v[0],Wn[ga][0],Wn[Ya][0]);Wn[ga][1]<0&&(ei=-ei),ga?ga==1?(ei=pr-ei,Ka[0]-=Wn[ga][0]*n(ei),Ka[1]-=Wn[ga][0]*f(ei)):(ei=lr-ei,Ka[0]+=Wn[ga][0]*n(ei),Ka[1]+=Wn[ga][0]*f(ei)):(Ka[0]+=Wn[ga][0]*n(ei),Ka[1]-=Wn[ga][0]*f(ei))}return Ka[0]/=3,Ka[1]/=3,Ka}return Pr}function tt(ze){return ze[0]*=k,ze[1]*=k,ze}function He(){return Ae([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])}function Ae(ze,We,qe){var ot=g.geoCentroid({type:"MultiPoint",coordinates:[ze,We,qe]}),_t=[-ot[0],-ot[1]],mt=g.geoRotation(_t),Et=Ge(tt(mt(ze)),tt(mt(We)),tt(mt(qe)));Et.invert=ce(Et);var fr=g.geoProjection(Et).rotate(_t),pr=fr.center;return delete fr.rotate,fr.center=function(lr){return arguments.length?pr(mt(lr)):mt.invert(pr())},fr.clipAngle(90)}function Ne(ze,We){var qe=D(1-f(We));return[2/u*ze*qe,u*(1-qe)]}Ne.invert=function(ze,We){var qe=(qe=We/u-1)*qe;return[qe>0?ze*D(l/qe)/2:0,z(1-qe)]};function Ze(){return g.geoProjection(Ne).scale(95.6464).center([0,30])}function Qe(ze){var We=d(ze);function qe(ot,_t){return[ot,(ot?ot/f(ot):1)*(f(_t)*n(ot)-We*n(_t))]}return qe.invert=We?function(ot,_t){ot&&(_t*=f(ot)/ot);var mt=n(ot);return[ot,2*a(D(mt*mt+We*We-_t*_t)-mt,We-_t)]}:function(ot,_t){return[ot,z(ot?_t*d(ot)/ot:_t)]},qe}function bt(){return Ve(Qe).scale(249.828).clipAngle(90)}var dt=D(3);function wt(ze,We){return[dt*ze*(2*n(2*We/3)-1)/u,dt*u*f(We/3)]}wt.invert=function(ze,We){var qe=3*z(We/(dt*u));return[u*ze/(dt*(2*n(2*qe/3)-1)),qe]};function Ut(){return g.geoProjection(wt).scale(156.19)}function Rt(ze){var We=n(ze);function qe(ot,_t){return[ot*We,f(_t)/We]}return qe.invert=function(ot,_t){return[ot/We,z(_t*We)]},qe}function Nt(){return Ve(Rt).parallel(38.58).scale(195.044)}function Wt(ze){var We=n(ze);function qe(ot,_t){return[ot*We,(1+We)*d(_t/2)]}return qe.invert=function(ot,_t){return[ot/We,e(_t/(1+We))*2]},qe}function Vt(){return Ve(Wt).scale(124.75)}function ir(ze,We){var qe=D(8/(3*l));return[qe*ze*(1-M(We)/l),qe*We]}ir.invert=function(ze,We){var qe=D(8/(3*l)),ot=We/qe;return[ze/(qe*(1-M(ot)/l)),ot]};function Hr(){return g.geoProjection(ir).scale(165.664)}function sn(ze,We){var qe=D(4-3*f(M(We)));return[2/D(6*l)*ze*qe,v(We)*D(2*l/3)*(2-qe)]}sn.invert=function(ze,We){var qe=2-M(We)/D(2*l/3);return[ze*D(6*l)/(2*qe),v(We)*z((4-qe*qe)/3)]};function jr(){return g.geoProjection(sn).scale(165.664)}function at(ze,We){var qe=D(l*(4+l));return[2/qe*ze*(1+D(1-4*We*We/(l*l))),4/qe*We]}at.invert=function(ze,We){var qe=D(l*(4+l))/2;return[ze*qe/(1+D(1-We*We*(4+l)/(4*l))),We*qe/2]};function $t(){return g.geoProjection(at).scale(180.739)}function Jt(ze,We){var qe=(2+w)*f(We);We/=2;for(var ot=0,_t=1/0;ot<10&&M(_t)>o;ot++){var mt=n(We);We-=_t=(We+f(We)*(mt+2)-qe)/(2*mt*(1+mt))}return[2/D(l*(4+l))*ze*(1+n(We)),2*D(l/(4+l))*f(We)]}Jt.invert=function(ze,We){var qe=We*D((4+l)/l)/2,ot=z(qe),_t=n(ot);return[ze/(2/D(l*(4+l))*(1+_t)),z((ot+qe*(_t+2))/(2+w))]};function Gt(){return g.geoProjection(Jt).scale(180.739)}function _r(ze,We){return[ze*(1+n(We))/D(2+l),2*We/D(2+l)]}_r.invert=function(ze,We){var qe=D(2+l),ot=We*qe/2;return[qe*ze/(1+n(ot)),ot]};function rt(){return g.geoProjection(_r).scale(173.044)}function Je(ze,We){for(var qe=(1+w)*f(We),ot=0,_t=1/0;ot<10&&M(_t)>o;ot++)We-=_t=(We+f(We)-qe)/(1+n(We));return qe=D(2+l),[ze*(1+n(We))/qe,2*We/qe]}Je.invert=function(ze,We){var qe=1+w,ot=D(qe/2);return[ze*2*ot/(1+n(We*=ot)),z((We+f(We))/qe)]};function st(){return g.geoProjection(Je).scale(173.044)}var lt=3+2*b;function Tt(ze,We){var qe=f(ze/=2),ot=n(ze),_t=D(n(We)),mt=n(We/=2),Et=f(We)/(mt+b*ot*_t),fr=D(2/(1+Et*Et)),pr=D((b*mt+(ot+qe)*_t)/(b*mt+(ot-qe)*_t));return[lt*(fr*(pr-1/pr)-2*h(pr)),lt*(fr*Et*(pr+1/pr)-2*e(Et))]}Tt.invert=function(ze,We){if(!(mt=q.invert(ze/1.2,We*1.065)))return null;var qe=mt[0],ot=mt[1],_t=20,mt;ze/=lt,We/=lt;do{var Et=qe/2,fr=ot/2,pr=f(Et),lr=n(Et),xr=f(fr),Pr=n(fr),Xr=n(ot),qr=D(Xr),bn=xr/(Pr+b*lr*qr),Dn=bn*bn,Wn=D(2/(1+Dn)),ga=b*Pr+(lr+pr)*qr,xa=b*Pr+(lr-pr)*qr,Ka=ga/xa,Ya=D(Ka),ei=Ya-1/Ya,hi=Ya+1/Ya,io=Wn*ei-2*h(Ya)-ze,ri=Wn*bn*hi-2*e(bn)-We,Vi=xr&&c*qr*pr*Dn/xr,fo=(b*lr*Pr+qr)/(2*(Pr+b*lr*qr)*(Pr+b*lr*qr)*qr),_o=-.5*bn*Wn*Wn*Wn,bi=_o*Vi,Mi=_o*fo,fs=(fs=2*Pr+b*qr*(lr-pr))*fs*Ya,go=(b*lr*Pr*qr+Xr)/fs,Po=-(b*pr*xr)/(qr*fs),Go=ei*bi-2*go/Ya+Wn*(go+go/Ka),le=ei*Mi-2*Po/Ya+Wn*(Po+Po/Ka),_e=bn*hi*bi-2*Vi/(1+Dn)+Wn*hi*Vi+Wn*bn*(go-go/Ka),Le=bn*hi*Mi-2*fo/(1+Dn)+Wn*hi*fo+Wn*bn*(Po-Po/Ka),Be=le*_e-Le*Go;if(!Be)break;var Oe=(ri*le-io*Le)/Be,Ke=(io*_e-ri*Go)/Be;qe-=Oe,ot=s(-w,i(w,ot-Ke))}while((M(Oe)>o||M(Ke)>o)&&--_t>0);return M(M(ot)-w)<o?[0,ot]:_t&&[qe,ot]};function zt(){return g.geoProjection(Tt).scale(62.5271)}var Ce=n(35*k);function Se(ze,We){var qe=d(We/2);return[ze*Ce*D(1-qe*qe),(1+Ce)*qe]}Se.invert=function(ze,We){var qe=We/(1+Ce);return[ze&&ze/(Ce*D(1-qe*qe)),2*e(qe)]};function nt(){return g.geoProjection(Se).scale(137.152)}function it(ze,We){var qe=We/2,ot=n(qe);return[2*ze/u*n(We)*ot*ot,u*d(qe)]}it.invert=function(ze,We){var qe=e(We/u),ot=n(qe),_t=2*qe;return[ze*u/2/(n(_t)*ot*ot),_t]};function ct(){return g.geoProjection(it).scale(135.264)}function kt(ze){var We=1-ze,qe=mt(l,0)[0]-mt(-l,0)[0],ot=mt(0,w)[1]-mt(0,-w)[1],_t=D(2*ot/qe);function mt(pr,lr){var xr=n(lr),Pr=f(lr);return[xr/(We+ze*xr)*pr,We*lr+ze*Pr]}function Et(pr,lr){var xr=mt(pr,lr);return[xr[0]*_t,xr[1]/_t]}function fr(pr){return Et(0,pr)[1]}return Et.invert=function(pr,lr){var xr=be(fr,lr),Pr=pr/_t*(ze+We/n(xr));return[Pr,xr]},Et}function gt(){var ze=.5,We=g.geoProjectionMutator(kt),qe=We(ze);return qe.alpha=function(ot){return arguments.length?We(ze=+ot):ze},qe.scale(168.725)}function St(ze){return[ze[0]/2,z(d(ze[1]/2*k))*T]}function Yt(ze){return[ze[0]*2,2*e(f(ze[1]*k))*T]}function ar(ze){ze==null&&(ze=g.geoOrthographic);var We=ze(),qe=g.geoEquirectangular().scale(T).precision(0).clipAngle(null).translate([0,0]);function ot(mt){return We(St(mt))}We.invert&&(ot.invert=function(mt){return Yt(We.invert(mt))}),ot.stream=function(mt){var Et=We.stream(mt),fr=qe.stream({point:function(pr,lr){Et.point(pr/2,z(d(-lr/2*k))*T)},lineStart:function(){Et.lineStart()},lineEnd:function(){Et.lineEnd()},polygonStart:function(){Et.polygonStart()},polygonEnd:function(){Et.polygonEnd()}});return fr.sphere=Et.sphere,fr};function _t(mt){ot[mt]=function(){return arguments.length?(We[mt].apply(We,arguments),ot):We[mt]()}}return ot.rotate=function(mt){return arguments.length?(qe.rotate(mt),ot):qe.rotate()},ot.center=function(mt){return arguments.length?(We.center(St(mt)),ot):Yt(We.center())},_t("angle"),_t("clipAngle"),_t("clipExtent"),_t("fitExtent"),_t("fitHeight"),_t("fitSize"),_t("fitWidth"),_t("scale"),_t("translate"),_t("precision"),ot.scale(249.5)}function kr(ze,We){var qe=2*l/We,ot=ze*ze;function _t(mt,Et){var fr=g.geoAzimuthalEquidistantRaw(mt,Et),pr=fr[0],lr=fr[1],xr=pr*pr+lr*lr;if(xr>ot){var Pr=D(xr),Xr=a(lr,pr),qr=qe*p(Xr/qe),bn=Xr-qr,Dn=ze*n(bn),Wn=(ze*f(bn)-bn*f(Dn))/(w-Dn),ga=br(bn,Wn),xa=(l-ze)/Mr(ga,Dn,l);pr=Pr;var Ka=50,Ya;do pr-=Ya=(ze+Mr(ga,Dn,pr)*xa-Pr)/(ga(pr)*xa);while(M(Ya)>o&&--Ka>0);lr=bn*f(pr),pr<w&&(lr-=Wn*(pr-w));var ei=f(qr),hi=n(qr);fr[0]=pr*hi-lr*ei,fr[1]=pr*ei+lr*hi}return fr}return _t.invert=function(mt,Et){var fr=mt*mt+Et*Et;if(fr>ot){var pr=D(fr),lr=a(Et,mt),xr=qe*p(lr/qe),Pr=lr-xr;mt=pr*n(Pr),Et=pr*f(Pr);for(var Xr=mt-w,qr=f(mt),bn=Et/qr,Dn=mt<w?1/0:0,Wn=10;;){var ga=ze*f(bn),xa=ze*n(bn),Ka=f(xa),Ya=w-xa,ei=(ga-bn*Ka)/Ya,hi=br(bn,ei);if(M(Dn)<m||!--Wn)break;bn-=Dn=(bn*qr-ei*Xr-Et)/(qr-Xr*2*(Ya*(xa+bn*ga*n(xa)-Ka)-ga*(ga-bn*Ka))/(Ya*Ya))}pr=ze+Mr(hi,xa,mt)*(l-ze)/Mr(hi,xa,l),lr=xr+bn,mt=pr*n(lr),Et=pr*f(lr)}return g.geoAzimuthalEquidistantRaw.invert(mt,Et)},_t}function br(ze,We){return function(qe){var ot=ze*n(qe);return qe<w&&(ot-=We),D(1+ot*ot)}}function Mr(ze,We,qe){for(var ot=50,_t=(qe-We)/ot,mt=ze(We)+ze(qe),Et=1,fr=We;Et<ot;++Et)mt+=2*ze(fr+=_t);return mt*.5*_t}function Yr(){var ze=6,We=30*k,qe=n(We),ot=f(We),_t=g.geoProjectionMutator(kr),mt=_t(We,ze),Et=mt.stream,fr=.01,pr=-n(fr*k),lr=f(fr*k);return mt.radius=function(xr){return arguments.length?(qe=n(We=xr*k),ot=f(We),_t(We,ze)):We*T},mt.lobes=function(xr){return arguments.length?_t(We,ze=+xr):ze},mt.stream=function(xr){var Pr=mt.rotate(),Xr=Et(xr),qr=(mt.rotate([0,0]),Et(xr));return mt.rotate(Pr),Xr.sphere=function(){qr.polygonStart(),qr.lineStart();for(var bn=0,Dn=2*l/ze,Wn=0;bn<ze;++bn,Wn-=Dn)qr.point(a(lr*n(Wn),pr)*T,z(lr*f(Wn))*T),qr.point(a(ot*n(Wn-Dn/2),qe)*T,z(ot*f(Wn-Dn/2))*T);qr.lineEnd(),qr.polygonEnd()},Xr},mt.rotate([90,-40]).scale(91.7095).clipAngle(180-.001)}function nr(ze,We,qe,ot,_t,mt,Et,fr){arguments.length<8&&(fr=0);function pr(lr,xr){if(!xr)return[ze*lr/l,0];var Pr=xr*xr,Xr=ze+Pr*(We+Pr*(qe+Pr*ot)),qr=xr*(_t-1+Pr*(mt-fr+Pr*Et)),bn=(Xr*Xr+qr*qr)/(2*qr),Dn=lr*z(Xr/bn)/l;return[bn*f(Dn),xr*(1+Pr*fr)+bn*(1-n(Dn))]}return pr.invert=function(lr,xr){var Pr=l*lr/ze,Xr=xr,qr,bn,Dn=50;do{var Wn=Xr*Xr,ga=ze+Wn*(We+Wn*(qe+Wn*ot)),xa=Xr*(_t-1+Wn*(mt-fr+Wn*Et)),Ka=ga*ga+xa*xa,Ya=2*xa,ei=Ka/Ya,hi=ei*ei,io=z(ga/ei)/l,ri=Pr*io,Vi=ga*ga,fo=(2*We+Wn*(4*qe+Wn*6*ot))*Xr,_o=_t+Wn*(3*mt+Wn*5*Et),bi=2*(ga*fo+xa*(_o-1)),Mi=2*(_o-1),fs=(bi*Ya-Ka*Mi)/(Ya*Ya),go=n(ri),Po=f(ri),Go=ei*go,le=ei*Po,_e=Pr/l*(1/D(1-Vi/hi))*(fo*ei-ga*fs)/hi,Le=le-lr,Be=Xr*(1+Wn*fr)+ei-Go-xr,Oe=fs*Po+Go*_e,Ke=Go*io,xt=1+fs-(fs*go-le*_e),ht=le*io,Pt=Oe*ht-xt*Ke;if(!Pt)break;Pr-=qr=(Be*Oe-Le*xt)/Pt,Xr-=bn=(Le*ht-Be*Ke)/Pt}while((M(qr)>o||M(bn)>o)&&--Dn>0);return[Pr,Xr]},pr}var gr=nr(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);function Rr(){return g.geoProjection(gr).scale(149.995)}var Br=nr(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);function Sr(){return g.geoProjection(Br).scale(153.93)}var et=nr(5/6*l,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Lt(){return g.geoProjection(et).scale(130.945)}function Zt(ze,We){var qe=ze*ze,ot=We*We;return[ze*(1-.162388*ot)*(.87-952426e-9*qe*qe),We*(1+ot/12)]}Zt.invert=function(ze,We){var qe=ze,ot=We,_t=50,mt;do{var Et=ot*ot;ot-=mt=(ot*(1+Et/12)-We)/(1+Et/4)}while(M(mt)>o&&--_t>0);_t=50,ze/=1-.162388*Et;do{var fr=(fr=qe*qe)*fr;qe-=mt=(qe*(.87-952426e-9*fr)-ze)/(.87-.00476213*fr)}while(M(mt)>o&&--_t>0);return[qe,ot]};function or(){return g.geoProjection(Zt).scale(131.747)}var Ir=nr(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Or(){return g.geoProjection(Ir).scale(131.087)}function Er(ze){var We=ze(w,0)[0]-ze(-w,0)[0];function qe(ot,_t){var mt=ot>0?-.5:.5,Et=ze(ot+mt*l,_t);return Et[0]-=mt*We,Et}return ze.invert&&(qe.invert=function(ot,_t){var mt=ot>0?-.5:.5,Et=ze.invert(ot+mt*We,_t),fr=Et[0]-mt*l;return fr<-l?fr+=2*l:fr>l&&(fr-=2*l),Et[0]=fr,Et}),qe}function wr(ze,We){var qe=v(ze),ot=v(We),_t=n(We),mt=n(ze)*_t,Et=f(ze)*_t,fr=f(ot*We);ze=M(a(Et,fr)),We=z(mt),M(ze-w)>o&&(ze%=w);var pr=Gr(ze>l/4?w-ze:ze,We);return ze>l/4&&(fr=pr[0],pr[0]=-pr[1],pr[1]=-fr),pr[0]*=qe,pr[1]*=-ot,pr}wr.invert=function(ze,We){M(ze)>1&&(ze=v(ze)*2-ze),M(We)>1&&(We=v(We)*2-We);var qe=v(ze),ot=v(We),_t=-qe*ze,mt=-ot*We,Et=mt/_t<1,fr=wn(Et?mt:_t,Et?_t:mt),pr=fr[0],lr=fr[1],xr=n(lr);return Et&&(pr=-w-pr),[qe*(a(f(pr)*xr,-f(lr))+l),ot*z(n(pr)*xr)]};function Gr(ze,We){if(We===w)return[0,0];var qe=f(We),ot=qe*qe,_t=ot*ot,mt=1+_t,Et=1+3*_t,fr=1-_t,pr=z(1/D(mt)),lr=fr+ot*mt*pr,xr=(1-qe)/lr,Pr=D(xr),Xr=xr*mt,qr=D(Xr),bn=Pr*fr,Dn,Wn;if(ze===0)return[0,-(bn+ot*qr)];var ga=n(We),xa=1/ga,Ka=2*qe*ga,Ya=(-3*ot+pr*Et)*Ka,ei=(-lr*ga-(1-qe)*Ya)/(lr*lr),hi=.5*ei/Pr,io=fr*hi-2*ot*Pr*Ka,ri=ot*mt*ei+xr*Et*Ka,Vi=-xa*Ka,fo=-xa*ri,_o=-2*xa*io,bi=4*ze/l,Mi;if(ze>.222*l||We<l/4&&ze>.175*l){if(Dn=(bn+ot*D(Xr*(1+_t)-bn*bn))/(1+_t),ze>l/4)return[Dn,Dn];var fs=Dn,go=.5*Dn;Dn=.5*(go+fs),Wn=50;do{var Po=D(Xr-Dn*Dn),Go=Dn*(_o+Vi*Po)+fo*z(Dn/qr)-bi;if(!Go)break;Go<0?go=Dn:fs=Dn,Dn=.5*(go+fs)}while(M(fs-go)>o&&--Wn>0)}else{Dn=o,Wn=25;do{var le=Dn*Dn,_e=D(Xr-le),Le=_o+Vi*_e,Be=Dn*Le+fo*z(Dn/qr)-bi,Oe=Le+(fo-Vi*le)/_e;Dn-=Mi=_e?Be/Oe:0}while(M(Mi)>o&&--Wn>0)}return[Dn,-bn-ot*D(Xr-Dn*Dn)]}function wn(ze,We){for(var qe=0,ot=1,_t=.5,mt=50;;){var Et=_t*_t,fr=D(_t),pr=z(1/D(1+Et)),lr=1-Et+_t*(1+Et)*pr,xr=(1-fr)/lr,Pr=D(xr),Xr=xr*(1+Et),qr=Pr*(1-Et),bn=Xr-ze*ze,Dn=D(bn),Wn=We+qr+_t*Dn;if(M(ot-qe)<m||--mt===0||Wn===0)break;Wn>0?qe=_t:ot=_t,_t=.5*(qe+ot)}if(!mt)return null;var ga=z(fr),xa=n(ga),Ka=1/xa,Ya=2*fr*xa,ei=(-3*_t+pr*(1+3*Et))*Ya,hi=(-lr*xa-(1-fr)*ei)/(lr*lr),io=.5*hi/Pr,ri=(1-Et)*io-2*_t*Pr*Ya,Vi=-2*Ka*ri,fo=-Ka*Ya,_o=-Ka*(_t*(1+Et)*hi+xr*(1+3*Et)*Ya);return[l/4*(ze*(Vi+fo*Dn)+_o*z(ze/D(Xr))),ga]}function cn(){return g.geoProjection(Er(wr)).scale(239.75)}function Bn(ze,We,qe){var ot,_t,mt;return ze?(ot=En(ze,qe),We?(_t=En(We,1-qe),mt=_t[1]*_t[1]+qe*ot[0]*ot[0]*_t[0]*_t[0],[[ot[0]*_t[2]/mt,ot[1]*ot[2]*_t[0]*_t[1]/mt],[ot[1]*_t[1]/mt,-ot[0]*ot[2]*_t[0]*_t[2]/mt],[ot[2]*_t[1]*_t[2]/mt,-qe*ot[0]*ot[1]*_t[0]/mt]]):[[ot[0],0],[ot[1],0],[ot[2],0]]):(_t=En(We,1-qe),[[0,_t[0]/_t[1]],[1/_t[1],0],[_t[2]/_t[1],0]])}function En(ze,We){var qe,ot,_t,mt,Et;if(We<o)return mt=f(ze),ot=n(ze),qe=We*(ze-mt*ot)/4,[mt-qe*ot,ot+qe*mt,1-We*mt*mt/2,ze-qe];if(We>=1-o)return qe=(1-We)/4,ot=F(ze),mt=R(ze),_t=1/ot,Et=ot*O(ze),[mt+qe*(Et-ze)/(ot*ot),_t-qe*mt*_t*(Et-ze),_t+qe*mt*_t*(Et+ze),2*e(r(ze))-w+qe*(Et-ze)/ot];var fr=[1,0,0,0,0,0,0,0,0],pr=[D(We),0,0,0,0,0,0,0,0],lr=0;for(ot=D(1-We),Et=1;M(pr[lr]/fr[lr])>o&&lr<8;)qe=fr[lr++],pr[lr]=(qe-ot)/2,fr[lr]=(qe+ot)/2,ot=D(qe*ot),Et*=2;_t=Et*fr[lr]*ze;do mt=pr[lr]*f(ot=_t)/fr[lr],_t=(z(mt)+_t)/2;while(--lr);return[f(_t),mt=n(_t),mt/n(_t-ot),_t]}function Yn(ze,We,qe){var ot=M(ze),_t=M(We),mt=O(_t);if(ot){var Et=1/f(ot),fr=1/(d(ot)*d(ot)),pr=-(fr+qe*(mt*mt*Et*Et)-1+qe),lr=(qe-1)*fr,xr=(-pr+D(pr*pr-4*lr))/2;return[Vn(e(1/D(xr)),qe)*v(ze),Vn(e(D((xr/fr-1)/qe)),1-qe)*v(We)]}return[0,Vn(e(mt),1-qe)*v(We)]}function Vn(ze,We){if(!We)return ze;if(We===1)return h(d(ze/2+_));for(var qe=1,ot=D(1-We),_t=D(We),mt=0;M(_t)>o;mt++){if(ze%l){var Et=e(ot*d(ze)/qe);Et<0&&(Et+=l),ze+=Et+~~(ze/l)*l}else ze+=ze;_t=(qe+ot)/2,ot=D(qe*ot),_t=((qe=_t)-ot)/2}return ze/(x(2,mt)*qe)}function pa(ze,We){var qe=(b-1)/(b+1),ot=D(1-qe*qe),_t=Vn(w,ot*ot),mt=-1,Et=h(d(l/4+M(We)/2)),fr=r(mt*Et)/D(qe),pr=Ma(fr*n(mt*ze),fr*f(mt*ze)),lr=Yn(pr[0],pr[1],ot*ot);return[-lr[1],(We>=0?1:-1)*(.5*_t-lr[0])]}function Ma(ze,We){var qe=ze*ze,ot=We+1,_t=1-qe-We*We;return[.5*((ze>=0?w:-w)-a(_t,2*ze)),-.25*h(_t*_t+4*qe)+.5*h(ot*ot+qe)]}function ci(ze,We){var qe=We[0]*We[0]+We[1]*We[1];return[(ze[0]*We[0]+ze[1]*We[1])/qe,(ze[1]*We[0]-ze[0]*We[1])/qe]}pa.invert=function(ze,We){var qe=(b-1)/(b+1),ot=D(1-qe*qe),_t=Vn(w,ot*ot),mt=-1,Et=Bn(.5*_t-We,-ze,ot*ot),fr=ci(Et[0],Et[1]),pr=a(fr[1],fr[0])/mt;return[pr,2*e(r(.5/mt*h(qe*fr[0]*fr[0]+qe*fr[1]*fr[1])))-w]};function Va(){return g.geoProjection(Er(pa)).scale(151.496)}function ja(ze){var We=f(ze),qe=n(ze),ot=Wa(ze);ot.invert=Wa(-ze);function _t(mt,Et){var fr=ot(mt,Et);mt=fr[0],Et=fr[1];var pr=f(Et),lr=n(Et),xr=n(mt),Pr=I(We*pr+qe*lr*xr),Xr=f(Pr),qr=M(Xr)>o?Pr/Xr:1;return[qr*qe*f(mt),(M(mt)>w?qr:-qr)*(We*lr-qe*pr*xr)]}return _t.invert=function(mt,Et){var fr=D(mt*mt+Et*Et),pr=-f(fr),lr=n(fr),xr=fr*lr,Pr=-Et*pr,Xr=fr*We,qr=D(xr*xr+Pr*Pr-Xr*Xr),bn=a(xr*Xr+Pr*qr,Pr*Xr-xr*qr),Dn=(fr>w?-1:1)*a(mt*pr,fr*n(bn)*lr+Et*f(bn)*pr);return ot.invert(Dn,bn)},_t}function Wa(ze){var We=f(ze),qe=n(ze);return function(ot,_t){var mt=n(_t),Et=n(ot)*mt,fr=f(ot)*mt,pr=f(_t);return[a(fr,Et*qe-pr*We),z(pr*qe+Et*We)]}}function Tr(){var ze=0,We=g.geoProjectionMutator(ja),qe=We(ze),ot=qe.rotate,_t=qe.stream,mt=g.geoCircle();return qe.parallel=function(Et){if(!arguments.length)return ze*T;var fr=qe.rotate();return We(ze=Et*k).rotate(fr)},qe.rotate=function(Et){return arguments.length?(ot.call(qe,[Et[0],Et[1]-ze*T]),mt.center([-Et[0],-Et[1]]),qe):(Et=ot.call(qe),Et[1]+=ze*T,Et)},qe.stream=function(Et){return Et=_t(Et),Et.sphere=function(){Et.polygonStart();var fr=.01,pr=mt.radius(90-fr)().coordinates[0],lr=pr.length-1,xr=-1,Pr;for(Et.lineStart();++xr<lr;)Et.point((Pr=pr[xr])[0],Pr[1]);for(Et.lineEnd(),pr=mt.radius(90+fr)().coordinates[0],lr=pr.length-1,Et.lineStart();--xr>=0;)Et.point((Pr=pr[xr])[0],Pr[1]);Et.lineEnd(),Et.polygonEnd()},Et},qe.scale(79.4187).parallel(45).clipAngle(180-.001)}var pn=3,fn=z(1-1/pn)*T,An=Rt(0);function Zn(ze){var We=fn*k,qe=Ne(l,We)[0]-Ne(-l,We)[0],ot=An(0,We)[1],_t=Ne(0,We)[1],mt=u-_t,Et=L/ze,fr=4/L,pr=ot+mt*mt*4/L;function lr(xr,Pr){var Xr,qr=M(Pr);if(qr>We){var bn=i(ze-1,s(0,t((xr+l)/Et)));xr+=l*(ze-1)/ze-bn*Et,Xr=Ne(xr,qr),Xr[0]=Xr[0]*L/qe-L*(ze-1)/(2*ze)+bn*L/ze,Xr[1]=ot+(Xr[1]-_t)*4*mt/L,Pr<0&&(Xr[1]=-Xr[1])}else Xr=An(xr,Pr);return Xr[0]*=fr,Xr[1]/=pr,Xr}return lr.invert=function(xr,Pr){xr/=fr,Pr*=pr;var Xr=M(Pr);if(Xr>ot){var qr=i(ze-1,s(0,t((xr+l)/Et)));xr=(xr+l*(ze-1)/ze-qr*Et)*qe/L;var bn=Ne.invert(xr,.25*(Xr-ot)*L/mt+_t);return bn[0]-=l*(ze-1)/ze-qr*Et,Pr<0&&(bn[1]=-bn[1]),bn}return An.invert(xr,Pr)},lr}function ua(ze,We){return[ze,We&1?90-o:fn]}function ea(ze,We){return[ze,We&1?-90+o:-fn]}function Rn(ze){return[ze[0]*(1-o),ze[1]]}function Xn(ze){var We=[].concat(S.range(-180,180+ze/2,ze).map(ua),S.range(180,-180-ze/2,-ze).map(ea));return{type:"Polygon",coordinates:[ze===180?We.map(Rn):We]}}function Ua(){var ze=4,We=g.geoProjectionMutator(Zn),qe=We(ze),ot=qe.stream;return qe.lobes=function(_t){return arguments.length?We(ze=+_t):ze},qe.stream=function(_t){var mt=qe.rotate(),Et=ot(_t),fr=(qe.rotate([0,0]),ot(_t));return qe.rotate(mt),Et.sphere=function(){g.geoStream(Xn(180/ze),fr)},Et},qe.scale(239.75)}function li(ze){var We=1+ze,qe=f(1/We),ot=z(qe),_t=2*D(l/(mt=l+4*ot*We)),mt,Et=.5*_t*(We+D(ze*(2+ze))),fr=ze*ze,pr=We*We;function lr(xr,Pr){var Xr=1-f(Pr),qr,bn;if(Xr&&Xr<2){var Dn=w-Pr,Wn=25,ga;do{var xa=f(Dn),Ka=n(Dn),Ya=ot+a(xa,We-Ka),ei=1+pr-2*We*Ka;Dn-=ga=(Dn-fr*ot-We*xa+ei*Ya-.5*Xr*mt)/(2*We*xa*Ya)}while(M(ga)>m&&--Wn>0);qr=_t*D(ei),bn=xr*Ya/l}else qr=_t*(ze+Xr),bn=xr*ot/l;return[qr*f(bn),Et-qr*n(bn)]}return lr.invert=function(xr,Pr){var Xr=xr*xr+(Pr-=Et)*Pr,qr=(1+pr-Xr/(_t*_t))/(2*We),bn=I(qr),Dn=f(bn),Wn=ot+a(Dn,We-qr);return[z(xr/D(Xr))*l/Wn,z(1-2*(bn-fr*ot-We*Dn+(1+pr-2*We*qr)*Wn)/mt)]},lr}function Ht(){var ze=1,We=g.geoProjectionMutator(li),qe=We(ze);return qe.ratio=function(ot){return arguments.length?We(ze=+ot):ze},qe.scale(167.774).center([0,18.67])}var hr=.7109889596207567,rn=.0528035274542;function vn(ze,We){return We>-hr?(ze=Ee(ze,We),ze[1]+=rn,ze):Ie(ze,We)}vn.invert=function(ze,We){return We>-hr?Ee.invert(ze,We-rn):Ie.invert(ze,We)};function en(){return g.geoProjection(vn).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}function Tn(ze,We){return M(We)>hr?(ze=Ee(ze,We),ze[1]-=We>0?rn:-rn,ze):Ie(ze,We)}Tn.invert=function(ze,We){return M(We)>hr?Ee.invert(ze,We+(We>0?rn:-rn)):Ie.invert(ze,We)};function xn(){return g.geoProjection(Tn).scale(152.63)}function un(ze,We,qe,ot){var _t=D(4*l/(2*qe+(1+ze-We/2)*f(2*qe)+(ze+We)/2*f(4*qe)+We/2*f(6*qe))),mt=D(ot*f(qe)*D((1+ze*n(2*qe)+We*n(4*qe))/(1+ze+We))),Et=qe*pr(1);function fr(Pr){return D(1+ze*n(2*Pr)+We*n(4*Pr))}function pr(Pr){var Xr=Pr*qe;return(2*Xr+(1+ze-We/2)*f(2*Xr)+(ze+We)/2*f(4*Xr)+We/2*f(6*Xr))/qe}function lr(Pr){return fr(Pr)*f(Pr)}var xr=function(Pr,Xr){var qr=qe*be(pr,Et*f(Xr)/qe,Xr/l);isNaN(qr)&&(qr=qe*v(Xr));var bn=_t*fr(qr);return[bn*mt*Pr/l*n(qr),bn/mt*f(qr)]};return xr.invert=function(Pr,Xr){var qr=be(lr,Xr*mt/_t);return[Pr*l/(n(qr)*_t*mt*fr(qr)),z(qe*pr(qr/qe)/Et)]},qe===0&&(_t=D(ot/l),xr=function(Pr,Xr){return[Pr*_t,f(Xr)/_t]},xr.invert=function(Pr,Xr){return[Pr/_t,z(Xr*_t)]}),xr}function yr(){var ze=1,We=0,qe=45*k,ot=2,_t=g.geoProjectionMutator(un),mt=_t(ze,We,qe,ot);return mt.a=function(Et){return arguments.length?_t(ze=+Et,We,qe,ot):ze},mt.b=function(Et){return arguments.length?_t(ze,We=+Et,qe,ot):We},mt.psiMax=function(Et){return arguments.length?_t(ze,We,qe=+Et*k,ot):qe*T},mt.ratio=function(Et){return arguments.length?_t(ze,We,qe,ot=+Et):ot},mt.scale(180.739)}function mr(ze,We,qe,ot,_t,mt,Et,fr,pr,lr,xr){if(xr.nanEncountered)return NaN;var Pr,Xr,qr,bn,Dn,Wn,ga,xa,Ka,Ya;if(Pr=qe-We,Xr=ze(We+Pr*.25),qr=ze(qe-Pr*.25),isNaN(Xr)){xr.nanEncountered=!0;return}if(isNaN(qr)){xr.nanEncountered=!0;return}return bn=Pr*(ot+4*Xr+_t)/12,Dn=Pr*(_t+4*qr+mt)/12,Wn=bn+Dn,Ya=(Wn-Et)/15,lr>pr?(xr.maxDepthCount++,Wn+Ya):Math.abs(Ya)<fr?Wn+Ya:(ga=We+Pr*.5,xa=mr(ze,We,ga,ot,Xr,_t,bn,fr*.5,pr,lr+1,xr),isNaN(xa)?(xr.nanEncountered=!0,NaN):(Ka=mr(ze,ga,qe,_t,qr,mt,Dn,fr*.5,pr,lr+1,xr),isNaN(Ka)?(xr.nanEncountered=!0,NaN):xa+Ka))}function zr(ze,We,qe,ot,_t){var mt={maxDepthCount:0,nanEncountered:!1};ot===void 0&&(ot=1e-8),_t===void 0&&(_t=20);var Et=ze(We),fr=ze(.5*(We+qe)),pr=ze(qe),lr=(Et+4*fr+pr)*(qe-We)/6,xr=mr(ze,We,qe,Et,fr,pr,lr,ot,_t,1,mt);return xr}function gn(ze,We,qe){function ot(qr){return ze+(1-ze)*x(1-x(qr,We),1/We)}function _t(qr){return zr(ot,0,qr,1e-4)}for(var mt=1/_t(1),Et=1e3,fr=(1+1e-8)*mt,pr=[],lr=0;lr<=Et;lr++)pr.push(_t(lr/Et)*fr);function xr(qr){var bn=0,Dn=Et,Wn=Et>>1;do pr[Wn]>qr?Dn=Wn:bn=Wn,Wn=bn+Dn>>1;while(Wn>bn);var ga=pr[Wn+1]-pr[Wn];return ga&&(ga=(qr-pr[Wn+1])/ga),(Wn+1+ga)/Et}var Pr=2*xr(1)/l*mt/qe,Xr=function(qr,bn){var Dn=xr(M(f(bn))),Wn=ot(Dn)*qr;return Dn/=Pr,[Wn,bn>=0?Dn:-Dn]};return Xr.invert=function(qr,bn){var Dn;return bn*=Pr,M(bn)<1&&(Dn=v(bn)*z(_t(M(bn))*mt)),[qr/ot(M(bn)),Dn]},Xr}function On(){var ze=0,We=2.5,qe=1.183136,ot=g.geoProjectionMutator(gn),_t=ot(ze,We,qe);return _t.alpha=function(mt){return arguments.length?ot(ze=+mt,We,qe):ze},_t.k=function(mt){return arguments.length?ot(ze,We=+mt,qe):We},_t.gamma=function(mt){return arguments.length?ot(ze,We,qe=+mt):qe},_t.scale(152.63)}function ta(ze,We){return M(ze[0]-We[0])<o&&M(ze[1]-We[1])<o}function _n(ze,We){for(var qe=-1,ot=ze.length,_t=ze[0],mt,Et,fr,pr=[];++qe<ot;){mt=ze[qe],Et=(mt[0]-_t[0])/We,fr=(mt[1]-_t[1])/We;for(var lr=0;lr<We;++lr)pr.push([_t[0]+lr*Et,_t[1]+lr*fr]);_t=mt}return pr.push(mt),pr}function jn(ze){var We=[],qe,ot,_t,mt,Et,fr,pr,lr=ze[0].length;for(pr=0;pr<lr;++pr)qe=ze[0][pr],ot=qe[0][0],_t=qe[0][1],mt=qe[1][1],Et=qe[2][0],fr=qe[2][1],We.push(_n([[ot+o,_t+o],[ot+o,mt-o],[Et-o,mt-o],[Et-o,fr+o]],30));for(pr=ze[1].length-1;pr>=0;--pr)qe=ze[1][pr],ot=qe[0][0],_t=qe[0][1],mt=qe[1][1],Et=qe[2][0],fr=qe[2][1],We.push(_n([[Et-o,fr-o],[Et-o,mt+o],[ot+o,mt+o],[ot+o,_t-o]],30));return{type:"Polygon",coordinates:[S.merge(We)]}}function aa(ze,We,qe){var ot,_t;function mt(pr,lr){for(var xr=lr<0?-1:1,Pr=We[+(lr<0)],Xr=0,qr=Pr.length-1;Xr<qr&&pr>Pr[Xr][2][0];++Xr);var bn=ze(pr-Pr[Xr][1][0],lr);return bn[0]+=ze(Pr[Xr][1][0],xr*lr>xr*Pr[Xr][0][1]?Pr[Xr][0][1]:lr)[0],bn}qe?mt.invert=qe(mt):ze.invert&&(mt.invert=function(pr,lr){for(var xr=_t[+(lr<0)],Pr=We[+(lr<0)],Xr=0,qr=xr.length;Xr<qr;++Xr){var bn=xr[Xr];if(bn[0][0]<=pr&&pr<bn[1][0]&&bn[0][1]<=lr&&lr<bn[1][1]){var Dn=ze.invert(pr-ze(Pr[Xr][1][0],0)[0],lr);return Dn[0]+=Pr[Xr][1][0],ta(mt(Dn[0],Dn[1]),[pr,lr])?Dn:null}}});var Et=g.geoProjection(mt),fr=Et.stream;return Et.stream=function(pr){var lr=Et.rotate(),xr=fr(pr),Pr=(Et.rotate([0,0]),fr(pr));return Et.rotate(lr),xr.sphere=function(){g.geoStream(ot,Pr)},xr},Et.lobes=function(pr){return arguments.length?(ot=jn(pr),We=pr.map(function(lr){return lr.map(function(xr){return[[xr[0][0]*k,xr[0][1]*k],[xr[1][0]*k,xr[1][1]*k],[xr[2][0]*k,xr[2][1]*k]]})}),_t=We.map(function(lr){return lr.map(function(xr){var Pr=ze(xr[0][0],xr[0][1])[0],Xr=ze(xr[2][0],xr[2][1])[0],qr=ze(xr[1][0],xr[0][1])[1],bn=ze(xr[1][0],xr[1][1])[1],Dn;return qr>bn&&(Dn=qr,qr=bn,bn=Dn),[[Pr,qr],[Xr,bn]]})}),Et):We.map(function(lr){return lr.map(function(xr){return[[xr[0][0]*T,xr[0][1]*T],[xr[1][0]*T,xr[1][1]*T],[xr[2][0]*T,xr[2][1]*T]]})})},We!=null&&Et.lobes(We),Et}var da=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function ma(){return aa(ke,da).scale(160.857)}var sa=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function Aa(){return aa(Tn,sa).scale(152.63)}var vo=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function Io(){return aa(Ee,vo).scale(169.529)}var jo=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function nl(){return aa(Ee,jo).scale(169.529).rotate([20,0])}var pl=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];function Yl(){return aa(vn,pl,ce).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}var vi=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Vs(){return aa(Ie,vi).scale(152.63).rotate([-20,0])}function Ds(ze,We){return[3/L*ze*D(l*l/3-We*We),We]}Ds.invert=function(ze,We){return[L/3*ze/D(l*l/3-We*We),We]};function Ui(){return g.geoProjection(Ds).scale(158.837)}function Mo(ze){function We(qe,ot){if(M(M(ot)-w)<o)return[0,ot<0?-2:2];var _t=f(ot),mt=x((1+_t)/(1-_t),ze/2),Et=.5*(mt+1/mt)+n(qe*=ze);return[2*f(qe)/Et,(mt-1/mt)/Et]}return We.invert=function(qe,ot){var _t=M(ot);if(M(_t-2)<o)return qe?null:[0,v(ot)*w];if(_t>2)return null;qe/=2,ot/=2;var mt=qe*qe,Et=ot*ot,fr=2*ot/(1+mt+Et);return fr=x((1+fr)/(1-fr),1/ze),[a(2*qe,1-mt-Et)/ze,z((fr-1)/(fr+1))]},We}function dl(){var ze=.5,We=g.geoProjectionMutator(Mo),qe=We(ze);return qe.spacing=function(ot){return arguments.length?We(ze=+ot):ze},qe.scale(124.75)}var vs=l/b;function Di(ze,We){return[ze*(1+D(n(We)))/2,We/(n(We/2)*n(ze/6))]}Di.invert=function(ze,We){var qe=M(ze),ot=M(We),_t=o,mt=w;ot<vs?mt*=ot/vs:_t+=6*I(vs/ot);for(var Et=0;Et<25;Et++){var fr=f(mt),pr=D(n(mt)),lr=f(mt/2),xr=n(mt/2),Pr=f(_t/6),Xr=n(_t/6),qr=.5*_t*(1+pr)-qe,bn=mt/(xr*Xr)-ot,Dn=pr?-.25*_t*fr/pr:0,Wn=.5*(1+pr),ga=(1+.5*mt*lr/xr)/(xr*Xr),xa=mt/xr*(Pr/6)/(Xr*Xr),Ka=Dn*xa-ga*Wn,Ya=(qr*xa-bn*Wn)/Ka,ei=(bn*Dn-qr*ga)/Ka;if(mt-=Ya,_t-=ei,M(Ya)<o&&M(ei)<o)break}return[ze<0?-_t:_t,We<0?-mt:mt]};function al(){return g.geoProjection(Di).scale(97.2672)}function Ki(ze,We){var qe=ze*ze,ot=We*We;return[ze*(.975534+ot*(-.119161+qe*-.0143059+ot*-.0547009)),We*(1.00384+qe*(.0802894+ot*-.02855+qe*199025e-9)+ot*(.0998909+ot*-.0491032))]}Ki.invert=function(ze,We){var qe=v(ze)*l,ot=We/2,_t=50;do{var mt=qe*qe,Et=ot*ot,fr=qe*ot,pr=qe*(.975534+Et*(-.119161+mt*-.0143059+Et*-.0547009))-ze,lr=ot*(1.00384+mt*(.0802894+Et*-.02855+mt*199025e-9)+Et*(.0998909+Et*-.0491032))-We,xr=.975534-Et*(.119161+3*mt*.0143059+Et*.0547009),Pr=-fr*(2*.119161+4*.0547009*Et+2*.0143059*mt),Xr=fr*(2*.0802894+4*199025e-9*mt+2*-.02855*Et),qr=1.00384+mt*(.0802894+199025e-9*mt)+Et*(3*(.0998909-.02855*mt)-5*.0491032*Et),bn=Pr*Xr-qr*xr,Dn=(lr*Pr-pr*qr)/bn,Wn=(pr*Xr-lr*xr)/bn;qe-=Dn,ot-=Wn}while((M(Dn)>o||M(Wn)>o)&&--_t>0);return _t&&[qe,ot]};function Fi(){return g.geoProjection(Ki).scale(139.98)}function ao(ze,We){return[f(ze)/n(We),d(We)*n(ze)]}ao.invert=function(ze,We){var qe=ze*ze,ot=We*We,_t=ot+1,mt=qe+_t,Et=ze?c*D((mt-D(mt*mt-4*qe))/qe):1/D(_t);return[z(ze*Et),v(We)*I(Et)]};function Ji(){return g.geoProjection(ao).scale(144.049).clipAngle(90-.001)}function ts(ze){var We=n(ze),qe=d(_+ze/2);function ot(_t,mt){var Et=mt-ze,fr=M(Et)<o?_t*We:M(fr=_+mt/2)<o||M(M(fr)-w)<o?0:_t*Et/h(d(fr)/qe);return[fr,Et]}return ot.invert=function(_t,mt){var Et,fr=mt+ze;return[M(mt)<o?_t/We:M(Et=_+fr/2)<o||M(M(Et)-w)<o?0:_t*h(d(Et)/qe)/mt,fr]},ot}function Gs(){return Ve(ts).parallel(40).scale(158.837)}function au(ze,We){return[ze,1.25*h(d(_+.4*We))]}au.invert=function(ze,We){return[ze,2.5*e(r(.8*We))-.625*l]};function Ko(){return g.geoProjection(au).scale(108.318)}function iu(ze){var We=ze.length-1;function qe(ot,_t){for(var mt=n(_t),Et=2/(1+mt*n(ot)),fr=Et*mt*f(ot),pr=Et*f(_t),lr=We,xr=ze[lr],Pr=xr[0],Xr=xr[1],qr;--lr>=0;)xr=ze[lr],Pr=xr[0]+fr*(qr=Pr)-pr*Xr,Xr=xr[1]+fr*Xr+pr*qr;return Pr=fr*(qr=Pr)-pr*Xr,Xr=fr*Xr+pr*qr,[Pr,Xr]}return qe.invert=function(ot,_t){var mt=20,Et=ot,fr=_t;do{for(var pr=We,lr=ze[pr],xr=lr[0],Pr=lr[1],Xr=0,qr=0,bn;--pr>=0;)lr=ze[pr],Xr=xr+Et*(bn=Xr)-fr*qr,qr=Pr+Et*qr+fr*bn,xr=lr[0]+Et*(bn=xr)-fr*Pr,Pr=lr[1]+Et*Pr+fr*bn;Xr=xr+Et*(bn=Xr)-fr*qr,qr=Pr+Et*qr+fr*bn,xr=Et*(bn=xr)-fr*Pr-ot,Pr=Et*Pr+fr*bn-_t;var Dn=Xr*Xr+qr*qr,Wn,ga;Et-=Wn=(xr*Xr+Pr*qr)/Dn,fr-=ga=(Pr*Xr-xr*qr)/Dn}while(M(Wn)+M(ga)>o*o&&--mt>0);if(mt){var xa=D(Et*Et+fr*fr),Ka=2*e(xa*.5),Ya=f(Ka);return[a(Et*Ya,xa*n(Ka)),xa?z(fr*Ya/xa):0]}},qe}var Rs=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],So=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Mu=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Is=[[.9245,0],[0,0],[.01943,0]],_s=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Ll(){return ws(Rs,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)}function Su(){return ws(So,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])}function ku(){return ws(Mu,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])}function Ys(){return ws(Is,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)}function Pl(){return ws(_s,[165,10]).scale(250).clipAngle(130).center([-165,-10])}function ws(ze,We){var qe=g.geoProjection(iu(ze)).rotate(We).clipAngle(90),ot=g.geoRotation(We),_t=qe.center;return delete qe.rotate,qe.center=function(mt){return arguments.length?_t(ot(mt)):ot.invert(_t())},qe}var Wl=D(6),il=D(7);function Xl(ze,We){var qe=z(7*f(We)/(3*Wl));return[Wl*ze*(2*n(2*qe/3)-1)/il,9*f(qe/3)/il]}Xl.invert=function(ze,We){var qe=3*z(We*il/9);return[ze*il/(Wl*(2*n(2*qe/3)-1)),z(f(qe)*3*Wl/7)]};function ou(){return g.geoProjection(Xl).scale(164.859)}function Dl(ze,We){for(var qe=(1+c)*f(We),ot=We,_t=0,mt;_t<25&&(ot-=mt=(f(ot/2)+f(ot)-qe)/(.5*n(ot/2)+n(ot)),!(M(mt)<o));_t++);return[ze*(1+2*n(ot)/n(ot/2))/(3*b),2*D(3)*f(ot/2)/D(2+b)]}Dl.invert=function(ze,We){var qe=We*D(2+b)/(2*D(3)),ot=2*z(qe);return[3*b*ze/(1+2*n(ot)/n(ot/2)),z((qe+f(ot))/(1+c))]};function Eu(){return g.geoProjection(Dl).scale(188.209)}function Ws(ze,We){for(var qe=D(6/(4+l)),ot=(1+l/4)*f(We),_t=We/2,mt=0,Et;mt<25&&(_t-=Et=(_t/2+f(_t)-ot)/(.5+n(_t)),!(M(Et)<o));mt++);return[qe*(.5+n(_t))*ze/1.5,qe*_t]}Ws.invert=function(ze,We){var qe=D(6/(4+l)),ot=We/qe;return M(M(ot)-w)<o&&(ot=ot<0?-w:w),[1.5*ze/(qe*(.5+n(ot))),z((ot/2+f(ot))/(1+l/4))]};function Zl(){return g.geoProjection(Ws).scale(166.518)}function Rl(ze,We){var qe=We*We,ot=qe*qe,_t=qe*ot;return[ze*(.84719-.13063*qe+_t*_t*(-.04515+.05494*qe-.02326*ot+.00331*_t)),We*(1.01183+ot*ot*(-.02625+.01926*qe-.00396*ot))]}Rl.invert=function(ze,We){var qe=We,ot=25,_t,mt,Et,fr;do mt=qe*qe,Et=mt*mt,qe-=_t=(qe*(1.01183+Et*Et*(-.02625+.01926*mt-.00396*Et))-We)/(1.01183+Et*Et*(9*-.02625+11*.01926*mt+13*-.00396*Et));while(M(_t)>m&&--ot>0);return mt=qe*qe,Et=mt*mt,fr=mt*Et,[ze/(.84719-.13063*mt+fr*fr*(-.04515+.05494*mt-.02326*Et+.00331*fr)),qe]};function ps(){return g.geoProjection(Rl).scale(175.295)}function yl(ze,We){return[ze*(1+n(We))/2,2*(We-d(We/2))]}yl.invert=function(ze,We){for(var qe=We/2,ot=0,_t=1/0;ot<10&&M(_t)>o;++ot){var mt=n(We/2);We-=_t=(We-d(We/2)-qe)/(1-.5/(mt*mt))}return[2*ze/(1+n(We)),We]};function jl(){return g.geoProjection(yl).scale(152.63)}var su=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function lu(){return aa(se(1/0),su).rotate([20,0]).scale(152.63)}function Il(ze,We){var qe=f(We),ot=n(We),_t=v(ze);if(ze===0||M(We)===w)return[0,We];if(We===0)return[ze,0];if(M(ze)===w)return[ze*ot,w*qe];var mt=l/(2*ze)-2*ze/l,Et=2*We/l,fr=(1-Et*Et)/(qe-Et),pr=mt*mt,lr=fr*fr,xr=1+pr/lr,Pr=1+lr/pr,Xr=(mt*qe/fr-mt/2)/xr,qr=(lr*qe/pr+fr/2)/Pr,bn=Xr*Xr+ot*ot/xr,Dn=qr*qr-(lr*qe*qe/pr+fr*qe-1)/Pr;return[w*(Xr+D(bn)*_t),w*(qr+D(Dn<0?0:Dn)*v(-We*mt)*_t)]}Il.invert=function(ze,We){ze/=w,We/=w;var qe=ze*ze,ot=We*We,_t=qe+ot,mt=l*l;return[ze?(_t-1+D((1-_t)*(1-_t)+4*qe))/(2*ze)*w:0,be(function(Et){return _t*(l*f(Et)-2*Et)*l+4*Et*Et*(We-f(Et))+2*l*Et-mt*We},0)]};function Cu(){return g.geoProjection(Il).scale(127.267)}var uu=1.0148,Jo=.23185,ol=-.14499,sl=.02406,Kl=uu,ds=5*Jo,ko=7*ol,zl=9*sl,Ts=1.790857183;function As(ze,We){var qe=We*We;return[ze,We*(uu+qe*qe*(Jo+qe*(ol+sl*qe)))]}As.invert=function(ze,We){We>Ts?We=Ts:We<-Ts&&(We=-Ts);var qe=We,ot;do{var _t=qe*qe;qe-=ot=(qe*(uu+_t*_t*(Jo+_t*(ol+sl*_t)))-We)/(Kl+_t*_t*(ds+_t*(ko+zl*_t)))}while(M(ot)>o);return[ze,qe]};function so(){return g.geoProjection(As).scale(139.319)}function ml(ze,We){if(M(We)<o)return[ze,0];var qe=d(We),ot=ze*f(We);return[f(ot)/qe,We+(1-n(ot))/qe]}ml.invert=function(ze,We){if(M(We)<o)return[ze,0];var qe=ze*ze+We*We,ot=We*.5,_t=10,mt;do{var Et=d(ot),fr=1/n(ot),pr=qe-2*We*ot+ot*ot;ot-=mt=(Et*pr+2*(ot-We))/(2+pr*fr*fr+2*(ot-We)*Et)}while(M(mt)>o&&--_t>0);return Et=d(ot),[(M(We)<M(ot+1/Et)?z(ze*Et):v(We)*v(ze)*(I(M(ze*Et))+w))/f(ot),ot]};function xl(){return g.geoProjection(ml).scale(103.74)}function Xs(ze,We){var qe=ll(ze[1],ze[0]),ot=ll(We[1],We[0]),_t=_l(qe,ot),mt=Fl(qe)/Fl(ot);return bl([1,0,ze[0][0],0,1,ze[0][1]],bl([mt,0,0,0,mt,0],bl([n(_t),f(_t),0,-f(_t),n(_t),0],[1,0,-We[0][0],0,1,-We[0][1]])))}function gs(ze){var We=1/(ze[0]*ze[4]-ze[1]*ze[3]);return[We*ze[4],-We*ze[1],We*(ze[1]*ze[5]-ze[2]*ze[4]),-We*ze[3],We*ze[0],We*(ze[2]*ze[3]-ze[0]*ze[5])]}function bl(ze,We){return[ze[0]*We[0]+ze[1]*We[3],ze[0]*We[1]+ze[1]*We[4],ze[0]*We[2]+ze[1]*We[5]+ze[2],ze[3]*We[0]+ze[4]*We[3],ze[3]*We[1]+ze[4]*We[4],ze[3]*We[2]+ze[4]*We[5]+ze[5]]}function ll(ze,We){return[ze[0]-We[0],ze[1]-We[1]]}function Fl(ze){return D(ze[0]*ze[0]+ze[1]*ze[1])}function _l(ze,We){return a(ze[0]*We[1]-ze[1]*We[0],ze[0]*We[0]+ze[1]*We[1])}function Zs(ze,We,qe){ot(ze,{transform:null});function ot(lr,xr){if(lr.edges=Jl(lr.face),xr.face){var Pr=lr.shared=Yu(lr.face,xr.face),Xr=Xs(Pr.map(xr.project),Pr.map(lr.project));lr.transform=xr.transform?bl(xr.transform,Xr):Xr;for(var qr=xr.edges,bn=0,Dn=qr.length;bn<Dn;++bn)rs(Pr[0],qr[bn][1])&&rs(Pr[1],qr[bn][0])&&(qr[bn]=lr),rs(Pr[0],qr[bn][0])&&rs(Pr[1],qr[bn][1])&&(qr[bn]=lr);for(qr=lr.edges,bn=0,Dn=qr.length;bn<Dn;++bn)rs(Pr[0],qr[bn][0])&&rs(Pr[1],qr[bn][1])&&(qr[bn]=xr),rs(Pr[0],qr[bn][1])&&rs(Pr[1],qr[bn][0])&&(qr[bn]=xr)}else lr.transform=xr.transform;return lr.children&&lr.children.forEach(function(Wn){ot(Wn,lr)}),lr}function _t(lr,xr){var Pr=We(lr,xr),Xr=Pr.project([lr*T,xr*T]),qr;return(qr=Pr.transform)?[qr[0]*Xr[0]+qr[1]*Xr[1]+qr[2],-(qr[3]*Xr[0]+qr[4]*Xr[1]+qr[5])]:(Xr[1]=-Xr[1],Xr)}ul(ze)&&(_t.invert=function(lr,xr){var Pr=mt(ze,[lr,-xr]);return Pr&&(Pr[0]*=k,Pr[1]*=k,Pr)});function mt(lr,xr){var Pr=lr.project.invert,Xr=lr.transform,qr=xr;if(Xr&&(Xr=gs(Xr),qr=[Xr[0]*qr[0]+Xr[1]*qr[1]+Xr[2],Xr[3]*qr[0]+Xr[4]*qr[1]+Xr[5]]),Pr&&lr===Et(bn=Pr(qr)))return bn;for(var bn,Dn=lr.children,Wn=0,ga=Dn&&Dn.length;Wn<ga;++Wn)if(bn=mt(Dn[Wn],xr))return bn}function Et(lr){return We(lr[0]*k,lr[1]*k)}var fr=g.geoProjection(_t),pr=fr.stream;return fr.stream=function(lr){var xr=fr.rotate(),Pr=pr(lr),Xr=(fr.rotate([0,0]),pr(lr));return fr.rotate(xr),Pr.sphere=function(){Xr.polygonStart(),Xr.lineStart(),Lu(Xr,ze),Xr.lineEnd(),Xr.polygonEnd()},Pr},fr.angle(qe==null?-30:qe*T)}function Lu(ze,We,qe){var ot,_t=We.edges,mt=_t.length,Et,fr={type:"MultiPoint",coordinates:We.face},pr=We.face.filter(function(Dn){return M(Dn[1])!==90}),lr=g.geoBounds({type:"MultiPoint",coordinates:pr}),xr=!1,Pr=-1,Xr=lr[1][0]-lr[0][0],qr=Xr===180||Xr===360?[(lr[0][0]+lr[1][0])/2,(lr[0][1]+lr[1][1])/2]:g.geoCentroid(fr);if(qe)for(;++Pr<mt&&_t[Pr]!==qe;);++Pr;for(var bn=0;bn<mt;++bn)Et=_t[(bn+Pr)%mt],Array.isArray(Et)?(xr||(ze.point((ot=g.geoInterpolate(Et[0],qr)(o))[0],ot[1]),xr=!0),ze.point((ot=g.geoInterpolate(Et[1],qr)(o))[0],ot[1])):(xr=!1,Et!==qe&&Lu(ze,Et,We))}function rs(ze,We){return ze&&We&&ze[0]===We[0]&&ze[1]===We[1]}function Yu(ze,We){for(var qe,ot,_t=ze.length,mt=null,Et=0;Et<_t;++Et){qe=ze[Et];for(var fr=We.length;--fr>=0;)if(ot=We[fr],qe[0]===ot[0]&&qe[1]===ot[1]){if(mt)return[mt,qe];mt=qe}}}function Jl(ze){for(var We=ze.length,qe=[],ot=ze[We-1],_t=0;_t<We;++_t)qe.push([ot,ot=ze[_t]]);return qe}function ul(ze){return ze.project.invert||ze.children&&ze.children.some(ul)}var wl=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],js=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(ze){return ze.map(function(We){return wl[We]})});function Tl(ze){ze=ze||function(qe){var ot=g.geoCentroid({type:"MultiPoint",coordinates:qe});return g.geoGnomonic().scale(1).translate([0,0]).rotate([-ot[0],-ot[1]])};var We=js.map(function(qe){return{face:qe,project:ze(qe)}});return[-1,0,0,1,0,1,4,5].forEach(function(qe,ot){var _t=We[qe];_t&&(_t.children||(_t.children=[])).push(We[ot])}),Zs(We[0],function(qe,ot){return We[qe<-l/2?ot<0?6:4:qe<0?ot<0?2:0:qe<l/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(101.858).center([0,45])}var fu=2/D(3);function cu(ze,We){var qe=Ne(ze,We);return[qe[0]*fu,qe[1]]}cu.invert=function(ze,We){return Ne.invert(ze/fu,We)};function Wu(ze){ze=ze||function(qe){var ot=g.geoCentroid({type:"MultiPoint",coordinates:qe});return g.geoProjection(cu).translate([0,0]).scale(1).rotate(ot[1]>0?[-ot[0],0]:[180-ot[0],180])};var We=js.map(function(qe){return{face:qe,project:ze(qe)}});return[-1,0,0,1,0,1,4,5].forEach(function(qe,ot){var _t=We[qe];_t&&(_t.children||(_t.children=[])).push(We[ot])}),Zs(We[0],function(qe,ot){return We[qe<-l/2?ot<0?6:4:qe<0?ot<0?2:0:qe<l/2?ot<0?3:1:ot<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])}function Ri(ze){ze=ze||function(Et){var fr=Et.length===6?g.geoCentroid({type:"MultiPoint",coordinates:Et}):Et[0];return g.geoGnomonic().scale(1).translate([0,0]).rotate([-fr[0],-fr[1]])};var We=js.map(function(Et){for(var fr=Et.map(ns),pr=fr.length,lr=fr[pr-1],xr,Pr=[],Xr=0;Xr<pr;++Xr)xr=fr[Xr],Pr.push(Qo([lr[0]*.9486832980505138+xr[0]*.31622776601683794,lr[1]*.9486832980505138+xr[1]*.31622776601683794,lr[2]*.9486832980505138+xr[2]*.31622776601683794]),Qo([xr[0]*.9486832980505138+lr[0]*.31622776601683794,xr[1]*.9486832980505138+lr[1]*.31622776601683794,xr[2]*.9486832980505138+lr[2]*.31622776601683794])),lr=xr;return Pr}),qe=[],ot=[-1,0,0,1,0,1,4,5];We.forEach(function(Et,fr){for(var pr=js[fr],lr=pr.length,xr=qe[fr]=[],Pr=0;Pr<lr;++Pr)We.push([pr[Pr],Et[(Pr*2+2)%(2*lr)],Et[(Pr*2+1)%(2*lr)]]),ot.push(fr),xr.push(Ks(ns(Et[(Pr*2+2)%(2*lr)]),ns(Et[(Pr*2+1)%(2*lr)])))});var _t=We.map(function(Et){return{project:ze(Et),face:Et}});ot.forEach(function(Et,fr){var pr=_t[Et];pr&&(pr.children||(pr.children=[])).push(_t[fr])});function mt(Et,fr){var pr=n(fr),lr=[pr*n(Et),pr*f(Et),f(fr)],xr=Et<-l/2?fr<0?6:4:Et<0?fr<0?2:0:Et<l/2?fr<0?3:1:fr<0?7:5,Pr=qe[xr];return _t[fl(Pr[0],lr)<0?8+3*xr:fl(Pr[1],lr)<0?8+3*xr+1:fl(Pr[2],lr)<0?8+3*xr+2:xr]}return Zs(_t[0],mt).angle(-30).scale(110.625).center([0,45])}function fl(ze,We){for(var qe=0,ot=ze.length,_t=0;qe<ot;++qe)_t+=ze[qe]*We[qe];return _t}function Ks(ze,We){return[ze[1]*We[2]-ze[2]*We[1],ze[2]*We[0]-ze[0]*We[2],ze[0]*We[1]-ze[1]*We[0]]}function Qo(ze){return[a(ze[1],ze[0])*T,z(s(-1,i(1,ze[2])))*T]}function ns(ze){var We=ze[0]*k,qe=ze[1]*k,ot=n(qe);return[ot*n(We),ot*f(We),f(qe)]}function Al(){}function lo(ze){if((qe=ze.length)<4)return!1;for(var We=0,qe,ot=ze[qe-1][1]*ze[0][0]-ze[qe-1][0]*ze[0][1];++We<qe;)ot+=ze[We-1][1]*ze[We][0]-ze[We-1][0]*ze[We][1];return ot<=0}function hu(ze,We){for(var qe=We[0],ot=We[1],_t=!1,mt=0,Et=ze.length,fr=Et-1;mt<Et;fr=mt++){var pr=ze[mt],lr=pr[0],xr=pr[1],Pr=ze[fr],Xr=Pr[0],qr=Pr[1];xr>ot^qr>ot&&qe<(Xr-lr)*(ot-xr)/(qr-xr)+lr&&(_t=!_t)}return _t}function as(ze,We){var qe=We.stream,ot;if(!qe)throw new Error("invalid projection");switch(ze&&ze.type){case"Feature":ot=Fs;break;case"FeatureCollection":ot=zs;break;default:ot=is;break}return ot(ze,qe)}function zs(ze,We){return{type:"FeatureCollection",features:ze.features.map(function(qe){return Fs(qe,We)})}}function Fs(ze,We){return{type:"Feature",id:ze.id,properties:ze.properties,geometry:is(ze.geometry,We)}}function Ms(ze,We){return{type:"GeometryCollection",geometries:ze.geometries.map(function(qe){return is(qe,We)})}}function is(ze,We){if(!ze)return null;if(ze.type==="GeometryCollection")return Ms(ze,We);var qe;switch(ze.type){case"Point":qe=os;break;case"MultiPoint":qe=os;break;case"LineString":qe=vu;break;case"MultiLineString":qe=vu;break;case"Polygon":qe=Ol;break;case"MultiPolygon":qe=Ol;break;case"Sphere":qe=Ol;break;default:return null}return g.geoStream(ze,We(qe)),qe.result()}var Hi=[],Eo=[],os={point:function(ze,We){Hi.push([ze,We])},result:function(){var ze=Hi.length?Hi.length<2?{type:"Point",coordinates:Hi[0]}:{type:"MultiPoint",coordinates:Hi}:null;return Hi=[],ze}},vu={lineStart:Al,point:function(ze,We){Hi.push([ze,We])},lineEnd:function(){Hi.length&&(Eo.push(Hi),Hi=[])},result:function(){var ze=Eo.length?Eo.length<2?{type:"LineString",coordinates:Eo[0]}:{type:"MultiLineString",coordinates:Eo}:null;return Eo=[],ze}},Ol={polygonStart:Al,lineStart:Al,point:function(ze,We){Hi.push([ze,We])},lineEnd:function(){var ze=Hi.length;if(ze){do Hi.push(Hi[0].slice());while(++ze<4);Eo.push(Hi),Hi=[]}},polygonEnd:Al,result:function(){if(!Eo.length)return null;var ze=[],We=[];return Eo.forEach(function(qe){lo(qe)?ze.push([qe]):We.push(qe)}),We.forEach(function(qe){var ot=qe[0];ze.some(function(_t){if(hu(_t[0],ot))return _t.push(qe),!0})||ze.push([qe])}),Eo=[],ze.length?ze.length>1?{type:"MultiPolygon",coordinates:ze}:{type:"Polygon",coordinates:ze[0]}:null}};function pu(ze){var We=ze(w,0)[0]-ze(-w,0)[0];function qe(ot,_t){var mt=M(ot)<w,Et=ze(mt?ot:ot>0?ot-l:ot+l,_t),fr=(Et[0]-Et[1])*c,pr=(Et[0]+Et[1])*c;if(mt)return[fr,pr];var lr=We*c,xr=fr>0^pr>0?-1:1;return[xr*fr-v(pr)*lr,xr*pr-v(fr)*lr]}return ze.invert&&(qe.invert=function(ot,_t){var mt=(ot+_t)*c,Et=(_t-ot)*c,fr=M(mt)<.5*We&&M(Et)<.5*We;if(!fr){var pr=We*c,lr=mt>0^Et>0?-1:1,xr=-lr*ot+(Et>0?1:-1)*pr,Pr=-lr*_t+(mt>0?1:-1)*pr;mt=(-xr-Pr)*c,Et=(xr-Pr)*c}var Xr=ze.invert(mt,Et);return fr||(Xr[0]+=mt>0?l:-l),Xr}),g.geoProjection(qe).rotate([-90,-90,45]).clipAngle(180-.001)}function yt(){return pu(wr).scale(176.423)}function Bt(){return pu(pa).scale(111.48)}function cr(ze,We){if(!(0<=(We=+We)&&We<=20))throw new Error("invalid digits");function qe(lr){var xr=lr.length,Pr=2,Xr=new Array(xr);for(Xr[0]=+lr[0].toFixed(We),Xr[1]=+lr[1].toFixed(We);Pr<xr;)Xr[Pr]=lr[Pr],++Pr;return Xr}function ot(lr){return lr.map(qe)}function _t(lr){for(var xr=qe(lr[0]),Pr=[xr],Xr=1;Xr<lr.length;Xr++){var qr=qe(lr[Xr]);(qr.length>2||qr[0]!=xr[0]||qr[1]!=xr[1])&&(Pr.push(qr),xr=qr)}return Pr.length===1&&lr.length>1&&Pr.push(qe(lr[lr.length-1])),Pr}function mt(lr){return lr.map(_t)}function Et(lr){if(lr==null)return lr;var xr;switch(lr.type){case"GeometryCollection":xr={type:"GeometryCollection",geometries:lr.geometries.map(Et)};break;case"Point":xr={type:"Point",coordinates:qe(lr.coordinates)};break;case"MultiPoint":xr={type:lr.type,coordinates:ot(lr.coordinates)};break;case"LineString":xr={type:lr.type,coordinates:_t(lr.coordinates)};break;case"MultiLineString":case"Polygon":xr={type:lr.type,coordinates:mt(lr.coordinates)};break;case"MultiPolygon":xr={type:"MultiPolygon",coordinates:lr.coordinates.map(mt)};break;default:return lr}return lr.bbox!=null&&(xr.bbox=lr.bbox),xr}function fr(lr){var xr={type:"Feature",properties:lr.properties,geometry:Et(lr.geometry)};return lr.id!=null&&(xr.id=lr.id),lr.bbox!=null&&(xr.bbox=lr.bbox),xr}if(ze!=null)switch(ze.type){case"Feature":return fr(ze);case"FeatureCollection":{var pr={type:"FeatureCollection",features:ze.features.map(fr)};return ze.bbox!=null&&(pr.bbox=ze.bbox),pr}default:return Et(ze)}return ze}function sr(ze){var We=f(ze);function qe(ot,_t){var mt=We?d(ot*We/2)/We:ot/2;if(!_t)return[2*mt,-ze];var Et=2*e(mt*f(_t)),fr=1/d(_t);return[f(Et)*fr,_t+(1-n(Et))*fr-ze]}return qe.invert=function(ot,_t){if(M(_t+=ze)<o)return[We?2*e(We*ot/2)/We:ot,0];var mt=ot*ot+_t*_t,Et=0,fr=10,pr;do{var lr=d(Et),xr=1/n(Et),Pr=mt-2*_t*Et+Et*Et;Et-=pr=(lr*Pr+2*(Et-_t))/(2+Pr*xr*xr+2*(Et-_t)*lr)}while(M(pr)>o&&--fr>0);var Xr=ot*(lr=d(Et)),qr=d(M(_t)<M(Et+1/lr)?z(Xr)*.5:I(Xr)*.5+l/4)/f(Et);return[We?2*e(We*qr)/We:2*qr,Et]},qe}function Dr(){return Ve(sr).scale(131.215)}var tn=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];tn.forEach(function(ze){ze[1]*=1.0144});function dn(ze,We){var qe=i(18,M(We)*36/l),ot=t(qe),_t=qe-ot,mt=(Pr=tn[ot])[0],Et=Pr[1],fr=(Pr=tn[++ot])[0],pr=Pr[1],lr=(Pr=tn[i(19,++ot)])[0],xr=Pr[1],Pr;return[ze*(fr+_t*(lr-mt)/2+_t*_t*(lr-2*fr+mt)/2),(We>0?w:-w)*(pr+_t*(xr-Et)/2+_t*_t*(xr-2*pr+Et)/2)]}dn.invert=function(ze,We){var qe=We/w,ot=qe*90,_t=i(18,M(ot/5)),mt=s(0,t(_t));do{var Et=tn[mt][1],fr=tn[mt+1][1],pr=tn[i(19,mt+2)][1],lr=pr-Et,xr=pr-2*fr+Et,Pr=2*(M(qe)-fr)/lr,Xr=xr/lr,qr=Pr*(1-Xr*Pr*(1-2*Xr*Pr));if(qr>=0||mt===1){ot=(We>=0?5:-5)*(qr+_t);var bn=50,Dn;do _t=i(18,M(ot)/5),mt=t(_t),qr=_t-mt,Et=tn[mt][1],fr=tn[mt+1][1],pr=tn[i(19,mt+2)][1],ot-=(Dn=(We>=0?w:-w)*(fr+qr*(pr-Et)/2+qr*qr*(pr-2*fr+Et)/2)-We)*T;while(M(Dn)>m&&--bn>0);break}}while(--mt>=0);var Wn=tn[mt][0],ga=tn[mt+1][0],xa=tn[i(19,mt+2)][0];return[ze/(ga+qr*(xa-Wn)/2+qr*qr*(xa-2*ga+Wn)/2),ot*k]};function Mn(){return g.geoProjection(dn).scale(152.63)}function Ln(ze){function We(qe,ot){var _t=n(ot),mt=(ze-1)/(ze-_t*n(qe));return[mt*_t*f(qe),mt*f(ot)]}return We.invert=function(qe,ot){var _t=qe*qe+ot*ot,mt=D(_t),Et=(ze-D(1-_t*(ze+1)/(ze-1)))/((ze-1)/mt+mt/(ze-1));return[a(qe*Et,mt*D(1-Et*Et)),mt?z(ot*Et/mt):0]},We}function Nn(ze,We){var qe=Ln(ze);if(!We)return qe;var ot=n(We),_t=f(We);function mt(Et,fr){var pr=qe(Et,fr),lr=pr[1],xr=lr*_t/(ze-1)+ot;return[pr[0]*ot/xr,lr/xr]}return mt.invert=function(Et,fr){var pr=(ze-1)/(ze-1-fr*_t);return qe.invert(pr*Et,pr*fr*ot)},mt}function yn(){var ze=2,We=0,qe=g.geoProjectionMutator(Nn),ot=qe(ze,We);return ot.distance=function(_t){return arguments.length?qe(ze=+_t,We):ze},ot.tilt=function(_t){return arguments.length?qe(ze,We=_t*k):We*T},ot.scale(432.147).clipAngle(I(1/ze)*T-1e-6)}var zn=1e-4,Pn=1e4,Hn=-180,$n=Hn+zn,za=180,Ea=za-zn,Fa=-90,Oa=Fa+zn,Jn=90,ha=Jn-zn;function Ga(ze){return ze.length>0}function Qa(ze){return Math.floor(ze*Pn)/Pn}function di(ze){return ze===Fa||ze===Jn?[0,ze]:[Hn,Qa(ze)]}function gi(ze){var We=ze[0],qe=ze[1],ot=!1;return We<=$n?(We=Hn,ot=!0):We>=Ea&&(We=za,ot=!0),qe<=Oa?(qe=Fa,ot=!0):qe>=ha&&(qe=Jn,ot=!0),ot?[We,qe]:ze}function mi(ze){return ze.map(gi)}function Ai(ze,We,qe){for(var ot=0,_t=ze.length;ot<_t;++ot){var mt=ze[ot].slice();qe.push({index:-1,polygon:We,ring:mt});for(var Et=0,fr=mt.length;Et<fr;++Et){var pr=mt[Et],lr=pr[0],xr=pr[1];if(lr<=$n||lr>=Ea||xr<=Oa||xr>=ha){mt[Et]=gi(pr);for(var Pr=Et+1;Pr<fr;++Pr){var Xr=mt[Pr],qr=Xr[0],bn=Xr[1];if(qr>$n&&qr<Ea&&bn>Oa&&bn<ha)break}if(Pr===Et+1)continue;if(Et){var Dn={index:-1,polygon:We,ring:mt.slice(0,Et+1)};Dn.ring[Dn.ring.length-1]=di(xr),qe[qe.length-1]=Dn}else qe.pop();if(Pr>=fr)break;qe.push({index:-1,polygon:We,ring:mt=mt.slice(Pr-1)}),mt[0]=di(mt[0][1]),Et=-1,fr=mt.length}}}}function oi(ze){var We,qe=ze.length,ot={},_t={},mt,Et,fr,pr,lr;for(We=0;We<qe;++We){if(mt=ze[We],Et=mt.ring[0],pr=mt.ring[mt.ring.length-1],Et[0]===pr[0]&&Et[1]===pr[1]){mt.polygon.push(mt.ring),ze[We]=null;continue}mt.index=We,ot[Et]=_t[pr]=mt}for(We=0;We<qe;++We)if(mt=ze[We],mt){if(Et=mt.ring[0],pr=mt.ring[mt.ring.length-1],fr=_t[Et],lr=ot[pr],delete ot[Et],delete _t[pr],Et[0]===pr[0]&&Et[1]===pr[1]){mt.polygon.push(mt.ring);continue}fr?(delete _t[Et],delete ot[fr.ring[0]],fr.ring.pop(),ze[fr.index]=null,mt={index:-1,polygon:fr.polygon,ring:fr.ring.concat(mt.ring)},fr===lr?mt.polygon.push(mt.ring):(mt.index=qe++,ze.push(ot[mt.ring[0]]=_t[mt.ring[mt.ring.length-1]]=mt))):lr?(delete ot[pr],delete _t[lr.ring[lr.ring.length-1]],mt.ring.pop(),mt={index:qe++,polygon:lr.polygon,ring:mt.ring.concat(lr.ring)},ze[lr.index]=null,ze.push(ot[mt.ring[0]]=_t[mt.ring[mt.ring.length-1]]=mt)):(mt.ring.push(mt.ring[0]),mt.polygon.push(mt.ring))}}function mo(ze){var We={type:"Feature",geometry:qi(ze.geometry)};return ze.id!=null&&(We.id=ze.id),ze.bbox!=null&&(We.bbox=ze.bbox),ze.properties!=null&&(We.properties=ze.properties),We}function qi(ze){if(ze==null)return ze;var We,qe,ot,_t;switch(ze.type){case"GeometryCollection":We={type:"GeometryCollection",geometries:ze.geometries.map(qi)};break;case"Point":We={type:"Point",coordinates:gi(ze.coordinates)};break;case"MultiPoint":case"LineString":We={type:ze.type,coordinates:mi(ze.coordinates)};break;case"MultiLineString":We={type:"MultiLineString",coordinates:ze.coordinates.map(mi)};break;case"Polygon":{var mt=[];Ai(ze.coordinates,mt,qe=[]),oi(qe),We={type:"Polygon",coordinates:mt};break}case"MultiPolygon":{qe=[],ot=-1,_t=ze.coordinates.length;for(var Et=new Array(_t);++ot<_t;)Ai(ze.coordinates[ot],Et[ot]=[],qe);oi(qe),We={type:"MultiPolygon",coordinates:Et.filter(Ga)};break}default:return ze}return ze.bbox!=null&&(We.bbox=ze.bbox),We}function Ja(ze){if(ze==null)return ze;switch(ze.type){case"Feature":return mo(ze);case"FeatureCollection":{var We={type:"FeatureCollection",features:ze.features.map(mo)};return ze.bbox!=null&&(We.bbox=ze.bbox),We}default:return qi(ze)}}function va(ze,We){var qe=d(We/2),ot=f(_*qe);return[ze*(.74482-.34588*ot*ot),1.70711*qe]}va.invert=function(ze,We){var qe=We/1.70711,ot=f(_*qe);return[ze/(.74482-.34588*ot*ot),2*e(qe)]};function xi(){return g.geoProjection(va).scale(146.153)}function uo(ze,We,qe){var ot=g.geoInterpolate(We,qe),_t=ot(.5),mt=g.geoRotation([-_t[0],-_t[1]])(We),Et=ot.distance/2,fr=-z(f(mt[1]*k)/f(Et)),pr=[-_t[0],-_t[1],-(mt[0]>0?l-fr:fr)*T],lr=g.geoProjection(ze(Et)).rotate(pr),xr=g.geoRotation(pr),Pr=lr.center;return delete lr.rotate,lr.center=function(Xr){return arguments.length?Pr(xr(Xr)):xr.invert(Pr())},lr.clipAngle(90)}function po(ze){var We=n(ze);function qe(ot,_t){var mt=g.geoGnomonicRaw(ot,_t);return mt[0]*=We,mt}return qe.invert=function(ot,_t){return g.geoGnomonicRaw.invert(ot/We,_t)},qe}function ss(){return Ss([-158,21.5],[-77,39]).clipAngle(60).scale(400)}function Ss(ze,We){return uo(po,ze,We)}function zo(ze){if(!(ze*=2))return g.geoAzimuthalEquidistantRaw;var We=-ze/2,qe=-We,ot=ze*ze,_t=d(qe),mt=.5/f(qe);function Et(fr,pr){var lr=I(n(pr)*n(fr-We)),xr=I(n(pr)*n(fr-qe)),Pr=pr<0?-1:1;return lr*=lr,xr*=xr,[(lr-xr)/(2*ze),Pr*D(4*ot*xr-(ot-lr+xr)*(ot-lr+xr))/(2*ze)]}return Et.invert=function(fr,pr){var lr=pr*pr,xr=n(D(lr+(Xr=fr+We)*Xr)),Pr=n(D(lr+(Xr=fr+qe)*Xr)),Xr,qr;return[a(qr=xr-Pr,Xr=(xr+Pr)*_t),(pr<0?-1:1)*I(D(Xr*Xr+qr*qr)*mt)]},Et}function Js(){return ys([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)}function ys(ze,We){return uo(zo,ze,We)}function ls(ze,We){if(M(We)<o)return[ze,0];var qe=M(We/w),ot=z(qe);if(M(ze)<o||M(M(We)-w)<o)return[0,v(We)*l*d(ot/2)];var _t=n(ot),mt=M(l/ze-ze/l)/2,Et=mt*mt,fr=_t/(qe+_t-1),pr=fr*(2/qe-1),lr=pr*pr,xr=lr+Et,Pr=fr-lr,Xr=Et+fr;return[v(ze)*l*(mt*Pr+D(Et*Pr*Pr-xr*(fr*fr-lr)))/xr,v(We)*l*(pr*Xr-mt*D((Et+1)*xr-Xr*Xr))/xr]}ls.invert=function(ze,We){if(M(We)<o)return[ze,0];if(M(ze)<o)return[0,w*f(2*e(We/l))];var qe=(ze/=l)*ze,ot=(We/=l)*We,_t=qe+ot,mt=_t*_t,Et=-M(We)*(1+_t),fr=Et-2*ot+qe,pr=-2*Et+1+2*ot+mt,lr=ot/pr+(2*fr*fr*fr/(pr*pr*pr)-9*Et*fr/(pr*pr))/27,xr=(Et-fr*fr/(3*pr))/pr,Pr=2*D(-xr/3),Xr=I(3*lr/(xr*Pr))/3;return[l*(_t-1+D(1+2*(qe-ot)+mt))/(2*ze),v(We)*l*(-Pr*n(Xr+l/3)-fr/(3*pr))]};function xo(){return g.geoProjection(ls).scale(79.4183)}function Bl(ze,We){if(M(We)<o)return[ze,0];var qe=M(We/w),ot=z(qe);if(M(ze)<o||M(M(We)-w)<o)return[0,v(We)*l*d(ot/2)];var _t=n(ot),mt=M(l/ze-ze/l)/2,Et=mt*mt,fr=_t*(D(1+Et)-mt*_t)/(1+Et*qe*qe);return[v(ze)*l*fr,v(We)*l*D(1-fr*(2*mt+fr))]}Bl.invert=function(ze,We){if(!ze)return[0,w*f(2*e(We/l))];var qe=M(ze/l),ot=(1-qe*qe-(We/=l)*We)/(2*qe),_t=ot*ot,mt=D(_t+1);return[v(ze)*l*(mt-ot),v(We)*w*f(2*a(D((1-2*ot*qe)*(ot+mt)-qe),D(mt+ot+qe)))]};function Ql(){return g.geoProjection(Bl).scale(79.4183)}function us(ze,We){if(M(We)<o)return[ze,0];var qe=We/w,ot=z(qe);if(M(ze)<o||M(M(We)-w)<o)return[0,l*d(ot/2)];var _t=(l/ze-ze/l)/2,mt=qe/(1+n(ot));return[l*(v(ze)*D(_t*_t+1-mt*mt)-_t),l*mt]}us.invert=function(ze,We){if(!We)return[ze,0];var qe=We/l,ot=(l*l*(1-qe*qe)-ze*ze)/(2*l*ze);return[ze?l*(v(ze)*D(ot*ot+1)-ot):0,w*f(2*e(qe))]};function du(){return g.geoProjection(us).scale(79.4183)}function Nl(ze,We){if(!We)return[ze,0];var qe=M(We);if(!ze||qe===w)return[0,We];var ot=qe/w,_t=ot*ot,mt=(8*ot-_t*(_t+2)-5)/(2*_t*(ot-1)),Et=mt*mt,fr=ot*mt,pr=_t+Et+2*fr,lr=ot+3*mt,xr=ze/w,Pr=xr+1/xr,Xr=v(M(ze)-w)*D(Pr*Pr-4),qr=Xr*Xr,bn=pr*(_t+Et*qr-1)+(1-_t)*(_t*(lr*lr+4*Et)+12*fr*Et+4*Et*Et),Dn=(Xr*(pr+Et-1)+2*D(bn))/(4*pr+qr);return[v(ze)*w*Dn,v(We)*w*D(1+Xr*M(Dn)-Dn*Dn)]}Nl.invert=function(ze,We){var qe;if(!ze||!We)return[ze,We];We/=l;var ot=v(ze)*ze/w,_t=(ot*ot-1+4*We*We)/M(ot),mt=_t*_t,Et=2*We,fr=50;do{var pr=Et*Et,lr=(8*Et-pr*(pr+2)-5)/(2*pr*(Et-1)),xr=(3*Et-pr*Et-10)/(2*pr*Et),Pr=lr*lr,Xr=Et*lr,qr=Et+lr,bn=qr*qr,Dn=Et+3*lr,Wn=bn*(pr+Pr*mt-1)+(1-pr)*(pr*(Dn*Dn+4*Pr)+Pr*(12*Xr+4*Pr)),ga=-2*qr*(4*Xr*Pr+(1-4*pr+3*pr*pr)*(1+xr)+Pr*(-6+14*pr-mt+(-8+8*pr-2*mt)*xr)+Xr*(-8+12*pr+(-10+10*pr-mt)*xr)),xa=D(Wn),Ka=_t*(bn+Pr-1)+2*xa-ot*(4*bn+mt),Ya=_t*(2*lr*xr+2*qr*(1+xr))+ga/xa-8*qr*(_t*(-1+Pr+bn)+2*xa)*(1+xr)/(mt+4*bn);Et-=qe=Ka/Ya}while(qe>o&&--fr>0);return[v(ze)*(D(_t*_t+4)+_t)*l/4,w*Et]};function vf(){return g.geoProjection(Nl).scale(127.16)}function Pu(ze,We,qe,ot,_t){function mt(Et,fr){var pr=qe*f(ot*fr),lr=D(1-pr*pr),xr=D(2/(1+lr*n(Et*=_t)));return[ze*lr*xr*f(Et),We*pr*xr]}return mt.invert=function(Et,fr){var pr=Et/ze,lr=fr/We,xr=D(pr*pr+lr*lr),Pr=2*z(xr/2);return[a(Et*d(Pr),ze*xr)/_t,xr&&z(fr*f(Pr)/(We*qe*xr))/ot]},mt}function gu(ze,We,qe,ot){var _t=l/3;ze=s(ze,o),We=s(We,o),ze=i(ze,w),We=i(We,l-o),qe=s(qe,0),qe=i(qe,100-o),ot=s(ot,o);var mt=qe/100+1,Et=ot/100,fr=I(mt*n(_t))/_t,pr=f(ze)/f(fr*w),lr=We/l,xr=D(Et*f(ze/2)/f(We/2)),Pr=xr/D(lr*pr*fr),Xr=1/(xr*D(lr*pr*fr));return Pu(Pr,Xr,pr,fr,lr)}function Du(){var ze=65*k,We=60*k,qe=20,ot=200,_t=g.geoProjectionMutator(gu),mt=_t(ze,We,qe,ot);return mt.poleline=function(Et){return arguments.length?_t(ze=+Et*k,We,qe,ot):ze*T},mt.parallels=function(Et){return arguments.length?_t(ze,We=+Et*k,qe,ot):We*T},mt.inflation=function(Et){return arguments.length?_t(ze,We,qe=+Et,ot):qe},mt.ratio=function(Et){return arguments.length?_t(ze,We,qe,ot=+Et):ot},mt.scale(163.775)}function ks(){return Du().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)}var Xu=4*l+3*D(3),Ru=2*D(2*l*D(3)/Xu),Iu=me(Ru*D(3)/l,Ru,Xu/6);function Fo(){return g.geoProjection(Iu).scale(176.84)}function zu(ze,We){return[ze*D(1-3*We*We/(l*l)),We]}zu.invert=function(ze,We){return[ze/D(1-3*We*We/(l*l)),We]};function $u(){return g.geoProjection(zu).scale(152.63)}function ms(ze,We){var qe=n(We),ot=n(ze)*qe,_t=1-ot,mt=n(ze=a(f(ze)*qe,-f(We))),Et=f(ze);return qe=D(1-ot*ot),[Et*qe-mt*_t,-mt*qe-Et*_t]}ms.invert=function(ze,We){var qe=(ze*ze+We*We)/-2,ot=D(-qe*(2+qe)),_t=We*qe+ze*ot,mt=ze*qe-We*ot,Et=D(mt*mt+_t*_t);return[a(ot*_t,Et*(1+qe)),Et?-z(ot*mt/Et):0]};function yu(){return g.geoProjection(ms).rotate([0,-90,45]).scale(124.75).clipAngle(180-.001)}function mu(ze,We){var qe=Y(ze,We);return[(qe[0]+ze/w)/2,(qe[1]+We)/2]}mu.invert=function(ze,We){var qe=ze,ot=We,_t=25;do{var mt=n(ot),Et=f(ot),fr=f(2*ot),pr=Et*Et,lr=mt*mt,xr=f(qe),Pr=n(qe/2),Xr=f(qe/2),qr=Xr*Xr,bn=1-lr*Pr*Pr,Dn=bn?I(mt*Pr)*D(Wn=1/bn):Wn=0,Wn,ga=.5*(2*Dn*mt*Xr+qe/w)-ze,xa=.5*(Dn*Et+ot)-We,Ka=.5*Wn*(lr*qr+Dn*mt*Pr*pr)+.5/w,Ya=Wn*(xr*fr/4-Dn*Et*Xr),ei=.125*Wn*(fr*Xr-Dn*Et*lr*xr),hi=.5*Wn*(pr*Pr+Dn*qr*mt)+.5,io=Ya*ei-hi*Ka,ri=(xa*Ya-ga*hi)/io,Vi=(ga*ei-xa*Ka)/io;qe-=ri,ot-=Vi}while((M(ri)>o||M(Vi)>o)&&--_t>0);return[qe,ot]};function Fu(){return g.geoProjection(mu).scale(158.837)}A.geoNaturalEarth=g.geoNaturalEarth1,A.geoNaturalEarthRaw=g.geoNaturalEarth1Raw,A.geoAiry=W,A.geoAiryRaw=K,A.geoAitoff=re,A.geoAitoffRaw=Y,A.geoArmadillo=j,A.geoArmadilloRaw=ue,A.geoAugust=H,A.geoAugustRaw=q,A.geoBaker=X,A.geoBakerRaw=ne,A.geoBerghaus=ie,A.geoBerghausRaw=Q,A.geoBertin1953=ye,A.geoBertin1953Raw=de,A.geoBoggs=Xe,A.geoBoggsRaw=ke,A.geoBonne=vt,A.geoBonneRaw=Ye,A.geoBottomley=Kt,A.geoBottomleyRaw=Dt,A.geoBromley=Mt,A.geoBromleyRaw=Ft,A.geoChamberlin=Ae,A.geoChamberlinRaw=Ge,A.geoChamberlinAfrica=He,A.geoCollignon=Ze,A.geoCollignonRaw=Ne,A.geoCraig=bt,A.geoCraigRaw=Qe,A.geoCraster=Ut,A.geoCrasterRaw=wt,A.geoCylindricalEqualArea=Nt,A.geoCylindricalEqualAreaRaw=Rt,A.geoCylindricalStereographic=Vt,A.geoCylindricalStereographicRaw=Wt,A.geoEckert1=Hr,A.geoEckert1Raw=ir,A.geoEckert2=jr,A.geoEckert2Raw=sn,A.geoEckert3=$t,A.geoEckert3Raw=at,A.geoEckert4=Gt,A.geoEckert4Raw=Jt,A.geoEckert5=rt,A.geoEckert5Raw=_r,A.geoEckert6=st,A.geoEckert6Raw=Je,A.geoEisenlohr=zt,A.geoEisenlohrRaw=Tt,A.geoFahey=nt,A.geoFaheyRaw=Se,A.geoFoucaut=ct,A.geoFoucautRaw=it,A.geoFoucautSinusoidal=gt,A.geoFoucautSinusoidalRaw=kt,A.geoGilbert=ar,A.geoGingery=Yr,A.geoGingeryRaw=kr,A.geoGinzburg4=Rr,A.geoGinzburg4Raw=gr,A.geoGinzburg5=Sr,A.geoGinzburg5Raw=Br,A.geoGinzburg6=Lt,A.geoGinzburg6Raw=et,A.geoGinzburg8=or,A.geoGinzburg8Raw=Zt,A.geoGinzburg9=Or,A.geoGinzburg9Raw=Ir,A.geoGringorten=cn,A.geoGringortenRaw=wr,A.geoGuyou=Va,A.geoGuyouRaw=pa,A.geoHammer=oe,A.geoHammerRaw=se,A.geoHammerRetroazimuthal=Tr,A.geoHammerRetroazimuthalRaw=ja,A.geoHealpix=Ua,A.geoHealpixRaw=Zn,A.geoHill=Ht,A.geoHillRaw=li,A.geoHomolosine=xn,A.geoHomolosineRaw=Tn,A.geoHufnagel=yr,A.geoHufnagelRaw=un,A.geoHyperelliptical=On,A.geoHyperellipticalRaw=gn,A.geoInterrupt=aa,A.geoInterruptedBoggs=ma,A.geoInterruptedHomolosine=Aa,A.geoInterruptedMollweide=Io,A.geoInterruptedMollweideHemispheres=nl,A.geoInterruptedSinuMollweide=Yl,A.geoInterruptedSinusoidal=Vs,A.geoKavrayskiy7=Ui,A.geoKavrayskiy7Raw=Ds,A.geoLagrange=dl,A.geoLagrangeRaw=Mo,A.geoLarrivee=al,A.geoLarriveeRaw=Di,A.geoLaskowski=Fi,A.geoLaskowskiRaw=Ki,A.geoLittrow=Ji,A.geoLittrowRaw=ao,A.geoLoximuthal=Gs,A.geoLoximuthalRaw=ts,A.geoMiller=Ko,A.geoMillerRaw=au,A.geoModifiedStereographic=ws,A.geoModifiedStereographicRaw=iu,A.geoModifiedStereographicAlaska=Ll,A.geoModifiedStereographicGs48=Su,A.geoModifiedStereographicGs50=ku,A.geoModifiedStereographicMiller=Ys,A.geoModifiedStereographicLee=Pl,A.geoMollweide=Pe,A.geoMollweideRaw=Ee,A.geoMtFlatPolarParabolic=ou,A.geoMtFlatPolarParabolicRaw=Xl,A.geoMtFlatPolarQuartic=Eu,A.geoMtFlatPolarQuarticRaw=Dl,A.geoMtFlatPolarSinusoidal=Zl,A.geoMtFlatPolarSinusoidalRaw=Ws,A.geoNaturalEarth2=ps,A.geoNaturalEarth2Raw=Rl,A.geoNellHammer=jl,A.geoNellHammerRaw=yl,A.geoInterruptedQuarticAuthalic=lu,A.geoNicolosi=Cu,A.geoNicolosiRaw=Il,A.geoPatterson=so,A.geoPattersonRaw=As,A.geoPolyconic=xl,A.geoPolyconicRaw=ml,A.geoPolyhedral=Zs,A.geoPolyhedralButterfly=Tl,A.geoPolyhedralCollignon=Wu,A.geoPolyhedralWaterman=Ri,A.geoProject=as,A.geoGringortenQuincuncial=yt,A.geoPeirceQuincuncial=Bt,A.geoPierceQuincuncial=Bt,A.geoQuantize=cr,A.geoQuincuncial=pu,A.geoRectangularPolyconic=Dr,A.geoRectangularPolyconicRaw=sr,A.geoRobinson=Mn,A.geoRobinsonRaw=dn,A.geoSatellite=yn,A.geoSatelliteRaw=Nn,A.geoSinuMollweide=en,A.geoSinuMollweideRaw=vn,A.geoSinusoidal=De,A.geoSinusoidalRaw=Ie,A.geoStitch=Ja,A.geoTimes=xi,A.geoTimesRaw=va,A.geoTwoPointAzimuthal=Ss,A.geoTwoPointAzimuthalRaw=po,A.geoTwoPointAzimuthalUsa=ss,A.geoTwoPointEquidistant=ys,A.geoTwoPointEquidistantRaw=zo,A.geoTwoPointEquidistantUsa=Js,A.geoVanDerGrinten=xo,A.geoVanDerGrintenRaw=ls,A.geoVanDerGrinten2=Ql,A.geoVanDerGrinten2Raw=Bl,A.geoVanDerGrinten3=du,A.geoVanDerGrinten3Raw=us,A.geoVanDerGrinten4=vf,A.geoVanDerGrinten4Raw=Nl,A.geoWagner=Du,A.geoWagner7=ks,A.geoWagnerRaw=gu,A.geoWagner4=Fo,A.geoWagner4Raw=Iu,A.geoWagner6=$u,A.geoWagner6Raw=zu,A.geoWiechel=yu,A.geoWiechelRaw=ms,A.geoWinkel3=Fu,A.geoWinkel3Raw=mu,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,y("d3-array")):(A=A||self,g(A.d3=A.d3||{},A.d3))})(this,function(A,g){function S(){return new M}function M(){this.reset()}M.prototype={constructor:M,reset:function(){this.s=this.t=0},add:function(yt){a(e,yt,this.t),a(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new M;function a(yt,Bt,cr){var sr=yt.s=Bt+cr,Dr=sr-Bt,tn=sr-Dr;yt.t=Bt-tn+(cr-Dr)}var n=1e-6,r=1e-12,t=Math.PI,h=t/2,s=t/4,i=t*2,x=180/t,p=t/180,v=Math.abs,f=Math.atan,d=Math.atan2,o=Math.cos,m=Math.ceil,l=Math.exp,w=Math.log,_=Math.pow,c=Math.sin,b=Math.sign||function(yt){return yt>0?1:yt<0?-1:0},u=Math.sqrt,L=Math.tan;function T(yt){return yt>1?0:yt<-1?t:Math.acos(yt)}function k(yt){return yt>1?h:yt<-1?-h:Math.asin(yt)}function P(yt){return(yt=c(yt/2))*yt}function z(){}function I(yt,Bt){yt&&R.hasOwnProperty(yt.type)&&R[yt.type](yt,Bt)}var D={Feature:function(yt,Bt){I(yt.geometry,Bt)},FeatureCollection:function(yt,Bt){for(var cr=yt.features,sr=-1,Dr=cr.length;++sr<Dr;)I(cr[sr].geometry,Bt)}},R={Sphere:function(yt,Bt){Bt.sphere()},Point:function(yt,Bt){yt=yt.coordinates,Bt.point(yt[0],yt[1],yt[2])},MultiPoint:function(yt,Bt){for(var cr=yt.coordinates,sr=-1,Dr=cr.length;++sr<Dr;)yt=cr[sr],Bt.point(yt[0],yt[1],yt[2])},LineString:function(yt,Bt){O(yt.coordinates,Bt,0)},MultiLineString:function(yt,Bt){for(var cr=yt.coordinates,sr=-1,Dr=cr.length;++sr<Dr;)O(cr[sr],Bt,0)},Polygon:function(yt,Bt){F(yt.coordinates,Bt)},MultiPolygon:function(yt,Bt){for(var cr=yt.coordinates,sr=-1,Dr=cr.length;++sr<Dr;)F(cr[sr],Bt)},GeometryCollection:function(yt,Bt){for(var cr=yt.geometries,sr=-1,Dr=cr.length;++sr<Dr;)I(cr[sr],Bt)}};function O(yt,Bt,cr){var sr=-1,Dr=yt.length-cr,tn;for(Bt.lineStart();++sr<Dr;)tn=yt[sr],Bt.point(tn[0],tn[1],tn[2]);Bt.lineEnd()}function F(yt,Bt){var cr=-1,sr=yt.length;for(Bt.polygonStart();++cr<sr;)O(yt[cr],Bt,1);Bt.polygonEnd()}function N(yt,Bt){yt&&D.hasOwnProperty(yt.type)?D[yt.type](yt,Bt):I(yt,Bt)}var G=S(),K=S(),W,Y,re,ue,j,q={point:z,lineStart:z,lineEnd:z,polygonStart:function(){G.reset(),q.lineStart=H,q.lineEnd=U},polygonEnd:function(){var yt=+G;K.add(yt<0?i+yt:yt),this.lineStart=this.lineEnd=this.point=z},sphere:function(){K.add(i)}};function H(){q.point=$}function U(){ne(W,Y)}function $(yt,Bt){q.point=ne,W=yt,Y=Bt,yt*=p,Bt*=p,re=yt,ue=o(Bt=Bt/2+s),j=c(Bt)}function ne(yt,Bt){yt*=p,Bt*=p,Bt=Bt/2+s;var cr=yt-re,sr=cr>=0?1:-1,Dr=sr*cr,tn=o(Bt),dn=c(Bt),Mn=j*dn,Ln=ue*tn+Mn*o(Dr),Nn=Mn*sr*c(Dr);G.add(d(Nn,Ln)),re=yt,ue=tn,j=dn}function X(yt){return K.reset(),N(yt,q),K*2}function Q(yt){return[d(yt[1],yt[0]),k(yt[2])]}function ie(yt){var Bt=yt[0],cr=yt[1],sr=o(cr);return[sr*o(Bt),sr*c(Bt),c(cr)]}function se(yt,Bt){return yt[0]*Bt[0]+yt[1]*Bt[1]+yt[2]*Bt[2]}function ae(yt,Bt){return[yt[1]*Bt[2]-yt[2]*Bt[1],yt[2]*Bt[0]-yt[0]*Bt[2],yt[0]*Bt[1]-yt[1]*Bt[0]]}function oe(yt,Bt){yt[0]+=Bt[0],yt[1]+=Bt[1],yt[2]+=Bt[2]}function be(yt,Bt){return[yt[0]*Bt,yt[1]*Bt,yt[2]*Bt]}function ce(yt){var Bt=u(yt[0]*yt[0]+yt[1]*yt[1]+yt[2]*yt[2]);yt[0]/=Bt,yt[1]/=Bt,yt[2]/=Bt}var de,ye,ge,me,Ee,Pe,Ue,we,ke=S(),Xe,Ve,Ie={point:De,lineStart:vt,lineEnd:Dt,polygonStart:function(){Ie.point=Kt,Ie.lineStart=Ft,Ie.lineEnd=Mt,ke.reset(),q.polygonStart()},polygonEnd:function(){q.polygonEnd(),Ie.point=De,Ie.lineStart=vt,Ie.lineEnd=Dt,G<0?(de=-(ge=180),ye=-(me=90)):ke>n?me=90:ke<-n&&(ye=-90),Ve[0]=de,Ve[1]=ge},sphere:function(){de=-(ge=180),ye=-(me=90)}};function De(yt,Bt){Xe.push(Ve=[de=yt,ge=yt]),Bt<ye&&(ye=Bt),Bt>me&&(me=Bt)}function Ye(yt,Bt){var cr=ie([yt*p,Bt*p]);if(we){var sr=ae(we,cr),Dr=[sr[1],-sr[0],0],tn=ae(Dr,sr);ce(tn),tn=Q(tn);var dn=yt-Ee,Mn=dn>0?1:-1,Ln=tn[0]*x*Mn,Nn,yn=v(dn)>180;yn^(Mn*Ee<Ln&&Ln<Mn*yt)?(Nn=tn[1]*x,Nn>me&&(me=Nn)):(Ln=(Ln+360)%360-180,yn^(Mn*Ee<Ln&&Ln<Mn*yt)?(Nn=-tn[1]*x,Nn<ye&&(ye=Nn)):(Bt<ye&&(ye=Bt),Bt>me&&(me=Bt))),yn?yt<Ee?Xt(de,yt)>Xt(de,ge)&&(ge=yt):Xt(yt,ge)>Xt(de,ge)&&(de=yt):ge>=de?(yt<de&&(de=yt),yt>ge&&(ge=yt)):yt>Ee?Xt(de,yt)>Xt(de,ge)&&(ge=yt):Xt(yt,ge)>Xt(de,ge)&&(de=yt)}else Xe.push(Ve=[de=yt,ge=yt]);Bt<ye&&(ye=Bt),Bt>me&&(me=Bt),we=cr,Ee=yt}function vt(){Ie.point=Ye}function Dt(){Ve[0]=de,Ve[1]=ge,Ie.point=De,we=null}function Kt(yt,Bt){if(we){var cr=yt-Ee;ke.add(v(cr)>180?cr+(cr>0?360:-360):cr)}else Pe=yt,Ue=Bt;q.point(yt,Bt),Ye(yt,Bt)}function Ft(){q.lineStart()}function Mt(){Kt(Pe,Ue),q.lineEnd(),v(ke)>n&&(de=-(ge=180)),Ve[0]=de,Ve[1]=ge,we=null}function Xt(yt,Bt){return(Bt-=yt)<0?Bt+360:Bt}function It(yt,Bt){return yt[0]-Bt[0]}function At(yt,Bt){return yt[0]<=yt[1]?yt[0]<=Bt&&Bt<=yt[1]:Bt<yt[0]||yt[1]<Bt}function Ge(yt){var Bt,cr,sr,Dr,tn,dn,Mn;if(me=ge=-(de=ye=1/0),Xe=[],N(yt,Ie),cr=Xe.length){for(Xe.sort(It),Bt=1,sr=Xe[0],tn=[sr];Bt<cr;++Bt)Dr=Xe[Bt],At(sr,Dr[0])||At(sr,Dr[1])?(Xt(sr[0],Dr[1])>Xt(sr[0],sr[1])&&(sr[1]=Dr[1]),Xt(Dr[0],sr[1])>Xt(sr[0],sr[1])&&(sr[0]=Dr[0])):tn.push(sr=Dr);for(dn=-1/0,cr=tn.length-1,Bt=0,sr=tn[cr];Bt<=cr;sr=Dr,++Bt)Dr=tn[Bt],(Mn=Xt(sr[1],Dr[0]))>dn&&(dn=Mn,de=Dr[0],ge=sr[1])}return Xe=Ve=null,de===1/0||ye===1/0?[[NaN,NaN],[NaN,NaN]]:[[de,ye],[ge,me]]}var tt,He,Ae,Ne,Ze,Qe,bt,dt,wt,Ut,Rt,Nt,Wt,Vt,ir,Hr,sn={sphere:z,point:jr,lineStart:$t,lineEnd:_r,polygonStart:function(){sn.lineStart=rt,sn.lineEnd=Je},polygonEnd:function(){sn.lineStart=$t,sn.lineEnd=_r}};function jr(yt,Bt){yt*=p,Bt*=p;var cr=o(Bt);at(cr*o(yt),cr*c(yt),c(Bt))}function at(yt,Bt,cr){++tt,Ae+=(yt-Ae)/tt,Ne+=(Bt-Ne)/tt,Ze+=(cr-Ze)/tt}function $t(){sn.point=Jt}function Jt(yt,Bt){yt*=p,Bt*=p;var cr=o(Bt);Vt=cr*o(yt),ir=cr*c(yt),Hr=c(Bt),sn.point=Gt,at(Vt,ir,Hr)}function Gt(yt,Bt){yt*=p,Bt*=p;var cr=o(Bt),sr=cr*o(yt),Dr=cr*c(yt),tn=c(Bt),dn=d(u((dn=ir*tn-Hr*Dr)*dn+(dn=Hr*sr-Vt*tn)*dn+(dn=Vt*Dr-ir*sr)*dn),Vt*sr+ir*Dr+Hr*tn);He+=dn,Qe+=dn*(Vt+(Vt=sr)),bt+=dn*(ir+(ir=Dr)),dt+=dn*(Hr+(Hr=tn)),at(Vt,ir,Hr)}function _r(){sn.point=jr}function rt(){sn.point=st}function Je(){lt(Nt,Wt),sn.point=jr}function st(yt,Bt){Nt=yt,Wt=Bt,yt*=p,Bt*=p,sn.point=lt;var cr=o(Bt);Vt=cr*o(yt),ir=cr*c(yt),Hr=c(Bt),at(Vt,ir,Hr)}function lt(yt,Bt){yt*=p,Bt*=p;var cr=o(Bt),sr=cr*o(yt),Dr=cr*c(yt),tn=c(Bt),dn=ir*tn-Hr*Dr,Mn=Hr*sr-Vt*tn,Ln=Vt*Dr-ir*sr,Nn=u(dn*dn+Mn*Mn+Ln*Ln),yn=k(Nn),zn=Nn&&-yn/Nn;wt+=zn*dn,Ut+=zn*Mn,Rt+=zn*Ln,He+=yn,Qe+=yn*(Vt+(Vt=sr)),bt+=yn*(ir+(ir=Dr)),dt+=yn*(Hr+(Hr=tn)),at(Vt,ir,Hr)}function Tt(yt){tt=He=Ae=Ne=Ze=Qe=bt=dt=wt=Ut=Rt=0,N(yt,sn);var Bt=wt,cr=Ut,sr=Rt,Dr=Bt*Bt+cr*cr+sr*sr;return Dr<r&&(Bt=Qe,cr=bt,sr=dt,He<n&&(Bt=Ae,cr=Ne,sr=Ze),Dr=Bt*Bt+cr*cr+sr*sr,Dr<r)?[NaN,NaN]:[d(cr,Bt)*x,k(sr/u(Dr))*x]}function zt(yt){return function(){return yt}}function Ce(yt,Bt){function cr(sr,Dr){return sr=yt(sr,Dr),Bt(sr[0],sr[1])}return yt.invert&&Bt.invert&&(cr.invert=function(sr,Dr){return sr=Bt.invert(sr,Dr),sr&&yt.invert(sr[0],sr[1])}),cr}function Se(yt,Bt){return[v(yt)>t?yt+Math.round(-yt/i)*i:yt,Bt]}Se.invert=Se;function nt(yt,Bt,cr){return(yt%=i)?Bt||cr?Ce(ct(yt),kt(Bt,cr)):ct(yt):Bt||cr?kt(Bt,cr):Se}function it(yt){return function(Bt,cr){return Bt+=yt,[Bt>t?Bt-i:Bt<-t?Bt+i:Bt,cr]}}function ct(yt){var Bt=it(yt);return Bt.invert=it(-yt),Bt}function kt(yt,Bt){var cr=o(yt),sr=c(yt),Dr=o(Bt),tn=c(Bt);function dn(Mn,Ln){var Nn=o(Ln),yn=o(Mn)*Nn,zn=c(Mn)*Nn,Pn=c(Ln),Hn=Pn*cr+yn*sr;return[d(zn*Dr-Hn*tn,yn*cr-Pn*sr),k(Hn*Dr+zn*tn)]}return dn.invert=function(Mn,Ln){var Nn=o(Ln),yn=o(Mn)*Nn,zn=c(Mn)*Nn,Pn=c(Ln),Hn=Pn*Dr-zn*tn;return[d(zn*Dr+Pn*tn,yn*cr+Hn*sr),k(Hn*cr-yn*sr)]},dn}function gt(yt){yt=nt(yt[0]*p,yt[1]*p,yt.length>2?yt[2]*p:0);function Bt(cr){return cr=yt(cr[0]*p,cr[1]*p),cr[0]*=x,cr[1]*=x,cr}return Bt.invert=function(cr){return cr=yt.invert(cr[0]*p,cr[1]*p),cr[0]*=x,cr[1]*=x,cr},Bt}function St(yt,Bt,cr,sr,Dr,tn){if(cr){var dn=o(Bt),Mn=c(Bt),Ln=sr*cr;Dr==null?(Dr=Bt+sr*i,tn=Bt-Ln/2):(Dr=Yt(dn,Dr),tn=Yt(dn,tn),(sr>0?Dr<tn:Dr>tn)&&(Dr+=sr*i));for(var Nn,yn=Dr;sr>0?yn>tn:yn<tn;yn-=Ln)Nn=Q([dn,-Mn*o(yn),-Mn*c(yn)]),yt.point(Nn[0],Nn[1])}}function Yt(yt,Bt){Bt=ie(Bt),Bt[0]-=yt,ce(Bt);var cr=T(-Bt[1]);return((-Bt[2]<0?-cr:cr)+i-n)%i}function ar(){var yt=zt([0,0]),Bt=zt(90),cr=zt(6),sr,Dr,tn={point:dn};function dn(Ln,Nn){sr.push(Ln=Dr(Ln,Nn)),Ln[0]*=x,Ln[1]*=x}function Mn(){var Ln=yt.apply(this,arguments),Nn=Bt.apply(this,arguments)*p,yn=cr.apply(this,arguments)*p;return sr=[],Dr=nt(-Ln[0]*p,-Ln[1]*p,0).invert,St(tn,Nn,yn,1),Ln={type:"Polygon",coordinates:[sr]},sr=Dr=null,Ln}return Mn.center=function(Ln){return arguments.length?(yt=typeof Ln=="function"?Ln:zt([+Ln[0],+Ln[1]]),Mn):yt},Mn.radius=function(Ln){return arguments.length?(Bt=typeof Ln=="function"?Ln:zt(+Ln),Mn):Bt},Mn.precision=function(Ln){return arguments.length?(cr=typeof Ln=="function"?Ln:zt(+Ln),Mn):cr},Mn}function kr(){var yt=[],Bt;return{point:function(cr,sr,Dr){Bt.push([cr,sr,Dr])},lineStart:function(){yt.push(Bt=[])},lineEnd:z,rejoin:function(){yt.length>1&&yt.push(yt.pop().concat(yt.shift()))},result:function(){var cr=yt;return yt=[],Bt=null,cr}}}function br(yt,Bt){return v(yt[0]-Bt[0])<n&&v(yt[1]-Bt[1])<n}function Mr(yt,Bt,cr,sr){this.x=yt,this.z=Bt,this.o=cr,this.e=sr,this.v=!1,this.n=this.p=null}function Yr(yt,Bt,cr,sr,Dr){var tn=[],dn=[],Mn,Ln;if(yt.forEach(function($n){if(!((za=$n.length-1)<=0)){var za,Ea=$n[0],Fa=$n[za],Oa;if(br(Ea,Fa)){if(!Ea[2]&&!Fa[2]){for(Dr.lineStart(),Mn=0;Mn<za;++Mn)Dr.point((Ea=$n[Mn])[0],Ea[1]);Dr.lineEnd();return}Fa[0]+=2*n}tn.push(Oa=new Mr(Ea,$n,null,!0)),dn.push(Oa.o=new Mr(Ea,null,Oa,!1)),tn.push(Oa=new Mr(Fa,$n,null,!1)),dn.push(Oa.o=new Mr(Fa,null,Oa,!0))}}),!!tn.length){for(dn.sort(Bt),nr(tn),nr(dn),Mn=0,Ln=dn.length;Mn<Ln;++Mn)dn[Mn].e=cr=!cr;for(var Nn=tn[0],yn,zn;;){for(var Pn=Nn,Hn=!0;Pn.v;)if((Pn=Pn.n)===Nn)return;yn=Pn.z,Dr.lineStart();do{if(Pn.v=Pn.o.v=!0,Pn.e){if(Hn)for(Mn=0,Ln=yn.length;Mn<Ln;++Mn)Dr.point((zn=yn[Mn])[0],zn[1]);else sr(Pn.x,Pn.n.x,1,Dr);Pn=Pn.n}else{if(Hn)for(yn=Pn.p.z,Mn=yn.length-1;Mn>=0;--Mn)Dr.point((zn=yn[Mn])[0],zn[1]);else sr(Pn.x,Pn.p.x,-1,Dr);Pn=Pn.p}Pn=Pn.o,yn=Pn.z,Hn=!Hn}while(!Pn.v);Dr.lineEnd()}}}function nr(yt){if(Bt=yt.length){for(var Bt,cr=0,sr=yt[0],Dr;++cr<Bt;)sr.n=Dr=yt[cr],Dr.p=sr,sr=Dr;sr.n=Dr=yt[0],Dr.p=sr}}var gr=S();function Rr(yt){return v(yt[0])<=t?yt[0]:b(yt[0])*((v(yt[0])+t)%i-t)}function Br(yt,Bt){var cr=Rr(Bt),sr=Bt[1],Dr=c(sr),tn=[c(cr),-o(cr),0],dn=0,Mn=0;gr.reset(),Dr===1?sr=h+n:Dr===-1&&(sr=-h-n);for(var Ln=0,Nn=yt.length;Ln<Nn;++Ln)if(zn=(yn=yt[Ln]).length)for(var yn,zn,Pn=yn[zn-1],Hn=Rr(Pn),$n=Pn[1]/2+s,za=c($n),Ea=o($n),Fa=0;Fa<zn;++Fa,Hn=Jn,za=Ga,Ea=Qa,Pn=Oa){var Oa=yn[Fa],Jn=Rr(Oa),ha=Oa[1]/2+s,Ga=c(ha),Qa=o(ha),di=Jn-Hn,gi=di>=0?1:-1,mi=gi*di,Ai=mi>t,oi=za*Ga;if(gr.add(d(oi*gi*c(mi),Ea*Qa+oi*o(mi))),dn+=Ai?di+gi*i:di,Ai^Hn>=cr^Jn>=cr){var mo=ae(ie(Pn),ie(Oa));ce(mo);var qi=ae(tn,mo);ce(qi);var Ja=(Ai^di>=0?-1:1)*k(qi[2]);(sr>Ja||sr===Ja&&(mo[0]||mo[1]))&&(Mn+=Ai^di>=0?1:-1)}}return(dn<-n||dn<n&&gr<-n)^Mn&1}function Sr(yt,Bt,cr,sr){return function(Dr){var tn=Bt(Dr),dn=kr(),Mn=Bt(dn),Ln=!1,Nn,yn,zn,Pn={point:Hn,lineStart:za,lineEnd:Ea,polygonStart:function(){Pn.point=Fa,Pn.lineStart=Oa,Pn.lineEnd=Jn,yn=[],Nn=[]},polygonEnd:function(){Pn.point=Hn,Pn.lineStart=za,Pn.lineEnd=Ea,yn=g.merge(yn);var ha=Br(Nn,sr);yn.length?(Ln||(Dr.polygonStart(),Ln=!0),Yr(yn,Lt,ha,cr,Dr)):ha&&(Ln||(Dr.polygonStart(),Ln=!0),Dr.lineStart(),cr(null,null,1,Dr),Dr.lineEnd()),Ln&&(Dr.polygonEnd(),Ln=!1),yn=Nn=null},sphere:function(){Dr.polygonStart(),Dr.lineStart(),cr(null,null,1,Dr),Dr.lineEnd(),Dr.polygonEnd()}};function Hn(ha,Ga){yt(ha,Ga)&&Dr.point(ha,Ga)}function $n(ha,Ga){tn.point(ha,Ga)}function za(){Pn.point=$n,tn.lineStart()}function Ea(){Pn.point=Hn,tn.lineEnd()}function Fa(ha,Ga){zn.push([ha,Ga]),Mn.point(ha,Ga)}function Oa(){Mn.lineStart(),zn=[]}function Jn(){Fa(zn[0][0],zn[0][1]),Mn.lineEnd();var ha=Mn.clean(),Ga=dn.result(),Qa,di=Ga.length,gi,mi,Ai;if(zn.pop(),Nn.push(zn),zn=null,!!di){if(ha&1){if(mi=Ga[0],(gi=mi.length-1)>0){for(Ln||(Dr.polygonStart(),Ln=!0),Dr.lineStart(),Qa=0;Qa<gi;++Qa)Dr.point((Ai=mi[Qa])[0],Ai[1]);Dr.lineEnd()}return}di>1&&ha&2&&Ga.push(Ga.pop().concat(Ga.shift())),yn.push(Ga.filter(et))}}return Pn}}function et(yt){return yt.length>1}function Lt(yt,Bt){return((yt=yt.x)[0]<0?yt[1]-h-n:h-yt[1])-((Bt=Bt.x)[0]<0?Bt[1]-h-n:h-Bt[1])}var Zt=Sr(function(){return!0},or,Or,[-t,-h]);function or(yt){var Bt=NaN,cr=NaN,sr=NaN,Dr;return{lineStart:function(){yt.lineStart(),Dr=1},point:function(tn,dn){var Mn=tn>0?t:-t,Ln=v(tn-Bt);v(Ln-t)<n?(yt.point(Bt,cr=(cr+dn)/2>0?h:-h),yt.point(sr,cr),yt.lineEnd(),yt.lineStart(),yt.point(Mn,cr),yt.point(tn,cr),Dr=0):sr!==Mn&&Ln>=t&&(v(Bt-sr)<n&&(Bt-=sr*n),v(tn-Mn)<n&&(tn-=Mn*n),cr=Ir(Bt,cr,tn,dn),yt.point(sr,cr),yt.lineEnd(),yt.lineStart(),yt.point(Mn,cr),Dr=0),yt.point(Bt=tn,cr=dn),sr=Mn},lineEnd:function(){yt.lineEnd(),Bt=cr=NaN},clean:function(){return 2-Dr}}}function Ir(yt,Bt,cr,sr){var Dr,tn,dn=c(yt-cr);return v(dn)>n?f((c(Bt)*(tn=o(sr))*c(cr)-c(sr)*(Dr=o(Bt))*c(yt))/(Dr*tn*dn)):(Bt+sr)/2}function Or(yt,Bt,cr,sr){var Dr;if(yt==null)Dr=cr*h,sr.point(-t,Dr),sr.point(0,Dr),sr.point(t,Dr),sr.point(t,0),sr.point(t,-Dr),sr.point(0,-Dr),sr.point(-t,-Dr),sr.point(-t,0),sr.point(-t,Dr);else if(v(yt[0]-Bt[0])>n){var tn=yt[0]<Bt[0]?t:-t;Dr=cr*tn/2,sr.point(-tn,Dr),sr.point(0,Dr),sr.point(tn,Dr)}else sr.point(Bt[0],Bt[1])}function Er(yt){var Bt=o(yt),cr=6*p,sr=Bt>0,Dr=v(Bt)>n;function tn(yn,zn,Pn,Hn){St(Hn,yt,cr,Pn,yn,zn)}function dn(yn,zn){return o(yn)*o(zn)>Bt}function Mn(yn){var zn,Pn,Hn,$n,za;return{lineStart:function(){$n=Hn=!1,za=1},point:function(Ea,Fa){var Oa=[Ea,Fa],Jn,ha=dn(Ea,Fa),Ga=sr?ha?0:Nn(Ea,Fa):ha?Nn(Ea+(Ea<0?t:-t),Fa):0;if(!zn&&($n=Hn=ha)&&yn.lineStart(),ha!==Hn&&(Jn=Ln(zn,Oa),(!Jn||br(zn,Jn)||br(Oa,Jn))&&(Oa[2]=1)),ha!==Hn)za=0,ha?(yn.lineStart(),Jn=Ln(Oa,zn),yn.point(Jn[0],Jn[1])):(Jn=Ln(zn,Oa),yn.point(Jn[0],Jn[1],2),yn.lineEnd()),zn=Jn;else if(Dr&&zn&&sr^ha){var Qa;!(Ga&Pn)&&(Qa=Ln(Oa,zn,!0))&&(za=0,sr?(yn.lineStart(),yn.point(Qa[0][0],Qa[0][1]),yn.point(Qa[1][0],Qa[1][1]),yn.lineEnd()):(yn.point(Qa[1][0],Qa[1][1]),yn.lineEnd(),yn.lineStart(),yn.point(Qa[0][0],Qa[0][1],3)))}ha&&(!zn||!br(zn,Oa))&&yn.point(Oa[0],Oa[1]),zn=Oa,Hn=ha,Pn=Ga},lineEnd:function(){Hn&&yn.lineEnd(),zn=null},clean:function(){return za|($n&&Hn)<<1}}}function Ln(yn,zn,Pn){var Hn=ie(yn),$n=ie(zn),za=[1,0,0],Ea=ae(Hn,$n),Fa=se(Ea,Ea),Oa=Ea[0],Jn=Fa-Oa*Oa;if(!Jn)return!Pn&&yn;var ha=Bt*Fa/Jn,Ga=-Bt*Oa/Jn,Qa=ae(za,Ea),di=be(za,ha),gi=be(Ea,Ga);oe(di,gi);var mi=Qa,Ai=se(di,mi),oi=se(mi,mi),mo=Ai*Ai-oi*(se(di,di)-1);if(!(mo<0)){var qi=u(mo),Ja=be(mi,(-Ai-qi)/oi);if(oe(Ja,di),Ja=Q(Ja),!Pn)return Ja;var va=yn[0],xi=zn[0],uo=yn[1],po=zn[1],ss;xi<va&&(ss=va,va=xi,xi=ss);var Ss=xi-va,zo=v(Ss-t)<n,Js=zo||Ss<n;if(!zo&&po<uo&&(ss=uo,uo=po,po=ss),Js?zo?uo+po>0^Ja[1]<(v(Ja[0]-va)<n?uo:po):uo<=Ja[1]&&Ja[1]<=po:Ss>t^(va<=Ja[0]&&Ja[0]<=xi)){var ys=be(mi,(-Ai+qi)/oi);return oe(ys,di),[Ja,Q(ys)]}}}function Nn(yn,zn){var Pn=sr?yt:t-yt,Hn=0;return yn<-Pn?Hn|=1:yn>Pn&&(Hn|=2),zn<-Pn?Hn|=4:zn>Pn&&(Hn|=8),Hn}return Sr(dn,Mn,tn,sr?[0,-yt]:[-t,yt-t])}function wr(yt,Bt,cr,sr,Dr,tn){var dn=yt[0],Mn=yt[1],Ln=Bt[0],Nn=Bt[1],yn=0,zn=1,Pn=Ln-dn,Hn=Nn-Mn,$n;if($n=cr-dn,!(!Pn&&$n>0)){if($n/=Pn,Pn<0){if($n<yn)return;$n<zn&&(zn=$n)}else if(Pn>0){if($n>zn)return;$n>yn&&(yn=$n)}if($n=Dr-dn,!(!Pn&&$n<0)){if($n/=Pn,Pn<0){if($n>zn)return;$n>yn&&(yn=$n)}else if(Pn>0){if($n<yn)return;$n<zn&&(zn=$n)}if($n=sr-Mn,!(!Hn&&$n>0)){if($n/=Hn,Hn<0){if($n<yn)return;$n<zn&&(zn=$n)}else if(Hn>0){if($n>zn)return;$n>yn&&(yn=$n)}if($n=tn-Mn,!(!Hn&&$n<0)){if($n/=Hn,Hn<0){if($n>zn)return;$n>yn&&(yn=$n)}else if(Hn>0){if($n<yn)return;$n<zn&&(zn=$n)}return yn>0&&(yt[0]=dn+yn*Pn,yt[1]=Mn+yn*Hn),zn<1&&(Bt[0]=dn+zn*Pn,Bt[1]=Mn+zn*Hn),!0}}}}}var Gr=1e9,wn=-Gr;function cn(yt,Bt,cr,sr){function Dr(Nn,yn){return yt<=Nn&&Nn<=cr&&Bt<=yn&&yn<=sr}function tn(Nn,yn,zn,Pn){var Hn=0,$n=0;if(Nn==null||(Hn=dn(Nn,zn))!==($n=dn(yn,zn))||Ln(Nn,yn)<0^zn>0)do Pn.point(Hn===0||Hn===3?yt:cr,Hn>1?sr:Bt);while((Hn=(Hn+zn+4)%4)!==$n);else Pn.point(yn[0],yn[1])}function dn(Nn,yn){return v(Nn[0]-yt)<n?yn>0?0:3:v(Nn[0]-cr)<n?yn>0?2:1:v(Nn[1]-Bt)<n?yn>0?1:0:yn>0?3:2}function Mn(Nn,yn){return Ln(Nn.x,yn.x)}function Ln(Nn,yn){var zn=dn(Nn,1),Pn=dn(yn,1);return zn!==Pn?zn-Pn:zn===0?yn[1]-Nn[1]:zn===1?Nn[0]-yn[0]:zn===2?Nn[1]-yn[1]:yn[0]-Nn[0]}return function(Nn){var yn=Nn,zn=kr(),Pn,Hn,$n,za,Ea,Fa,Oa,Jn,ha,Ga,Qa,di={point:gi,lineStart:mo,lineEnd:qi,polygonStart:Ai,polygonEnd:oi};function gi(va,xi){Dr(va,xi)&&yn.point(va,xi)}function mi(){for(var va=0,xi=0,uo=Hn.length;xi<uo;++xi)for(var po=Hn[xi],ss=1,Ss=po.length,zo=po[0],Js,ys,ls=zo[0],xo=zo[1];ss<Ss;++ss)Js=ls,ys=xo,zo=po[ss],ls=zo[0],xo=zo[1],ys<=sr?xo>sr&&(ls-Js)*(sr-ys)>(xo-ys)*(yt-Js)&&++va:xo<=sr&&(ls-Js)*(sr-ys)<(xo-ys)*(yt-Js)&&--va;return va}function Ai(){yn=zn,Pn=[],Hn=[],Qa=!0}function oi(){var va=mi(),xi=Qa&&va,uo=(Pn=g.merge(Pn)).length;(xi||uo)&&(Nn.polygonStart(),xi&&(Nn.lineStart(),tn(null,null,1,Nn),Nn.lineEnd()),uo&&Yr(Pn,Mn,va,tn,Nn),Nn.polygonEnd()),yn=Nn,Pn=Hn=$n=null}function mo(){di.point=Ja,Hn&&Hn.push($n=[]),Ga=!0,ha=!1,Oa=Jn=NaN}function qi(){Pn&&(Ja(za,Ea),Fa&&ha&&zn.rejoin(),Pn.push(zn.result())),di.point=gi,ha&&yn.lineEnd()}function Ja(va,xi){var uo=Dr(va,xi);if(Hn&&$n.push([va,xi]),Ga)za=va,Ea=xi,Fa=uo,Ga=!1,uo&&(yn.lineStart(),yn.point(va,xi));else if(uo&&ha)yn.point(va,xi);else{var po=[Oa=Math.max(wn,Math.min(Gr,Oa)),Jn=Math.max(wn,Math.min(Gr,Jn))],ss=[va=Math.max(wn,Math.min(Gr,va)),xi=Math.max(wn,Math.min(Gr,xi))];wr(po,ss,yt,Bt,cr,sr)?(ha||(yn.lineStart(),yn.point(po[0],po[1])),yn.point(ss[0],ss[1]),uo||yn.lineEnd(),Qa=!1):uo&&(yn.lineStart(),yn.point(va,xi),Qa=!1)}Oa=va,Jn=xi,ha=uo}return di}}function Bn(){var yt=0,Bt=0,cr=960,sr=500,Dr,tn,dn;return dn={stream:function(Mn){return Dr&&tn===Mn?Dr:Dr=cn(yt,Bt,cr,sr)(tn=Mn)},extent:function(Mn){return arguments.length?(yt=+Mn[0][0],Bt=+Mn[0][1],cr=+Mn[1][0],sr=+Mn[1][1],Dr=tn=null,dn):[[yt,Bt],[cr,sr]]}}}var En=S(),Yn,Vn,pa,Ma={sphere:z,point:z,lineStart:ci,lineEnd:z,polygonStart:z,polygonEnd:z};function ci(){Ma.point=ja,Ma.lineEnd=Va}function Va(){Ma.point=Ma.lineEnd=z}function ja(yt,Bt){yt*=p,Bt*=p,Yn=yt,Vn=c(Bt),pa=o(Bt),Ma.point=Wa}function Wa(yt,Bt){yt*=p,Bt*=p;var cr=c(Bt),sr=o(Bt),Dr=v(yt-Yn),tn=o(Dr),dn=c(Dr),Mn=sr*dn,Ln=pa*cr-Vn*sr*tn,Nn=Vn*cr+pa*sr*tn;En.add(d(u(Mn*Mn+Ln*Ln),Nn)),Yn=yt,Vn=cr,pa=sr}function Tr(yt){return En.reset(),N(yt,Ma),+En}var pn=[null,null],fn={type:"LineString",coordinates:pn};function An(yt,Bt){return pn[0]=yt,pn[1]=Bt,Tr(fn)}var Zn={Feature:function(yt,Bt){return ea(yt.geometry,Bt)},FeatureCollection:function(yt,Bt){for(var cr=yt.features,sr=-1,Dr=cr.length;++sr<Dr;)if(ea(cr[sr].geometry,Bt))return!0;return!1}},ua={Sphere:function(){return!0},Point:function(yt,Bt){return Rn(yt.coordinates,Bt)},MultiPoint:function(yt,Bt){for(var cr=yt.coordinates,sr=-1,Dr=cr.length;++sr<Dr;)if(Rn(cr[sr],Bt))return!0;return!1},LineString:function(yt,Bt){return Xn(yt.coordinates,Bt)},MultiLineString:function(yt,Bt){for(var cr=yt.coordinates,sr=-1,Dr=cr.length;++sr<Dr;)if(Xn(cr[sr],Bt))return!0;return!1},Polygon:function(yt,Bt){return Ua(yt.coordinates,Bt)},MultiPolygon:function(yt,Bt){for(var cr=yt.coordinates,sr=-1,Dr=cr.length;++sr<Dr;)if(Ua(cr[sr],Bt))return!0;return!1},GeometryCollection:function(yt,Bt){for(var cr=yt.geometries,sr=-1,Dr=cr.length;++sr<Dr;)if(ea(cr[sr],Bt))return!0;return!1}};function ea(yt,Bt){return yt&&ua.hasOwnProperty(yt.type)?ua[yt.type](yt,Bt):!1}function Rn(yt,Bt){return An(yt,Bt)===0}function Xn(yt,Bt){for(var cr,sr,Dr,tn=0,dn=yt.length;tn<dn;tn++){if(sr=An(yt[tn],Bt),sr===0||tn>0&&(Dr=An(yt[tn],yt[tn-1]),Dr>0&&cr<=Dr&&sr<=Dr&&(cr+sr-Dr)*(1-Math.pow((cr-sr)/Dr,2))<r*Dr))return!0;cr=sr}return!1}function Ua(yt,Bt){return!!Br(yt.map(li),Ht(Bt))}function li(yt){return yt=yt.map(Ht),yt.pop(),yt}function Ht(yt){return[yt[0]*p,yt[1]*p]}function hr(yt,Bt){return(yt&&Zn.hasOwnProperty(yt.type)?Zn[yt.type]:ea)(yt,Bt)}function rn(yt,Bt,cr){var sr=g.range(yt,Bt-n,cr).concat(Bt);return function(Dr){return sr.map(function(tn){return[Dr,tn]})}}function vn(yt,Bt,cr){var sr=g.range(yt,Bt-n,cr).concat(Bt);return function(Dr){return sr.map(function(tn){return[tn,Dr]})}}function en(){var yt,Bt,cr,sr,Dr,tn,dn,Mn,Ln=10,Nn=Ln,yn=90,zn=360,Pn,Hn,$n,za,Ea=2.5;function Fa(){return{type:"MultiLineString",coordinates:Oa()}}function Oa(){return g.range(m(sr/yn)*yn,cr,yn).map($n).concat(g.range(m(Mn/zn)*zn,dn,zn).map(za)).concat(g.range(m(Bt/Ln)*Ln,yt,Ln).filter(function(Jn){return v(Jn%yn)>n}).map(Pn)).concat(g.range(m(tn/Nn)*Nn,Dr,Nn).filter(function(Jn){return v(Jn%zn)>n}).map(Hn))}return Fa.lines=function(){return Oa().map(function(Jn){return{type:"LineString",coordinates:Jn}})},Fa.outline=function(){return{type:"Polygon",coordinates:[$n(sr).concat(za(dn).slice(1),$n(cr).reverse().slice(1),za(Mn).reverse().slice(1))]}},Fa.extent=function(Jn){return arguments.length?Fa.extentMajor(Jn).extentMinor(Jn):Fa.extentMinor()},Fa.extentMajor=function(Jn){return arguments.length?(sr=+Jn[0][0],cr=+Jn[1][0],Mn=+Jn[0][1],dn=+Jn[1][1],sr>cr&&(Jn=sr,sr=cr,cr=Jn),Mn>dn&&(Jn=Mn,Mn=dn,dn=Jn),Fa.precision(Ea)):[[sr,Mn],[cr,dn]]},Fa.extentMinor=function(Jn){return arguments.length?(Bt=+Jn[0][0],yt=+Jn[1][0],tn=+Jn[0][1],Dr=+Jn[1][1],Bt>yt&&(Jn=Bt,Bt=yt,yt=Jn),tn>Dr&&(Jn=tn,tn=Dr,Dr=Jn),Fa.precision(Ea)):[[Bt,tn],[yt,Dr]]},Fa.step=function(Jn){return arguments.length?Fa.stepMajor(Jn).stepMinor(Jn):Fa.stepMinor()},Fa.stepMajor=function(Jn){return arguments.length?(yn=+Jn[0],zn=+Jn[1],Fa):[yn,zn]},Fa.stepMinor=function(Jn){return arguments.length?(Ln=+Jn[0],Nn=+Jn[1],Fa):[Ln,Nn]},Fa.precision=function(Jn){return arguments.length?(Ea=+Jn,Pn=rn(tn,Dr,90),Hn=vn(Bt,yt,Ea),$n=rn(Mn,dn,90),za=vn(sr,cr,Ea),Fa):Ea},Fa.extentMajor([[-180,-90+n],[180,90-n]]).extentMinor([[-180,-80-n],[180,80+n]])}function Tn(){return en()()}function xn(yt,Bt){var cr=yt[0]*p,sr=yt[1]*p,Dr=Bt[0]*p,tn=Bt[1]*p,dn=o(sr),Mn=c(sr),Ln=o(tn),Nn=c(tn),yn=dn*o(cr),zn=dn*c(cr),Pn=Ln*o(Dr),Hn=Ln*c(Dr),$n=2*k(u(P(tn-sr)+dn*Ln*P(Dr-cr))),za=c($n),Ea=$n?function(Fa){var Oa=c(Fa*=$n)/za,Jn=c($n-Fa)/za,ha=Jn*yn+Oa*Pn,Ga=Jn*zn+Oa*Hn,Qa=Jn*Mn+Oa*Nn;return[d(Ga,ha)*x,d(Qa,u(ha*ha+Ga*Ga))*x]}:function(){return[cr*x,sr*x]};return Ea.distance=$n,Ea}function un(yt){return yt}var yr=S(),mr=S(),zr,gn,On,ta,_n={point:z,lineStart:z,lineEnd:z,polygonStart:function(){_n.lineStart=jn,_n.lineEnd=ma},polygonEnd:function(){_n.lineStart=_n.lineEnd=_n.point=z,yr.add(v(mr)),mr.reset()},result:function(){var yt=yr/2;return yr.reset(),yt}};function jn(){_n.point=aa}function aa(yt,Bt){_n.point=da,zr=On=yt,gn=ta=Bt}function da(yt,Bt){mr.add(ta*yt-On*Bt),On=yt,ta=Bt}function ma(){da(zr,gn)}var sa=1/0,Aa=sa,vo=-sa,Io=vo,jo={point:nl,lineStart:z,lineEnd:z,polygonStart:z,polygonEnd:z,result:function(){var yt=[[sa,Aa],[vo,Io]];return vo=Io=-(Aa=sa=1/0),yt}};function nl(yt,Bt){yt<sa&&(sa=yt),yt>vo&&(vo=yt),Bt<Aa&&(Aa=Bt),Bt>Io&&(Io=Bt)}var pl=0,Yl=0,vi=0,Vs=0,Ds=0,Ui=0,Mo=0,dl=0,vs=0,Di,al,Ki,Fi,ao={point:Ji,lineStart:ts,lineEnd:Ko,polygonStart:function(){ao.lineStart=iu,ao.lineEnd=Rs},polygonEnd:function(){ao.point=Ji,ao.lineStart=ts,ao.lineEnd=Ko},result:function(){var yt=vs?[Mo/vs,dl/vs]:Ui?[Vs/Ui,Ds/Ui]:vi?[pl/vi,Yl/vi]:[NaN,NaN];return pl=Yl=vi=Vs=Ds=Ui=Mo=dl=vs=0,yt}};function Ji(yt,Bt){pl+=yt,Yl+=Bt,++vi}function ts(){ao.point=Gs}function Gs(yt,Bt){ao.point=au,Ji(Ki=yt,Fi=Bt)}function au(yt,Bt){var cr=yt-Ki,sr=Bt-Fi,Dr=u(cr*cr+sr*sr);Vs+=Dr*(Ki+yt)/2,Ds+=Dr*(Fi+Bt)/2,Ui+=Dr,Ji(Ki=yt,Fi=Bt)}function Ko(){ao.point=Ji}function iu(){ao.point=So}function Rs(){Mu(Di,al)}function So(yt,Bt){ao.point=Mu,Ji(Di=Ki=yt,al=Fi=Bt)}function Mu(yt,Bt){var cr=yt-Ki,sr=Bt-Fi,Dr=u(cr*cr+sr*sr);Vs+=Dr*(Ki+yt)/2,Ds+=Dr*(Fi+Bt)/2,Ui+=Dr,Dr=Fi*yt-Ki*Bt,Mo+=Dr*(Ki+yt),dl+=Dr*(Fi+Bt),vs+=Dr*3,Ji(Ki=yt,Fi=Bt)}function Is(yt){this._context=yt}Is.prototype={_radius:4.5,pointRadius:function(yt){return this._radius=yt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(yt,Bt){switch(this._point){case 0:{this._context.moveTo(yt,Bt),this._point=1;break}case 1:{this._context.lineTo(yt,Bt);break}default:{this._context.moveTo(yt+this._radius,Bt),this._context.arc(yt,Bt,this._radius,0,i);break}}},result:z};var _s=S(),Ll,Su,ku,Ys,Pl,ws={point:z,lineStart:function(){ws.point=Wl},lineEnd:function(){Ll&&il(Su,ku),ws.point=z},polygonStart:function(){Ll=!0},polygonEnd:function(){Ll=null},result:function(){var yt=+_s;return _s.reset(),yt}};function Wl(yt,Bt){ws.point=il,Su=Ys=yt,ku=Pl=Bt}function il(yt,Bt){Ys-=yt,Pl-=Bt,_s.add(u(Ys*Ys+Pl*Pl)),Ys=yt,Pl=Bt}function Xl(){this._string=[]}Xl.prototype={_radius:4.5,_circle:ou(4.5),pointRadius:function(yt){return(yt=+yt)!==this._radius&&(this._radius=yt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(yt,Bt){switch(this._point){case 0:{this._string.push("M",yt,",",Bt),this._point=1;break}case 1:{this._string.push("L",yt,",",Bt);break}default:{this._circle==null&&(this._circle=ou(this._radius)),this._string.push("M",yt,",",Bt,this._circle);break}}},result:function(){if(this._string.length){var yt=this._string.join("");return this._string=[],yt}else return null}};function ou(yt){return"m0,"+yt+"a"+yt+","+yt+" 0 1,1 0,"+-2*yt+"a"+yt+","+yt+" 0 1,1 0,"+2*yt+"z"}function Dl(yt,Bt){var cr=4.5,sr,Dr;function tn(dn){return dn&&(typeof cr=="function"&&Dr.pointRadius(+cr.apply(this,arguments)),N(dn,sr(Dr))),Dr.result()}return tn.area=function(dn){return N(dn,sr(_n)),_n.result()},tn.measure=function(dn){return N(dn,sr(ws)),ws.result()},tn.bounds=function(dn){return N(dn,sr(jo)),jo.result()},tn.centroid=function(dn){return N(dn,sr(ao)),ao.result()},tn.projection=function(dn){return arguments.length?(sr=dn==null?(yt=null,un):(yt=dn).stream,tn):yt},tn.context=function(dn){return arguments.length?(Dr=dn==null?(Bt=null,new Xl):new Is(Bt=dn),typeof cr!="function"&&Dr.pointRadius(cr),tn):Bt},tn.pointRadius=function(dn){return arguments.length?(cr=typeof dn=="function"?dn:(Dr.pointRadius(+dn),+dn),tn):cr},tn.projection(yt).context(Bt)}function Eu(yt){return{stream:Ws(yt)}}function Ws(yt){return function(Bt){var cr=new Zl;for(var sr in yt)cr[sr]=yt[sr];return cr.stream=Bt,cr}}function Zl(){}Zl.prototype={constructor:Zl,point:function(yt,Bt){this.stream.point(yt,Bt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Rl(yt,Bt,cr){var sr=yt.clipExtent&&yt.clipExtent();return yt.scale(150).translate([0,0]),sr!=null&&yt.clipExtent(null),N(cr,yt.stream(jo)),Bt(jo.result()),sr!=null&&yt.clipExtent(sr),yt}function ps(yt,Bt,cr){return Rl(yt,function(sr){var Dr=Bt[1][0]-Bt[0][0],tn=Bt[1][1]-Bt[0][1],dn=Math.min(Dr/(sr[1][0]-sr[0][0]),tn/(sr[1][1]-sr[0][1])),Mn=+Bt[0][0]+(Dr-dn*(sr[1][0]+sr[0][0]))/2,Ln=+Bt[0][1]+(tn-dn*(sr[1][1]+sr[0][1]))/2;yt.scale(150*dn).translate([Mn,Ln])},cr)}function yl(yt,Bt,cr){return ps(yt,[[0,0],Bt],cr)}function jl(yt,Bt,cr){return Rl(yt,function(sr){var Dr=+Bt,tn=Dr/(sr[1][0]-sr[0][0]),dn=(Dr-tn*(sr[1][0]+sr[0][0]))/2,Mn=-tn*sr[0][1];yt.scale(150*tn).translate([dn,Mn])},cr)}function su(yt,Bt,cr){return Rl(yt,function(sr){var Dr=+Bt,tn=Dr/(sr[1][1]-sr[0][1]),dn=-tn*sr[0][0],Mn=(Dr-tn*(sr[1][1]+sr[0][1]))/2;yt.scale(150*tn).translate([dn,Mn])},cr)}var lu=16,Il=o(30*p);function Cu(yt,Bt){return+Bt?Jo(yt,Bt):uu(yt)}function uu(yt){return Ws({point:function(Bt,cr){Bt=yt(Bt,cr),this.stream.point(Bt[0],Bt[1])}})}function Jo(yt,Bt){function cr(sr,Dr,tn,dn,Mn,Ln,Nn,yn,zn,Pn,Hn,$n,za,Ea){var Fa=Nn-sr,Oa=yn-Dr,Jn=Fa*Fa+Oa*Oa;if(Jn>4*Bt&&za--){var ha=dn+Pn,Ga=Mn+Hn,Qa=Ln+$n,di=u(ha*ha+Ga*Ga+Qa*Qa),gi=k(Qa/=di),mi=v(v(Qa)-1)<n||v(tn-zn)<n?(tn+zn)/2:d(Ga,ha),Ai=yt(mi,gi),oi=Ai[0],mo=Ai[1],qi=oi-sr,Ja=mo-Dr,va=Oa*qi-Fa*Ja;(va*va/Jn>Bt||v((Fa*qi+Oa*Ja)/Jn-.5)>.3||dn*Pn+Mn*Hn+Ln*$n<Il)&&(cr(sr,Dr,tn,dn,Mn,Ln,oi,mo,mi,ha/=di,Ga/=di,Qa,za,Ea),Ea.point(oi,mo),cr(oi,mo,mi,ha,Ga,Qa,Nn,yn,zn,Pn,Hn,$n,za,Ea))}}return function(sr){var Dr,tn,dn,Mn,Ln,Nn,yn,zn,Pn,Hn,$n,za,Ea={point:Fa,lineStart:Oa,lineEnd:ha,polygonStart:function(){sr.polygonStart(),Ea.lineStart=Ga},polygonEnd:function(){sr.polygonEnd(),Ea.lineStart=Oa}};function Fa(gi,mi){gi=yt(gi,mi),sr.point(gi[0],gi[1])}function Oa(){zn=NaN,Ea.point=Jn,sr.lineStart()}function Jn(gi,mi){var Ai=ie([gi,mi]),oi=yt(gi,mi);cr(zn,Pn,yn,Hn,$n,za,zn=oi[0],Pn=oi[1],yn=gi,Hn=Ai[0],$n=Ai[1],za=Ai[2],lu,sr),sr.point(zn,Pn)}function ha(){Ea.point=Fa,sr.lineEnd()}function Ga(){Oa(),Ea.point=Qa,Ea.lineEnd=di}function Qa(gi,mi){Jn(Dr=gi,mi),tn=zn,dn=Pn,Mn=Hn,Ln=$n,Nn=za,Ea.point=Jn}function di(){cr(zn,Pn,yn,Hn,$n,za,tn,dn,Dr,Mn,Ln,Nn,lu,sr),Ea.lineEnd=ha,ha()}return Ea}}var ol=Ws({point:function(yt,Bt){this.stream.point(yt*p,Bt*p)}});function sl(yt){return Ws({point:function(Bt,cr){var sr=yt(Bt,cr);return this.stream.point(sr[0],sr[1])}})}function Kl(yt,Bt,cr,sr,Dr){function tn(dn,Mn){return dn*=sr,Mn*=Dr,[Bt+yt*dn,cr-yt*Mn]}return tn.invert=function(dn,Mn){return[(dn-Bt)/yt*sr,(cr-Mn)/yt*Dr]},tn}function ds(yt,Bt,cr,sr,Dr,tn){var dn=o(tn),Mn=c(tn),Ln=dn*yt,Nn=Mn*yt,yn=dn/yt,zn=Mn/yt,Pn=(Mn*cr-dn*Bt)/yt,Hn=(Mn*Bt+dn*cr)/yt;function $n(za,Ea){return za*=sr,Ea*=Dr,[Ln*za-Nn*Ea+Bt,cr-Nn*za-Ln*Ea]}return $n.invert=function(za,Ea){return[sr*(yn*za-zn*Ea+Pn),Dr*(Hn-zn*za-yn*Ea)]},$n}function ko(yt){return zl(function(){return yt})()}function zl(yt){var Bt,cr=150,sr=480,Dr=250,tn=0,dn=0,Mn=0,Ln=0,Nn=0,yn,zn=0,Pn=1,Hn=1,$n=null,za=Zt,Ea=null,Fa,Oa,Jn,ha=un,Ga=.5,Qa,di,gi,mi,Ai;function oi(va){return gi(va[0]*p,va[1]*p)}function mo(va){return va=gi.invert(va[0],va[1]),va&&[va[0]*x,va[1]*x]}oi.stream=function(va){return mi&&Ai===va?mi:mi=ol(sl(yn)(za(Qa(ha(Ai=va)))))},oi.preclip=function(va){return arguments.length?(za=va,$n=void 0,Ja()):za},oi.postclip=function(va){return arguments.length?(ha=va,Ea=Fa=Oa=Jn=null,Ja()):ha},oi.clipAngle=function(va){return arguments.length?(za=+va?Er($n=va*p):($n=null,Zt),Ja()):$n*x},oi.clipExtent=function(va){return arguments.length?(ha=va==null?(Ea=Fa=Oa=Jn=null,un):cn(Ea=+va[0][0],Fa=+va[0][1],Oa=+va[1][0],Jn=+va[1][1]),Ja()):Ea==null?null:[[Ea,Fa],[Oa,Jn]]},oi.scale=function(va){return arguments.length?(cr=+va,qi()):cr},oi.translate=function(va){return arguments.length?(sr=+va[0],Dr=+va[1],qi()):[sr,Dr]},oi.center=function(va){return arguments.length?(tn=va[0]%360*p,dn=va[1]%360*p,qi()):[tn*x,dn*x]},oi.rotate=function(va){return arguments.length?(Mn=va[0]%360*p,Ln=va[1]%360*p,Nn=va.length>2?va[2]%360*p:0,qi()):[Mn*x,Ln*x,Nn*x]},oi.angle=function(va){return arguments.length?(zn=va%360*p,qi()):zn*x},oi.reflectX=function(va){return arguments.length?(Pn=va?-1:1,qi()):Pn<0},oi.reflectY=function(va){return arguments.length?(Hn=va?-1:1,qi()):Hn<0},oi.precision=function(va){return arguments.length?(Qa=Cu(di,Ga=va*va),Ja()):u(Ga)},oi.fitExtent=function(va,xi){return ps(oi,va,xi)},oi.fitSize=function(va,xi){return yl(oi,va,xi)},oi.fitWidth=function(va,xi){return jl(oi,va,xi)},oi.fitHeight=function(va,xi){return su(oi,va,xi)};function qi(){var va=ds(cr,0,0,Pn,Hn,zn).apply(null,Bt(tn,dn)),xi=(zn?ds:Kl)(cr,sr-va[0],Dr-va[1],Pn,Hn,zn);return yn=nt(Mn,Ln,Nn),di=Ce(Bt,xi),gi=Ce(yn,di),Qa=Cu(di,Ga),Ja()}function Ja(){return mi=Ai=null,oi}return function(){return Bt=yt.apply(this,arguments),oi.invert=Bt.invert&&mo,qi()}}function Ts(yt){var Bt=0,cr=t/3,sr=zl(yt),Dr=sr(Bt,cr);return Dr.parallels=function(tn){return arguments.length?sr(Bt=tn[0]*p,cr=tn[1]*p):[Bt*x,cr*x]},Dr}function As(yt){var Bt=o(yt);function cr(sr,Dr){return[sr*Bt,c(Dr)/Bt]}return cr.invert=function(sr,Dr){return[sr/Bt,k(Dr*Bt)]},cr}function so(yt,Bt){var cr=c(yt),sr=(cr+c(Bt))/2;if(v(sr)<n)return As(yt);var Dr=1+cr*(2*sr-cr),tn=u(Dr)/sr;function dn(Mn,Ln){var Nn=u(Dr-2*sr*c(Ln))/sr;return[Nn*c(Mn*=sr),tn-Nn*o(Mn)]}return dn.invert=function(Mn,Ln){var Nn=tn-Ln,yn=d(Mn,v(Nn))*b(Nn);return Nn*sr<0&&(yn-=t*b(Mn)*b(Nn)),[yn/sr,k((Dr-(Mn*Mn+Nn*Nn)*sr*sr)/(2*sr))]},dn}function ml(){return Ts(so).scale(155.424).center([0,33.6442])}function xl(){return ml().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Xs(yt){var Bt=yt.length;return{point:function(cr,sr){for(var Dr=-1;++Dr<Bt;)yt[Dr].point(cr,sr)},sphere:function(){for(var cr=-1;++cr<Bt;)yt[cr].sphere()},lineStart:function(){for(var cr=-1;++cr<Bt;)yt[cr].lineStart()},lineEnd:function(){for(var cr=-1;++cr<Bt;)yt[cr].lineEnd()},polygonStart:function(){for(var cr=-1;++cr<Bt;)yt[cr].polygonStart()},polygonEnd:function(){for(var cr=-1;++cr<Bt;)yt[cr].polygonEnd()}}}function gs(){var yt,Bt,cr=xl(),sr,Dr=ml().rotate([154,0]).center([-2,58.5]).parallels([55,65]),tn,dn=ml().rotate([157,0]).center([-3,19.9]).parallels([8,18]),Mn,Ln,Nn={point:function(Pn,Hn){Ln=[Pn,Hn]}};function yn(Pn){var Hn=Pn[0],$n=Pn[1];return Ln=null,sr.point(Hn,$n),Ln||(tn.point(Hn,$n),Ln)||(Mn.point(Hn,$n),Ln)}yn.invert=function(Pn){var Hn=cr.scale(),$n=cr.translate(),za=(Pn[0]-$n[0])/Hn,Ea=(Pn[1]-$n[1])/Hn;return(Ea>=.12&&Ea<.234&&za>=-.425&&za<-.214?Dr:Ea>=.166&&Ea<.234&&za>=-.214&&za<-.115?dn:cr).invert(Pn)},yn.stream=function(Pn){return yt&&Bt===Pn?yt:yt=Xs([cr.stream(Bt=Pn),Dr.stream(Pn),dn.stream(Pn)])},yn.precision=function(Pn){return arguments.length?(cr.precision(Pn),Dr.precision(Pn),dn.precision(Pn),zn()):cr.precision()},yn.scale=function(Pn){return arguments.length?(cr.scale(Pn),Dr.scale(Pn*.35),dn.scale(Pn),yn.translate(cr.translate())):cr.scale()},yn.translate=function(Pn){if(!arguments.length)return cr.translate();var Hn=cr.scale(),$n=+Pn[0],za=+Pn[1];return sr=cr.translate(Pn).clipExtent([[$n-.455*Hn,za-.238*Hn],[$n+.455*Hn,za+.238*Hn]]).stream(Nn),tn=Dr.translate([$n-.307*Hn,za+.201*Hn]).clipExtent([[$n-.425*Hn+n,za+.12*Hn+n],[$n-.214*Hn-n,za+.234*Hn-n]]).stream(Nn),Mn=dn.translate([$n-.205*Hn,za+.212*Hn]).clipExtent([[$n-.214*Hn+n,za+.166*Hn+n],[$n-.115*Hn-n,za+.234*Hn-n]]).stream(Nn),zn()},yn.fitExtent=function(Pn,Hn){return ps(yn,Pn,Hn)},yn.fitSize=function(Pn,Hn){return yl(yn,Pn,Hn)},yn.fitWidth=function(Pn,Hn){return jl(yn,Pn,Hn)},yn.fitHeight=function(Pn,Hn){return su(yn,Pn,Hn)};function zn(){return yt=Bt=null,yn}return yn.scale(1070)}function bl(yt){return function(Bt,cr){var sr=o(Bt),Dr=o(cr),tn=yt(sr*Dr);return[tn*Dr*c(Bt),tn*c(cr)]}}function ll(yt){return function(Bt,cr){var sr=u(Bt*Bt+cr*cr),Dr=yt(sr),tn=c(Dr),dn=o(Dr);return[d(Bt*tn,sr*dn),k(sr&&cr*tn/sr)]}}var Fl=bl(function(yt){return u(2/(1+yt))});Fl.invert=ll(function(yt){return 2*k(yt/2)});function _l(){return ko(Fl).scale(124.75).clipAngle(180-.001)}var Zs=bl(function(yt){return(yt=T(yt))&&yt/c(yt)});Zs.invert=ll(function(yt){return yt});function Lu(){return ko(Zs).scale(79.4188).clipAngle(180-.001)}function rs(yt,Bt){return[yt,w(L((h+Bt)/2))]}rs.invert=function(yt,Bt){return[yt,2*f(l(Bt))-h]};function Yu(){return Jl(rs).scale(961/i)}function Jl(yt){var Bt=ko(yt),cr=Bt.center,sr=Bt.scale,Dr=Bt.translate,tn=Bt.clipExtent,dn=null,Mn,Ln,Nn;Bt.scale=function(zn){return arguments.length?(sr(zn),yn()):sr()},Bt.translate=function(zn){return arguments.length?(Dr(zn),yn()):Dr()},Bt.center=function(zn){return arguments.length?(cr(zn),yn()):cr()},Bt.clipExtent=function(zn){return arguments.length?(zn==null?dn=Mn=Ln=Nn=null:(dn=+zn[0][0],Mn=+zn[0][1],Ln=+zn[1][0],Nn=+zn[1][1]),yn()):dn==null?null:[[dn,Mn],[Ln,Nn]]};function yn(){var zn=t*sr(),Pn=Bt(gt(Bt.rotate()).invert([0,0]));return tn(dn==null?[[Pn[0]-zn,Pn[1]-zn],[Pn[0]+zn,Pn[1]+zn]]:yt===rs?[[Math.max(Pn[0]-zn,dn),Mn],[Math.min(Pn[0]+zn,Ln),Nn]]:[[dn,Math.max(Pn[1]-zn,Mn)],[Ln,Math.min(Pn[1]+zn,Nn)]])}return yn()}function ul(yt){return L((h+yt)/2)}function wl(yt,Bt){var cr=o(yt),sr=yt===Bt?c(yt):w(cr/o(Bt))/w(ul(Bt)/ul(yt)),Dr=cr*_(ul(yt),sr)/sr;if(!sr)return rs;function tn(dn,Mn){Dr>0?Mn<-h+n&&(Mn=-h+n):Mn>h-n&&(Mn=h-n);var Ln=Dr/_(ul(Mn),sr);return[Ln*c(sr*dn),Dr-Ln*o(sr*dn)]}return tn.invert=function(dn,Mn){var Ln=Dr-Mn,Nn=b(sr)*u(dn*dn+Ln*Ln),yn=d(dn,v(Ln))*b(Ln);return Ln*sr<0&&(yn-=t*b(dn)*b(Ln)),[yn/sr,2*f(_(Dr/Nn,1/sr))-h]},tn}function js(){return Ts(wl).scale(109.5).parallels([30,30])}function Tl(yt,Bt){return[yt,Bt]}Tl.invert=Tl;function fu(){return ko(Tl).scale(152.63)}function cu(yt,Bt){var cr=o(yt),sr=yt===Bt?c(yt):(cr-o(Bt))/(Bt-yt),Dr=cr/sr+yt;if(v(sr)<n)return Tl;function tn(dn,Mn){var Ln=Dr-Mn,Nn=sr*dn;return[Ln*c(Nn),Dr-Ln*o(Nn)]}return tn.invert=function(dn,Mn){var Ln=Dr-Mn,Nn=d(dn,v(Ln))*b(Ln);return Ln*sr<0&&(Nn-=t*b(dn)*b(Ln)),[Nn/sr,Dr-b(sr)*u(dn*dn+Ln*Ln)]},tn}function Wu(){return Ts(cu).scale(131.154).center([0,13.9389])}var Ri=1.340264,fl=-.081106,Ks=893e-6,Qo=.003796,ns=u(3)/2,Al=12;function lo(yt,Bt){var cr=k(ns*c(Bt)),sr=cr*cr,Dr=sr*sr*sr;return[yt*o(cr)/(ns*(Ri+3*fl*sr+Dr*(7*Ks+9*Qo*sr))),cr*(Ri+fl*sr+Dr*(Ks+Qo*sr))]}lo.invert=function(yt,Bt){for(var cr=Bt,sr=cr*cr,Dr=sr*sr*sr,tn=0,dn,Mn,Ln;tn<Al&&(Mn=cr*(Ri+fl*sr+Dr*(Ks+Qo*sr))-Bt,Ln=Ri+3*fl*sr+Dr*(7*Ks+9*Qo*sr),cr-=dn=Mn/Ln,sr=cr*cr,Dr=sr*sr*sr,!(v(dn)<r));++tn);return[ns*yt*(Ri+3*fl*sr+Dr*(7*Ks+9*Qo*sr))/o(cr),k(c(cr)/ns)]};function hu(){return ko(lo).scale(177.158)}function as(yt,Bt){var cr=o(Bt),sr=o(yt)*cr;return[cr*c(yt)/sr,c(Bt)/sr]}as.invert=ll(f);function zs(){return ko(as).scale(144.049).clipAngle(60)}function Fs(){var yt=1,Bt=0,cr=0,sr=1,Dr=1,tn=0,dn,Mn,Ln=null,Nn,yn,zn,Pn=1,Hn=1,$n=Ws({point:function(ha,Ga){var Qa=Jn([ha,Ga]);this.stream.point(Qa[0],Qa[1])}}),za=un,Ea,Fa;function Oa(){return Pn=yt*sr,Hn=yt*Dr,Ea=Fa=null,Jn}function Jn(ha){var Ga=ha[0]*Pn,Qa=ha[1]*Hn;if(tn){var di=Qa*dn-Ga*Mn;Ga=Ga*dn+Qa*Mn,Qa=di}return[Ga+Bt,Qa+cr]}return Jn.invert=function(ha){var Ga=ha[0]-Bt,Qa=ha[1]-cr;if(tn){var di=Qa*dn+Ga*Mn;Ga=Ga*dn-Qa*Mn,Qa=di}return[Ga/Pn,Qa/Hn]},Jn.stream=function(ha){return Ea&&Fa===ha?Ea:Ea=$n(za(Fa=ha))},Jn.postclip=function(ha){return arguments.length?(za=ha,Ln=Nn=yn=zn=null,Oa()):za},Jn.clipExtent=function(ha){return arguments.length?(za=ha==null?(Ln=Nn=yn=zn=null,un):cn(Ln=+ha[0][0],Nn=+ha[0][1],yn=+ha[1][0],zn=+ha[1][1]),Oa()):Ln==null?null:[[Ln,Nn],[yn,zn]]},Jn.scale=function(ha){return arguments.length?(yt=+ha,Oa()):yt},Jn.translate=function(ha){return arguments.length?(Bt=+ha[0],cr=+ha[1],Oa()):[Bt,cr]},Jn.angle=function(ha){return arguments.length?(tn=ha%360*p,Mn=c(tn),dn=o(tn),Oa()):tn*x},Jn.reflectX=function(ha){return arguments.length?(sr=ha?-1:1,Oa()):sr<0},Jn.reflectY=function(ha){return arguments.length?(Dr=ha?-1:1,Oa()):Dr<0},Jn.fitExtent=function(ha,Ga){return ps(Jn,ha,Ga)},Jn.fitSize=function(ha,Ga){return yl(Jn,ha,Ga)},Jn.fitWidth=function(ha,Ga){return jl(Jn,ha,Ga)},Jn.fitHeight=function(ha,Ga){return su(Jn,ha,Ga)},Jn}function Ms(yt,Bt){var cr=Bt*Bt,sr=cr*cr;return[yt*(.8707-.131979*cr+sr*(-.013791+sr*(.003971*cr-.001529*sr))),Bt*(1.007226+cr*(.015085+sr*(-.044475+.028874*cr-.005916*sr)))]}Ms.invert=function(yt,Bt){var cr=Bt,sr=25,Dr;do{var tn=cr*cr,dn=tn*tn;cr-=Dr=(cr*(1.007226+tn*(.015085+dn*(-.044475+.028874*tn-.005916*dn)))-Bt)/(1.007226+tn*(.015085*3+dn*(-.044475*7+.028874*9*tn-.005916*11*dn)))}while(v(Dr)>n&&--sr>0);return[yt/(.8707+(tn=cr*cr)*(-.131979+tn*(-.013791+tn*tn*tn*(.003971-.001529*tn)))),cr]};function is(){return ko(Ms).scale(175.295)}function Hi(yt,Bt){return[o(Bt)*c(yt),c(Bt)]}Hi.invert=ll(k);function Eo(){return ko(Hi).scale(249.5).clipAngle(90+n)}function os(yt,Bt){var cr=o(Bt),sr=1+o(yt)*cr;return[cr*c(yt)/sr,c(Bt)/sr]}os.invert=ll(function(yt){return 2*f(yt)});function vu(){return ko(os).scale(250).clipAngle(142)}function Ol(yt,Bt){return[w(L((h+Bt)/2)),-yt]}Ol.invert=function(yt,Bt){return[-Bt,2*f(l(yt))-h]};function pu(){var yt=Jl(Ol),Bt=yt.center,cr=yt.rotate;return yt.center=function(sr){return arguments.length?Bt([-sr[1],sr[0]]):(sr=Bt(),[sr[1],-sr[0]])},yt.rotate=function(sr){return arguments.length?cr([sr[0],sr[1],sr.length>2?sr[2]+90:90]):(sr=cr(),[sr[0],sr[1],sr[2]-90])},cr([0,0,90]).scale(159.155)}A.geoAlbers=xl,A.geoAlbersUsa=gs,A.geoArea=X,A.geoAzimuthalEqualArea=_l,A.geoAzimuthalEqualAreaRaw=Fl,A.geoAzimuthalEquidistant=Lu,A.geoAzimuthalEquidistantRaw=Zs,A.geoBounds=Ge,A.geoCentroid=Tt,A.geoCircle=ar,A.geoClipAntimeridian=Zt,A.geoClipCircle=Er,A.geoClipExtent=Bn,A.geoClipRectangle=cn,A.geoConicConformal=js,A.geoConicConformalRaw=wl,A.geoConicEqualArea=ml,A.geoConicEqualAreaRaw=so,A.geoConicEquidistant=Wu,A.geoConicEquidistantRaw=cu,A.geoContains=hr,A.geoDistance=An,A.geoEqualEarth=hu,A.geoEqualEarthRaw=lo,A.geoEquirectangular=fu,A.geoEquirectangularRaw=Tl,A.geoGnomonic=zs,A.geoGnomonicRaw=as,A.geoGraticule=en,A.geoGraticule10=Tn,A.geoIdentity=Fs,A.geoInterpolate=xn,A.geoLength=Tr,A.geoMercator=Yu,A.geoMercatorRaw=rs,A.geoNaturalEarth1=is,A.geoNaturalEarth1Raw=Ms,A.geoOrthographic=Eo,A.geoOrthographicRaw=Hi,A.geoPath=Dl,A.geoProjection=ko,A.geoProjectionMutator=zl,A.geoRotation=gt,A.geoStereographic=vu,A.geoStereographicRaw=os,A.geoStream=N,A.geoTransform=Eu,A.geoTransverseMercator=pu,A.geoTransverseMercatorRaw=Ol,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){function g(He,Ae){return He.parent===Ae.parent?1:2}function S(He){return He.reduce(M,0)/He.length}function M(He,Ae){return He+Ae.x}function e(He){return 1+He.reduce(a,0)}function a(He,Ae){return Math.max(He,Ae.y)}function n(He){for(var Ae;Ae=He.children;)He=Ae[0];return He}function r(He){for(var Ae;Ae=He.children;)He=Ae[Ae.length-1];return He}function t(){var He=g,Ae=1,Ne=1,Ze=!1;function Qe(bt){var dt,wt=0;bt.eachAfter(function(Vt){var ir=Vt.children;ir?(Vt.x=S(ir),Vt.y=e(ir)):(Vt.x=dt?wt+=He(Vt,dt):0,Vt.y=0,dt=Vt)});var Ut=n(bt),Rt=r(bt),Nt=Ut.x-He(Ut,Rt)/2,Wt=Rt.x+He(Rt,Ut)/2;return bt.eachAfter(Ze?function(Vt){Vt.x=(Vt.x-bt.x)*Ae,Vt.y=(bt.y-Vt.y)*Ne}:function(Vt){Vt.x=(Vt.x-Nt)/(Wt-Nt)*Ae,Vt.y=(1-(bt.y?Vt.y/bt.y:1))*Ne})}return Qe.separation=function(bt){return arguments.length?(He=bt,Qe):He},Qe.size=function(bt){return arguments.length?(Ze=!1,Ae=+bt[0],Ne=+bt[1],Qe):Ze?null:[Ae,Ne]},Qe.nodeSize=function(bt){return arguments.length?(Ze=!0,Ae=+bt[0],Ne=+bt[1],Qe):Ze?[Ae,Ne]:null},Qe}function h(He){var Ae=0,Ne=He.children,Ze=Ne&&Ne.length;if(!Ze)Ae=1;else for(;--Ze>=0;)Ae+=Ne[Ze].value;He.value=Ae}function s(){return this.eachAfter(h)}function i(He){var Ae=this,Ne,Ze=[Ae],Qe,bt,dt;do for(Ne=Ze.reverse(),Ze=[];Ae=Ne.pop();)if(He(Ae),Qe=Ae.children,Qe)for(bt=0,dt=Qe.length;bt<dt;++bt)Ze.push(Qe[bt]);while(Ze.length);return this}function x(He){for(var Ae=this,Ne=[Ae],Ze,Qe;Ae=Ne.pop();)if(He(Ae),Ze=Ae.children,Ze)for(Qe=Ze.length-1;Qe>=0;--Qe)Ne.push(Ze[Qe]);return this}function p(He){for(var Ae=this,Ne=[Ae],Ze=[],Qe,bt,dt;Ae=Ne.pop();)if(Ze.push(Ae),Qe=Ae.children,Qe)for(bt=0,dt=Qe.length;bt<dt;++bt)Ne.push(Qe[bt]);for(;Ae=Ze.pop();)He(Ae);return this}function v(He){return this.eachAfter(function(Ae){for(var Ne=+He(Ae.data)||0,Ze=Ae.children,Qe=Ze&&Ze.length;--Qe>=0;)Ne+=Ze[Qe].value;Ae.value=Ne})}function f(He){return this.eachBefore(function(Ae){Ae.children&&Ae.children.sort(He)})}function d(He){for(var Ae=this,Ne=o(Ae,He),Ze=[Ae];Ae!==Ne;)Ae=Ae.parent,Ze.push(Ae);for(var Qe=Ze.length;He!==Ne;)Ze.splice(Qe,0,He),He=He.parent;return Ze}function o(He,Ae){if(He===Ae)return He;var Ne=He.ancestors(),Ze=Ae.ancestors(),Qe=null;for(He=Ne.pop(),Ae=Ze.pop();He===Ae;)Qe=He,He=Ne.pop(),Ae=Ze.pop();return Qe}function m(){for(var He=this,Ae=[He];He=He.parent;)Ae.push(He);return Ae}function l(){var He=[];return this.each(function(Ae){He.push(Ae)}),He}function w(){var He=[];return this.eachBefore(function(Ae){Ae.children||He.push(Ae)}),He}function _(){var He=this,Ae=[];return He.each(function(Ne){Ne!==He&&Ae.push({source:Ne.parent,target:Ne})}),Ae}function c(He,Ae){var Ne=new k(He),Ze=+He.value&&(Ne.value=He.value),Qe,bt=[Ne],dt,wt,Ut,Rt;for(Ae==null&&(Ae=u);Qe=bt.pop();)if(Ze&&(Qe.value=+Qe.data.value),(wt=Ae(Qe.data))&&(Rt=wt.length))for(Qe.children=new Array(Rt),Ut=Rt-1;Ut>=0;--Ut)bt.push(dt=Qe.children[Ut]=new k(wt[Ut])),dt.parent=Qe,dt.depth=Qe.depth+1;return Ne.eachBefore(T)}function b(){return c(this).eachBefore(L)}function u(He){return He.children}function L(He){He.data=He.data.data}function T(He){var Ae=0;do He.height=Ae;while((He=He.parent)&&He.height<++Ae)}function k(He){this.data=He,this.depth=this.height=0,this.parent=null}k.prototype=c.prototype={constructor:k,count:s,each:i,eachAfter:p,eachBefore:x,sum:v,sort:f,path:d,ancestors:m,descendants:l,leaves:w,links:_,copy:b};var P=Array.prototype.slice;function z(He){for(var Ae=He.length,Ne,Ze;Ae;)Ze=Math.random()*Ae--|0,Ne=He[Ae],He[Ae]=He[Ze],He[Ze]=Ne;return He}function I(He){for(var Ae=0,Ne=(He=z(P.call(He))).length,Ze=[],Qe,bt;Ae<Ne;)Qe=He[Ae],bt&&O(bt,Qe)?++Ae:(bt=N(Ze=D(Ze,Qe)),Ae=0);return bt}function D(He,Ae){var Ne,Ze;if(F(Ae,He))return[Ae];for(Ne=0;Ne<He.length;++Ne)if(R(Ae,He[Ne])&&F(K(He[Ne],Ae),He))return[He[Ne],Ae];for(Ne=0;Ne<He.length-1;++Ne)for(Ze=Ne+1;Ze<He.length;++Ze)if(R(K(He[Ne],He[Ze]),Ae)&&R(K(He[Ne],Ae),He[Ze])&&R(K(He[Ze],Ae),He[Ne])&&F(W(He[Ne],He[Ze],Ae),He))return[He[Ne],He[Ze],Ae];throw new Error}function R(He,Ae){var Ne=He.r-Ae.r,Ze=Ae.x-He.x,Qe=Ae.y-He.y;return Ne<0||Ne*Ne<Ze*Ze+Qe*Qe}function O(He,Ae){var Ne=He.r-Ae.r+1e-6,Ze=Ae.x-He.x,Qe=Ae.y-He.y;return Ne>0&&Ne*Ne>Ze*Ze+Qe*Qe}function F(He,Ae){for(var Ne=0;Ne<Ae.length;++Ne)if(!O(He,Ae[Ne]))return!1;return!0}function N(He){switch(He.length){case 1:return G(He[0]);case 2:return K(He[0],He[1]);case 3:return W(He[0],He[1],He[2])}}function G(He){return{x:He.x,y:He.y,r:He.r}}function K(He,Ae){var Ne=He.x,Ze=He.y,Qe=He.r,bt=Ae.x,dt=Ae.y,wt=Ae.r,Ut=bt-Ne,Rt=dt-Ze,Nt=wt-Qe,Wt=Math.sqrt(Ut*Ut+Rt*Rt);return{x:(Ne+bt+Ut/Wt*Nt)/2,y:(Ze+dt+Rt/Wt*Nt)/2,r:(Wt+Qe+wt)/2}}function W(He,Ae,Ne){var Ze=He.x,Qe=He.y,bt=He.r,dt=Ae.x,wt=Ae.y,Ut=Ae.r,Rt=Ne.x,Nt=Ne.y,Wt=Ne.r,Vt=Ze-dt,ir=Ze-Rt,Hr=Qe-wt,sn=Qe-Nt,jr=Ut-bt,at=Wt-bt,$t=Ze*Ze+Qe*Qe-bt*bt,Jt=$t-dt*dt-wt*wt+Ut*Ut,Gt=$t-Rt*Rt-Nt*Nt+Wt*Wt,_r=ir*Hr-Vt*sn,rt=(Hr*Gt-sn*Jt)/(_r*2)-Ze,Je=(sn*jr-Hr*at)/_r,st=(ir*Jt-Vt*Gt)/(_r*2)-Qe,lt=(Vt*at-ir*jr)/_r,Tt=Je*Je+lt*lt-1,zt=2*(bt+rt*Je+st*lt),Ce=rt*rt+st*st-bt*bt,Se=-(Tt?(zt+Math.sqrt(zt*zt-4*Tt*Ce))/(2*Tt):Ce/zt);return{x:Ze+rt+Je*Se,y:Qe+st+lt*Se,r:Se}}function Y(He,Ae,Ne){var Ze=He.x-Ae.x,Qe,bt,dt=He.y-Ae.y,wt,Ut,Rt=Ze*Ze+dt*dt;Rt?(bt=Ae.r+Ne.r,bt*=bt,Ut=He.r+Ne.r,Ut*=Ut,bt>Ut?(Qe=(Rt+Ut-bt)/(2*Rt),wt=Math.sqrt(Math.max(0,Ut/Rt-Qe*Qe)),Ne.x=He.x-Qe*Ze-wt*dt,Ne.y=He.y-Qe*dt+wt*Ze):(Qe=(Rt+bt-Ut)/(2*Rt),wt=Math.sqrt(Math.max(0,bt/Rt-Qe*Qe)),Ne.x=Ae.x+Qe*Ze-wt*dt,Ne.y=Ae.y+Qe*dt+wt*Ze)):(Ne.x=Ae.x+Ne.r,Ne.y=Ae.y)}function re(He,Ae){var Ne=He.r+Ae.r-1e-6,Ze=Ae.x-He.x,Qe=Ae.y-He.y;return Ne>0&&Ne*Ne>Ze*Ze+Qe*Qe}function ue(He){var Ae=He._,Ne=He.next._,Ze=Ae.r+Ne.r,Qe=(Ae.x*Ne.r+Ne.x*Ae.r)/Ze,bt=(Ae.y*Ne.r+Ne.y*Ae.r)/Ze;return Qe*Qe+bt*bt}function j(He){this._=He,this.next=null,this.previous=null}function q(He){if(!(Qe=He.length))return 0;var Ae,Ne,Ze,Qe,bt,dt,wt,Ut,Rt,Nt,Wt;if(Ae=He[0],Ae.x=0,Ae.y=0,!(Qe>1))return Ae.r;if(Ne=He[1],Ae.x=-Ne.r,Ne.x=Ae.r,Ne.y=0,!(Qe>2))return Ae.r+Ne.r;Y(Ne,Ae,Ze=He[2]),Ae=new j(Ae),Ne=new j(Ne),Ze=new j(Ze),Ae.next=Ze.previous=Ne,Ne.next=Ae.previous=Ze,Ze.next=Ne.previous=Ae;e:for(wt=3;wt<Qe;++wt){Y(Ae._,Ne._,Ze=He[wt]),Ze=new j(Ze),Ut=Ne.next,Rt=Ae.previous,Nt=Ne._.r,Wt=Ae._.r;do if(Nt<=Wt){if(re(Ut._,Ze._)){Ne=Ut,Ae.next=Ne,Ne.previous=Ae,--wt;continue e}Nt+=Ut._.r,Ut=Ut.next}else{if(re(Rt._,Ze._)){Ae=Rt,Ae.next=Ne,Ne.previous=Ae,--wt;continue e}Wt+=Rt._.r,Rt=Rt.previous}while(Ut!==Rt.next);for(Ze.previous=Ae,Ze.next=Ne,Ae.next=Ne.previous=Ne=Ze,bt=ue(Ae);(Ze=Ze.next)!==Ne;)(dt=ue(Ze))<bt&&(Ae=Ze,bt=dt);Ne=Ae.next}for(Ae=[Ne._],Ze=Ne;(Ze=Ze.next)!==Ne;)Ae.push(Ze._);for(Ze=I(Ae),wt=0;wt<Qe;++wt)Ae=He[wt],Ae.x-=Ze.x,Ae.y-=Ze.y;return Ze.r}function H(He){return q(He),He}function U(He){return He==null?null:$(He)}function $(He){if(typeof He!="function")throw new Error;return He}function ne(){return 0}function X(He){return function(){return He}}function Q(He){return Math.sqrt(He.value)}function ie(){var He=null,Ae=1,Ne=1,Ze=ne;function Qe(bt){return bt.x=Ae/2,bt.y=Ne/2,He?bt.eachBefore(se(He)).eachAfter(ae(Ze,.5)).eachBefore(oe(1)):bt.eachBefore(se(Q)).eachAfter(ae(ne,1)).eachAfter(ae(Ze,bt.r/Math.min(Ae,Ne))).eachBefore(oe(Math.min(Ae,Ne)/(2*bt.r))),bt}return Qe.radius=function(bt){return arguments.length?(He=U(bt),Qe):He},Qe.size=function(bt){return arguments.length?(Ae=+bt[0],Ne=+bt[1],Qe):[Ae,Ne]},Qe.padding=function(bt){return arguments.length?(Ze=typeof bt=="function"?bt:X(+bt),Qe):Ze},Qe}function se(He){return function(Ae){Ae.children||(Ae.r=Math.max(0,+He(Ae)||0))}}function ae(He,Ae){return function(Ne){if(Ze=Ne.children){var Ze,Qe,bt=Ze.length,dt=He(Ne)*Ae||0,wt;if(dt)for(Qe=0;Qe<bt;++Qe)Ze[Qe].r+=dt;if(wt=q(Ze),dt)for(Qe=0;Qe<bt;++Qe)Ze[Qe].r-=dt;Ne.r=wt+dt}}}function oe(He){return function(Ae){var Ne=Ae.parent;Ae.r*=He,Ne&&(Ae.x=Ne.x+He*Ae.x,Ae.y=Ne.y+He*Ae.y)}}function be(He){He.x0=Math.round(He.x0),He.y0=Math.round(He.y0),He.x1=Math.round(He.x1),He.y1=Math.round(He.y1)}function ce(He,Ae,Ne,Ze,Qe){for(var bt=He.children,dt,wt=-1,Ut=bt.length,Rt=He.value&&(Ze-Ae)/He.value;++wt<Ut;)dt=bt[wt],dt.y0=Ne,dt.y1=Qe,dt.x0=Ae,dt.x1=Ae+=dt.value*Rt}function de(){var He=1,Ae=1,Ne=0,Ze=!1;function Qe(dt){var wt=dt.height+1;return dt.x0=dt.y0=Ne,dt.x1=He,dt.y1=Ae/wt,dt.eachBefore(bt(Ae,wt)),Ze&&dt.eachBefore(be),dt}function bt(dt,wt){return function(Ut){Ut.children&&ce(Ut,Ut.x0,dt*(Ut.depth+1)/wt,Ut.x1,dt*(Ut.depth+2)/wt);var Rt=Ut.x0,Nt=Ut.y0,Wt=Ut.x1-Ne,Vt=Ut.y1-Ne;Wt<Rt&&(Rt=Wt=(Rt+Wt)/2),Vt<Nt&&(Nt=Vt=(Nt+Vt)/2),Ut.x0=Rt,Ut.y0=Nt,Ut.x1=Wt,Ut.y1=Vt}}return Qe.round=function(dt){return arguments.length?(Ze=!!dt,Qe):Ze},Qe.size=function(dt){return arguments.length?(He=+dt[0],Ae=+dt[1],Qe):[He,Ae]},Qe.padding=function(dt){return arguments.length?(Ne=+dt,Qe):Ne},Qe}var ye="$",ge={depth:-1},me={};function Ee(He){return He.id}function Pe(He){return He.parentId}function Ue(){var He=Ee,Ae=Pe;function Ne(Ze){var Qe,bt,dt=Ze.length,wt,Ut,Rt,Nt=new Array(dt),Wt,Vt,ir={};for(bt=0;bt<dt;++bt)Qe=Ze[bt],Rt=Nt[bt]=new k(Qe),(Wt=He(Qe,bt,Ze))!=null&&(Wt+="")&&(Vt=ye+(Rt.id=Wt),ir[Vt]=Vt in ir?me:Rt);for(bt=0;bt<dt;++bt)if(Rt=Nt[bt],Wt=Ae(Ze[bt],bt,Ze),Wt==null||!(Wt+="")){if(wt)throw new Error("multiple roots");wt=Rt}else{if(Ut=ir[ye+Wt],!Ut)throw new Error("missing: "+Wt);if(Ut===me)throw new Error("ambiguous: "+Wt);Ut.children?Ut.children.push(Rt):Ut.children=[Rt],Rt.parent=Ut}if(!wt)throw new Error("no root");if(wt.parent=ge,wt.eachBefore(function(Hr){Hr.depth=Hr.parent.depth+1,--dt}).eachBefore(T),wt.parent=null,dt>0)throw new Error("cycle");return wt}return Ne.id=function(Ze){return arguments.length?(He=$(Ze),Ne):He},Ne.parentId=function(Ze){return arguments.length?(Ae=$(Ze),Ne):Ae},Ne}function we(He,Ae){return He.parent===Ae.parent?1:2}function ke(He){var Ae=He.children;return Ae?Ae[0]:He.t}function Xe(He){var Ae=He.children;return Ae?Ae[Ae.length-1]:He.t}function Ve(He,Ae,Ne){var Ze=Ne/(Ae.i-He.i);Ae.c-=Ze,Ae.s+=Ne,He.c+=Ze,Ae.z+=Ne,Ae.m+=Ne}function Ie(He){for(var Ae=0,Ne=0,Ze=He.children,Qe=Ze.length,bt;--Qe>=0;)bt=Ze[Qe],bt.z+=Ae,bt.m+=Ae,Ae+=bt.s+(Ne+=bt.c)}function De(He,Ae,Ne){return He.a.parent===Ae.parent?He.a:Ne}function Ye(He,Ae){this._=He,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=Ae}Ye.prototype=Object.create(k.prototype);function vt(He){for(var Ae=new Ye(He,0),Ne,Ze=[Ae],Qe,bt,dt,wt;Ne=Ze.pop();)if(bt=Ne._.children)for(Ne.children=new Array(wt=bt.length),dt=wt-1;dt>=0;--dt)Ze.push(Qe=Ne.children[dt]=new Ye(bt[dt],dt)),Qe.parent=Ne;return(Ae.parent=new Ye(null,0)).children=[Ae],Ae}function Dt(){var He=we,Ae=1,Ne=1,Ze=null;function Qe(Rt){var Nt=vt(Rt);if(Nt.eachAfter(bt),Nt.parent.m=-Nt.z,Nt.eachBefore(dt),Ze)Rt.eachBefore(Ut);else{var Wt=Rt,Vt=Rt,ir=Rt;Rt.eachBefore(function($t){$t.x<Wt.x&&(Wt=$t),$t.x>Vt.x&&(Vt=$t),$t.depth>ir.depth&&(ir=$t)});var Hr=Wt===Vt?1:He(Wt,Vt)/2,sn=Hr-Wt.x,jr=Ae/(Vt.x+Hr+sn),at=Ne/(ir.depth||1);Rt.eachBefore(function($t){$t.x=($t.x+sn)*jr,$t.y=$t.depth*at})}return Rt}function bt(Rt){var Nt=Rt.children,Wt=Rt.parent.children,Vt=Rt.i?Wt[Rt.i-1]:null;if(Nt){Ie(Rt);var ir=(Nt[0].z+Nt[Nt.length-1].z)/2;Vt?(Rt.z=Vt.z+He(Rt._,Vt._),Rt.m=Rt.z-ir):Rt.z=ir}else Vt&&(Rt.z=Vt.z+He(Rt._,Vt._));Rt.parent.A=wt(Rt,Vt,Rt.parent.A||Wt[0])}function dt(Rt){Rt._.x=Rt.z+Rt.parent.m,Rt.m+=Rt.parent.m}function wt(Rt,Nt,Wt){if(Nt){for(var Vt=Rt,ir=Rt,Hr=Nt,sn=Vt.parent.children[0],jr=Vt.m,at=ir.m,$t=Hr.m,Jt=sn.m,Gt;Hr=Xe(Hr),Vt=ke(Vt),Hr&&Vt;)sn=ke(sn),ir=Xe(ir),ir.a=Rt,Gt=Hr.z+$t-Vt.z-jr+He(Hr._,Vt._),Gt>0&&(Ve(De(Hr,Rt,Wt),Rt,Gt),jr+=Gt,at+=Gt),$t+=Hr.m,jr+=Vt.m,Jt+=sn.m,at+=ir.m;Hr&&!Xe(ir)&&(ir.t=Hr,ir.m+=$t-at),Vt&&!ke(sn)&&(sn.t=Vt,sn.m+=jr-Jt,Wt=Rt)}return Wt}function Ut(Rt){Rt.x*=Ae,Rt.y=Rt.depth*Ne}return Qe.separation=function(Rt){return arguments.length?(He=Rt,Qe):He},Qe.size=function(Rt){return arguments.length?(Ze=!1,Ae=+Rt[0],Ne=+Rt[1],Qe):Ze?null:[Ae,Ne]},Qe.nodeSize=function(Rt){return arguments.length?(Ze=!0,Ae=+Rt[0],Ne=+Rt[1],Qe):Ze?[Ae,Ne]:null},Qe}function Kt(He,Ae,Ne,Ze,Qe){for(var bt=He.children,dt,wt=-1,Ut=bt.length,Rt=He.value&&(Qe-Ne)/He.value;++wt<Ut;)dt=bt[wt],dt.x0=Ae,dt.x1=Ze,dt.y0=Ne,dt.y1=Ne+=dt.value*Rt}var Ft=(1+Math.sqrt(5))/2;function Mt(He,Ae,Ne,Ze,Qe,bt){for(var dt=[],wt=Ae.children,Ut,Rt,Nt=0,Wt=0,Vt=wt.length,ir,Hr,sn=Ae.value,jr,at,$t,Jt,Gt,_r,rt;Nt<Vt;){ir=Qe-Ne,Hr=bt-Ze;do jr=wt[Wt++].value;while(!jr&&Wt<Vt);for(at=$t=jr,_r=Math.max(Hr/ir,ir/Hr)/(sn*He),rt=jr*jr*_r,Gt=Math.max($t/rt,rt/at);Wt<Vt;++Wt){if(jr+=Rt=wt[Wt].value,Rt<at&&(at=Rt),Rt>$t&&($t=Rt),rt=jr*jr*_r,Jt=Math.max($t/rt,rt/at),Jt>Gt){jr-=Rt;break}Gt=Jt}dt.push(Ut={value:jr,dice:ir<Hr,children:wt.slice(Nt,Wt)}),Ut.dice?ce(Ut,Ne,Ze,Qe,sn?Ze+=Hr*jr/sn:bt):Kt(Ut,Ne,Ze,sn?Ne+=ir*jr/sn:Qe,bt),sn-=jr,Nt=Wt}return dt}var Xt=function He(Ae){function Ne(Ze,Qe,bt,dt,wt){Mt(Ae,Ze,Qe,bt,dt,wt)}return Ne.ratio=function(Ze){return He((Ze=+Ze)>1?Ze:1)},Ne}(Ft);function It(){var He=Xt,Ae=!1,Ne=1,Ze=1,Qe=[0],bt=ne,dt=ne,wt=ne,Ut=ne,Rt=ne;function Nt(Vt){return Vt.x0=Vt.y0=0,Vt.x1=Ne,Vt.y1=Ze,Vt.eachBefore(Wt),Qe=[0],Ae&&Vt.eachBefore(be),Vt}function Wt(Vt){var ir=Qe[Vt.depth],Hr=Vt.x0+ir,sn=Vt.y0+ir,jr=Vt.x1-ir,at=Vt.y1-ir;jr<Hr&&(Hr=jr=(Hr+jr)/2),at<sn&&(sn=at=(sn+at)/2),Vt.x0=Hr,Vt.y0=sn,Vt.x1=jr,Vt.y1=at,Vt.children&&(ir=Qe[Vt.depth+1]=bt(Vt)/2,Hr+=Rt(Vt)-ir,sn+=dt(Vt)-ir,jr-=wt(Vt)-ir,at-=Ut(Vt)-ir,jr<Hr&&(Hr=jr=(Hr+jr)/2),at<sn&&(sn=at=(sn+at)/2),He(Vt,Hr,sn,jr,at))}return Nt.round=function(Vt){return arguments.length?(Ae=!!Vt,Nt):Ae},Nt.size=function(Vt){return arguments.length?(Ne=+Vt[0],Ze=+Vt[1],Nt):[Ne,Ze]},Nt.tile=function(Vt){return arguments.length?(He=$(Vt),Nt):He},Nt.padding=function(Vt){return arguments.length?Nt.paddingInner(Vt).paddingOuter(Vt):Nt.paddingInner()},Nt.paddingInner=function(Vt){return arguments.length?(bt=typeof Vt=="function"?Vt:X(+Vt),Nt):bt},Nt.paddingOuter=function(Vt){return arguments.length?Nt.paddingTop(Vt).paddingRight(Vt).paddingBottom(Vt).paddingLeft(Vt):Nt.paddingTop()},Nt.paddingTop=function(Vt){return arguments.length?(dt=typeof Vt=="function"?Vt:X(+Vt),Nt):dt},Nt.paddingRight=function(Vt){return arguments.length?(wt=typeof Vt=="function"?Vt:X(+Vt),Nt):wt},Nt.paddingBottom=function(Vt){return arguments.length?(Ut=typeof Vt=="function"?Vt:X(+Vt),Nt):Ut},Nt.paddingLeft=function(Vt){return arguments.length?(Rt=typeof Vt=="function"?Vt:X(+Vt),Nt):Rt},Nt}function At(He,Ae,Ne,Ze,Qe){var bt=He.children,dt,wt=bt.length,Ut,Rt=new Array(wt+1);for(Rt[0]=Ut=dt=0;dt<wt;++dt)Rt[dt+1]=Ut+=bt[dt].value;Nt(0,wt,He.value,Ae,Ne,Ze,Qe);function Nt(Wt,Vt,ir,Hr,sn,jr,at){if(Wt>=Vt-1){var $t=bt[Wt];$t.x0=Hr,$t.y0=sn,$t.x1=jr,$t.y1=at;return}for(var Jt=Rt[Wt],Gt=ir/2+Jt,_r=Wt+1,rt=Vt-1;_r<rt;){var Je=_r+rt>>>1;Rt[Je]<Gt?_r=Je+1:rt=Je}Gt-Rt[_r-1]<Rt[_r]-Gt&&Wt+1<_r&&--_r;var st=Rt[_r]-Jt,lt=ir-st;if(jr-Hr>at-sn){var Tt=(Hr*lt+jr*st)/ir;Nt(Wt,_r,st,Hr,sn,Tt,at),Nt(_r,Vt,lt,Tt,sn,jr,at)}else{var zt=(sn*lt+at*st)/ir;Nt(Wt,_r,st,Hr,sn,jr,zt),Nt(_r,Vt,lt,Hr,zt,jr,at)}}}function Ge(He,Ae,Ne,Ze,Qe){(He.depth&1?Kt:ce)(He,Ae,Ne,Ze,Qe)}var tt=function He(Ae){function Ne(Ze,Qe,bt,dt,wt){if((Ut=Ze._squarify)&&Ut.ratio===Ae)for(var Ut,Rt,Nt,Wt,Vt=-1,ir,Hr=Ut.length,sn=Ze.value;++Vt<Hr;){for(Rt=Ut[Vt],Nt=Rt.children,Wt=Rt.value=0,ir=Nt.length;Wt<ir;++Wt)Rt.value+=Nt[Wt].value;Rt.dice?ce(Rt,Qe,bt,dt,bt+=(wt-bt)*Rt.value/sn):Kt(Rt,Qe,bt,Qe+=(dt-Qe)*Rt.value/sn,wt),sn-=Rt.value}else Ze._squarify=Ut=Mt(Ae,Ze,Qe,bt,dt,wt),Ut.ratio=Ae}return Ne.ratio=function(Ze){return He((Ze=+Ze)>1?Ze:1)},Ne}(Ft);A.cluster=t,A.hierarchy=c,A.pack=ie,A.packEnclose=I,A.packSiblings=H,A.partition=de,A.stratify=Ue,A.tree=Dt,A.treemap=It,A.treemapBinary=At,A.treemapDice=ce,A.treemapResquarify=tt,A.treemapSlice=Kt,A.treemapSliceDice=Ge,A.treemapSquarify=Xt,Object.defineProperty(A,"__esModule",{value:!0})})},{}],116:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,y("d3-color")):(A=A||self,g(A.d3=A.d3||{},A.d3))})(this,function(A,g){function S(we,ke,Xe,Ve,Ie){var De=we*we,Ye=De*we;return((1-3*we+3*De-Ye)*ke+(4-6*De+3*Ye)*Xe+(1+3*we+3*De-3*Ye)*Ve+Ye*Ie)/6}function M(we){var ke=we.length-1;return function(Xe){var Ve=Xe<=0?Xe=0:Xe>=1?(Xe=1,ke-1):Math.floor(Xe*ke),Ie=we[Ve],De=we[Ve+1],Ye=Ve>0?we[Ve-1]:2*Ie-De,vt=Ve<ke-1?we[Ve+2]:2*De-Ie;return S((Xe-Ve/ke)*ke,Ye,Ie,De,vt)}}function e(we){var ke=we.length;return function(Xe){var Ve=Math.floor(((Xe%=1)<0?++Xe:Xe)*ke),Ie=we[(Ve+ke-1)%ke],De=we[Ve%ke],Ye=we[(Ve+1)%ke],vt=we[(Ve+2)%ke];return S((Xe-Ve/ke)*ke,Ie,De,Ye,vt)}}function a(we){return function(){return we}}function n(we,ke){return function(Xe){return we+Xe*ke}}function r(we,ke,Xe){return we=Math.pow(we,Xe),ke=Math.pow(ke,Xe)-we,Xe=1/Xe,function(Ve){return Math.pow(we+Ve*ke,Xe)}}function t(we,ke){var Xe=ke-we;return Xe?n(we,Xe>180||Xe<-180?Xe-360*Math.round(Xe/360):Xe):a(isNaN(we)?ke:we)}function h(we){return(we=+we)==1?s:function(ke,Xe){return Xe-ke?r(ke,Xe,we):a(isNaN(ke)?Xe:ke)}}function s(we,ke){var Xe=ke-we;return Xe?n(we,Xe):a(isNaN(we)?ke:we)}var i=function we(ke){var Xe=h(ke);function Ve(Ie,De){var Ye=Xe((Ie=g.rgb(Ie)).r,(De=g.rgb(De)).r),vt=Xe(Ie.g,De.g),Dt=Xe(Ie.b,De.b),Kt=s(Ie.opacity,De.opacity);return function(Ft){return Ie.r=Ye(Ft),Ie.g=vt(Ft),Ie.b=Dt(Ft),Ie.opacity=Kt(Ft),Ie+""}}return Ve.gamma=we,Ve}(1);function x(we){return function(ke){var Xe=ke.length,Ve=new Array(Xe),Ie=new Array(Xe),De=new Array(Xe),Ye,vt;for(Ye=0;Ye<Xe;++Ye)vt=g.rgb(ke[Ye]),Ve[Ye]=vt.r||0,Ie[Ye]=vt.g||0,De[Ye]=vt.b||0;return Ve=we(Ve),Ie=we(Ie),De=we(De),vt.opacity=1,function(Dt){return vt.r=Ve(Dt),vt.g=Ie(Dt),vt.b=De(Dt),vt+""}}}var p=x(M),v=x(e);function f(we,ke){ke||(ke=[]);var Xe=we?Math.min(ke.length,we.length):0,Ve=ke.slice(),Ie;return function(De){for(Ie=0;Ie<Xe;++Ie)Ve[Ie]=we[Ie]*(1-De)+ke[Ie]*De;return Ve}}function d(we){return ArrayBuffer.isView(we)&&!(we instanceof DataView)}function o(we,ke){return(d(ke)?f:m)(we,ke)}function m(we,ke){var Xe=ke?ke.length:0,Ve=we?Math.min(Xe,we.length):0,Ie=new Array(Ve),De=new Array(Xe),Ye;for(Ye=0;Ye<Ve;++Ye)Ie[Ye]=k(we[Ye],ke[Ye]);for(;Ye<Xe;++Ye)De[Ye]=ke[Ye];return function(vt){for(Ye=0;Ye<Ve;++Ye)De[Ye]=Ie[Ye](vt);return De}}function l(we,ke){var Xe=new Date;return we=+we,ke=+ke,function(Ve){return Xe.setTime(we*(1-Ve)+ke*Ve),Xe}}function w(we,ke){return we=+we,ke=+ke,function(Xe){return we*(1-Xe)+ke*Xe}}function _(we,ke){var Xe={},Ve={},Ie;(we===null||typeof we!="object")&&(we={}),(ke===null||typeof ke!="object")&&(ke={});for(Ie in ke)Ie in we?Xe[Ie]=k(we[Ie],ke[Ie]):Ve[Ie]=ke[Ie];return function(De){for(Ie in Xe)Ve[Ie]=Xe[Ie](De);return Ve}}var c=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b=new RegExp(c.source,"g");function u(we){return function(){return we}}function L(we){return function(ke){return we(ke)+""}}function T(we,ke){var Xe=c.lastIndex=b.lastIndex=0,Ve,Ie,De,Ye=-1,vt=[],Dt=[];for(we=we+"",ke=ke+"";(Ve=c.exec(we))&&(Ie=b.exec(ke));)(De=Ie.index)>Xe&&(De=ke.slice(Xe,De),vt[Ye]?vt[Ye]+=De:vt[++Ye]=De),(Ve=Ve[0])===(Ie=Ie[0])?vt[Ye]?vt[Ye]+=Ie:vt[++Ye]=Ie:(vt[++Ye]=null,Dt.push({i:Ye,x:w(Ve,Ie)})),Xe=b.lastIndex;return Xe<ke.length&&(De=ke.slice(Xe),vt[Ye]?vt[Ye]+=De:vt[++Ye]=De),vt.length<2?Dt[0]?L(Dt[0].x):u(ke):(ke=Dt.length,function(Kt){for(var Ft=0,Mt;Ft<ke;++Ft)vt[(Mt=Dt[Ft]).i]=Mt.x(Kt);return vt.join("")})}function k(we,ke){var Xe=typeof ke,Ve;return ke==null||Xe==="boolean"?a(ke):(Xe==="number"?w:Xe==="string"?(Ve=g.color(ke))?(ke=Ve,i):T:ke instanceof g.color?i:ke instanceof Date?l:d(ke)?f:Array.isArray(ke)?m:typeof ke.valueOf!="function"&&typeof ke.toString!="function"||isNaN(ke)?_:w)(we,ke)}function P(we){var ke=we.length;return function(Xe){return we[Math.max(0,Math.min(ke-1,Math.floor(Xe*ke)))]}}function z(we,ke){var Xe=t(+we,+ke);return function(Ve){var Ie=Xe(Ve);return Ie-360*Math.floor(Ie/360)}}function I(we,ke){return we=+we,ke=+ke,function(Xe){return Math.round(we*(1-Xe)+ke*Xe)}}var D=180/Math.PI,R={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function O(we,ke,Xe,Ve,Ie,De){var Ye,vt,Dt;return(Ye=Math.sqrt(we*we+ke*ke))&&(we/=Ye,ke/=Ye),(Dt=we*Xe+ke*Ve)&&(Xe-=we*Dt,Ve-=ke*Dt),(vt=Math.sqrt(Xe*Xe+Ve*Ve))&&(Xe/=vt,Ve/=vt,Dt/=vt),we*Ve<ke*Xe&&(we=-we,ke=-ke,Dt=-Dt,Ye=-Ye),{translateX:Ie,translateY:De,rotate:Math.atan2(ke,we)*D,skewX:Math.atan(Dt)*D,scaleX:Ye,scaleY:vt}}var F,N,G,K;function W(we){return we==="none"?R:(F||(F=document.createElement("DIV"),N=document.documentElement,G=document.defaultView),F.style.transform=we,we=G.getComputedStyle(N.appendChild(F),null).getPropertyValue("transform"),N.removeChild(F),we=we.slice(7,-1).split(","),O(+we[0],+we[1],+we[2],+we[3],+we[4],+we[5]))}function Y(we){return we==null||(K||(K=document.createElementNS("http://www.w3.org/2000/svg","g")),K.setAttribute("transform",we),!(we=K.transform.baseVal.consolidate()))?R:(we=we.matrix,O(we.a,we.b,we.c,we.d,we.e,we.f))}function re(we,ke,Xe,Ve){function Ie(Kt){return Kt.length?Kt.pop()+" ":""}function De(Kt,Ft,Mt,Xt,It,At){if(Kt!==Mt||Ft!==Xt){var Ge=It.push("translate(",null,ke,null,Xe);At.push({i:Ge-4,x:w(Kt,Mt)},{i:Ge-2,x:w(Ft,Xt)})}else(Mt||Xt)&&It.push("translate("+Mt+ke+Xt+Xe)}function Ye(Kt,Ft,Mt,Xt){Kt!==Ft?(Kt-Ft>180?Ft+=360:Ft-Kt>180&&(Kt+=360),Xt.push({i:Mt.push(Ie(Mt)+"rotate(",null,Ve)-2,x:w(Kt,Ft)})):Ft&&Mt.push(Ie(Mt)+"rotate("+Ft+Ve)}function vt(Kt,Ft,Mt,Xt){Kt!==Ft?Xt.push({i:Mt.push(Ie(Mt)+"skewX(",null,Ve)-2,x:w(Kt,Ft)}):Ft&&Mt.push(Ie(Mt)+"skewX("+Ft+Ve)}function Dt(Kt,Ft,Mt,Xt,It,At){if(Kt!==Mt||Ft!==Xt){var Ge=It.push(Ie(It)+"scale(",null,",",null,")");At.push({i:Ge-4,x:w(Kt,Mt)},{i:Ge-2,x:w(Ft,Xt)})}else(Mt!==1||Xt!==1)&&It.push(Ie(It)+"scale("+Mt+","+Xt+")")}return function(Kt,Ft){var Mt=[],Xt=[];return Kt=we(Kt),Ft=we(Ft),De(Kt.translateX,Kt.translateY,Ft.translateX,Ft.translateY,Mt,Xt),Ye(Kt.rotate,Ft.rotate,Mt,Xt),vt(Kt.skewX,Ft.skewX,Mt,Xt),Dt(Kt.scaleX,Kt.scaleY,Ft.scaleX,Ft.scaleY,Mt,Xt),Kt=Ft=null,function(It){for(var At=-1,Ge=Xt.length,tt;++At<Ge;)Mt[(tt=Xt[At]).i]=tt.x(It);return Mt.join("")}}}var ue=re(W,"px, ","px)","deg)"),j=re(Y,", ",")",")"),q=Math.SQRT2,H=2,U=4,$=1e-12;function ne(we){return((we=Math.exp(we))+1/we)/2}function X(we){return((we=Math.exp(we))-1/we)/2}function Q(we){return((we=Math.exp(2*we))-1)/(we+1)}function ie(we,ke){var Xe=we[0],Ve=we[1],Ie=we[2],De=ke[0],Ye=ke[1],vt=ke[2],Dt=De-Xe,Kt=Ye-Ve,Ft=Dt*Dt+Kt*Kt,Mt,Xt;if(Ft<$)Xt=Math.log(vt/Ie)/q,Mt=function(Ae){return[Xe+Ae*Dt,Ve+Ae*Kt,Ie*Math.exp(q*Ae*Xt)]};else{var It=Math.sqrt(Ft),At=(vt*vt-Ie*Ie+U*Ft)/(2*Ie*H*It),Ge=(vt*vt-Ie*Ie-U*Ft)/(2*vt*H*It),tt=Math.log(Math.sqrt(At*At+1)-At),He=Math.log(Math.sqrt(Ge*Ge+1)-Ge);Xt=(He-tt)/q,Mt=function(Ae){var Ne=Ae*Xt,Ze=ne(tt),Qe=Ie/(H*It)*(Ze*Q(q*Ne+tt)-X(tt));return[Xe+Qe*Dt,Ve+Qe*Kt,Ie*Ze/ne(q*Ne+tt)]}}return Mt.duration=Xt*1e3,Mt}function se(we){return function(ke,Xe){var Ve=we((ke=g.hsl(ke)).h,(Xe=g.hsl(Xe)).h),Ie=s(ke.s,Xe.s),De=s(ke.l,Xe.l),Ye=s(ke.opacity,Xe.opacity);return function(vt){return ke.h=Ve(vt),ke.s=Ie(vt),ke.l=De(vt),ke.opacity=Ye(vt),ke+""}}}var ae=se(t),oe=se(s);function be(we,ke){var Xe=s((we=g.lab(we)).l,(ke=g.lab(ke)).l),Ve=s(we.a,ke.a),Ie=s(we.b,ke.b),De=s(we.opacity,ke.opacity);return function(Ye){return we.l=Xe(Ye),we.a=Ve(Ye),we.b=Ie(Ye),we.opacity=De(Ye),we+""}}function ce(we){return function(ke,Xe){var Ve=we((ke=g.hcl(ke)).h,(Xe=g.hcl(Xe)).h),Ie=s(ke.c,Xe.c),De=s(ke.l,Xe.l),Ye=s(ke.opacity,Xe.opacity);return function(vt){return ke.h=Ve(vt),ke.c=Ie(vt),ke.l=De(vt),ke.opacity=Ye(vt),ke+""}}}var de=ce(t),ye=ce(s);function ge(we){return function ke(Xe){Xe=+Xe;function Ve(Ie,De){var Ye=we((Ie=g.cubehelix(Ie)).h,(De=g.cubehelix(De)).h),vt=s(Ie.s,De.s),Dt=s(Ie.l,De.l),Kt=s(Ie.opacity,De.opacity);return function(Ft){return Ie.h=Ye(Ft),Ie.s=vt(Ft),Ie.l=Dt(Math.pow(Ft,Xe)),Ie.opacity=Kt(Ft),Ie+""}}return Ve.gamma=ke,Ve}(1)}var me=ge(t),Ee=ge(s);function Pe(we,ke){for(var Xe=0,Ve=ke.length-1,Ie=ke[0],De=new Array(Ve<0?0:Ve);Xe<Ve;)De[Xe]=we(Ie,Ie=ke[++Xe]);return function(Ye){var vt=Math.max(0,Math.min(Ve-1,Math.floor(Ye*=Ve)));return De[vt](Ye-vt)}}function Ue(we,ke){for(var Xe=new Array(ke),Ve=0;Ve<ke;++Ve)Xe[Ve]=we(Ve/(ke-1));return Xe}A.interpolate=k,A.interpolateArray=o,A.interpolateBasis=M,A.interpolateBasisClosed=e,A.interpolateCubehelix=me,A.interpolateCubehelixLong=Ee,A.interpolateDate=l,A.interpolateDiscrete=P,A.interpolateHcl=de,A.interpolateHclLong=ye,A.interpolateHsl=ae,A.interpolateHslLong=oe,A.interpolateHue=z,A.interpolateLab=be,A.interpolateNumber=w,A.interpolateNumberArray=f,A.interpolateObject=_,A.interpolateRgb=i,A.interpolateRgbBasis=p,A.interpolateRgbBasisClosed=v,A.interpolateRound=I,A.interpolateString=T,A.interpolateTransformCss=ue,A.interpolateTransformSvg=j,A.interpolateZoom=ie,A.piecewise=Pe,A.quantize=Ue,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){var g=Math.PI,S=2*g,M=1e-6,e=S-M;function a(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function n(){return new a}a.prototype=n.prototype={constructor:a,moveTo:function(r,t){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(r,t){this._+="L"+(this._x1=+r)+","+(this._y1=+t)},quadraticCurveTo:function(r,t,h,s){this._+="Q"+ +r+","+ +t+","+(this._x1=+h)+","+(this._y1=+s)},bezierCurveTo:function(r,t,h,s,i,x){this._+="C"+ +r+","+ +t+","+ +h+","+ +s+","+(this._x1=+i)+","+(this._y1=+x)},arcTo:function(r,t,h,s,i){r=+r,t=+t,h=+h,s=+s,i=+i;var x=this._x1,p=this._y1,v=h-r,f=s-t,d=x-r,o=p-t,m=d*d+o*o;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=r)+","+(this._y1=t);else if(m>M)if(!(Math.abs(o*v-f*d)>M)||!i)this._+="L"+(this._x1=r)+","+(this._y1=t);else{var l=h-x,w=s-p,_=v*v+f*f,c=l*l+w*w,b=Math.sqrt(_),u=Math.sqrt(m),L=i*Math.tan((g-Math.acos((_+m-c)/(2*b*u)))/2),T=L/u,k=L/b;Math.abs(T-1)>M&&(this._+="L"+(r+T*d)+","+(t+T*o)),this._+="A"+i+","+i+",0,0,"+ +(o*l>d*w)+","+(this._x1=r+k*v)+","+(this._y1=t+k*f)}},arc:function(r,t,h,s,i,x){r=+r,t=+t,h=+h,x=!!x;var p=h*Math.cos(s),v=h*Math.sin(s),f=r+p,d=t+v,o=1^x,m=x?s-i:i-s;if(h<0)throw new Error("negative radius: "+h);this._x1===null?this._+="M"+f+","+d:(Math.abs(this._x1-f)>M||Math.abs(this._y1-d)>M)&&(this._+="L"+f+","+d),h&&(m<0&&(m=m%S+S),m>e?this._+="A"+h+","+h+",0,1,"+o+","+(r-p)+","+(t-v)+"A"+h+","+h+",0,1,"+o+","+(this._x1=f)+","+(this._y1=d):m>M&&(this._+="A"+h+","+h+",0,"+ +(m>=g)+","+o+","+(this._x1=r+h*Math.cos(i))+","+(this._y1=t+h*Math.sin(i))))},rect:function(r,t,h,s){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+t)+"h"+ +h+"v"+ +s+"h"+-h+"Z"},toString:function(){return this._}},A.path=n,Object.defineProperty(A,"__esModule",{value:!0})})},{}],118:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){function g(b){var u=+this._x.call(null,b),L=+this._y.call(null,b);return S(this.cover(u,L),u,L,b)}function S(b,u,L,T){if(isNaN(u)||isNaN(L))return b;var k,P=b._root,z={data:T},I=b._x0,D=b._y0,R=b._x1,O=b._y1,F,N,G,K,W,Y,re,ue;if(!P)return b._root=z,b;for(;P.length;)if((W=u>=(F=(I+R)/2))?I=F:R=F,(Y=L>=(N=(D+O)/2))?D=N:O=N,k=P,!(P=P[re=Y<<1|W]))return k[re]=z,b;if(G=+b._x.call(null,P.data),K=+b._y.call(null,P.data),u===G&&L===K)return z.next=P,k?k[re]=z:b._root=z,b;do k=k?k[re]=new Array(4):b._root=new Array(4),(W=u>=(F=(I+R)/2))?I=F:R=F,(Y=L>=(N=(D+O)/2))?D=N:O=N;while((re=Y<<1|W)===(ue=(K>=N)<<1|G>=F));return k[ue]=P,k[re]=z,b}function M(b){var u,L,T=b.length,k,P,z=new Array(T),I=new Array(T),D=1/0,R=1/0,O=-1/0,F=-1/0;for(L=0;L<T;++L)isNaN(k=+this._x.call(null,u=b[L]))||isNaN(P=+this._y.call(null,u))||(z[L]=k,I[L]=P,k<D&&(D=k),k>O&&(O=k),P<R&&(R=P),P>F&&(F=P));if(D>O||R>F)return this;for(this.cover(D,R).cover(O,F),L=0;L<T;++L)S(this,z[L],I[L],b[L]);return this}function e(b,u){if(isNaN(b=+b)||isNaN(u=+u))return this;var L=this._x0,T=this._y0,k=this._x1,P=this._y1;if(isNaN(L))k=(L=Math.floor(b))+1,P=(T=Math.floor(u))+1;else{for(var z=k-L,I=this._root,D,R;L>b||b>=k||T>u||u>=P;)switch(R=(u<T)<<1|b<L,D=new Array(4),D[R]=I,I=D,z*=2,R){case 0:k=L+z,P=T+z;break;case 1:L=k-z,P=T+z;break;case 2:k=L+z,T=P-z;break;case 3:L=k-z,T=P-z;break}this._root&&this._root.length&&(this._root=I)}return this._x0=L,this._y0=T,this._x1=k,this._y1=P,this}function a(){var b=[];return this.visit(function(u){if(!u.length)do b.push(u.data);while(u=u.next)}),b}function n(b){return arguments.length?this.cover(+b[0][0],+b[0][1]).cover(+b[1][0],+b[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function r(b,u,L,T,k){this.node=b,this.x0=u,this.y0=L,this.x1=T,this.y1=k}function t(b,u,L){var T,k=this._x0,P=this._y0,z,I,D,R,O=this._x1,F=this._y1,N=[],G=this._root,K,W;for(G&&N.push(new r(G,k,P,O,F)),L==null?L=1/0:(k=b-L,P=u-L,O=b+L,F=u+L,L*=L);K=N.pop();)if(!(!(G=K.node)||(z=K.x0)>O||(I=K.y0)>F||(D=K.x1)<k||(R=K.y1)<P))if(G.length){var Y=(z+D)/2,re=(I+R)/2;N.push(new r(G[3],Y,re,D,R),new r(G[2],z,re,Y,R),new r(G[1],Y,I,D,re),new r(G[0],z,I,Y,re)),(W=(u>=re)<<1|b>=Y)&&(K=N[N.length-1],N[N.length-1]=N[N.length-1-W],N[N.length-1-W]=K)}else{var ue=b-+this._x.call(null,G.data),j=u-+this._y.call(null,G.data),q=ue*ue+j*j;if(q<L){var H=Math.sqrt(L=q);k=b-H,P=u-H,O=b+H,F=u+H,T=G.data}}return T}function h(b){if(isNaN(O=+this._x.call(null,b))||isNaN(F=+this._y.call(null,b)))return this;var u,L=this._root,T,k,P,z=this._x0,I=this._y0,D=this._x1,R=this._y1,O,F,N,G,K,W,Y,re;if(!L)return this;if(L.length)for(;;){if((K=O>=(N=(z+D)/2))?z=N:D=N,(W=F>=(G=(I+R)/2))?I=G:R=G,u=L,!(L=L[Y=W<<1|K]))return this;if(!L.length)break;(u[Y+1&3]||u[Y+2&3]||u[Y+3&3])&&(T=u,re=Y)}for(;L.data!==b;)if(k=L,!(L=L.next))return this;return(P=L.next)&&delete L.next,k?(P?k.next=P:delete k.next,this):u?(P?u[Y]=P:delete u[Y],(L=u[0]||u[1]||u[2]||u[3])&&L===(u[3]||u[2]||u[1]||u[0])&&!L.length&&(T?T[re]=L:this._root=L),this):(this._root=P,this)}function s(b){for(var u=0,L=b.length;u<L;++u)this.remove(b[u]);return this}function i(){return this._root}function x(){var b=0;return this.visit(function(u){if(!u.length)do++b;while(u=u.next)}),b}function p(b){var u=[],L,T=this._root,k,P,z,I,D;for(T&&u.push(new r(T,this._x0,this._y0,this._x1,this._y1));L=u.pop();)if(!b(T=L.node,P=L.x0,z=L.y0,I=L.x1,D=L.y1)&&T.length){var R=(P+I)/2,O=(z+D)/2;(k=T[3])&&u.push(new r(k,R,O,I,D)),(k=T[2])&&u.push(new r(k,P,O,R,D)),(k=T[1])&&u.push(new r(k,R,z,I,O)),(k=T[0])&&u.push(new r(k,P,z,R,O))}return this}function v(b){var u=[],L=[],T;for(this._root&&u.push(new r(this._root,this._x0,this._y0,this._x1,this._y1));T=u.pop();){var k=T.node;if(k.length){var P,z=T.x0,I=T.y0,D=T.x1,R=T.y1,O=(z+D)/2,F=(I+R)/2;(P=k[0])&&u.push(new r(P,z,I,O,F)),(P=k[1])&&u.push(new r(P,O,I,D,F)),(P=k[2])&&u.push(new r(P,z,F,O,R)),(P=k[3])&&u.push(new r(P,O,F,D,R))}L.push(T)}for(;T=L.pop();)b(T.node,T.x0,T.y0,T.x1,T.y1);return this}function f(b){return b[0]}function d(b){return arguments.length?(this._x=b,this):this._x}function o(b){return b[1]}function m(b){return arguments.length?(this._y=b,this):this._y}function l(b,u,L){var T=new w(u??f,L??o,NaN,NaN,NaN,NaN);return b==null?T:T.addAll(b)}function w(b,u,L,T,k,P){this._x=b,this._y=u,this._x0=L,this._y0=T,this._x1=k,this._y1=P,this._root=void 0}function _(b){for(var u={data:b.data},L=u;b=b.next;)L=L.next={data:b.data};return u}var c=l.prototype=w.prototype;c.copy=function(){var b=new w(this._x,this._y,this._x0,this._y0,this._x1,this._y1),u=this._root,L,T;if(!u)return b;if(!u.length)return b._root=_(u),b;for(L=[{source:u,target:b._root=new Array(4)}];u=L.pop();)for(var k=0;k<4;++k)(T=u.source[k])&&(T.length?L.push({source:T,target:u.target[k]=new Array(4)}):u.target[k]=_(T));return b},c.add=g,c.addAll=M,c.cover=e,c.data=a,c.extent=n,c.find=t,c.remove=h,c.removeAll=s,c.root=i,c.size=x,c.visit=p,c.visitAfter=v,c.x=d,c.y=m,A.quadtree=l,Object.defineProperty(A,"__esModule",{value:!0})})},{}],119:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,y("d3-path")):(A=A||self,g(A.d3=A.d3||{},A.d3))})(this,function(A,g){function S(et){return function(){return et}}var M=Math.abs,e=Math.atan2,a=Math.cos,n=Math.max,r=Math.min,t=Math.sin,h=Math.sqrt,s=1e-12,i=Math.PI,x=i/2,p=2*i;function v(et){return et>1?0:et<-1?i:Math.acos(et)}function f(et){return et>=1?x:et<=-1?-x:Math.asin(et)}function d(et){return et.innerRadius}function o(et){return et.outerRadius}function m(et){return et.startAngle}function l(et){return et.endAngle}function w(et){return et&&et.padAngle}function _(et,Lt,Zt,or,Ir,Or,Er,wr){var Gr=Zt-et,wn=or-Lt,cn=Er-Ir,Bn=wr-Or,En=Bn*Gr-cn*wn;if(!(En*En<s))return En=(cn*(Lt-Or)-Bn*(et-Ir))/En,[et+En*Gr,Lt+En*wn]}function c(et,Lt,Zt,or,Ir,Or,Er){var wr=et-Zt,Gr=Lt-or,wn=(Er?Or:-Or)/h(wr*wr+Gr*Gr),cn=wn*Gr,Bn=-wn*wr,En=et+cn,Yn=Lt+Bn,Vn=Zt+cn,pa=or+Bn,Ma=(En+Vn)/2,ci=(Yn+pa)/2,Va=Vn-En,ja=pa-Yn,Wa=Va*Va+ja*ja,Tr=Ir-Or,pn=En*pa-Vn*Yn,fn=(ja<0?-1:1)*h(n(0,Tr*Tr*Wa-pn*pn)),An=(pn*ja-Va*fn)/Wa,Zn=(-pn*Va-ja*fn)/Wa,ua=(pn*ja+Va*fn)/Wa,ea=(-pn*Va+ja*fn)/Wa,Rn=An-Ma,Xn=Zn-ci,Ua=ua-Ma,li=ea-ci;return Rn*Rn+Xn*Xn>Ua*Ua+li*li&&(An=ua,Zn=ea),{cx:An,cy:Zn,x01:-cn,y01:-Bn,x11:An*(Ir/Tr-1),y11:Zn*(Ir/Tr-1)}}function b(){var et=d,Lt=o,Zt=S(0),or=null,Ir=m,Or=l,Er=w,wr=null;function Gr(){var wn,cn,Bn=+et.apply(this,arguments),En=+Lt.apply(this,arguments),Yn=Ir.apply(this,arguments)-x,Vn=Or.apply(this,arguments)-x,pa=M(Vn-Yn),Ma=Vn>Yn;if(wr||(wr=wn=g.path()),En<Bn&&(cn=En,En=Bn,Bn=cn),!(En>s))wr.moveTo(0,0);else if(pa>p-s)wr.moveTo(En*a(Yn),En*t(Yn)),wr.arc(0,0,En,Yn,Vn,!Ma),Bn>s&&(wr.moveTo(Bn*a(Vn),Bn*t(Vn)),wr.arc(0,0,Bn,Vn,Yn,Ma));else{var ci=Yn,Va=Vn,ja=Yn,Wa=Vn,Tr=pa,pn=pa,fn=Er.apply(this,arguments)/2,An=fn>s&&(or?+or.apply(this,arguments):h(Bn*Bn+En*En)),Zn=r(M(En-Bn)/2,+Zt.apply(this,arguments)),ua=Zn,ea=Zn,Rn,Xn;if(An>s){var Ua=f(An/Bn*t(fn)),li=f(An/En*t(fn));(Tr-=Ua*2)>s?(Ua*=Ma?1:-1,ja+=Ua,Wa-=Ua):(Tr=0,ja=Wa=(Yn+Vn)/2),(pn-=li*2)>s?(li*=Ma?1:-1,ci+=li,Va-=li):(pn=0,ci=Va=(Yn+Vn)/2)}var Ht=En*a(ci),hr=En*t(ci),rn=Bn*a(Wa),vn=Bn*t(Wa);if(Zn>s){var en=En*a(Va),Tn=En*t(Va),xn=Bn*a(ja),un=Bn*t(ja),yr;if(pa<i&&(yr=_(Ht,hr,xn,un,en,Tn,rn,vn))){var mr=Ht-yr[0],zr=hr-yr[1],gn=en-yr[0],On=Tn-yr[1],ta=1/t(v((mr*gn+zr*On)/(h(mr*mr+zr*zr)*h(gn*gn+On*On)))/2),_n=h(yr[0]*yr[0]+yr[1]*yr[1]);ua=r(Zn,(Bn-_n)/(ta-1)),ea=r(Zn,(En-_n)/(ta+1))}}pn>s?ea>s?(Rn=c(xn,un,Ht,hr,En,ea,Ma),Xn=c(en,Tn,rn,vn,En,ea,Ma),wr.moveTo(Rn.cx+Rn.x01,Rn.cy+Rn.y01),ea<Zn?wr.arc(Rn.cx,Rn.cy,ea,e(Rn.y01,Rn.x01),e(Xn.y01,Xn.x01),!Ma):(wr.arc(Rn.cx,Rn.cy,ea,e(Rn.y01,Rn.x01),e(Rn.y11,Rn.x11),!Ma),wr.arc(0,0,En,e(Rn.cy+Rn.y11,Rn.cx+Rn.x11),e(Xn.cy+Xn.y11,Xn.cx+Xn.x11),!Ma),wr.arc(Xn.cx,Xn.cy,ea,e(Xn.y11,Xn.x11),e(Xn.y01,Xn.x01),!Ma))):(wr.moveTo(Ht,hr),wr.arc(0,0,En,ci,Va,!Ma)):wr.moveTo(Ht,hr),!(Bn>s)||!(Tr>s)?wr.lineTo(rn,vn):ua>s?(Rn=c(rn,vn,en,Tn,Bn,-ua,Ma),Xn=c(Ht,hr,xn,un,Bn,-ua,Ma),wr.lineTo(Rn.cx+Rn.x01,Rn.cy+Rn.y01),ua<Zn?wr.arc(Rn.cx,Rn.cy,ua,e(Rn.y01,Rn.x01),e(Xn.y01,Xn.x01),!Ma):(wr.arc(Rn.cx,Rn.cy,ua,e(Rn.y01,Rn.x01),e(Rn.y11,Rn.x11),!Ma),wr.arc(0,0,Bn,e(Rn.cy+Rn.y11,Rn.cx+Rn.x11),e(Xn.cy+Xn.y11,Xn.cx+Xn.x11),Ma),wr.arc(Xn.cx,Xn.cy,ua,e(Xn.y11,Xn.x11),e(Xn.y01,Xn.x01),!Ma))):wr.arc(0,0,Bn,Wa,ja,Ma)}if(wr.closePath(),wn)return wr=null,wn+""||null}return Gr.centroid=function(){var wn=(+et.apply(this,arguments)+ +Lt.apply(this,arguments))/2,cn=(+Ir.apply(this,arguments)+ +Or.apply(this,arguments))/2-i/2;return[a(cn)*wn,t(cn)*wn]},Gr.innerRadius=function(wn){return arguments.length?(et=typeof wn=="function"?wn:S(+wn),Gr):et},Gr.outerRadius=function(wn){return arguments.length?(Lt=typeof wn=="function"?wn:S(+wn),Gr):Lt},Gr.cornerRadius=function(wn){return arguments.length?(Zt=typeof wn=="function"?wn:S(+wn),Gr):Zt},Gr.padRadius=function(wn){return arguments.length?(or=wn==null?null:typeof wn=="function"?wn:S(+wn),Gr):or},Gr.startAngle=function(wn){return arguments.length?(Ir=typeof wn=="function"?wn:S(+wn),Gr):Ir},Gr.endAngle=function(wn){return arguments.length?(Or=typeof wn=="function"?wn:S(+wn),Gr):Or},Gr.padAngle=function(wn){return arguments.length?(Er=typeof wn=="function"?wn:S(+wn),Gr):Er},Gr.context=function(wn){return arguments.length?(wr=wn??null,Gr):wr},Gr}function u(et){this._context=et}u.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(et,Lt){switch(et=+et,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(et,Lt):this._context.moveTo(et,Lt);break;case 1:this._point=2;default:this._context.lineTo(et,Lt);break}}};function L(et){return new u(et)}function T(et){return et[0]}function k(et){return et[1]}function P(){var et=T,Lt=k,Zt=S(!0),or=null,Ir=L,Or=null;function Er(wr){var Gr,wn=wr.length,cn,Bn=!1,En;for(or==null&&(Or=Ir(En=g.path())),Gr=0;Gr<=wn;++Gr)!(Gr<wn&&Zt(cn=wr[Gr],Gr,wr))===Bn&&((Bn=!Bn)?Or.lineStart():Or.lineEnd()),Bn&&Or.point(+et(cn,Gr,wr),+Lt(cn,Gr,wr));if(En)return Or=null,En+""||null}return Er.x=function(wr){return arguments.length?(et=typeof wr=="function"?wr:S(+wr),Er):et},Er.y=function(wr){return arguments.length?(Lt=typeof wr=="function"?wr:S(+wr),Er):Lt},Er.defined=function(wr){return arguments.length?(Zt=typeof wr=="function"?wr:S(!!wr),Er):Zt},Er.curve=function(wr){return arguments.length?(Ir=wr,or!=null&&(Or=Ir(or)),Er):Ir},Er.context=function(wr){return arguments.length?(wr==null?or=Or=null:Or=Ir(or=wr),Er):or},Er}function z(){var et=T,Lt=null,Zt=S(0),or=k,Ir=S(!0),Or=null,Er=L,wr=null;function Gr(cn){var Bn,En,Yn,Vn=cn.length,pa,Ma=!1,ci,Va=new Array(Vn),ja=new Array(Vn);for(Or==null&&(wr=Er(ci=g.path())),Bn=0;Bn<=Vn;++Bn){if(!(Bn<Vn&&Ir(pa=cn[Bn],Bn,cn))===Ma)if(Ma=!Ma)En=Bn,wr.areaStart(),wr.lineStart();else{for(wr.lineEnd(),wr.lineStart(),Yn=Bn-1;Yn>=En;--Yn)wr.point(Va[Yn],ja[Yn]);wr.lineEnd(),wr.areaEnd()}Ma&&(Va[Bn]=+et(pa,Bn,cn),ja[Bn]=+Zt(pa,Bn,cn),wr.point(Lt?+Lt(pa,Bn,cn):Va[Bn],or?+or(pa,Bn,cn):ja[Bn]))}if(ci)return wr=null,ci+""||null}function wn(){return P().defined(Ir).curve(Er).context(Or)}return Gr.x=function(cn){return arguments.length?(et=typeof cn=="function"?cn:S(+cn),Lt=null,Gr):et},Gr.x0=function(cn){return arguments.length?(et=typeof cn=="function"?cn:S(+cn),Gr):et},Gr.x1=function(cn){return arguments.length?(Lt=cn==null?null:typeof cn=="function"?cn:S(+cn),Gr):Lt},Gr.y=function(cn){return arguments.length?(Zt=typeof cn=="function"?cn:S(+cn),or=null,Gr):Zt},Gr.y0=function(cn){return arguments.length?(Zt=typeof cn=="function"?cn:S(+cn),Gr):Zt},Gr.y1=function(cn){return arguments.length?(or=cn==null?null:typeof cn=="function"?cn:S(+cn),Gr):or},Gr.lineX0=Gr.lineY0=function(){return wn().x(et).y(Zt)},Gr.lineY1=function(){return wn().x(et).y(or)},Gr.lineX1=function(){return wn().x(Lt).y(Zt)},Gr.defined=function(cn){return arguments.length?(Ir=typeof cn=="function"?cn:S(!!cn),Gr):Ir},Gr.curve=function(cn){return arguments.length?(Er=cn,Or!=null&&(wr=Er(Or)),Gr):Er},Gr.context=function(cn){return arguments.length?(cn==null?Or=wr=null:wr=Er(Or=cn),Gr):Or},Gr}function I(et,Lt){return Lt<et?-1:Lt>et?1:Lt>=et?0:NaN}function D(et){return et}function R(){var et=D,Lt=I,Zt=null,or=S(0),Ir=S(p),Or=S(0);function Er(wr){var Gr,wn=wr.length,cn,Bn,En=0,Yn=new Array(wn),Vn=new Array(wn),pa=+or.apply(this,arguments),Ma=Math.min(p,Math.max(-p,Ir.apply(this,arguments)-pa)),ci,Va=Math.min(Math.abs(Ma)/wn,Or.apply(this,arguments)),ja=Va*(Ma<0?-1:1),Wa;for(Gr=0;Gr<wn;++Gr)(Wa=Vn[Yn[Gr]=Gr]=+et(wr[Gr],Gr,wr))>0&&(En+=Wa);for(Lt!=null?Yn.sort(function(Tr,pn){return Lt(Vn[Tr],Vn[pn])}):Zt!=null&&Yn.sort(function(Tr,pn){return Zt(wr[Tr],wr[pn])}),Gr=0,Bn=En?(Ma-wn*ja)/En:0;Gr<wn;++Gr,pa=ci)cn=Yn[Gr],Wa=Vn[cn],ci=pa+(Wa>0?Wa*Bn:0)+ja,Vn[cn]={data:wr[cn],index:Gr,value:Wa,startAngle:pa,endAngle:ci,padAngle:Va};return Vn}return Er.value=function(wr){return arguments.length?(et=typeof wr=="function"?wr:S(+wr),Er):et},Er.sortValues=function(wr){return arguments.length?(Lt=wr,Zt=null,Er):Lt},Er.sort=function(wr){return arguments.length?(Zt=wr,Lt=null,Er):Zt},Er.startAngle=function(wr){return arguments.length?(or=typeof wr=="function"?wr:S(+wr),Er):or},Er.endAngle=function(wr){return arguments.length?(Ir=typeof wr=="function"?wr:S(+wr),Er):Ir},Er.padAngle=function(wr){return arguments.length?(Or=typeof wr=="function"?wr:S(+wr),Er):Or},Er}var O=N(L);function F(et){this._curve=et}F.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(et,Lt){this._curve.point(Lt*Math.sin(et),Lt*-Math.cos(et))}};function N(et){function Lt(Zt){return new F(et(Zt))}return Lt._curve=et,Lt}function G(et){var Lt=et.curve;return et.angle=et.x,delete et.x,et.radius=et.y,delete et.y,et.curve=function(Zt){return arguments.length?Lt(N(Zt)):Lt()._curve},et}function K(){return G(P().curve(O))}function W(){var et=z().curve(O),Lt=et.curve,Zt=et.lineX0,or=et.lineX1,Ir=et.lineY0,Or=et.lineY1;return et.angle=et.x,delete et.x,et.startAngle=et.x0,delete et.x0,et.endAngle=et.x1,delete et.x1,et.radius=et.y,delete et.y,et.innerRadius=et.y0,delete et.y0,et.outerRadius=et.y1,delete et.y1,et.lineStartAngle=function(){return G(Zt())},delete et.lineX0,et.lineEndAngle=function(){return G(or())},delete et.lineX1,et.lineInnerRadius=function(){return G(Ir())},delete et.lineY0,et.lineOuterRadius=function(){return G(Or())},delete et.lineY1,et.curve=function(Er){return arguments.length?Lt(N(Er)):Lt()._curve},et}function Y(et,Lt){return[(Lt=+Lt)*Math.cos(et-=Math.PI/2),Lt*Math.sin(et)]}var re=Array.prototype.slice;function ue(et){return et.source}function j(et){return et.target}function q(et){var Lt=ue,Zt=j,or=T,Ir=k,Or=null;function Er(){var wr,Gr=re.call(arguments),wn=Lt.apply(this,Gr),cn=Zt.apply(this,Gr);if(Or||(Or=wr=g.path()),et(Or,+or.apply(this,(Gr[0]=wn,Gr)),+Ir.apply(this,Gr),+or.apply(this,(Gr[0]=cn,Gr)),+Ir.apply(this,Gr)),wr)return Or=null,wr+""||null}return Er.source=function(wr){return arguments.length?(Lt=wr,Er):Lt},Er.target=function(wr){return arguments.length?(Zt=wr,Er):Zt},Er.x=function(wr){return arguments.length?(or=typeof wr=="function"?wr:S(+wr),Er):or},Er.y=function(wr){return arguments.length?(Ir=typeof wr=="function"?wr:S(+wr),Er):Ir},Er.context=function(wr){return arguments.length?(Or=wr??null,Er):Or},Er}function H(et,Lt,Zt,or,Ir){et.moveTo(Lt,Zt),et.bezierCurveTo(Lt=(Lt+or)/2,Zt,Lt,Ir,or,Ir)}function U(et,Lt,Zt,or,Ir){et.moveTo(Lt,Zt),et.bezierCurveTo(Lt,Zt=(Zt+Ir)/2,or,Zt,or,Ir)}function $(et,Lt,Zt,or,Ir){var Or=Y(Lt,Zt),Er=Y(Lt,Zt=(Zt+Ir)/2),wr=Y(or,Zt),Gr=Y(or,Ir);et.moveTo(Or[0],Or[1]),et.bezierCurveTo(Er[0],Er[1],wr[0],wr[1],Gr[0],Gr[1])}function ne(){return q(H)}function X(){return q(U)}function Q(){var et=q($);return et.angle=et.x,delete et.x,et.radius=et.y,delete et.y,et}var ie={draw:function(et,Lt){var Zt=Math.sqrt(Lt/i);et.moveTo(Zt,0),et.arc(0,0,Zt,0,p)}},se={draw:function(et,Lt){var Zt=Math.sqrt(Lt/5)/2;et.moveTo(-3*Zt,-Zt),et.lineTo(-Zt,-Zt),et.lineTo(-Zt,-3*Zt),et.lineTo(Zt,-3*Zt),et.lineTo(Zt,-Zt),et.lineTo(3*Zt,-Zt),et.lineTo(3*Zt,Zt),et.lineTo(Zt,Zt),et.lineTo(Zt,3*Zt),et.lineTo(-Zt,3*Zt),et.lineTo(-Zt,Zt),et.lineTo(-3*Zt,Zt),et.closePath()}},ae=Math.sqrt(1/3),oe=ae*2,be={draw:function(et,Lt){var Zt=Math.sqrt(Lt/oe),or=Zt*ae;et.moveTo(0,-Zt),et.lineTo(or,0),et.lineTo(0,Zt),et.lineTo(-or,0),et.closePath()}},ce=.8908130915292852,de=Math.sin(i/10)/Math.sin(7*i/10),ye=Math.sin(p/10)*de,ge=-Math.cos(p/10)*de,me={draw:function(et,Lt){var Zt=Math.sqrt(Lt*ce),or=ye*Zt,Ir=ge*Zt;et.moveTo(0,-Zt),et.lineTo(or,Ir);for(var Or=1;Or<5;++Or){var Er=p*Or/5,wr=Math.cos(Er),Gr=Math.sin(Er);et.lineTo(Gr*Zt,-wr*Zt),et.lineTo(wr*or-Gr*Ir,Gr*or+wr*Ir)}et.closePath()}},Ee={draw:function(et,Lt){var Zt=Math.sqrt(Lt),or=-Zt/2;et.rect(or,or,Zt,Zt)}},Pe=Math.sqrt(3),Ue={draw:function(et,Lt){var Zt=-Math.sqrt(Lt/(Pe*3));et.moveTo(0,Zt*2),et.lineTo(-Pe*Zt,-Zt),et.lineTo(Pe*Zt,-Zt),et.closePath()}},we=-.5,ke=Math.sqrt(3)/2,Xe=1/Math.sqrt(12),Ve=(Xe/2+1)*3,Ie={draw:function(et,Lt){var Zt=Math.sqrt(Lt/Ve),or=Zt/2,Ir=Zt*Xe,Or=or,Er=Zt*Xe+Zt,wr=-Or,Gr=Er;et.moveTo(or,Ir),et.lineTo(Or,Er),et.lineTo(wr,Gr),et.lineTo(we*or-ke*Ir,ke*or+we*Ir),et.lineTo(we*Or-ke*Er,ke*Or+we*Er),et.lineTo(we*wr-ke*Gr,ke*wr+we*Gr),et.lineTo(we*or+ke*Ir,we*Ir-ke*or),et.lineTo(we*Or+ke*Er,we*Er-ke*Or),et.lineTo(we*wr+ke*Gr,we*Gr-ke*wr),et.closePath()}},De=[ie,se,be,Ee,me,Ue,Ie];function Ye(){var et=S(ie),Lt=S(64),Zt=null;function or(){var Ir;if(Zt||(Zt=Ir=g.path()),et.apply(this,arguments).draw(Zt,+Lt.apply(this,arguments)),Ir)return Zt=null,Ir+""||null}return or.type=function(Ir){return arguments.length?(et=typeof Ir=="function"?Ir:S(Ir),or):et},or.size=function(Ir){return arguments.length?(Lt=typeof Ir=="function"?Ir:S(+Ir),or):Lt},or.context=function(Ir){return arguments.length?(Zt=Ir??null,or):Zt},or}function vt(){}function Dt(et,Lt,Zt){et._context.bezierCurveTo((2*et._x0+et._x1)/3,(2*et._y0+et._y1)/3,(et._x0+2*et._x1)/3,(et._y0+2*et._y1)/3,(et._x0+4*et._x1+Lt)/6,(et._y0+4*et._y1+Zt)/6)}function Kt(et){this._context=et}Kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Dt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(et,Lt){switch(et=+et,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(et,Lt):this._context.moveTo(et,Lt);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Dt(this,et,Lt);break}this._x0=this._x1,this._x1=et,this._y0=this._y1,this._y1=Lt}};function Ft(et){return new Kt(et)}function Mt(et){this._context=et}Mt.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(et,Lt){switch(et=+et,Lt=+Lt,this._point){case 0:this._point=1,this._x2=et,this._y2=Lt;break;case 1:this._point=2,this._x3=et,this._y3=Lt;break;case 2:this._point=3,this._x4=et,this._y4=Lt,this._context.moveTo((this._x0+4*this._x1+et)/6,(this._y0+4*this._y1+Lt)/6);break;default:Dt(this,et,Lt);break}this._x0=this._x1,this._x1=et,this._y0=this._y1,this._y1=Lt}};function Xt(et){return new Mt(et)}function It(et){this._context=et}It.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(et,Lt){switch(et=+et,Lt=+Lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var Zt=(this._x0+4*this._x1+et)/6,or=(this._y0+4*this._y1+Lt)/6;this._line?this._context.lineTo(Zt,or):this._context.moveTo(Zt,or);break;case 3:this._point=4;default:Dt(this,et,Lt);break}this._x0=this._x1,this._x1=et,this._y0=this._y1,this._y1=Lt}};function At(et){return new It(et)}function Ge(et,Lt){this._basis=new Kt(et),this._beta=Lt}Ge.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var et=this._x,Lt=this._y,Zt=et.length-1;if(Zt>0)for(var or=et[0],Ir=Lt[0],Or=et[Zt]-or,Er=Lt[Zt]-Ir,wr=-1,Gr;++wr<=Zt;)Gr=wr/Zt,this._basis.point(this._beta*et[wr]+(1-this._beta)*(or+Gr*Or),this._beta*Lt[wr]+(1-this._beta)*(Ir+Gr*Er));this._x=this._y=null,this._basis.lineEnd()},point:function(et,Lt){this._x.push(+et),this._y.push(+Lt)}};var tt=function et(Lt){function Zt(or){return Lt===1?new Kt(or):new Ge(or,Lt)}return Zt.beta=function(or){return et(+or)},Zt}(.85);function He(et,Lt,Zt){et._context.bezierCurveTo(et._x1+et._k*(et._x2-et._x0),et._y1+et._k*(et._y2-et._y0),et._x2+et._k*(et._x1-Lt),et._y2+et._k*(et._y1-Zt),et._x2,et._y2)}function Ae(et,Lt){this._context=et,this._k=(1-Lt)/6}Ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:He(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(et,Lt){switch(et=+et,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(et,Lt):this._context.moveTo(et,Lt);break;case 1:this._point=2,this._x1=et,this._y1=Lt;break;case 2:this._point=3;default:He(this,et,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=et,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var Ne=function et(Lt){function Zt(or){return new Ae(or,Lt)}return Zt.tension=function(or){return et(+or)},Zt}(0);function Ze(et,Lt){this._context=et,this._k=(1-Lt)/6}Ze.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(et,Lt){switch(et=+et,Lt=+Lt,this._point){case 0:this._point=1,this._x3=et,this._y3=Lt;break;case 1:this._point=2,this._context.moveTo(this._x4=et,this._y4=Lt);break;case 2:this._point=3,this._x5=et,this._y5=Lt;break;default:He(this,et,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=et,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var Qe=function et(Lt){function Zt(or){return new Ze(or,Lt)}return Zt.tension=function(or){return et(+or)},Zt}(0);function bt(et,Lt){this._context=et,this._k=(1-Lt)/6}bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(et,Lt){switch(et=+et,Lt=+Lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:He(this,et,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=et,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var dt=function et(Lt){function Zt(or){return new bt(or,Lt)}return Zt.tension=function(or){return et(+or)},Zt}(0);function wt(et,Lt,Zt){var or=et._x1,Ir=et._y1,Or=et._x2,Er=et._y2;if(et._l01_a>s){var wr=2*et._l01_2a+3*et._l01_a*et._l12_a+et._l12_2a,Gr=3*et._l01_a*(et._l01_a+et._l12_a);or=(or*wr-et._x0*et._l12_2a+et._x2*et._l01_2a)/Gr,Ir=(Ir*wr-et._y0*et._l12_2a+et._y2*et._l01_2a)/Gr}if(et._l23_a>s){var wn=2*et._l23_2a+3*et._l23_a*et._l12_a+et._l12_2a,cn=3*et._l23_a*(et._l23_a+et._l12_a);Or=(Or*wn+et._x1*et._l23_2a-Lt*et._l12_2a)/cn,Er=(Er*wn+et._y1*et._l23_2a-Zt*et._l12_2a)/cn}et._context.bezierCurveTo(or,Ir,Or,Er,et._x2,et._y2)}function Ut(et,Lt){this._context=et,this._alpha=Lt}Ut.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(et,Lt){if(et=+et,Lt=+Lt,this._point){var Zt=this._x2-et,or=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Zt*Zt+or*or,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(et,Lt):this._context.moveTo(et,Lt);break;case 1:this._point=2;break;case 2:this._point=3;default:wt(this,et,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=et,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var Rt=function et(Lt){function Zt(or){return Lt?new Ut(or,Lt):new Ae(or,0)}return Zt.alpha=function(or){return et(+or)},Zt}(.5);function Nt(et,Lt){this._context=et,this._alpha=Lt}Nt.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(et,Lt){if(et=+et,Lt=+Lt,this._point){var Zt=this._x2-et,or=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Zt*Zt+or*or,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=et,this._y3=Lt;break;case 1:this._point=2,this._context.moveTo(this._x4=et,this._y4=Lt);break;case 2:this._point=3,this._x5=et,this._y5=Lt;break;default:wt(this,et,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=et,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var Wt=function et(Lt){function Zt(or){return Lt?new Nt(or,Lt):new Ze(or,0)}return Zt.alpha=function(or){return et(+or)},Zt}(.5);function Vt(et,Lt){this._context=et,this._alpha=Lt}Vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(et,Lt){if(et=+et,Lt=+Lt,this._point){var Zt=this._x2-et,or=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Zt*Zt+or*or,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:wt(this,et,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=et,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var ir=function et(Lt){function Zt(or){return Lt?new Vt(or,Lt):new bt(or,0)}return Zt.alpha=function(or){return et(+or)},Zt}(.5);function Hr(et){this._context=et}Hr.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(et,Lt){et=+et,Lt=+Lt,this._point?this._context.lineTo(et,Lt):(this._point=1,this._context.moveTo(et,Lt))}};function sn(et){return new Hr(et)}function jr(et){return et<0?-1:1}function at(et,Lt,Zt){var or=et._x1-et._x0,Ir=Lt-et._x1,Or=(et._y1-et._y0)/(or||Ir<0&&-0),Er=(Zt-et._y1)/(Ir||or<0&&-0),wr=(Or*Ir+Er*or)/(or+Ir);return(jr(Or)+jr(Er))*Math.min(Math.abs(Or),Math.abs(Er),.5*Math.abs(wr))||0}function $t(et,Lt){var Zt=et._x1-et._x0;return Zt?(3*(et._y1-et._y0)/Zt-Lt)/2:Lt}function Jt(et,Lt,Zt){var or=et._x0,Ir=et._y0,Or=et._x1,Er=et._y1,wr=(Or-or)/3;et._context.bezierCurveTo(or+wr,Ir+wr*Lt,Or-wr,Er-wr*Zt,Or,Er)}function Gt(et){this._context=et}Gt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jt(this,this._t0,$t(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(et,Lt){var Zt=NaN;if(et=+et,Lt=+Lt,!(et===this._x1&&Lt===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(et,Lt):this._context.moveTo(et,Lt);break;case 1:this._point=2;break;case 2:this._point=3,Jt(this,$t(this,Zt=at(this,et,Lt)),Zt);break;default:Jt(this,this._t0,Zt=at(this,et,Lt));break}this._x0=this._x1,this._x1=et,this._y0=this._y1,this._y1=Lt,this._t0=Zt}}};function _r(et){this._context=new rt(et)}(_r.prototype=Object.create(Gt.prototype)).point=function(et,Lt){Gt.prototype.point.call(this,Lt,et)};function rt(et){this._context=et}rt.prototype={moveTo:function(et,Lt){this._context.moveTo(Lt,et)},closePath:function(){this._context.closePath()},lineTo:function(et,Lt){this._context.lineTo(Lt,et)},bezierCurveTo:function(et,Lt,Zt,or,Ir,Or){this._context.bezierCurveTo(Lt,et,or,Zt,Or,Ir)}};function Je(et){return new Gt(et)}function st(et){return new _r(et)}function lt(et){this._context=et}lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var et=this._x,Lt=this._y,Zt=et.length;if(Zt)if(this._line?this._context.lineTo(et[0],Lt[0]):this._context.moveTo(et[0],Lt[0]),Zt===2)this._context.lineTo(et[1],Lt[1]);else for(var or=Tt(et),Ir=Tt(Lt),Or=0,Er=1;Er<Zt;++Or,++Er)this._context.bezierCurveTo(or[0][Or],Ir[0][Or],or[1][Or],Ir[1][Or],et[Er],Lt[Er]);(this._line||this._line!==0&&Zt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(et,Lt){this._x.push(+et),this._y.push(+Lt)}};function Tt(et){var Lt,Zt=et.length-1,or,Ir=new Array(Zt),Or=new Array(Zt),Er=new Array(Zt);for(Ir[0]=0,Or[0]=2,Er[0]=et[0]+2*et[1],Lt=1;Lt<Zt-1;++Lt)Ir[Lt]=1,Or[Lt]=4,Er[Lt]=4*et[Lt]+2*et[Lt+1];for(Ir[Zt-1]=2,Or[Zt-1]=7,Er[Zt-1]=8*et[Zt-1]+et[Zt],Lt=1;Lt<Zt;++Lt)or=Ir[Lt]/Or[Lt-1],Or[Lt]-=or,Er[Lt]-=or*Er[Lt-1];for(Ir[Zt-1]=Er[Zt-1]/Or[Zt-1],Lt=Zt-2;Lt>=0;--Lt)Ir[Lt]=(Er[Lt]-Ir[Lt+1])/Or[Lt];for(Or[Zt-1]=(et[Zt]+Ir[Zt-1])/2,Lt=0;Lt<Zt-1;++Lt)Or[Lt]=2*et[Lt+1]-Ir[Lt+1];return[Ir,Or]}function zt(et){return new lt(et)}function Ce(et,Lt){this._context=et,this._t=Lt}Ce.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(et,Lt){switch(et=+et,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(et,Lt):this._context.moveTo(et,Lt);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,Lt),this._context.lineTo(et,Lt);else{var Zt=this._x*(1-this._t)+et*this._t;this._context.lineTo(Zt,this._y),this._context.lineTo(Zt,Lt)}break}}this._x=et,this._y=Lt}};function Se(et){return new Ce(et,.5)}function nt(et){return new Ce(et,0)}function it(et){return new Ce(et,1)}function ct(et,Lt){if((Er=et.length)>1)for(var Zt=1,or,Ir,Or=et[Lt[0]],Er,wr=Or.length;Zt<Er;++Zt)for(Ir=Or,Or=et[Lt[Zt]],or=0;or<wr;++or)Or[or][1]+=Or[or][0]=isNaN(Ir[or][1])?Ir[or][0]:Ir[or][1]}function kt(et){for(var Lt=et.length,Zt=new Array(Lt);--Lt>=0;)Zt[Lt]=Lt;return Zt}function gt(et,Lt){return et[Lt]}function St(){var et=S([]),Lt=kt,Zt=ct,or=gt;function Ir(Or){var Er=et.apply(this,arguments),wr,Gr=Or.length,wn=Er.length,cn=new Array(wn),Bn;for(wr=0;wr<wn;++wr){for(var En=Er[wr],Yn=cn[wr]=new Array(Gr),Vn=0,pa;Vn<Gr;++Vn)Yn[Vn]=pa=[0,+or(Or[Vn],En,Vn,Or)],pa.data=Or[Vn];Yn.key=En}for(wr=0,Bn=Lt(cn);wr<wn;++wr)cn[Bn[wr]].index=wr;return Zt(cn,Bn),cn}return Ir.keys=function(Or){return arguments.length?(et=typeof Or=="function"?Or:S(re.call(Or)),Ir):et},Ir.value=function(Or){return arguments.length?(or=typeof Or=="function"?Or:S(+Or),Ir):or},Ir.order=function(Or){return arguments.length?(Lt=Or==null?kt:typeof Or=="function"?Or:S(re.call(Or)),Ir):Lt},Ir.offset=function(Or){return arguments.length?(Zt=Or??ct,Ir):Zt},Ir}function Yt(et,Lt){if((or=et.length)>0){for(var Zt,or,Ir=0,Or=et[0].length,Er;Ir<Or;++Ir){for(Er=Zt=0;Zt<or;++Zt)Er+=et[Zt][Ir][1]||0;if(Er)for(Zt=0;Zt<or;++Zt)et[Zt][Ir][1]/=Er}ct(et,Lt)}}function ar(et,Lt){if((Gr=et.length)>0)for(var Zt,or=0,Ir,Or,Er,wr,Gr,wn=et[Lt[0]].length;or<wn;++or)for(Er=wr=0,Zt=0;Zt<Gr;++Zt)(Or=(Ir=et[Lt[Zt]][or])[1]-Ir[0])>0?(Ir[0]=Er,Ir[1]=Er+=Or):Or<0?(Ir[1]=wr,Ir[0]=wr+=Or):(Ir[0]=0,Ir[1]=Or)}function kr(et,Lt){if((Ir=et.length)>0){for(var Zt=0,or=et[Lt[0]],Ir,Or=or.length;Zt<Or;++Zt){for(var Er=0,wr=0;Er<Ir;++Er)wr+=et[Er][Zt][1]||0;or[Zt][1]+=or[Zt][0]=-wr/2}ct(et,Lt)}}function br(et,Lt){if(!(!((Er=et.length)>0)||!((Or=(Ir=et[Lt[0]]).length)>0))){for(var Zt=0,or=1,Ir,Or,Er;or<Or;++or){for(var wr=0,Gr=0,wn=0;wr<Er;++wr){for(var cn=et[Lt[wr]],Bn=cn[or][1]||0,En=cn[or-1][1]||0,Yn=(Bn-En)/2,Vn=0;Vn<wr;++Vn){var pa=et[Lt[Vn]],Ma=pa[or][1]||0,ci=pa[or-1][1]||0;Yn+=Ma-ci}Gr+=Bn,wn+=Yn*Bn}Ir[or-1][1]+=Ir[or-1][0]=Zt,Gr&&(Zt-=wn/Gr)}Ir[or-1][1]+=Ir[or-1][0]=Zt,ct(et,Lt)}}function Mr(et){var Lt=et.map(Yr);return kt(et).sort(function(Zt,or){return Lt[Zt]-Lt[or]})}function Yr(et){for(var Lt=-1,Zt=0,or=et.length,Ir,Or=-1/0;++Lt<or;)(Ir=+et[Lt][1])>Or&&(Or=Ir,Zt=Lt);return Zt}function nr(et){var Lt=et.map(gr);return kt(et).sort(function(Zt,or){return Lt[Zt]-Lt[or]})}function gr(et){for(var Lt=0,Zt=-1,or=et.length,Ir;++Zt<or;)(Ir=+et[Zt][1])&&(Lt+=Ir);return Lt}function Rr(et){return nr(et).reverse()}function Br(et){var Lt=et.length,Zt,or,Ir=et.map(gr),Or=Mr(et),Er=0,wr=0,Gr=[],wn=[];for(Zt=0;Zt<Lt;++Zt)or=Or[Zt],Er<wr?(Er+=Ir[or],Gr.push(or)):(wr+=Ir[or],wn.push(or));return wn.reverse().concat(Gr)}function Sr(et){return kt(et).reverse()}A.arc=b,A.area=z,A.areaRadial=W,A.curveBasis=Ft,A.curveBasisClosed=Xt,A.curveBasisOpen=At,A.curveBundle=tt,A.curveCardinal=Ne,A.curveCardinalClosed=Qe,A.curveCardinalOpen=dt,A.curveCatmullRom=Rt,A.curveCatmullRomClosed=Wt,A.curveCatmullRomOpen=ir,A.curveLinear=L,A.curveLinearClosed=sn,A.curveMonotoneX=Je,A.curveMonotoneY=st,A.curveNatural=zt,A.curveStep=Se,A.curveStepAfter=it,A.curveStepBefore=nt,A.line=P,A.lineRadial=K,A.linkHorizontal=ne,A.linkRadial=Q,A.linkVertical=X,A.pie=R,A.pointRadial=Y,A.radialArea=W,A.radialLine=K,A.stack=St,A.stackOffsetDiverging=ar,A.stackOffsetExpand=Yt,A.stackOffsetNone=ct,A.stackOffsetSilhouette=kr,A.stackOffsetWiggle=br,A.stackOrderAppearance=Mr,A.stackOrderAscending=nr,A.stackOrderDescending=Rr,A.stackOrderInsideOut=Br,A.stackOrderNone=kt,A.stackOrderReverse=Sr,A.symbol=Ye,A.symbolCircle=ie,A.symbolCross=se,A.symbolDiamond=be,A.symbolSquare=Ee,A.symbolStar=me,A.symbolTriangle=Ue,A.symbolWye=Ie,A.symbols=De,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te,y("d3-time")):(A=A||self,g(A.d3=A.d3||{},A.d3))})(this,function(A,g){function S(Ge){if(0<=Ge.y&&Ge.y<100){var tt=new Date(-1,Ge.m,Ge.d,Ge.H,Ge.M,Ge.S,Ge.L);return tt.setFullYear(Ge.y),tt}return new Date(Ge.y,Ge.m,Ge.d,Ge.H,Ge.M,Ge.S,Ge.L)}function M(Ge){if(0<=Ge.y&&Ge.y<100){var tt=new Date(Date.UTC(-1,Ge.m,Ge.d,Ge.H,Ge.M,Ge.S,Ge.L));return tt.setUTCFullYear(Ge.y),tt}return new Date(Date.UTC(Ge.y,Ge.m,Ge.d,Ge.H,Ge.M,Ge.S,Ge.L))}function e(Ge,tt,He){return{y:Ge,m:tt,d:He,H:0,M:0,S:0,L:0}}function a(Ge){var tt=Ge.dateTime,He=Ge.date,Ae=Ge.time,Ne=Ge.periods,Ze=Ge.days,Qe=Ge.shortDays,bt=Ge.months,dt=Ge.shortMonths,wt=x(Ne),Ut=p(Ne),Rt=x(Ze),Nt=p(Ze),Wt=x(Qe),Vt=p(Qe),ir=x(bt),Hr=p(bt),sn=x(dt),jr=p(dt),at={a:it,A:ct,b:kt,B:gt,c:null,d:F,e:F,f:Y,H:N,I:G,j:K,L:W,m:re,M:ue,p:St,q:Yt,Q:Ye,s:vt,S:j,u:q,U:H,V:U,w:$,W:ne,x:null,X:null,y:X,Y:Q,Z:ie,"%":De},$t={a:ar,A:kr,b:br,B:Mr,c:null,d:se,e:se,f:de,H:ae,I:oe,j:be,L:ce,m:ye,M:ge,p:Yr,q:nr,Q:Ye,s:vt,S:me,u:Ee,U:Pe,V:Ue,w:we,W:ke,x:null,X:null,y:Xe,Y:Ve,Z:Ie,"%":De},Jt={a:st,A:lt,b:Tt,B:zt,c:Ce,d:u,e:u,f:I,H:T,I:T,j:L,L:z,m:b,M:k,p:Je,q:c,Q:R,s:O,S:P,u:f,U:d,V:o,w:v,W:m,x:Se,X:nt,y:w,Y:l,Z:_,"%":D};at.x=Gt(He,at),at.X=Gt(Ae,at),at.c=Gt(tt,at),$t.x=Gt(He,$t),$t.X=Gt(Ae,$t),$t.c=Gt(tt,$t);function Gt(gr,Rr){return function(Br){var Sr=[],et=-1,Lt=0,Zt=gr.length,or,Ir,Or;for(Br instanceof Date||(Br=new Date(+Br));++et<Zt;)gr.charCodeAt(et)===37&&(Sr.push(gr.slice(Lt,et)),(Ir=n[or=gr.charAt(++et)])!=null?or=gr.charAt(++et):Ir=or==="e"?" ":"0",(Or=Rr[or])&&(or=Or(Br,Ir)),Sr.push(or),Lt=et+1);return Sr.push(gr.slice(Lt,et)),Sr.join("")}}function _r(gr,Rr){return function(Br){var Sr=e(1900,void 0,1),et=rt(Sr,gr,Br+="",0),Lt,Zt;if(et!=Br.length)return null;if("Q"in Sr)return new Date(Sr.Q);if("s"in Sr)return new Date(Sr.s*1e3+("L"in Sr?Sr.L:0));if(Rr&&!("Z"in Sr)&&(Sr.Z=0),"p"in Sr&&(Sr.H=Sr.H%12+Sr.p*12),Sr.m===void 0&&(Sr.m="q"in Sr?Sr.q:0),"V"in Sr){if(Sr.V<1||Sr.V>53)return null;"w"in Sr||(Sr.w=1),"Z"in Sr?(Lt=M(e(Sr.y,0,1)),Zt=Lt.getUTCDay(),Lt=Zt>4||Zt===0?g.utcMonday.ceil(Lt):g.utcMonday(Lt),Lt=g.utcDay.offset(Lt,(Sr.V-1)*7),Sr.y=Lt.getUTCFullYear(),Sr.m=Lt.getUTCMonth(),Sr.d=Lt.getUTCDate()+(Sr.w+6)%7):(Lt=S(e(Sr.y,0,1)),Zt=Lt.getDay(),Lt=Zt>4||Zt===0?g.timeMonday.ceil(Lt):g.timeMonday(Lt),Lt=g.timeDay.offset(Lt,(Sr.V-1)*7),Sr.y=Lt.getFullYear(),Sr.m=Lt.getMonth(),Sr.d=Lt.getDate()+(Sr.w+6)%7)}else("W"in Sr||"U"in Sr)&&("w"in Sr||(Sr.w="u"in Sr?Sr.u%7:"W"in Sr?1:0),Zt="Z"in Sr?M(e(Sr.y,0,1)).getUTCDay():S(e(Sr.y,0,1)).getDay(),Sr.m=0,Sr.d="W"in Sr?(Sr.w+6)%7+Sr.W*7-(Zt+5)%7:Sr.w+Sr.U*7-(Zt+6)%7);return"Z"in Sr?(Sr.H+=Sr.Z/100|0,Sr.M+=Sr.Z%100,M(Sr)):S(Sr)}}function rt(gr,Rr,Br,Sr){for(var et=0,Lt=Rr.length,Zt=Br.length,or,Ir;et<Lt;){if(Sr>=Zt)return-1;if(or=Rr.charCodeAt(et++),or===37){if(or=Rr.charAt(et++),Ir=Jt[or in n?Rr.charAt(et++):or],!Ir||(Sr=Ir(gr,Br,Sr))<0)return-1}else if(or!=Br.charCodeAt(Sr++))return-1}return Sr}function Je(gr,Rr,Br){var Sr=wt.exec(Rr.slice(Br));return Sr?(gr.p=Ut[Sr[0].toLowerCase()],Br+Sr[0].length):-1}function st(gr,Rr,Br){var Sr=Wt.exec(Rr.slice(Br));return Sr?(gr.w=Vt[Sr[0].toLowerCase()],Br+Sr[0].length):-1}function lt(gr,Rr,Br){var Sr=Rt.exec(Rr.slice(Br));return Sr?(gr.w=Nt[Sr[0].toLowerCase()],Br+Sr[0].length):-1}function Tt(gr,Rr,Br){var Sr=sn.exec(Rr.slice(Br));return Sr?(gr.m=jr[Sr[0].toLowerCase()],Br+Sr[0].length):-1}function zt(gr,Rr,Br){var Sr=ir.exec(Rr.slice(Br));return Sr?(gr.m=Hr[Sr[0].toLowerCase()],Br+Sr[0].length):-1}function Ce(gr,Rr,Br){return rt(gr,tt,Rr,Br)}function Se(gr,Rr,Br){return rt(gr,He,Rr,Br)}function nt(gr,Rr,Br){return rt(gr,Ae,Rr,Br)}function it(gr){return Qe[gr.getDay()]}function ct(gr){return Ze[gr.getDay()]}function kt(gr){return dt[gr.getMonth()]}function gt(gr){return bt[gr.getMonth()]}function St(gr){return Ne[+(gr.getHours()>=12)]}function Yt(gr){return 1+~~(gr.getMonth()/3)}function ar(gr){return Qe[gr.getUTCDay()]}function kr(gr){return Ze[gr.getUTCDay()]}function br(gr){return dt[gr.getUTCMonth()]}function Mr(gr){return bt[gr.getUTCMonth()]}function Yr(gr){return Ne[+(gr.getUTCHours()>=12)]}function nr(gr){return 1+~~(gr.getUTCMonth()/3)}return{format:function(gr){var Rr=Gt(gr+="",at);return Rr.toString=function(){return gr},Rr},parse:function(gr){var Rr=_r(gr+="",!1);return Rr.toString=function(){return gr},Rr},utcFormat:function(gr){var Rr=Gt(gr+="",$t);return Rr.toString=function(){return gr},Rr},utcParse:function(gr){var Rr=_r(gr+="",!0);return Rr.toString=function(){return gr},Rr}}}var n={"-":"",_:" ",0:"0"},r=/^\s*\d+/,t=/^%/,h=/[\\^$*+?|[\]().{}]/g;function s(Ge,tt,He){var Ae=Ge<0?"-":"",Ne=(Ae?-Ge:Ge)+"",Ze=Ne.length;return Ae+(Ze<He?new Array(He-Ze+1).join(tt)+Ne:Ne)}function i(Ge){return Ge.replace(h,"\\$&")}function x(Ge){return new RegExp("^(?:"+Ge.map(i).join("|")+")","i")}function p(Ge){for(var tt={},He=-1,Ae=Ge.length;++He<Ae;)tt[Ge[He].toLowerCase()]=He;return tt}function v(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+1));return Ae?(Ge.w=+Ae[0],He+Ae[0].length):-1}function f(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+1));return Ae?(Ge.u=+Ae[0],He+Ae[0].length):-1}function d(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.U=+Ae[0],He+Ae[0].length):-1}function o(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.V=+Ae[0],He+Ae[0].length):-1}function m(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.W=+Ae[0],He+Ae[0].length):-1}function l(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+4));return Ae?(Ge.y=+Ae[0],He+Ae[0].length):-1}function w(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.y=+Ae[0]+(+Ae[0]>68?1900:2e3),He+Ae[0].length):-1}function _(Ge,tt,He){var Ae=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(tt.slice(He,He+6));return Ae?(Ge.Z=Ae[1]?0:-(Ae[2]+(Ae[3]||"00")),He+Ae[0].length):-1}function c(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+1));return Ae?(Ge.q=Ae[0]*3-3,He+Ae[0].length):-1}function b(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.m=Ae[0]-1,He+Ae[0].length):-1}function u(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.d=+Ae[0],He+Ae[0].length):-1}function L(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+3));return Ae?(Ge.m=0,Ge.d=+Ae[0],He+Ae[0].length):-1}function T(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.H=+Ae[0],He+Ae[0].length):-1}function k(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.M=+Ae[0],He+Ae[0].length):-1}function P(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+2));return Ae?(Ge.S=+Ae[0],He+Ae[0].length):-1}function z(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+3));return Ae?(Ge.L=+Ae[0],He+Ae[0].length):-1}function I(Ge,tt,He){var Ae=r.exec(tt.slice(He,He+6));return Ae?(Ge.L=Math.floor(Ae[0]/1e3),He+Ae[0].length):-1}function D(Ge,tt,He){var Ae=t.exec(tt.slice(He,He+1));return Ae?He+Ae[0].length:-1}function R(Ge,tt,He){var Ae=r.exec(tt.slice(He));return Ae?(Ge.Q=+Ae[0],He+Ae[0].length):-1}function O(Ge,tt,He){var Ae=r.exec(tt.slice(He));return Ae?(Ge.s=+Ae[0],He+Ae[0].length):-1}function F(Ge,tt){return s(Ge.getDate(),tt,2)}function N(Ge,tt){return s(Ge.getHours(),tt,2)}function G(Ge,tt){return s(Ge.getHours()%12||12,tt,2)}function K(Ge,tt){return s(1+g.timeDay.count(g.timeYear(Ge),Ge),tt,3)}function W(Ge,tt){return s(Ge.getMilliseconds(),tt,3)}function Y(Ge,tt){return W(Ge,tt)+"000"}function re(Ge,tt){return s(Ge.getMonth()+1,tt,2)}function ue(Ge,tt){return s(Ge.getMinutes(),tt,2)}function j(Ge,tt){return s(Ge.getSeconds(),tt,2)}function q(Ge){var tt=Ge.getDay();return tt===0?7:tt}function H(Ge,tt){return s(g.timeSunday.count(g.timeYear(Ge)-1,Ge),tt,2)}function U(Ge,tt){var He=Ge.getDay();return Ge=He>=4||He===0?g.timeThursday(Ge):g.timeThursday.ceil(Ge),s(g.timeThursday.count(g.timeYear(Ge),Ge)+(g.timeYear(Ge).getDay()===4),tt,2)}function $(Ge){return Ge.getDay()}function ne(Ge,tt){return s(g.timeMonday.count(g.timeYear(Ge)-1,Ge),tt,2)}function X(Ge,tt){return s(Ge.getFullYear()%100,tt,2)}function Q(Ge,tt){return s(Ge.getFullYear()%1e4,tt,4)}function ie(Ge){var tt=Ge.getTimezoneOffset();return(tt>0?"-":(tt*=-1,"+"))+s(tt/60|0,"0",2)+s(tt%60,"0",2)}function se(Ge,tt){return s(Ge.getUTCDate(),tt,2)}function ae(Ge,tt){return s(Ge.getUTCHours(),tt,2)}function oe(Ge,tt){return s(Ge.getUTCHours()%12||12,tt,2)}function be(Ge,tt){return s(1+g.utcDay.count(g.utcYear(Ge),Ge),tt,3)}function ce(Ge,tt){return s(Ge.getUTCMilliseconds(),tt,3)}function de(Ge,tt){return ce(Ge,tt)+"000"}function ye(Ge,tt){return s(Ge.getUTCMonth()+1,tt,2)}function ge(Ge,tt){return s(Ge.getUTCMinutes(),tt,2)}function me(Ge,tt){return s(Ge.getUTCSeconds(),tt,2)}function Ee(Ge){var tt=Ge.getUTCDay();return tt===0?7:tt}function Pe(Ge,tt){return s(g.utcSunday.count(g.utcYear(Ge)-1,Ge),tt,2)}function Ue(Ge,tt){var He=Ge.getUTCDay();return Ge=He>=4||He===0?g.utcThursday(Ge):g.utcThursday.ceil(Ge),s(g.utcThursday.count(g.utcYear(Ge),Ge)+(g.utcYear(Ge).getUTCDay()===4),tt,2)}function we(Ge){return Ge.getUTCDay()}function ke(Ge,tt){return s(g.utcMonday.count(g.utcYear(Ge)-1,Ge),tt,2)}function Xe(Ge,tt){return s(Ge.getUTCFullYear()%100,tt,2)}function Ve(Ge,tt){return s(Ge.getUTCFullYear()%1e4,tt,4)}function Ie(){return"+0000"}function De(){return"%"}function Ye(Ge){return+Ge}function vt(Ge){return Math.floor(+Ge/1e3)}var Dt;Kt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Kt(Ge){return Dt=a(Ge),A.timeFormat=Dt.format,A.timeParse=Dt.parse,A.utcFormat=Dt.utcFormat,A.utcParse=Dt.utcParse,Dt}var Ft="%Y-%m-%dT%H:%M:%S.%LZ";function Mt(Ge){return Ge.toISOString()}var Xt=Date.prototype.toISOString?Mt:A.utcFormat(Ft);function It(Ge){var tt=new Date(Ge);return isNaN(tt)?null:tt}var At=+new Date("2000-01-01T00:00:00.000Z")?It:A.utcParse(Ft);A.isoFormat=Xt,A.isoParse=At,A.timeFormatDefaultLocale=Kt,A.timeFormatLocale=a,Object.defineProperty(A,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){var g=new Date,S=new Date;function M(we,ke,Xe,Ve){function Ie(De){return we(De=arguments.length===0?new Date:new Date(+De)),De}return Ie.floor=function(De){return we(De=new Date(+De)),De},Ie.ceil=function(De){return we(De=new Date(De-1)),ke(De,1),we(De),De},Ie.round=function(De){var Ye=Ie(De),vt=Ie.ceil(De);return De-Ye<vt-De?Ye:vt},Ie.offset=function(De,Ye){return ke(De=new Date(+De),Ye==null?1:Math.floor(Ye)),De},Ie.range=function(De,Ye,vt){var Dt=[],Kt;if(De=Ie.ceil(De),vt=vt==null?1:Math.floor(vt),!(De<Ye)||!(vt>0))return Dt;do Dt.push(Kt=new Date(+De)),ke(De,vt),we(De);while(Kt<De&&De<Ye);return Dt},Ie.filter=function(De){return M(function(Ye){if(Ye>=Ye)for(;we(Ye),!De(Ye);)Ye.setTime(Ye-1)},function(Ye,vt){if(Ye>=Ye)if(vt<0)for(;++vt<=0;)for(;ke(Ye,-1),!De(Ye););else for(;--vt>=0;)for(;ke(Ye,1),!De(Ye););})},Xe&&(Ie.count=function(De,Ye){return g.setTime(+De),S.setTime(+Ye),we(g),we(S),Math.floor(Xe(g,S))},Ie.every=function(De){return De=Math.floor(De),!isFinite(De)||!(De>0)?null:De>1?Ie.filter(Ve?function(Ye){return Ve(Ye)%De===0}:function(Ye){return Ie.count(0,Ye)%De===0}):Ie}),Ie}var e=M(function(){},function(we,ke){we.setTime(+we+ke)},function(we,ke){return ke-we});e.every=function(we){return we=Math.floor(we),!isFinite(we)||!(we>0)?null:we>1?M(function(ke){ke.setTime(Math.floor(ke/we)*we)},function(ke,Xe){ke.setTime(+ke+Xe*we)},function(ke,Xe){return(Xe-ke)/we}):e};var a=e.range,n=1e3,r=6e4,t=36e5,h=864e5,s=6048e5,i=M(function(we){we.setTime(we-we.getMilliseconds())},function(we,ke){we.setTime(+we+ke*n)},function(we,ke){return(ke-we)/n},function(we){return we.getUTCSeconds()}),x=i.range,p=M(function(we){we.setTime(we-we.getMilliseconds()-we.getSeconds()*n)},function(we,ke){we.setTime(+we+ke*r)},function(we,ke){return(ke-we)/r},function(we){return we.getMinutes()}),v=p.range,f=M(function(we){we.setTime(we-we.getMilliseconds()-we.getSeconds()*n-we.getMinutes()*r)},function(we,ke){we.setTime(+we+ke*t)},function(we,ke){return(ke-we)/t},function(we){return we.getHours()}),d=f.range,o=M(function(we){we.setHours(0,0,0,0)},function(we,ke){we.setDate(we.getDate()+ke)},function(we,ke){return(ke-we-(ke.getTimezoneOffset()-we.getTimezoneOffset())*r)/h},function(we){return we.getDate()-1}),m=o.range;function l(we){return M(function(ke){ke.setDate(ke.getDate()-(ke.getDay()+7-we)%7),ke.setHours(0,0,0,0)},function(ke,Xe){ke.setDate(ke.getDate()+Xe*7)},function(ke,Xe){return(Xe-ke-(Xe.getTimezoneOffset()-ke.getTimezoneOffset())*r)/s})}var w=l(0),_=l(1),c=l(2),b=l(3),u=l(4),L=l(5),T=l(6),k=w.range,P=_.range,z=c.range,I=b.range,D=u.range,R=L.range,O=T.range,F=M(function(we){we.setDate(1),we.setHours(0,0,0,0)},function(we,ke){we.setMonth(we.getMonth()+ke)},function(we,ke){return ke.getMonth()-we.getMonth()+(ke.getFullYear()-we.getFullYear())*12},function(we){return we.getMonth()}),N=F.range,G=M(function(we){we.setMonth(0,1),we.setHours(0,0,0,0)},function(we,ke){we.setFullYear(we.getFullYear()+ke)},function(we,ke){return ke.getFullYear()-we.getFullYear()},function(we){return we.getFullYear()});G.every=function(we){return!isFinite(we=Math.floor(we))||!(we>0)?null:M(function(ke){ke.setFullYear(Math.floor(ke.getFullYear()/we)*we),ke.setMonth(0,1),ke.setHours(0,0,0,0)},function(ke,Xe){ke.setFullYear(ke.getFullYear()+Xe*we)})};var K=G.range,W=M(function(we){we.setUTCSeconds(0,0)},function(we,ke){we.setTime(+we+ke*r)},function(we,ke){return(ke-we)/r},function(we){return we.getUTCMinutes()}),Y=W.range,re=M(function(we){we.setUTCMinutes(0,0,0)},function(we,ke){we.setTime(+we+ke*t)},function(we,ke){return(ke-we)/t},function(we){return we.getUTCHours()}),ue=re.range,j=M(function(we){we.setUTCHours(0,0,0,0)},function(we,ke){we.setUTCDate(we.getUTCDate()+ke)},function(we,ke){return(ke-we)/h},function(we){return we.getUTCDate()-1}),q=j.range;function H(we){return M(function(ke){ke.setUTCDate(ke.getUTCDate()-(ke.getUTCDay()+7-we)%7),ke.setUTCHours(0,0,0,0)},function(ke,Xe){ke.setUTCDate(ke.getUTCDate()+Xe*7)},function(ke,Xe){return(Xe-ke)/s})}var U=H(0),$=H(1),ne=H(2),X=H(3),Q=H(4),ie=H(5),se=H(6),ae=U.range,oe=$.range,be=ne.range,ce=X.range,de=Q.range,ye=ie.range,ge=se.range,me=M(function(we){we.setUTCDate(1),we.setUTCHours(0,0,0,0)},function(we,ke){we.setUTCMonth(we.getUTCMonth()+ke)},function(we,ke){return ke.getUTCMonth()-we.getUTCMonth()+(ke.getUTCFullYear()-we.getUTCFullYear())*12},function(we){return we.getUTCMonth()}),Ee=me.range,Pe=M(function(we){we.setUTCMonth(0,1),we.setUTCHours(0,0,0,0)},function(we,ke){we.setUTCFullYear(we.getUTCFullYear()+ke)},function(we,ke){return ke.getUTCFullYear()-we.getUTCFullYear()},function(we){return we.getUTCFullYear()});Pe.every=function(we){return!isFinite(we=Math.floor(we))||!(we>0)?null:M(function(ke){ke.setUTCFullYear(Math.floor(ke.getUTCFullYear()/we)*we),ke.setUTCMonth(0,1),ke.setUTCHours(0,0,0,0)},function(ke,Xe){ke.setUTCFullYear(ke.getUTCFullYear()+Xe*we)})};var Ue=Pe.range;A.timeDay=o,A.timeDays=m,A.timeFriday=L,A.timeFridays=R,A.timeHour=f,A.timeHours=d,A.timeInterval=M,A.timeMillisecond=e,A.timeMilliseconds=a,A.timeMinute=p,A.timeMinutes=v,A.timeMonday=_,A.timeMondays=P,A.timeMonth=F,A.timeMonths=N,A.timeSaturday=T,A.timeSaturdays=O,A.timeSecond=i,A.timeSeconds=x,A.timeSunday=w,A.timeSundays=k,A.timeThursday=u,A.timeThursdays=D,A.timeTuesday=c,A.timeTuesdays=z,A.timeWednesday=b,A.timeWednesdays=I,A.timeWeek=w,A.timeWeeks=k,A.timeYear=G,A.timeYears=K,A.utcDay=j,A.utcDays=q,A.utcFriday=ie,A.utcFridays=ye,A.utcHour=re,A.utcHours=ue,A.utcMillisecond=e,A.utcMilliseconds=a,A.utcMinute=W,A.utcMinutes=Y,A.utcMonday=$,A.utcMondays=oe,A.utcMonth=me,A.utcMonths=Ee,A.utcSaturday=se,A.utcSaturdays=ge,A.utcSecond=i,A.utcSeconds=x,A.utcSunday=U,A.utcSundays=ae,A.utcThursday=Q,A.utcThursdays=de,A.utcTuesday=ne,A.utcTuesdays=be,A.utcWednesday=X,A.utcWednesdays=ce,A.utcWeek=U,A.utcWeeks=ae,A.utcYear=Pe,A.utcYears=Ue,Object.defineProperty(A,"__esModule",{value:!0})})},{}],122:[function(y,ee,te){arguments[4][121][0].apply(te,arguments)},{dup:121}],123:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.d3=A.d3||{}))})(this,function(A){var g=0,S=0,M=0,e=1e3,a,n,r=0,t=0,h=0,s=typeof performance=="object"&&performance.now?performance:Date,i=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(b){setTimeout(b,17)};function x(){return t||(i(p),t=s.now()+h)}function p(){t=0}function v(){this._call=this._time=this._next=null}v.prototype=f.prototype={constructor:v,restart:function(b,u,L){if(typeof b!="function")throw new TypeError("callback is not a function");L=(L==null?x():+L)+(u==null?0:+u),!this._next&&n!==this&&(n?n._next=this:a=this,n=this),this._call=b,this._time=L,w()},stop:function(){this._call&&(this._call=null,this._time=1/0,w())}};function f(b,u,L){var T=new v;return T.restart(b,u,L),T}function d(){x(),++g;for(var b=a,u;b;)(u=t-b._time)>=0&&b._call.call(null,u),b=b._next;--g}function o(){t=(r=s.now())+h,g=S=0;try{d()}finally{g=0,l(),t=0}}function m(){var b=s.now(),u=b-r;u>e&&(h-=u,r=b)}function l(){for(var b,u=a,L,T=1/0;u;)u._call?(T>u._time&&(T=u._time),b=u,u=u._next):(L=u._next,u._next=null,u=b?b._next=L:a=L);n=b,w(T)}function w(b){if(!g){S&&(S=clearTimeout(S));var u=b-t;u>24?(b<1/0&&(S=setTimeout(o,b-s.now()-h)),M&&(M=clearInterval(M))):(M||(r=s.now(),M=setInterval(m,e)),g=1,i(o))}}function _(b,u,L){var T=new v;return u=u==null?0:+u,T.restart(function(k){T.stop(),b(k+u)},u,L),T}function c(b,u,L){var T=new v,k=u;return u==null?(T.restart(b,u,L),T):(u=+u,L=L==null?x():+L,T.restart(function P(z){z+=k,T.restart(P,k+=u,L),b(z)},u,L),T)}A.interval=c,A.now=x,A.timeout=_,A.timer=f,A.timerFlush=d,Object.defineProperty(A,"__esModule",{value:!0})})},{}],124:[function(y,ee,te){ee.exports=function(){for(var A=0;A<arguments.length;A++)if(arguments[A]!==void 0)return arguments[A]}},{}],125:[function(y,ee,te){ee.exports=M;var A=M.canvas=document.createElement("canvas"),g=A.getContext("2d"),S=e([32,126]);M.createPairs=e,M.ascii=S;function M(a,n){Array.isArray(a)&&(a=a.join(", "));var r={},t,h=16,s=.05;n&&(n.length===2&&typeof n[0]=="number"?t=e(n):Array.isArray(n)?t=n:(n.o?t=e(n.o):n.pairs&&(t=n.pairs),n.fontSize&&(h=n.fontSize),n.threshold!=null&&(s=n.threshold))),t||(t=S),g.font=h+"px "+a;for(var i=0;i<t.length;i++){var x=t[i],p=g.measureText(x[0]).width+g.measureText(x[1]).width,v=g.measureText(x).width;if(Math.abs(p-v)>h*s){var f=(v-p)/h;r[x]=f*1e3}}return r}function e(a){for(var n=[],r=a[0];r<=a[1];r++)for(var t=String.fromCharCode(r),h=a[0];h<a[1];h++){var s=String.fromCharCode(h),i=t+s;n.push(i)}return n}},{}],126:[function(y,ee,te){var A=y("abs-svg-path"),g=y("normalize-svg-path"),S={M:"moveTo",C:"bezierCurveTo"};ee.exports=function(M,e){M.beginPath(),g(A(e)).forEach(function(a){var n=a[0],r=a.slice(1);M[S[n]].apply(M,r)}),M.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(y,ee,te){ee.exports=function(A){switch(A){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(y,ee,te){function A(M,e,a){var n=M[a]|0;if(n<=0)return[];var r=new Array(n),t;if(a===M.length-1)for(t=0;t<n;++t)r[t]=e;else for(t=0;t<n;++t)r[t]=A(M,e,a+1);return r}function g(M,e){var a,n;for(a=new Array(M),n=0;n<M;++n)a[n]=e;return a}function S(M,e){switch(typeof e>"u"&&(e=0),typeof M){case"number":if(M>0)return g(M|0,e);break;case"object":if(typeof M.length=="number")return A(M,e,0);break}return[]}ee.exports=S},{}],129:[function(y,ee,te){ee.exports=A,ee.exports.default=A;function A(R,O,F){F=F||2;var N=O&&O.length,G=N?O[0]*F:R.length,K=g(R,0,G,F,!0),W=[];if(!K||K.next===K.prev)return W;var Y,re,ue,j,q,H,U;if(N&&(K=t(R,O,K,F)),R.length>80*F){Y=ue=R[0],re=j=R[1];for(var $=F;$<G;$+=F)q=R[$],H=R[$+1],q<Y&&(Y=q),H<re&&(re=H),q>ue&&(ue=q),H>j&&(j=H);U=Math.max(ue-Y,j-re),U=U!==0?1/U:0}return M(K,W,F,Y,re,U),W}function g(R,O,F,N,G){var K,W;if(G===D(R,O,F,N)>0)for(K=O;K<F;K+=N)W=P(K,R[K],R[K+1],W);else for(K=F-N;K>=O;K-=N)W=P(K,R[K],R[K+1],W);return W&&w(W,W.next)&&(z(W),W=W.next),W}function S(R,O){if(!R)return R;O||(O=R);var F=R,N;do if(N=!1,!F.steiner&&(w(F,F.next)||l(F.prev,F,F.next)===0)){if(z(F),F=O=F.prev,F===F.next)break;N=!0}else F=F.next;while(N||F!==O);return O}function M(R,O,F,N,G,K,W){if(R){!W&&K&&p(R,N,G,K);for(var Y=R,re,ue;R.prev!==R.next;){if(re=R.prev,ue=R.next,K?a(R,N,G,K):e(R)){O.push(re.i/F),O.push(R.i/F),O.push(ue.i/F),z(R),R=ue.next,Y=ue.next;continue}if(R=ue,R===Y){W?W===1?(R=n(S(R),O,F),M(R,O,F,N,G,K,2)):W===2&&r(R,O,F,N,G,K):M(S(R),O,F,N,G,K,1);break}}}}function e(R){var O=R.prev,F=R,N=R.next;if(l(O,F,N)>=0)return!1;for(var G=R.next.next;G!==R.prev;){if(o(O.x,O.y,F.x,F.y,N.x,N.y,G.x,G.y)&&l(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function a(R,O,F,N){var G=R.prev,K=R,W=R.next;if(l(G,K,W)>=0)return!1;for(var Y=G.x<K.x?G.x<W.x?G.x:W.x:K.x<W.x?K.x:W.x,re=G.y<K.y?G.y<W.y?G.y:W.y:K.y<W.y?K.y:W.y,ue=G.x>K.x?G.x>W.x?G.x:W.x:K.x>W.x?K.x:W.x,j=G.y>K.y?G.y>W.y?G.y:W.y:K.y>W.y?K.y:W.y,q=f(Y,re,O,F,N),H=f(ue,j,O,F,N),U=R.prevZ,$=R.nextZ;U&&U.z>=q&&$&&$.z<=H;){if(U!==R.prev&&U!==R.next&&o(G.x,G.y,K.x,K.y,W.x,W.y,U.x,U.y)&&l(U.prev,U,U.next)>=0||(U=U.prevZ,$!==R.prev&&$!==R.next&&o(G.x,G.y,K.x,K.y,W.x,W.y,$.x,$.y)&&l($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;U&&U.z>=q;){if(U!==R.prev&&U!==R.next&&o(G.x,G.y,K.x,K.y,W.x,W.y,U.x,U.y)&&l(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;$&&$.z<=H;){if($!==R.prev&&$!==R.next&&o(G.x,G.y,K.x,K.y,W.x,W.y,$.x,$.y)&&l($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function n(R,O,F){var N=R;do{var G=N.prev,K=N.next.next;!w(G,K)&&_(G,N,N.next,K)&&L(G,K)&&L(K,G)&&(O.push(G.i/F),O.push(N.i/F),O.push(K.i/F),z(N),z(N.next),N=R=K),N=N.next}while(N!==R);return S(N)}function r(R,O,F,N,G,K){var W=R;do{for(var Y=W.next.next;Y!==W.prev;){if(W.i!==Y.i&&m(W,Y)){var re=k(W,Y);W=S(W,W.next),re=S(re,re.next),M(W,O,F,N,G,K),M(re,O,F,N,G,K);return}Y=Y.next}W=W.next}while(W!==R)}function t(R,O,F,N){var G=[],K,W,Y,re,ue;for(K=0,W=O.length;K<W;K++)Y=O[K]*N,re=K<W-1?O[K+1]*N:R.length,ue=g(R,Y,re,N,!1),ue===ue.next&&(ue.steiner=!0),G.push(d(ue));for(G.sort(h),K=0;K<G.length;K++)s(G[K],F),F=S(F,F.next);return F}function h(R,O){return R.x-O.x}function s(R,O){if(O=i(R,O),O){var F=k(O,R);S(O,O.next),S(F,F.next)}}function i(R,O){var F=O,N=R.x,G=R.y,K=-1/0,W;do{if(G<=F.y&&G>=F.next.y&&F.next.y!==F.y){var Y=F.x+(G-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(Y<=N&&Y>K){if(K=Y,Y===N){if(G===F.y)return F;if(G===F.next.y)return F.next}W=F.x<F.next.x?F:F.next}}F=F.next}while(F!==O);if(!W)return null;if(N===K)return W;var re=W,ue=W.x,j=W.y,q=1/0,H;F=W;do N>=F.x&&F.x>=ue&&N!==F.x&&o(G<j?N:K,G,ue,j,G<j?K:N,G,F.x,F.y)&&(H=Math.abs(G-F.y)/(N-F.x),L(F,R)&&(H<q||H===q&&(F.x>W.x||F.x===W.x&&x(W,F)))&&(W=F,q=H)),F=F.next;while(F!==re);return W}function x(R,O){return l(R.prev,R,O.prev)<0&&l(O.next,R,R.next)<0}function p(R,O,F,N){var G=R;do G.z===null&&(G.z=f(G.x,G.y,O,F,N)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==R);G.prevZ.nextZ=null,G.prevZ=null,v(G)}function v(R){var O,F,N,G,K,W,Y,re,ue=1;do{for(F=R,R=null,K=null,W=0;F;){for(W++,N=F,Y=0,O=0;O<ue&&(Y++,N=N.nextZ,!!N);O++);for(re=ue;Y>0||re>0&&N;)Y!==0&&(re===0||!N||F.z<=N.z)?(G=F,F=F.nextZ,Y--):(G=N,N=N.nextZ,re--),K?K.nextZ=G:R=G,G.prevZ=K,K=G;F=N}K.nextZ=null,ue*=2}while(W>1);return R}function f(R,O,F,N,G){return R=32767*(R-F)*G,O=32767*(O-N)*G,R=(R|R<<8)&16711935,R=(R|R<<4)&252645135,R=(R|R<<2)&858993459,R=(R|R<<1)&1431655765,O=(O|O<<8)&16711935,O=(O|O<<4)&252645135,O=(O|O<<2)&858993459,O=(O|O<<1)&1431655765,R|O<<1}function d(R){var O=R,F=R;do(O.x<F.x||O.x===F.x&&O.y<F.y)&&(F=O),O=O.next;while(O!==R);return F}function o(R,O,F,N,G,K,W,Y){return(G-W)*(O-Y)-(R-W)*(K-Y)>=0&&(R-W)*(N-Y)-(F-W)*(O-Y)>=0&&(F-W)*(K-Y)-(G-W)*(N-Y)>=0}function m(R,O){return R.next.i!==O.i&&R.prev.i!==O.i&&!u(R,O)&&(L(R,O)&&L(O,R)&&T(R,O)&&(l(R.prev,R,O.prev)||l(R,O.prev,O))||w(R,O)&&l(R.prev,R,R.next)>0&&l(O.prev,O,O.next)>0)}function l(R,O,F){return(O.y-R.y)*(F.x-O.x)-(O.x-R.x)*(F.y-O.y)}function w(R,O){return R.x===O.x&&R.y===O.y}function _(R,O,F,N){var G=b(l(R,O,F)),K=b(l(R,O,N)),W=b(l(F,N,R)),Y=b(l(F,N,O));return!!(G!==K&&W!==Y||G===0&&c(R,F,O)||K===0&&c(R,N,O)||W===0&&c(F,R,N)||Y===0&&c(F,O,N))}function c(R,O,F){return O.x<=Math.max(R.x,F.x)&&O.x>=Math.min(R.x,F.x)&&O.y<=Math.max(R.y,F.y)&&O.y>=Math.min(R.y,F.y)}function b(R){return R>0?1:R<0?-1:0}function u(R,O){var F=R;do{if(F.i!==R.i&&F.next.i!==R.i&&F.i!==O.i&&F.next.i!==O.i&&_(F,F.next,R,O))return!0;F=F.next}while(F!==R);return!1}function L(R,O){return l(R.prev,R,R.next)<0?l(R,O,R.next)>=0&&l(R,R.prev,O)>=0:l(R,O,R.prev)<0||l(R,R.next,O)<0}function T(R,O){var F=R,N=!1,G=(R.x+O.x)/2,K=(R.y+O.y)/2;do F.y>K!=F.next.y>K&&F.next.y!==F.y&&G<(F.next.x-F.x)*(K-F.y)/(F.next.y-F.y)+F.x&&(N=!N),F=F.next;while(F!==R);return N}function k(R,O){var F=new I(R.i,R.x,R.y),N=new I(O.i,O.x,O.y),G=R.next,K=O.prev;return R.next=O,O.prev=R,F.next=G,G.prev=F,N.next=F,F.prev=N,K.next=N,N.prev=K,N}function P(R,O,F,N){var G=new I(R,O,F);return N?(G.next=N.next,G.prev=N,N.next.prev=G,N.next=G):(G.prev=G,G.next=G),G}function z(R){R.next.prev=R.prev,R.prev.next=R.next,R.prevZ&&(R.prevZ.nextZ=R.nextZ),R.nextZ&&(R.nextZ.prevZ=R.prevZ)}function I(R,O,F){this.i=R,this.x=O,this.y=F,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}A.deviation=function(R,O,F,N){var G=O&&O.length,K=G?O[0]*F:R.length,W=Math.abs(D(R,0,K,F));if(G)for(var Y=0,re=O.length;Y<re;Y++){var ue=O[Y]*F,j=Y<re-1?O[Y+1]*F:R.length;W-=Math.abs(D(R,ue,j,F))}var q=0;for(Y=0;Y<N.length;Y+=3){var H=N[Y]*F,U=N[Y+1]*F,$=N[Y+2]*F;q+=Math.abs((R[H]-R[$])*(R[U+1]-R[H+1])-(R[H]-R[U])*(R[$+1]-R[H+1]))}return W===0&&q===0?0:Math.abs((q-W)/W)};function D(R,O,F,N){for(var G=0,K=O,W=F-N;K<F;K+=N)G+=(R[W]-R[K])*(R[K+1]+R[W+1]),W=K;return G}A.flatten=function(R){for(var O=R[0][0].length,F={vertices:[],holes:[],dimensions:O},N=0,G=0;G<R.length;G++){for(var K=0;K<R[G].length;K++)for(var W=0;W<O;W++)F.vertices.push(R[G][K][W]);G>0&&(N+=R[G-1].length,F.holes.push(N))}return F}},{}],130:[function(y,ee,te){var A=y("strongly-connected-components");ee.exports=function(S,M){var e=[],a=[],n=[],r={},t=[],h;function s(w){n[w]=!1,r.hasOwnProperty(w)&&Object.keys(r[w]).forEach(function(_){delete r[w][_],n[_]&&s(_)})}function i(w){var _=!1;a.push(w),n[w]=!0;var c,b;for(c=0;c<t[w].length;c++)b=t[w][c],b===h?(x(h,a),_=!0):n[b]||(_=i(b));if(_)s(w);else for(c=0;c<t[w].length;c++){b=t[w][c];var u=r[b];u||(u={},r[b]=u),u[b]=!0}return a.pop(),_}function x(w,_){var c=[].concat(_).concat(w);M?M(i):e.push(c)}function p(w){for(var _=0;_<S.length;_++)_<w&&(S[_]=[]),S[_]=S[_].filter(function(c){return c>=w})}function v(w){p(w);for(var _=S,c=A(_),b=c.components.filter(function(I){return I.length>1}),u=1/0,L,T=0;T<b.length;T++)for(var k=0;k<b[T].length;k++)b[T][k]<u&&(u=b[T][k],L=T);var P=b[L];if(!P)return!1;var z=S.map(function(I,D){return P.indexOf(D)===-1?[]:I.filter(function(R){return P.indexOf(R)!==-1})});return{leastVertex:u,adjList:z}}h=0;for(var f=S.length;h<f;){var d=v(h);if(h=d.leastVertex,t=d.adjList,t){for(var o=0;o<t.length;o++)for(var m=0;m<t[o].length;m++){var l=t[o][m];n[+l]=!1,r[l]={}}i(h),h=h+1}else h=f}if(!M)return e}},{"strongly-connected-components":307}],131:[function(y,ee,te){var A=y("../../object/valid-value");ee.exports=function(){return A(this).length=0,this}},{"../../object/valid-value":162}],132:[function(y,ee,te){ee.exports=y("./is-implemented")()?Array.from:y("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(y,ee,te){ee.exports=function(){var A=Array.from,g,S;return typeof A!="function"?!1:(g=["raz","dwa"],S=A(g),!!(S&&S!==g&&S[1]==="dwa"))}},{}],134:[function(y,ee,te){var A=y("es6-symbol").iterator,g=y("../../function/is-arguments"),S=y("../../function/is-function"),M=y("../../number/to-pos-integer"),e=y("../../object/valid-callable"),a=y("../../object/valid-value"),n=y("../../object/is-value"),r=y("../../string/is-string"),t=Array.isArray,h=Function.prototype.call,s={configurable:!0,enumerable:!0,writable:!0,value:null},i=Object.defineProperty;ee.exports=function(x){var p=arguments[1],v=arguments[2],f,d,o,m,l,w,_,c,b,u;if(x=Object(a(x)),n(p)&&e(p),!this||this===Array||!S(this)){if(!p){if(g(x))return l=x.length,l!==1?Array.apply(null,x):(m=new Array(1),m[0]=x[0],m);if(t(x)){for(m=new Array(l=x.length),d=0;d<l;++d)m[d]=x[d];return m}}m=[]}else f=this;if(!t(x)){if((b=x[A])!==void 0){for(_=e(b).call(x),f&&(m=new f),c=_.next(),d=0;!c.done;)u=p?h.call(p,v,c.value,d):c.value,f?(s.value=u,i(m,d,s)):m[d]=u,c=_.next(),++d;l=d}else if(r(x)){for(l=x.length,f&&(m=new f),d=0,o=0;d<l;++d)u=x[d],d+1<l&&(w=u.charCodeAt(0),w>=55296&&w<=56319&&(u+=x[++d])),u=p?h.call(p,v,u,o):u,f?(s.value=u,i(m,o,s)):m[o]=u,++o;l=o}}if(l===void 0)for(l=M(x.length),f&&(m=new f(l)),d=0;d<l;++d)u=p?h.call(p,v,x[d],d):x[d],f?(s.value=u,i(m,d,s)):m[d]=u;return f&&(s.value=null,m.length=l),m}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(y,ee,te){var A=Object.prototype.toString,g=A.call(function(){return arguments}());ee.exports=function(S){return A.call(S)===g}},{}],136:[function(y,ee,te){var A=Object.prototype.toString,g=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);ee.exports=function(S){return typeof S=="function"&&g(A.call(S))}},{}],137:[function(y,ee,te){ee.exports=function(){}},{}],138:[function(y,ee,te){ee.exports=y("./is-implemented")()?Math.sign:y("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(y,ee,te){ee.exports=function(){var A=Math.sign;return typeof A!="function"?!1:A(10)===1&&A(-20)===-1}},{}],140:[function(y,ee,te){ee.exports=function(A){return A=Number(A),isNaN(A)||A===0?A:A>0?1:-1}},{}],141:[function(y,ee,te){var A=y("../math/sign"),g=Math.abs,S=Math.floor;ee.exports=function(M){return isNaN(M)?0:(M=Number(M),M===0||!isFinite(M)?M:A(M)*S(g(M)))}},{"../math/sign":138}],142:[function(y,ee,te){var A=y("./to-integer"),g=Math.max;ee.exports=function(S){return g(0,A(S))}},{"./to-integer":141}],143:[function(y,ee,te){var A=y("./valid-callable"),g=y("./valid-value"),S=Function.prototype.bind,M=Function.prototype.call,e=Object.keys,a=Object.prototype.propertyIsEnumerable;ee.exports=function(n,r){return function(t,h){var s,i=arguments[2],x=arguments[3];return t=Object(g(t)),A(h),s=e(t),x&&s.sort(typeof x=="function"?S.call(x,t):void 0),typeof n!="function"&&(n=s[n]),M.call(n,s,function(p,v){return a.call(t,p)?M.call(h,i,t[p],p,t,v):r})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(y,ee,te){ee.exports=y("./is-implemented")()?Object.assign:y("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(y,ee,te){ee.exports=function(){var A=Object.assign,g;return typeof A!="function"?!1:(g={foo:"raz"},A(g,{bar:"dwa"},{trzy:"trzy"}),g.foo+g.bar+g.trzy==="razdwatrzy")}},{}],146:[function(y,ee,te){var A=y("../keys"),g=y("../valid-value"),S=Math.max;ee.exports=function(M,e){var a,n,r=S(arguments.length,2),t;for(M=Object(g(M)),t=function(h){try{M[h]=e[h]}catch(s){a||(a=s)}},n=1;n<r;++n)e=arguments[n],A(e).forEach(t);if(a!==void 0)throw a;return M}},{"../keys":152,"../valid-value":162}],147:[function(y,ee,te){var A=y("../array/from"),g=y("./assign"),S=y("./valid-value");ee.exports=function(M){var e=Object(S(M)),a=arguments[1],n=Object(arguments[2]);if(e!==M&&!a)return e;var r={};return a?A(a,function(t){(n.ensure||t in M)&&(r[t]=M[t])}):g(r,M),r}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(y,ee,te){var A=Object.create,g;y("./set-prototype-of/is-implemented")()||(g=y("./set-prototype-of/shim")),ee.exports=function(){var S,M,e;return!g||g.level!==1?A:(S={},M={},e={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(a){if(a==="__proto__"){M[a]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}M[a]=e}),Object.defineProperties(S,M),Object.defineProperty(g,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:S}),function(a,n){return A(a===null?S:a,n)})}()},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(y,ee,te){ee.exports=y("./_iterate")("forEach")},{"./_iterate":143}],150:[function(y,ee,te){var A=y("./is-value"),g={function:!0,object:!0};ee.exports=function(S){return A(S)&&g[typeof S]||!1}},{"./is-value":151}],151:[function(y,ee,te){var A=y("../function/noop")();ee.exports=function(g){return g!==A&&g!==null}},{"../function/noop":137}],152:[function(y,ee,te){ee.exports=y("./is-implemented")()?Object.keys:y("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(y,ee,te){ee.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(y,ee,te){var A=y("../is-value"),g=Object.keys;ee.exports=function(S){return g(A(S)?Object(S):S)}},{"../is-value":151}],155:[function(y,ee,te){var A=y("./valid-callable"),g=y("./for-each"),S=Function.prototype.call;ee.exports=function(M,e){var a={},n=arguments[2];return A(e),g(M,function(r,t,h,s){a[t]=S.call(e,n,r,t,h,s)}),a}},{"./for-each":149,"./valid-callable":160}],156:[function(y,ee,te){var A=y("./is-value"),g=Array.prototype.forEach,S=Object.create,M=function(e,a){var n;for(n in e)a[n]=e[n]};ee.exports=function(e){var a=S(null);return g.call(arguments,function(n){A(n)&&M(Object(n),a)}),a}},{"./is-value":151}],157:[function(y,ee,te){ee.exports=y("./is-implemented")()?Object.setPrototypeOf:y("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(y,ee,te){var A=Object.create,g=Object.getPrototypeOf,S={};ee.exports=function(){var M=Object.setPrototypeOf,e=arguments[0]||A;return typeof M!="function"?!1:g(M(e(null),S))===S}},{}],159:[function(y,ee,te){var A=y("../is-object"),g=y("../valid-value"),S=Object.prototype.isPrototypeOf,M=Object.defineProperty,e={configurable:!0,enumerable:!1,writable:!0,value:void 0},a;a=function(n,r){if(g(n),r===null||A(r))return n;throw new TypeError("Prototype must be null or an object")},ee.exports=function(n){var r,t;return n?(n.level===2?n.set?(t=n.set,r=function(h,s){return t.call(a(h,s),s),h}):r=function(h,s){return a(h,s).__proto__=s,h}:r=function h(s,i){var x;return a(s,i),x=S.call(h.nullPolyfill,s),x&&delete h.nullPolyfill.__proto__,i===null&&(i=h.nullPolyfill),s.__proto__=i,x&&M(h.nullPolyfill,"__proto__",e),s},Object.defineProperty(r,"level",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null}(function(){var n=Object.create(null),r={},t,h=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(h){try{t=h.set,t.call(n,r)}catch{}if(Object.getPrototypeOf(n)===r)return{set:t,level:2}}return n.__proto__=r,Object.getPrototypeOf(n)===r?{level:2}:(n={},n.__proto__=r,Object.getPrototypeOf(n)===r?{level:1}:!1)}()),y("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(y,ee,te){ee.exports=function(A){if(typeof A!="function")throw new TypeError(A+" is not a function");return A}},{}],161:[function(y,ee,te){var A=y("./is-object");ee.exports=function(g){if(!A(g))throw new TypeError(g+" is not an Object");return g}},{"./is-object":150}],162:[function(y,ee,te){var A=y("./is-value");ee.exports=function(g){if(!A(g))throw new TypeError("Cannot use null or undefined");return g}},{"./is-value":151}],163:[function(y,ee,te){ee.exports=y("./is-implemented")()?String.prototype.contains:y("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(y,ee,te){var A="razdwatrzy";ee.exports=function(){return typeof A.contains!="function"?!1:A.contains("dwa")===!0&&A.contains("foo")===!1}},{}],165:[function(y,ee,te){var A=String.prototype.indexOf;ee.exports=function(g){return A.call(this,g,arguments[1])>-1}},{}],166:[function(y,ee,te){var A=Object.prototype.toString,g=A.call("");ee.exports=function(S){return typeof S=="string"||S&&typeof S=="object"&&(S instanceof String||A.call(S)===g)||!1}},{}],167:[function(y,ee,te){var A=Object.create(null),g=Math.random;ee.exports=function(){var S;do S=g().toString(36).slice(2);while(A[S]);return S}},{}],168:[function(y,ee,te){var A=y("es5-ext/object/set-prototype-of"),g=y("es5-ext/string/#/contains"),S=y("d"),M=y("es6-symbol"),e=y("./"),a=Object.defineProperty,n;n=ee.exports=function(r,t){if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");e.call(this,r),t?g.call(t,"key+value")?t="key+value":g.call(t,"key")?t="key":t="value":t="value",a(this,"__kind__",S("",t))},A&&A(n,e),delete n.prototype.constructor,n.prototype=Object.create(e.prototype,{_resolve:S(function(r){return this.__kind__==="value"?this.__list__[r]:this.__kind__==="key+value"?[r,this.__list__[r]]:r})}),a(n.prototype,M.toStringTag,S("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(y,ee,te){var A=y("es5-ext/function/is-arguments"),g=y("es5-ext/object/valid-callable"),S=y("es5-ext/string/is-string"),M=y("./get"),e=Array.isArray,a=Function.prototype.call,n=Array.prototype.some;ee.exports=function(r,t){var h,s=arguments[2],i,x,p,v,f,d,o;if(e(r)||A(r)?h="array":S(r)?h="string":r=M(r),g(t),x=function(){p=!0},h==="array"){n.call(r,function(m){return a.call(t,s,m,x),p});return}if(h==="string"){for(f=r.length,v=0;v<f&&(d=r[v],v+1<f&&(o=d.charCodeAt(0),o>=55296&&o<=56319&&(d+=r[++v])),a.call(t,s,d,x),!p);++v);return}for(i=r.next();!i.done;){if(a.call(t,s,i.value,x),p)return;i=r.next()}}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(y,ee,te){var A=y("es5-ext/function/is-arguments"),g=y("es5-ext/string/is-string"),S=y("./array"),M=y("./string"),e=y("./valid-iterable"),a=y("es6-symbol").iterator;ee.exports=function(n){return typeof e(n)[a]=="function"?n[a]():A(n)?new S(n):g(n)?new M(n):new S(n)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(y,ee,te){var A=y("es5-ext/array/#/clear"),g=y("es5-ext/object/assign"),S=y("es5-ext/object/valid-callable"),M=y("es5-ext/object/valid-value"),e=y("d"),a=y("d/auto-bind"),n=y("es6-symbol"),r=Object.defineProperty,t=Object.defineProperties,h;ee.exports=h=function(s,i){if(!(this instanceof h))throw new TypeError("Constructor requires 'new'");t(this,{__list__:e("w",M(s)),__context__:e("w",i),__nextIndex__:e("w",0)}),i&&(S(i.on),i.on("_add",this._onAdd),i.on("_delete",this._onDelete),i.on("_clear",this._onClear))},delete h.prototype.constructor,t(h.prototype,g({_next:e(function(){var s;if(this.__list__){if(this.__redo__&&(s=this.__redo__.shift(),s!==void 0))return s;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:e(function(){return this._createResult(this._next())}),_createResult:e(function(s){return s===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(s)}}),_resolve:e(function(s){return this.__list__[s]}),_unBind:e(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:e(function(){return"[object "+(this[n.toStringTag]||"Object")+"]"})},a({_onAdd:e(function(s){if(!(s>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){r(this,"__redo__",e("c",[s]));return}this.__redo__.forEach(function(i,x){i>=s&&(this.__redo__[x]=++i)},this),this.__redo__.push(s)}}),_onDelete:e(function(s){var i;s>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(i=this.__redo__.indexOf(s),i!==-1&&this.__redo__.splice(i,1),this.__redo__.forEach(function(x,p){x>s&&(this.__redo__[p]=--x)},this)))}),_onClear:e(function(){this.__redo__&&A.call(this.__redo__),this.__nextIndex__=0})}))),r(h.prototype,n.iterator,e(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(y,ee,te){var A=y("es5-ext/function/is-arguments"),g=y("es5-ext/object/is-value"),S=y("es5-ext/string/is-string"),M=y("es6-symbol").iterator,e=Array.isArray;ee.exports=function(a){return g(a)?e(a)||S(a)||A(a)?!0:typeof a[M]=="function":!1}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(y,ee,te){var A=y("es5-ext/object/set-prototype-of"),g=y("d"),S=y("es6-symbol"),M=y("./"),e=Object.defineProperty,a;a=ee.exports=function(n){if(!(this instanceof a))throw new TypeError("Constructor requires 'new'");n=String(n),M.call(this,n),e(this,"__length__",g("",n.length))},A&&A(a,M),delete a.prototype.constructor,a.prototype=Object.create(M.prototype,{_next:g(function(){if(this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:g(function(n){var r=this.__list__[n],t;return this.__nextIndex__===this.__length__?r:(t=r.charCodeAt(0),t>=55296&&t<=56319?r+this.__list__[this.__nextIndex__++]:r)})}),e(a.prototype,S.toStringTag,g("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(y,ee,te){var A=y("./is-iterable");ee.exports=function(g){if(!A(g))throw new TypeError(g+" is not iterable");return g}},{"./is-iterable":172}],175:[function(y,ee,te){ee.exports=y("./is-implemented")()?y("ext/global-this").Symbol:y("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(y,ee,te){var A=y("ext/global-this"),g={object:!0,symbol:!0};ee.exports=function(){var S=A.Symbol,M;if(typeof S!="function")return!1;M=S("test symbol");try{String(M)}catch{return!1}return!(!g[typeof S.iterator]||!g[typeof S.toPrimitive]||!g[typeof S.toStringTag])}},{"ext/global-this":188}],177:[function(y,ee,te){ee.exports=function(A){return A?typeof A=="symbol"?!0:!A.constructor||A.constructor.name!=="Symbol"?!1:A[A.constructor.toStringTag]==="Symbol":!1}},{}],178:[function(y,ee,te){var A=y("d"),g=Object.create,S=Object.defineProperty,M=Object.prototype,e=g(null);ee.exports=function(a){for(var n=0,r,t;e[a+(n||"")];)++n;return a+=n||"",e[a]=!0,r="@@"+a,S(M,r,A.gs(null,function(h){t||(t=!0,S(this,r,A(h)),t=!1)})),r}},{d:106}],179:[function(y,ee,te){var A=y("d"),g=y("ext/global-this").Symbol;ee.exports=function(S){return Object.defineProperties(S,{hasInstance:A("",g&&g.hasInstance||S("hasInstance")),isConcatSpreadable:A("",g&&g.isConcatSpreadable||S("isConcatSpreadable")),iterator:A("",g&&g.iterator||S("iterator")),match:A("",g&&g.match||S("match")),replace:A("",g&&g.replace||S("replace")),search:A("",g&&g.search||S("search")),species:A("",g&&g.species||S("species")),split:A("",g&&g.split||S("split")),toPrimitive:A("",g&&g.toPrimitive||S("toPrimitive")),toStringTag:A("",g&&g.toStringTag||S("toStringTag")),unscopables:A("",g&&g.unscopables||S("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(y,ee,te){var A=y("d"),g=y("../../../validate-symbol"),S=Object.create(null);ee.exports=function(M){return Object.defineProperties(M,{for:A(function(e){return S[e]?S[e]:S[e]=M(String(e))}),keyFor:A(function(e){var a;g(e);for(a in S)if(S[a]===e)return a})})}},{"../../../validate-symbol":182,d:106}],181:[function(y,ee,te){var A=y("d"),g=y("./validate-symbol"),S=y("ext/global-this").Symbol,M=y("./lib/private/generate-name"),e=y("./lib/private/setup/standard-symbols"),a=y("./lib/private/setup/symbol-registry"),n=Object.create,r=Object.defineProperties,t=Object.defineProperty,h,s,i;if(typeof S=="function")try{String(S()),i=!0}catch{}else S=null;s=function(p){if(this instanceof s)throw new TypeError("Symbol is not a constructor");return h(p)},ee.exports=h=function x(p){var v;if(this instanceof x)throw new TypeError("Symbol is not a constructor");return i?S(p):(v=n(s.prototype),p=p===void 0?"":String(p),r(v,{__description__:A("",p),__name__:A("",M(p))}))},e(h),a(h),r(s.prototype,{constructor:A(h),toString:A("",function(){return this.__name__})}),r(h.prototype,{toString:A(function(){return"Symbol ("+g(this).__description__+")"}),valueOf:A(function(){return g(this)})}),t(h.prototype,h.toPrimitive,A("",function(){var x=g(this);return typeof x=="symbol"?x:x.toString()})),t(h.prototype,h.toStringTag,A("c","Symbol")),t(s.prototype,h.toStringTag,A("c",h.prototype[h.toStringTag])),t(s.prototype,h.toPrimitive,A("c",h.prototype[h.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(y,ee,te){var A=y("./is-symbol");ee.exports=function(g){if(!A(g))throw new TypeError(g+" is not a symbol");return g}},{"./is-symbol":177}],183:[function(y,ee,te){ee.exports=y("./is-implemented")()?WeakMap:y("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(y,ee,te){ee.exports=function(){var A,g;if(typeof WeakMap!="function")return!1;try{A=new WeakMap([[g={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return!(String(A)!=="[object WeakMap]"||typeof A.set!="function"||A.set({},1)!==A||typeof A.delete!="function"||typeof A.has!="function"||A.get(g)!=="one")}},{}],185:[function(y,ee,te){ee.exports=function(){return typeof WeakMap!="function"?!1:Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],186:[function(y,ee,te){var A=y("es5-ext/object/is-value"),g=y("es5-ext/object/set-prototype-of"),S=y("es5-ext/object/valid-object"),M=y("es5-ext/object/valid-value"),e=y("es5-ext/string/random-uniq"),a=y("d"),n=y("es6-iterator/get"),r=y("es6-iterator/for-of"),t=y("es6-symbol").toStringTag,h=y("./is-native-implemented"),s=Array.isArray,i=Object.defineProperty,x=Object.prototype.hasOwnProperty,p=Object.getPrototypeOf,v;ee.exports=v=function(){var f=arguments[0],d;if(!(this instanceof v))throw new TypeError("Constructor requires 'new'");return d=h&&g&&WeakMap!==v?g(new WeakMap,p(this)):this,A(f)&&(s(f)||(f=n(f))),i(d,"__weakMapData__",a("c","$weakMap$"+e())),f&&r(f,function(o){M(o),d.set(o[0],o[1])}),d},h&&(g&&g(v,WeakMap),v.prototype=Object.create(WeakMap.prototype,{constructor:a(v)})),Object.defineProperties(v.prototype,{delete:a(function(f){return x.call(S(f),this.__weakMapData__)?(delete f[this.__weakMapData__],!0):!1}),get:a(function(f){if(x.call(S(f),this.__weakMapData__))return f[this.__weakMapData__]}),has:a(function(f){return x.call(S(f),this.__weakMapData__)}),set:a(function(f,d){return i(S(f),this.__weakMapData__,a("c",d)),this}),toString:a(function(){return"[object WeakMap]"})}),i(v.prototype,t,a("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(y,ee,te){var A=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};ee.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return A()}try{return __global__||A()}finally{delete Object.prototype.__global__}}()},{}],188:[function(y,ee,te){ee.exports=y("./is-implemented")()?globalThis:y("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(y,ee,te){ee.exports=function(){return typeof globalThis!="object"||!globalThis?!1:globalThis.Array===Array}},{}],190:[function(y,ee,te){var A=y("is-string-blank");ee.exports=function(g){var S=typeof g;if(S==="string"){var M=g;if(g=+g,g===0&&A(M))return!1}else if(S!=="number")return!1;return g-g<1}},{"is-string-blank":237}],191:[function(y,ee,te){var A=y("dtype");ee.exports=g;function g(S,M,e){if(!S)throw new TypeError("must specify data as first parameter");if(e=+(e||0)|0,Array.isArray(S)&&S[0]&&typeof S[0][0]=="number"){var a=S[0].length,n=S.length*a,r,t,h,s;(!M||typeof M=="string")&&(M=new(A(M||"float32"))(n+e));var i=M.length-e;if(n!==i)throw new Error("source length "+n+" ("+a+"x"+S.length+") does not match destination length "+i);for(r=0,h=e;r<S.length;r++)for(t=0;t<a;t++)M[h++]=S[r][t]===null?NaN:S[r][t]}else if(!M||typeof M=="string"){var x=A(M||"float32");if(Array.isArray(S)||M==="array")for(M=new x(S.length+e),r=0,h=e,s=M.length;h<s;h++,r++)M[h]=S[r]===null?NaN:S[r];else e===0?M=new x(S):(M=new x(S.length+e),M.set(S,e))}else M.set(S,e);return M}},{dtype:127}],192:[function(y,ee,te){var A=y("css-font/stringify"),g=[32,126];ee.exports=S;function S(M){M=M||{};var e=M.shape?M.shape:M.canvas?[M.canvas.width,M.canvas.height]:[512,512],a=M.canvas||document.createElement("canvas"),n=M.font,r=typeof M.step=="number"?[M.step,M.step]:M.step||[32,32],t=M.chars||g;if(n&&typeof n!="string"&&(n=A(n)),!Array.isArray(t))t=String(t).split("");else if(t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"){for(var h=[],s=t[0],i=0;s<=t[1];s++)h[i++]=String.fromCharCode(s);t=h}e=e.slice(),a.width=e[0],a.height=e[1];var x=a.getContext("2d");x.fillStyle="#000",x.fillRect(0,0,a.width,a.height),x.font=n,x.textAlign="center",x.textBaseline="middle",x.fillStyle="#fff";for(var p=r[0]/2,v=r[1]/2,s=0;s<t.length;s++)x.fillText(t[s],p,v),(p+=r[0])>e[0]-r[0]/2&&(p=r[0]/2,v+=r[1]);return a}},{"css-font/stringify":102}],193:[function(y,ee,te){ee.exports=A,A.canvas=document.createElement("canvas"),A.cache={};function A(s,a){a||(a={}),(typeof s=="string"||Array.isArray(s))&&(a.family=s);var n=Array.isArray(a.family)?a.family.join(", "):a.family;if(!n)throw Error("`family` must be defined");var r=a.size||a.fontSize||a.em||48,t=a.weight||a.fontWeight||"",h=a.style||a.fontStyle||"",s=[h,t,r].join(" ")+"px "+n,i=a.origin||"top";if(A.cache[n]&&r<=A.cache[n].em)return g(A.cache[n],i);var x=a.canvas||A.canvas,p=x.getContext("2d"),v={upper:a.upper!==void 0?a.upper:"H",lower:a.lower!==void 0?a.lower:"x",descent:a.descent!==void 0?a.descent:"p",ascent:a.ascent!==void 0?a.ascent:"h",tittle:a.tittle!==void 0?a.tittle:"i",overshoot:a.overshoot!==void 0?a.overshoot:"O"},f=Math.ceil(r*1.5);x.height=f,x.width=f*.5,p.font=s;var d="H",o={top:0};p.clearRect(0,0,f,f),p.textBaseline="top",p.fillStyle="black",p.fillText(d,0,0);var m=S(p.getImageData(0,0,f,f));p.clearRect(0,0,f,f),p.textBaseline="bottom",p.fillText(d,0,f);var l=S(p.getImageData(0,0,f,f));o.lineHeight=o.bottom=f-l+m,p.clearRect(0,0,f,f),p.textBaseline="alphabetic",p.fillText(d,0,f);var w=S(p.getImageData(0,0,f,f)),_=f-w-1+m;o.baseline=o.alphabetic=_,p.clearRect(0,0,f,f),p.textBaseline="middle",p.fillText(d,0,f*.5);var c=S(p.getImageData(0,0,f,f));o.median=o.middle=f-c-1+m-f*.5,p.clearRect(0,0,f,f),p.textBaseline="hanging",p.fillText(d,0,f*.5);var b=S(p.getImageData(0,0,f,f));o.hanging=f-b-1+m-f*.5,p.clearRect(0,0,f,f),p.textBaseline="ideographic",p.fillText(d,0,f);var u=S(p.getImageData(0,0,f,f));if(o.ideographic=f-u-1+m,v.upper&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.upper,0,0),o.upper=S(p.getImageData(0,0,f,f)),o.capHeight=o.baseline-o.upper),v.lower&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.lower,0,0),o.lower=S(p.getImageData(0,0,f,f)),o.xHeight=o.baseline-o.lower),v.tittle&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.tittle,0,0),o.tittle=S(p.getImageData(0,0,f,f))),v.ascent&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.ascent,0,0),o.ascent=S(p.getImageData(0,0,f,f))),v.descent&&(p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.descent,0,0),o.descent=M(p.getImageData(0,0,f,f))),v.overshoot){p.clearRect(0,0,f,f),p.textBaseline="top",p.fillText(v.overshoot,0,0);var L=M(p.getImageData(0,0,f,f));o.overshoot=L-_}for(var T in o)o[T]/=r;return o.em=r,A.cache[n]=o,g(o,i)}function g(e,a){var n={};typeof a=="string"&&(a=e[a]);for(var r in e)r!=="em"&&(n[r]=e[r]-a);return n}function S(e){for(var a=e.height,n=e.data,r=3;r<n.length;r+=4)if(n[r]!==0)return Math.floor((r-3)*.25/a)}function M(e){for(var a=e.height,n=e.data,r=n.length-1;r>0;r-=4)if(n[r]!==0)return Math.floor((r-3)*.25/a)}},{}],194:[function(y,ee,te){ee.exports=A;function A(g,S){if(typeof g!="string")throw new TypeError("must specify type string");if(S=S||{},typeof document>"u"&&!S.canvas)return null;var M=S.canvas||document.createElement("canvas");typeof S.width=="number"&&(M.width=S.width),typeof S.height=="number"&&(M.height=S.height);var e=S,a;try{var n=[g];g.indexOf("webgl")===0&&n.push("experimental-"+g);for(var r=0;r<n.length;r++)if(a=M.getContext(n[r],e),a)return a}catch{a=null}return a||null}},{}],195:[function(y,ee,te){ee.exports=A;function A(g,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=S[4],t=S[5],h=S[6],s=S[7],i=S[8],x=S[9],p=S[10],v=S[11],f=S[12],d=S[13],o=S[14],m=S[15];return g[0]=t*(p*m-v*o)-x*(h*m-s*o)+d*(h*v-s*p),g[1]=-(e*(p*m-v*o)-x*(a*m-n*o)+d*(a*v-n*p)),g[2]=e*(h*m-s*o)-t*(a*m-n*o)+d*(a*s-n*h),g[3]=-(e*(h*v-s*p)-t*(a*v-n*p)+x*(a*s-n*h)),g[4]=-(r*(p*m-v*o)-i*(h*m-s*o)+f*(h*v-s*p)),g[5]=M*(p*m-v*o)-i*(a*m-n*o)+f*(a*v-n*p),g[6]=-(M*(h*m-s*o)-r*(a*m-n*o)+f*(a*s-n*h)),g[7]=M*(h*v-s*p)-r*(a*v-n*p)+i*(a*s-n*h),g[8]=r*(x*m-v*d)-i*(t*m-s*d)+f*(t*v-s*x),g[9]=-(M*(x*m-v*d)-i*(e*m-n*d)+f*(e*v-n*x)),g[10]=M*(t*m-s*d)-r*(e*m-n*d)+f*(e*s-n*t),g[11]=-(M*(t*v-s*x)-r*(e*v-n*x)+i*(e*s-n*t)),g[12]=-(r*(x*o-p*d)-i*(t*o-h*d)+f*(t*p-h*x)),g[13]=M*(x*o-p*d)-i*(e*o-a*d)+f*(e*p-a*x),g[14]=-(M*(t*o-h*d)-r*(e*o-a*d)+f*(e*h-a*t)),g[15]=M*(t*p-h*x)-r*(e*p-a*x)+i*(e*h-a*t),g}},{}],196:[function(y,ee,te){ee.exports=A;function A(g){var S=new Float32Array(16);return S[0]=g[0],S[1]=g[1],S[2]=g[2],S[3]=g[3],S[4]=g[4],S[5]=g[5],S[6]=g[6],S[7]=g[7],S[8]=g[8],S[9]=g[9],S[10]=g[10],S[11]=g[11],S[12]=g[12],S[13]=g[13],S[14]=g[14],S[15]=g[15],S}},{}],197:[function(y,ee,te){ee.exports=A;function A(g,S){return g[0]=S[0],g[1]=S[1],g[2]=S[2],g[3]=S[3],g[4]=S[4],g[5]=S[5],g[6]=S[6],g[7]=S[7],g[8]=S[8],g[9]=S[9],g[10]=S[10],g[11]=S[11],g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15],g}},{}],198:[function(y,ee,te){ee.exports=A;function A(){var g=new Float32Array(16);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],199:[function(y,ee,te){ee.exports=A;function A(g){var S=g[0],M=g[1],e=g[2],a=g[3],n=g[4],r=g[5],t=g[6],h=g[7],s=g[8],i=g[9],x=g[10],p=g[11],v=g[12],f=g[13],d=g[14],o=g[15],m=S*r-M*n,l=S*t-e*n,w=S*h-a*n,_=M*t-e*r,c=M*h-a*r,b=e*h-a*t,u=s*f-i*v,L=s*d-x*v,T=s*o-p*v,k=i*d-x*f,P=i*o-p*f,z=x*o-p*d;return m*z-l*P+w*k+_*T-c*L+b*u}},{}],200:[function(y,ee,te){ee.exports=A;function A(g,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=M+M,t=e+e,h=a+a,s=M*r,i=e*r,x=e*t,p=a*r,v=a*t,f=a*h,d=n*r,o=n*t,m=n*h;return g[0]=1-x-f,g[1]=i+m,g[2]=p-o,g[3]=0,g[4]=i-m,g[5]=1-s-f,g[6]=v+d,g[7]=0,g[8]=p+o,g[9]=v-d,g[10]=1-s-x,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],201:[function(y,ee,te){ee.exports=A;function A(g,S,M){var e,a,n,r=M[0],t=M[1],h=M[2],s=Math.sqrt(r*r+t*t+h*h);return Math.abs(s)<1e-6?null:(s=1/s,r*=s,t*=s,h*=s,e=Math.sin(S),a=Math.cos(S),n=1-a,g[0]=r*r*n+a,g[1]=t*r*n+h*e,g[2]=h*r*n-t*e,g[3]=0,g[4]=r*t*n-h*e,g[5]=t*t*n+a,g[6]=h*t*n+r*e,g[7]=0,g[8]=r*h*n+t*e,g[9]=t*h*n-r*e,g[10]=h*h*n+a,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g)}},{}],202:[function(y,ee,te){ee.exports=A;function A(g,S,M){var e=S[0],a=S[1],n=S[2],r=S[3],t=e+e,h=a+a,s=n+n,i=e*t,x=e*h,p=e*s,v=a*h,f=a*s,d=n*s,o=r*t,m=r*h,l=r*s;return g[0]=1-(v+d),g[1]=x+l,g[2]=p-m,g[3]=0,g[4]=x-l,g[5]=1-(i+d),g[6]=f+o,g[7]=0,g[8]=p+m,g[9]=f-o,g[10]=1-(i+v),g[11]=0,g[12]=M[0],g[13]=M[1],g[14]=M[2],g[15]=1,g}},{}],203:[function(y,ee,te){ee.exports=A;function A(g,S){return g[0]=S[0],g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=S[1],g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=S[2],g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],204:[function(y,ee,te){ee.exports=A;function A(g,S){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=S[0],g[13]=S[1],g[14]=S[2],g[15]=1,g}},{}],205:[function(y,ee,te){ee.exports=A;function A(g,S){var M=Math.sin(S),e=Math.cos(S);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=e,g[6]=M,g[7]=0,g[8]=0,g[9]=-M,g[10]=e,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],206:[function(y,ee,te){ee.exports=A;function A(g,S){var M=Math.sin(S),e=Math.cos(S);return g[0]=e,g[1]=0,g[2]=-M,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=M,g[9]=0,g[10]=e,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],207:[function(y,ee,te){ee.exports=A;function A(g,S){var M=Math.sin(S),e=Math.cos(S);return g[0]=e,g[1]=M,g[2]=0,g[3]=0,g[4]=-M,g[5]=e,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],208:[function(y,ee,te){ee.exports=A;function A(g,S,M,e,a,n,r){var t=1/(M-S),h=1/(a-e),s=1/(n-r);return g[0]=n*2*t,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=n*2*h,g[6]=0,g[7]=0,g[8]=(M+S)*t,g[9]=(a+e)*h,g[10]=(r+n)*s,g[11]=-1,g[12]=0,g[13]=0,g[14]=r*n*2*s,g[15]=0,g}},{}],209:[function(y,ee,te){ee.exports=A;function A(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],210:[function(y,ee,te){ee.exports={create:y("./create"),clone:y("./clone"),copy:y("./copy"),identity:y("./identity"),transpose:y("./transpose"),invert:y("./invert"),adjoint:y("./adjoint"),determinant:y("./determinant"),multiply:y("./multiply"),translate:y("./translate"),scale:y("./scale"),rotate:y("./rotate"),rotateX:y("./rotateX"),rotateY:y("./rotateY"),rotateZ:y("./rotateZ"),fromRotation:y("./fromRotation"),fromRotationTranslation:y("./fromRotationTranslation"),fromScaling:y("./fromScaling"),fromTranslation:y("./fromTranslation"),fromXRotation:y("./fromXRotation"),fromYRotation:y("./fromYRotation"),fromZRotation:y("./fromZRotation"),fromQuat:y("./fromQuat"),frustum:y("./frustum"),perspective:y("./perspective"),perspectiveFromFieldOfView:y("./perspectiveFromFieldOfView"),ortho:y("./ortho"),lookAt:y("./lookAt"),str:y("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(y,ee,te){ee.exports=A;function A(g,S){var M=S[0],e=S[1],a=S[2],n=S[3],r=S[4],t=S[5],h=S[6],s=S[7],i=S[8],x=S[9],p=S[10],v=S[11],f=S[12],d=S[13],o=S[14],m=S[15],l=M*t-e*r,w=M*h-a*r,_=M*s-n*r,c=e*h-a*t,b=e*s-n*t,u=a*s-n*h,L=i*d-x*f,T=i*o-p*f,k=i*m-v*f,P=x*o-p*d,z=x*m-v*d,I=p*m-v*o,D=l*I-w*z+_*P+c*k-b*T+u*L;return D?(D=1/D,g[0]=(t*I-h*z+s*P)*D,g[1]=(a*z-e*I-n*P)*D,g[2]=(d*u-o*b+m*c)*D,g[3]=(p*b-x*u-v*c)*D,g[4]=(h*k-r*I-s*T)*D,g[5]=(M*I-a*k+n*T)*D,g[6]=(o*_-f*u-m*w)*D,g[7]=(i*u-p*_+v*w)*D,g[8]=(r*z-t*k+s*L)*D,g[9]=(e*k-M*z-n*L)*D,g[10]=(f*b-d*_+m*l)*D,g[11]=(x*_-i*b-v*l)*D,g[12]=(t*T-r*P-h*L)*D,g[13]=(M*P-e*T+a*L)*D,g[14]=(d*w-f*c-o*l)*D,g[15]=(i*c-x*w+p*l)*D,g):null}},{}],212:[function(y,ee,te){var A=y("./identity");ee.exports=g;function g(S,M,e,a){var n,r,t,h,s,i,x,p,v,f,d=M[0],o=M[1],m=M[2],l=a[0],w=a[1],_=a[2],c=e[0],b=e[1],u=e[2];return Math.abs(d-c)<1e-6&&Math.abs(o-b)<1e-6&&Math.abs(m-u)<1e-6?A(S):(x=d-c,p=o-b,v=m-u,f=1/Math.sqrt(x*x+p*p+v*v),x*=f,p*=f,v*=f,n=w*v-_*p,r=_*x-l*v,t=l*p-w*x,f=Math.sqrt(n*n+r*r+t*t),f?(f=1/f,n*=f,r*=f,t*=f):(n=0,r=0,t=0),h=p*t-v*r,s=v*n-x*t,i=x*r-p*n,f=Math.sqrt(h*h+s*s+i*i),f?(f=1/f,h*=f,s*=f,i*=f):(h=0,s=0,i=0),S[0]=n,S[1]=h,S[2]=x,S[3]=0,S[4]=r,S[5]=s,S[6]=p,S[7]=0,S[8]=t,S[9]=i,S[10]=v,S[11]=0,S[12]=-(n*d+r*o+t*m),S[13]=-(h*d+s*o+i*m),S[14]=-(x*d+p*o+v*m),S[15]=1,S)}},{"./identity":209}],213:[function(y,ee,te){ee.exports=A;function A(g,S,M){var e=S[0],a=S[1],n=S[2],r=S[3],t=S[4],h=S[5],s=S[6],i=S[7],x=S[8],p=S[9],v=S[10],f=S[11],d=S[12],o=S[13],m=S[14],l=S[15],w=M[0],_=M[1],c=M[2],b=M[3];return g[0]=w*e+_*t+c*x+b*d,g[1]=w*a+_*h+c*p+b*o,g[2]=w*n+_*s+c*v+b*m,g[3]=w*r+_*i+c*f+b*l,w=M[4],_=M[5],c=M[6],b=M[7],g[4]=w*e+_*t+c*x+b*d,g[5]=w*a+_*h+c*p+b*o,g[6]=w*n+_*s+c*v+b*m,g[7]=w*r+_*i+c*f+b*l,w=M[8],_=M[9],c=M[10],b=M[11],g[8]=w*e+_*t+c*x+b*d,g[9]=w*a+_*h+c*p+b*o,g[10]=w*n+_*s+c*v+b*m,g[11]=w*r+_*i+c*f+b*l,w=M[12],_=M[13],c=M[14],b=M[15],g[12]=w*e+_*t+c*x+b*d,g[13]=w*a+_*h+c*p+b*o,g[14]=w*n+_*s+c*v+b*m,g[15]=w*r+_*i+c*f+b*l,g}},{}],214:[function(y,ee,te){ee.exports=A;function A(g,S,M,e,a,n,r){var t=1/(S-M),h=1/(e-a),s=1/(n-r);return g[0]=-2*t,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*h,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*s,g[11]=0,g[12]=(S+M)*t,g[13]=(a+e)*h,g[14]=(r+n)*s,g[15]=1,g}},{}],215:[function(y,ee,te){ee.exports=A;function A(g,S,M,e,a){var n=1/Math.tan(S/2),r=1/(e-a);return g[0]=n/M,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=n,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=(a+e)*r,g[11]=-1,g[12]=0,g[13]=0,g[14]=2*a*e*r,g[15]=0,g}},{}],216:[function(y,ee,te){ee.exports=A;function A(g,S,M,e){var a=Math.tan(S.upDegrees*Math.PI/180),n=Math.tan(S.downDegrees*Math.PI/180),r=Math.tan(S.leftDegrees*Math.PI/180),t=Math.tan(S.rightDegrees*Math.PI/180),h=2/(r+t),s=2/(a+n);return g[0]=h,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=s,g[6]=0,g[7]=0,g[8]=-((r-t)*h*.5),g[9]=(a-n)*s*.5,g[10]=e/(M-e),g[11]=-1,g[12]=0,g[13]=0,g[14]=e*M/(M-e),g[15]=0,g}},{}],217:[function(y,ee,te){ee.exports=A;function A(g,S,M,e){var a=e[0],n=e[1],r=e[2],t=Math.sqrt(a*a+n*n+r*r),h,s,i,x,p,v,f,d,o,m,l,w,_,c,b,u,L,T,k,P,z,I,D,R;return Math.abs(t)<1e-6?null:(t=1/t,a*=t,n*=t,r*=t,h=Math.sin(M),s=Math.cos(M),i=1-s,x=S[0],p=S[1],v=S[2],f=S[3],d=S[4],o=S[5],m=S[6],l=S[7],w=S[8],_=S[9],c=S[10],b=S[11],u=a*a*i+s,L=n*a*i+r*h,T=r*a*i-n*h,k=a*n*i-r*h,P=n*n*i+s,z=r*n*i+a*h,I=a*r*i+n*h,D=n*r*i-a*h,R=r*r*i+s,g[0]=x*u+d*L+w*T,g[1]=p*u+o*L+_*T,g[2]=v*u+m*L+c*T,g[3]=f*u+l*L+b*T,g[4]=x*k+d*P+w*z,g[5]=p*k+o*P+_*z,g[6]=v*k+m*P+c*z,g[7]=f*k+l*P+b*z,g[8]=x*I+d*D+w*R,g[9]=p*I+o*D+_*R,g[10]=v*I+m*D+c*R,g[11]=f*I+l*D+b*R,S!==g&&(g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15]),g)}},{}],218:[function(y,ee,te){ee.exports=A;function A(g,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[4],r=S[5],t=S[6],h=S[7],s=S[8],i=S[9],x=S[10],p=S[11];return S!==g&&(g[0]=S[0],g[1]=S[1],g[2]=S[2],g[3]=S[3],g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15]),g[4]=n*a+s*e,g[5]=r*a+i*e,g[6]=t*a+x*e,g[7]=h*a+p*e,g[8]=s*a-n*e,g[9]=i*a-r*e,g[10]=x*a-t*e,g[11]=p*a-h*e,g}},{}],219:[function(y,ee,te){ee.exports=A;function A(g,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[0],r=S[1],t=S[2],h=S[3],s=S[8],i=S[9],x=S[10],p=S[11];return S!==g&&(g[4]=S[4],g[5]=S[5],g[6]=S[6],g[7]=S[7],g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15]),g[0]=n*a-s*e,g[1]=r*a-i*e,g[2]=t*a-x*e,g[3]=h*a-p*e,g[8]=n*e+s*a,g[9]=r*e+i*a,g[10]=t*e+x*a,g[11]=h*e+p*a,g}},{}],220:[function(y,ee,te){ee.exports=A;function A(g,S,M){var e=Math.sin(M),a=Math.cos(M),n=S[0],r=S[1],t=S[2],h=S[3],s=S[4],i=S[5],x=S[6],p=S[7];return S!==g&&(g[8]=S[8],g[9]=S[9],g[10]=S[10],g[11]=S[11],g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15]),g[0]=n*a+s*e,g[1]=r*a+i*e,g[2]=t*a+x*e,g[3]=h*a+p*e,g[4]=s*a-n*e,g[5]=i*a-r*e,g[6]=x*a-t*e,g[7]=p*a-h*e,g}},{}],221:[function(y,ee,te){ee.exports=A;function A(g,S,M){var e=M[0],a=M[1],n=M[2];return g[0]=S[0]*e,g[1]=S[1]*e,g[2]=S[2]*e,g[3]=S[3]*e,g[4]=S[4]*a,g[5]=S[5]*a,g[6]=S[6]*a,g[7]=S[7]*a,g[8]=S[8]*n,g[9]=S[9]*n,g[10]=S[10]*n,g[11]=S[11]*n,g[12]=S[12],g[13]=S[13],g[14]=S[14],g[15]=S[15],g}},{}],222:[function(y,ee,te){ee.exports=A;function A(g){return"mat4("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+", "+g[6]+", "+g[7]+", "+g[8]+", "+g[9]+", "+g[10]+", "+g[11]+", "+g[12]+", "+g[13]+", "+g[14]+", "+g[15]+")"}},{}],223:[function(y,ee,te){ee.exports=A;function A(g,S,M){var e=M[0],a=M[1],n=M[2],r,t,h,s,i,x,p,v,f,d,o,m;return S===g?(g[12]=S[0]*e+S[4]*a+S[8]*n+S[12],g[13]=S[1]*e+S[5]*a+S[9]*n+S[13],g[14]=S[2]*e+S[6]*a+S[10]*n+S[14],g[15]=S[3]*e+S[7]*a+S[11]*n+S[15]):(r=S[0],t=S[1],h=S[2],s=S[3],i=S[4],x=S[5],p=S[6],v=S[7],f=S[8],d=S[9],o=S[10],m=S[11],g[0]=r,g[1]=t,g[2]=h,g[3]=s,g[4]=i,g[5]=x,g[6]=p,g[7]=v,g[8]=f,g[9]=d,g[10]=o,g[11]=m,g[12]=r*e+i*a+f*n+S[12],g[13]=t*e+x*a+d*n+S[13],g[14]=h*e+p*a+o*n+S[14],g[15]=s*e+v*a+m*n+S[15]),g}},{}],224:[function(y,ee,te){ee.exports=A;function A(g,S){if(g===S){var M=S[1],e=S[2],a=S[3],n=S[6],r=S[7],t=S[11];g[1]=S[4],g[2]=S[8],g[3]=S[12],g[4]=M,g[6]=S[9],g[7]=S[13],g[8]=e,g[9]=n,g[11]=S[14],g[12]=a,g[13]=r,g[14]=t}else g[0]=S[0],g[1]=S[4],g[2]=S[8],g[3]=S[12],g[4]=S[1],g[5]=S[5],g[6]=S[9],g[7]=S[13],g[8]=S[2],g[9]=S[6],g[10]=S[10],g[11]=S[14],g[12]=S[3],g[13]=S[7],g[14]=S[11],g[15]=S[15];return g}},{}],225:[function(y,ee,te){var A=y("css-font"),g=y("pick-by-alias"),S=y("regl"),M=y("gl-util/context"),e=y("es6-weak-map"),a=y("color-normalize"),n=y("font-atlas"),r=y("typedarray-pool"),t=y("parse-rect"),h=y("is-plain-obj"),s=y("parse-unit"),i=y("to-px"),x=y("detect-kerning"),p=y("object-assign"),v=y("font-measure"),f=y("flatten-vertex-data"),d=y("bit-twiddle"),o=d.nextPow2,m=new e,l=!1;if(document.body){var w=document.body.appendChild(document.createElement("div"));w.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(w).fontStretch&&(l=!0),document.body.removeChild(w)}var _=function(u){c(u)?(u={regl:u},this.gl=u.regl._gl):this.gl=M(u),this.shader=m.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=u.regl||S({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),m.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(h(u)?u:{})};_.prototype.createShader=function(){var u=this.regl,L=u({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:u.prop("count"),offset:u.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:u.this("sizeBuffer")},width:{offset:0,stride:8,buffer:u.this("sizeBuffer")},char:u.this("charBuffer"),position:u.this("position")},uniforms:{atlasSize:function(k,P){return[P.atlas.width,P.atlas.height]},atlasDim:function(k,P){return[P.atlas.cols,P.atlas.rows]},atlas:function(k,P){return P.atlas.texture},charStep:function(k,P){return P.atlas.step},em:function(k,P){return P.atlas.em},color:u.prop("color"),opacity:u.prop("opacity"),viewport:u.this("viewportArray"),scale:u.this("scale"),align:u.prop("align"),baseline:u.prop("baseline"),translate:u.this("translate"),positionOffset:u.prop("positionOffset")},primitive:"points",viewport:u.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`}),T={};return{regl:u,draw:L,atlas:T}},_.prototype.update=function(u){var L=this;if(typeof u=="string")u={text:u};else if(!u)return;u=g(u,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),u.opacity!=null&&(Array.isArray(u.opacity)?this.opacity=u.opacity.map(function(we){return parseFloat(we)}):this.opacity=parseFloat(u.opacity)),u.viewport!=null&&(this.viewport=t(u.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),u.kerning!=null&&(this.kerning=u.kerning),u.offset!=null&&(typeof u.offset=="number"&&(u.offset=[u.offset,0]),this.positionOffset=f(u.offset)),u.direction&&(this.direction=u.direction),u.range&&(this.range=u.range,this.scale=[1/(u.range[2]-u.range[0]),1/(u.range[3]-u.range[1])],this.translate=[-u.range[0],-u.range[1]]),u.scale&&(this.scale=u.scale),u.translate&&(this.translate=u.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),!this.font.length&&!u.font&&(u.font=_.baseFontSize+"px sans-serif");var T=!1,k=!1;if(u.font&&(Array.isArray(u.font)?u.font:[u.font]).forEach(function(we,ke){if(typeof we=="string")try{we=A.parse(we)}catch{we=A.parse(_.baseFontSize+"px "+we)}else we=A.parse(A.stringify(we));var Xe=A.stringify({size:_.baseFontSize,family:we.family,stretch:l?we.stretch:void 0,variant:we.variant,weight:we.weight,style:we.style}),Ve=s(we.size),Ie=Math.round(Ve[0]*i(Ve[1]));if(Ie!==L.fontSize[ke]&&(k=!0,L.fontSize[ke]=Ie),(!L.font[ke]||Xe!=L.font[ke].baseString)&&(T=!0,L.font[ke]=_.fonts[Xe],!L.font[ke])){var De=we.family.join(", "),Ye=[we.style];we.style!=we.variant&&Ye.push(we.variant),we.variant!=we.weight&&Ye.push(we.weight),l&&we.weight!=we.stretch&&Ye.push(we.stretch),L.font[ke]={baseString:Xe,family:De,weight:we.weight,stretch:we.stretch,style:we.style,variant:we.variant,width:{},kerning:{},metrics:v(De,{origin:"top",fontSize:_.baseFontSize,fontStyle:Ye.join(" ")})},_.fonts[Xe]=L.font[ke]}}),(T||k)&&this.font.forEach(function(we,ke){var Xe=A.stringify({size:L.fontSize[ke],family:we.family,stretch:l?we.stretch:void 0,variant:we.variant,weight:we.weight,style:we.style});if(L.fontAtlas[ke]=L.shader.atlas[Xe],!L.fontAtlas[ke]){var Ve=we.metrics;L.shader.atlas[Xe]=L.fontAtlas[ke]={fontString:Xe,step:Math.ceil(L.fontSize[ke]*Ve.bottom*.5)*2,em:L.fontSize[ke],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:L.regl.texture()}}u.text==null&&(u.text=L.text)}),typeof u.text=="string"&&u.position&&u.position.length>2){for(var P=Array(u.position.length*.5),z=0;z<P.length;z++)P[z]=u.text;u.text=P}var I;if(u.text!=null||T){if(this.textOffsets=[0],Array.isArray(u.text)){this.count=u.text[0].length,this.counts=[this.count];for(var D=1;D<u.text.length;D++)this.textOffsets[D]=this.textOffsets[D-1]+u.text[D-1].length,this.count+=u.text[D].length,this.counts.push(u.text[D].length);this.text=u.text.join("")}else this.text=u.text,this.count=this.text.length,this.counts=[this.count];I=[],this.font.forEach(function(we,ke){_.atlasContext.font=we.baseString;for(var Xe=L.fontAtlas[ke],Ve=0;Ve<L.text.length;Ve++){var Ie=L.text.charAt(Ve);if(Xe.ids[Ie]==null&&(Xe.ids[Ie]=Xe.chars.length,Xe.chars.push(Ie),I.push(Ie)),we.width[Ie]==null&&(we.width[Ie]=_.atlasContext.measureText(Ie).width/_.baseFontSize,L.kerning)){var De=[];for(var Ye in we.width)De.push(Ye+Ie,Ie+Ye);p(we.kerning,x(we.family,{pairs:De}))}}})}if(u.position)if(u.position.length>2){for(var R=!u.position[0].length,O=r.mallocFloat(this.count*2),F=0,N=0;F<this.counts.length;F++){var G=this.counts[F];if(R)for(var K=0;K<G;K++)O[N++]=u.position[F*2],O[N++]=u.position[F*2+1];else for(var W=0;W<G;W++)O[N++]=u.position[F][0],O[N++]=u.position[F][1]}this.position.call?this.position({type:"float",data:O}):this.position=this.regl.buffer({type:"float",data:O}),r.freeFloat(O)}else this.position.destroy&&this.position.destroy(),this.position={constant:u.position};if(u.text||T){var Y=r.mallocUint8(this.count),re=r.mallocFloat(this.count*2);this.textWidth=[];for(var ue=0,j=0;ue<this.counts.length;ue++){for(var q=this.counts[ue],H=this.font[ue]||this.font[0],U=this.fontAtlas[ue]||this.fontAtlas[0],$=0;$<q;$++){var ne=this.text.charAt(j),X=this.text.charAt(j-1);if(Y[j]=U.ids[ne],re[j*2]=H.width[ne],$){var Q=re[j*2-2],ie=re[j*2],se=re[j*2-1],ae=se+Q*.5+ie*.5;if(this.kerning){var oe=H.kerning[X+ne];oe&&(ae+=oe*.001)}re[j*2+1]=ae}else re[j*2+1]=re[j*2]*.5;j++}this.textWidth.push(re.length?re[j*2-2]*.5+re[j*2-1]:0)}u.align||(u.align=this.align),this.charBuffer({data:Y,type:"uint8",usage:"stream"}),this.sizeBuffer({data:re,type:"float",usage:"stream"}),r.freeUint8(Y),r.freeFloat(re),I.length&&this.font.forEach(function(we,ke){var Xe=L.fontAtlas[ke],Ve=Xe.step,Ie=Math.floor(_.maxAtlasSize/Ve),De=Math.min(Ie,Xe.chars.length),Ye=Math.ceil(Xe.chars.length/De),vt=o(De*Ve),Dt=o(Ye*Ve);Xe.width=vt,Xe.height=Dt,Xe.rows=Ye,Xe.cols=De,Xe.em&&Xe.texture({data:n({canvas:_.atlasCanvas,font:Xe.fontString,chars:Xe.chars,shape:[vt,Dt],step:[Ve,Ve]})})})}if(u.align&&(this.align=u.align,this.alignOffset=this.textWidth.map(function(we,ke){var Xe=Array.isArray(L.align)?L.align.length>1?L.align[ke]:L.align[0]:L.align;if(typeof Xe=="number")return Xe;switch(Xe){case"right":case"end":return-we;case"center":case"centre":case"middle":return-we*.5}return 0})),this.baseline==null&&u.baseline==null&&(u.baseline=0),u.baseline!=null&&(this.baseline=u.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(we,ke){var Xe=(L.font[ke]||L.font[0]).metrics,Ve=0;return Ve+=Xe.bottom*.5,typeof we=="number"?Ve+=we-Xe.baseline:Ve+=-Xe[we],Ve*=-1,Ve})),u.color!=null)if(u.color||(u.color="transparent"),typeof u.color=="string"||!isNaN(u.color))this.color=a(u.color,"uint8");else{var be;if(typeof u.color[0]=="number"&&u.color.length>this.counts.length){var ce=u.color.length;be=r.mallocUint8(ce);for(var de=(u.color.subarray||u.color.slice).bind(u.color),ye=0;ye<ce;ye+=4)be.set(a(de(ye,ye+4),"uint8"),ye)}else{var ge=u.color.length;be=r.mallocUint8(ge*4);for(var me=0;me<ge;me++)be.set(a(u.color[me]||0,"uint8"),me*4)}this.color=be}if(u.position||u.text||u.color||u.baseline||u.align||u.font||u.offset||u.opacity){var Ee=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(Ee){var Pe=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array(Pe);for(var Ue=0;Ue<this.batch.length;Ue++)this.batch[Ue]={count:this.counts.length>1?this.counts[Ue]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[Ue]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(Ue*4,Ue*4+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[Ue]:this.opacity,baseline:this.baselineOffset[Ue]!=null?this.baselineOffset[Ue]:this.baselineOffset[0],align:this.align?this.alignOffset[Ue]!=null?this.alignOffset[Ue]:this.alignOffset[0]:0,atlas:this.fontAtlas[Ue]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(Ue*2,Ue*2+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]}},_.prototype.destroy=function(){},_.prototype.kerning=!0,_.prototype.position={constant:new Float32Array(2)},_.prototype.translate=null,_.prototype.scale=null,_.prototype.font=null,_.prototype.text="",_.prototype.positionOffset=[0,0],_.prototype.opacity=1,_.prototype.color=new Uint8Array([0,0,0,255]),_.prototype.alignOffset=[0,0],_.maxAtlasSize=1024,_.atlasCanvas=document.createElement("canvas"),_.atlasContext=_.atlasCanvas.getContext("2d",{alpha:!1}),_.baseFontSize=64,_.fonts={};function c(b){return typeof b=="function"&&b._gl&&b.prop&&b.texture&&b.buffer}ee.exports=_},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(y,ee,te){(function(A){(function(){var g=y("pick-by-alias");ee.exports=function(t){if(t?typeof t=="string"&&(t={container:t}):t={},M(t)?t={container:t}:e(t)?t={container:t}:a(t)?t={gl:t}:t=g(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=A.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if(typeof t.container=="string"){var h=document.querySelector(t.container);if(!h)throw Error("Element "+t.container+" is not found");t.container=h}M(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):t.canvas||(t.canvas=n(),t.container.appendChild(t.canvas),S(t))}else if(!t.canvas)if(typeof document<"u")t.container=document.body||document.documentElement,t.canvas=n(),t.container.appendChild(t.canvas),S(t);else throw Error("Not DOM environment. Use headless-gl.");return t.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(s){try{t.gl=t.canvas.getContext(s,t.attrs)}catch{}return t.gl}),t.gl};function S(r){if(r.container)if(r.container==document.body)document.body.style.width||(r.canvas.width=r.width||r.pixelRatio*A.innerWidth),document.body.style.height||(r.canvas.height=r.height||r.pixelRatio*A.innerHeight);else{var t=r.container.getBoundingClientRect();r.canvas.width=r.width||t.right-t.left,r.canvas.height=r.height||t.bottom-t.top}}function M(r){return typeof r.getContext=="function"&&"width"in r&&"height"in r}function e(r){return typeof r.nodeName=="string"&&typeof r.appendChild=="function"&&typeof r.getBoundingClientRect=="function"}function a(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}function n(){var r=document.createElement("canvas");return r.style.position="absolute",r.style.top=0,r.style.left=0,r}}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(y,ee,te){ee.exports=function(A){typeof A=="string"&&(A=[A]);for(var g=[].slice.call(arguments,1),S=[],M=0;M<A.length-1;M++)S.push(A[M],g[M]||"");return S.push(A[M]),S.join("")}},{}],228:[function(y,ee,te){(function(A){(function(){var g=y("is-browser"),S;typeof A.matchMedia=="function"?S=!A.matchMedia("(hover: none)").matches:S=g,ee.exports=S}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(y,ee,te){var A=y("is-browser");function g(){var S=!1;try{var M=Object.defineProperty({},"passive",{get:function(){S=!0}});window.addEventListener("test",null,M),window.removeEventListener("test",null,M)}catch{S=!1}return S}ee.exports=A&&g()},{"is-browser":232}],230:[function(y,ee,te){te.read=function(A,g,S,M,e){var a,n,r=e*8-M-1,t=(1<<r)-1,h=t>>1,s=-7,i=S?e-1:0,x=S?-1:1,p=A[g+i];for(i+=x,a=p&(1<<-s)-1,p>>=-s,s+=r;s>0;a=a*256+A[g+i],i+=x,s-=8);for(n=a&(1<<-s)-1,a>>=-s,s+=M;s>0;n=n*256+A[g+i],i+=x,s-=8);if(a===0)a=1-h;else{if(a===t)return n?NaN:(p?-1:1)*(1/0);n=n+Math.pow(2,M),a=a-h}return(p?-1:1)*n*Math.pow(2,a-M)},te.write=function(A,g,S,M,e,a){var n,r,t,h=a*8-e-1,s=(1<<h)-1,i=s>>1,x=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=M?0:a-1,v=M?1:-1,f=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(r=isNaN(g)?1:0,n=s):(n=Math.floor(Math.log(g)/Math.LN2),g*(t=Math.pow(2,-n))<1&&(n--,t*=2),n+i>=1?g+=x/t:g+=x*Math.pow(2,1-i),g*t>=2&&(n++,t/=2),n+i>=s?(r=0,n=s):n+i>=1?(r=(g*t-1)*Math.pow(2,e),n=n+i):(r=g*Math.pow(2,i-1)*Math.pow(2,e),n=0));e>=8;A[S+p]=r&255,p+=v,r/=256,e-=8);for(n=n<<e|r,h+=e;h>0;A[S+p]=n&255,p+=v,n/=256,h-=8);A[S+p-v]|=f*128}},{}],231:[function(y,ee,te){typeof Object.create=="function"?ee.exports=function(g,S){S&&(g.super_=S,g.prototype=Object.create(S.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}))}:ee.exports=function(g,S){if(S){g.super_=S;var M=function(){};M.prototype=S.prototype,g.prototype=new M,g.prototype.constructor=g}}},{}],232:[function(y,ee,te){ee.exports=!0},{}],233:[function(y,ee,te){ee.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(y,ee,te){ee.exports=S,ee.exports.isMobile=S,ee.exports.default=S;var A=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function S(M){M||(M={});var e=M.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var a=M.tablet?g.test(e):A.test(e);return!a&&M.tablet&&M.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(a=!0),a}},{}],235:[function(y,ee,te){ee.exports=function(A){var g=typeof A;return A!==null&&(g==="object"||g==="function")}},{}],236:[function(y,ee,te){var A=Object.prototype.toString;ee.exports=function(g){var S;return A.call(g)==="[object Object]"&&(S=Object.getPrototypeOf(g),S===null||S===Object.getPrototypeOf({}))}},{}],237:[function(y,ee,te){ee.exports=function(A){for(var g=A.length,S,M=0;M<g;M++)if(S=A.charCodeAt(M),(S<9||S>13)&&S!==32&&S!==133&&S!==160&&S!==5760&&S!==6158&&(S<8192||S>8205)&&S!==8232&&S!==8233&&S!==8239&&S!==8287&&S!==8288&&S!==12288&&S!==65279)return!1;return!0}},{}],238:[function(y,ee,te){ee.exports=function(g){return typeof g!="string"?!1:(g=g.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(g)&&/[\dz]$/i.test(g)&&g.length>4))}},{}],239:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?ee.exports=g():(A=A||self,A.mapboxgl=g())})(this,function(){var A,g,S;function M(e,a){if(!A)A=a;else if(!g)g=a;else{var n="var sharedChunk = {}; ("+A+")(sharedChunk); ("+g+")(sharedChunk);",r={};A(r),S=a(r),S.workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"}))}}return M(["exports"],function(e){function a(E,C){return C={exports:{}},E(C,C.exports),C.exports}var n="1.10.1",r=t;function t(E,C,B,J){this.cx=3*E,this.bx=3*(B-E)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*C,this.by=3*(J-C)-this.cy,this.ay=1-this.cy-this.by,this.p1x=E,this.p1y=J,this.p2x=B,this.p2y=J}t.prototype.sampleCurveX=function(E){return((this.ax*E+this.bx)*E+this.cx)*E},t.prototype.sampleCurveY=function(E){return((this.ay*E+this.by)*E+this.cy)*E},t.prototype.sampleCurveDerivativeX=function(E){return(3*this.ax*E+2*this.bx)*E+this.cx},t.prototype.solveCurveX=function(E,C){typeof C>"u"&&(C=1e-6);var B,J,he,xe,Te;for(he=E,Te=0;Te<8;Te++){if(xe=this.sampleCurveX(he)-E,Math.abs(xe)<C)return he;var Fe=this.sampleCurveDerivativeX(he);if(Math.abs(Fe)<1e-6)break;he=he-xe/Fe}if(B=0,J=1,he=E,he<B)return B;if(he>J)return J;for(;B<J;){if(xe=this.sampleCurveX(he),Math.abs(xe-E)<C)return he;E>xe?B=he:J=he,he=(J-B)*.5+B}return he},t.prototype.solve=function(E,C){return this.sampleCurveY(this.solveCurveX(E,C))};var h=s;function s(E,C){this.x=E,this.y=C}s.prototype={clone:function(){return new s(this.x,this.y)},add:function(E){return this.clone()._add(E)},sub:function(E){return this.clone()._sub(E)},multByPoint:function(E){return this.clone()._multByPoint(E)},divByPoint:function(E){return this.clone()._divByPoint(E)},mult:function(E){return this.clone()._mult(E)},div:function(E){return this.clone()._div(E)},rotate:function(E){return this.clone()._rotate(E)},rotateAround:function(E,C){return this.clone()._rotateAround(E,C)},matMult:function(E){return this.clone()._matMult(E)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(E){return this.x===E.x&&this.y===E.y},dist:function(E){return Math.sqrt(this.distSqr(E))},distSqr:function(E){var C=E.x-this.x,B=E.y-this.y;return C*C+B*B},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(E){return Math.atan2(this.y-E.y,this.x-E.x)},angleWith:function(E){return this.angleWithSep(E.x,E.y)},angleWithSep:function(E,C){return Math.atan2(this.x*C-this.y*E,this.x*E+this.y*C)},_matMult:function(E){var C=E[0]*this.x+E[1]*this.y,B=E[2]*this.x+E[3]*this.y;return this.x=C,this.y=B,this},_add:function(E){return this.x+=E.x,this.y+=E.y,this},_sub:function(E){return this.x-=E.x,this.y-=E.y,this},_mult:function(E){return this.x*=E,this.y*=E,this},_div:function(E){return this.x/=E,this.y/=E,this},_multByPoint:function(E){return this.x*=E.x,this.y*=E.y,this},_divByPoint:function(E){return this.x/=E.x,this.y/=E.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var E=this.y;return this.y=this.x,this.x=-E,this},_rotate:function(E){var C=Math.cos(E),B=Math.sin(E),J=C*this.x-B*this.y,he=B*this.x+C*this.y;return this.x=J,this.y=he,this},_rotateAround:function(E,C){var B=Math.cos(E),J=Math.sin(E),he=C.x+B*(this.x-C.x)-J*(this.y-C.y),xe=C.y+J*(this.x-C.x)+B*(this.y-C.y);return this.x=he,this.y=xe,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},s.convert=function(E){return E instanceof s?E:Array.isArray(E)?new s(E[0],E[1]):E};function i(E,C){if(Array.isArray(E)){if(!Array.isArray(C)||E.length!==C.length)return!1;for(var B=0;B<E.length;B++)if(!i(E[B],C[B]))return!1;return!0}if(typeof E=="object"&&E!==null&&C!==null){if(typeof C!="object")return!1;var J=Object.keys(E);if(J.length!==Object.keys(C).length)return!1;for(var he in E)if(!i(E[he],C[he]))return!1;return!0}return E===C}function x(E){if(E<=0)return 0;if(E>=1)return 1;var C=E*E,B=C*E;return 4*(E<.5?B:3*(E-C)+B-.75)}function p(E,C,B,J){var he=new r(E,C,B,J);return function(xe){return he.solve(xe)}}var v=p(.25,.1,.25,1);function f(E,C,B){return Math.min(B,Math.max(C,E))}function d(E,C,B){var J=B-C,he=((E-C)%J+J)%J+C;return he===C?B:he}function o(E,C,B){if(!E.length)return B(null,[]);var J=E.length,he=new Array(E.length),xe=null;E.forEach(function(Te,Fe){C(Te,function($e,ft){$e&&(xe=$e),he[Fe]=ft,--J===0&&B(xe,he)})})}function m(E){var C=[];for(var B in E)C.push(E[B]);return C}function l(E,C){var B=[];for(var J in E)J in C||B.push(J);return B}function w(E){for(var C=[],B=arguments.length-1;B-- >0;)C[B]=arguments[B+1];for(var J=0,he=C;J<he.length;J+=1){var xe=he[J];for(var Te in xe)E[Te]=xe[Te]}return E}function _(E,C){for(var B={},J=0;J<C.length;J++){var he=C[J];he in E&&(B[he]=E[he])}return B}var c=1;function b(){return c++}function u(){function E(C){return C?(C^Math.random()*16>>C/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,E)}return E()}function L(E){return E?/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(E):!1}function T(E,C){E.forEach(function(B){C[B]&&(C[B]=C[B].bind(C))})}function k(E,C){return E.indexOf(C,E.length-C.length)!==-1}function P(E,C,B){var J={};for(var he in E)J[he]=C.call(B||this,E[he],he,E);return J}function z(E,C,B){var J={};for(var he in E)C.call(B||this,E[he],he,E)&&(J[he]=E[he]);return J}function I(E){return Array.isArray(E)?E.map(I):typeof E=="object"&&E?P(E,I):E}function D(E,C){for(var B=0;B<E.length;B++)if(C.indexOf(E[B])>=0)return!0;return!1}var R={};function O(E){R[E]||(typeof console<"u"&&console.warn(E),R[E]=!0)}function F(E,C,B){return(B.y-E.y)*(C.x-E.x)>(C.y-E.y)*(B.x-E.x)}function N(E){for(var C=0,B=0,J=E.length,he=J-1,xe=void 0,Te=void 0;B<J;he=B++)xe=E[B],Te=E[he],C+=(Te.x-xe.x)*(xe.y+Te.y);return C}function G(E){var C=E[0],B=E[1],J=E[2];return B+=90,B*=Math.PI/180,J*=Math.PI/180,{x:C*Math.cos(B)*Math.sin(J),y:C*Math.sin(B)*Math.sin(J),z:C*Math.cos(J)}}function K(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function W(E){var C=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,B={};if(E.replace(C,function(he,xe,Te,Fe){var $e=Te||Fe;return B[xe]=$e?$e.toLowerCase():!0,""}),B["max-age"]){var J=parseInt(B["max-age"],10);isNaN(J)?delete B["max-age"]:B["max-age"]=J}return B}var Y=null;function re(E){if(Y==null){var C=E.navigator?E.navigator.userAgent:null;Y=!!E.safari||!!(C&&(/\b(iPad|iPhone|iPod)\b/.test(C)||C.match("Safari")&&!C.match("Chrome")))}return Y}function ue(E){try{var C=self[E];return C.setItem("_mapbox_test_",1),C.removeItem("_mapbox_test_"),!0}catch{return!1}}function j(E){return self.btoa(encodeURIComponent(E).replace(/%([0-9A-F]{2})/g,function(C,B){return String.fromCharCode(+("0x"+B))}))}function q(E){return decodeURIComponent(self.atob(E).split("").map(function(C){return"%"+("00"+C.charCodeAt(0).toString(16)).slice(-2)}).join(""))}var H=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),U=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,$=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,ne,X,Q={now:H,frame:function(C){var B=U(C);return{cancel:function(){return $(B)}}},getImageData:function(C,B){B===void 0&&(B=0);var J=self.document.createElement("canvas"),he=J.getContext("2d");if(!he)throw new Error("failed to create canvas 2d context");return J.width=C.width,J.height=C.height,he.drawImage(C,0,0,C.width,C.height),he.getImageData(-B,-B,C.width+2*B,C.height+2*B)},resolveURL:function(C){return ne||(ne=self.document.createElement("a")),ne.href=C,ne.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return self.matchMedia?(X==null&&(X=self.matchMedia("(prefers-reduced-motion: reduce)")),X.matches):!1}},ie={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},se={supported:!1,testSupport:de},ae,oe=!1,be,ce=!1;self.document&&(be=self.document.createElement("img"),be.onload=function(){ae&&ye(ae),ae=null,ce=!0},be.onerror=function(){oe=!0,ae=null},be.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function de(E){oe||!be||(ce?ye(E):ae=E)}function ye(E){var C=E.createTexture();E.bindTexture(E.TEXTURE_2D,C);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,be),E.isContextLost())return;se.supported=!0}catch{}E.deleteTexture(C),oe=!0}var ge="01";function me(){for(var E="1",C="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",B="",J=0;J<10;J++)B+=C[Math.floor(Math.random()*62)];var he=12*60*60*1e3,xe=[E,ge,B].join(""),Te=Date.now()+he;return{token:xe,tokenExpiresAt:Te}}var Ee=function(C,B){this._transformRequestFn=C,this._customAccessToken=B,this._createSkuToken()};Ee.prototype._createSkuToken=function(){var C=me();this._skuToken=C.token,this._skuTokenExpiresAt=C.tokenExpiresAt},Ee.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ee.prototype.transformRequest=function(C,B){return this._transformRequestFn?this._transformRequestFn(C,B)||{url:C}:{url:C}},Ee.prototype.normalizeStyleURL=function(C,B){if(!Pe(C))return C;var J=Ie(C);return J.path="/styles/v1"+J.path,this._makeAPIURL(J,this._customAccessToken||B)},Ee.prototype.normalizeGlyphsURL=function(C,B){if(!Pe(C))return C;var J=Ie(C);return J.path="/fonts/v1"+J.path,this._makeAPIURL(J,this._customAccessToken||B)},Ee.prototype.normalizeSourceURL=function(C,B){if(!Pe(C))return C;var J=Ie(C);return J.path="/v4/"+J.authority+".json",J.params.push("secure"),this._makeAPIURL(J,this._customAccessToken||B)},Ee.prototype.normalizeSpriteURL=function(C,B,J,he){var xe=Ie(C);return Pe(C)?(xe.path="/styles/v1"+xe.path+"/sprite"+B+J,this._makeAPIURL(xe,this._customAccessToken||he)):(xe.path+=""+B+J,De(xe))},Ee.prototype.normalizeTileURL=function(C,B){if(this._isSkuTokenExpired()&&this._createSkuToken(),C&&!Pe(C))return C;var J=Ie(C),he=/(\.(png|jpg)\d*)(?=$)/,xe=/^.+\/v4\//,Te=Q.devicePixelRatio>=2||B===512?"@2x":"",Fe=se.supported?".webp":"$1";J.path=J.path.replace(he,""+Te+Fe),J.path=J.path.replace(xe,"/"),J.path="/v4"+J.path;var $e=this._customAccessToken||Xe(J.params)||ie.ACCESS_TOKEN;return ie.REQUIRE_ACCESS_TOKEN&&$e&&this._skuToken&&J.params.push("sku="+this._skuToken),this._makeAPIURL(J,$e)},Ee.prototype.canonicalizeTileURL=function(C,B){var J="/v4/",he=/\.[\w]+$/,xe=Ie(C);if(!xe.path.match(/(^\/v4\/)/)||!xe.path.match(he))return C;var Te="mapbox://tiles/";Te+=xe.path.replace(J,"");var Fe=xe.params;return B&&(Fe=Fe.filter(function($e){return!$e.match(/^access_token=/)})),Fe.length&&(Te+="?"+Fe.join("&")),Te},Ee.prototype.canonicalizeTileset=function(C,B){for(var J=B?Pe(B):!1,he=[],xe=0,Te=C.tiles||[];xe<Te.length;xe+=1){var Fe=Te[xe];we(Fe)?he.push(this.canonicalizeTileURL(Fe,J)):he.push(Fe)}return he},Ee.prototype._makeAPIURL=function(C,B){var J="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",he=Ie(ie.API_URL);if(C.protocol=he.protocol,C.authority=he.authority,he.path!=="/"&&(C.path=""+he.path+C.path),!ie.REQUIRE_ACCESS_TOKEN)return De(C);if(B=B||ie.ACCESS_TOKEN,!B)throw new Error("An API access token is required to use Mapbox GL. "+J);if(B[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+J);return C.params=C.params.filter(function(xe){return xe.indexOf("access_token")===-1}),C.params.push("access_token="+B),De(C)};function Pe(E){return E.indexOf("mapbox:")===0}var Ue=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function we(E){return Ue.test(E)}function ke(E){return E.indexOf("sku=")>0&&we(E)}function Xe(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C],he=J.match(/^access_token=(.*)$/);if(he)return he[1]}return null}var Ve=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ie(E){var C=E.match(Ve);if(!C)throw new Error("Unable to parse URL object");return{protocol:C[1],authority:C[2],path:C[3]||"/",params:C[4]?C[4].split("&"):[]}}function De(E){var C=E.params.length?"?"+E.params.join("&"):"";return E.protocol+"://"+E.authority+E.path+C}var Ye="mapbox.eventData";function vt(E){if(!E)return null;var C=E.split(".");if(!C||C.length!==3)return null;try{var B=JSON.parse(q(C[1]));return B}catch{return null}}var Dt=function(C){this.type=C,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Dt.prototype.getStorageKey=function(C){var B=vt(ie.ACCESS_TOKEN),J="";return B&&B.u?J=j(B.u):J=ie.ACCESS_TOKEN||"",C?Ye+"."+C+":"+J:Ye+":"+J},Dt.prototype.fetchEventData=function(){var C=ue("localStorage"),B=this.getStorageKey(),J=this.getStorageKey("uuid");if(C)try{var he=self.localStorage.getItem(B);he&&(this.eventData=JSON.parse(he));var xe=self.localStorage.getItem(J);xe&&(this.anonId=xe)}catch{O("Unable to read from LocalStorage")}},Dt.prototype.saveEventData=function(){var C=ue("localStorage"),B=this.getStorageKey(),J=this.getStorageKey("uuid");if(C)try{self.localStorage.setItem(J,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(B,JSON.stringify(this.eventData))}catch{O("Unable to write to LocalStorage")}},Dt.prototype.processRequests=function(C){},Dt.prototype.postEvent=function(C,B,J,he){var xe=this;if(ie.EVENTS_URL){var Te=Ie(ie.EVENTS_URL);Te.params.push("access_token="+(he||ie.ACCESS_TOKEN||""));var Fe={event:this.type,created:new Date(C).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:ge,userId:this.anonId},$e=B?w(Fe,B):Fe,ft={url:De(Te),headers:{"Content-Type":"text/plain"},body:JSON.stringify([$e])};this.pendingRequest=Tt(ft,function(pt){xe.pendingRequest=null,J(pt),xe.saveEventData(),xe.processRequests(he)})}},Dt.prototype.queueRequest=function(C,B){this.queue.push(C),this.processRequests(B)};var Kt=function(E){function C(){E.call(this,"map.load"),this.success={},this.skuToken=""}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.postMapLoadEvent=function(J,he,xe,Te){this.skuToken=xe,(ie.EVENTS_URL&&Te||ie.ACCESS_TOKEN&&Array.isArray(J)&&J.some(function(Fe){return Pe(Fe)||we(Fe)}))&&this.queueRequest({id:he,timestamp:Date.now()},Te)},C.prototype.processRequests=function(J){var he=this;if(!(this.pendingRequest||this.queue.length===0)){var xe=this.queue.shift(),Te=xe.id,Fe=xe.timestamp;Te&&this.success[Te]||(this.anonId||this.fetchEventData(),L(this.anonId)||(this.anonId=u()),this.postEvent(Fe,{skuToken:this.skuToken},function($e){$e||Te&&(he.success[Te]=!0)},J))}},C}(Dt),Ft=function(E){function C(B){E.call(this,"appUserTurnstile"),this._customAccessToken=B}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.postTurnstileEvent=function(J,he){ie.EVENTS_URL&&ie.ACCESS_TOKEN&&Array.isArray(J)&&J.some(function(xe){return Pe(xe)||we(xe)})&&this.queueRequest(Date.now(),he)},C.prototype.processRequests=function(J){var he=this;if(!(this.pendingRequest||this.queue.length===0)){(!this.anonId||!this.eventData.lastSuccess||!this.eventData.tokenU)&&this.fetchEventData();var xe=vt(ie.ACCESS_TOKEN),Te=xe?xe.u:ie.ACCESS_TOKEN,Fe=Te!==this.eventData.tokenU;L(this.anonId)||(this.anonId=u(),Fe=!0);var $e=this.queue.shift();if(this.eventData.lastSuccess){var ft=new Date(this.eventData.lastSuccess),pt=new Date($e),Ot=($e-this.eventData.lastSuccess)/(24*60*60*1e3);Fe=Fe||Ot>=1||Ot<-1||ft.getDate()!==pt.getDate()}else Fe=!0;if(!Fe)return this.processRequests();this.postEvent($e,{"enabled.telemetry":!1},function(rr){rr||(he.eventData.lastSuccess=$e,he.eventData.tokenU=Te)},J)}},C}(Dt),Mt=new Ft,Xt=Mt.postTurnstileEvent.bind(Mt),It=new Kt,At=It.postMapLoadEvent.bind(It),Ge="mapbox-tiles",tt=500,He=50,Ae=1e3*60*7,Ne;function Ze(){self.caches&&!Ne&&(Ne=self.caches.open(Ge))}var Qe;function bt(E,C){if(Qe===void 0)try{new Response(new ReadableStream),Qe=!0}catch{Qe=!1}Qe?C(E.body):E.blob().then(C)}function dt(E,C,B){if(Ze(),!!Ne){var J={status:C.status,statusText:C.statusText,headers:new self.Headers};C.headers.forEach(function(Te,Fe){return J.headers.set(Fe,Te)});var he=W(C.headers.get("Cache-Control")||"");if(!he["no-store"]){he["max-age"]&&J.headers.set("Expires",new Date(B+he["max-age"]*1e3).toUTCString());var xe=new Date(J.headers.get("Expires")).getTime()-B;xe<Ae||bt(C,function(Te){var Fe=new self.Response(Te,J);Ze(),Ne&&Ne.then(function($e){return $e.put(wt(E.url),Fe)}).catch(function($e){return O($e.message)})})}}}function wt(E){var C=E.indexOf("?");return C<0?E:E.slice(0,C)}function Ut(E,C){if(Ze(),!Ne)return C(null);var B=wt(E.url);Ne.then(function(J){J.match(B).then(function(he){var xe=Rt(he);J.delete(B),xe&&J.put(B,he.clone()),C(null,he,xe)}).catch(C)}).catch(C)}function Rt(E){if(!E)return!1;var C=new Date(E.headers.get("Expires")||0),B=W(E.headers.get("Cache-Control")||"");return C>Date.now()&&!B["no-cache"]}var Nt=1/0;function Wt(E){Nt++,Nt>He&&(E.getActor().send("enforceCacheSizeLimit",tt),Nt=0)}function Vt(E){Ze(),Ne&&Ne.then(function(C){C.keys().then(function(B){for(var J=0;J<B.length-E;J++)C.delete(B[J])})})}function ir(E){var C=self.caches.delete(Ge);E&&C.catch(E).then(function(){return E()})}function Hr(E,C){tt=E,He=C}var sn;function jr(){return sn==null&&(sn=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),sn}var at={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(at);var $t=function(E){function C(B,J,he){J===401&&we(he)&&(B+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),E.call(this,B),this.status=J,this.url=he,this.name=this.constructor.name,this.message=B}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},C}(Error),Jt=K()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href},Gt=function(E){return/^file:/.test(E)||/^file:/.test(Jt())&&!/^\w+:/.test(E)};function _r(E,C){var B=new self.AbortController,J=new self.Request(E.url,{method:E.method||"GET",body:E.body,credentials:E.credentials,headers:E.headers,referrer:Jt(),signal:B.signal}),he=!1,xe=!1,Te=ke(J.url);E.type==="json"&&J.headers.set("Accept","application/json");var Fe=function(ft,pt,Ot){if(!xe){if(ft&&ft.message!=="SecurityError"&&O(ft),pt&&Ot)return $e(pt);var rr=Date.now();self.fetch(J).then(function(qt){if(qt.ok){var dr=Te?qt.clone():null;return $e(qt,dr,rr)}else return C(new $t(qt.statusText,qt.status,E.url))}).catch(function(qt){qt.code!==20&&C(new Error(qt.message))})}},$e=function(ft,pt,Ot){(E.type==="arrayBuffer"?ft.arrayBuffer():E.type==="json"?ft.json():ft.text()).then(function(rr){xe||(pt&&Ot&&dt(J,pt,Ot),he=!0,C(null,rr,ft.headers.get("Cache-Control"),ft.headers.get("Expires")))}).catch(function(rr){xe||C(new Error(rr.message))})};return Te?Ut(J,Fe):Fe(null,null),{cancel:function(){xe=!0,he||B.abort()}}}function rt(E,C){var B=new self.XMLHttpRequest;B.open(E.method||"GET",E.url,!0),E.type==="arrayBuffer"&&(B.responseType="arraybuffer");for(var J in E.headers)B.setRequestHeader(J,E.headers[J]);return E.type==="json"&&(B.responseType="text",B.setRequestHeader("Accept","application/json")),B.withCredentials=E.credentials==="include",B.onerror=function(){C(new Error(B.statusText))},B.onload=function(){if((B.status>=200&&B.status<300||B.status===0)&&B.response!==null){var he=B.response;if(E.type==="json")try{he=JSON.parse(B.response)}catch(xe){return C(xe)}C(null,he,B.getResponseHeader("Cache-Control"),B.getResponseHeader("Expires"))}else C(new $t(B.statusText,B.status,E.url))},B.send(E.body),{cancel:function(){return B.abort()}}}var Je=function(E,C){if(!Gt(E.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return _r(E,C);if(K()&&self.worker&&self.worker.actor){var B=!0;return self.worker.actor.send("getResource",E,C,void 0,B)}}return rt(E,C)},st=function(E,C){return Je(w(E,{type:"json"}),C)},lt=function(E,C){return Je(w(E,{type:"arrayBuffer"}),C)},Tt=function(E,C){return Je(w(E,{method:"POST"}),C)};function zt(E){var C=self.document.createElement("a");return C.href=E,C.protocol===self.document.location.protocol&&C.host===self.document.location.host}var Ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Se(E,C,B,J){var he=new self.Image,xe=self.URL;he.onload=function(){C(null,he),xe.revokeObjectURL(he.src)},he.onerror=function(){return C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Te=new self.Blob([new Uint8Array(E)],{type:"image/png"});he.cacheControl=B,he.expires=J,he.src=E.byteLength?xe.createObjectURL(Te):Ce}function nt(E,C){var B=new self.Blob([new Uint8Array(E)],{type:"image/png"});self.createImageBitmap(B).then(function(J){C(null,J)}).catch(function(J){C(new Error("Could not load image because of "+J.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}var it,ct,kt=function(){it=[],ct=0};kt();var gt=function(E,C){if(se.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),ct>=ie.MAX_PARALLEL_IMAGE_REQUESTS){var B={requestParameters:E,callback:C,cancelled:!1,cancel:function(){this.cancelled=!0}};return it.push(B),B}ct++;var J=!1,he=function(){if(!J)for(J=!0,ct--;it.length&&ct<ie.MAX_PARALLEL_IMAGE_REQUESTS;){var Te=it.shift(),Fe=Te.requestParameters,$e=Te.callback,ft=Te.cancelled;ft||(Te.cancel=gt(Fe,$e).cancel)}},xe=lt(E,function(Te,Fe,$e,ft){he(),Te?C(Te):Fe&&(jr()?nt(Fe,C):Se(Fe,C,$e,ft))});return{cancel:function(){xe.cancel(),he()}}},St=function(E,C){var B=self.document.createElement("video");B.muted=!0,B.onloadstart=function(){C(null,B)};for(var J=0;J<E.length;J++){var he=self.document.createElement("source");zt(E[J])||(B.crossOrigin="Anonymous"),he.src=E[J],B.appendChild(he)}return{cancel:function(){}}};function Yt(E,C,B){var J=B[E]&&B[E].indexOf(C)!==-1;J||(B[E]=B[E]||[],B[E].push(C))}function ar(E,C,B){if(B&&B[E]){var J=B[E].indexOf(C);J!==-1&&B[E].splice(J,1)}}var kr=function(C,B){B===void 0&&(B={}),w(this,B),this.type=C},br=function(E){function C(B,J){J===void 0&&(J={}),E.call(this,"error",w({error:B},J))}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(kr),Mr=function(){};Mr.prototype.on=function(C,B){return this._listeners=this._listeners||{},Yt(C,B,this._listeners),this},Mr.prototype.off=function(C,B){return ar(C,B,this._listeners),ar(C,B,this._oneTimeListeners),this},Mr.prototype.once=function(C,B){return this._oneTimeListeners=this._oneTimeListeners||{},Yt(C,B,this._oneTimeListeners),this},Mr.prototype.fire=function(C,B){typeof C=="string"&&(C=new kr(C,B||{}));var J=C.type;if(this.listens(J)){C.target=this;for(var he=this._listeners&&this._listeners[J]?this._listeners[J].slice():[],xe=0,Te=he;xe<Te.length;xe+=1){var Fe=Te[xe];Fe.call(this,C)}for(var $e=this._oneTimeListeners&&this._oneTimeListeners[J]?this._oneTimeListeners[J].slice():[],ft=0,pt=$e;ft<pt.length;ft+=1){var Ot=pt[ft];ar(J,Ot,this._oneTimeListeners),Ot.call(this,C)}var rr=this._eventedParent;rr&&(w(C,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),rr.fire(C))}else C instanceof br&&console.error(C.error);return this},Mr.prototype.listens=function(C){return this._listeners&&this._listeners[C]&&this._listeners[C].length>0||this._oneTimeListeners&&this._oneTimeListeners[C]&&this._oneTimeListeners[C].length>0||this._eventedParent&&this._eventedParent.listens(C)},Mr.prototype.setEventedParent=function(C,B){return this._eventedParent=C,this._eventedParentData=B,this};var Yr=8,nr={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},gr={"*":{type:"source"}},Rr=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Br={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},Sr={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},et={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},Lt={type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Zt={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},or={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Ir={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Or=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Er={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},wr={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Gr={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},wn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},cn={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Bn={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},En={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Vn={type:"array",value:"*"},pa={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},Ma={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},ci={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Va={type:"array",value:"*",minimum:1},ja={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},Wa={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Tr=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],pn={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},fn={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},An={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Zn={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ua={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},ea={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Rn={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Xn={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Ua={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},li={"*":{type:"string"}},Ht={$version:Yr,$root:nr,sources:gr,source:Rr,source_vector:Br,source_raster:Sr,source_raster_dem:et,source_geojson:Lt,source_video:Zt,source_image:or,layer:Ir,layout:Or,layout_background:Er,layout_fill:wr,layout_circle:Gr,layout_heatmap:wn,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:cn,layout_symbol:Bn,layout_raster:En,layout_hillshade:Yn,filter:Vn,filter_operator:pa,geometry_type:Ma,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:ci,expression:Va,expression_name:ja,light:Wa,paint:Tr,paint_fill:pn,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:fn,paint_circle:An,paint_heatmap:Zn,paint_symbol:ua,paint_raster:ea,paint_hillshade:Rn,paint_background:Xn,transition:Ua,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:li},hr=function(C,B,J,he){this.message=(C?C+": ":"")+J,he&&(this.identifier=he),B!=null&&B.__line__&&(this.line=B.__line__)};function rn(E){var C=E.key,B=E.value;return B?[new hr(C,B,"constants have been deprecated as of v8")]:[]}function vn(E){for(var C=[],B=arguments.length-1;B-- >0;)C[B]=arguments[B+1];for(var J=0,he=C;J<he.length;J+=1){var xe=he[J];for(var Te in xe)E[Te]=xe[Te]}return E}function en(E){return E instanceof Number||E instanceof String||E instanceof Boolean?E.valueOf():E}function Tn(E){if(Array.isArray(E))return E.map(Tn);if(E instanceof Object&&!(E instanceof Number||E instanceof String||E instanceof Boolean)){var C={};for(var B in E)C[B]=Tn(E[B]);return C}return en(E)}var xn=function(E){function C(B,J){E.call(this,J),this.message=J,this.key=B}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(Error),un=function(C,B){B===void 0&&(B=[]),this.parent=C,this.bindings={};for(var J=0,he=B;J<he.length;J+=1){var xe=he[J],Te=xe[0],Fe=xe[1];this.bindings[Te]=Fe}};un.prototype.concat=function(C){return new un(this,C)},un.prototype.get=function(C){if(this.bindings[C])return this.bindings[C];if(this.parent)return this.parent.get(C);throw new Error(C+" not found in scope.")},un.prototype.has=function(C){return this.bindings[C]?!0:this.parent?this.parent.has(C):!1};var yr={kind:"null"},mr={kind:"number"},zr={kind:"string"},gn={kind:"boolean"},On={kind:"color"},ta={kind:"object"},_n={kind:"value"},jn={kind:"error"},aa={kind:"collator"},da={kind:"formatted"},ma={kind:"resolvedImage"};function sa(E,C){return{kind:"array",itemType:E,N:C}}function Aa(E){if(E.kind==="array"){var C=Aa(E.itemType);return typeof E.N=="number"?"array<"+C+", "+E.N+">":E.itemType.kind==="value"?"array":"array<"+C+">"}else return E.kind}var vo=[yr,mr,zr,gn,On,da,ta,sa(_n),ma];function Io(E,C){if(C.kind==="error")return null;if(E.kind==="array"){if(C.kind==="array"&&(C.N===0&&C.itemType.kind==="value"||!Io(E.itemType,C.itemType))&&(typeof E.N!="number"||E.N===C.N))return null}else{if(E.kind===C.kind)return null;if(E.kind==="value")for(var B=0,J=vo;B<J.length;B+=1){var he=J[B];if(!Io(he,C))return null}}return"Expected "+Aa(E)+" but found "+Aa(C)+" instead."}function jo(E,C){return C.some(function(B){return B.kind===E.kind})}function nl(E,C){return C.some(function(B){return B==="null"?E===null:B==="array"?Array.isArray(E):B==="object"?E&&!Array.isArray(E)&&typeof E=="object":B===typeof E})}var pl=a(function(E,C){var B={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function J(ft){return ft=Math.round(ft),ft<0?0:ft>255?255:ft}function he(ft){return ft<0?0:ft>1?1:ft}function xe(ft){return ft[ft.length-1]==="%"?J(parseFloat(ft)/100*255):J(parseInt(ft))}function Te(ft){return ft[ft.length-1]==="%"?he(parseFloat(ft)/100):he(parseFloat(ft))}function Fe(ft,pt,Ot){return Ot<0?Ot+=1:Ot>1&&(Ot-=1),Ot*6<1?ft+(pt-ft)*Ot*6:Ot*2<1?pt:Ot*3<2?ft+(pt-ft)*(2/3-Ot)*6:ft}function $e(ft){var pt=ft.replace(/ /g,"").toLowerCase();if(pt in B)return B[pt].slice();if(pt[0]==="#"){if(pt.length===4){var Ot=parseInt(pt.substr(1),16);return Ot>=0&&Ot<=4095?[(Ot&3840)>>4|(Ot&3840)>>8,Ot&240|(Ot&240)>>4,Ot&15|(Ot&15)<<4,1]:null}else if(pt.length===7){var Ot=parseInt(pt.substr(1),16);return Ot>=0&&Ot<=16777215?[(Ot&16711680)>>16,(Ot&65280)>>8,Ot&255,1]:null}return null}var rr=pt.indexOf("("),qt=pt.indexOf(")");if(rr!==-1&&qt+1===pt.length){var dr=pt.substr(0,rr),Fr=pt.substr(rr+1,qt-(rr+1)).split(","),an=1;switch(dr){case"rgba":if(Fr.length!==4)return null;an=Te(Fr.pop());case"rgb":return Fr.length!==3?null:[xe(Fr[0]),xe(Fr[1]),xe(Fr[2]),an];case"hsla":if(Fr.length!==4)return null;an=Te(Fr.pop());case"hsl":if(Fr.length!==3)return null;var $r=(parseFloat(Fr[0])%360+360)%360/360,kn=Te(Fr[1]),mn=Te(Fr[2]),Sn=mn<=.5?mn*(kn+1):mn+kn-mn*kn,In=mn*2-Sn;return[J(Fe(In,Sn,$r+1/3)*255),J(Fe(In,Sn,$r)*255),J(Fe(In,Sn,$r-1/3)*255),an];default:return null}}return null}try{C.parseCSSColor=$e}catch{}}),Yl=pl.parseCSSColor,vi=function(C,B,J,he){he===void 0&&(he=1),this.r=C,this.g=B,this.b=J,this.a=he};vi.parse=function(C){if(C){if(C instanceof vi)return C;if(typeof C=="string"){var B=Yl(C);if(B)return new vi(B[0]/255*B[3],B[1]/255*B[3],B[2]/255*B[3],B[3])}}},vi.prototype.toString=function(){var C=this.toArray(),B=C[0],J=C[1],he=C[2],xe=C[3];return"rgba("+Math.round(B)+","+Math.round(J)+","+Math.round(he)+","+xe+")"},vi.prototype.toArray=function(){var C=this,B=C.r,J=C.g,he=C.b,xe=C.a;return xe===0?[0,0,0,0]:[B*255/xe,J*255/xe,he*255/xe,xe]},vi.black=new vi(0,0,0,1),vi.white=new vi(1,1,1,1),vi.transparent=new vi(0,0,0,0),vi.red=new vi(1,0,0,1);var Vs=function(C,B,J){C?this.sensitivity=B?"variant":"case":this.sensitivity=B?"accent":"base",this.locale=J,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Vs.prototype.compare=function(C,B){return this.collator.compare(C,B)},Vs.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ds=function(C,B,J,he,xe){this.text=C,this.image=B,this.scale=J,this.fontStack=he,this.textColor=xe},Ui=function(C){this.sections=C};Ui.fromString=function(C){return new Ui([new Ds(C,null,null,null,null)])},Ui.prototype.isEmpty=function(){return this.sections.length===0?!0:!this.sections.some(function(C){return C.text.length!==0||C.image&&C.image.name.length!==0})},Ui.factory=function(C){return C instanceof Ui?C:Ui.fromString(C)},Ui.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(C){return C.text}).join("")},Ui.prototype.serialize=function(){for(var C=["format"],B=0,J=this.sections;B<J.length;B+=1){var he=J[B];if(he.image){C.push(["image",he.image.name]);continue}C.push(he.text);var xe={};he.fontStack&&(xe["text-font"]=["literal",he.fontStack.split(",")]),he.scale&&(xe["font-scale"]=he.scale),he.textColor&&(xe["text-color"]=["rgba"].concat(he.textColor.toArray())),C.push(xe)}return C};var Mo=function(C){this.name=C.name,this.available=C.available};Mo.prototype.toString=function(){return this.name},Mo.fromString=function(C){return C?new Mo({name:C,available:!1}):null},Mo.prototype.serialize=function(){return["image",this.name]};function dl(E,C,B,J){if(!(typeof E=="number"&&E>=0&&E<=255&&typeof C=="number"&&C>=0&&C<=255&&typeof B=="number"&&B>=0&&B<=255)){var he=typeof J=="number"?[E,C,B,J]:[E,C,B];return"Invalid rgba value ["+he.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return typeof J>"u"||typeof J=="number"&&J>=0&&J<=1?null:"Invalid rgba value ["+[E,C,B,J].join(", ")+"]: 'a' must be between 0 and 1."}function vs(E){if(E===null)return!0;if(typeof E=="string")return!0;if(typeof E=="boolean")return!0;if(typeof E=="number")return!0;if(E instanceof vi)return!0;if(E instanceof Vs)return!0;if(E instanceof Ui)return!0;if(E instanceof Mo)return!0;if(Array.isArray(E)){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(!vs(J))return!1}return!0}else if(typeof E=="object"){for(var he in E)if(!vs(E[he]))return!1;return!0}else return!1}function Di(E){if(E===null)return yr;if(typeof E=="string")return zr;if(typeof E=="boolean")return gn;if(typeof E=="number")return mr;if(E instanceof vi)return On;if(E instanceof Vs)return aa;if(E instanceof Ui)return da;if(E instanceof Mo)return ma;if(Array.isArray(E)){for(var C=E.length,B,J=0,he=E;J<he.length;J+=1){var xe=he[J],Te=Di(xe);if(!B)B=Te;else{if(B===Te)continue;B=_n;break}}return sa(B||_n,C)}else return ta}function al(E){var C=typeof E;return E===null?"":C==="string"||C==="number"||C==="boolean"?String(E):E instanceof vi||E instanceof Ui||E instanceof Mo?E.toString():JSON.stringify(E)}var Ki=function(C,B){this.type=C,this.value=B};Ki.parse=function(C,B){if(C.length!==2)return B.error("'literal' expression requires exactly one argument, but found "+(C.length-1)+" instead.");if(!vs(C[1]))return B.error("invalid value");var J=C[1],he=Di(J),xe=B.expectedType;return he.kind==="array"&&he.N===0&&xe&&xe.kind==="array"&&(typeof xe.N!="number"||xe.N===0)&&(he=xe),new Ki(he,J)},Ki.prototype.evaluate=function(){return this.value},Ki.prototype.eachChild=function(){},Ki.prototype.outputDefined=function(){return!0},Ki.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof vi?["rgba"].concat(this.value.toArray()):this.value instanceof Ui?this.value.serialize():this.value};var Fi=function(C){this.name="ExpressionEvaluationError",this.message=C};Fi.prototype.toJSON=function(){return this.message};var ao={string:zr,number:mr,boolean:gn,object:ta},Ji=function(C,B){this.type=C,this.args=B};Ji.parse=function(C,B){if(C.length<2)return B.error("Expected at least one argument.");var J=1,he,xe=C[0];if(xe==="array"){var Te;if(C.length>2){var Fe=C[1];if(typeof Fe!="string"||!(Fe in ao)||Fe==="object")return B.error('The item type argument of "array" must be one of string, number, boolean',1);Te=ao[Fe],J++}else Te=_n;var $e;if(C.length>3){if(C[2]!==null&&(typeof C[2]!="number"||C[2]<0||C[2]!==Math.floor(C[2])))return B.error('The length argument to "array" must be a positive integer literal',2);$e=C[2],J++}he=sa(Te,$e)}else he=ao[xe];for(var ft=[];J<C.length;J++){var pt=B.parse(C[J],J,_n);if(!pt)return null;ft.push(pt)}return new Ji(he,ft)},Ji.prototype.evaluate=function(C){for(var B=0;B<this.args.length;B++){var J=this.args[B].evaluate(C),he=Io(this.type,Di(J));if(he){if(B===this.args.length-1)throw new Fi("Expected value to be of type "+Aa(this.type)+", but found "+Aa(Di(J))+" instead.")}else return J}return null},Ji.prototype.eachChild=function(C){this.args.forEach(C)},Ji.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},Ji.prototype.serialize=function(){var C=this.type,B=[C.kind];if(C.kind==="array"){var J=C.itemType;if(J.kind==="string"||J.kind==="number"||J.kind==="boolean"){B.push(J.kind);var he=C.N;(typeof he=="number"||this.args.length>1)&&B.push(he)}}return B.concat(this.args.map(function(xe){return xe.serialize()}))};var ts=function(C){this.type=da,this.sections=C};ts.parse=function(C,B){if(C.length<2)return B.error("Expected at least one argument.");var J=C[1];if(!Array.isArray(J)&&typeof J=="object")return B.error("First argument must be an image or text section.");for(var he=[],xe=!1,Te=1;Te<=C.length-1;++Te){var Fe=C[Te];if(xe&&typeof Fe=="object"&&!Array.isArray(Fe)){xe=!1;var $e=null;if(Fe["font-scale"]&&($e=B.parse(Fe["font-scale"],1,mr),!$e))return null;var ft=null;if(Fe["text-font"]&&(ft=B.parse(Fe["text-font"],1,sa(zr)),!ft))return null;var pt=null;if(Fe["text-color"]&&(pt=B.parse(Fe["text-color"],1,On),!pt))return null;var Ot=he[he.length-1];Ot.scale=$e,Ot.font=ft,Ot.textColor=pt}else{var rr=B.parse(C[Te],1,_n);if(!rr)return null;var qt=rr.type.kind;if(qt!=="string"&&qt!=="value"&&qt!=="null"&&qt!=="resolvedImage")return B.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");xe=!0,he.push({content:rr,scale:null,font:null,textColor:null})}}return new ts(he)},ts.prototype.evaluate=function(C){var B=function(J){var he=J.content.evaluate(C);return Di(he)===ma?new Ds("",he,null,null,null):new Ds(al(he),null,J.scale?J.scale.evaluate(C):null,J.font?J.font.evaluate(C).join(","):null,J.textColor?J.textColor.evaluate(C):null)};return new Ui(this.sections.map(B))},ts.prototype.eachChild=function(C){for(var B=0,J=this.sections;B<J.length;B+=1){var he=J[B];C(he.content),he.scale&&C(he.scale),he.font&&C(he.font),he.textColor&&C(he.textColor)}},ts.prototype.outputDefined=function(){return!1},ts.prototype.serialize=function(){for(var C=["format"],B=0,J=this.sections;B<J.length;B+=1){var he=J[B];C.push(he.content.serialize());var xe={};he.scale&&(xe["font-scale"]=he.scale.serialize()),he.font&&(xe["text-font"]=he.font.serialize()),he.textColor&&(xe["text-color"]=he.textColor.serialize()),C.push(xe)}return C};var Gs=function(C){this.type=ma,this.input=C};Gs.parse=function(C,B){if(C.length!==2)return B.error("Expected two arguments.");var J=B.parse(C[1],1,zr);return J?new Gs(J):B.error("No image name provided.")},Gs.prototype.evaluate=function(C){var B=this.input.evaluate(C),J=Mo.fromString(B);return J&&C.availableImages&&(J.available=C.availableImages.indexOf(B)>-1),J},Gs.prototype.eachChild=function(C){C(this.input)},Gs.prototype.outputDefined=function(){return!1},Gs.prototype.serialize=function(){return["image",this.input.serialize()]};var au={"to-boolean":gn,"to-color":On,"to-number":mr,"to-string":zr},Ko=function(C,B){this.type=C,this.args=B};Ko.parse=function(C,B){if(C.length<2)return B.error("Expected at least one argument.");var J=C[0];if((J==="to-boolean"||J==="to-string")&&C.length!==2)return B.error("Expected one argument.");for(var he=au[J],xe=[],Te=1;Te<C.length;Te++){var Fe=B.parse(C[Te],Te,_n);if(!Fe)return null;xe.push(Fe)}return new Ko(he,xe)},Ko.prototype.evaluate=function(C){if(this.type.kind==="boolean")return!!this.args[0].evaluate(C);if(this.type.kind==="color"){for(var B,J,he=0,xe=this.args;he<xe.length;he+=1){var Te=xe[he];if(B=Te.evaluate(C),J=null,B instanceof vi)return B;if(typeof B=="string"){var Fe=C.parseColor(B);if(Fe)return Fe}else if(Array.isArray(B)&&(B.length<3||B.length>4?J="Invalid rbga value "+JSON.stringify(B)+": expected an array containing either three or four numeric values.":J=dl(B[0],B[1],B[2],B[3]),!J))return new vi(B[0]/255,B[1]/255,B[2]/255,B[3])}throw new Fi(J||"Could not parse color from value '"+(typeof B=="string"?B:String(JSON.stringify(B)))+"'")}else if(this.type.kind==="number"){for(var $e=null,ft=0,pt=this.args;ft<pt.length;ft+=1){var Ot=pt[ft];if($e=Ot.evaluate(C),$e===null)return 0;var rr=Number($e);if(!isNaN(rr))return rr}throw new Fi("Could not convert "+JSON.stringify($e)+" to number.")}else return this.type.kind==="formatted"?Ui.fromString(al(this.args[0].evaluate(C))):this.type.kind==="resolvedImage"?Mo.fromString(al(this.args[0].evaluate(C))):al(this.args[0].evaluate(C))},Ko.prototype.eachChild=function(C){this.args.forEach(C)},Ko.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},Ko.prototype.serialize=function(){if(this.type.kind==="formatted")return new ts([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Gs(this.args[0]).serialize();var C=["to-"+this.type.kind];return this.eachChild(function(B){C.push(B.serialize())}),C};var iu=["Unknown","Point","LineString","Polygon"],Rs=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Rs.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Rs.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?iu[this.feature.type]:this.feature.type:null},Rs.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Rs.prototype.canonicalID=function(){return this.canonical},Rs.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Rs.prototype.parseColor=function(C){var B=this._parseColorCache[C];return B||(B=this._parseColorCache[C]=vi.parse(C)),B};var So=function(C,B,J,he){this.name=C,this.type=B,this._evaluate=J,this.args=he};So.prototype.evaluate=function(C){return this._evaluate(C,this.args)},So.prototype.eachChild=function(C){this.args.forEach(C)},So.prototype.outputDefined=function(){return!1},So.prototype.serialize=function(){return[this.name].concat(this.args.map(function(C){return C.serialize()}))},So.parse=function(C,B){var J,he=C[0],xe=So.definitions[he];if(!xe)return B.error('Unknown expression "'+he+'". If you wanted a literal array, use ["literal", [...]].',0);for(var Te=Array.isArray(xe)?xe[0]:xe.type,Fe=Array.isArray(xe)?[[xe[1],xe[2]]]:xe.overloads,$e=Fe.filter(function(La){var Da=La[0];return!Array.isArray(Da)||Da.length===C.length-1}),ft=null,pt=0,Ot=$e;pt<Ot.length;pt+=1){var rr=Ot[pt],qt=rr[0],dr=rr[1];ft=new ko(B.registry,B.path,null,B.scope);for(var Fr=[],an=!1,$r=1;$r<C.length;$r++){var kn=C[$r],mn=Array.isArray(qt)?qt[$r-1]:qt.type,Sn=ft.parse(kn,1+Fr.length,mn);if(!Sn){an=!0;break}Fr.push(Sn)}if(!an){if(Array.isArray(qt)&&qt.length!==Fr.length){ft.error("Expected "+qt.length+" arguments, but found "+Fr.length+" instead.");continue}for(var In=0;In<Fr.length;In++){var Gn=Array.isArray(qt)?qt[In]:qt.type,oa=Fr[In];ft.concat(In+1).checkSubtype(Gn,oa.type)}if(ft.errors.length===0)return new So(he,Te,dr,Fr)}}if($e.length===1)(J=B.errors).push.apply(J,ft.errors);else{for(var na=$e.length?$e:Fe,Ra=na.map(function(La){var Da=La[0];return Mu(Da)}).join(" | "),wa=[],Sa=1;Sa<C.length;Sa++){var ti=B.parse(C[Sa],1+wa.length);if(!ti)return null;wa.push(Aa(ti.type))}B.error("Expected arguments of type "+Ra+", but found ("+wa.join(", ")+") instead.")}return null},So.register=function(C,B){So.definitions=B;for(var J in B)C[J]=So};function Mu(E){return Array.isArray(E)?"("+E.map(Aa).join(", ")+")":"("+Aa(E.type)+"...)"}var Is=function(C,B,J){this.type=aa,this.locale=J,this.caseSensitive=C,this.diacriticSensitive=B};Is.parse=function(C,B){if(C.length!==2)return B.error("Expected one argument.");var J=C[1];if(typeof J!="object"||Array.isArray(J))return B.error("Collator options argument must be an object.");var he=B.parse(J["case-sensitive"]===void 0?!1:J["case-sensitive"],1,gn);if(!he)return null;var xe=B.parse(J["diacritic-sensitive"]===void 0?!1:J["diacritic-sensitive"],1,gn);if(!xe)return null;var Te=null;return J.locale&&(Te=B.parse(J.locale,1,zr),!Te)?null:new Is(he,xe,Te)},Is.prototype.evaluate=function(C){return new Vs(this.caseSensitive.evaluate(C),this.diacriticSensitive.evaluate(C),this.locale?this.locale.evaluate(C):null)},Is.prototype.eachChild=function(C){C(this.caseSensitive),C(this.diacriticSensitive),this.locale&&C(this.locale)},Is.prototype.outputDefined=function(){return!1},Is.prototype.serialize=function(){var C={};return C["case-sensitive"]=this.caseSensitive.serialize(),C["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(C.locale=this.locale.serialize()),["collator",C]};var _s=8192;function Ll(E,C){E[0]=Math.min(E[0],C[0]),E[1]=Math.min(E[1],C[1]),E[2]=Math.max(E[2],C[0]),E[3]=Math.max(E[3],C[1])}function Su(E){return(180+E)/360}function ku(E){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360}function Ys(E,C){return!(E[0]<=C[0]||E[2]>=C[2]||E[1]<=C[1]||E[3]>=C[3])}function Pl(E,C){var B=Su(E[0]),J=ku(E[1]),he=Math.pow(2,C.z);return[Math.round(B*he*_s),Math.round(J*he*_s)]}function ws(E,C,B){var J=E[0]-C[0],he=E[1]-C[1],xe=E[0]-B[0],Te=E[1]-B[1];return J*Te-xe*he===0&&J*xe<=0&&he*Te<=0}function Wl(E,C,B){return C[1]>E[1]!=B[1]>E[1]&&E[0]<(B[0]-C[0])*(E[1]-C[1])/(B[1]-C[1])+C[0]}function il(E,C){for(var B=!1,J=0,he=C.length;J<he;J++)for(var xe=C[J],Te=0,Fe=xe.length;Te<Fe-1;Te++){if(ws(E,xe[Te],xe[Te+1]))return!1;Wl(E,xe[Te],xe[Te+1])&&(B=!B)}return B}function Xl(E,C){for(var B=0;B<C.length;B++)if(il(E,C[B]))return!0;return!1}function ou(E,C){return E[0]*C[1]-E[1]*C[0]}function Dl(E,C,B,J){var he=E[0]-B[0],xe=E[1]-B[1],Te=C[0]-B[0],Fe=C[1]-B[1],$e=J[0]-B[0],ft=J[1]-B[1],pt=he*ft-$e*xe,Ot=Te*ft-$e*Fe;return pt>0&&Ot<0||pt<0&&Ot>0}function Eu(E,C,B,J){var he=[C[0]-E[0],C[1]-E[1]],xe=[J[0]-B[0],J[1]-B[1]];return ou(xe,he)===0?!1:!!(Dl(E,C,B,J)&&Dl(B,J,E,C))}function Ws(E,C,B){for(var J=0,he=B;J<he.length;J+=1)for(var xe=he[J],Te=0;Te<xe.length-1;++Te)if(Eu(E,C,xe[Te],xe[Te+1]))return!0;return!1}function Zl(E,C){for(var B=0;B<E.length;++B)if(!il(E[B],C))return!1;for(var J=0;J<E.length-1;++J)if(Ws(E[J],E[J+1],C))return!1;return!0}function Rl(E,C){for(var B=0;B<C.length;B++)if(Zl(E,C[B]))return!0;return!1}function ps(E,C,B){for(var J=[],he=0;he<E.length;he++){for(var xe=[],Te=0;Te<E[he].length;Te++){var Fe=Pl(E[he][Te],B);Ll(C,Fe),xe.push(Fe)}J.push(xe)}return J}function yl(E,C,B){for(var J=[],he=0;he<E.length;he++){var xe=ps(E[he],C,B);J.push(xe)}return J}function jl(E,C,B,J){if(E[0]<B[0]||E[0]>B[2]){var he=J*.5,xe=E[0]-B[0]>he?-J:B[0]-E[0]>he?J:0;xe===0&&(xe=E[0]-B[2]>he?-J:B[2]-E[0]>he?J:0),E[0]+=xe}Ll(C,E)}function su(E){E[0]=E[1]=1/0,E[2]=E[3]=-1/0}function lu(E,C,B,J){for(var he=Math.pow(2,J.z)*_s,xe=[J.x*_s,J.y*_s],Te=[],Fe=0,$e=E;Fe<$e.length;Fe+=1)for(var ft=$e[Fe],pt=0,Ot=ft;pt<Ot.length;pt+=1){var rr=Ot[pt],qt=[rr.x+xe[0],rr.y+xe[1]];jl(qt,C,B,he),Te.push(qt)}return Te}function Il(E,C,B,J){for(var he=Math.pow(2,J.z)*_s,xe=[J.x*_s,J.y*_s],Te=[],Fe=0,$e=E;Fe<$e.length;Fe+=1){for(var ft=$e[Fe],pt=[],Ot=0,rr=ft;Ot<rr.length;Ot+=1){var qt=rr[Ot],dr=[qt.x+xe[0],qt.y+xe[1]];Ll(C,dr),pt.push(dr)}Te.push(pt)}if(C[2]-C[0]<=he/2){su(C);for(var Fr=0,an=Te;Fr<an.length;Fr+=1)for(var $r=an[Fr],kn=0,mn=$r;kn<mn.length;kn+=1){var Sn=mn[kn];jl(Sn,C,B,he)}}return Te}function Cu(E,C){var B=[1/0,1/0,-1/0,-1/0],J=[1/0,1/0,-1/0,-1/0],he=E.canonicalID();if(C.type==="Polygon"){var xe=ps(C.coordinates,J,he),Te=lu(E.geometry(),B,J,he);if(!Ys(B,J))return!1;for(var Fe=0,$e=Te;Fe<$e.length;Fe+=1){var ft=$e[Fe];if(!il(ft,xe))return!1}}if(C.type==="MultiPolygon"){var pt=yl(C.coordinates,J,he),Ot=lu(E.geometry(),B,J,he);if(!Ys(B,J))return!1;for(var rr=0,qt=Ot;rr<qt.length;rr+=1){var dr=qt[rr];if(!Xl(dr,pt))return!1}}return!0}function uu(E,C){var B=[1/0,1/0,-1/0,-1/0],J=[1/0,1/0,-1/0,-1/0],he=E.canonicalID();if(C.type==="Polygon"){var xe=ps(C.coordinates,J,he),Te=Il(E.geometry(),B,J,he);if(!Ys(B,J))return!1;for(var Fe=0,$e=Te;Fe<$e.length;Fe+=1){var ft=$e[Fe];if(!Zl(ft,xe))return!1}}if(C.type==="MultiPolygon"){var pt=yl(C.coordinates,J,he),Ot=Il(E.geometry(),B,J,he);if(!Ys(B,J))return!1;for(var rr=0,qt=Ot;rr<qt.length;rr+=1){var dr=qt[rr];if(!Rl(dr,pt))return!1}}return!0}var Jo=function(C,B){this.type=gn,this.geojson=C,this.geometries=B};Jo.parse=function(C,B){if(C.length!==2)return B.error("'within' expression requires exactly one argument, but found "+(C.length-1)+" instead.");if(vs(C[1])){var J=C[1];if(J.type==="FeatureCollection")for(var he=0;he<J.features.length;++he){var xe=J.features[he].geometry.type;if(xe==="Polygon"||xe==="MultiPolygon")return new Jo(J,J.features[he].geometry)}else if(J.type==="Feature"){var Te=J.geometry.type;if(Te==="Polygon"||Te==="MultiPolygon")return new Jo(J,J.geometry)}else if(J.type==="Polygon"||J.type==="MultiPolygon")return new Jo(J,J)}return B.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Jo.prototype.evaluate=function(C){if(C.geometry()!=null&&C.canonicalID()!=null){if(C.geometryType()==="Point")return Cu(C,this.geometries);if(C.geometryType()==="LineString")return uu(C,this.geometries)}return!1},Jo.prototype.eachChild=function(){},Jo.prototype.outputDefined=function(){return!0},Jo.prototype.serialize=function(){return["within",this.geojson]};function ol(E){if(E instanceof So){if(E.name==="get"&&E.args.length===1)return!1;if(E.name==="feature-state")return!1;if(E.name==="has"&&E.args.length===1)return!1;if(E.name==="properties"||E.name==="geometry-type"||E.name==="id")return!1;if(/^filter-/.test(E.name))return!1}if(E instanceof Jo)return!1;var C=!0;return E.eachChild(function(B){C&&!ol(B)&&(C=!1)}),C}function sl(E){if(E instanceof So&&E.name==="feature-state")return!1;var C=!0;return E.eachChild(function(B){C&&!sl(B)&&(C=!1)}),C}function Kl(E,C){if(E instanceof So&&C.indexOf(E.name)>=0)return!1;var B=!0;return E.eachChild(function(J){B&&!Kl(J,C)&&(B=!1)}),B}var ds=function(C,B){this.type=B.type,this.name=C,this.boundExpression=B};ds.parse=function(C,B){if(C.length!==2||typeof C[1]!="string")return B.error("'var' expression requires exactly one string literal argument.");var J=C[1];return B.scope.has(J)?new ds(J,B.scope.get(J)):B.error('Unknown variable "'+J+'". Make sure "'+J+'" has been bound in an enclosing "let" expression before using it.',1)},ds.prototype.evaluate=function(C){return this.boundExpression.evaluate(C)},ds.prototype.eachChild=function(){},ds.prototype.outputDefined=function(){return!1},ds.prototype.serialize=function(){return["var",this.name]};var ko=function(C,B,J,he,xe){B===void 0&&(B=[]),he===void 0&&(he=new un),xe===void 0&&(xe=[]),this.registry=C,this.path=B,this.key=B.map(function(Te){return"["+Te+"]"}).join(""),this.scope=he,this.errors=xe,this.expectedType=J};ko.prototype.parse=function(C,B,J,he,xe){return xe===void 0&&(xe={}),B?this.concat(B,J,he)._parse(C,xe):this._parse(C,xe)},ko.prototype._parse=function(C,B){(C===null||typeof C=="string"||typeof C=="boolean"||typeof C=="number")&&(C=["literal",C]);function J(pt,Ot,rr){return rr==="assert"?new Ji(Ot,[pt]):rr==="coerce"?new Ko(Ot,[pt]):pt}if(Array.isArray(C)){if(C.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var he=C[0];if(typeof he!="string")return this.error("Expression name must be a string, but found "+typeof he+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var xe=this.registry[he];if(xe){var Te=xe.parse(C,this);if(!Te)return null;if(this.expectedType){var Fe=this.expectedType,$e=Te.type;if((Fe.kind==="string"||Fe.kind==="number"||Fe.kind==="boolean"||Fe.kind==="object"||Fe.kind==="array")&&$e.kind==="value")Te=J(Te,Fe,B.typeAnnotation||"assert");else if((Fe.kind==="color"||Fe.kind==="formatted"||Fe.kind==="resolvedImage")&&($e.kind==="value"||$e.kind==="string"))Te=J(Te,Fe,B.typeAnnotation||"coerce");else if(this.checkSubtype(Fe,$e))return null}if(!(Te instanceof Ki)&&Te.type.kind!=="resolvedImage"&&zl(Te)){var ft=new Rs;try{Te=new Ki(Te.type,Te.evaluate(ft))}catch(pt){return this.error(pt.message),null}}return Te}return this.error('Unknown expression "'+he+'". If you wanted a literal array, use ["literal", [...]].',0)}else return typeof C>"u"?this.error("'undefined' value invalid. Use null instead."):typeof C=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof C+" instead.")},ko.prototype.concat=function(C,B,J){var he=typeof C=="number"?this.path.concat(C):this.path,xe=J?this.scope.concat(J):this.scope;return new ko(this.registry,he,B||null,xe,this.errors)},ko.prototype.error=function(C){for(var B=[],J=arguments.length-1;J-- >0;)B[J]=arguments[J+1];var he=""+this.key+B.map(function(xe){return"["+xe+"]"}).join("");this.errors.push(new xn(he,C))},ko.prototype.checkSubtype=function(C,B){var J=Io(C,B);return J&&this.error(J),J};function zl(E){if(E instanceof ds)return zl(E.boundExpression);if(E instanceof So&&E.name==="error")return!1;if(E instanceof Is)return!1;if(E instanceof Jo)return!1;var C=E instanceof Ko||E instanceof Ji,B=!0;return E.eachChild(function(J){C?B=B&&zl(J):B=B&&J instanceof Ki}),B?ol(E)&&Kl(E,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Ts(E,C){for(var B=E.length-1,J=0,he=B,xe=0,Te,Fe;J<=he;)if(xe=Math.floor((J+he)/2),Te=E[xe],Fe=E[xe+1],Te<=C){if(xe===B||C<Fe)return xe;J=xe+1}else if(Te>C)he=xe-1;else throw new Fi("Input is not a number.");return 0}var As=function(C,B,J){this.type=C,this.input=B,this.labels=[],this.outputs=[];for(var he=0,xe=J;he<xe.length;he+=1){var Te=xe[he],Fe=Te[0],$e=Te[1];this.labels.push(Fe),this.outputs.push($e)}};As.parse=function(C,B){if(C.length-1<4)return B.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if((C.length-1)%2!==0)return B.error("Expected an even number of arguments.");var J=B.parse(C[1],1,mr);if(!J)return null;var he=[],xe=null;B.expectedType&&B.expectedType.kind!=="value"&&(xe=B.expectedType);for(var Te=1;Te<C.length;Te+=2){var Fe=Te===1?-1/0:C[Te],$e=C[Te+1],ft=Te,pt=Te+1;if(typeof Fe!="number")return B.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ft);if(he.length&&he[he.length-1][0]>=Fe)return B.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ft);var Ot=B.parse($e,pt,xe);if(!Ot)return null;xe=xe||Ot.type,he.push([Fe,Ot])}return new As(xe,J,he)},As.prototype.evaluate=function(C){var B=this.labels,J=this.outputs;if(B.length===1)return J[0].evaluate(C);var he=this.input.evaluate(C);if(he<=B[0])return J[0].evaluate(C);var xe=B.length;if(he>=B[xe-1])return J[xe-1].evaluate(C);var Te=Ts(B,he);return J[Te].evaluate(C)},As.prototype.eachChild=function(C){C(this.input);for(var B=0,J=this.outputs;B<J.length;B+=1){var he=J[B];C(he)}},As.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})},As.prototype.serialize=function(){for(var C=["step",this.input.serialize()],B=0;B<this.labels.length;B++)B>0&&C.push(this.labels[B]),C.push(this.outputs[B].serialize());return C};function so(E,C,B){return E*(1-B)+C*B}function ml(E,C,B){return new vi(so(E.r,C.r,B),so(E.g,C.g,B),so(E.b,C.b,B),so(E.a,C.a,B))}function xl(E,C,B){return E.map(function(J,he){return so(J,C[he],B)})}var Xs=Object.freeze({__proto__:null,number:so,color:ml,array:xl}),gs=.95047,bl=1,ll=1.08883,Fl=4/29,_l=6/29,Zs=3*_l*_l,Lu=_l*_l*_l,rs=Math.PI/180,Yu=180/Math.PI;function Jl(E){return E>Lu?Math.pow(E,1/3):E/Zs+Fl}function ul(E){return E>_l?E*E*E:Zs*(E-Fl)}function wl(E){return 255*(E<=.0031308?12.92*E:1.055*Math.pow(E,1/2.4)-.055)}function js(E){return E/=255,E<=.04045?E/12.92:Math.pow((E+.055)/1.055,2.4)}function Tl(E){var C=js(E.r),B=js(E.g),J=js(E.b),he=Jl((.4124564*C+.3575761*B+.1804375*J)/gs),xe=Jl((.2126729*C+.7151522*B+.072175*J)/bl),Te=Jl((.0193339*C+.119192*B+.9503041*J)/ll);return{l:116*xe-16,a:500*(he-xe),b:200*(xe-Te),alpha:E.a}}function fu(E){var C=(E.l+16)/116,B=isNaN(E.a)?C:C+E.a/500,J=isNaN(E.b)?C:C-E.b/200;return C=bl*ul(C),B=gs*ul(B),J=ll*ul(J),new vi(wl(3.2404542*B-1.5371385*C-.4985314*J),wl(-.969266*B+1.8760108*C+.041556*J),wl(.0556434*B-.2040259*C+1.0572252*J),E.alpha)}function cu(E,C,B){return{l:so(E.l,C.l,B),a:so(E.a,C.a,B),b:so(E.b,C.b,B),alpha:so(E.alpha,C.alpha,B)}}function Wu(E){var C=Tl(E),B=C.l,J=C.a,he=C.b,xe=Math.atan2(he,J)*Yu;return{h:xe<0?xe+360:xe,c:Math.sqrt(J*J+he*he),l:B,alpha:E.a}}function Ri(E){var C=E.h*rs,B=E.c,J=E.l;return fu({l:J,a:Math.cos(C)*B,b:Math.sin(C)*B,alpha:E.alpha})}function fl(E,C,B){var J=C-E;return E+B*(J>180||J<-180?J-360*Math.round(J/360):J)}function Ks(E,C,B){return{h:fl(E.h,C.h,B),c:so(E.c,C.c,B),l:so(E.l,C.l,B),alpha:so(E.alpha,C.alpha,B)}}var Qo={forward:Tl,reverse:fu,interpolate:cu},ns={forward:Wu,reverse:Ri,interpolate:Ks},Al=Object.freeze({__proto__:null,lab:Qo,hcl:ns}),lo=function(C,B,J,he,xe){this.type=C,this.operator=B,this.interpolation=J,this.input=he,this.labels=[],this.outputs=[];for(var Te=0,Fe=xe;Te<Fe.length;Te+=1){var $e=Fe[Te],ft=$e[0],pt=$e[1];this.labels.push(ft),this.outputs.push(pt)}};lo.interpolationFactor=function(C,B,J,he){var xe=0;if(C.name==="exponential")xe=hu(B,C.base,J,he);else if(C.name==="linear")xe=hu(B,1,J,he);else if(C.name==="cubic-bezier"){var Te=C.controlPoints,Fe=new r(Te[0],Te[1],Te[2],Te[3]);xe=Fe.solve(hu(B,1,J,he))}return xe},lo.parse=function(C,B){var J=C[0],he=C[1],xe=C[2],Te=C.slice(3);if(!Array.isArray(he)||he.length===0)return B.error("Expected an interpolation type expression.",1);if(he[0]==="linear")he={name:"linear"};else if(he[0]==="exponential"){var Fe=he[1];if(typeof Fe!="number")return B.error("Exponential interpolation requires a numeric base.",1,1);he={name:"exponential",base:Fe}}else if(he[0]==="cubic-bezier"){var $e=he.slice(1);if($e.length!==4||$e.some(function($r){return typeof $r!="number"||$r<0||$r>1}))return B.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);he={name:"cubic-bezier",controlPoints:$e}}else return B.error("Unknown interpolation type "+String(he[0]),1,0);if(C.length-1<4)return B.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if((C.length-1)%2!==0)return B.error("Expected an even number of arguments.");if(xe=B.parse(xe,2,mr),!xe)return null;var ft=[],pt=null;J==="interpolate-hcl"||J==="interpolate-lab"?pt=On:B.expectedType&&B.expectedType.kind!=="value"&&(pt=B.expectedType);for(var Ot=0;Ot<Te.length;Ot+=2){var rr=Te[Ot],qt=Te[Ot+1],dr=Ot+3,Fr=Ot+4;if(typeof rr!="number")return B.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',dr);if(ft.length&&ft[ft.length-1][0]>=rr)return B.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',dr);var an=B.parse(qt,Fr,pt);if(!an)return null;pt=pt||an.type,ft.push([rr,an])}return pt.kind!=="number"&&pt.kind!=="color"&&!(pt.kind==="array"&&pt.itemType.kind==="number"&&typeof pt.N=="number")?B.error("Type "+Aa(pt)+" is not interpolatable."):new lo(pt,J,he,xe,ft)},lo.prototype.evaluate=function(C){var B=this.labels,J=this.outputs;if(B.length===1)return J[0].evaluate(C);var he=this.input.evaluate(C);if(he<=B[0])return J[0].evaluate(C);var xe=B.length;if(he>=B[xe-1])return J[xe-1].evaluate(C);var Te=Ts(B,he),Fe=B[Te],$e=B[Te+1],ft=lo.interpolationFactor(this.interpolation,he,Fe,$e),pt=J[Te].evaluate(C),Ot=J[Te+1].evaluate(C);return this.operator==="interpolate"?Xs[this.type.kind.toLowerCase()](pt,Ot,ft):this.operator==="interpolate-hcl"?ns.reverse(ns.interpolate(ns.forward(pt),ns.forward(Ot),ft)):Qo.reverse(Qo.interpolate(Qo.forward(pt),Qo.forward(Ot),ft))},lo.prototype.eachChild=function(C){C(this.input);for(var B=0,J=this.outputs;B<J.length;B+=1){var he=J[B];C(he)}},lo.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})},lo.prototype.serialize=function(){var C;this.interpolation.name==="linear"?C=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?C=["linear"]:C=["exponential",this.interpolation.base]:C=["cubic-bezier"].concat(this.interpolation.controlPoints);for(var B=[this.operator,C,this.input.serialize()],J=0;J<this.labels.length;J++)B.push(this.labels[J],this.outputs[J].serialize());return B};function hu(E,C,B,J){var he=J-B,xe=E-B;return he===0?0:C===1?xe/he:(Math.pow(C,xe)-1)/(Math.pow(C,he)-1)}var as=function(C,B){this.type=C,this.args=B};as.parse=function(C,B){if(C.length<2)return B.error("Expectected at least one argument.");var J=null,he=B.expectedType;he&&he.kind!=="value"&&(J=he);for(var xe=[],Te=0,Fe=C.slice(1);Te<Fe.length;Te+=1){var $e=Fe[Te],ft=B.parse($e,1+xe.length,J,void 0,{typeAnnotation:"omit"});if(!ft)return null;J=J||ft.type,xe.push(ft)}var pt=he&&xe.some(function(Ot){return Io(he,Ot.type)});return pt?new as(_n,xe):new as(J,xe)},as.prototype.evaluate=function(C){for(var B=null,J=0,he,xe=0,Te=this.args;xe<Te.length;xe+=1){var Fe=Te[xe];if(J++,B=Fe.evaluate(C),B&&B instanceof Mo&&!B.available&&(he||(he=B.name),B=null,J===this.args.length&&(B=he)),B!==null)break}return B},as.prototype.eachChild=function(C){this.args.forEach(C)},as.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},as.prototype.serialize=function(){var C=["coalesce"];return this.eachChild(function(B){C.push(B.serialize())}),C};var zs=function(C,B){this.type=B.type,this.bindings=[].concat(C),this.result=B};zs.prototype.evaluate=function(C){return this.result.evaluate(C)},zs.prototype.eachChild=function(C){for(var B=0,J=this.bindings;B<J.length;B+=1){var he=J[B];C(he[1])}C(this.result)},zs.parse=function(C,B){if(C.length<4)return B.error("Expected at least 3 arguments, but found "+(C.length-1)+" instead.");for(var J=[],he=1;he<C.length-1;he+=2){var xe=C[he];if(typeof xe!="string")return B.error("Expected string, but found "+typeof xe+" instead.",he);if(/[^a-zA-Z0-9_]/.test(xe))return B.error("Variable names must contain only alphanumeric characters or '_'.",he);var Te=B.parse(C[he+1],he+1);if(!Te)return null;J.push([xe,Te])}var Fe=B.parse(C[C.length-1],C.length-1,B.expectedType,J);return Fe?new zs(J,Fe):null},zs.prototype.outputDefined=function(){return this.result.outputDefined()},zs.prototype.serialize=function(){for(var C=["let"],B=0,J=this.bindings;B<J.length;B+=1){var he=J[B],xe=he[0],Te=he[1];C.push(xe,Te.serialize())}return C.push(this.result.serialize()),C};var Fs=function(C,B,J){this.type=C,this.index=B,this.input=J};Fs.parse=function(C,B){if(C.length!==3)return B.error("Expected 2 arguments, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1,mr),he=B.parse(C[2],2,sa(B.expectedType||_n));if(!J||!he)return null;var xe=he.type;return new Fs(xe.itemType,J,he)},Fs.prototype.evaluate=function(C){var B=this.index.evaluate(C),J=this.input.evaluate(C);if(B<0)throw new Fi("Array index out of bounds: "+B+" < 0.");if(B>=J.length)throw new Fi("Array index out of bounds: "+B+" > "+(J.length-1)+".");if(B!==Math.floor(B))throw new Fi("Array index must be an integer, but found "+B+" instead.");return J[B]},Fs.prototype.eachChild=function(C){C(this.index),C(this.input)},Fs.prototype.outputDefined=function(){return!1},Fs.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ms=function(C,B){this.type=gn,this.needle=C,this.haystack=B};Ms.parse=function(C,B){if(C.length!==3)return B.error("Expected 2 arguments, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1,_n),he=B.parse(C[2],2,_n);return!J||!he?null:jo(J.type,[gn,zr,mr,yr,_n])?new Ms(J,he):B.error("Expected first argument to be of type boolean, string, number or null, but found "+Aa(J.type)+" instead")},Ms.prototype.evaluate=function(C){var B=this.needle.evaluate(C),J=this.haystack.evaluate(C);if(!J)return!1;if(!nl(B,["boolean","string","number","null"]))throw new Fi("Expected first argument to be of type boolean, string, number or null, but found "+Aa(Di(B))+" instead.");if(!nl(J,["string","array"]))throw new Fi("Expected second argument to be of type array or string, but found "+Aa(Di(J))+" instead.");return J.indexOf(B)>=0},Ms.prototype.eachChild=function(C){C(this.needle),C(this.haystack)},Ms.prototype.outputDefined=function(){return!0},Ms.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var is=function(C,B,J){this.type=mr,this.needle=C,this.haystack=B,this.fromIndex=J};is.parse=function(C,B){if(C.length<=2||C.length>=5)return B.error("Expected 3 or 4 arguments, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1,_n),he=B.parse(C[2],2,_n);if(!J||!he)return null;if(!jo(J.type,[gn,zr,mr,yr,_n]))return B.error("Expected first argument to be of type boolean, string, number or null, but found "+Aa(J.type)+" instead");if(C.length===4){var xe=B.parse(C[3],3,mr);return xe?new is(J,he,xe):null}else return new is(J,he)},is.prototype.evaluate=function(C){var B=this.needle.evaluate(C),J=this.haystack.evaluate(C);if(!nl(B,["boolean","string","number","null"]))throw new Fi("Expected first argument to be of type boolean, string, number or null, but found "+Aa(Di(B))+" instead.");if(!nl(J,["string","array"]))throw new Fi("Expected second argument to be of type array or string, but found "+Aa(Di(J))+" instead.");if(this.fromIndex){var he=this.fromIndex.evaluate(C);return J.indexOf(B,he)}return J.indexOf(B)},is.prototype.eachChild=function(C){C(this.needle),C(this.haystack),this.fromIndex&&C(this.fromIndex)},is.prototype.outputDefined=function(){return!1},is.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var C=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),C]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Hi=function(C,B,J,he,xe,Te){this.inputType=C,this.type=B,this.input=J,this.cases=he,this.outputs=xe,this.otherwise=Te};Hi.parse=function(C,B){if(C.length<5)return B.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if(C.length%2!==1)return B.error("Expected an even number of arguments.");var J,he;B.expectedType&&B.expectedType.kind!=="value"&&(he=B.expectedType);for(var xe={},Te=[],Fe=2;Fe<C.length-1;Fe+=2){var $e=C[Fe],ft=C[Fe+1];Array.isArray($e)||($e=[$e]);var pt=B.concat(Fe);if($e.length===0)return pt.error("Expected at least one branch label.");for(var Ot=0,rr=$e;Ot<rr.length;Ot+=1){var qt=rr[Ot];if(typeof qt!="number"&&typeof qt!="string")return pt.error("Branch labels must be numbers or strings.");if(typeof qt=="number"&&Math.abs(qt)>Number.MAX_SAFE_INTEGER)return pt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof qt=="number"&&Math.floor(qt)!==qt)return pt.error("Numeric branch labels must be integer values.");if(!J)J=Di(qt);else if(pt.checkSubtype(J,Di(qt)))return null;if(typeof xe[String(qt)]<"u")return pt.error("Branch labels must be unique.");xe[String(qt)]=Te.length}var dr=B.parse(ft,Fe,he);if(!dr)return null;he=he||dr.type,Te.push(dr)}var Fr=B.parse(C[1],1,_n);if(!Fr)return null;var an=B.parse(C[C.length-1],C.length-1,he);return!an||Fr.type.kind!=="value"&&B.concat(1).checkSubtype(J,Fr.type)?null:new Hi(J,he,Fr,xe,Te,an)},Hi.prototype.evaluate=function(C){var B=this.input.evaluate(C),J=Di(B)===this.inputType&&this.outputs[this.cases[B]]||this.otherwise;return J.evaluate(C)},Hi.prototype.eachChild=function(C){C(this.input),this.outputs.forEach(C),C(this.otherwise)},Hi.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})&&this.otherwise.outputDefined()},Hi.prototype.serialize=function(){for(var C=this,B=["match",this.input.serialize()],J=Object.keys(this.cases).sort(),he=[],xe={},Te=0,Fe=J;Te<Fe.length;Te+=1){var $e=Fe[Te],ft=xe[this.cases[$e]];ft===void 0?(xe[this.cases[$e]]=he.length,he.push([this.cases[$e],[$e]])):he[ft][1].push($e)}for(var pt=function(Fr){return C.inputType.kind==="number"?Number(Fr):Fr},Ot=0,rr=he;Ot<rr.length;Ot+=1){var qt=rr[Ot],ft=qt[0],dr=qt[1];dr.length===1?B.push(pt(dr[0])):B.push(dr.map(pt)),B.push(this.outputs[outputIndex$1].serialize())}return B.push(this.otherwise.serialize()),B};var Eo=function(C,B,J){this.type=C,this.branches=B,this.otherwise=J};Eo.parse=function(C,B){if(C.length<4)return B.error("Expected at least 3 arguments, but found only "+(C.length-1)+".");if(C.length%2!==0)return B.error("Expected an odd number of arguments.");var J;B.expectedType&&B.expectedType.kind!=="value"&&(J=B.expectedType);for(var he=[],xe=1;xe<C.length-1;xe+=2){var Te=B.parse(C[xe],xe,gn);if(!Te)return null;var Fe=B.parse(C[xe+1],xe+1,J);if(!Fe)return null;he.push([Te,Fe]),J=J||Fe.type}var $e=B.parse(C[C.length-1],C.length-1,J);return $e?new Eo(J,he,$e):null},Eo.prototype.evaluate=function(C){for(var B=0,J=this.branches;B<J.length;B+=1){var he=J[B],xe=he[0],Te=he[1];if(xe.evaluate(C))return Te.evaluate(C)}return this.otherwise.evaluate(C)},Eo.prototype.eachChild=function(C){for(var B=0,J=this.branches;B<J.length;B+=1){var he=J[B],xe=he[0],Te=he[1];C(xe),C(Te)}C(this.otherwise)},Eo.prototype.outputDefined=function(){return this.branches.every(function(C){C[0];var B=C[1];return B.outputDefined()})&&this.otherwise.outputDefined()},Eo.prototype.serialize=function(){var C=["case"];return this.eachChild(function(B){C.push(B.serialize())}),C};var os=function(C,B,J,he){this.type=C,this.input=B,this.beginIndex=J,this.endIndex=he};os.parse=function(C,B){if(C.length<=2||C.length>=5)return B.error("Expected 3 or 4 arguments, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1,_n),he=B.parse(C[2],2,mr);if(!J||!he)return null;if(!jo(J.type,[sa(_n),zr,_n]))return B.error("Expected first argument to be of type array or string, but found "+Aa(J.type)+" instead");if(C.length===4){var xe=B.parse(C[3],3,mr);return xe?new os(J.type,J,he,xe):null}else return new os(J.type,J,he)},os.prototype.evaluate=function(C){var B=this.input.evaluate(C),J=this.beginIndex.evaluate(C);if(!nl(B,["string","array"]))throw new Fi("Expected first argument to be of type array or string, but found "+Aa(Di(B))+" instead.");if(this.endIndex){var he=this.endIndex.evaluate(C);return B.slice(J,he)}return B.slice(J)},os.prototype.eachChild=function(C){C(this.input),C(this.beginIndex),this.endIndex&&C(this.endIndex)},os.prototype.outputDefined=function(){return!1},os.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var C=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),C]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};function vu(E,C){return E==="=="||E==="!="?C.kind==="boolean"||C.kind==="string"||C.kind==="number"||C.kind==="null"||C.kind==="value":C.kind==="string"||C.kind==="number"||C.kind==="value"}function Ol(E,C,B){return C===B}function pu(E,C,B){return C!==B}function yt(E,C,B){return C<B}function Bt(E,C,B){return C>B}function cr(E,C,B){return C<=B}function sr(E,C,B){return C>=B}function Dr(E,C,B,J){return J.compare(C,B)===0}function tn(E,C,B,J){return!Dr(E,C,B,J)}function dn(E,C,B,J){return J.compare(C,B)<0}function Mn(E,C,B,J){return J.compare(C,B)>0}function Ln(E,C,B,J){return J.compare(C,B)<=0}function Nn(E,C,B,J){return J.compare(C,B)>=0}function yn(E,C,B){var J=E!=="=="&&E!=="!=";return function(){function he(xe,Te,Fe){this.type=gn,this.lhs=xe,this.rhs=Te,this.collator=Fe,this.hasUntypedArgument=xe.type.kind==="value"||Te.type.kind==="value"}return he.parse=function(Te,Fe){if(Te.length!==3&&Te.length!==4)return Fe.error("Expected two or three arguments.");var $e=Te[0],ft=Fe.parse(Te[1],1,_n);if(!ft)return null;if(!vu($e,ft.type))return Fe.concat(1).error('"'+$e+`" comparisons are not supported for type '`+Aa(ft.type)+"'.");var pt=Fe.parse(Te[2],2,_n);if(!pt)return null;if(!vu($e,pt.type))return Fe.concat(2).error('"'+$e+`" comparisons are not supported for type '`+Aa(pt.type)+"'.");if(ft.type.kind!==pt.type.kind&&ft.type.kind!=="value"&&pt.type.kind!=="value")return Fe.error("Cannot compare types '"+Aa(ft.type)+"' and '"+Aa(pt.type)+"'.");J&&(ft.type.kind==="value"&&pt.type.kind!=="value"?ft=new Ji(pt.type,[ft]):ft.type.kind!=="value"&&pt.type.kind==="value"&&(pt=new Ji(ft.type,[pt])));var Ot=null;if(Te.length===4){if(ft.type.kind!=="string"&&pt.type.kind!=="string"&&ft.type.kind!=="value"&&pt.type.kind!=="value")return Fe.error("Cannot use collator to compare non-string types.");if(Ot=Fe.parse(Te[3],3,aa),!Ot)return null}return new he(ft,pt,Ot)},he.prototype.evaluate=function(Te){var Fe=this.lhs.evaluate(Te),$e=this.rhs.evaluate(Te);if(J&&this.hasUntypedArgument){var ft=Di(Fe),pt=Di($e);if(ft.kind!==pt.kind||!(ft.kind==="string"||ft.kind==="number"))throw new Fi('Expected arguments for "'+E+'" to be (string, string) or (number, number), but found ('+ft.kind+", "+pt.kind+") instead.")}if(this.collator&&!J&&this.hasUntypedArgument){var Ot=Di(Fe),rr=Di($e);if(Ot.kind!=="string"||rr.kind!=="string")return C(Te,Fe,$e)}return this.collator?B(Te,Fe,$e,this.collator.evaluate(Te)):C(Te,Fe,$e)},he.prototype.eachChild=function(Te){Te(this.lhs),Te(this.rhs),this.collator&&Te(this.collator)},he.prototype.outputDefined=function(){return!0},he.prototype.serialize=function(){var Te=[E];return this.eachChild(function(Fe){Te.push(Fe.serialize())}),Te},he}()}var zn=yn("==",Ol,Dr),Pn=yn("!=",pu,tn),Hn=yn("<",yt,dn),$n=yn(">",Bt,Mn),za=yn("<=",cr,Ln),Ea=yn(">=",sr,Nn),Fa=function(C,B,J,he,xe){this.type=zr,this.number=C,this.locale=B,this.currency=J,this.minFractionDigits=he,this.maxFractionDigits=xe};Fa.parse=function(C,B){if(C.length!==3)return B.error("Expected two arguments.");var J=B.parse(C[1],1,mr);if(!J)return null;var he=C[2];if(typeof he!="object"||Array.isArray(he))return B.error("NumberFormat options argument must be an object.");var xe=null;if(he.locale&&(xe=B.parse(he.locale,1,zr),!xe))return null;var Te=null;if(he.currency&&(Te=B.parse(he.currency,1,zr),!Te))return null;var Fe=null;if(he["min-fraction-digits"]&&(Fe=B.parse(he["min-fraction-digits"],1,mr),!Fe))return null;var $e=null;return he["max-fraction-digits"]&&($e=B.parse(he["max-fraction-digits"],1,mr),!$e)?null:new Fa(J,xe,Te,Fe,$e)},Fa.prototype.evaluate=function(C){return new Intl.NumberFormat(this.locale?this.locale.evaluate(C):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(C):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(C):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(C):void 0}).format(this.number.evaluate(C))},Fa.prototype.eachChild=function(C){C(this.number),this.locale&&C(this.locale),this.currency&&C(this.currency),this.minFractionDigits&&C(this.minFractionDigits),this.maxFractionDigits&&C(this.maxFractionDigits)},Fa.prototype.outputDefined=function(){return!1},Fa.prototype.serialize=function(){var C={};return this.locale&&(C.locale=this.locale.serialize()),this.currency&&(C.currency=this.currency.serialize()),this.minFractionDigits&&(C["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(C["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),C]};var Oa=function(C){this.type=mr,this.input=C};Oa.parse=function(C,B){if(C.length!==2)return B.error("Expected 1 argument, but found "+(C.length-1)+" instead.");var J=B.parse(C[1],1);return J?J.type.kind!=="array"&&J.type.kind!=="string"&&J.type.kind!=="value"?B.error("Expected argument of type string or array, but found "+Aa(J.type)+" instead."):new Oa(J):null},Oa.prototype.evaluate=function(C){var B=this.input.evaluate(C);if(typeof B=="string")return B.length;if(Array.isArray(B))return B.length;throw new Fi("Expected value to be of type string or array, but found "+Aa(Di(B))+" instead.")},Oa.prototype.eachChild=function(C){C(this.input)},Oa.prototype.outputDefined=function(){return!1},Oa.prototype.serialize=function(){var C=["length"];return this.eachChild(function(B){C.push(B.serialize())}),C};var Jn={"==":zn,"!=":Pn,">":$n,"<":Hn,">=":Ea,"<=":za,array:Ji,at:Fs,boolean:Ji,case:Eo,coalesce:as,collator:Is,format:ts,image:Gs,in:Ms,"index-of":is,interpolate:lo,"interpolate-hcl":lo,"interpolate-lab":lo,length:Oa,let:zs,literal:Ki,match:Hi,number:Ji,"number-format":Fa,object:Ji,slice:os,step:As,string:Ji,"to-boolean":Ko,"to-color":Ko,"to-number":Ko,"to-string":Ko,var:ds,within:Jo};function ha(E,C){var B=C[0],J=C[1],he=C[2],xe=C[3];B=B.evaluate(E),J=J.evaluate(E),he=he.evaluate(E);var Te=xe?xe.evaluate(E):1,Fe=dl(B,J,he,Te);if(Fe)throw new Fi(Fe);return new vi(B/255*Te,J/255*Te,he/255*Te,Te)}function Ga(E,C){return E in C}function Qa(E,C){var B=C[E];return typeof B>"u"?null:B}function di(E,C,B,J){for(;B<=J;){var he=B+J>>1;if(C[he]===E)return!0;C[he]>E?J=he-1:B=he+1}return!1}function gi(E){return{type:E}}So.register(Jn,{error:[jn,[zr],function(E,C){var B=C[0];throw new Fi(B.evaluate(E))}],typeof:[zr,[_n],function(E,C){var B=C[0];return Aa(Di(B.evaluate(E)))}],"to-rgba":[sa(mr,4),[On],function(E,C){var B=C[0];return B.evaluate(E).toArray()}],rgb:[On,[mr,mr,mr],ha],rgba:[On,[mr,mr,mr,mr],ha],has:{type:gn,overloads:[[[zr],function(E,C){var B=C[0];return Ga(B.evaluate(E),E.properties())}],[[zr,ta],function(E,C){var B=C[0],J=C[1];return Ga(B.evaluate(E),J.evaluate(E))}]]},get:{type:_n,overloads:[[[zr],function(E,C){var B=C[0];return Qa(B.evaluate(E),E.properties())}],[[zr,ta],function(E,C){var B=C[0],J=C[1];return Qa(B.evaluate(E),J.evaluate(E))}]]},"feature-state":[_n,[zr],function(E,C){var B=C[0];return Qa(B.evaluate(E),E.featureState||{})}],properties:[ta,[],function(E){return E.properties()}],"geometry-type":[zr,[],function(E){return E.geometryType()}],id:[_n,[],function(E){return E.id()}],zoom:[mr,[],function(E){return E.globals.zoom}],"heatmap-density":[mr,[],function(E){return E.globals.heatmapDensity||0}],"line-progress":[mr,[],function(E){return E.globals.lineProgress||0}],accumulated:[_n,[],function(E){return E.globals.accumulated===void 0?null:E.globals.accumulated}],"+":[mr,gi(mr),function(E,C){for(var B=0,J=0,he=C;J<he.length;J+=1){var xe=he[J];B+=xe.evaluate(E)}return B}],"*":[mr,gi(mr),function(E,C){for(var B=1,J=0,he=C;J<he.length;J+=1){var xe=he[J];B*=xe.evaluate(E)}return B}],"-":{type:mr,overloads:[[[mr,mr],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)-J.evaluate(E)}],[[mr],function(E,C){var B=C[0];return-B.evaluate(E)}]]},"/":[mr,[mr,mr],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)/J.evaluate(E)}],"%":[mr,[mr,mr],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)%J.evaluate(E)}],ln2:[mr,[],function(){return Math.LN2}],pi:[mr,[],function(){return Math.PI}],e:[mr,[],function(){return Math.E}],"^":[mr,[mr,mr],function(E,C){var B=C[0],J=C[1];return Math.pow(B.evaluate(E),J.evaluate(E))}],sqrt:[mr,[mr],function(E,C){var B=C[0];return Math.sqrt(B.evaluate(E))}],log10:[mr,[mr],function(E,C){var B=C[0];return Math.log(B.evaluate(E))/Math.LN10}],ln:[mr,[mr],function(E,C){var B=C[0];return Math.log(B.evaluate(E))}],log2:[mr,[mr],function(E,C){var B=C[0];return Math.log(B.evaluate(E))/Math.LN2}],sin:[mr,[mr],function(E,C){var B=C[0];return Math.sin(B.evaluate(E))}],cos:[mr,[mr],function(E,C){var B=C[0];return Math.cos(B.evaluate(E))}],tan:[mr,[mr],function(E,C){var B=C[0];return Math.tan(B.evaluate(E))}],asin:[mr,[mr],function(E,C){var B=C[0];return Math.asin(B.evaluate(E))}],acos:[mr,[mr],function(E,C){var B=C[0];return Math.acos(B.evaluate(E))}],atan:[mr,[mr],function(E,C){var B=C[0];return Math.atan(B.evaluate(E))}],min:[mr,gi(mr),function(E,C){return Math.min.apply(Math,C.map(function(B){return B.evaluate(E)}))}],max:[mr,gi(mr),function(E,C){return Math.max.apply(Math,C.map(function(B){return B.evaluate(E)}))}],abs:[mr,[mr],function(E,C){var B=C[0];return Math.abs(B.evaluate(E))}],round:[mr,[mr],function(E,C){var B=C[0],J=B.evaluate(E);return J<0?-Math.round(-J):Math.round(J)}],floor:[mr,[mr],function(E,C){var B=C[0];return Math.floor(B.evaluate(E))}],ceil:[mr,[mr],function(E,C){var B=C[0];return Math.ceil(B.evaluate(E))}],"filter-==":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1];return E.properties()[B.value]===J.value}],"filter-id-==":[gn,[_n],function(E,C){var B=C[0];return E.id()===B.value}],"filter-type-==":[gn,[zr],function(E,C){var B=C[0];return E.geometryType()===B.value}],"filter-<":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1],he=E.properties()[B.value],xe=J.value;return typeof he==typeof xe&&he<xe}],"filter-id-<":[gn,[_n],function(E,C){var B=C[0],J=E.id(),he=B.value;return typeof J==typeof he&&J<he}],"filter->":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1],he=E.properties()[B.value],xe=J.value;return typeof he==typeof xe&&he>xe}],"filter-id->":[gn,[_n],function(E,C){var B=C[0],J=E.id(),he=B.value;return typeof J==typeof he&&J>he}],"filter-<=":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1],he=E.properties()[B.value],xe=J.value;return typeof he==typeof xe&&he<=xe}],"filter-id-<=":[gn,[_n],function(E,C){var B=C[0],J=E.id(),he=B.value;return typeof J==typeof he&&J<=he}],"filter->=":[gn,[zr,_n],function(E,C){var B=C[0],J=C[1],he=E.properties()[B.value],xe=J.value;return typeof he==typeof xe&&he>=xe}],"filter-id->=":[gn,[_n],function(E,C){var B=C[0],J=E.id(),he=B.value;return typeof J==typeof he&&J>=he}],"filter-has":[gn,[_n],function(E,C){var B=C[0];return B.value in E.properties()}],"filter-has-id":[gn,[],function(E){return E.id()!==null&&E.id()!==void 0}],"filter-type-in":[gn,[sa(zr)],function(E,C){var B=C[0];return B.value.indexOf(E.geometryType())>=0}],"filter-id-in":[gn,[sa(_n)],function(E,C){var B=C[0];return B.value.indexOf(E.id())>=0}],"filter-in-small":[gn,[zr,sa(_n)],function(E,C){var B=C[0],J=C[1];return J.value.indexOf(E.properties()[B.value])>=0}],"filter-in-large":[gn,[zr,sa(_n)],function(E,C){var B=C[0],J=C[1];return di(E.properties()[B.value],J.value,0,J.value.length-1)}],all:{type:gn,overloads:[[[gn,gn],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)&&J.evaluate(E)}],[gi(gn),function(E,C){for(var B=0,J=C;B<J.length;B+=1){var he=J[B];if(!he.evaluate(E))return!1}return!0}]]},any:{type:gn,overloads:[[[gn,gn],function(E,C){var B=C[0],J=C[1];return B.evaluate(E)||J.evaluate(E)}],[gi(gn),function(E,C){for(var B=0,J=C;B<J.length;B+=1){var he=J[B];if(he.evaluate(E))return!0}return!1}]]},"!":[gn,[gn],function(E,C){var B=C[0];return!B.evaluate(E)}],"is-supported-script":[gn,[zr],function(E,C){var B=C[0],J=E.globals&&E.globals.isSupportedScript;return J?J(B.evaluate(E)):!0}],upcase:[zr,[zr],function(E,C){var B=C[0];return B.evaluate(E).toUpperCase()}],downcase:[zr,[zr],function(E,C){var B=C[0];return B.evaluate(E).toLowerCase()}],concat:[zr,gi(_n),function(E,C){return C.map(function(B){return al(B.evaluate(E))}).join("")}],"resolved-locale":[zr,[aa],function(E,C){var B=C[0];return B.evaluate(E).resolvedLocale()}]});function mi(E){return{result:"success",value:E}}function Ai(E){return{result:"error",value:E}}function oi(E){return E["property-type"]==="data-driven"||E["property-type"]==="cross-faded-data-driven"}function mo(E){return!!E.expression&&E.expression.parameters.indexOf("zoom")>-1}function qi(E){return!!E.expression&&E.expression.interpolated}function Ja(E){return E instanceof Number?"number":E instanceof String?"string":E instanceof Boolean?"boolean":Array.isArray(E)?"array":E===null?"null":typeof E}function va(E){return typeof E=="object"&&E!==null&&!Array.isArray(E)}function xi(E){return E}function uo(E,C){var B=C.type==="color",J=E.stops&&typeof E.stops[0][0]=="object",he=J||E.property!==void 0,xe=J||!he,Te=E.type||(qi(C)?"exponential":"interval");if(B&&(E=vn({},E),E.stops&&(E.stops=E.stops.map(function(na){return[na[0],vi.parse(na[1])]})),E.default?E.default=vi.parse(E.default):E.default=vi.parse(C.default)),E.colorSpace&&E.colorSpace!=="rgb"&&!Al[E.colorSpace])throw new Error("Unknown color space: "+E.colorSpace);var Fe,$e,ft;if(Te==="exponential")Fe=zo;else if(Te==="interval")Fe=Ss;else if(Te==="categorical"){Fe=ss,$e=Object.create(null);for(var pt=0,Ot=E.stops;pt<Ot.length;pt+=1){var rr=Ot[pt];$e[rr[0]]=rr[1]}ft=typeof E.stops[0][0]}else if(Te==="identity")Fe=Js;else throw new Error('Unknown function type "'+Te+'"');if(J){for(var qt={},dr=[],Fr=0;Fr<E.stops.length;Fr++){var an=E.stops[Fr],$r=an[0].zoom;qt[$r]===void 0&&(qt[$r]={zoom:$r,type:E.type,property:E.property,default:E.default,stops:[]},dr.push($r)),qt[$r].stops.push([an[0].value,an[1]])}for(var kn=[],mn=0,Sn=dr;mn<Sn.length;mn+=1){var In=Sn[mn];kn.push([qt[In].zoom,uo(qt[In],C)])}var Gn={name:"linear"};return{kind:"composite",interpolationType:Gn,interpolationFactor:lo.interpolationFactor.bind(void 0,Gn),zoomStops:kn.map(function(na){return na[0]}),evaluate:function(Ra,wa){var Sa=Ra.zoom;return zo({stops:kn,base:E.base},C,Sa).evaluate(Sa,wa)}}}else if(xe){var oa=Te==="exponential"?{name:"exponential",base:E.base!==void 0?E.base:1}:null;return{kind:"camera",interpolationType:oa,interpolationFactor:lo.interpolationFactor.bind(void 0,oa),zoomStops:E.stops.map(function(na){return na[0]}),evaluate:function(na){var Ra=na.zoom;return Fe(E,C,Ra,$e,ft)}}}else return{kind:"source",evaluate:function(Ra,wa){var Sa=wa&&wa.properties?wa.properties[E.property]:void 0;return Sa===void 0?po(E.default,C.default):Fe(E,C,Sa,$e,ft)}}}function po(E,C,B){if(E!==void 0)return E;if(C!==void 0)return C;if(B!==void 0)return B}function ss(E,C,B,J,he){var xe=typeof B===he?J[B]:void 0;return po(xe,E.default,C.default)}function Ss(E,C,B){if(Ja(B)!=="number")return po(E.default,C.default);var J=E.stops.length;if(J===1||B<=E.stops[0][0])return E.stops[0][1];if(B>=E.stops[J-1][0])return E.stops[J-1][1];var he=Ts(E.stops.map(function(xe){return xe[0]}),B);return E.stops[he][1]}function zo(E,C,B){var J=E.base!==void 0?E.base:1;if(Ja(B)!=="number")return po(E.default,C.default);var he=E.stops.length;if(he===1||B<=E.stops[0][0])return E.stops[0][1];if(B>=E.stops[he-1][0])return E.stops[he-1][1];var xe=Ts(E.stops.map(function(Ot){return Ot[0]}),B),Te=ys(B,J,E.stops[xe][0],E.stops[xe+1][0]),Fe=E.stops[xe][1],$e=E.stops[xe+1][1],ft=Xs[C.type]||xi;if(E.colorSpace&&E.colorSpace!=="rgb"){var pt=Al[E.colorSpace];ft=function(Ot,rr){return pt.reverse(pt.interpolate(pt.forward(Ot),pt.forward(rr),Te))}}return typeof Fe.evaluate=="function"?{evaluate:function(){for(var rr=[],qt=arguments.length;qt--;)rr[qt]=arguments[qt];var dr=Fe.evaluate.apply(void 0,rr),Fr=$e.evaluate.apply(void 0,rr);if(!(dr===void 0||Fr===void 0))return ft(dr,Fr,Te)}}:ft(Fe,$e,Te)}function Js(E,C,B){return C.type==="color"?B=vi.parse(B):C.type==="formatted"?B=Ui.fromString(B.toString()):C.type==="resolvedImage"?B=Mo.fromString(B.toString()):Ja(B)!==C.type&&(C.type!=="enum"||!C.values[B])&&(B=void 0),po(B,E.default,C.default)}function ys(E,C,B,J){var he=J-B,xe=E-B;return he===0?0:C===1?xe/he:(Math.pow(C,xe)-1)/(Math.pow(C,he)-1)}var ls=function(C,B){this.expression=C,this._warningHistory={},this._evaluator=new Rs,this._defaultValue=B?Du(B):null,this._enumValues=B&&B.type==="enum"?B.values:null};ls.prototype.evaluateWithoutErrorHandling=function(C,B,J,he,xe,Te){return this._evaluator.globals=C,this._evaluator.feature=B,this._evaluator.featureState=J,this._evaluator.canonical=he,this._evaluator.availableImages=xe||null,this._evaluator.formattedSection=Te,this.expression.evaluate(this._evaluator)},ls.prototype.evaluate=function(C,B,J,he,xe,Te){this._evaluator.globals=C,this._evaluator.feature=B||null,this._evaluator.featureState=J||null,this._evaluator.canonical=he,this._evaluator.availableImages=xe||null,this._evaluator.formattedSection=Te||null;try{var Fe=this.expression.evaluate(this._evaluator);if(Fe==null||typeof Fe=="number"&&Fe!==Fe)return this._defaultValue;if(this._enumValues&&!(Fe in this._enumValues))throw new Fi("Expected value to be one of "+Object.keys(this._enumValues).map(function($e){return JSON.stringify($e)}).join(", ")+", but found "+JSON.stringify(Fe)+" instead.");return Fe}catch($e){return this._warningHistory[$e.message]||(this._warningHistory[$e.message]=!0,typeof console<"u"&&console.warn($e.message)),this._defaultValue}};function xo(E){return Array.isArray(E)&&E.length>0&&typeof E[0]=="string"&&E[0]in Jn}function Bl(E,C){var B=new ko(Jn,[],C?gu(C):void 0),J=B.parse(E,void 0,void 0,void 0,C&&C.type==="string"?{typeAnnotation:"coerce"}:void 0);return J?mi(new ls(J,C)):Ai(B.errors)}var Ql=function(C,B){this.kind=C,this._styleExpression=B,this.isStateDependent=C!=="constant"&&!sl(B.expression)};Ql.prototype.evaluateWithoutErrorHandling=function(C,B,J,he,xe,Te){return this._styleExpression.evaluateWithoutErrorHandling(C,B,J,he,xe,Te)},Ql.prototype.evaluate=function(C,B,J,he,xe,Te){return this._styleExpression.evaluate(C,B,J,he,xe,Te)};var us=function(C,B,J,he){this.kind=C,this.zoomStops=J,this._styleExpression=B,this.isStateDependent=C!=="camera"&&!sl(B.expression),this.interpolationType=he};us.prototype.evaluateWithoutErrorHandling=function(C,B,J,he,xe,Te){return this._styleExpression.evaluateWithoutErrorHandling(C,B,J,he,xe,Te)},us.prototype.evaluate=function(C,B,J,he,xe,Te){return this._styleExpression.evaluate(C,B,J,he,xe,Te)},us.prototype.interpolationFactor=function(C,B,J){return this.interpolationType?lo.interpolationFactor(this.interpolationType,C,B,J):0};function du(E,C){if(E=Bl(E,C),E.result==="error")return E;var B=E.value.expression,J=ol(B);if(!J&&!oi(C))return Ai([new xn("","data expressions not supported")]);var he=Kl(B,["zoom"]);if(!he&&!mo(C))return Ai([new xn("","zoom expressions not supported")]);var xe=Pu(B);if(!xe&&!he)return Ai([new xn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(xe instanceof xn)return Ai([xe]);if(xe instanceof lo&&!qi(C))return Ai([new xn("",'"interpolate" expressions cannot be used with this property')]);if(!xe)return mi(J?new Ql("constant",E.value):new Ql("source",E.value));var Te=xe instanceof lo?xe.interpolation:void 0;return mi(J?new us("camera",E.value,xe.labels,Te):new us("composite",E.value,xe.labels,Te))}var Nl=function(C,B){this._parameters=C,this._specification=B,vn(this,uo(this._parameters,this._specification))};Nl.deserialize=function(C){return new Nl(C._parameters,C._specification)},Nl.serialize=function(C){return{_parameters:C._parameters,_specification:C._specification}};function vf(E,C){if(va(E))return new Nl(E,C);if(xo(E)){var B=du(E,C);if(B.result==="error")throw new Error(B.value.map(function(he){return he.key+": "+he.message}).join(", "));return B.value}else{var J=E;return typeof E=="string"&&C.type==="color"&&(J=vi.parse(E)),{kind:"constant",evaluate:function(){return J}}}}function Pu(E){var C=null;if(E instanceof zs)C=Pu(E.result);else if(E instanceof as)for(var B=0,J=E.args;B<J.length;B+=1){var he=J[B];if(C=Pu(he),C)break}else(E instanceof As||E instanceof lo)&&E.input instanceof So&&E.input.name==="zoom"&&(C=E);return C instanceof xn||E.eachChild(function(xe){var Te=Pu(xe);Te instanceof xn?C=Te:!C&&Te?C=new xn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):C&&Te&&C!==Te&&(C=new xn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),C}function gu(E){var C={color:On,string:zr,number:mr,enum:zr,boolean:gn,formatted:da,resolvedImage:ma};return E.type==="array"?sa(C[E.value]||_n,E.length):C[E.type]}function Du(E){return E.type==="color"&&va(E.default)?new vi(0,0,0,0):E.type==="color"?vi.parse(E.default)||null:E.default===void 0?null:E.default}function ks(E){var C=E.key,B=E.value,J=E.valueSpec||{},he=E.objectElementValidators||{},xe=E.style,Te=E.styleSpec,Fe=[],$e=Ja(B);if($e!=="object")return[new hr(C,B,"object expected, "+$e+" found")];for(var ft in B){var pt=ft.split(".")[0],Ot=J[pt]||J["*"],rr=void 0;if(he[pt])rr=he[pt];else if(J[pt])rr=hi;else if(he["*"])rr=he["*"];else if(J["*"])rr=hi;else{Fe.push(new hr(C,B[ft],'unknown property "'+ft+'"'));continue}Fe=Fe.concat(rr({key:(C&&C+".")+ft,value:B[ft],valueSpec:Ot,style:xe,styleSpec:Te,object:B,objectKey:ft},B))}for(var qt in J)he[qt]||J[qt].required&&J[qt].default===void 0&&B[qt]===void 0&&Fe.push(new hr(C,B,'missing required property "'+qt+'"'));return Fe}function Xu(E){var C=E.value,B=E.valueSpec,J=E.style,he=E.styleSpec,xe=E.key,Te=E.arrayElementValidator||hi;if(Ja(C)!=="array")return[new hr(xe,C,"array expected, "+Ja(C)+" found")];if(B.length&&C.length!==B.length)return[new hr(xe,C,"array length "+B.length+" expected, length "+C.length+" found")];if(B["min-length"]&&C.length<B["min-length"])return[new hr(xe,C,"array length at least "+B["min-length"]+" expected, length "+C.length+" found")];var Fe={type:B.value,values:B.values};he.$version<7&&(Fe.function=B.function),Ja(B.value)==="object"&&(Fe=B.value);for(var $e=[],ft=0;ft<C.length;ft++)$e=$e.concat(Te({array:C,arrayIndex:ft,value:C[ft],valueSpec:Fe,style:J,styleSpec:he,key:xe+"["+ft+"]"}));return $e}function Ru(E){var C=E.key,B=E.value,J=E.valueSpec,he=Ja(B);return he==="number"&&B!==B&&(he="NaN"),he!=="number"?[new hr(C,B,"number expected, "+he+" found")]:"minimum"in J&&B<J.minimum?[new hr(C,B,B+" is less than the minimum value "+J.minimum)]:"maximum"in J&&B>J.maximum?[new hr(C,B,B+" is greater than the maximum value "+J.maximum)]:[]}function Iu(E){var C=E.valueSpec,B=en(E.value.type),J,he={},xe,Te,Fe=B!=="categorical"&&E.value.property===void 0,$e=!Fe,ft=Ja(E.value.stops)==="array"&&Ja(E.value.stops[0])==="array"&&Ja(E.value.stops[0][0])==="object",pt=ks({key:E.key,value:E.value,valueSpec:E.styleSpec.function,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{stops:Ot,default:dr}});return B==="identity"&&Fe&&pt.push(new hr(E.key,E.value,'missing required property "property"')),B!=="identity"&&!E.value.stops&&pt.push(new hr(E.key,E.value,'missing required property "stops"')),B==="exponential"&&E.valueSpec.expression&&!qi(E.valueSpec)&&pt.push(new hr(E.key,E.value,"exponential functions not supported")),E.styleSpec.$version>=8&&($e&&!oi(E.valueSpec)?pt.push(new hr(E.key,E.value,"property functions not supported")):Fe&&!mo(E.valueSpec)&&pt.push(new hr(E.key,E.value,"zoom functions not supported"))),(B==="categorical"||ft)&&E.value.property===void 0&&pt.push(new hr(E.key,E.value,'"property" property is required')),pt;function Ot(Fr){if(B==="identity")return[new hr(Fr.key,Fr.value,'identity function may not have a "stops" property')];var an=[],$r=Fr.value;return an=an.concat(Xu({key:Fr.key,value:$r,valueSpec:Fr.valueSpec,style:Fr.style,styleSpec:Fr.styleSpec,arrayElementValidator:rr})),Ja($r)==="array"&&$r.length===0&&an.push(new hr(Fr.key,$r,"array must have at least one stop")),an}function rr(Fr){var an=[],$r=Fr.value,kn=Fr.key;if(Ja($r)!=="array")return[new hr(kn,$r,"array expected, "+Ja($r)+" found")];if($r.length!==2)return[new hr(kn,$r,"array length 2 expected, length "+$r.length+" found")];if(ft){if(Ja($r[0])!=="object")return[new hr(kn,$r,"object expected, "+Ja($r[0])+" found")];if($r[0].zoom===void 0)return[new hr(kn,$r,"object stop key must have zoom")];if($r[0].value===void 0)return[new hr(kn,$r,"object stop key must have value")];if(Te&&Te>en($r[0].zoom))return[new hr(kn,$r[0].zoom,"stop zoom values must appear in ascending order")];en($r[0].zoom)!==Te&&(Te=en($r[0].zoom),xe=void 0,he={}),an=an.concat(ks({key:kn+"[0]",value:$r[0],valueSpec:{zoom:{}},style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{zoom:Ru,value:qt}}))}else an=an.concat(qt({key:kn+"[0]",value:$r[0],valueSpec:{},style:Fr.style,styleSpec:Fr.styleSpec},$r));return xo(Tn($r[1]))?an.concat([new hr(kn+"[1]",$r[1],"expressions are not allowed in function stops.")]):an.concat(hi({key:kn+"[1]",value:$r[1],valueSpec:C,style:Fr.style,styleSpec:Fr.styleSpec}))}function qt(Fr,an){var $r=Ja(Fr.value),kn=en(Fr.value),mn=Fr.value!==null?Fr.value:an;if(!J)J=$r;else if($r!==J)return[new hr(Fr.key,mn,$r+" stop domain type must match previous stop domain type "+J)];if($r!=="number"&&$r!=="string"&&$r!=="boolean")return[new hr(Fr.key,mn,"stop domain value must be a number, string, or boolean")];if($r!=="number"&&B!=="categorical"){var Sn="number expected, "+$r+" found";return oi(C)&&B===void 0&&(Sn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new hr(Fr.key,mn,Sn)]}return B==="categorical"&&$r==="number"&&(!isFinite(kn)||Math.floor(kn)!==kn)?[new hr(Fr.key,mn,"integer expected, found "+kn)]:B!=="categorical"&&$r==="number"&&xe!==void 0&&kn<xe?[new hr(Fr.key,mn,"stop domain values must appear in ascending order")]:(xe=kn,B==="categorical"&&kn in he?[new hr(Fr.key,mn,"stop domain values must be unique")]:(he[kn]=!0,[]))}function dr(Fr){return hi({key:Fr.key,value:Fr.value,valueSpec:C,style:Fr.style,styleSpec:Fr.styleSpec})}}function Fo(E){var C=(E.expressionContext==="property"?du:Bl)(Tn(E.value),E.valueSpec);if(C.result==="error")return C.value.map(function(J){return new hr(""+E.key+J.key,E.value,J.message)});var B=C.value.expression||C.value._styleExpression.expression;if(E.expressionContext==="property"&&E.propertyKey==="text-font"&&!B.outputDefined())return[new hr(E.key,E.value,'Invalid data expression for "'+E.propertyKey+'". Output values must be contained as literals within the expression.')];if(E.expressionContext==="property"&&E.propertyType==="layout"&&!sl(B))return[new hr(E.key,E.value,'"feature-state" data expressions are not supported with layout properties.')];if(E.expressionContext==="filter"&&!sl(B))return[new hr(E.key,E.value,'"feature-state" data expressions are not supported with filters.')];if(E.expressionContext&&E.expressionContext.indexOf("cluster")===0){if(!Kl(B,["zoom","feature-state"]))return[new hr(E.key,E.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(E.expressionContext==="cluster-initial"&&!ol(B))return[new hr(E.key,E.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zu(E){var C=E.value,B=E.key,J=Ja(C);return J!=="boolean"?[new hr(B,C,"boolean expected, "+J+" found")]:[]}function $u(E){var C=E.key,B=E.value,J=Ja(B);return J!=="string"?[new hr(C,B,"color expected, "+J+" found")]:Yl(B)===null?[new hr(C,B,'color expected, "'+B+'" found')]:[]}function ms(E){var C=E.key,B=E.value,J=E.valueSpec,he=[];return Array.isArray(J.values)?J.values.indexOf(en(B))===-1&&he.push(new hr(C,B,"expected one of ["+J.values.join(", ")+"], "+JSON.stringify(B)+" found")):Object.keys(J.values).indexOf(en(B))===-1&&he.push(new hr(C,B,"expected one of ["+Object.keys(J.values).join(", ")+"], "+JSON.stringify(B)+" found")),he}function yu(E){if(E===!0||E===!1)return!0;if(!Array.isArray(E)||E.length===0)return!1;switch(E[0]){case"has":return E.length>=2&&E[1]!=="$id"&&E[1]!=="$type";case"in":return E.length>=3&&(typeof E[1]!="string"||Array.isArray(E[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return E.length!==3||Array.isArray(E[1])||Array.isArray(E[2]);case"any":case"all":for(var C=0,B=E.slice(1);C<B.length;C+=1){var J=B[C];if(!yu(J)&&typeof J!="boolean")return!1}return!0;default:return!0}}var mu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fu(E){if(E==null)return{filter:function(){return!0},needGeometry:!1};yu(E)||(E=qe(E));var C=Bl(E,mu);if(C.result==="error")throw new Error(C.value.map(function(J){return J.key+": "+J.message}).join(", "));var B=We(E);return{filter:function(J,he,xe){return C.value.evaluate(J,he,{},xe)},needGeometry:B}}function ze(E,C){return E<C?-1:E>C?1:0}function We(E){if(!Array.isArray(E))return!1;if(E[0]==="within")return!0;for(var C=1;C<E.length;C++)if(We(E[C]))return!0;return!1}function qe(E){if(!E)return!0;var C=E[0];if(E.length<=1)return C!=="any";var B=C==="=="?ot(E[1],E[2],"=="):C==="!="?fr(ot(E[1],E[2],"==")):C==="<"||C===">"||C==="<="||C===">="?ot(E[1],E[2],C):C==="any"?_t(E.slice(1)):C==="all"?["all"].concat(E.slice(1).map(qe)):C==="none"?["all"].concat(E.slice(1).map(qe).map(fr)):C==="in"?mt(E[1],E.slice(2)):C==="!in"?fr(mt(E[1],E.slice(2))):C==="has"?Et(E[1]):C==="!has"?fr(Et(E[1])):C==="within"?E:!0;return B}function ot(E,C,B){switch(E){case"$type":return["filter-type-"+B,C];case"$id":return["filter-id-"+B,C];default:return["filter-"+B,E,C]}}function _t(E){return["any"].concat(E.map(qe))}function mt(E,C){if(C.length===0)return!1;switch(E){case"$type":return["filter-type-in",["literal",C]];case"$id":return["filter-id-in",["literal",C]];default:return C.length>200&&!C.some(function(B){return typeof B!=typeof C[0]})?["filter-in-large",E,["literal",C.sort(ze)]]:["filter-in-small",E,["literal",C]]}}function Et(E){switch(E){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",E]}}function fr(E){return["!",E]}function pr(E){return yu(Tn(E.value))?Fo(vn({},E,{expressionContext:"filter",valueSpec:{value:"boolean"}})):lr(E)}function lr(E){var C=E.value,B=E.key;if(Ja(C)!=="array")return[new hr(B,C,"array expected, "+Ja(C)+" found")];var J=E.styleSpec,he,xe=[];if(C.length<1)return[new hr(B,C,"filter array must have at least 1 element")];switch(xe=xe.concat(ms({key:B+"[0]",value:C[0],valueSpec:J.filter_operator,style:E.style,styleSpec:E.styleSpec})),en(C[0])){case"<":case"<=":case">":case">=":C.length>=2&&en(C[1])==="$type"&&xe.push(new hr(B,C,'"$type" cannot be use with operator "'+C[0]+'"'));case"==":case"!=":C.length!==3&&xe.push(new hr(B,C,'filter array for operator "'+C[0]+'" must have 3 elements'));case"in":case"!in":C.length>=2&&(he=Ja(C[1]),he!=="string"&&xe.push(new hr(B+"[1]",C[1],"string expected, "+he+" found")));for(var Te=2;Te<C.length;Te++)he=Ja(C[Te]),en(C[1])==="$type"?xe=xe.concat(ms({key:B+"["+Te+"]",value:C[Te],valueSpec:J.geometry_type,style:E.style,styleSpec:E.styleSpec})):he!=="string"&&he!=="number"&&he!=="boolean"&&xe.push(new hr(B+"["+Te+"]",C[Te],"string, number, or boolean expected, "+he+" found"));break;case"any":case"all":case"none":for(var Fe=1;Fe<C.length;Fe++)xe=xe.concat(lr({key:B+"["+Fe+"]",value:C[Fe],style:E.style,styleSpec:E.styleSpec}));break;case"has":case"!has":he=Ja(C[1]),C.length!==2?xe.push(new hr(B,C,'filter array for "'+C[0]+'" operator must have 2 elements')):he!=="string"&&xe.push(new hr(B+"[1]",C[1],"string expected, "+he+" found"));break;case"within":he=Ja(C[1]),C.length!==2?xe.push(new hr(B,C,'filter array for "'+C[0]+'" operator must have 2 elements')):he!=="object"&&xe.push(new hr(B+"[1]",C[1],"object expected, "+he+" found"));break}return xe}function xr(E,C){var B=E.key,J=E.style,he=E.styleSpec,xe=E.value,Te=E.objectKey,Fe=he[C+"_"+E.layerType];if(!Fe)return[];var $e=Te.match(/^(.*)-transition$/);if(C==="paint"&&$e&&Fe[$e[1]]&&Fe[$e[1]].transition)return hi({key:B,value:xe,valueSpec:he.transition,style:J,styleSpec:he});var ft=E.valueSpec||Fe[Te];if(!ft)return[new hr(B,xe,'unknown property "'+Te+'"')];var pt;if(Ja(xe)==="string"&&oi(ft)&&!ft.tokens&&(pt=/^{([^}]+)}$/.exec(xe)))return[new hr(B,xe,'"'+Te+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(pt[1])+" }`.")];var Ot=[];return E.layerType==="symbol"&&(Te==="text-field"&&J&&!J.glyphs&&Ot.push(new hr(B,xe,'use of "text-field" requires a style "glyphs" property')),Te==="text-font"&&va(Tn(xe))&&en(xe.type)==="identity"&&Ot.push(new hr(B,xe,'"text-font" does not support identity functions'))),Ot.concat(hi({key:E.key,value:xe,valueSpec:ft,style:J,styleSpec:he,expressionContext:"property",propertyType:C,propertyKey:Te}))}function Pr(E){return xr(E,"paint")}function Xr(E){return xr(E,"layout")}function qr(E){var C=[],B=E.value,J=E.key,he=E.style,xe=E.styleSpec;!B.type&&!B.ref&&C.push(new hr(J,B,'either "type" or "ref" is required'));var Te=en(B.type),Fe=en(B.ref);if(B.id)for(var $e=en(B.id),ft=0;ft<E.arrayIndex;ft++){var pt=he.layers[ft];en(pt.id)===$e&&C.push(new hr(J,B.id,'duplicate layer id "'+B.id+'", previously used at line '+pt.id.__line__))}if("ref"in B){["type","source","source-layer","filter","layout"].forEach(function(dr){dr in B&&C.push(new hr(J,B[dr],'"'+dr+'" is prohibited for ref layers'))});var Ot;he.layers.forEach(function(dr){en(dr.id)===Fe&&(Ot=dr)}),Ot?Ot.ref?C.push(new hr(J,B.ref,"ref cannot reference another ref layer")):Te=en(Ot.type):C.push(new hr(J,B.ref,'ref layer "'+Fe+'" not found'))}else if(Te!=="background")if(!B.source)C.push(new hr(J,B,'missing required property "source"'));else{var rr=he.sources&&he.sources[B.source],qt=rr&&en(rr.type);rr?qt==="vector"&&Te==="raster"?C.push(new hr(J,B.source,'layer "'+B.id+'" requires a raster source')):qt==="raster"&&Te!=="raster"?C.push(new hr(J,B.source,'layer "'+B.id+'" requires a vector source')):qt==="vector"&&!B["source-layer"]?C.push(new hr(J,B,'layer "'+B.id+'" must specify a "source-layer"')):qt==="raster-dem"&&Te!=="hillshade"?C.push(new hr(J,B.source,"raster-dem source can only be used with layer type 'hillshade'.")):Te==="line"&&B.paint&&B.paint["line-gradient"]&&(qt!=="geojson"||!rr.lineMetrics)&&C.push(new hr(J,B,'layer "'+B.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):C.push(new hr(J,B.source,'source "'+B.source+'" not found'))}return C=C.concat(ks({key:J,value:B,valueSpec:xe.layer,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return hi({key:J+".type",value:B.type,valueSpec:xe.layer.type,style:E.style,styleSpec:E.styleSpec,object:B,objectKey:"type"})},filter:pr,layout:function(Fr){return ks({layer:B,key:Fr.key,value:Fr.value,style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{"*":function($r){return Xr(vn({layerType:Te},$r))}}})},paint:function(Fr){return ks({layer:B,key:Fr.key,value:Fr.value,style:Fr.style,styleSpec:Fr.styleSpec,objectElementValidators:{"*":function($r){return Pr(vn({layerType:Te},$r))}}})}}})),C}function bn(E){var C=E.value,B=E.key,J=Ja(C);return J!=="string"?[new hr(B,C,"string expected, "+J+" found")]:[]}var Dn={promoteId:ga};function Wn(E){var C=E.value,B=E.key,J=E.styleSpec,he=E.style;if(!C.type)return[new hr(B,C,'"type" is required')];var xe=en(C.type),Te;switch(xe){case"vector":case"raster":case"raster-dem":return Te=ks({key:B,value:C,valueSpec:J["source_"+xe.replace("-","_")],style:E.style,styleSpec:J,objectElementValidators:Dn}),Te;case"geojson":if(Te=ks({key:B,value:C,valueSpec:J.source_geojson,style:he,styleSpec:J,objectElementValidators:Dn}),C.cluster)for(var Fe in C.clusterProperties){var $e=C.clusterProperties[Fe],ft=$e[0],pt=$e[1],Ot=typeof ft=="string"?[ft,["accumulated"],["get",Fe]]:ft;Te.push.apply(Te,Fo({key:B+"."+Fe+".map",value:pt,expressionContext:"cluster-map"})),Te.push.apply(Te,Fo({key:B+"."+Fe+".reduce",value:Ot,expressionContext:"cluster-reduce"}))}return Te;case"video":return ks({key:B,value:C,valueSpec:J.source_video,style:he,styleSpec:J});case"image":return ks({key:B,value:C,valueSpec:J.source_image,style:he,styleSpec:J});case"canvas":return[new hr(B,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ms({key:B+".type",value:C.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:he,styleSpec:J})}}function ga(E){var C=E.key,B=E.value;if(Ja(B)==="string")return bn({key:C,value:B});var J=[];for(var he in B)J.push.apply(J,bn({key:C+"."+he,value:B[he]}));return J}function xa(E){var C=E.value,B=E.styleSpec,J=B.light,he=E.style,xe=[],Te=Ja(C);if(C===void 0)return xe;if(Te!=="object")return xe=xe.concat([new hr("light",C,"object expected, "+Te+" found")]),xe;for(var Fe in C){var $e=Fe.match(/^(.*)-transition$/);$e&&J[$e[1]]&&J[$e[1]].transition?xe=xe.concat(hi({key:Fe,value:C[Fe],valueSpec:B.transition,style:he,styleSpec:B})):J[Fe]?xe=xe.concat(hi({key:Fe,value:C[Fe],valueSpec:J[Fe],style:he,styleSpec:B})):xe=xe.concat([new hr(Fe,C[Fe],'unknown property "'+Fe+'"')])}return xe}function Ka(E){return bn(E).length===0?[]:Fo(E)}function Ya(E){return bn(E).length===0?[]:Fo(E)}var ei={"*":function(){return[]},array:Xu,boolean:zu,number:Ru,color:$u,constants:rn,enum:ms,filter:pr,function:Iu,layer:qr,object:ks,source:Wn,light:xa,string:bn,formatted:Ka,resolvedImage:Ya};function hi(E){var C=E.value,B=E.valueSpec,J=E.styleSpec;if(B.expression&&va(en(C)))return Iu(E);if(B.expression&&xo(Tn(C)))return Fo(E);if(B.type&&ei[B.type])return ei[B.type](E);var he=ks(vn({},E,{valueSpec:B.type?J[B.type]:B}));return he}function io(E){var C=E.value,B=E.key,J=bn(E);return J.length||(C.indexOf("{fontstack}")===-1&&J.push(new hr(B,C,'"glyphs" url must include a "{fontstack}" token')),C.indexOf("{range}")===-1&&J.push(new hr(B,C,'"glyphs" url must include a "{range}" token'))),J}function ri(E,C){C===void 0&&(C=Ht);var B=[];return B=B.concat(hi({key:"",value:E,valueSpec:C.$root,styleSpec:C,style:E,objectElementValidators:{glyphs:io,"*":function(){return[]}}})),E.constants&&(B=B.concat(rn({key:"constants",value:E.constants,style:E,styleSpec:C}))),Vi(B)}ri.source=fo(Wn),ri.light=fo(xa),ri.layer=fo(qr),ri.filter=fo(pr),ri.paintProperty=fo(Pr),ri.layoutProperty=fo(Xr);function Vi(E){return[].concat(E).sort(function(C,B){return C.line-B.line})}function fo(E){return function(){for(var C=[],B=arguments.length;B--;)C[B]=arguments[B];return Vi(E.apply(this,C))}}var _o=ri,bi=_o.light,Mi=_o.paintProperty,fs=_o.layoutProperty;function go(E,C){var B=!1;if(C&&C.length)for(var J=0,he=C;J<he.length;J+=1){var xe=he[J];E.fire(new br(new Error(xe.message))),B=!0}return B}var Po=le,Go=3;function le(E,C,B){var J=this.cells=[];if(E instanceof ArrayBuffer){this.arrayBuffer=E;var he=new Int32Array(this.arrayBuffer);E=he[0],C=he[1],B=he[2],this.d=C+2*B;for(var xe=0;xe<this.d*this.d;xe++){var Te=he[Go+xe],Fe=he[Go+xe+1];J.push(Te===Fe?null:he.subarray(Te,Fe))}var $e=he[Go+J.length],ft=he[Go+J.length+1];this.keys=he.subarray($e,ft),this.bboxes=he.subarray(ft),this.insert=this._insertReadonly}else{this.d=C+2*B;for(var pt=0;pt<this.d*this.d;pt++)J.push([]);this.keys=[],this.bboxes=[]}this.n=C,this.extent=E,this.padding=B,this.scale=C/E,this.uid=0;var Ot=B/C*E;this.min=-Ot,this.max=E+Ot}le.prototype.insert=function(E,C,B,J,he){this._forEachCell(C,B,J,he,this._insertCell,this.uid++),this.keys.push(E),this.bboxes.push(C),this.bboxes.push(B),this.bboxes.push(J),this.bboxes.push(he)},le.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},le.prototype._insertCell=function(E,C,B,J,he,xe){this.cells[he].push(xe)},le.prototype.query=function(E,C,B,J,he){var xe=this.min,Te=this.max;if(E<=xe&&C<=xe&&Te<=B&&Te<=J&&!he)return Array.prototype.slice.call(this.keys);var Fe=[],$e={};return this._forEachCell(E,C,B,J,this._queryCell,Fe,$e,he),Fe},le.prototype._queryCell=function(E,C,B,J,he,xe,Te,Fe){var $e=this.cells[he];if($e!==null)for(var ft=this.keys,pt=this.bboxes,Ot=0;Ot<$e.length;Ot++){var rr=$e[Ot];if(Te[rr]===void 0){var qt=rr*4;(Fe?Fe(pt[qt+0],pt[qt+1],pt[qt+2],pt[qt+3]):E<=pt[qt+2]&&C<=pt[qt+3]&&B>=pt[qt+0]&&J>=pt[qt+1])?(Te[rr]=!0,xe.push(ft[rr])):Te[rr]=!1}}},le.prototype._forEachCell=function(E,C,B,J,he,xe,Te,Fe){for(var $e=this._convertToCellCoord(E),ft=this._convertToCellCoord(C),pt=this._convertToCellCoord(B),Ot=this._convertToCellCoord(J),rr=$e;rr<=pt;rr++)for(var qt=ft;qt<=Ot;qt++){var dr=this.d*qt+rr;if(!(Fe&&!Fe(this._convertFromCellCoord(rr),this._convertFromCellCoord(qt),this._convertFromCellCoord(rr+1),this._convertFromCellCoord(qt+1)))&&he.call(this,E,C,B,J,dr,xe,Te,Fe))return}},le.prototype._convertFromCellCoord=function(E){return(E-this.padding)/this.scale},le.prototype._convertToCellCoord=function(E){return Math.max(0,Math.min(this.d-1,Math.floor(E*this.scale)+this.padding))},le.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var E=this.cells,C=Go+this.cells.length+1+1,B=0,J=0;J<this.cells.length;J++)B+=this.cells[J].length;var he=new Int32Array(C+B+this.keys.length+this.bboxes.length);he[0]=this.extent,he[1]=this.n,he[2]=this.padding;for(var xe=C,Te=0;Te<E.length;Te++){var Fe=E[Te];he[Go+Te]=xe,he.set(Fe,xe),xe+=Fe.length}return he[Go+E.length]=xe,he.set(this.keys,xe),xe+=this.keys.length,he[Go+E.length+1]=xe,he.set(this.bboxes,xe),xe+=this.bboxes.length,he.buffer};var _e=self.ImageData,Le=self.ImageBitmap,Be={};function Oe(E,C,B){B===void 0&&(B={}),Object.defineProperty(C,"_classRegistryKey",{value:E,writeable:!1}),Be[E]={klass:C,omit:B.omit||[],shallow:B.shallow||[]}}Oe("Object",Object),Po.serialize=function(C,B){var J=C.toArrayBuffer();return B&&B.push(J),{buffer:J}},Po.deserialize=function(C){return new Po(C.buffer)},Oe("Grid",Po),Oe("Color",vi),Oe("Error",Error),Oe("ResolvedImage",Mo),Oe("StylePropertyFunction",Nl),Oe("StyleExpression",ls,{omit:["_evaluator"]}),Oe("ZoomDependentExpression",us),Oe("ZoomConstantExpression",Ql),Oe("CompoundExpression",So,{omit:["_evaluate"]});for(var Ke in Jn)Jn[Ke]._classRegistryKey||Oe("Expression_"+Ke,Jn[Ke]);function xt(E){return E&&typeof ArrayBuffer<"u"&&(E instanceof ArrayBuffer||E.constructor&&E.constructor.name==="ArrayBuffer")}function ht(E){return Le&&E instanceof Le}function Pt(E,C){if(E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||E instanceof Boolean||E instanceof Number||E instanceof String||E instanceof Date||E instanceof RegExp)return E;if(xt(E)||ht(E))return C&&C.push(E),E;if(ArrayBuffer.isView(E)){var B=E;return C&&C.push(B.buffer),B}if(E instanceof _e)return C&&C.push(E.data.buffer),E;if(Array.isArray(E)){for(var J=[],he=0,xe=E;he<xe.length;he+=1){var Te=xe[he];J.push(Pt(Te,C))}return J}if(typeof E=="object"){var Fe=E.constructor,$e=Fe._classRegistryKey;if(!$e)throw new Error("can't serialize object of unregistered class");var ft=Fe.serialize?Fe.serialize(E,C):{};if(!Fe.serialize){for(var pt in E)if(E.hasOwnProperty(pt)&&!(Be[$e].omit.indexOf(pt)>=0)){var Ot=E[pt];ft[pt]=Be[$e].shallow.indexOf(pt)>=0?Ot:Pt(Ot,C)}E instanceof Error&&(ft.message=E.message)}if(ft.$name)throw new Error("$name property is reserved for worker serialization logic.");return $e!=="Object"&&(ft.$name=$e),ft}throw new Error("can't serialize object of type "+typeof E)}function jt(E){if(E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||E instanceof Boolean||E instanceof Number||E instanceof String||E instanceof Date||E instanceof RegExp||xt(E)||ht(E)||ArrayBuffer.isView(E)||E instanceof _e)return E;if(Array.isArray(E))return E.map(jt);if(typeof E=="object"){var C=E.$name||"Object",B=Be[C],J=B.klass;if(!J)throw new Error("can't deserialize unregistered class "+C);if(J.deserialize)return J.deserialize(E);for(var he=Object.create(J.prototype),xe=0,Te=Object.keys(E);xe<Te.length;xe+=1){var Fe=Te[xe];if(Fe!=="$name"){var $e=E[Fe];he[Fe]=Be[C].shallow.indexOf(Fe)>=0?$e:jt($e)}}return he}throw new Error("can't deserialize object of type "+typeof E)}var er=function(){this.first=!0};er.prototype.update=function(C,B){var J=Math.floor(C);return this.first?(this.first=!1,this.lastIntegerZoom=J,this.lastIntegerZoomTime=0,this.lastZoom=C,this.lastFloorZoom=J,!0):(this.lastFloorZoom>J?(this.lastIntegerZoom=J+1,this.lastIntegerZoomTime=B):this.lastFloorZoom<J&&(this.lastIntegerZoom=J,this.lastIntegerZoomTime=B),C!==this.lastZoom?(this.lastZoom=C,this.lastFloorZoom=J,!0):!1)};var tr={"Latin-1 Supplement":function(E){return E>=128&&E<=255},Arabic:function(E){return E>=1536&&E<=1791},"Arabic Supplement":function(E){return E>=1872&&E<=1919},"Arabic Extended-A":function(E){return E>=2208&&E<=2303},"Hangul Jamo":function(E){return E>=4352&&E<=4607},"Unified Canadian Aboriginal Syllabics":function(E){return E>=5120&&E<=5759},Khmer:function(E){return E>=6016&&E<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(E){return E>=6320&&E<=6399},"General Punctuation":function(E){return E>=8192&&E<=8303},"Letterlike Symbols":function(E){return E>=8448&&E<=8527},"Number Forms":function(E){return E>=8528&&E<=8591},"Miscellaneous Technical":function(E){return E>=8960&&E<=9215},"Control Pictures":function(E){return E>=9216&&E<=9279},"Optical Character Recognition":function(E){return E>=9280&&E<=9311},"Enclosed Alphanumerics":function(E){return E>=9312&&E<=9471},"Geometric Shapes":function(E){return E>=9632&&E<=9727},"Miscellaneous Symbols":function(E){return E>=9728&&E<=9983},"Miscellaneous Symbols and Arrows":function(E){return E>=11008&&E<=11263},"CJK Radicals Supplement":function(E){return E>=11904&&E<=12031},"Kangxi Radicals":function(E){return E>=12032&&E<=12255},"Ideographic Description Characters":function(E){return E>=12272&&E<=12287},"CJK Symbols and Punctuation":function(E){return E>=12288&&E<=12351},Hiragana:function(E){return E>=12352&&E<=12447},Katakana:function(E){return E>=12448&&E<=12543},Bopomofo:function(E){return E>=12544&&E<=12591},"Hangul Compatibility Jamo":function(E){return E>=12592&&E<=12687},Kanbun:function(E){return E>=12688&&E<=12703},"Bopomofo Extended":function(E){return E>=12704&&E<=12735},"CJK Strokes":function(E){return E>=12736&&E<=12783},"Katakana Phonetic Extensions":function(E){return E>=12784&&E<=12799},"Enclosed CJK Letters and Months":function(E){return E>=12800&&E<=13055},"CJK Compatibility":function(E){return E>=13056&&E<=13311},"CJK Unified Ideographs Extension A":function(E){return E>=13312&&E<=19903},"Yijing Hexagram Symbols":function(E){return E>=19904&&E<=19967},"CJK Unified Ideographs":function(E){return E>=19968&&E<=40959},"Yi Syllables":function(E){return E>=40960&&E<=42127},"Yi Radicals":function(E){return E>=42128&&E<=42191},"Hangul Jamo Extended-A":function(E){return E>=43360&&E<=43391},"Hangul Syllables":function(E){return E>=44032&&E<=55215},"Hangul Jamo Extended-B":function(E){return E>=55216&&E<=55295},"Private Use Area":function(E){return E>=57344&&E<=63743},"CJK Compatibility Ideographs":function(E){return E>=63744&&E<=64255},"Arabic Presentation Forms-A":function(E){return E>=64336&&E<=65023},"Vertical Forms":function(E){return E>=65040&&E<=65055},"CJK Compatibility Forms":function(E){return E>=65072&&E<=65103},"Small Form Variants":function(E){return E>=65104&&E<=65135},"Arabic Presentation Forms-B":function(E){return E>=65136&&E<=65279},"Halfwidth and Fullwidth Forms":function(E){return E>=65280&&E<=65519}};function Ar(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(Nr(J.charCodeAt(0)))return!0}return!1}function Qr(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(!ln(J.charCodeAt(0)))return!1}return!0}function ln(E){return!(tr.Arabic(E)||tr["Arabic Supplement"](E)||tr["Arabic Extended-A"](E)||tr["Arabic Presentation Forms-A"](E)||tr["Arabic Presentation Forms-B"](E))}function Lr(E){return E<11904?!1:!!(tr["Bopomofo Extended"](E)||tr.Bopomofo(E)||tr["CJK Compatibility Forms"](E)||tr["CJK Compatibility Ideographs"](E)||tr["CJK Compatibility"](E)||tr["CJK Radicals Supplement"](E)||tr["CJK Strokes"](E)||tr["CJK Symbols and Punctuation"](E)||tr["CJK Unified Ideographs Extension A"](E)||tr["CJK Unified Ideographs"](E)||tr["Enclosed CJK Letters and Months"](E)||tr["Halfwidth and Fullwidth Forms"](E)||tr.Hiragana(E)||tr["Ideographic Description Characters"](E)||tr["Kangxi Radicals"](E)||tr["Katakana Phonetic Extensions"](E)||tr.Katakana(E)||tr["Vertical Forms"](E)||tr["Yi Radicals"](E)||tr["Yi Syllables"](E))}function Nr(E){return E===746||E===747?!0:E<4352?!1:!!(tr["Bopomofo Extended"](E)||tr.Bopomofo(E)||tr["CJK Compatibility Forms"](E)&&!(E>=65097&&E<=65103)||tr["CJK Compatibility Ideographs"](E)||tr["CJK Compatibility"](E)||tr["CJK Radicals Supplement"](E)||tr["CJK Strokes"](E)||tr["CJK Symbols and Punctuation"](E)&&!(E>=12296&&E<=12305)&&!(E>=12308&&E<=12319)&&E!==12336||tr["CJK Unified Ideographs Extension A"](E)||tr["CJK Unified Ideographs"](E)||tr["Enclosed CJK Letters and Months"](E)||tr["Hangul Compatibility Jamo"](E)||tr["Hangul Jamo Extended-A"](E)||tr["Hangul Jamo Extended-B"](E)||tr["Hangul Jamo"](E)||tr["Hangul Syllables"](E)||tr.Hiragana(E)||tr["Ideographic Description Characters"](E)||tr.Kanbun(E)||tr["Kangxi Radicals"](E)||tr["Katakana Phonetic Extensions"](E)||tr.Katakana(E)&&E!==12540||tr["Halfwidth and Fullwidth Forms"](E)&&E!==65288&&E!==65289&&E!==65293&&!(E>=65306&&E<=65310)&&E!==65339&&E!==65341&&E!==65343&&!(E>=65371&&E<=65503)&&E!==65507&&!(E>=65512&&E<=65519)||tr["Small Form Variants"](E)&&!(E>=65112&&E<=65118)&&!(E>=65123&&E<=65126)||tr["Unified Canadian Aboriginal Syllabics"](E)||tr["Unified Canadian Aboriginal Syllabics Extended"](E)||tr["Vertical Forms"](E)||tr["Yijing Hexagram Symbols"](E)||tr["Yi Syllables"](E)||tr["Yi Radicals"](E))}function Zr(E){return!!(tr["Latin-1 Supplement"](E)&&(E===167||E===169||E===174||E===177||E===188||E===189||E===190||E===215||E===247)||tr["General Punctuation"](E)&&(E===8214||E===8224||E===8225||E===8240||E===8241||E===8251||E===8252||E===8258||E===8263||E===8264||E===8265||E===8273)||tr["Letterlike Symbols"](E)||tr["Number Forms"](E)||tr["Miscellaneous Technical"](E)&&(E>=8960&&E<=8967||E>=8972&&E<=8991||E>=8996&&E<=9e3||E===9003||E>=9085&&E<=9114||E>=9150&&E<=9165||E===9167||E>=9169&&E<=9179||E>=9186&&E<=9215)||tr["Control Pictures"](E)&&E!==9251||tr["Optical Character Recognition"](E)||tr["Enclosed Alphanumerics"](E)||tr["Geometric Shapes"](E)||tr["Miscellaneous Symbols"](E)&&!(E>=9754&&E<=9759)||tr["Miscellaneous Symbols and Arrows"](E)&&(E>=11026&&E<=11055||E>=11088&&E<=11097||E>=11192&&E<=11243)||tr["CJK Symbols and Punctuation"](E)||tr.Katakana(E)||tr["Private Use Area"](E)||tr["CJK Compatibility Forms"](E)||tr["Small Form Variants"](E)||tr["Halfwidth and Fullwidth Forms"](E)||E===8734||E===8756||E===8757||E>=9984&&E<=10087||E>=10102&&E<=10131||E===65532||E===65533)}function nn(E){return!(Nr(E)||Zr(E))}function on(E){return tr.Arabic(E)||tr["Arabic Supplement"](E)||tr["Arabic Extended-A"](E)||tr["Arabic Presentation Forms-A"](E)||tr["Arabic Presentation Forms-B"](E)}function Kr(E){return E>=1424&&E<=2303||tr["Arabic Presentation Forms-A"](E)||tr["Arabic Presentation Forms-B"](E)}function Un(E,C){return!(!C&&Kr(E)||E>=2304&&E<=3583||E>=3840&&E<=4255||tr.Khmer(E))}function ra(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(Kr(J.charCodeAt(0)))return!0}return!1}function _a(E,C){for(var B=0,J=E;B<J.length;B+=1){var he=J[B];if(!Un(he.charCodeAt(0),C))return!1}return!0}var ia={unavailable:"unavailable",deferred:"deferred",loading:"loading",loaded:"loaded",error:"error"},ka=null,la=ia.unavailable,Na=null,Pa=function(E){E&&typeof E=="string"&&E.indexOf("NetworkError")>-1&&(la=ia.error),ka&&ka(E)};function $a(){yi.fire(new kr("pluginStateChange",{pluginStatus:la,pluginURL:Na}))}var yi=new Mr,co=function(){return la},Ii=function(E){return E({pluginStatus:la,pluginURL:Na}),yi.on("pluginStateChange",E),E},fa=function(E,C,B){if(B===void 0&&(B=!1),la===ia.deferred||la===ia.loading||la===ia.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Na=Q.resolveURL(E),la=ia.deferred,ka=C,$a(),B||ai()},ai=function(){if(la!==ia.deferred||!Na)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");la=ia.loading,$a(),Na&&lt({url:Na},function(E){E?Pa(E):(la=ia.loaded,$a())})},Xa={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return la===ia.loaded||Xa.applyArabicShaping!=null},isLoading:function(){return la===ia.loading},setState:function(C){la=C.pluginStatus,Na=C.pluginURL},isParsed:function(){return Xa.applyArabicShaping!=null&&Xa.processBidirectionalText!=null&&Xa.processStyledBidirectionalText!=null},getPluginURL:function(){return Na}},Si=function(){!Xa.isLoading()&&!Xa.isLoaded()&&co()==="deferred"&&ai()},si=function(C,B){this.zoom=C,B?(this.now=B.now,this.fadeDuration=B.fadeDuration,this.zoomHistory=B.zoomHistory,this.transition=B.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new er,this.transition={})};si.prototype.isSupportedScript=function(C){return _a(C,Xa.isLoaded())},si.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},si.prototype.getCrossfadeParameters=function(){var C=this.zoom,B=C-Math.floor(C),J=this.crossFadingFactor();return C>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:B+(1-B)*J}:{fromScale:.5,toScale:1,t:1-(1-J)*B}};var oo=function(C,B){this.property=C,this.value=B,this.expression=vf(B===void 0?C.specification.default:B,C.specification)};oo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},oo.prototype.possiblyEvaluate=function(C,B,J){return this.property.possiblyEvaluate(this,C,B,J)};var Qi=function(C){this.property=C,this.value=new oo(C,void 0)};Qi.prototype.transitioned=function(C,B){return new Yo(this.property,this.value,B,w({},C.transition,this.transition),C.now)},Qi.prototype.untransitioned=function(){return new Yo(this.property,this.value,null,{},0)};var yo=function(C){this._properties=C,this._values=Object.create(C.defaultTransitionablePropertyValues)};yo.prototype.getValue=function(C){return I(this._values[C].value.value)},yo.prototype.setValue=function(C,B){this._values.hasOwnProperty(C)||(this._values[C]=new Qi(this._values[C].property)),this._values[C].value=new oo(this._values[C].property,B===null?void 0:I(B))},yo.prototype.getTransition=function(C){return I(this._values[C].transition)},yo.prototype.setTransition=function(C,B){this._values.hasOwnProperty(C)||(this._values[C]=new Qi(this._values[C].property)),this._values[C].transition=I(B)||void 0},yo.prototype.serialize=function(){for(var C={},B=0,J=Object.keys(this._values);B<J.length;B+=1){var he=J[B],xe=this.getValue(he);xe!==void 0&&(C[he]=xe);var Te=this.getTransition(he);Te!==void 0&&(C[he+"-transition"]=Te)}return C},yo.prototype.transitioned=function(C,B){for(var J=new Oo(this._properties),he=0,xe=Object.keys(this._values);he<xe.length;he+=1){var Te=xe[he];J._values[Te]=this._values[Te].transitioned(C,B._values[Te])}return J},yo.prototype.untransitioned=function(){for(var C=new Oo(this._properties),B=0,J=Object.keys(this._values);B<J.length;B+=1){var he=J[B];C._values[he]=this._values[he].untransitioned()}return C};var Yo=function(C,B,J,he,xe){this.property=C,this.value=B,this.begin=xe+he.delay||0,this.end=this.begin+he.duration||0,C.specification.transition&&(he.delay||he.duration)&&(this.prior=J)};Yo.prototype.possiblyEvaluate=function(C,B,J){var he=C.now||0,xe=this.value.possiblyEvaluate(C,B,J),Te=this.prior;if(Te){if(he>this.end)return this.prior=null,xe;if(this.value.isDataDriven())return this.prior=null,xe;if(he<this.begin)return Te.possiblyEvaluate(C,B,J);var Fe=(he-this.begin)/(this.end-this.begin);return this.property.interpolate(Te.possiblyEvaluate(C,B,J),xe,x(Fe))}else return xe};var Oo=function(C){this._properties=C,this._values=Object.create(C.defaultTransitioningPropertyValues)};Oo.prototype.possiblyEvaluate=function(C,B,J){for(var he=new Bi(this._properties),xe=0,Te=Object.keys(this._values);xe<Te.length;xe+=1){var Fe=Te[xe];he._values[Fe]=this._values[Fe].possiblyEvaluate(C,B,J)}return he},Oo.prototype.hasTransition=function(){for(var C=0,B=Object.keys(this._values);C<B.length;C+=1){var J=B[C];if(this._values[J].prior)return!0}return!1};var Wo=function(C){this._properties=C,this._values=Object.create(C.defaultPropertyValues)};Wo.prototype.getValue=function(C){return I(this._values[C].value)},Wo.prototype.setValue=function(C,B){this._values[C]=new oo(this._values[C].property,B===null?void 0:I(B))},Wo.prototype.serialize=function(){for(var C={},B=0,J=Object.keys(this._values);B<J.length;B+=1){var he=J[B],xe=this.getValue(he);xe!==void 0&&(C[he]=xe)}return C},Wo.prototype.possiblyEvaluate=function(C,B,J){for(var he=new Bi(this._properties),xe=0,Te=Object.keys(this._values);xe<Te.length;xe+=1){var Fe=Te[xe];he._values[Fe]=this._values[Fe].possiblyEvaluate(C,B,J)}return he};var Gi=function(C,B,J){this.property=C,this.value=B,this.parameters=J};Gi.prototype.isConstant=function(){return this.value.kind==="constant"},Gi.prototype.constantOr=function(C){return this.value.kind==="constant"?this.value.value:C},Gi.prototype.evaluate=function(C,B,J,he){return this.property.evaluate(this.value,this.parameters,C,B,J,he)};var Bi=function(C){this._properties=C,this._values=Object.create(C.defaultPossiblyEvaluatedValues)};Bi.prototype.get=function(C){return this._values[C]};var Ia=function(C){this.specification=C};Ia.prototype.possiblyEvaluate=function(C,B){return C.expression.evaluate(B)},Ia.prototype.interpolate=function(C,B,J){var he=Xs[this.specification.type];return he?he(C,B,J):C};var Za=function(C,B){this.specification=C,this.overrides=B};Za.prototype.possiblyEvaluate=function(C,B,J,he){return C.expression.kind==="constant"||C.expression.kind==="camera"?new Gi(this,{kind:"constant",value:C.expression.evaluate(B,null,{},J,he)},B):new Gi(this,C.expression,B)},Za.prototype.interpolate=function(C,B,J){if(C.value.kind!=="constant"||B.value.kind!=="constant")return C;if(C.value.value===void 0||B.value.value===void 0)return new Gi(this,{kind:"constant",value:void 0},C.parameters);var he=Xs[this.specification.type];return he?new Gi(this,{kind:"constant",value:he(C.value.value,B.value.value,J)},C.parameters):C},Za.prototype.evaluate=function(C,B,J,he,xe,Te){return C.kind==="constant"?C.value:C.evaluate(B,J,he,xe,Te)};var bo=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.possiblyEvaluate=function(J,he,xe,Te){if(J.value===void 0)return new Gi(this,{kind:"constant",value:void 0},he);if(J.expression.kind==="constant"){var Fe=J.expression.evaluate(he,null,{},xe,Te),$e=J.property.specification.type==="resolvedImage",ft=$e&&typeof Fe!="string"?Fe.name:Fe,pt=this._calculate(ft,ft,ft,he);return new Gi(this,{kind:"constant",value:pt},he)}else if(J.expression.kind==="camera"){var Ot=this._calculate(J.expression.evaluate({zoom:he.zoom-1}),J.expression.evaluate({zoom:he.zoom}),J.expression.evaluate({zoom:he.zoom+1}),he);return new Gi(this,{kind:"constant",value:Ot},he)}else return new Gi(this,J.expression,he)},C.prototype.evaluate=function(J,he,xe,Te,Fe,$e){if(J.kind==="source"){var ft=J.evaluate(he,xe,Te,Fe,$e);return this._calculate(ft,ft,ft,he)}else return J.kind==="composite"?this._calculate(J.evaluate({zoom:Math.floor(he.zoom)-1},xe,Te),J.evaluate({zoom:Math.floor(he.zoom)},xe,Te),J.evaluate({zoom:Math.floor(he.zoom)+1},xe,Te),he):J.value},C.prototype._calculate=function(J,he,xe,Te){var Fe=Te.zoom;return Fe>Te.zoomHistory.lastIntegerZoom?{from:J,to:he}:{from:xe,to:he}},C.prototype.interpolate=function(J){return J},C}(Za),eo=function(C){this.specification=C};eo.prototype.possiblyEvaluate=function(C,B,J,he){if(C.value!==void 0)if(C.expression.kind==="constant"){var xe=C.expression.evaluate(B,null,{},J,he);return this._calculate(xe,xe,xe,B)}else return this._calculate(C.expression.evaluate(new si(Math.floor(B.zoom-1),B)),C.expression.evaluate(new si(Math.floor(B.zoom),B)),C.expression.evaluate(new si(Math.floor(B.zoom+1),B)),B)},eo.prototype._calculate=function(C,B,J,he){var xe=he.zoom;return xe>he.zoomHistory.lastIntegerZoom?{from:C,to:B}:{from:J,to:B}},eo.prototype.interpolate=function(C){return C};var Do=function(C){this.specification=C};Do.prototype.possiblyEvaluate=function(C,B,J,he){return!!C.expression.evaluate(B,null,{},J,he)},Do.prototype.interpolate=function(){return!1};var Xi=function(C){this.properties=C,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(var B in C){var J=C[B];J.specification.overridable&&this.overridableProperties.push(B);var he=this.defaultPropertyValues[B]=new oo(J,void 0),xe=this.defaultTransitionablePropertyValues[B]=new Qi(J);this.defaultTransitioningPropertyValues[B]=xe.untransitioned(),this.defaultPossiblyEvaluatedValues[B]=he.possiblyEvaluate({})}};Oe("DataDrivenProperty",Za),Oe("DataConstantProperty",Ia),Oe("CrossFadedDataDrivenProperty",bo),Oe("CrossFadedProperty",eo),Oe("ColorRampProperty",Do);var Xo="-transition",xs=function(E){function C(B,J){if(E.call(this),this.id=B.id,this.type=B.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},B.type!=="custom"&&(B=B,this.metadata=B.metadata,this.minzoom=B.minzoom,this.maxzoom=B.maxzoom,B.type!=="background"&&(this.source=B.source,this.sourceLayer=B["source-layer"],this.filter=B.filter),J.layout&&(this._unevaluatedLayout=new Wo(J.layout)),J.paint)){this._transitionablePaint=new yo(J.paint);for(var he in B.paint)this.setPaintProperty(he,B.paint[he],{validate:!1});for(var xe in B.layout)this.setLayoutProperty(xe,B.layout[xe],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bi(J.paint)}}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},C.prototype.getLayoutProperty=function(J){return J==="visibility"?this.visibility:this._unevaluatedLayout.getValue(J)},C.prototype.setLayoutProperty=function(J,he,xe){if(xe===void 0&&(xe={}),he!=null){var Te="layers."+this.id+".layout."+J;if(this._validate(fs,Te,J,he,xe))return}if(J==="visibility"){this.visibility=he;return}this._unevaluatedLayout.setValue(J,he)},C.prototype.getPaintProperty=function(J){return k(J,Xo)?this._transitionablePaint.getTransition(J.slice(0,-Xo.length)):this._transitionablePaint.getValue(J)},C.prototype.setPaintProperty=function(J,he,xe){if(xe===void 0&&(xe={}),he!=null){var Te="layers."+this.id+".paint."+J;if(this._validate(Mi,Te,J,he,xe))return!1}if(k(J,Xo))return this._transitionablePaint.setTransition(J.slice(0,-Xo.length),he||void 0),!1;var Fe=this._transitionablePaint._values[J],$e=Fe.property.specification["property-type"]==="cross-faded-data-driven",ft=Fe.value.isDataDriven(),pt=Fe.value;this._transitionablePaint.setValue(J,he),this._handleSpecialPaintPropertyUpdate(J);var Ot=this._transitionablePaint._values[J].value,rr=Ot.isDataDriven();return rr||ft||$e||this._handleOverridablePaintPropertyUpdate(J,pt,Ot)},C.prototype._handleSpecialPaintPropertyUpdate=function(J){},C.prototype._handleOverridablePaintPropertyUpdate=function(J,he,xe){return!1},C.prototype.isHidden=function(J){return this.minzoom&&J<this.minzoom||this.maxzoom&&J>=this.maxzoom?!0:this.visibility==="none"},C.prototype.updateTransitions=function(J){this._transitioningPaint=this._transitionablePaint.transitioned(J,this._transitioningPaint)},C.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},C.prototype.recalculate=function(J,he){J.getCrossfadeParameters&&(this._crossfadeParameters=J.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(J,void 0,he)),this.paint=this._transitioningPaint.possiblyEvaluate(J,void 0,he)},C.prototype.serialize=function(){var J={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(J.layout=J.layout||{},J.layout.visibility=this.visibility),z(J,function(he,xe){return he!==void 0&&!(xe==="layout"&&!Object.keys(he).length)&&!(xe==="paint"&&!Object.keys(he).length)})},C.prototype._validate=function(J,he,xe,Te,Fe){return Fe===void 0&&(Fe={}),Fe&&Fe.validate===!1?!1:go(this,J.call(_o,{key:he,layerType:this.type,objectKey:xe,value:Te,styleSpec:Ht,style:{glyphs:!0,sprite:!0}}))},C.prototype.is3D=function(){return!1},C.prototype.isTileClipped=function(){return!1},C.prototype.hasOffscreenPass=function(){return!1},C.prototype.resize=function(){},C.prototype.isStateDependent=function(){for(var J in this.paint._values){var he=this.paint.get(J);if(!(!(he instanceof Gi)||!oi(he.property.specification))&&(he.value.kind==="source"||he.value.kind==="composite")&&he.value.isStateDependent)return!0}return!1},C}(Mr),Ul={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Zi=function(C,B){this._structArray=C,this._pos1=B*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},qu=128,Ml=5,Oi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};Oi.serialize=function(C,B){return C._trim(),B&&(C.isTransferred=!0,B.push(C.arrayBuffer)),{length:C.length,arrayBuffer:C.arrayBuffer}},Oi.deserialize=function(C){var B=Object.create(this.prototype);return B.arrayBuffer=C.arrayBuffer,B.length=C.length,B.capacity=C.arrayBuffer.byteLength/B.bytesPerElement,B._refreshViews(),B},Oi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Oi.prototype.clear=function(){this.length=0},Oi.prototype.resize=function(C){this.reserve(C),this.length=C},Oi.prototype.reserve=function(C){if(C>this.capacity){this.capacity=Math.max(C,Math.floor(this.capacity*Ml),qu),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var B=this.uint8;this._refreshViews(),B&&this.uint8.set(B)}},Oi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};function Ro(E,C){C===void 0&&(C=1);var B=0,J=0,he=E.map(function(Te){var Fe=Kc(Te.type),$e=B=Mf(B,Math.max(C,Fe)),ft=Te.components||1;return J=Math.max(J,Fe),B+=Fe*ft,{name:Te.name,type:Te.type,components:ft,offset:$e}}),xe=Mf(B,Math.max(J,C));return{members:he,size:xe,alignment:C}}function Kc(E){return Ul[E].BYTES_PER_ELEMENT}function Mf(E,C){return Math.ceil(E/C)*C}var pf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he){var xe=this.length;return this.resize(xe+1),this.emplace(xe,J,he)},C.prototype.emplace=function(J,he,xe){var Te=J*2;return this.int16[Te+0]=he,this.int16[Te+1]=xe,J},C}(Oi);pf.prototype.bytesPerElement=4,Oe("StructArrayLayout2i4",pf);var Ou=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,J,he,xe,Te)},C.prototype.emplace=function(J,he,xe,Te,Fe){var $e=J*4;return this.int16[$e+0]=he,this.int16[$e+1]=xe,this.int16[$e+2]=Te,this.int16[$e+3]=Fe,J},C}(Oi);Ou.prototype.bytesPerElement=8,Oe("StructArrayLayout4i8",Ou);var ef=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,J,he,xe,Te,Fe,$e)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e,ft){var pt=J*6;return this.int16[pt+0]=he,this.int16[pt+1]=xe,this.int16[pt+2]=Te,this.int16[pt+3]=Fe,this.int16[pt+4]=$e,this.int16[pt+5]=ft,J},C}(Oi);ef.prototype.bytesPerElement=12,Oe("StructArrayLayout2i4i12",ef);var Sf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,J,he,xe,Te,Fe,$e)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e,ft){var pt=J*4,Ot=J*8;return this.int16[pt+0]=he,this.int16[pt+1]=xe,this.uint8[Ot+4]=Te,this.uint8[Ot+5]=Fe,this.uint8[Ot+6]=$e,this.uint8[Ot+7]=ft,J},C}(Oi);Sf.prototype.bytesPerElement=8,Oe("StructArrayLayout2i4ub8",Sf);var Os=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr){var qt=this.length;return this.resize(qt+1),this.emplace(qt,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt){var dr=J*9,Fr=J*18;return this.uint16[dr+0]=he,this.uint16[dr+1]=xe,this.uint16[dr+2]=Te,this.uint16[dr+3]=Fe,this.uint16[dr+4]=$e,this.uint16[dr+5]=ft,this.uint16[dr+6]=pt,this.uint16[dr+7]=Ot,this.uint8[Fr+16]=rr,this.uint8[Fr+17]=qt,J},C}(Oi);Os.prototype.bytesPerElement=18,Oe("StructArrayLayout8ui2ub18",Os);var Bu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr){var Fr=this.length;return this.resize(Fr+1),this.emplace(Fr,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr){var an=J*12;return this.int16[an+0]=he,this.int16[an+1]=xe,this.int16[an+2]=Te,this.int16[an+3]=Fe,this.uint16[an+4]=$e,this.uint16[an+5]=ft,this.uint16[an+6]=pt,this.uint16[an+7]=Ot,this.int16[an+8]=rr,this.int16[an+9]=qt,this.int16[an+10]=dr,this.int16[an+11]=Fr,J},C}(Oi);Bu.prototype.bytesPerElement=24,Oe("StructArrayLayout4i4ui4i24",Bu);var $f=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,J,he,xe)},C.prototype.emplace=function(J,he,xe,Te){var Fe=J*3;return this.float32[Fe+0]=he,this.float32[Fe+1]=xe,this.float32[Fe+2]=Te,J},C}(Oi);$f.prototype.bytesPerElement=12,Oe("StructArrayLayout3f12",$f);var qf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J){var he=this.length;return this.resize(he+1),this.emplace(he,J)},C.prototype.emplace=function(J,he){var xe=J*1;return this.uint32[xe+0]=he,J},C}(Oi);qf.prototype.bytesPerElement=4,Oe("StructArrayLayout1ul4",qf);var df=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,$e,ft,pt,Ot){var rr=this.length;return this.resize(rr+1),this.emplace(rr,J,he,xe,Te,Fe,$e,ft,pt,Ot)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr){var qt=J*10,dr=J*5;return this.int16[qt+0]=he,this.int16[qt+1]=xe,this.int16[qt+2]=Te,this.int16[qt+3]=Fe,this.int16[qt+4]=$e,this.int16[qt+5]=ft,this.uint32[dr+3]=pt,this.uint16[qt+8]=Ot,this.uint16[qt+9]=rr,J},C}(Oi);df.prototype.bytesPerElement=20,Oe("StructArrayLayout6i1ul2ui20",df);var kf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,J,he,xe,Te,Fe,$e)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e,ft){var pt=J*6;return this.int16[pt+0]=he,this.int16[pt+1]=xe,this.int16[pt+2]=Te,this.int16[pt+3]=Fe,this.int16[pt+4]=$e,this.int16[pt+5]=ft,J},C}(Oi);kf.prototype.bytesPerElement=12,Oe("StructArrayLayout2i2i2i12",kf);var xu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe){var $e=this.length;return this.resize($e+1),this.emplace($e,J,he,xe,Te,Fe)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e){var ft=J*4,pt=J*8;return this.float32[ft+0]=he,this.float32[ft+1]=xe,this.float32[ft+2]=Te,this.int16[pt+6]=Fe,this.int16[pt+7]=$e,J},C}(Oi);xu.prototype.bytesPerElement=16,Oe("StructArrayLayout2f1f2i16",xu);var Qs=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,J,he,xe,Te)},C.prototype.emplace=function(J,he,xe,Te,Fe){var $e=J*12,ft=J*3;return this.uint8[$e+0]=he,this.uint8[$e+1]=xe,this.float32[ft+1]=Te,this.float32[ft+2]=Fe,J},C}(Oi);Qs.prototype.bytesPerElement=12,Oe("StructArrayLayout2ub2f12",Qs);var bu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,J,he,xe)},C.prototype.emplace=function(J,he,xe,Te){var Fe=J*3;return this.uint16[Fe+0]=he,this.uint16[Fe+1]=xe,this.uint16[Fe+2]=Te,J},C}(Oi);bu.prototype.bytesPerElement=6,Oe("StructArrayLayout3ui6",bu);var gf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr,an,$r,kn,mn){var Sn=this.length;return this.resize(Sn+1),this.emplace(Sn,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr,an,$r,kn,mn)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr,an,$r,kn,mn,Sn){var In=J*24,Gn=J*12,oa=J*48;return this.int16[In+0]=he,this.int16[In+1]=xe,this.uint16[In+2]=Te,this.uint16[In+3]=Fe,this.uint32[Gn+2]=$e,this.uint32[Gn+3]=ft,this.uint32[Gn+4]=pt,this.uint16[In+10]=Ot,this.uint16[In+11]=rr,this.uint16[In+12]=qt,this.float32[Gn+7]=dr,this.float32[Gn+8]=Fr,this.uint8[oa+36]=an,this.uint8[oa+37]=$r,this.uint8[oa+38]=kn,this.uint32[Gn+10]=mn,this.int16[In+22]=Sn,J},C}(Oi);gf.prototype.bytesPerElement=48,Oe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",gf);var Ef=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr,an,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Sa,ti,La,Da){var fi=this.length;return this.resize(fi+1),this.emplace(fi,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr,an,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Sa,ti,La,Da)},C.prototype.emplace=function(J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr,an,$r,kn,mn,Sn,In,Gn,oa,na,Ra,wa,Sa,ti,La,Da,fi){var qa=J*34,ki=J*17;return this.int16[qa+0]=he,this.int16[qa+1]=xe,this.int16[qa+2]=Te,this.int16[qa+3]=Fe,this.int16[qa+4]=$e,this.int16[qa+5]=ft,this.int16[qa+6]=pt,this.int16[qa+7]=Ot,this.uint16[qa+8]=rr,this.uint16[qa+9]=qt,this.uint16[qa+10]=dr,this.uint16[qa+11]=Fr,this.uint16[qa+12]=an,this.uint16[qa+13]=$r,this.uint16[qa+14]=kn,this.uint16[qa+15]=mn,this.uint16[qa+16]=Sn,this.uint16[qa+17]=In,this.uint16[qa+18]=Gn,this.uint16[qa+19]=oa,this.uint16[qa+20]=na,this.uint16[qa+21]=Ra,this.uint16[qa+22]=wa,this.uint32[ki+12]=Sa,this.float32[ki+13]=ti,this.float32[ki+14]=La,this.float32[ki+15]=Da,this.float32[ki+16]=fi,J},C}(Oi);Ef.prototype.bytesPerElement=68,Oe("StructArrayLayout8i15ui1ul4f68",Ef);var tf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J){var he=this.length;return this.resize(he+1),this.emplace(he,J)},C.prototype.emplace=function(J,he){var xe=J*1;return this.float32[xe+0]=he,J},C}(Oi);tf.prototype.bytesPerElement=4,Oe("StructArrayLayout1f4",tf);var ec=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,J,he,xe)},C.prototype.emplace=function(J,he,xe,Te){var Fe=J*3;return this.int16[Fe+0]=he,this.int16[Fe+1]=xe,this.int16[Fe+2]=Te,J},C}(Oi);ec.prototype.bytesPerElement=6,Oe("StructArrayLayout3i6",ec);var Nu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,J,he,xe)},C.prototype.emplace=function(J,he,xe,Te){var Fe=J*2,$e=J*4;return this.uint32[Fe+0]=he,this.uint16[$e+2]=xe,this.uint16[$e+3]=Te,J},C}(Oi);Nu.prototype.bytesPerElement=8,Oe("StructArrayLayout1ul2ui8",Nu);var yf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he){var xe=this.length;return this.resize(xe+1),this.emplace(xe,J,he)},C.prototype.emplace=function(J,he,xe){var Te=J*2;return this.uint16[Te+0]=he,this.uint16[Te+1]=xe,J},C}(Oi);yf.prototype.bytesPerElement=4,Oe("StructArrayLayout2ui4",yf);var rf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J){var he=this.length;return this.resize(he+1),this.emplace(he,J)},C.prototype.emplace=function(J,he){var xe=J*1;return this.uint16[xe+0]=he,J},C}(Oi);rf.prototype.bytesPerElement=2,Oe("StructArrayLayout1ui2",rf);var Uu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he){var xe=this.length;return this.resize(xe+1),this.emplace(xe,J,he)},C.prototype.emplace=function(J,he,xe){var Te=J*2;return this.float32[Te+0]=he,this.float32[Te+1]=xe,J},C}(Oi);Uu.prototype.bytesPerElement=8,Oe("StructArrayLayout2f8",Uu);var tc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function(J,he,xe,Te){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,J,he,xe,Te)},C.prototype.emplace=function(J,he,xe,Te,Fe){var $e=J*4;return this.float32[$e+0]=he,this.float32[$e+1]=xe,this.float32[$e+2]=Te,this.float32[$e+3]=Fe,J},C}(Oi);tc.prototype.bytesPerElement=16,Oe("StructArrayLayout4f16",tc);var bc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var B={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return B.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},B.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},B.x1.get=function(){return this._structArray.int16[this._pos2+2]},B.y1.get=function(){return this._structArray.int16[this._pos2+3]},B.x2.get=function(){return this._structArray.int16[this._pos2+4]},B.y2.get=function(){return this._structArray.int16[this._pos2+5]},B.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},B.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},B.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},B.anchorPoint.get=function(){return new h(this.anchorPointX,this.anchorPointY)},Object.defineProperties(C.prototype,B),C}(Zi);bc.prototype.size=20;var Hu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(J){return new bc(this,J)},C}(df);Oe("CollisionBoxArray",Hu);var rc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var B={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return B.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},B.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},B.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},B.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},B.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},B.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},B.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},B.segment.get=function(){return this._structArray.uint16[this._pos2+10]},B.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},B.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},B.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},B.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},B.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},B.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},B.placedOrientation.set=function(J){this._structArray.uint8[this._pos1+37]=J},B.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},B.hidden.set=function(J){this._structArray.uint8[this._pos1+38]=J},B.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},B.crossTileID.set=function(J){this._structArray.uint32[this._pos4+10]=J},B.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(C.prototype,B),C}(Zi);rc.prototype.size=48;var nf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(J){return new rc(this,J)},C}(gf);Oe("PlacedSymbolArray",nf);var _c=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var B={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return B.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},B.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},B.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},B.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},B.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},B.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},B.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},B.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},B.key.get=function(){return this._structArray.uint16[this._pos2+8]},B.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},B.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},B.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},B.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},B.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},B.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},B.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},B.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},B.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},B.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},B.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},B.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},B.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},B.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},B.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},B.crossTileID.set=function(J){this._structArray.uint32[this._pos4+12]=J},B.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},B.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},B.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},B.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(C.prototype,B),C}(Zi);_c.prototype.size=68;var wc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(J){return new _c(this,J)},C}(Ef);Oe("SymbolInstanceArray",wc);var Hl=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getoffsetX=function(J){return this.float32[J*1+0]},C}(tf);Oe("GlyphOffsetArray",Hl);var Tc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getx=function(J){return this.int16[J*3+0]},C.prototype.gety=function(J){return this.int16[J*3+1]},C.prototype.gettileUnitDistanceFromAnchor=function(J){return this.int16[J*3+2]},C}(ec);Oe("SymbolLineVertexArray",Tc);var Ac=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var B={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return B.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},B.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},B.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(C.prototype,B),C}(Zi);Ac.prototype.size=8;var nc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function(J){return new Ac(this,J)},C}(Nu);Oe("FeatureIndexArray",nc);var Mc=Ro([{name:"a_pos",components:2,type:"Int16"}],4),fe=Mc.members,V=function(C){C===void 0&&(C=[]),this.segments=C};V.prototype.prepareSegment=function(C,B,J,he){var xe=this.segments[this.segments.length-1];return C>V.MAX_VERTEX_ARRAY_LENGTH&&O("Max vertices per segment is "+V.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+C),(!xe||xe.vertexLength+C>V.MAX_VERTEX_ARRAY_LENGTH||xe.sortKey!==he)&&(xe={vertexOffset:B.length,primitiveOffset:J.length,vertexLength:0,primitiveLength:0},he!==void 0&&(xe.sortKey=he),this.segments.push(xe)),xe},V.prototype.get=function(){return this.segments},V.prototype.destroy=function(){for(var C=0,B=this.segments;C<B.length;C+=1){var J=B[C];for(var he in J.vaos)J.vaos[he].destroy()}},V.simpleSegment=function(C,B,J,he){return new V([{vertexOffset:C,primitiveOffset:B,vertexLength:J,primitiveLength:he,vaos:{},sortKey:0}])},V.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Oe("SegmentVector",V);function ve(E,C){return E=f(Math.floor(E),0,255),C=f(Math.floor(C),0,255),256*E+C}var Z=Ro([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),pe=a(function(E){function C(B,J){var he,xe,Te,Fe,$e,ft,pt,Ot;for(he=B.length&3,xe=B.length-he,Te=J,$e=3432918353,ft=461845907,Ot=0;Ot<xe;)pt=B.charCodeAt(Ot)&255|(B.charCodeAt(++Ot)&255)<<8|(B.charCodeAt(++Ot)&255)<<16|(B.charCodeAt(++Ot)&255)<<24,++Ot,pt=(pt&65535)*$e+(((pt>>>16)*$e&65535)<<16)&4294967295,pt=pt<<15|pt>>>17,pt=(pt&65535)*ft+(((pt>>>16)*ft&65535)<<16)&4294967295,Te^=pt,Te=Te<<13|Te>>>19,Fe=(Te&65535)*5+(((Te>>>16)*5&65535)<<16)&4294967295,Te=(Fe&65535)+27492+(((Fe>>>16)+58964&65535)<<16);switch(pt=0,he){case 3:pt^=(B.charCodeAt(Ot+2)&255)<<16;case 2:pt^=(B.charCodeAt(Ot+1)&255)<<8;case 1:pt^=B.charCodeAt(Ot)&255,pt=(pt&65535)*$e+(((pt>>>16)*$e&65535)<<16)&4294967295,pt=pt<<15|pt>>>17,pt=(pt&65535)*ft+(((pt>>>16)*ft&65535)<<16)&4294967295,Te^=pt}return Te^=B.length,Te^=Te>>>16,Te=(Te&65535)*2246822507+(((Te>>>16)*2246822507&65535)<<16)&4294967295,Te^=Te>>>13,Te=(Te&65535)*3266489909+(((Te>>>16)*3266489909&65535)<<16)&4294967295,Te^=Te>>>16,Te>>>0}E.exports=C}),Me=a(function(E){function C(B,J){for(var he=B.length,xe=J^he,Te=0,Fe;he>=4;)Fe=B.charCodeAt(Te)&255|(B.charCodeAt(++Te)&255)<<8|(B.charCodeAt(++Te)&255)<<16|(B.charCodeAt(++Te)&255)<<24,Fe=(Fe&65535)*1540483477+(((Fe>>>16)*1540483477&65535)<<16),Fe^=Fe>>>24,Fe=(Fe&65535)*1540483477+(((Fe>>>16)*1540483477&65535)<<16),xe=(xe&65535)*1540483477+(((xe>>>16)*1540483477&65535)<<16)^Fe,he-=4,++Te;switch(he){case 3:xe^=(B.charCodeAt(Te+2)&255)<<16;case 2:xe^=(B.charCodeAt(Te+1)&255)<<8;case 1:xe^=B.charCodeAt(Te)&255,xe=(xe&65535)*1540483477+(((xe>>>16)*1540483477&65535)<<16)}return xe^=xe>>>13,xe=(xe&65535)*1540483477+(((xe>>>16)*1540483477&65535)<<16),xe^=xe>>>15,xe>>>0}E.exports=C}),Re=pe,je=pe,ut=Me;Re.murmur3=je,Re.murmur2=ut;var Ct=function(){this.ids=[],this.positions=[],this.indexed=!1};Ct.prototype.add=function(C,B,J,he){this.ids.push(ur(C)),this.positions.push(B,J,he)},Ct.prototype.getPositions=function(C){for(var B=ur(C),J=0,he=this.ids.length-1;J<he;){var xe=J+he>>1;this.ids[xe]>=B?he=xe:J=xe+1}for(var Te=[];this.ids[J]===B;){var Fe=this.positions[3*J],$e=this.positions[3*J+1],ft=this.positions[3*J+2];Te.push({index:Fe,start:$e,end:ft}),J++}return Te},Ct.serialize=function(C,B){var J=new Float64Array(C.ids),he=new Uint32Array(C.positions);return vr(J,he,0,J.length-1),B&&B.push(J.buffer,he.buffer),{ids:J,positions:he}},Ct.deserialize=function(C){var B=new Ct;return B.ids=C.ids,B.positions=C.positions,B.indexed=!0,B};var Qt=Math.pow(2,53)-1;function ur(E){var C=+E;return!isNaN(C)&&C<=Qt?C:Re(String(E))}function vr(E,C,B,J){for(;B<J;){for(var he=E[B+J>>1],xe=B-1,Te=J+1;;){do xe++;while(E[xe]<he);do Te--;while(E[Te]>he);if(xe>=Te)break;Cr(E,xe,Te),Cr(C,3*xe,3*Te),Cr(C,3*xe+1,3*Te+1),Cr(C,3*xe+2,3*Te+2)}Te-B<J-Te?(vr(E,C,B,Te),B=Te+1):(vr(E,C,Te+1,J),J=Te)}}function Cr(E,C,B){var J=E[C];E[C]=E[B],E[B]=J}Oe("FeaturePositionMap",Ct);var Vr=function(C,B){this.gl=C.gl,this.location=B},Wr=function(E){function C(B,J){E.call(this,B,J),this.current=0}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){this.current!==J&&(this.current=J,this.gl.uniform1i(this.location,J))},C}(Vr),Ur=function(E){function C(B,J){E.call(this,B,J),this.current=0}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){this.current!==J&&(this.current=J,this.gl.uniform1f(this.location,J))},C}(Vr),Jr=function(E){function C(B,J){E.call(this,B,J),this.current=[0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){(J[0]!==this.current[0]||J[1]!==this.current[1])&&(this.current=J,this.gl.uniform2f(this.location,J[0],J[1]))},C}(Vr),hn=function(E){function C(B,J){E.call(this,B,J),this.current=[0,0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){(J[0]!==this.current[0]||J[1]!==this.current[1]||J[2]!==this.current[2])&&(this.current=J,this.gl.uniform3f(this.location,J[0],J[1],J[2]))},C}(Vr),Cn=function(E){function C(B,J){E.call(this,B,J),this.current=[0,0,0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){(J[0]!==this.current[0]||J[1]!==this.current[1]||J[2]!==this.current[2]||J[3]!==this.current[3])&&(this.current=J,this.gl.uniform4f(this.location,J[0],J[1],J[2],J[3]))},C}(Vr),Fn=function(E){function C(B,J){E.call(this,B,J),this.current=vi.transparent}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){(J.r!==this.current.r||J.g!==this.current.g||J.b!==this.current.b||J.a!==this.current.a)&&(this.current=J,this.gl.uniform4f(this.location,J.r,J.g,J.b,J.a))},C}(Vr),Kn=new Float32Array(16),qn=function(E){function C(B,J){E.call(this,B,J),this.current=Kn}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function(J){if(J[12]!==this.current[12]||J[0]!==this.current[0]){this.current=J,this.gl.uniformMatrix4fv(this.location,!1,J);return}for(var he=1;he<16;he++)if(J[he]!==this.current[he]){this.current=J,this.gl.uniformMatrix4fv(this.location,!1,J);break}},C}(Vr);function Qn(E){return[ve(255*E.r,255*E.g),ve(255*E.b,255*E.a)]}var ca=function(C,B,J){this.value=C,this.uniformNames=B.map(function(he){return"u_"+he}),this.type=J};ca.prototype.setUniform=function(C,B,J){C.set(J.constantOr(this.value))},ca.prototype.getBinding=function(C,B,J){return this.type==="color"?new Fn(C,B):new Ur(C,B)};var ba=function(C,B){this.uniformNames=B.map(function(J){return"u_"+J}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ba.prototype.setConstantPatternPositions=function(C,B){this.pixelRatioFrom=B.pixelRatio,this.pixelRatioTo=C.pixelRatio,this.patternFrom=B.tlbr,this.patternTo=C.tlbr},ba.prototype.setUniform=function(C,B,J,he){var xe=he==="u_pattern_to"?this.patternTo:he==="u_pattern_from"?this.patternFrom:he==="u_pixel_ratio_to"?this.pixelRatioTo:he==="u_pixel_ratio_from"?this.pixelRatioFrom:null;xe&&C.set(xe)},ba.prototype.getBinding=function(C,B,J){return J.substr(0,9)==="u_pattern"?new Cn(C,B):new Ur(C,B)};var ya=function(C,B,J,he){this.expression=C,this.type=J,this.maxValue=0,this.paintVertexAttributes=B.map(function(xe){return{name:"a_"+xe,type:"Float32",components:J==="color"?2:1,offset:0}}),this.paintVertexArray=new he};ya.prototype.populatePaintArray=function(C,B,J,he,xe){var Te=this.paintVertexArray.length,Fe=this.expression.evaluate(new si(0),B,{},he,[],xe);this.paintVertexArray.resize(C),this._setPaintValue(Te,C,Fe)},ya.prototype.updatePaintArray=function(C,B,J,he){var xe=this.expression.evaluate({zoom:0},J,he);this._setPaintValue(C,B,xe)},ya.prototype._setPaintValue=function(C,B,J){if(this.type==="color")for(var he=Qn(J),xe=C;xe<B;xe++)this.paintVertexArray.emplace(xe,he[0],he[1]);else{for(var Te=C;Te<B;Te++)this.paintVertexArray.emplace(Te,J);this.maxValue=Math.max(this.maxValue,Math.abs(J))}},ya.prototype.upload=function(C){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=C.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ya.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ta=function(C,B,J,he,xe,Te){this.expression=C,this.uniformNames=B.map(function(Fe){return"u_"+Fe+"_t"}),this.type=J,this.useIntegerZoom=he,this.zoom=xe,this.maxValue=0,this.paintVertexAttributes=B.map(function(Fe){return{name:"a_"+Fe,type:"Float32",components:J==="color"?4:2,offset:0}}),this.paintVertexArray=new Te};Ta.prototype.populatePaintArray=function(C,B,J,he,xe){var Te=this.expression.evaluate(new si(this.zoom),B,{},he,[],xe),Fe=this.expression.evaluate(new si(this.zoom+1),B,{},he,[],xe),$e=this.paintVertexArray.length;this.paintVertexArray.resize(C),this._setPaintValue($e,C,Te,Fe)},Ta.prototype.updatePaintArray=function(C,B,J,he){var xe=this.expression.evaluate({zoom:this.zoom},J,he),Te=this.expression.evaluate({zoom:this.zoom+1},J,he);this._setPaintValue(C,B,xe,Te)},Ta.prototype._setPaintValue=function(C,B,J,he){if(this.type==="color")for(var xe=Qn(J),Te=Qn(he),Fe=C;Fe<B;Fe++)this.paintVertexArray.emplace(Fe,xe[0],xe[1],Te[0],Te[1]);else{for(var $e=C;$e<B;$e++)this.paintVertexArray.emplace($e,J,he);this.maxValue=Math.max(this.maxValue,Math.abs(J),Math.abs(he))}},Ta.prototype.upload=function(C){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=C.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ta.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ta.prototype.setUniform=function(C,B){var J=this.useIntegerZoom?Math.floor(B.zoom):B.zoom,he=f(this.expression.interpolationFactor(J,this.zoom,this.zoom+1),0,1);C.set(he)},Ta.prototype.getBinding=function(C,B,J){return new Ur(C,B)};var Ca=function(C,B,J,he,xe,Te){this.expression=C,this.type=B,this.useIntegerZoom=J,this.zoom=he,this.layerId=Te,this.zoomInPaintVertexArray=new xe,this.zoomOutPaintVertexArray=new xe};Ca.prototype.populatePaintArray=function(C,B,J){var he=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(C),this.zoomOutPaintVertexArray.resize(C),this._setPaintValues(he,C,B.patterns&&B.patterns[this.layerId],J)},Ca.prototype.updatePaintArray=function(C,B,J,he,xe){this._setPaintValues(C,B,J.patterns&&J.patterns[this.layerId],xe)},Ca.prototype._setPaintValues=function(C,B,J,he){if(!(!he||!J)){var xe=J.min,Te=J.mid,Fe=J.max,$e=he[xe],ft=he[Te],pt=he[Fe];if(!(!$e||!ft||!pt))for(var Ot=C;Ot<B;Ot++)this.zoomInPaintVertexArray.emplace(Ot,ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],$e.tl[0],$e.tl[1],$e.br[0],$e.br[1],ft.pixelRatio,$e.pixelRatio),this.zoomOutPaintVertexArray.emplace(Ot,ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],pt.tl[0],pt.tl[1],pt.br[0],pt.br[1],ft.pixelRatio,pt.pixelRatio)}},Ca.prototype.upload=function(C){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=C.createVertexBuffer(this.zoomInPaintVertexArray,Z.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=C.createVertexBuffer(this.zoomOutPaintVertexArray,Z.members,this.expression.isStateDependent))},Ca.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ha=function(C,B,J,he){this.binders={},this.layoutAttributes=he,this._buffers=[];var xe=[];for(var Te in C.paint._values)if(J(Te)){var Fe=C.paint.get(Te);if(!(!(Fe instanceof Gi)||!oi(Fe.property.specification))){var $e=Li(Te,C.type),ft=Fe.value,pt=Fe.property.specification.type,Ot=Fe.property.useIntegerZoom,rr=Fe.property.specification["property-type"],qt=rr==="cross-faded"||rr==="cross-faded-data-driven";if(ft.kind==="constant")this.binders[Te]=qt?new ba(ft.value,$e):new ca(ft.value,$e,pt),xe.push("/u_"+Te);else if(ft.kind==="source"||qt){var dr=pi(Te,pt,"source");this.binders[Te]=qt?new Ca(ft,pt,Ot,B,dr,C.id):new ya(ft,$e,pt,dr),xe.push("/a_"+Te)}else{var Fr=pi(Te,pt,"composite");this.binders[Te]=new Ta(ft,$e,pt,Ot,B,Fr),xe.push("/z_"+Te)}}}this.cacheKey=xe.sort().join("")};Ha.prototype.getMaxValue=function(C){var B=this.binders[C];return B instanceof ya||B instanceof Ta?B.maxValue:0},Ha.prototype.populatePaintArrays=function(C,B,J,he,xe){for(var Te in this.binders){var Fe=this.binders[Te];(Fe instanceof ya||Fe instanceof Ta||Fe instanceof Ca)&&Fe.populatePaintArray(C,B,J,he,xe)}},Ha.prototype.setConstantPatternPositions=function(C,B){for(var J in this.binders){var he=this.binders[J];he instanceof ba&&he.setConstantPatternPositions(C,B)}},Ha.prototype.updatePaintArrays=function(C,B,J,he,xe){var Te=!1;for(var Fe in C)for(var $e=B.getPositions(Fe),ft=0,pt=$e;ft<pt.length;ft+=1){var Ot=pt[ft],rr=J.feature(Ot.index);for(var qt in this.binders){var dr=this.binders[qt];if((dr instanceof ya||dr instanceof Ta||dr instanceof Ca)&&dr.expression.isStateDependent===!0){var Fr=he.paint.get(qt);dr.expression=Fr.value,dr.updatePaintArray(Ot.start,Ot.end,rr,C[Fe],xe),Te=!0}}}return Te},Ha.prototype.defines=function(){var C=[];for(var B in this.binders){var J=this.binders[B];(J instanceof ca||J instanceof ba)&&C.push.apply(C,J.uniformNames.map(function(he){return"#define HAS_UNIFORM_"+he}))}return C},Ha.prototype.getPaintVertexBuffers=function(){return this._buffers},Ha.prototype.getUniforms=function(C,B){var J=[];for(var he in this.binders){var xe=this.binders[he];if(xe instanceof ca||xe instanceof ba||xe instanceof Ta)for(var Te=0,Fe=xe.uniformNames;Te<Fe.length;Te+=1){var $e=Fe[Te];if(B[$e]){var ft=xe.getBinding(C,B[$e],$e);J.push({name:$e,property:he,binding:ft})}}}return J},Ha.prototype.setUniforms=function(C,B,J,he){for(var xe=0,Te=B;xe<Te.length;xe+=1){var Fe=Te[xe],$e=Fe.name,ft=Fe.property,pt=Fe.binding;this.binders[ft].setUniform(pt,he,J.get(ft),$e)}},Ha.prototype.updatePaintBuffers=function(C){this._buffers=[];for(var B in this.binders){var J=this.binders[B];if(C&&J instanceof Ca){var he=C.fromScale===2?J.zoomInPaintVertexBuffer:J.zoomOutPaintVertexBuffer;he&&this._buffers.push(he)}else(J instanceof ya||J instanceof Ta)&&J.paintVertexBuffer&&this._buffers.push(J.paintVertexBuffer)}},Ha.prototype.upload=function(C){for(var B in this.binders){var J=this.binders[B];(J instanceof ya||J instanceof Ta||J instanceof Ca)&&J.upload(C)}this.updatePaintBuffers()},Ha.prototype.destroy=function(){for(var C in this.binders){var B=this.binders[C];(B instanceof ya||B instanceof Ta||B instanceof Ca)&&B.destroy()}};var ni=function(C,B,J,he){he===void 0&&(he=function(){return!0}),this.programConfigurations={};for(var xe=0,Te=B;xe<Te.length;xe+=1){var Fe=Te[xe];this.programConfigurations[Fe.id]=new Ha(Fe,J,he,C)}this.needsUpload=!1,this._featureMap=new Ct,this._bufferOffset=0};ni.prototype.populatePaintArrays=function(C,B,J,he,xe,Te){for(var Fe in this.programConfigurations)this.programConfigurations[Fe].populatePaintArrays(C,B,he,xe,Te);B.id!==void 0&&this._featureMap.add(B.id,J,this._bufferOffset,C),this._bufferOffset=C,this.needsUpload=!0},ni.prototype.updatePaintArrays=function(C,B,J,he){for(var xe=0,Te=J;xe<Te.length;xe+=1){var Fe=Te[xe];this.needsUpload=this.programConfigurations[Fe.id].updatePaintArrays(C,this._featureMap,B,Fe,he)||this.needsUpload}},ni.prototype.get=function(C){return this.programConfigurations[C]},ni.prototype.upload=function(C){if(this.needsUpload){for(var B in this.programConfigurations)this.programConfigurations[B].upload(C);this.needsUpload=!1}},ni.prototype.destroy=function(){for(var C in this.programConfigurations)this.programConfigurations[C].destroy()};function Li(E,C){var B={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]};return B[E]||[E.replace(C+"-","").replace(/-/g,"_")]}function ui(E){var C={"line-pattern":{source:Os,composite:Os},"fill-pattern":{source:Os,composite:Os},"fill-extrusion-pattern":{source:Os,composite:Os}};return C[E]}function pi(E,C,B){var J={color:{source:Uu,composite:tc},number:{source:tf,composite:Uu}},he=ui(E);return he&&he[B]||J[C][B]}Oe("ConstantBinder",ca),Oe("CrossFadedConstantBinder",ba),Oe("SourceExpressionBinder",ya),Oe("CrossFadedCompositeBinder",Ca),Oe("CompositeExpressionBinder",Ta),Oe("ProgramConfiguration",Ha,{omit:["_buffers"]}),Oe("ProgramConfigurationSet",ni);var Ba=8192;function Pi(E){return{min:-1*Math.pow(2,E-1),max:Math.pow(2,E-1)-1}}var zi=Pi(15);function Ni(E){for(var C=Ba/E.extent,B=E.loadGeometry(),J=0;J<B.length;J++)for(var he=B[J],xe=0;xe<he.length;xe++){var Te=he[xe];Te.x=Math.round(Te.x*C),Te.y=Math.round(Te.y*C),(Te.x<zi.min||Te.x>zi.max||Te.y<zi.min||Te.y>zi.max)&&(O("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Te.x=f(Te.x,zi.min,zi.max),Te.y=f(Te.y,zi.min,zi.max))}return B}function _i(E,C,B,J,he){E.emplaceBack(C*2+(J+1)/2,B*2+(he+1)/2)}var ji=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=C.index,this.hasPattern=!1,this.layoutVertexArray=new pf,this.indexArray=new bu,this.segments=new V,this.programConfigurations=new ni(fe,C.layers,C.zoom),this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id})};ji.prototype.populate=function(C,B,J){var he=this.layers[0],xe=[],Te=null;he.type==="circle"&&(Te=he.layout.get("circle-sort-key"));for(var Fe=0,$e=C;Fe<$e.length;Fe+=1){var ft=$e[Fe],pt=ft.feature,Ot=ft.id,rr=ft.index,qt=ft.sourceLayerIndex,dr=this.layers[0]._featureFilter.needGeometry,Fr={type:pt.type,id:Ot,properties:pt.properties,geometry:dr?Ni(pt):[]};if(this.layers[0]._featureFilter.filter(new si(this.zoom),Fr,J)){dr||(Fr.geometry=Ni(pt));var an=Te?Te.evaluate(Fr,{},J):void 0,$r={id:Ot,properties:pt.properties,type:pt.type,sourceLayerIndex:qt,index:rr,geometry:Fr.geometry,patterns:{},sortKey:an};xe.push($r)}}Te&&xe.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var kn=0,mn=xe;kn<mn.length;kn+=1){var Sn=mn[kn],In=Sn,Gn=In.geometry,oa=In.index,na=In.sourceLayerIndex,Ra=C[oa].feature;this.addFeature(Sn,Gn,oa,J),B.featureIndex.insert(Ra,Gn,oa,na,this.index)}},ji.prototype.update=function(C,B,J){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(C,B,this.stateDependentLayers,J)},ji.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ji.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ji.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,fe),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},ji.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ji.prototype.addFeature=function(C,B,J,he){for(var xe=0,Te=B;xe<Te.length;xe+=1)for(var Fe=Te[xe],$e=0,ft=Fe;$e<ft.length;$e+=1){var pt=ft[$e],Ot=pt.x,rr=pt.y;if(!(Ot<0||Ot>=Ba||rr<0||rr>=Ba)){var qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,C.sortKey),dr=qt.vertexLength;_i(this.layoutVertexArray,Ot,rr,-1,-1),_i(this.layoutVertexArray,Ot,rr,1,-1),_i(this.layoutVertexArray,Ot,rr,1,1),_i(this.layoutVertexArray,Ot,rr,-1,1),this.indexArray.emplaceBack(dr,dr+1,dr+2),this.indexArray.emplaceBack(dr,dr+3,dr+2),qt.vertexLength+=4,qt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,J,{},he)},Oe("CircleBucket",ji,{omit:["layers"]});function ii(E,C){for(var B=0;B<E.length;B++)if(Bs(C,E[B]))return!0;for(var J=0;J<C.length;J++)if(Bs(E,C[J]))return!0;return!!kl(E,C)}function wi(E,C,B){return!!(Bs(E,C)||ql(C,E,B))}function wo(E,C){if(E.length===1)return eu(C,E[0]);for(var B=0;B<C.length;B++)for(var J=C[B],he=0;he<J.length;he++)if(Bs(E,J[he]))return!0;for(var xe=0;xe<E.length;xe++)if(eu(C,E[xe]))return!0;for(var Te=0;Te<C.length;Te++)if(kl(E,C[Te]))return!0;return!1}function Bo(E,C,B){for(var J=0;J<C.length;J++){var he=C[J];if(E.length>=3){for(var xe=0;xe<he.length;xe++)if(Bs(E,he[xe]))return!0}if(Sl(E,he,B))return!0}return!1}function Sl(E,C,B){if(E.length>1){if(kl(E,C))return!0;for(var J=0;J<C.length;J++)if(ql(C[J],E,B))return!0}for(var he=0;he<E.length;he++)if(ql(E[he],C,B))return!0;return!1}function kl(E,C){if(E.length===0||C.length===0)return!1;for(var B=0;B<E.length-1;B++)for(var J=E[B],he=E[B+1],xe=0;xe<C.length-1;xe++){var Te=C[xe],Fe=C[xe+1];if($l(J,he,Te,Fe))return!0}return!1}function $l(E,C,B,J){return F(E,B,J)!==F(C,B,J)&&F(E,C,B)!==F(E,C,J)}function ql(E,C,B){var J=B*B;if(C.length===1)return E.distSqr(C[0])<J;for(var he=1;he<C.length;he++){var xe=C[he-1],Te=C[he];if(_u(E,xe,Te)<J)return!0}return!1}function _u(E,C,B){var J=C.distSqr(B);if(J===0)return E.distSqr(C);var he=((E.x-C.x)*(B.x-C.x)+(E.y-C.y)*(B.y-C.y))/J;return he<0?E.distSqr(C):he>1?E.distSqr(B):E.distSqr(B.sub(C)._mult(he)._add(C))}function eu(E,C){for(var B=!1,J,he,xe,Te=0;Te<E.length;Te++){J=E[Te];for(var Fe=0,$e=J.length-1;Fe<J.length;$e=Fe++)he=J[Fe],xe=J[$e],he.y>C.y!=xe.y>C.y&&C.x<(xe.x-he.x)*(C.y-he.y)/(xe.y-he.y)+he.x&&(B=!B)}return B}function Bs(E,C){for(var B=!1,J=0,he=E.length-1;J<E.length;he=J++){var xe=E[J],Te=E[he];xe.y>C.y!=Te.y>C.y&&C.x<(Te.x-xe.x)*(C.y-xe.y)/(Te.y-xe.y)+xe.x&&(B=!B)}return B}function Vu(E,C,B,J,he){for(var xe=0,Te=E;xe<Te.length;xe+=1){var Fe=Te[xe];if(C<=Fe.x&&B<=Fe.y&&J>=Fe.x&&he>=Fe.y)return!0}var $e=[new h(C,B),new h(C,he),new h(J,he),new h(J,B)];if(E.length>2)for(var ft=0,pt=$e;ft<pt.length;ft+=1){var Ot=pt[ft];if(Bs(E,Ot))return!0}for(var rr=0;rr<E.length-1;rr++){var qt=E[rr],dr=E[rr+1];if(bs(qt,dr,$e))return!0}return!1}function bs(E,C,B){var J=B[0],he=B[2];if(E.x<J.x&&C.x<J.x||E.x>he.x&&C.x>he.x||E.y<J.y&&C.y<J.y||E.y>he.y&&C.y>he.y)return!1;var xe=F(E,C,B[0]);return xe!==F(E,C,B[1])||xe!==F(E,C,B[2])||xe!==F(E,C,B[3])}function cl(E,C,B){var J=C.paint.get(E).value;return J.kind==="constant"?J.value:B.programConfigurations.get(C.id).getMaxValue(E)}function tu(E){return Math.sqrt(E[0]*E[0]+E[1]*E[1])}function Vl(E,C,B,J,he){if(!C[0]&&!C[1])return E;var xe=h.convert(C)._mult(he);B==="viewport"&&xe._rotate(-J);for(var Te=[],Fe=0;Fe<E.length;Fe++){var $e=E[Fe];Te.push($e.sub(xe))}return Te}var ru=new Xi({"circle-sort-key":new Za(Ht.layout_circle["circle-sort-key"])}),Cf=new Xi({"circle-radius":new Za(Ht.paint_circle["circle-radius"]),"circle-color":new Za(Ht.paint_circle["circle-color"]),"circle-blur":new Za(Ht.paint_circle["circle-blur"]),"circle-opacity":new Za(Ht.paint_circle["circle-opacity"]),"circle-translate":new Ia(Ht.paint_circle["circle-translate"]),"circle-translate-anchor":new Ia(Ht.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ia(Ht.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ia(Ht.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Za(Ht.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Za(Ht.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Za(Ht.paint_circle["circle-stroke-opacity"])}),Zu={paint:Cf,layout:ru},cs=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var E=arguments,C=0,B=arguments.length;B--;)C+=E[B]*E[B];return Math.sqrt(C)});function mf(){var E=new cs(4);return cs!=Float32Array&&(E[1]=0,E[2]=0),E[0]=1,E[3]=1,E}function Es(E,C,B){var J=C[0],he=C[1],xe=C[2],Te=C[3],Fe=Math.sin(B),$e=Math.cos(B);return E[0]=J*$e+xe*Fe,E[1]=he*$e+Te*Fe,E[2]=J*-Fe+xe*$e,E[3]=he*-Fe+Te*$e,E}function xf(){var E=new cs(9);return cs!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E}function Lf(E,C){var B=Math.sin(C),J=Math.cos(C);return E[0]=J,E[1]=B,E[2]=0,E[3]=-B,E[4]=J,E[5]=0,E[6]=0,E[7]=0,E[8]=1,E}function Pf(){var E=new cs(16);return cs!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0),E[0]=1,E[5]=1,E[10]=1,E[15]=1,E}function Sc(E){var C=new cs(16);return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C[4]=E[4],C[5]=E[5],C[6]=E[6],C[7]=E[7],C[8]=E[8],C[9]=E[9],C[10]=E[10],C[11]=E[11],C[12]=E[12],C[13]=E[13],C[14]=E[14],C[15]=E[15],C}function Df(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E}function af(E,C){var B=C[0],J=C[1],he=C[2],xe=C[3],Te=C[4],Fe=C[5],$e=C[6],ft=C[7],pt=C[8],Ot=C[9],rr=C[10],qt=C[11],dr=C[12],Fr=C[13],an=C[14],$r=C[15],kn=B*Fe-J*Te,mn=B*$e-he*Te,Sn=B*ft-xe*Te,In=J*$e-he*Fe,Gn=J*ft-xe*Fe,oa=he*ft-xe*$e,na=pt*Fr-Ot*dr,Ra=pt*an-rr*dr,wa=pt*$r-qt*dr,Sa=Ot*an-rr*Fr,ti=Ot*$r-qt*Fr,La=rr*$r-qt*an,Da=kn*La-mn*ti+Sn*Sa+In*wa-Gn*Ra+oa*na;return Da?(Da=1/Da,E[0]=(Fe*La-$e*ti+ft*Sa)*Da,E[1]=(he*ti-J*La-xe*Sa)*Da,E[2]=(Fr*oa-an*Gn+$r*In)*Da,E[3]=(rr*Gn-Ot*oa-qt*In)*Da,E[4]=($e*wa-Te*La-ft*Ra)*Da,E[5]=(B*La-he*wa+xe*Ra)*Da,E[6]=(an*Sn-dr*oa-$r*mn)*Da,E[7]=(pt*oa-rr*Sn+qt*mn)*Da,E[8]=(Te*ti-Fe*wa+ft*na)*Da,E[9]=(J*wa-B*ti-xe*na)*Da,E[10]=(dr*Gn-Fr*Sn+$r*kn)*Da,E[11]=(Ot*Sn-pt*Gn-qt*kn)*Da,E[12]=(Fe*Ra-Te*Sa-$e*na)*Da,E[13]=(B*Sa-J*Ra+he*na)*Da,E[14]=(Fr*mn-dr*In-an*kn)*Da,E[15]=(pt*In-Ot*mn+rr*kn)*Da,E):null}function of(E,C,B){var J=C[0],he=C[1],xe=C[2],Te=C[3],Fe=C[4],$e=C[5],ft=C[6],pt=C[7],Ot=C[8],rr=C[9],qt=C[10],dr=C[11],Fr=C[12],an=C[13],$r=C[14],kn=C[15],mn=B[0],Sn=B[1],In=B[2],Gn=B[3];return E[0]=mn*J+Sn*Fe+In*Ot+Gn*Fr,E[1]=mn*he+Sn*$e+In*rr+Gn*an,E[2]=mn*xe+Sn*ft+In*qt+Gn*$r,E[3]=mn*Te+Sn*pt+In*dr+Gn*kn,mn=B[4],Sn=B[5],In=B[6],Gn=B[7],E[4]=mn*J+Sn*Fe+In*Ot+Gn*Fr,E[5]=mn*he+Sn*$e+In*rr+Gn*an,E[6]=mn*xe+Sn*ft+In*qt+Gn*$r,E[7]=mn*Te+Sn*pt+In*dr+Gn*kn,mn=B[8],Sn=B[9],In=B[10],Gn=B[11],E[8]=mn*J+Sn*Fe+In*Ot+Gn*Fr,E[9]=mn*he+Sn*$e+In*rr+Gn*an,E[10]=mn*xe+Sn*ft+In*qt+Gn*$r,E[11]=mn*Te+Sn*pt+In*dr+Gn*kn,mn=B[12],Sn=B[13],In=B[14],Gn=B[15],E[12]=mn*J+Sn*Fe+In*Ot+Gn*Fr,E[13]=mn*he+Sn*$e+In*rr+Gn*an,E[14]=mn*xe+Sn*ft+In*qt+Gn*$r,E[15]=mn*Te+Sn*pt+In*dr+Gn*kn,E}function Co(E,C,B){var J=B[0],he=B[1],xe=B[2],Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr,an,$r;return C===E?(E[12]=C[0]*J+C[4]*he+C[8]*xe+C[12],E[13]=C[1]*J+C[5]*he+C[9]*xe+C[13],E[14]=C[2]*J+C[6]*he+C[10]*xe+C[14],E[15]=C[3]*J+C[7]*he+C[11]*xe+C[15]):(Te=C[0],Fe=C[1],$e=C[2],ft=C[3],pt=C[4],Ot=C[5],rr=C[6],qt=C[7],dr=C[8],Fr=C[9],an=C[10],$r=C[11],E[0]=Te,E[1]=Fe,E[2]=$e,E[3]=ft,E[4]=pt,E[5]=Ot,E[6]=rr,E[7]=qt,E[8]=dr,E[9]=Fr,E[10]=an,E[11]=$r,E[12]=Te*J+pt*he+dr*xe+C[12],E[13]=Fe*J+Ot*he+Fr*xe+C[13],E[14]=$e*J+rr*he+an*xe+C[14],E[15]=ft*J+qt*he+$r*xe+C[15]),E}function $s(E,C,B){var J=B[0],he=B[1],xe=B[2];return E[0]=C[0]*J,E[1]=C[1]*J,E[2]=C[2]*J,E[3]=C[3]*J,E[4]=C[4]*he,E[5]=C[5]*he,E[6]=C[6]*he,E[7]=C[7]*he,E[8]=C[8]*xe,E[9]=C[9]*xe,E[10]=C[10]*xe,E[11]=C[11]*xe,E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15],E}function qs(E,C,B){var J=Math.sin(B),he=Math.cos(B),xe=C[4],Te=C[5],Fe=C[6],$e=C[7],ft=C[8],pt=C[9],Ot=C[10],rr=C[11];return C!==E&&(E[0]=C[0],E[1]=C[1],E[2]=C[2],E[3]=C[3],E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15]),E[4]=xe*he+ft*J,E[5]=Te*he+pt*J,E[6]=Fe*he+Ot*J,E[7]=$e*he+rr*J,E[8]=ft*he-xe*J,E[9]=pt*he-Te*J,E[10]=Ot*he-Fe*J,E[11]=rr*he-$e*J,E}function Rf(E,C,B){var J=Math.sin(B),he=Math.cos(B),xe=C[0],Te=C[1],Fe=C[2],$e=C[3],ft=C[4],pt=C[5],Ot=C[6],rr=C[7];return C!==E&&(E[8]=C[8],E[9]=C[9],E[10]=C[10],E[11]=C[11],E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15]),E[0]=xe*he+ft*J,E[1]=Te*he+pt*J,E[2]=Fe*he+Ot*J,E[3]=$e*he+rr*J,E[4]=ft*he-xe*J,E[5]=pt*he-Te*J,E[6]=Ot*he-Fe*J,E[7]=rr*he-$e*J,E}function ac(E,C,B,J,he){var xe=1/Math.tan(C/2),Te;return E[0]=xe/B,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=xe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,he!=null&&he!==1/0?(Te=1/(J-he),E[10]=(he+J)*Te,E[14]=2*he*J*Te):(E[10]=-1,E[14]=-2*J),E}function Jc(E,C,B,J,he,xe,Te){var Fe=1/(C-B),$e=1/(J-he),ft=1/(xe-Te);return E[0]=-2*Fe,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*$e,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*ft,E[11]=0,E[12]=(C+B)*Fe,E[13]=(he+J)*$e,E[14]=(Te+xe)*ft,E[15]=1,E}var Qc=of;function bf(){var E=new cs(3);return cs!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0),E}function $c(E){var C=new cs(3);return C[0]=E[0],C[1]=E[1],C[2]=E[2],C}function If(E,C,B){return E[0]=C[0]+B[0],E[1]=C[1]+B[1],E[2]=C[2]+B[2],E}function qc(E,C,B){return E[0]=C[0]-B[0],E[1]=C[1]-B[1],E[2]=C[2]-B[2],E}function eh(E,C,B){return E[0]=C[0]*B,E[1]=C[1]*B,E[2]=C[2]*B,E}function ic(E,C){var B=C[0],J=C[1],he=C[2],xe=B*B+J*J+he*he;return xe>0&&(xe=1/Math.sqrt(xe)),E[0]=C[0]*xe,E[1]=C[1]*xe,E[2]=C[2]*xe,E}function Gv(E,C){return E[0]*C[0]+E[1]*C[1]+E[2]*C[2]}function Yv(E,C,B){var J=C[0],he=C[1],xe=C[2],Te=B[0],Fe=B[1],$e=B[2];return E[0]=he*$e-xe*Fe,E[1]=xe*Te-J*$e,E[2]=J*Fe-he*Te,E}function Wv(E,C,B){var J=C[0],he=C[1],xe=C[2];return E[0]=J*B[0]+he*B[3]+xe*B[6],E[1]=J*B[1]+he*B[4]+xe*B[7],E[2]=J*B[2]+he*B[5]+xe*B[8],E}var Xv=qc;(function(){var E=bf();return function(C,B,J,he,xe,Te){var Fe,$e;for(B||(B=3),J||(J=0),he?$e=Math.min(he*B+J,C.length):$e=C.length,Fe=J;Fe<$e;Fe+=B)E[0]=C[Fe],E[1]=C[Fe+1],E[2]=C[Fe+2],xe(E,E,Te),C[Fe]=E[0],C[Fe+1]=E[1],C[Fe+2]=E[2];return C}})();function Zv(){var E=new cs(4);return cs!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0,E[3]=0),E}function jv(E,C,B){return E[0]=C[0]*B,E[1]=C[1]*B,E[2]=C[2]*B,E[3]=C[3]*B,E}function Kv(E,C){return E[0]*C[0]+E[1]*C[1]+E[2]*C[2]+E[3]*C[3]}function kc(E,C,B){var J=C[0],he=C[1],xe=C[2],Te=C[3];return E[0]=B[0]*J+B[4]*he+B[8]*xe+B[12]*Te,E[1]=B[1]*J+B[5]*he+B[9]*xe+B[13]*Te,E[2]=B[2]*J+B[6]*he+B[10]*xe+B[14]*Te,E[3]=B[3]*J+B[7]*he+B[11]*xe+B[15]*Te,E}(function(){var E=Zv();return function(C,B,J,he,xe,Te){var Fe,$e;for(B||(B=4),J||(J=0),he?$e=Math.min(he*B+J,C.length):$e=C.length,Fe=J;Fe<$e;Fe+=B)E[0]=C[Fe],E[1]=C[Fe+1],E[2]=C[Fe+2],E[3]=C[Fe+3],xe(E,E,Te),C[Fe]=E[0],C[Fe+1]=E[1],C[Fe+2]=E[2],C[Fe+3]=E[3];return C}})();function Jv(){var E=new cs(2);return cs!=Float32Array&&(E[0]=0,E[1]=0),E}function Qv(E){var C=E[0],B=E[1];return C*C+B*B}var $v=Qv;(function(){var E=Jv();return function(C,B,J,he,xe,Te){var Fe,$e;for(B||(B=2),J||(J=0),he?$e=Math.min(he*B+J,C.length):$e=C.length,Fe=J;Fe<$e;Fe+=B)E[0]=C[Fe],E[1]=C[Fe+1],xe(E,E,Te),C[Fe]=E[0],C[Fe+1]=E[1];return C}})();var qv=function(E){function C(B){E.call(this,B,Zu)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(J){return new ji(J)},C.prototype.queryRadius=function(J){var he=J;return cl("circle-radius",this,he)+cl("circle-stroke-width",this,he)+tu(this.paint.get("circle-translate"))},C.prototype.queryIntersectsFeature=function(J,he,xe,Te,Fe,$e,ft,pt){for(var Ot=Vl(J,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),$e.angle,ft),rr=this.paint.get("circle-radius").evaluate(he,xe),qt=this.paint.get("circle-stroke-width").evaluate(he,xe),dr=rr+qt,Fr=this.paint.get("circle-pitch-alignment")==="map",an=Fr?Ot:ep(Ot,pt),$r=Fr?dr*ft:dr,kn=0,mn=Te;kn<mn.length;kn+=1)for(var Sn=mn[kn],In=0,Gn=Sn;In<Gn.length;In+=1){var oa=Gn[In],na=Fr?oa:Eh(oa,pt),Ra=$r,wa=kc([],[oa.x,oa.y,0,1],pt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ra*=wa[3]/$e.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ra*=$e.cameraToCenterDistance/wa[3]),wi(an,na,Ra))return!0}return!1},C}(xs);function Eh(E,C){var B=kc([],[E.x,E.y,0,1],C);return new h(B[0]/B[3],B[1]/B[3])}function ep(E,C){return E.map(function(B){return Eh(B,C)})}var Ch=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(ji);Oe("HeatmapBucket",Ch,{omit:["layers"]});function th(E,C,B,J){var he=C.width,xe=C.height;if(!J)J=new Uint8Array(he*xe*B);else if(J instanceof Uint8ClampedArray)J=new Uint8Array(J.buffer);else if(J.length!==he*xe*B)throw new RangeError("mismatched image size");return E.width=he,E.height=xe,E.data=J,E}function Lh(E,C,B){var J=C.width,he=C.height;if(!(J===E.width&&he===E.height)){var xe=th({},{width:J,height:he},B);rh(E,xe,{x:0,y:0},{x:0,y:0},{width:Math.min(E.width,J),height:Math.min(E.height,he)},B),E.width=J,E.height=he,E.data=xe.data}}function rh(E,C,B,J,he,xe){if(he.width===0||he.height===0)return C;if(he.width>E.width||he.height>E.height||B.x>E.width-he.width||B.y>E.height-he.height)throw new RangeError("out of range source coordinates for image copy");if(he.width>C.width||he.height>C.height||J.x>C.width-he.width||J.y>C.height-he.height)throw new RangeError("out of range destination coordinates for image copy");for(var Te=E.data,Fe=C.data,$e=0;$e<he.height;$e++)for(var ft=((B.y+$e)*E.width+B.x)*xe,pt=((J.y+$e)*C.width+J.x)*xe,Ot=0;Ot<he.width*xe;Ot++)Fe[pt+Ot]=Te[ft+Ot];return C}var _f=function(C,B){th(this,C,1,B)};_f.prototype.resize=function(C){Lh(this,C,1)},_f.prototype.clone=function(){return new _f({width:this.width,height:this.height},new Uint8Array(this.data))},_f.copy=function(C,B,J,he,xe){rh(C,B,J,he,xe,1)};var el=function(C,B){th(this,C,4,B)};el.prototype.resize=function(C){Lh(this,C,4)},el.prototype.replace=function(C,B){B?this.data.set(C):C instanceof Uint8ClampedArray?this.data=new Uint8Array(C.buffer):this.data=C},el.prototype.clone=function(){return new el({width:this.width,height:this.height},new Uint8Array(this.data))},el.copy=function(C,B,J,he,xe){rh(C,B,J,he,xe,4)},Oe("AlphaImage",_f),Oe("RGBAImage",el);var tp=new Xi({"heatmap-radius":new Za(Ht.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Za(Ht.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ia(Ht.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Do(Ht.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ia(Ht.paint_heatmap["heatmap-opacity"])}),rp={paint:tp};function Ph(E,C){for(var B=new Uint8Array(1024),J={},he=0,xe=0;he<256;he++,xe+=4){J[C]=he/255;var Te=E.evaluate(J);B[xe+0]=Math.floor(Te.r*255/Te.a),B[xe+1]=Math.floor(Te.g*255/Te.a),B[xe+2]=Math.floor(Te.b*255/Te.a),B[xe+3]=Math.floor(Te.a*255)}return new el({width:256,height:1},B)}var np=function(E){function C(B){E.call(this,B,rp),this._updateColorRamp()}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(J){return new Ch(J)},C.prototype._handleSpecialPaintPropertyUpdate=function(J){J==="heatmap-color"&&this._updateColorRamp()},C.prototype._updateColorRamp=function(){var J=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Ph(J,"heatmapDensity"),this.colorRampTexture=null},C.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},C.prototype.queryRadius=function(){return 0},C.prototype.queryIntersectsFeature=function(){return!1},C.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},C}(xs),ap=new Xi({"hillshade-illumination-direction":new Ia(Ht.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ia(Ht.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ia(Ht.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ia(Ht.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ia(Ht.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ia(Ht.paint_hillshade["hillshade-accent-color"])}),ip={paint:ap},op=function(E){function C(B){E.call(this,B,ip)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},C}(xs),sp=Ro([{name:"a_pos",components:2,type:"Int16"}],4),Dh=sp.members,nh=Ec,lp=Ec;function Ec(E,C,B){B=B||2;var J=C&&C.length,he=J?C[0]*B:E.length,xe=Rh(E,0,he,B,!0),Te=[];if(!xe||xe.next===xe.prev)return Te;var Fe,$e,ft,pt,Ot,rr,qt;if(J&&(xe=vp(E,C,xe,B)),E.length>80*B){Fe=ft=E[0],$e=pt=E[1];for(var dr=B;dr<he;dr+=B)Ot=E[dr],rr=E[dr+1],Ot<Fe&&(Fe=Ot),rr<$e&&($e=rr),Ot>ft&&(ft=Ot),rr>pt&&(pt=rr);qt=Math.max(ft-Fe,pt-$e),qt=qt!==0?1/qt:0}return oc(xe,Te,B,Fe,$e,qt),Te}function Rh(E,C,B,J,he){var xe,Te;if(he===oh(E,C,B,J)>0)for(xe=C;xe<B;xe+=J)Te=Fh(xe,E[xe],E[xe+1],Te);else for(xe=B-J;xe>=C;xe-=J)Te=Fh(xe,E[xe],E[xe+1],Te);return Te&&Cc(Te,Te.next)&&(lc(Te),Te=Te.next),Te}function sf(E,C){if(!E)return E;C||(C=E);var B=E,J;do if(J=!1,!B.steiner&&(Cc(B,B.next)||No(B.prev,B,B.next)===0)){if(lc(B),B=C=B.prev,B===B.next)break;J=!0}else B=B.next;while(J||B!==C);return C}function oc(E,C,B,J,he,xe,Te){if(E){!Te&&xe&&mp(E,J,he,xe);for(var Fe=E,$e,ft;E.prev!==E.next;){if($e=E.prev,ft=E.next,xe?fp(E,J,he,xe):up(E)){C.push($e.i/B),C.push(E.i/B),C.push(ft.i/B),lc(E),E=ft.next,Fe=ft.next;continue}if(E=ft,E===Fe){Te?Te===1?(E=cp(sf(E),C,B),oc(E,C,B,J,he,xe,2)):Te===2&&hp(E,C,B,J,he,xe):oc(sf(E),C,B,J,he,xe,1);break}}}}function up(E){var C=E.prev,B=E,J=E.next;if(No(C,B,J)>=0)return!1;for(var he=E.next.next;he!==E.prev;){if(zf(C.x,C.y,B.x,B.y,J.x,J.y,he.x,he.y)&&No(he.prev,he,he.next)>=0)return!1;he=he.next}return!0}function fp(E,C,B,J){var he=E.prev,xe=E,Te=E.next;if(No(he,xe,Te)>=0)return!1;for(var Fe=he.x<xe.x?he.x<Te.x?he.x:Te.x:xe.x<Te.x?xe.x:Te.x,$e=he.y<xe.y?he.y<Te.y?he.y:Te.y:xe.y<Te.y?xe.y:Te.y,ft=he.x>xe.x?he.x>Te.x?he.x:Te.x:xe.x>Te.x?xe.x:Te.x,pt=he.y>xe.y?he.y>Te.y?he.y:Te.y:xe.y>Te.y?xe.y:Te.y,Ot=ah(Fe,$e,C,B,J),rr=ah(ft,pt,C,B,J),qt=E.prevZ,dr=E.nextZ;qt&&qt.z>=Ot&&dr&&dr.z<=rr;){if(qt!==E.prev&&qt!==E.next&&zf(he.x,he.y,xe.x,xe.y,Te.x,Te.y,qt.x,qt.y)&&No(qt.prev,qt,qt.next)>=0||(qt=qt.prevZ,dr!==E.prev&&dr!==E.next&&zf(he.x,he.y,xe.x,xe.y,Te.x,Te.y,dr.x,dr.y)&&No(dr.prev,dr,dr.next)>=0))return!1;dr=dr.nextZ}for(;qt&&qt.z>=Ot;){if(qt!==E.prev&&qt!==E.next&&zf(he.x,he.y,xe.x,xe.y,Te.x,Te.y,qt.x,qt.y)&&No(qt.prev,qt,qt.next)>=0)return!1;qt=qt.prevZ}for(;dr&&dr.z<=rr;){if(dr!==E.prev&&dr!==E.next&&zf(he.x,he.y,xe.x,xe.y,Te.x,Te.y,dr.x,dr.y)&&No(dr.prev,dr,dr.next)>=0)return!1;dr=dr.nextZ}return!0}function cp(E,C,B){var J=E;do{var he=J.prev,xe=J.next.next;!Cc(he,xe)&&Ih(he,J,J.next,xe)&&sc(he,xe)&&sc(xe,he)&&(C.push(he.i/B),C.push(J.i/B),C.push(xe.i/B),lc(J),lc(J.next),J=E=xe),J=J.next}while(J!==E);return sf(J)}function hp(E,C,B,J,he,xe){var Te=E;do{for(var Fe=Te.next.next;Fe!==Te.prev;){if(Te.i!==Fe.i&&_p(Te,Fe)){var $e=zh(Te,Fe);Te=sf(Te,Te.next),$e=sf($e,$e.next),oc(Te,C,B,J,he,xe),oc($e,C,B,J,he,xe);return}Fe=Fe.next}Te=Te.next}while(Te!==E)}function vp(E,C,B,J){var he=[],xe,Te,Fe,$e,ft;for(xe=0,Te=C.length;xe<Te;xe++)Fe=C[xe]*J,$e=xe<Te-1?C[xe+1]*J:E.length,ft=Rh(E,Fe,$e,J,!1),ft===ft.next&&(ft.steiner=!0),he.push(bp(ft));for(he.sort(pp),xe=0;xe<he.length;xe++)dp(he[xe],B),B=sf(B,B.next);return B}function pp(E,C){return E.x-C.x}function dp(E,C){if(C=gp(E,C),C){var B=zh(C,E);sf(C,C.next),sf(B,B.next)}}function gp(E,C){var B=C,J=E.x,he=E.y,xe=-1/0,Te;do{if(he<=B.y&&he>=B.next.y&&B.next.y!==B.y){var Fe=B.x+(he-B.y)*(B.next.x-B.x)/(B.next.y-B.y);if(Fe<=J&&Fe>xe){if(xe=Fe,Fe===J){if(he===B.y)return B;if(he===B.next.y)return B.next}Te=B.x<B.next.x?B:B.next}}B=B.next}while(B!==C);if(!Te)return null;if(J===xe)return Te;var $e=Te,ft=Te.x,pt=Te.y,Ot=1/0,rr;B=Te;do J>=B.x&&B.x>=ft&&J!==B.x&&zf(he<pt?J:xe,he,ft,pt,he<pt?xe:J,he,B.x,B.y)&&(rr=Math.abs(he-B.y)/(J-B.x),sc(B,E)&&(rr<Ot||rr===Ot&&(B.x>Te.x||B.x===Te.x&&yp(Te,B)))&&(Te=B,Ot=rr)),B=B.next;while(B!==$e);return Te}function yp(E,C){return No(E.prev,E,C.prev)<0&&No(C.next,E,E.next)<0}function mp(E,C,B,J){var he=E;do he.z===null&&(he.z=ah(he.x,he.y,C,B,J)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==E);he.prevZ.nextZ=null,he.prevZ=null,xp(he)}function xp(E){var C,B,J,he,xe,Te,Fe,$e,ft=1;do{for(B=E,E=null,xe=null,Te=0;B;){for(Te++,J=B,Fe=0,C=0;C<ft&&(Fe++,J=J.nextZ,!!J);C++);for($e=ft;Fe>0||$e>0&&J;)Fe!==0&&($e===0||!J||B.z<=J.z)?(he=B,B=B.nextZ,Fe--):(he=J,J=J.nextZ,$e--),xe?xe.nextZ=he:E=he,he.prevZ=xe,xe=he;B=J}xe.nextZ=null,ft*=2}while(Te>1);return E}function ah(E,C,B,J,he){return E=32767*(E-B)*he,C=32767*(C-J)*he,E=(E|E<<8)&16711935,E=(E|E<<4)&252645135,E=(E|E<<2)&858993459,E=(E|E<<1)&1431655765,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,E|C<<1}function bp(E){var C=E,B=E;do(C.x<B.x||C.x===B.x&&C.y<B.y)&&(B=C),C=C.next;while(C!==E);return B}function zf(E,C,B,J,he,xe,Te,Fe){return(he-Te)*(C-Fe)-(E-Te)*(xe-Fe)>=0&&(E-Te)*(J-Fe)-(B-Te)*(C-Fe)>=0&&(B-Te)*(xe-Fe)-(he-Te)*(J-Fe)>=0}function _p(E,C){return E.next.i!==C.i&&E.prev.i!==C.i&&!wp(E,C)&&(sc(E,C)&&sc(C,E)&&Tp(E,C)&&(No(E.prev,E,C.prev)||No(E,C.prev,C))||Cc(E,C)&&No(E.prev,E,E.next)>0&&No(C.prev,C,C.next)>0)}function No(E,C,B){return(C.y-E.y)*(B.x-C.x)-(C.x-E.x)*(B.y-C.y)}function Cc(E,C){return E.x===C.x&&E.y===C.y}function Ih(E,C,B,J){var he=Pc(No(E,C,B)),xe=Pc(No(E,C,J)),Te=Pc(No(B,J,E)),Fe=Pc(No(B,J,C));return!!(he!==xe&&Te!==Fe||he===0&&Lc(E,B,C)||xe===0&&Lc(E,J,C)||Te===0&&Lc(B,E,J)||Fe===0&&Lc(B,C,J))}function Lc(E,C,B){return C.x<=Math.max(E.x,B.x)&&C.x>=Math.min(E.x,B.x)&&C.y<=Math.max(E.y,B.y)&&C.y>=Math.min(E.y,B.y)}function Pc(E){return E>0?1:E<0?-1:0}function wp(E,C){var B=E;do{if(B.i!==E.i&&B.next.i!==E.i&&B.i!==C.i&&B.next.i!==C.i&&Ih(B,B.next,E,C))return!0;B=B.next}while(B!==E);return!1}function sc(E,C){return No(E.prev,E,E.next)<0?No(E,C,E.next)>=0&&No(E,E.prev,C)>=0:No(E,C,E.prev)<0||No(E,E.next,C)<0}function Tp(E,C){var B=E,J=!1,he=(E.x+C.x)/2,xe=(E.y+C.y)/2;do B.y>xe!=B.next.y>xe&&B.next.y!==B.y&&he<(B.next.x-B.x)*(xe-B.y)/(B.next.y-B.y)+B.x&&(J=!J),B=B.next;while(B!==E);return J}function zh(E,C){var B=new ih(E.i,E.x,E.y),J=new ih(C.i,C.x,C.y),he=E.next,xe=C.prev;return E.next=C,C.prev=E,B.next=he,he.prev=B,J.next=B,B.prev=J,xe.next=J,J.prev=xe,J}function Fh(E,C,B,J){var he=new ih(E,C,B);return J?(he.next=J.next,he.prev=J,J.next.prev=he,J.next=he):(he.prev=he,he.next=he),he}function lc(E){E.next.prev=E.prev,E.prev.next=E.next,E.prevZ&&(E.prevZ.nextZ=E.nextZ),E.nextZ&&(E.nextZ.prevZ=E.prevZ)}function ih(E,C,B){this.i=E,this.x=C,this.y=B,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ec.deviation=function(E,C,B,J){var he=C&&C.length,xe=he?C[0]*B:E.length,Te=Math.abs(oh(E,0,xe,B));if(he)for(var Fe=0,$e=C.length;Fe<$e;Fe++){var ft=C[Fe]*B,pt=Fe<$e-1?C[Fe+1]*B:E.length;Te-=Math.abs(oh(E,ft,pt,B))}var Ot=0;for(Fe=0;Fe<J.length;Fe+=3){var rr=J[Fe]*B,qt=J[Fe+1]*B,dr=J[Fe+2]*B;Ot+=Math.abs((E[rr]-E[dr])*(E[qt+1]-E[rr+1])-(E[rr]-E[qt])*(E[dr+1]-E[rr+1]))}return Te===0&&Ot===0?0:Math.abs((Ot-Te)/Te)};function oh(E,C,B,J){for(var he=0,xe=C,Te=B-J;xe<B;xe+=J)he+=(E[Te]-E[xe])*(E[xe+1]+E[Te+1]),Te=xe;return he}Ec.flatten=function(E){for(var C=E[0][0].length,B={vertices:[],holes:[],dimensions:C},J=0,he=0;he<E.length;he++){for(var xe=0;xe<E[he].length;xe++)for(var Te=0;Te<C;Te++)B.vertices.push(E[he][xe][Te]);he>0&&(J+=E[he-1].length,B.holes.push(J))}return B},nh.default=lp;function Ap(E,C,B,J,he){Oh(E,C,B||0,J||E.length-1,he||Mp)}function Oh(E,C,B,J,he){for(;J>B;){if(J-B>600){var xe=J-B+1,Te=C-B+1,Fe=Math.log(xe),$e=.5*Math.exp(2*Fe/3),ft=.5*Math.sqrt(Fe*$e*(xe-$e)/xe)*(Te-xe/2<0?-1:1),pt=Math.max(B,Math.floor(C-Te*$e/xe+ft)),Ot=Math.min(J,Math.floor(C+(xe-Te)*$e/xe+ft));Oh(E,C,pt,Ot,he)}var rr=E[C],qt=B,dr=J;for(uc(E,B,C),he(E[J],rr)>0&&uc(E,B,J);qt<dr;){for(uc(E,qt,dr),qt++,dr--;he(E[qt],rr)<0;)qt++;for(;he(E[dr],rr)>0;)dr--}he(E[B],rr)===0?uc(E,B,dr):(dr++,uc(E,dr,J)),dr<=C&&(B=dr+1),C<=dr&&(J=dr-1)}}function uc(E,C,B){var J=E[C];E[C]=E[B],E[B]=J}function Mp(E,C){return E<C?-1:E>C?1:0}function sh(E,C){var B=E.length;if(B<=1)return[E];for(var J=[],he,xe,Te=0;Te<B;Te++){var Fe=N(E[Te]);Fe!==0&&(E[Te].area=Math.abs(Fe),xe===void 0&&(xe=Fe<0),xe===Fe<0?(he&&J.push(he),he=[E[Te]]):he.push(E[Te]))}if(he&&J.push(he),C>1)for(var $e=0;$e<J.length;$e++)J[$e].length<=C||(Ap(J[$e],C,1,J[$e].length-1,Sp),J[$e]=J[$e].slice(0,C));return J}function Sp(E,C){return C.area-E.area}function lh(E,C,B){for(var J=B.patternDependencies,he=!1,xe=0,Te=C;xe<Te.length;xe+=1){var Fe=Te[xe],$e=Fe.paint.get(E+"-pattern");$e.isConstant()||(he=!0);var ft=$e.constantOr(null);ft&&(he=!0,J[ft.to]=!0,J[ft.from]=!0)}return he}function uh(E,C,B,J,he){for(var xe=he.patternDependencies,Te=0,Fe=C;Te<Fe.length;Te+=1){var $e=Fe[Te],ft=$e.paint.get(E+"-pattern"),pt=ft.value;if(pt.kind!=="constant"){var Ot=pt.evaluate({zoom:J-1},B,{},he.availableImages),rr=pt.evaluate({zoom:J},B,{},he.availableImages),qt=pt.evaluate({zoom:J+1},B,{},he.availableImages);Ot=Ot&&Ot.name?Ot.name:Ot,rr=rr&&rr.name?rr.name:rr,qt=qt&&qt.name?qt.name:qt,xe[Ot]=!0,xe[rr]=!0,xe[qt]=!0,B.patterns[$e.id]={min:Ot,mid:rr,max:qt}}}return B}var kp=500,wu=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=C.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pf,this.indexArray=new bu,this.indexArray2=new yf,this.programConfigurations=new ni(Dh,C.layers,C.zoom),this.segments=new V,this.segments2=new V,this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id})};wu.prototype.populate=function(C,B,J){this.hasPattern=lh("fill",this.layers,B);for(var he=this.layers[0].layout.get("fill-sort-key"),xe=[],Te=0,Fe=C;Te<Fe.length;Te+=1){var $e=Fe[Te],ft=$e.feature,pt=$e.id,Ot=$e.index,rr=$e.sourceLayerIndex,qt=this.layers[0]._featureFilter.needGeometry,dr={type:ft.type,id:pt,properties:ft.properties,geometry:qt?Ni(ft):[]};if(this.layers[0]._featureFilter.filter(new si(this.zoom),dr,J)){qt||(dr.geometry=Ni(ft));var Fr=he?he.evaluate(dr,{},J,B.availableImages):void 0,an={id:pt,properties:ft.properties,type:ft.type,sourceLayerIndex:rr,index:Ot,geometry:dr.geometry,patterns:{},sortKey:Fr};xe.push(an)}}he&&xe.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var $r=0,kn=xe;$r<kn.length;$r+=1){var mn=kn[$r],Sn=mn,In=Sn.geometry,Gn=Sn.index,oa=Sn.sourceLayerIndex;if(this.hasPattern){var na=uh("fill",this.layers,mn,this.zoom,B);this.patternFeatures.push(na)}else this.addFeature(mn,In,Gn,J,{});var Ra=C[Gn].feature;B.featureIndex.insert(Ra,In,Gn,oa,this.index)}},wu.prototype.update=function(C,B,J){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(C,B,this.stateDependentLayers,J)},wu.prototype.addFeatures=function(C,B,J){for(var he=0,xe=this.patternFeatures;he<xe.length;he+=1){var Te=xe[he];this.addFeature(Te,Te.geometry,Te.index,B,J)}},wu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},wu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wu.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Dh),this.indexBuffer=C.createIndexBuffer(this.indexArray),this.indexBuffer2=C.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(C),this.uploaded=!0},wu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},wu.prototype.addFeature=function(C,B,J,he,xe){for(var Te=0,Fe=sh(B,kp);Te<Fe.length;Te+=1){for(var $e=Fe[Te],ft=0,pt=0,Ot=$e;pt<Ot.length;pt+=1){var rr=Ot[pt];ft+=rr.length}for(var qt=this.segments.prepareSegment(ft,this.layoutVertexArray,this.indexArray),dr=qt.vertexLength,Fr=[],an=[],$r=0,kn=$e;$r<kn.length;$r+=1){var mn=kn[$r];if(mn.length!==0){mn!==$e[0]&&an.push(Fr.length/2);var Sn=this.segments2.prepareSegment(mn.length,this.layoutVertexArray,this.indexArray2),In=Sn.vertexLength;this.layoutVertexArray.emplaceBack(mn[0].x,mn[0].y),this.indexArray2.emplaceBack(In+mn.length-1,In),Fr.push(mn[0].x),Fr.push(mn[0].y);for(var Gn=1;Gn<mn.length;Gn++)this.layoutVertexArray.emplaceBack(mn[Gn].x,mn[Gn].y),this.indexArray2.emplaceBack(In+Gn-1,In+Gn),Fr.push(mn[Gn].x),Fr.push(mn[Gn].y);Sn.vertexLength+=mn.length,Sn.primitiveLength+=mn.length}}for(var oa=nh(Fr,an),na=0;na<oa.length;na+=3)this.indexArray.emplaceBack(dr+oa[na],dr+oa[na+1],dr+oa[na+2]);qt.vertexLength+=ft,qt.primitiveLength+=oa.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,J,xe,he)},Oe("FillBucket",wu,{omit:["layers","patternFeatures"]});var Ep=new Xi({"fill-sort-key":new Za(Ht.layout_fill["fill-sort-key"])}),Cp=new Xi({"fill-antialias":new Ia(Ht.paint_fill["fill-antialias"]),"fill-opacity":new Za(Ht.paint_fill["fill-opacity"]),"fill-color":new Za(Ht.paint_fill["fill-color"]),"fill-outline-color":new Za(Ht.paint_fill["fill-outline-color"]),"fill-translate":new Ia(Ht.paint_fill["fill-translate"]),"fill-translate-anchor":new Ia(Ht.paint_fill["fill-translate-anchor"]),"fill-pattern":new bo(Ht.paint_fill["fill-pattern"])}),Lp={paint:Cp,layout:Ep},Pp=function(E){function C(B){E.call(this,B,Lp)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.recalculate=function(J,he){E.prototype.recalculate.call(this,J,he);var xe=this.paint._values["fill-outline-color"];xe.value.kind==="constant"&&xe.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},C.prototype.createBucket=function(J){return new wu(J)},C.prototype.queryRadius=function(){return tu(this.paint.get("fill-translate"))},C.prototype.queryIntersectsFeature=function(J,he,xe,Te,Fe,$e,ft){var pt=Vl(J,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),$e.angle,ft);return wo(pt,Te)},C.prototype.isTileClipped=function(){return!0},C}(xs),Dp=Ro([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Bh=Dp.members,Nh=Ff;function Ff(E,C,B,J,he){this.properties={},this.extent=B,this.type=0,this._pbf=E,this._geometry=-1,this._keys=J,this._values=he,E.readFields(Rp,this,C)}function Rp(E,C,B){E==1?C.id=B.readVarint():E==2?Ip(B,C):E==3?C.type=B.readVarint():E==4&&(C._geometry=B.pos)}function Ip(E,C){for(var B=E.readVarint()+E.pos;E.pos<B;){var J=C._keys[E.readVarint()],he=C._values[E.readVarint()];C.properties[J]=he}}Ff.types=["Unknown","Point","LineString","Polygon"],Ff.prototype.loadGeometry=function(){var E=this._pbf;E.pos=this._geometry;for(var C=E.readVarint()+E.pos,B=1,J=0,he=0,xe=0,Te=[],Fe;E.pos<C;){if(J<=0){var $e=E.readVarint();B=$e&7,J=$e>>3}if(J--,B===1||B===2)he+=E.readSVarint(),xe+=E.readSVarint(),B===1&&(Fe&&Te.push(Fe),Fe=[]),Fe.push(new h(he,xe));else if(B===7)Fe&&Fe.push(Fe[0].clone());else throw new Error("unknown command "+B)}return Fe&&Te.push(Fe),Te},Ff.prototype.bbox=function(){var E=this._pbf;E.pos=this._geometry;for(var C=E.readVarint()+E.pos,B=1,J=0,he=0,xe=0,Te=1/0,Fe=-1/0,$e=1/0,ft=-1/0;E.pos<C;){if(J<=0){var pt=E.readVarint();B=pt&7,J=pt>>3}if(J--,B===1||B===2)he+=E.readSVarint(),xe+=E.readSVarint(),he<Te&&(Te=he),he>Fe&&(Fe=he),xe<$e&&($e=xe),xe>ft&&(ft=xe);else if(B!==7)throw new Error("unknown command "+B)}return[Te,$e,Fe,ft]},Ff.prototype.toGeoJSON=function(E,C,B){var J=this.extent*Math.pow(2,B),he=this.extent*E,xe=this.extent*C,Te=this.loadGeometry(),Fe=Ff.types[this.type],$e,ft;function pt(qt){for(var dr=0;dr<qt.length;dr++){var Fr=qt[dr],an=180-(Fr.y+xe)*360/J;qt[dr]=[(Fr.x+he)*360/J-180,360/Math.PI*Math.atan(Math.exp(an*Math.PI/180))-90]}}switch(this.type){case 1:var Ot=[];for($e=0;$e<Te.length;$e++)Ot[$e]=Te[$e][0];Te=Ot,pt(Te);break;case 2:for($e=0;$e<Te.length;$e++)pt(Te[$e]);break;case 3:for(Te=zp(Te),$e=0;$e<Te.length;$e++)for(ft=0;ft<Te[$e].length;ft++)pt(Te[$e][ft]);break}Te.length===1?Te=Te[0]:Fe="Multi"+Fe;var rr={type:"Feature",geometry:{type:Fe,coordinates:Te},properties:this.properties};return"id"in this&&(rr.id=this.id),rr};function zp(E){var C=E.length;if(C<=1)return[E];for(var B=[],J,he,xe=0;xe<C;xe++){var Te=Fp(E[xe]);Te!==0&&(he===void 0&&(he=Te<0),he===Te<0?(J&&B.push(J),J=[E[xe]]):J.push(E[xe]))}return J&&B.push(J),B}function Fp(E){for(var C=0,B=0,J=E.length,he=J-1,xe,Te;B<J;he=B++)xe=E[B],Te=E[he],C+=(Te.x-xe.x)*(xe.y+Te.y);return C}var Uh=Hh;function Hh(E,C){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=E,this._keys=[],this._values=[],this._features=[],E.readFields(Op,this,C),this.length=this._features.length}function Op(E,C,B){E===15?C.version=B.readVarint():E===1?C.name=B.readString():E===5?C.extent=B.readVarint():E===2?C._features.push(B.pos):E===3?C._keys.push(B.readString()):E===4&&C._values.push(Bp(B))}function Bp(E){for(var C=null,B=E.readVarint()+E.pos;E.pos<B;){var J=E.readVarint()>>3;C=J===1?E.readString():J===2?E.readFloat():J===3?E.readDouble():J===4?E.readVarint64():J===5?E.readVarint():J===6?E.readSVarint():J===7?E.readBoolean():null}return C}Hh.prototype.feature=function(E){if(E<0||E>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[E];var C=this._pbf.readVarint()+this._pbf.pos;return new Nh(this._pbf,C,this.extent,this._keys,this._values)};var Np=Up;function Up(E,C){this.layers=E.readFields(Hp,{},C)}function Hp(E,C,B){if(E===3){var J=new Uh(B,B.readVarint()+B.pos);J.length&&(C[J.name]=J)}}var Vp=Np,Gp=Nh,Yp=Uh,Of={VectorTile:Vp,VectorTileFeature:Gp,VectorTileLayer:Yp},Wp=Of.VectorTileFeature.types,Xp=500,fh=Math.pow(2,13);function fc(E,C,B,J,he,xe,Te,Fe){E.emplaceBack(C,B,Math.floor(J*fh)*2+Te,he*fh*2,xe*fh*2,Math.round(Fe))}var Tu=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=C.index,this.hasPattern=!1,this.layoutVertexArray=new ef,this.indexArray=new bu,this.programConfigurations=new ni(Bh,C.layers,C.zoom),this.segments=new V,this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id})};Tu.prototype.populate=function(C,B,J){this.features=[],this.hasPattern=lh("fill-extrusion",this.layers,B);for(var he=0,xe=C;he<xe.length;he+=1){var Te=xe[he],Fe=Te.feature,$e=Te.id,ft=Te.index,pt=Te.sourceLayerIndex,Ot=this.layers[0]._featureFilter.needGeometry,rr={type:Fe.type,id:$e,properties:Fe.properties,geometry:Ot?Ni(Fe):[]};if(this.layers[0]._featureFilter.filter(new si(this.zoom),rr,J)){var qt={id:$e,sourceLayerIndex:pt,index:ft,geometry:Ot?rr.geometry:Ni(Fe),properties:Fe.properties,type:Fe.type,patterns:{}};typeof Fe.id<"u"&&(qt.id=Fe.id),this.hasPattern?this.features.push(uh("fill-extrusion",this.layers,qt,this.zoom,B)):this.addFeature(qt,qt.geometry,ft,J,{}),B.featureIndex.insert(Fe,qt.geometry,ft,pt,this.index,!0)}}},Tu.prototype.addFeatures=function(C,B,J){for(var he=0,xe=this.features;he<xe.length;he+=1){var Te=xe[he],Fe=Te.geometry;this.addFeature(Te,Fe,Te.index,B,J)}},Tu.prototype.update=function(C,B,J){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(C,B,this.stateDependentLayers,J)},Tu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Tu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Tu.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Bh),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},Tu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Tu.prototype.addFeature=function(C,B,J,he,xe){for(var Te=0,Fe=sh(B,Xp);Te<Fe.length;Te+=1){for(var $e=Fe[Te],ft=0,pt=0,Ot=$e;pt<Ot.length;pt+=1){var rr=Ot[pt];ft+=rr.length}for(var qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),dr=0,Fr=$e;dr<Fr.length;dr+=1){var an=Fr[dr];if(an.length!==0&&!jp(an))for(var $r=0,kn=0;kn<an.length;kn++){var mn=an[kn];if(kn>=1){var Sn=an[kn-1];if(!Zp(mn,Sn)){qt.vertexLength+4>V.MAX_VERTEX_ARRAY_LENGTH&&(qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var In=mn.sub(Sn)._perp()._unit(),Gn=Sn.dist(mn);$r+Gn>32768&&($r=0),fc(this.layoutVertexArray,mn.x,mn.y,In.x,In.y,0,0,$r),fc(this.layoutVertexArray,mn.x,mn.y,In.x,In.y,0,1,$r),$r+=Gn,fc(this.layoutVertexArray,Sn.x,Sn.y,In.x,In.y,0,0,$r),fc(this.layoutVertexArray,Sn.x,Sn.y,In.x,In.y,0,1,$r);var oa=qt.vertexLength;this.indexArray.emplaceBack(oa,oa+2,oa+1),this.indexArray.emplaceBack(oa+1,oa+2,oa+3),qt.vertexLength+=4,qt.primitiveLength+=2}}}}if(qt.vertexLength+ft>V.MAX_VERTEX_ARRAY_LENGTH&&(qt=this.segments.prepareSegment(ft,this.layoutVertexArray,this.indexArray)),Wp[C.type]==="Polygon"){for(var na=[],Ra=[],wa=qt.vertexLength,Sa=0,ti=$e;Sa<ti.length;Sa+=1){var La=ti[Sa];if(La.length!==0){La!==$e[0]&&Ra.push(na.length/2);for(var Da=0;Da<La.length;Da++){var fi=La[Da];fc(this.layoutVertexArray,fi.x,fi.y,0,0,1,1,0),na.push(fi.x),na.push(fi.y)}}}for(var qa=nh(na,Ra),ki=0;ki<qa.length;ki+=3)this.indexArray.emplaceBack(wa+qa[ki],wa+qa[ki+2],wa+qa[ki+1]);qt.primitiveLength+=qa.length/3,qt.vertexLength+=ft}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,J,xe,he)},Oe("FillExtrusionBucket",Tu,{omit:["layers","features"]});function Zp(E,C){return E.x===C.x&&(E.x<0||E.x>Ba)||E.y===C.y&&(E.y<0||E.y>Ba)}function jp(E){return E.every(function(C){return C.x<0})||E.every(function(C){return C.x>Ba})||E.every(function(C){return C.y<0})||E.every(function(C){return C.y>Ba})}var Kp=new Xi({"fill-extrusion-opacity":new Ia(Ht["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Za(Ht["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ia(Ht["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ia(Ht["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new bo(Ht["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Za(Ht["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Za(Ht["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ia(Ht["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),Jp={paint:Kp},Qp=function(E){function C(B){E.call(this,B,Jp)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function(J){return new Tu(J)},C.prototype.queryRadius=function(){return tu(this.paint.get("fill-extrusion-translate"))},C.prototype.is3D=function(){return!0},C.prototype.queryIntersectsFeature=function(J,he,xe,Te,Fe,$e,ft,pt){var Ot=Vl(J,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),$e.angle,ft),rr=this.paint.get("fill-extrusion-height").evaluate(he,xe),qt=this.paint.get("fill-extrusion-base").evaluate(he,xe),dr=ed(Ot,pt,$e,0),Fr=qp(Te,qt,rr,pt),an=Fr[0],$r=Fr[1];return $p(an,$r,dr)},C}(xs);function cc(E,C){return E.x*C.x+E.y*C.y}function Vh(E,C){if(E.length===1){for(var B=0,J=C[B++],he;!he||J.equals(he);)if(he=C[B++],!he)return 1/0;for(;B<C.length;B++){var xe=C[B],Te=E[0],Fe=he.sub(J),$e=xe.sub(J),ft=Te.sub(J),pt=cc(Fe,Fe),Ot=cc(Fe,$e),rr=cc($e,$e),qt=cc(ft,Fe),dr=cc(ft,$e),Fr=pt*rr-Ot*Ot,an=(rr*qt-Ot*dr)/Fr,$r=(pt*dr-Ot*qt)/Fr,kn=1-an-$r,mn=J.z*kn+he.z*an+xe.z*$r;if(isFinite(mn))return mn}return 1/0}else{for(var Sn=1/0,In=0,Gn=C;In<Gn.length;In+=1){var oa=Gn[In];Sn=Math.min(Sn,oa.z)}return Sn}}function $p(E,C,B){var J=1/0;wo(B,C)&&(J=Vh(B,C[0]));for(var he=0;he<C.length;he++)for(var xe=C[he],Te=E[he],Fe=0;Fe<xe.length-1;Fe++){var $e=xe[Fe],ft=xe[Fe+1],pt=Te[Fe],Ot=Te[Fe+1],rr=[$e,ft,Ot,pt,$e];ii(B,rr)&&(J=Math.min(J,Vh(B,rr)))}return J===1/0?!1:J}function qp(E,C,B,J){for(var he=[],xe=[],Te=J[8]*C,Fe=J[9]*C,$e=J[10]*C,ft=J[11]*C,pt=J[8]*B,Ot=J[9]*B,rr=J[10]*B,qt=J[11]*B,dr=0,Fr=E;dr<Fr.length;dr+=1){for(var an=Fr[dr],$r=[],kn=[],mn=0,Sn=an;mn<Sn.length;mn+=1){var In=Sn[mn],Gn=In.x,oa=In.y,na=J[0]*Gn+J[4]*oa+J[12],Ra=J[1]*Gn+J[5]*oa+J[13],wa=J[2]*Gn+J[6]*oa+J[14],Sa=J[3]*Gn+J[7]*oa+J[15],ti=na+Te,La=Ra+Fe,Da=wa+$e,fi=Sa+ft,qa=na+pt,ki=Ra+Ot,Wi=wa+rr,Ei=Sa+qt,Ci=new h(ti/fi,La/fi);Ci.z=Da/fi,$r.push(Ci);var Ti=new h(qa/Ei,ki/Ei);Ti.z=Wi/Ei,kn.push(Ti)}he.push($r),xe.push(kn)}return[he,xe]}function ed(E,C,B,J){for(var he=[],xe=0,Te=E;xe<Te.length;xe+=1){var Fe=Te[xe],$e=[Fe.x,Fe.y,J,1];kc($e,$e,C),he.push(new h($e[0]/$e[3],$e[1]/$e[3]))}return he}var td=Ro([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),Gh=td.members,rd=Of.VectorTileFeature.types,Yh=63,nd=Math.cos(75/2*(Math.PI/180)),ad=15,id=20,od=15,Wh=1/2,Xh=Math.pow(2,od-1)/Wh,tl=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(B){return B.id}),this.index=C.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Sf,this.indexArray=new bu,this.programConfigurations=new ni(Gh,C.layers,C.zoom),this.segments=new V,this.stateDependentLayerIds=this.layers.filter(function(B){return B.isStateDependent()}).map(function(B){return B.id})};tl.prototype.populate=function(C,B,J){this.hasPattern=lh("line",this.layers,B);for(var he=this.layers[0].layout.get("line-sort-key"),xe=[],Te=0,Fe=C;Te<Fe.length;Te+=1){var $e=Fe[Te],ft=$e.feature,pt=$e.id,Ot=$e.index,rr=$e.sourceLayerIndex,qt=this.layers[0]._featureFilter.needGeometry,dr={type:ft.type,id:pt,properties:ft.properties,geometry:qt?Ni(ft):[]};if(this.layers[0]._featureFilter.filter(new si(this.zoom),dr,J)){qt||(dr.geometry=Ni(ft));var Fr=he?he.evaluate(dr,{},J):void 0,an={id:pt,properties:ft.properties,type:ft.type,sourceLayerIndex:rr,index:Ot,geometry:dr.geometry,patterns:{},sortKey:Fr};xe.push(an)}}he&&xe.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var $r=0,kn=xe;$r<kn.length;$r+=1){var mn=kn[$r],Sn=mn,In=Sn.geometry,Gn=Sn.index,oa=Sn.sourceLayerIndex;if(this.hasPattern){var na=uh("line",this.layers,mn,this.zoom,B);this.patternFeatures.push(na)}else this.addFeature(mn,In,Gn,J,{});var Ra=C[Gn].feature;B.featureIndex.insert(Ra,In,Gn,oa,this.index)}},tl.prototype.update=function(C,B,J){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(C,B,this.stateDependentLayers,J)},tl.prototype.addFeatures=function(C,B,J){for(var he=0,xe=this.patternFeatures;he<xe.length;he+=1){var Te=xe[he];this.addFeature(Te,Te.geometry,Te.index,B,J)}},tl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},tl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},tl.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Gh),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},tl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},tl.prototype.addFeature=function(C,B,J,he,xe){for(var Te=this.layers[0].layout,Fe=Te.get("line-join").evaluate(C,{}),$e=Te.get("line-cap"),ft=Te.get("line-miter-limit"),pt=Te.get("line-round-limit"),Ot=0,rr=B;Ot<rr.length;Ot+=1){var qt=rr[Ot];this.addLine(qt,C,Fe,$e,ft,pt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,J,xe,he)},tl.prototype.addLine=function(C,B,J,he,xe,Te){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,B.properties&&B.properties.hasOwnProperty("mapbox_clip_start")&&B.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+B.properties.mapbox_clip_start,this.clipEnd=+B.properties.mapbox_clip_end;for(var Fe=0;Fe<C.length-1;Fe++)this.totalDistance+=C[Fe].dist(C[Fe+1]);this.updateScaledDistance()}for(var $e=rd[B.type]==="Polygon",ft=C.length;ft>=2&&C[ft-1].equals(C[ft-2]);)ft--;for(var pt=0;pt<ft-1&&C[pt].equals(C[pt+1]);)pt++;if(!(ft<($e?3:2))){J==="bevel"&&(xe=1.05);var Ot=this.overscaling<=16?ad*Ba/(512*this.overscaling):0,rr=this.segments.prepareSegment(ft*10,this.layoutVertexArray,this.indexArray),qt,dr=void 0,Fr=void 0,an=void 0,$r=void 0;this.e1=this.e2=-1,$e&&(qt=C[ft-2],$r=C[pt].sub(qt)._unit()._perp());for(var kn=pt;kn<ft;kn++)if(Fr=kn===ft-1?$e?C[pt+1]:void 0:C[kn+1],!(Fr&&C[kn].equals(Fr))){$r&&(an=$r),qt&&(dr=qt),qt=C[kn],$r=Fr?Fr.sub(qt)._unit()._perp():an,an=an||$r;var mn=an.add($r);(mn.x!==0||mn.y!==0)&&mn._unit();var Sn=an.x*$r.x+an.y*$r.y,In=mn.x*$r.x+mn.y*$r.y,Gn=In!==0?1/In:1/0,oa=2*Math.sqrt(2-2*In),na=In<nd&&dr&&Fr,Ra=an.x*$r.y-an.y*$r.x>0;if(na&&kn>pt){var wa=qt.dist(dr);if(wa>2*Ot){var Sa=qt.sub(qt.sub(dr)._mult(Ot/wa)._round());this.updateDistance(dr,Sa),this.addCurrentVertex(Sa,an,0,0,rr),dr=Sa}}var ti=dr&&Fr,La=ti?J:$e?"butt":he;if(ti&&La==="round"&&(Gn<Te?La="miter":Gn<=2&&(La="fakeround")),La==="miter"&&Gn>xe&&(La="bevel"),La==="bevel"&&(Gn>2&&(La="flipbevel"),Gn<xe&&(La="miter")),dr&&this.updateDistance(dr,qt),La==="miter")mn._mult(Gn),this.addCurrentVertex(qt,mn,0,0,rr);else if(La==="flipbevel"){if(Gn>100)mn=$r.mult(-1);else{var Da=Gn*an.add($r).mag()/an.sub($r).mag();mn._perp()._mult(Da*(Ra?-1:1))}this.addCurrentVertex(qt,mn,0,0,rr),this.addCurrentVertex(qt,mn.mult(-1),0,0,rr)}else if(La==="bevel"||La==="fakeround"){var fi=-Math.sqrt(Gn*Gn-1),qa=Ra?fi:0,ki=Ra?0:fi;if(dr&&this.addCurrentVertex(qt,an,qa,ki,rr),La==="fakeround")for(var Wi=Math.round(oa*180/Math.PI/id),Ei=1;Ei<Wi;Ei++){var Ci=Ei/Wi;if(Ci!==.5){var Ti=Ci-.5,$i=1.0904+Sn*(-3.2452+Sn*(3.55645-Sn*1.43519)),ro=.848013+Sn*(-1.06021+Sn*.215638);Ci=Ci+Ci*Ti*(Ci-1)*($i*Ti*Ti+ro)}var To=$r.sub(an)._mult(Ci)._add(an)._unit()._mult(Ra?-1:1);this.addHalfVertex(qt,To.x,To.y,!1,Ra,0,rr)}Fr&&this.addCurrentVertex(qt,$r,-qa,-ki,rr)}else if(La==="butt")this.addCurrentVertex(qt,mn,0,0,rr);else if(La==="square"){var Lo=dr?1:-1;this.addCurrentVertex(qt,mn,Lo,Lo,rr)}else La==="round"&&(dr&&(this.addCurrentVertex(qt,an,0,0,rr),this.addCurrentVertex(qt,an,1,1,rr,!0)),Fr&&(this.addCurrentVertex(qt,$r,-1,-1,rr,!0),this.addCurrentVertex(qt,$r,0,0,rr)));if(na&&kn<ft-1){var qo=qt.dist(Fr);if(qo>2*Ot){var Vo=qt.add(Fr.sub(qt)._mult(Ot/qo)._round());this.updateDistance(qt,Vo),this.addCurrentVertex(Vo,$r,0,0,rr),qt=Vo}}}}},tl.prototype.addCurrentVertex=function(C,B,J,he,xe,Te){Te===void 0&&(Te=!1);var Fe=B.x+B.y*J,$e=B.y-B.x*J,ft=-B.x+B.y*he,pt=-B.y-B.x*he;this.addHalfVertex(C,Fe,$e,Te,!1,J,xe),this.addHalfVertex(C,ft,pt,Te,!0,-he,xe),this.distance>Xh/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(C,B,J,he,xe,Te))},tl.prototype.addHalfVertex=function(C,B,J,he,xe,Te,Fe){var $e=C.x,ft=C.y,pt=this.scaledDistance*Wh;this.layoutVertexArray.emplaceBack(($e<<1)+(he?1:0),(ft<<1)+(xe?1:0),Math.round(Yh*B)+128,Math.round(Yh*J)+128,(Te===0?0:Te<0?-1:1)+1|(pt&63)<<2,pt>>6);var Ot=Fe.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ot),Fe.primitiveLength++),xe?this.e2=Ot:this.e1=Ot},tl.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Xh-1):this.distance},tl.prototype.updateDistance=function(C,B){this.distance+=C.dist(B),this.updateScaledDistance()},Oe("LineBucket",tl,{omit:["layers","patternFeatures"]});var sd=new Xi({"line-cap":new Ia(Ht.layout_line["line-cap"]),"line-join":new Za(Ht.layout_line["line-join"]),"line-miter-limit":new Ia(Ht.layout_line["line-miter-limit"]),"line-round-limit":new Ia(Ht.layout_line["line-round-limit"]),"line-sort-key":new Za(Ht.layout_line["line-sort-key"])}),ld=new Xi({"line-opacity":new Za(Ht.paint_line["line-opacity"]),"line-color":new Za(Ht.paint_line["line-color"]),"line-translate":new Ia(Ht.paint_line["line-translate"]),"line-translate-anchor":new Ia(Ht.paint_line["line-translate-anchor"]),"line-width":new Za(Ht.paint_line["line-width"]),"line-gap-width":new Za(Ht.paint_line["line-gap-width"]),"line-offset":new Za(Ht.paint_line["line-offset"]),"line-blur":new Za(Ht.paint_line["line-blur"]),"line-dasharray":new eo(Ht.paint_line["line-dasharray"]),"line-pattern":new bo(Ht.paint_line["line-pattern"]),"line-gradient":new Do(Ht.paint_line["line-gradient"])}),Zh={paint:ld,layout:sd},ud=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.possiblyEvaluate=function(J,he){return he=new si(Math.floor(he.zoom),{now:he.now,fadeDuration:he.fadeDuration,zoomHistory:he.zoomHistory,transition:he.transition}),E.prototype.possiblyEvaluate.call(this,J,he)},C.prototype.evaluate=function(J,he,xe,Te){return he=w({},he,{zoom:Math.floor(he.zoom)}),E.prototype.evaluate.call(this,J,he,xe,Te)},C}(Za),jh=new ud(Zh.paint.properties["line-width"].specification);jh.useIntegerZoom=!0;var fd=function(E){function C(B){E.call(this,B,Zh)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._handleSpecialPaintPropertyUpdate=function(J){J==="line-gradient"&&this._updateGradient()},C.prototype._updateGradient=function(){var J=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Ph(J,"lineProgress"),this.gradientTexture=null},C.prototype.recalculate=function(J,he){E.prototype.recalculate.call(this,J,he),this.paint._values["line-floorwidth"]=jh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,J)},C.prototype.createBucket=function(J){return new tl(J)},C.prototype.queryRadius=function(J){var he=J,xe=Kh(cl("line-width",this,he),cl("line-gap-width",this,he)),Te=cl("line-offset",this,he);return xe/2+Math.abs(Te)+tu(this.paint.get("line-translate"))},C.prototype.queryIntersectsFeature=function(J,he,xe,Te,Fe,$e,ft){var pt=Vl(J,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),$e.angle,ft),Ot=ft/2*Kh(this.paint.get("line-width").evaluate(he,xe),this.paint.get("line-gap-width").evaluate(he,xe)),rr=this.paint.get("line-offset").evaluate(he,xe);return rr&&(Te=cd(Te,rr*ft)),Bo(pt,Te,Ot)},C.prototype.isTileClipped=function(){return!0},C}(xs);function Kh(E,C){return C>0?C+2*E:E}function cd(E,C){for(var B=[],J=new h(0,0),he=0;he<E.length;he++){for(var xe=E[he],Te=[],Fe=0;Fe<xe.length;Fe++){var $e=xe[Fe-1],ft=xe[Fe],pt=xe[Fe+1],Ot=Fe===0?J:ft.sub($e)._unit()._perp(),rr=Fe===xe.length-1?J:pt.sub(ft)._unit()._perp(),qt=Ot._add(rr)._unit(),dr=qt.x*rr.x+qt.y*rr.y;qt._mult(1/dr),Te.push(qt._mult(C)._add(ft))}B.push(Te)}return B}var ch=Ro([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),hd=Ro([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ro([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var vd=Ro([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Ro([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var Jh=Ro([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),pd=Ro([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ro([{name:"triangle",components:3,type:"Uint16"}]),Ro([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ro([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ro([{type:"Float32",name:"offsetX"}]),Ro([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function dd(E,C,B){var J=C.layout.get("text-transform").evaluate(B,{});return J==="uppercase"?E=E.toLocaleUpperCase():J==="lowercase"&&(E=E.toLocaleLowerCase()),Xa.applyArabicShaping&&(E=Xa.applyArabicShaping(E)),E}function gd(E,C,B){return E.sections.forEach(function(J){J.text=dd(J.text,C,B)}),E}function yd(E){var C={},B={},J=[],he=0;function xe($r){J.push(E[$r]),he++}function Te($r,kn,mn){var Sn=B[$r];return delete B[$r],B[kn]=Sn,J[Sn].geometry[0].pop(),J[Sn].geometry[0]=J[Sn].geometry[0].concat(mn[0]),Sn}function Fe($r,kn,mn){var Sn=C[kn];return delete C[kn],C[$r]=Sn,J[Sn].geometry[0].shift(),J[Sn].geometry[0]=mn[0].concat(J[Sn].geometry[0]),Sn}function $e($r,kn,mn){var Sn=mn?kn[0][kn[0].length-1]:kn[0][0];return $r+":"+Sn.x+":"+Sn.y}for(var ft=0;ft<E.length;ft++){var pt=E[ft],Ot=pt.geometry,rr=pt.text?pt.text.toString():null;if(!rr){xe(ft);continue}var qt=$e(rr,Ot),dr=$e(rr,Ot,!0);if(qt in B&&dr in C&&B[qt]!==C[dr]){var Fr=Fe(qt,dr,Ot),an=Te(qt,dr,J[Fr].geometry);delete C[qt],delete B[dr],B[$e(rr,J[an].geometry,!0)]=an,J[Fr].geometry=null}else qt in B?Te(qt,dr,Ot):dr in C?Fe(qt,dr,Ot):(xe(ft),C[qt]=he-1,B[dr]=he-1)}return J.filter(function($r){return $r.geometry})}var hc={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function md(E){for(var C="",B=0;B<E.length;B++){var J=E.charCodeAt(B+1)||null,he=E.charCodeAt(B-1)||null,xe=(!J||!nn(J)||hc[E[B+1]])&&(!he||!nn(he)||hc[E[B-1]]);xe&&hc[E[B]]?C+=hc[E[B]]:C+=E[B]}return C}var hs=24,xd=function(E,C,B,J,he){var xe,Te,Fe=he*8-J-1,$e=(1<<Fe)-1,ft=$e>>1,pt=-7,Ot=B?he-1:0,rr=B?-1:1,qt=E[C+Ot];for(Ot+=rr,xe=qt&(1<<-pt)-1,qt>>=-pt,pt+=Fe;pt>0;xe=xe*256+E[C+Ot],Ot+=rr,pt-=8);for(Te=xe&(1<<-pt)-1,xe>>=-pt,pt+=J;pt>0;Te=Te*256+E[C+Ot],Ot+=rr,pt-=8);if(xe===0)xe=1-ft;else{if(xe===$e)return Te?NaN:(qt?-1:1)*(1/0);Te=Te+Math.pow(2,J),xe=xe-ft}return(qt?-1:1)*Te*Math.pow(2,xe-J)},bd=function(E,C,B,J,he,xe){var Te,Fe,$e,ft=xe*8-he-1,pt=(1<<ft)-1,Ot=pt>>1,rr=he===23?Math.pow(2,-24)-Math.pow(2,-77):0,qt=J?0:xe-1,dr=J?1:-1,Fr=C<0||C===0&&1/C<0?1:0;for(C=Math.abs(C),isNaN(C)||C===1/0?(Fe=isNaN(C)?1:0,Te=pt):(Te=Math.floor(Math.log(C)/Math.LN2),C*($e=Math.pow(2,-Te))<1&&(Te--,$e*=2),Te+Ot>=1?C+=rr/$e:C+=rr*Math.pow(2,1-Ot),C*$e>=2&&(Te++,$e/=2),Te+Ot>=pt?(Fe=0,Te=pt):Te+Ot>=1?(Fe=(C*$e-1)*Math.pow(2,he),Te=Te+Ot):(Fe=C*Math.pow(2,Ot-1)*Math.pow(2,he),Te=0));he>=8;E[B+qt]=Fe&255,qt+=dr,Fe/=256,he-=8);for(Te=Te<<he|Fe,ft+=he;ft>0;E[B+qt]=Te&255,qt+=dr,Te/=256,ft-=8);E[B+qt-dr]|=Fr*128},Dc={read:xd,write:bd},Rc=to;function to(E){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(E)?E:new Uint8Array(E||0),this.pos=0,this.type=0,this.length=this.buf.length}to.Varint=0,to.Fixed64=1,to.Bytes=2,to.Fixed32=5;var hh=(1<<16)*(1<<16),Qh=1/hh,_d=12,$h=typeof TextDecoder>"u"?null:new TextDecoder("utf8");to.prototype={destroy:function(){this.buf=null},readFields:function(E,C,B){for(B=B||this.length;this.pos<B;){var J=this.readVarint(),he=J>>3,xe=this.pos;this.type=J&7,E(he,C,this),this.pos===xe&&this.skip(J)}return C},readMessage:function(E,C){return this.readFields(E,C,this.readVarint()+this.pos)},readFixed32:function(){var E=Ic(this.buf,this.pos);return this.pos+=4,E},readSFixed32:function(){var E=ev(this.buf,this.pos);return this.pos+=4,E},readFixed64:function(){var E=Ic(this.buf,this.pos)+Ic(this.buf,this.pos+4)*hh;return this.pos+=8,E},readSFixed64:function(){var E=Ic(this.buf,this.pos)+ev(this.buf,this.pos+4)*hh;return this.pos+=8,E},readFloat:function(){var E=Dc.read(this.buf,this.pos,!0,23,4);return this.pos+=4,E},readDouble:function(){var E=Dc.read(this.buf,this.pos,!0,52,8);return this.pos+=8,E},readVarint:function(E){var C=this.buf,B,J;return J=C[this.pos++],B=J&127,J<128||(J=C[this.pos++],B|=(J&127)<<7,J<128)||(J=C[this.pos++],B|=(J&127)<<14,J<128)||(J=C[this.pos++],B|=(J&127)<<21,J<128)?B:(J=C[this.pos],B|=(J&15)<<28,wd(B,E,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var E=this.readVarint();return E%2===1?(E+1)/-2:E/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var E=this.readVarint()+this.pos,C=this.pos;return this.pos=E,E-C>=_d&&$h?Fd(this.buf,C,E):zd(this.buf,C,E)},readBytes:function(){var E=this.readVarint()+this.pos,C=this.buf.subarray(this.pos,E);return this.pos=E,C},readPackedVarint:function(E,C){if(this.type!==to.Bytes)return E.push(this.readVarint(C));var B=ju(this);for(E=E||[];this.pos<B;)E.push(this.readVarint(C));return E},readPackedSVarint:function(E){if(this.type!==to.Bytes)return E.push(this.readSVarint());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSVarint());return E},readPackedBoolean:function(E){if(this.type!==to.Bytes)return E.push(this.readBoolean());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readBoolean());return E},readPackedFloat:function(E){if(this.type!==to.Bytes)return E.push(this.readFloat());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFloat());return E},readPackedDouble:function(E){if(this.type!==to.Bytes)return E.push(this.readDouble());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readDouble());return E},readPackedFixed32:function(E){if(this.type!==to.Bytes)return E.push(this.readFixed32());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFixed32());return E},readPackedSFixed32:function(E){if(this.type!==to.Bytes)return E.push(this.readSFixed32());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSFixed32());return E},readPackedFixed64:function(E){if(this.type!==to.Bytes)return E.push(this.readFixed64());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFixed64());return E},readPackedSFixed64:function(E){if(this.type!==to.Bytes)return E.push(this.readSFixed64());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSFixed64());return E},skip:function(E){var C=E&7;if(C===to.Varint)for(;this.buf[this.pos++]>127;);else if(C===to.Bytes)this.pos=this.readVarint()+this.pos;else if(C===to.Fixed32)this.pos+=4;else if(C===to.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+C)},writeTag:function(E,C){this.writeVarint(E<<3|C)},realloc:function(E){for(var C=this.length||16;C<this.pos+E;)C*=2;if(C!==this.length){var B=new Uint8Array(C);B.set(this.buf),this.buf=B,this.length=C}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(E){this.realloc(4),Nf(this.buf,E,this.pos),this.pos+=4},writeSFixed32:function(E){this.realloc(4),Nf(this.buf,E,this.pos),this.pos+=4},writeFixed64:function(E){this.realloc(8),Nf(this.buf,E&-1,this.pos),Nf(this.buf,Math.floor(E*Qh),this.pos+4),this.pos+=8},writeSFixed64:function(E){this.realloc(8),Nf(this.buf,E&-1,this.pos),Nf(this.buf,Math.floor(E*Qh),this.pos+4),this.pos+=8},writeVarint:function(E){if(E=+E||0,E>268435455||E<0){Td(E,this);return}this.realloc(4),this.buf[this.pos++]=E&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=(E>>>=7)&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=(E>>>=7)&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=E>>>7&127)))},writeSVarint:function(E){this.writeVarint(E<0?-E*2-1:E*2)},writeBoolean:function(E){this.writeVarint(!!E)},writeString:function(E){E=String(E),this.realloc(E.length*4),this.pos++;var C=this.pos;this.pos=Od(this.buf,E,this.pos);var B=this.pos-C;B>=128&&qh(C,B,this),this.pos=C-1,this.writeVarint(B),this.pos+=B},writeFloat:function(E){this.realloc(4),Dc.write(this.buf,E,this.pos,!0,23,4),this.pos+=4},writeDouble:function(E){this.realloc(8),Dc.write(this.buf,E,this.pos,!0,52,8),this.pos+=8},writeBytes:function(E){var C=E.length;this.writeVarint(C),this.realloc(C);for(var B=0;B<C;B++)this.buf[this.pos++]=E[B]},writeRawMessage:function(E,C){this.pos++;var B=this.pos;E(C,this);var J=this.pos-B;J>=128&&qh(B,J,this),this.pos=B-1,this.writeVarint(J),this.pos+=J},writeMessage:function(E,C,B){this.writeTag(E,to.Bytes),this.writeRawMessage(C,B)},writePackedVarint:function(E,C){C.length&&this.writeMessage(E,Sd,C)},writePackedSVarint:function(E,C){C.length&&this.writeMessage(E,kd,C)},writePackedBoolean:function(E,C){C.length&&this.writeMessage(E,Ld,C)},writePackedFloat:function(E,C){C.length&&this.writeMessage(E,Ed,C)},writePackedDouble:function(E,C){C.length&&this.writeMessage(E,Cd,C)},writePackedFixed32:function(E,C){C.length&&this.writeMessage(E,Pd,C)},writePackedSFixed32:function(E,C){C.length&&this.writeMessage(E,Dd,C)},writePackedFixed64:function(E,C){C.length&&this.writeMessage(E,Rd,C)},writePackedSFixed64:function(E,C){C.length&&this.writeMessage(E,Id,C)},writeBytesField:function(E,C){this.writeTag(E,to.Bytes),this.writeBytes(C)},writeFixed32Field:function(E,C){this.writeTag(E,to.Fixed32),this.writeFixed32(C)},writeSFixed32Field:function(E,C){this.writeTag(E,to.Fixed32),this.writeSFixed32(C)},writeFixed64Field:function(E,C){this.writeTag(E,to.Fixed64),this.writeFixed64(C)},writeSFixed64Field:function(E,C){this.writeTag(E,to.Fixed64),this.writeSFixed64(C)},writeVarintField:function(E,C){this.writeTag(E,to.Varint),this.writeVarint(C)},writeSVarintField:function(E,C){this.writeTag(E,to.Varint),this.writeSVarint(C)},writeStringField:function(E,C){this.writeTag(E,to.Bytes),this.writeString(C)},writeFloatField:function(E,C){this.writeTag(E,to.Fixed32),this.writeFloat(C)},writeDoubleField:function(E,C){this.writeTag(E,to.Fixed64),this.writeDouble(C)},writeBooleanField:function(E,C){this.writeVarintField(E,!!C)}};function wd(E,C,B){var J=B.buf,he,xe;if(xe=J[B.pos++],he=(xe&112)>>4,xe<128||(xe=J[B.pos++],he|=(xe&127)<<3,xe<128)||(xe=J[B.pos++],he|=(xe&127)<<10,xe<128)||(xe=J[B.pos++],he|=(xe&127)<<17,xe<128)||(xe=J[B.pos++],he|=(xe&127)<<24,xe<128)||(xe=J[B.pos++],he|=(xe&1)<<31,xe<128))return Bf(E,he,C);throw new Error("Expected varint not more than 10 bytes")}function ju(E){return E.type===to.Bytes?E.readVarint()+E.pos:E.pos+1}function Bf(E,C,B){return B?C*4294967296+(E>>>0):(C>>>0)*4294967296+(E>>>0)}function Td(E,C){var B,J;if(E>=0?(B=E%4294967296|0,J=E/4294967296|0):(B=~(-E%4294967296),J=~(-E/4294967296),B^4294967295?B=B+1|0:(B=0,J=J+1|0)),E>=18446744073709552e3||E<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");C.realloc(10),Ad(B,J,C),Md(J,C)}function Ad(E,C,B){B.buf[B.pos++]=E&127|128,E>>>=7,B.buf[B.pos++]=E&127|128,E>>>=7,B.buf[B.pos++]=E&127|128,E>>>=7,B.buf[B.pos++]=E&127|128,E>>>=7,B.buf[B.pos]=E&127}function Md(E,C){var B=(E&7)<<4;C.buf[C.pos++]|=B|((E>>>=3)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127)))))}function qh(E,C,B){var J=C<=16383?1:C<=2097151?2:C<=268435455?3:Math.floor(Math.log(C)/(Math.LN2*7));B.realloc(J);for(var he=B.pos-1;he>=E;he--)B.buf[he+J]=B.buf[he]}function Sd(E,C){for(var B=0;B<E.length;B++)C.writeVarint(E[B])}function kd(E,C){for(var B=0;B<E.length;B++)C.writeSVarint(E[B])}function Ed(E,C){for(var B=0;B<E.length;B++)C.writeFloat(E[B])}function Cd(E,C){for(var B=0;B<E.length;B++)C.writeDouble(E[B])}function Ld(E,C){for(var B=0;B<E.length;B++)C.writeBoolean(E[B])}function Pd(E,C){for(var B=0;B<E.length;B++)C.writeFixed32(E[B])}function Dd(E,C){for(var B=0;B<E.length;B++)C.writeSFixed32(E[B])}function Rd(E,C){for(var B=0;B<E.length;B++)C.writeFixed64(E[B])}function Id(E,C){for(var B=0;B<E.length;B++)C.writeSFixed64(E[B])}function Ic(E,C){return(E[C]|E[C+1]<<8|E[C+2]<<16)+E[C+3]*16777216}function Nf(E,C,B){E[B]=C,E[B+1]=C>>>8,E[B+2]=C>>>16,E[B+3]=C>>>24}function ev(E,C){return(E[C]|E[C+1]<<8|E[C+2]<<16)+(E[C+3]<<24)}function zd(E,C,B){for(var J="",he=C;he<B;){var xe=E[he],Te=null,Fe=xe>239?4:xe>223?3:xe>191?2:1;if(he+Fe>B)break;var $e,ft,pt;Fe===1?xe<128&&(Te=xe):Fe===2?($e=E[he+1],($e&192)===128&&(Te=(xe&31)<<6|$e&63,Te<=127&&(Te=null))):Fe===3?($e=E[he+1],ft=E[he+2],($e&192)===128&&(ft&192)===128&&(Te=(xe&15)<<12|($e&63)<<6|ft&63,(Te<=2047||Te>=55296&&Te<=57343)&&(Te=null))):Fe===4&&($e=E[he+1],ft=E[he+2],pt=E[he+3],($e&192)===128&&(ft&192)===128&&(pt&192)===128&&(Te=(xe&15)<<18|($e&63)<<12|(ft&63)<<6|pt&63,(Te<=65535||Te>=1114112)&&(Te=null))),Te===null?(Te=65533,Fe=1):Te>65535&&(Te-=65536,J+=String.fromCharCode(Te>>>10&1023|55296),Te=56320|Te&1023),J+=String.fromCharCode(Te),he+=Fe}return J}function Fd(E,C,B){return $h.decode(E.subarray(C,B))}function Od(E,C,B){for(var J=0,he,xe;J<C.length;J++){if(he=C.charCodeAt(J),he>55295&&he<57344)if(xe)if(he<56320){E[B++]=239,E[B++]=191,E[B++]=189,xe=he;continue}else he=xe-55296<<10|he-56320|65536,xe=null;else{he>56319||J+1===C.length?(E[B++]=239,E[B++]=191,E[B++]=189):xe=he;continue}else xe&&(E[B++]=239,E[B++]=191,E[B++]=189,xe=null);he<128?E[B++]=he:(he<2048?E[B++]=he>>6|192:(he<65536?E[B++]=he>>12|224:(E[B++]=he>>18|240,E[B++]=he>>12&63|128),E[B++]=he>>6&63|128),E[B++]=he&63|128)}return B}var vh=3;function Bd(E,C,B){E===1&&B.readMessage(Nd,C)}function Nd(E,C,B){if(E===3){var J=B.readMessage(Ud,{}),he=J.id,xe=J.bitmap,Te=J.width,Fe=J.height,$e=J.left,ft=J.top,pt=J.advance;C.push({id:he,bitmap:new _f({width:Te+2*vh,height:Fe+2*vh},xe),metrics:{width:Te,height:Fe,left:$e,top:ft,advance:pt}})}}function Ud(E,C,B){E===1?C.id=B.readVarint():E===2?C.bitmap=B.readBytes():E===3?C.width=B.readVarint():E===4?C.height=B.readVarint():E===5?C.left=B.readSVarint():E===6?C.top=B.readSVarint():E===7&&(C.advance=B.readVarint())}function Hd(E){return new Rc(E).readFields(Bd,[])}var tv=vh;function rv(E){for(var C=0,B=0,J=0,he=E;J<he.length;J+=1){var xe=he[J];C+=xe.w*xe.h,B=Math.max(B,xe.w)}E.sort(function(an,$r){return $r.h-an.h});for(var Te=Math.max(Math.ceil(Math.sqrt(C/.95)),B),Fe=[{x:0,y:0,w:Te,h:1/0}],$e=0,ft=0,pt=0,Ot=E;pt<Ot.length;pt+=1)for(var rr=Ot[pt],qt=Fe.length-1;qt>=0;qt--){var dr=Fe[qt];if(!(rr.w>dr.w||rr.h>dr.h)){if(rr.x=dr.x,rr.y=dr.y,ft=Math.max(ft,rr.y+rr.h),$e=Math.max($e,rr.x+rr.w),rr.w===dr.w&&rr.h===dr.h){var Fr=Fe.pop();qt<Fe.length&&(Fe[qt]=Fr)}else rr.h===dr.h?(dr.x+=rr.w,dr.w-=rr.w):rr.w===dr.w?(dr.y+=rr.h,dr.h-=rr.h):(Fe.push({x:dr.x+rr.w,y:dr.y,w:dr.w-rr.w,h:rr.h}),dr.y+=rr.h,dr.h-=rr.h);break}}return{w:$e,h:ft,fill:C/($e*ft)||0}}var hl=1,zc=function(C,B){var J=B.pixelRatio,he=B.version,xe=B.stretchX,Te=B.stretchY,Fe=B.content;this.paddedRect=C,this.pixelRatio=J,this.stretchX=xe,this.stretchY=Te,this.content=Fe,this.version=he},vc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};vc.tl.get=function(){return[this.paddedRect.x+hl,this.paddedRect.y+hl]},vc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-hl,this.paddedRect.y+this.paddedRect.h-hl]},vc.tlbr.get=function(){return this.tl.concat(this.br)},vc.displaySize.get=function(){return[(this.paddedRect.w-hl*2)/this.pixelRatio,(this.paddedRect.h-hl*2)/this.pixelRatio]},Object.defineProperties(zc.prototype,vc);var pc=function(C,B){var J={},he={};this.haveRenderCallbacks=[];var xe=[];this.addImages(C,J,xe),this.addImages(B,he,xe);var Te=rv(xe),Fe=Te.w,$e=Te.h,ft=new el({width:Fe||1,height:$e||1});for(var pt in C){var Ot=C[pt],rr=J[pt].paddedRect;el.copy(Ot.data,ft,{x:0,y:0},{x:rr.x+hl,y:rr.y+hl},Ot.data)}for(var qt in B){var dr=B[qt],Fr=he[qt].paddedRect,an=Fr.x+hl,$r=Fr.y+hl,kn=dr.data.width,mn=dr.data.height;el.copy(dr.data,ft,{x:0,y:0},{x:an,y:$r},dr.data),el.copy(dr.data,ft,{x:0,y:mn-1},{x:an,y:$r-1},{width:kn,height:1}),el.copy(dr.data,ft,{x:0,y:0},{x:an,y:$r+mn},{width:kn,height:1}),el.copy(dr.data,ft,{x:kn-1,y:0},{x:an-1,y:$r},{width:1,height:mn}),el.copy(dr.data,ft,{x:0,y:0},{x:an+kn,y:$r},{width:1,height:mn})}this.image=ft,this.iconPositions=J,this.patternPositions=he};pc.prototype.addImages=function(C,B,J){for(var he in C){var xe=C[he],Te={x:0,y:0,w:xe.data.width+2*hl,h:xe.data.height+2*hl};J.push(Te),B[he]=new zc(Te,xe),xe.hasRenderCallback&&this.haveRenderCallbacks.push(he)}},pc.prototype.patchUpdatedImages=function(C,B){C.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var J in C.updatedImages)this.patchUpdatedImage(this.iconPositions[J],C.getImage(J),B),this.patchUpdatedImage(this.patternPositions[J],C.getImage(J),B)},pc.prototype.patchUpdatedImage=function(C,B,J){if(!(!C||!B)&&C.version!==B.version){C.version=B.version;var he=C.tl,xe=he[0],Te=he[1];J.update(B.data,void 0,{x:xe,y:Te})}},Oe("ImagePosition",zc),Oe("ImageAtlas",pc);var El={horizontal:1,vertical:2,horizontalOnly:3},dc=-17;function Vd(E){for(var C=0,B=E;C<B.length;C+=1){var J=B[C];if(J.positionedGlyphs.length!==0)return!1}return!0}var nv=57344,av=63743,Uf=function(){this.scale=1,this.fontStack="",this.imageName=null};Uf.forText=function(C,B){var J=new Uf;return J.scale=C||1,J.fontStack=B,J},Uf.forImage=function(C){var B=new Uf;return B.imageName=C,B};var Cs=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};Cs.fromFeature=function(C,B){for(var J=new Cs,he=0;he<C.sections.length;he++){var xe=C.sections[he];xe.image?J.addImageSection(xe):J.addTextSection(xe,B)}return J},Cs.prototype.length=function(){return this.text.length},Cs.prototype.getSection=function(C){return this.sections[this.sectionIndex[C]]},Cs.prototype.getSectionIndex=function(C){return this.sectionIndex[C]},Cs.prototype.getCharCode=function(C){return this.text.charCodeAt(C)},Cs.prototype.verticalizePunctuation=function(){this.text=md(this.text)},Cs.prototype.trim=function(){for(var C=0,B=0;B<this.text.length&&Gu[this.text.charCodeAt(B)];B++)C++;for(var J=this.text.length,he=this.text.length-1;he>=0&&he>=C&&Gu[this.text.charCodeAt(he)];he--)J--;this.text=this.text.substring(C,J),this.sectionIndex=this.sectionIndex.slice(C,J)},Cs.prototype.substring=function(C,B){var J=new Cs;return J.text=this.text.substring(C,B),J.sectionIndex=this.sectionIndex.slice(C,B),J.sections=this.sections,J},Cs.prototype.toString=function(){return this.text},Cs.prototype.getMaxScale=function(){var C=this;return this.sectionIndex.reduce(function(B,J){return Math.max(B,C.sections[J].scale)},0)},Cs.prototype.addTextSection=function(C,B){this.text+=C.text,this.sections.push(Uf.forText(C.scale,C.fontStack||B));for(var J=this.sections.length-1,he=0;he<C.text.length;++he)this.sectionIndex.push(J)},Cs.prototype.addImageSection=function(C){var B=C.image?C.image.name:"";if(B.length===0){O("Can't add FormattedSection with an empty image.");return}var J=this.getNextImageSectionCharCode();if(!J){O("Reached maximum number of images "+(av-nv+2));return}this.text+=String.fromCharCode(J),this.sections.push(Uf.forImage(B)),this.sectionIndex.push(this.sections.length-1)},Cs.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=av?null:++this.imageSectionID:(this.imageSectionID=nv,this.imageSectionID)};function Gd(E,C){for(var B=[],J=E.text,he=0,xe=0,Te=C;xe<Te.length;xe+=1){var Fe=Te[xe];B.push(E.substring(he,Fe)),he=Fe}return he<J.length&&B.push(E.substring(he,J.length)),B}function Fc(E,C,B,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr){var an=Cs.fromFeature(E,he);Ot===El.vertical&&an.verticalizePunctuation();var $r,kn=Xa.processBidirectionalText,mn=Xa.processStyledBidirectionalText;if(kn&&an.sections.length===1){$r=[];for(var Sn=kn(an.toString(),ph(an,ft,xe,C,J,qt,dr)),In=0,Gn=Sn;In<Gn.length;In+=1){var oa=Gn[In],na=new Cs;na.text=oa,na.sections=an.sections;for(var Ra=0;Ra<oa.length;Ra++)na.sectionIndex.push(0);$r.push(na)}}else if(mn){$r=[];for(var wa=mn(an.text,an.sectionIndex,ph(an,ft,xe,C,J,qt,dr)),Sa=0,ti=wa;Sa<ti.length;Sa+=1){var La=ti[Sa],Da=new Cs;Da.text=La[0],Da.sectionIndex=La[1],Da.sections=an.sections,$r.push(Da)}}else $r=Gd(an,ph(an,ft,xe,C,J,qt,dr));var fi=[],qa={positionedLines:fi,text:an.toString(),top:pt[1],bottom:pt[1],left:pt[0],right:pt[0],writingMode:Ot,iconsInText:!1,verticalizable:!1};return Xd(qa,C,B,J,$r,Te,Fe,$e,Ot,ft,rr,Fr),Vd(fi)?!1:qa}var Gu={};Gu[9]=!0,Gu[10]=!0,Gu[11]=!0,Gu[12]=!0,Gu[13]=!0,Gu[32]=!0;var vl={};vl[10]=!0,vl[32]=!0,vl[38]=!0,vl[40]=!0,vl[41]=!0,vl[43]=!0,vl[45]=!0,vl[47]=!0,vl[173]=!0,vl[183]=!0,vl[8203]=!0,vl[8208]=!0,vl[8211]=!0,vl[8231]=!0;function iv(E,C,B,J,he,xe){if(C.imageName){var $e=J[C.imageName];return $e?$e.displaySize[0]*C.scale*hs/xe+he:0}else{var Te=B[C.fontStack],Fe=Te&&Te[E];return Fe?Fe.metrics.advance*C.scale+he:0}}function Yd(E,C,B,J,he,xe){for(var Te=0,Fe=0;Fe<E.length();Fe++){var $e=E.getSection(Fe);Te+=iv(E.getCharCode(Fe),$e,J,he,C,xe)}var ft=Math.max(1,Math.ceil(Te/B));return Te/ft}function ov(E,C,B,J){var he=Math.pow(E-C,2);return J?E<C?he/2:he*2:he+Math.abs(B)*B}function Wd(E,C,B){var J=0;return E===10&&(J-=1e4),B&&(J+=150),(E===40||E===65288)&&(J+=50),(C===41||C===65289)&&(J+=50),J}function sv(E,C,B,J,he,xe){for(var Te=null,Fe=ov(C,B,he,xe),$e=0,ft=J;$e<ft.length;$e+=1){var pt=ft[$e],Ot=C-pt.x,rr=ov(Ot,B,he,xe)+pt.badness;rr<=Fe&&(Te=pt,Fe=rr)}return{index:E,x:C,priorBreak:Te,badness:Fe}}function lv(E){return E?lv(E.priorBreak).concat(E.index):[]}function ph(E,C,B,J,he,xe,Te){if(xe!=="point")return[];if(!E)return[];for(var Fe=[],$e=Yd(E,C,B,J,he,Te),ft=E.text.indexOf("")>=0,pt=0,Ot=0;Ot<E.length();Ot++){var rr=E.getSection(Ot),qt=E.getCharCode(Ot);if(Gu[qt]||(pt+=iv(qt,rr,J,he,C,Te)),Ot<E.length()-1){var dr=Lr(qt);(vl[qt]||dr||rr.imageName)&&Fe.push(sv(Ot+1,pt,$e,Fe,Wd(qt,E.getCharCode(Ot+1),dr&&ft),!1))}}return lv(sv(E.length(),pt,$e,Fe,0,!0))}function dh(E){var C=.5,B=.5;switch(E){case"right":case"top-right":case"bottom-right":C=1;break;case"left":case"top-left":case"bottom-left":C=0;break}switch(E){case"bottom":case"bottom-right":case"bottom-left":B=1;break;case"top":case"top-right":case"top-left":B=0;break}return{horizontalAlign:C,verticalAlign:B}}function Xd(E,C,B,J,he,xe,Te,Fe,$e,ft,pt,Ot){for(var rr=0,qt=dc,dr=0,Fr=0,an=Fe==="right"?1:Fe==="left"?0:.5,$r=0,kn=0,mn=he;kn<mn.length;kn+=1){var Sn=mn[kn];Sn.trim();var In=Sn.getMaxScale(),Gn=(In-1)*hs,oa={positionedGlyphs:[],lineOffset:0};E.positionedLines[$r]=oa;var na=oa.positionedGlyphs,Ra=0;if(!Sn.length()){qt+=xe,++$r;continue}for(var wa=0;wa<Sn.length();wa++){var Sa=Sn.getSection(wa),ti=Sn.getSectionIndex(wa),La=Sn.getCharCode(wa),Da=0,fi=null,qa=null,ki=null,Wi=hs,Ei=!($e===El.horizontal||!pt&&!Nr(La)||pt&&(Gu[La]||on(La)));if(Sa.imageName){var To=J[Sa.imageName];if(!To)continue;ki=Sa.imageName,E.iconsInText=E.iconsInText||!0,qa=To.paddedRect;var Lo=To.displaySize;Sa.scale=Sa.scale*hs/Ot,fi={width:Lo[0],height:Lo[1],left:hl,top:-tv,advance:Ei?Lo[1]:Lo[0]};var qo=hs-Lo[1]*Sa.scale;Da=Gn+qo,Wi=fi.advance;var Vo=Ei?Lo[0]*Sa.scale-hs*In:Lo[1]*Sa.scale-hs*In;Vo>0&&Vo>Ra&&(Ra=Vo)}else{var Ci=B[Sa.fontStack],Ti=Ci&&Ci[La];if(Ti&&Ti.rect)qa=Ti.rect,fi=Ti.metrics;else{var $i=C[Sa.fontStack],ro=$i&&$i[La];if(!ro)continue;fi=ro.metrics}Da=(In-Sa.scale)*hs}Ei?(E.verticalizable=!0,na.push({glyph:La,imageName:ki,x:rr,y:qt+Da,vertical:Ei,scale:Sa.scale,fontStack:Sa.fontStack,sectionIndex:ti,metrics:fi,rect:qa}),rr+=Wi*Sa.scale+ft):(na.push({glyph:La,imageName:ki,x:rr,y:qt+Da,vertical:Ei,scale:Sa.scale,fontStack:Sa.fontStack,sectionIndex:ti,metrics:fi,rect:qa}),rr+=fi.advance*Sa.scale+ft)}if(na.length!==0){var Ls=rr-ft;dr=Math.max(Ls,dr),Zd(na,0,na.length-1,an,Ra)}rr=0;var Ps=xe*In+Ra;oa.lineOffset=Math.max(Ra,Gn),qt+=Ps,Fr=Math.max(Ps,Fr),++$r}var es=qt-dc,Ns=dh(Te),Us=Ns.horizontalAlign,Zo=Ns.verticalAlign;jd(E.positionedLines,an,Us,Zo,dr,Fr,xe,es,he.length),E.top+=-Zo*es,E.bottom=E.top+es,E.left+=-Us*dr,E.right=E.left+dr}function Zd(E,C,B,J,he){if(!(!J&&!he))for(var xe=E[B],Te=xe.metrics.advance*xe.scale,Fe=(E[B].x+Te)*J,$e=C;$e<=B;$e++)E[$e].x-=Fe,E[$e].y+=he}function jd(E,C,B,J,he,xe,Te,Fe,$e){var ft=(C-B)*he,pt=0;xe!==Te?pt=-Fe*J-dc:pt=(-J*$e+.5)*Te;for(var Ot=0,rr=E;Ot<rr.length;Ot+=1)for(var qt=rr[Ot],dr=0,Fr=qt.positionedGlyphs;dr<Fr.length;dr+=1){var an=Fr[dr];an.x+=ft,an.y+=pt}}function Kd(E,C,B){var J=dh(B),he=J.horizontalAlign,xe=J.verticalAlign,Te=C[0],Fe=C[1],$e=Te-E.displaySize[0]*he,ft=$e+E.displaySize[0],pt=Fe-E.displaySize[1]*xe,Ot=pt+E.displaySize[1];return{image:E,top:pt,bottom:Ot,left:$e,right:ft}}function uv(E,C,B,J,he,xe){var Te=E.image,Fe;if(Te.content){var $e=Te.content,ft=Te.pixelRatio||1;Fe=[$e[0]/ft,$e[1]/ft,Te.displaySize[0]-$e[2]/ft,Te.displaySize[1]-$e[3]/ft]}var pt=C.left*xe,Ot=C.right*xe,rr,qt,dr,Fr;B==="width"||B==="both"?(Fr=he[0]+pt-J[3],qt=he[0]+Ot+J[1]):(Fr=he[0]+(pt+Ot-Te.displaySize[0])/2,qt=Fr+Te.displaySize[0]);var an=C.top*xe,$r=C.bottom*xe;return B==="height"||B==="both"?(rr=he[1]+an-J[0],dr=he[1]+$r+J[2]):(rr=he[1]+(an+$r-Te.displaySize[1])/2,dr=rr+Te.displaySize[1]),{image:Te,top:rr,right:qt,bottom:dr,left:Fr,collisionPadding:Fe}}var Hf=function(E){function C(B,J,he,xe){E.call(this,B,J),this.angle=he,xe!==void 0&&(this.segment=xe)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.clone=function(){return new C(this.x,this.y,this.angle,this.segment)},C}(h);Oe("Anchor",Hf);var Au=128;function gh(E,C){var B=C.expression;if(B.kind==="constant"){var J=B.evaluate(new si(E+1));return{kind:"constant",layoutSize:J}}else{if(B.kind==="source")return{kind:"source"};for(var he=B.zoomStops,xe=B.interpolationType,Te=0;Te<he.length&&he[Te]<=E;)Te++;Te=Math.max(0,Te-1);for(var Fe=Te;Fe<he.length&&he[Fe]<E+1;)Fe++;Fe=Math.min(he.length-1,Fe);var $e=he[Te],ft=he[Fe];if(B.kind==="composite")return{kind:"composite",minZoom:$e,maxZoom:ft,interpolationType:xe};var pt=B.evaluate(new si($e)),Ot=B.evaluate(new si(ft));return{kind:"camera",minZoom:$e,maxZoom:ft,minSize:pt,maxSize:Ot,interpolationType:xe}}}function fv(E,C,B){var J=C.uSize,he=C.uSizeT,xe=B.lowerSize,Te=B.upperSize;return E.kind==="source"?xe/Au:E.kind==="composite"?so(xe/Au,Te/Au,he):J}function cv(E,C){var B=0,J=0;if(E.kind==="constant")J=E.layoutSize;else if(E.kind!=="source"){var he=E.interpolationType,xe=E.minZoom,Te=E.maxZoom,Fe=he?f(lo.interpolationFactor(he,C,xe,Te),0,1):0;E.kind==="camera"?J=so(E.minSize,E.maxSize,Fe):B=Fe}return{uSizeT:B,uSize:J}}var Jd=Object.freeze({__proto__:null,getSizeData:gh,evaluateSizeForFeature:fv,evaluateSizeForZoom:cv,SIZE_PACK_FACTOR:Au});function hv(E,C,B,J,he){if(C.segment===void 0)return!0;for(var xe=C,Te=C.segment+1,Fe=0;Fe>-B/2;){if(Te--,Te<0)return!1;Fe-=E[Te].dist(xe),xe=E[Te]}Fe+=E[Te].dist(E[Te+1]),Te++;for(var $e=[],ft=0;Fe<B/2;){var pt=E[Te-1],Ot=E[Te],rr=E[Te+1];if(!rr)return!1;var qt=pt.angleTo(Ot)-Ot.angleTo(rr);for(qt=Math.abs((qt+3*Math.PI)%(Math.PI*2)-Math.PI),$e.push({distance:Fe,angleDelta:qt}),ft+=qt;Fe-$e[0].distance>J;)ft-=$e.shift().angleDelta;if(ft>he)return!1;Te++,Fe+=Ot.dist(rr)}return!0}function vv(E){for(var C=0,B=0;B<E.length-1;B++)C+=E[B].dist(E[B+1]);return C}function pv(E,C,B){return E?3/5*C*B:0}function dv(E,C){return Math.max(E?E.right-E.left:0,C?C.right-C.left:0)}function Qd(E,C,B,J,he,xe){for(var Te=pv(B,he,xe),Fe=dv(B,J)*xe,$e=0,ft=vv(E)/2,pt=0;pt<E.length-1;pt++){var Ot=E[pt],rr=E[pt+1],qt=Ot.dist(rr);if($e+qt>ft){var dr=(ft-$e)/qt,Fr=so(Ot.x,rr.x,dr),an=so(Ot.y,rr.y,dr),$r=new Hf(Fr,an,rr.angleTo(Ot),pt);return $r._round(),!Te||hv(E,$r,Fe,Te,C)?$r:void 0}$e+=qt}}function $d(E,C,B,J,he,xe,Te,Fe,$e){var ft=pv(J,xe,Te),pt=dv(J,he),Ot=pt*Te,rr=E[0].x===0||E[0].x===$e||E[0].y===0||E[0].y===$e;C-Ot<C/4&&(C=Ot+C/4);var qt=xe*2,dr=rr?C/2*Fe%C:(pt/2+qt)*Te*Fe%C;return gv(E,dr,C,ft,B,Ot,rr,!1,$e)}function gv(E,C,B,J,he,xe,Te,Fe,$e){for(var ft=xe/2,pt=vv(E),Ot=0,rr=C-B,qt=[],dr=0;dr<E.length-1;dr++){for(var Fr=E[dr],an=E[dr+1],$r=Fr.dist(an),kn=an.angleTo(Fr);rr+B<Ot+$r;){rr+=B;var mn=(rr-Ot)/$r,Sn=so(Fr.x,an.x,mn),In=so(Fr.y,an.y,mn);if(Sn>=0&&Sn<$e&&In>=0&&In<$e&&rr-ft>=0&&rr+ft<=pt){var Gn=new Hf(Sn,In,kn,dr);Gn._round(),(!J||hv(E,Gn,xe,J,he))&&qt.push(Gn)}}Ot+=$r}return!Fe&&!qt.length&&!Te&&(qt=gv(E,Ot/2,B,J,he,xe,Te,!0,$e)),qt}function yv(E,C,B,J,he){for(var xe=[],Te=0;Te<E.length;Te++)for(var Fe=E[Te],$e=void 0,ft=0;ft<Fe.length-1;ft++){var pt=Fe[ft],Ot=Fe[ft+1];pt.x<C&&Ot.x<C||(pt.x<C?pt=new h(C,pt.y+(Ot.y-pt.y)*((C-pt.x)/(Ot.x-pt.x)))._round():Ot.x<C&&(Ot=new h(C,pt.y+(Ot.y-pt.y)*((C-pt.x)/(Ot.x-pt.x)))._round()),!(pt.y<B&&Ot.y<B)&&(pt.y<B?pt=new h(pt.x+(Ot.x-pt.x)*((B-pt.y)/(Ot.y-pt.y)),B)._round():Ot.y<B&&(Ot=new h(pt.x+(Ot.x-pt.x)*((B-pt.y)/(Ot.y-pt.y)),B)._round()),!(pt.x>=J&&Ot.x>=J)&&(pt.x>=J?pt=new h(J,pt.y+(Ot.y-pt.y)*((J-pt.x)/(Ot.x-pt.x)))._round():Ot.x>=J&&(Ot=new h(J,pt.y+(Ot.y-pt.y)*((J-pt.x)/(Ot.x-pt.x)))._round()),!(pt.y>=he&&Ot.y>=he)&&(pt.y>=he?pt=new h(pt.x+(Ot.x-pt.x)*((he-pt.y)/(Ot.y-pt.y)),he)._round():Ot.y>=he&&(Ot=new h(pt.x+(Ot.x-pt.x)*((he-pt.y)/(Ot.y-pt.y)),he)._round()),(!$e||!pt.equals($e[$e.length-1]))&&($e=[pt],xe.push($e)),$e.push(Ot)))))}return xe}var Vf=hl;function mv(E,C,B,J){var he=[],xe=E.image,Te=xe.pixelRatio,Fe=xe.paddedRect.w-2*Vf,$e=xe.paddedRect.h-2*Vf,ft=E.right-E.left,pt=E.bottom-E.top,Ot=xe.stretchX||[[0,Fe]],rr=xe.stretchY||[[0,$e]],qt=function(Ci,Ti){return Ci+Ti[1]-Ti[0]},dr=Ot.reduce(qt,0),Fr=rr.reduce(qt,0),an=Fe-dr,$r=$e-Fr,kn=0,mn=dr,Sn=0,In=Fr,Gn=0,oa=an,na=0,Ra=$r;if(xe.content&&J){var wa=xe.content;kn=Oc(Ot,0,wa[0]),Sn=Oc(rr,0,wa[1]),mn=Oc(Ot,wa[0],wa[2]),In=Oc(rr,wa[1],wa[3]),Gn=wa[0]-kn,na=wa[1]-Sn,oa=wa[2]-wa[0]-mn,Ra=wa[3]-wa[1]-In}var Sa=function(Ci,Ti,$i,ro){var To=Bc(Ci.stretch-kn,mn,ft,E.left),Lo=Nc(Ci.fixed-Gn,oa,Ci.stretch,dr),qo=Bc(Ti.stretch-Sn,In,pt,E.top),Vo=Nc(Ti.fixed-na,Ra,Ti.stretch,Fr),Ls=Bc($i.stretch-kn,mn,ft,E.left),Ps=Nc($i.fixed-Gn,oa,$i.stretch,dr),es=Bc(ro.stretch-Sn,In,pt,E.top),Ns=Nc(ro.fixed-na,Ra,ro.stretch,Fr),Us=new h(To,qo),Zo=new h(Ls,qo),Hs=new h(Ls,es),Cl=new h(To,es),Qu=new h(Lo/Te,Vo/Te),ff=new h(Ps/Te,Ns/Te),cf=C*Math.PI/180;if(cf){var hf=Math.sin(cf),Jf=Math.cos(cf),nu=[Jf,-hf,hf,Jf];Us._matMult(nu),Zo._matMult(nu),Cl._matMult(nu),Hs._matMult(nu)}var Wc=Ci.stretch+Ci.fixed,Ah=$i.stretch+$i.fixed,Xc=Ti.stretch+Ti.fixed,Mh=ro.stretch+ro.fixed,Gl={x:xe.paddedRect.x+Vf+Wc,y:xe.paddedRect.y+Vf+Xc,w:Ah-Wc,h:Mh-Xc},Qf=oa/Te/ft,Zc=Ra/Te/pt;return{tl:Us,tr:Zo,bl:Cl,br:Hs,tex:Gl,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Qu,pixelOffsetBR:ff,minFontScaleX:Qf,minFontScaleY:Zc,isSDF:B}};if(!J||!xe.stretchX&&!xe.stretchY)he.push(Sa({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Fe+1},{fixed:0,stretch:$e+1}));else for(var ti=xv(Ot,an,dr),La=xv(rr,$r,Fr),Da=0;Da<ti.length-1;Da++)for(var fi=ti[Da],qa=ti[Da+1],ki=0;ki<La.length-1;ki++){var Wi=La[ki],Ei=La[ki+1];he.push(Sa(fi,Wi,qa,Ei))}return he}function Oc(E,C,B){for(var J=0,he=0,xe=E;he<xe.length;he+=1){var Te=xe[he];J+=Math.max(C,Math.min(B,Te[1]))-Math.max(C,Math.min(B,Te[0]))}return J}function xv(E,C,B){for(var J=[{fixed:-Vf,stretch:0}],he=0,xe=E;he<xe.length;he+=1){var Te=xe[he],Fe=Te[0],$e=Te[1],ft=J[J.length-1];J.push({fixed:Fe-ft.stretch,stretch:ft.stretch}),J.push({fixed:Fe-ft.stretch,stretch:ft.stretch+($e-Fe)})}return J.push({fixed:C+Vf,stretch:B}),J}function Bc(E,C,B,J){return E/C*B+J}function Nc(E,C,B,J){return E-C*B/J}function qd(E,C,B,J,he,xe,Te,Fe){for(var $e=J.layout.get("text-rotate").evaluate(xe,{})*Math.PI/180,ft=[],pt=0,Ot=C.positionedLines;pt<Ot.length;pt+=1)for(var rr=Ot[pt],qt=0,dr=rr.positionedGlyphs;qt<dr.length;qt+=1){var Fr=dr[qt];if(Fr.rect){var an=Fr.rect||{},$r=1,kn=tv+$r,mn=!0,Sn=1,In=0,Gn=(he||Fe)&&Fr.vertical,oa=Fr.metrics.advance*Fr.scale/2;if(Fe&&C.verticalizable){var na=(Fr.scale-1)*hs,Ra=(hs-Fr.metrics.width*Fr.scale)/2;In=rr.lineOffset/2-(Fr.imageName?-Ra:na)}if(Fr.imageName){var wa=Te[Fr.imageName];mn=wa.sdf,Sn=wa.pixelRatio,kn=hl/Sn}var Sa=he?[Fr.x+oa,Fr.y]:[0,0],ti=he?[0,0]:[Fr.x+oa+B[0],Fr.y+B[1]-In],La=[0,0];Gn&&(La=ti,ti=[0,0]);var Da=(Fr.metrics.left-kn)*Fr.scale-oa+ti[0],fi=(-Fr.metrics.top-kn)*Fr.scale+ti[1],qa=Da+an.w*Fr.scale/Sn,ki=fi+an.h*Fr.scale/Sn,Wi=new h(Da,fi),Ei=new h(qa,fi),Ci=new h(Da,ki),Ti=new h(qa,ki);if(Gn){var $i=new h(-oa,oa-dc),ro=-Math.PI/2,To=hs/2-oa,Lo=Fr.imageName?To:0,qo=new h(5-dc-To,-Lo),Vo=new(Function.prototype.bind.apply(h,[null].concat(La)));Wi._rotateAround(ro,$i)._add(qo)._add(Vo),Ei._rotateAround(ro,$i)._add(qo)._add(Vo),Ci._rotateAround(ro,$i)._add(qo)._add(Vo),Ti._rotateAround(ro,$i)._add(qo)._add(Vo)}if($e){var Ls=Math.sin($e),Ps=Math.cos($e),es=[Ps,-Ls,Ls,Ps];Wi._matMult(es),Ei._matMult(es),Ci._matMult(es),Ti._matMult(es)}var Ns=new h(0,0),Us=new h(0,0),Zo=0,Hs=0;ft.push({tl:Wi,tr:Ei,bl:Ci,br:Ti,tex:an,writingMode:C.writingMode,glyphOffset:Sa,sectionIndex:Fr.sectionIndex,isSDF:mn,pixelOffsetTL:Ns,pixelOffsetBR:Us,minFontScaleX:Zo,minFontScaleY:Hs})}}return ft}var Uc=function(C,B,J,he,xe,Te,Fe,$e,ft,pt){if(this.boxStartIndex=C.length,ft){var Ot=Te.top,rr=Te.bottom,qt=Te.collisionPadding;qt&&(Ot-=qt[1],rr+=qt[3]);var dr=rr-Ot;dr>0&&(dr=Math.max(10,dr),this.circleDiameter=dr)}else{var Fr=Te.top*Fe-$e,an=Te.bottom*Fe+$e,$r=Te.left*Fe-$e,kn=Te.right*Fe+$e,mn=Te.collisionPadding;if(mn&&($r-=mn[0]*Fe,Fr-=mn[1]*Fe,kn+=mn[2]*Fe,an+=mn[3]*Fe),pt){var Sn=new h($r,Fr),In=new h(kn,Fr),Gn=new h($r,an),oa=new h(kn,an),na=pt*Math.PI/180;Sn._rotate(na),In._rotate(na),Gn._rotate(na),oa._rotate(na),$r=Math.min(Sn.x,In.x,Gn.x,oa.x),kn=Math.max(Sn.x,In.x,Gn.x,oa.x),Fr=Math.min(Sn.y,In.y,Gn.y,oa.y),an=Math.max(Sn.y,In.y,Gn.y,oa.y)}C.emplaceBack(B.x,B.y,$r,Fr,kn,an,J,he,xe)}this.boxEndIndex=C.length},Gf=function(C,B){if(C===void 0&&(C=[]),B===void 0&&(B=e0),this.data=C,this.length=this.data.length,this.compare=B,this.length>0)for(var J=(this.length>>1)-1;J>=0;J--)this._down(J)};Gf.prototype.push=function(C){this.data.push(C),this.length++,this._up(this.length-1)},Gf.prototype.pop=function(){if(this.length!==0){var C=this.data[0],B=this.data.pop();return this.length--,this.length>0&&(this.data[0]=B,this._down(0)),C}},Gf.prototype.peek=function(){return this.data[0]},Gf.prototype._up=function(C){for(var B=this,J=B.data,he=B.compare,xe=J[C];C>0;){var Te=C-1>>1,Fe=J[Te];if(he(xe,Fe)>=0)break;J[C]=Fe,C=Te}J[C]=xe},Gf.prototype._down=function(C){for(var B=this,J=B.data,he=B.compare,xe=this.length>>1,Te=J[C];C<xe;){var Fe=(C<<1)+1,$e=J[Fe],ft=Fe+1;if(ft<this.length&&he(J[ft],$e)<0&&(Fe=ft,$e=J[ft]),he($e,Te)>=0)break;J[C]=$e,C=Fe}J[C]=Te};function e0(E,C){return E<C?-1:E>C?1:0}function t0(E,C,B){C===void 0&&(C=1),B===void 0&&(B=!1);for(var J=1/0,he=1/0,xe=-1/0,Te=-1/0,Fe=E[0],$e=0;$e<Fe.length;$e++){var ft=Fe[$e];(!$e||ft.x<J)&&(J=ft.x),(!$e||ft.y<he)&&(he=ft.y),(!$e||ft.x>xe)&&(xe=ft.x),(!$e||ft.y>Te)&&(Te=ft.y)}var pt=xe-J,Ot=Te-he,rr=Math.min(pt,Ot),qt=rr/2,dr=new Gf([],r0);if(rr===0)return new h(J,he);for(var Fr=J;Fr<xe;Fr+=rr)for(var an=he;an<Te;an+=rr)dr.push(new Yf(Fr+qt,an+qt,qt,E));for(var $r=a0(E),kn=dr.length;dr.length;){var mn=dr.pop();(mn.d>$r.d||!$r.d)&&($r=mn,B&&console.log("found best %d after %d probes",Math.round(1e4*mn.d)/1e4,kn)),!(mn.max-$r.d<=C)&&(qt=mn.h/2,dr.push(new Yf(mn.p.x-qt,mn.p.y-qt,qt,E)),dr.push(new Yf(mn.p.x+qt,mn.p.y-qt,qt,E)),dr.push(new Yf(mn.p.x-qt,mn.p.y+qt,qt,E)),dr.push(new Yf(mn.p.x+qt,mn.p.y+qt,qt,E)),kn+=4)}return B&&(console.log("num probes: "+kn),console.log("best distance: "+$r.d)),$r.p}function r0(E,C){return C.max-E.max}function Yf(E,C,B,J){this.p=new h(E,C),this.h=B,this.d=n0(this.p,J),this.max=this.d+this.h*Math.SQRT2}function n0(E,C){for(var B=!1,J=1/0,he=0;he<C.length;he++)for(var xe=C[he],Te=0,Fe=xe.length,$e=Fe-1;Te<Fe;$e=Te++){var ft=xe[Te],pt=xe[$e];ft.y>E.y!=pt.y>E.y&&E.x<(pt.x-ft.x)*(E.y-ft.y)/(pt.y-ft.y)+ft.x&&(B=!B),J=Math.min(J,_u(E,ft,pt))}return(B?1:-1)*Math.sqrt(J)}function a0(E){for(var C=0,B=0,J=0,he=E[0],xe=0,Te=he.length,Fe=Te-1;xe<Te;Fe=xe++){var $e=he[xe],ft=he[Fe],pt=$e.x*ft.y-ft.x*$e.y;B+=($e.x+ft.x)*pt,J+=($e.y+ft.y)*pt,C+=pt*3}return new Yf(B/C,J/C,0,E)}var Wf=7,yh=Number.POSITIVE_INFINITY;function bv(E,C){function B(he,xe){var Te=0,Fe=0;xe<0&&(xe=0);var $e=xe/Math.sqrt(2);switch(he){case"top-right":case"top-left":Fe=$e-Wf;break;case"bottom-right":case"bottom-left":Fe=-$e+Wf;break;case"bottom":Fe=-xe+Wf;break;case"top":Fe=xe-Wf;break}switch(he){case"top-right":case"bottom-right":Te=-$e;break;case"top-left":case"bottom-left":Te=$e;break;case"left":Te=xe;break;case"right":Te=-xe;break}return[Te,Fe]}function J(he,xe,Te){var Fe=0,$e=0;switch(xe=Math.abs(xe),Te=Math.abs(Te),he){case"top-right":case"top-left":case"top":$e=Te-Wf;break;case"bottom-right":case"bottom-left":case"bottom":$e=-Te+Wf;break}switch(he){case"top-right":case"bottom-right":case"right":Fe=-xe;break;case"top-left":case"bottom-left":case"left":Fe=xe;break}return[Fe,$e]}return C[1]!==yh?J(E,C[0],C[1]):B(E,C[0])}function i0(E,C,B,J,he,xe,Te){E.createArrays();var Fe=512*E.overscaling;E.tilePixelRatio=Ba/Fe,E.compareText={},E.iconsNeedLinear=!1;var $e=E.layers[0].layout,ft=E.layers[0]._unevaluatedLayout._values,pt={};if(E.textSizeData.kind==="composite"){var Ot=E.textSizeData,rr=Ot.minZoom,qt=Ot.maxZoom;pt.compositeTextSizes=[ft["text-size"].possiblyEvaluate(new si(rr),Te),ft["text-size"].possiblyEvaluate(new si(qt),Te)]}if(E.iconSizeData.kind==="composite"){var dr=E.iconSizeData,Fr=dr.minZoom,an=dr.maxZoom;pt.compositeIconSizes=[ft["icon-size"].possiblyEvaluate(new si(Fr),Te),ft["icon-size"].possiblyEvaluate(new si(an),Te)]}pt.layoutTextSize=ft["text-size"].possiblyEvaluate(new si(E.zoom+1),Te),pt.layoutIconSize=ft["icon-size"].possiblyEvaluate(new si(E.zoom+1),Te),pt.textMaxSize=ft["text-size"].possiblyEvaluate(new si(18));for(var $r=$e.get("text-line-height")*hs,kn=$e.get("text-rotation-alignment")==="map"&&$e.get("symbol-placement")!=="point",mn=$e.get("text-keep-upright"),Sn=$e.get("text-size"),In=function(){var na=oa[Gn],Ra=$e.get("text-font").evaluate(na,{},Te).join(","),wa=Sn.evaluate(na,{},Te),Sa=pt.layoutTextSize.evaluate(na,{},Te),ti=pt.layoutIconSize.evaluate(na,{},Te),La={horizontal:{},vertical:void 0},Da=na.text,fi=[0,0];if(Da){var qa=Da.toString(),ki=$e.get("text-letter-spacing").evaluate(na,{},Te)*hs,Wi=Qr(qa)?ki:0,Ei=$e.get("text-anchor").evaluate(na,{},Te),Ci=$e.get("text-variable-anchor");if(!Ci){var Ti=$e.get("text-radial-offset").evaluate(na,{},Te);Ti?fi=bv(Ei,[Ti*hs,yh]):fi=$e.get("text-offset").evaluate(na,{},Te).map(function(Qu){return Qu*hs})}var $i=kn?"center":$e.get("text-justify").evaluate(na,{},Te),ro=$e.get("symbol-placement"),To=ro==="point"?$e.get("text-max-width").evaluate(na,{},Te)*hs:0,Lo=function(){E.allowVerticalPlacement&&Ar(qa)&&(La.vertical=Fc(Da,C,B,he,Ra,To,$r,Ei,"left",Wi,fi,El.vertical,!0,ro,Sa,wa))};if(!kn&&Ci){for(var qo=$i==="auto"?Ci.map(function(Qu){return mh(Qu)}):[$i],Vo=!1,Ls=0;Ls<qo.length;Ls++){var Ps=qo[Ls];if(!La.horizontal[Ps])if(Vo)La.horizontal[Ps]=La.horizontal[0];else{var es=Fc(Da,C,B,he,Ra,To,$r,"center",Ps,Wi,fi,El.horizontal,!1,ro,Sa,wa);es&&(La.horizontal[Ps]=es,Vo=es.positionedLines.length===1)}}Lo()}else{$i==="auto"&&($i=mh(Ei));var Ns=Fc(Da,C,B,he,Ra,To,$r,Ei,$i,Wi,fi,El.horizontal,!1,ro,Sa,wa);Ns&&(La.horizontal[$i]=Ns),Lo(),Ar(qa)&&kn&&mn&&(La.vertical=Fc(Da,C,B,he,Ra,To,$r,Ei,$i,Wi,fi,El.vertical,!1,ro,Sa,wa))}}var Us=void 0,Zo=!1;if(na.icon&&na.icon.name){var Hs=J[na.icon.name];Hs&&(Us=Kd(he[na.icon.name],$e.get("icon-offset").evaluate(na,{},Te),$e.get("icon-anchor").evaluate(na,{},Te)),Zo=Hs.sdf,E.sdfIcons===void 0?E.sdfIcons=Hs.sdf:E.sdfIcons!==Hs.sdf&&O("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Hs.pixelRatio!==E.pixelRatio||$e.get("icon-rotate").constantOr(1)!==0)&&(E.iconsNeedLinear=!0))}var Cl=wv(La.horizontal)||La.vertical;E.iconsInText=Cl?Cl.iconsInText:!1,(Cl||Us)&&o0(E,na,La,Us,J,pt,Sa,ti,fi,Zo,Te)},Gn=0,oa=E.features;Gn<oa.length;Gn+=1)In();xe&&E.generateCollisionDebugBuffers()}function mh(E){switch(E){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function o0(E,C,B,J,he,xe,Te,Fe,$e,ft,pt){var Ot=xe.textMaxSize.evaluate(C,{});Ot===void 0&&(Ot=Te);var rr=E.layers[0].layout,qt=rr.get("icon-offset").evaluate(C,{},pt),dr=wv(B.horizontal),Fr=24,an=Te/Fr,$r=E.tilePixelRatio*an,kn=E.tilePixelRatio*Ot/Fr,mn=E.tilePixelRatio*Fe,Sn=E.tilePixelRatio*rr.get("symbol-spacing"),In=rr.get("text-padding")*E.tilePixelRatio,Gn=rr.get("icon-padding")*E.tilePixelRatio,oa=rr.get("text-max-angle")/180*Math.PI,na=rr.get("text-rotation-alignment")==="map"&&rr.get("symbol-placement")!=="point",Ra=rr.get("icon-rotation-alignment")==="map"&&rr.get("symbol-placement")!=="point",wa=rr.get("symbol-placement"),Sa=Sn/2,ti=rr.get("icon-text-fit"),La;J&&ti!=="none"&&(E.allowVerticalPlacement&&B.vertical&&(La=uv(J,B.vertical,ti,rr.get("icon-text-fit-padding"),qt,an)),dr&&(J=uv(J,dr,ti,rr.get("icon-text-fit-padding"),qt,an)));var Da=function(Jf,nu){nu.x<0||nu.x>=Ba||nu.y<0||nu.y>=Ba||s0(E,nu,Jf,B,J,he,La,E.layers[0],E.collisionBoxArray,C.index,C.sourceLayerIndex,E.index,$r,In,na,$e,mn,Gn,Ra,qt,C,xe,ft,pt,Te)};if(wa==="line")for(var fi=0,qa=yv(C.geometry,0,0,Ba,Ba);fi<qa.length;fi+=1)for(var ki=qa[fi],Wi=$d(ki,Sn,oa,B.vertical||dr,J,Fr,kn,E.overscaling,Ba),Ei=0,Ci=Wi;Ei<Ci.length;Ei+=1){var Ti=Ci[Ei],$i=dr;(!$i||!l0(E,$i.text,Sa,Ti))&&Da(ki,Ti)}else if(wa==="line-center")for(var ro=0,To=C.geometry;ro<To.length;ro+=1){var Lo=To[ro];if(Lo.length>1){var qo=Qd(Lo,oa,B.vertical||dr,J,Fr,kn);qo&&Da(Lo,qo)}}else if(C.type==="Polygon")for(var Vo=0,Ls=sh(C.geometry,0);Vo<Ls.length;Vo+=1){var Ps=Ls[Vo],es=t0(Ps,16);Da(Ps[0],new Hf(es.x,es.y,0))}else if(C.type==="LineString")for(var Ns=0,Us=C.geometry;Ns<Us.length;Ns+=1){var Zo=Us[Ns];Da(Zo,new Hf(Zo[0].x,Zo[0].y,0))}else if(C.type==="Point")for(var Hs=0,Cl=C.geometry;Hs<Cl.length;Hs+=1)for(var Qu=Cl[Hs],ff=0,cf=Qu;ff<cf.length;ff+=1){var hf=cf[ff];Da([hf],new Hf(hf.x,hf.y,0))}}var gc=255,lf=gc*Au;function _v(E,C,B,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr){var Fr=qd(C,B,Fe,he,xe,Te,J,E.allowVerticalPlacement),an=E.textSizeData,$r=null;an.kind==="source"?($r=[Au*he.layout.get("text-size").evaluate(Te,{})],$r[0]>lf&&O(E.layerIds[0]+': Value for "text-size" is >= '+gc+'. Reduce your "text-size".')):an.kind==="composite"&&($r=[Au*qt.compositeTextSizes[0].evaluate(Te,{},dr),Au*qt.compositeTextSizes[1].evaluate(Te,{},dr)],($r[0]>lf||$r[1]>lf)&&O(E.layerIds[0]+': Value for "text-size" is >= '+gc+'. Reduce your "text-size".')),E.addSymbols(E.text,Fr,$r,Fe,xe,Te,ft,C,$e.lineStartIndex,$e.lineLength,rr,dr);for(var kn=0,mn=pt;kn<mn.length;kn+=1){var Sn=mn[kn];Ot[Sn]=E.text.placedSymbolArray.length-1}return Fr.length*4}function wv(E){for(var C in E)return E[C];return null}function s0(E,C,B,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr,qt,dr,Fr,an,$r,kn,mn,Sn,In,Gn,oa,na){var Ra,wa=E.addToLineVertexArray(C,B),Sa,ti,La,Da,fi=0,qa=0,ki=0,Wi=0,Ei=-1,Ci=-1,Ti={},$i=Re(""),ro=0,To=0;if(Fe._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Ra=Fe.layout.get("text-offset").evaluate(Sn,{},oa).map(function(xc){return xc*hs}),ro=Ra[0],To=Ra[1]):(ro=Fe.layout.get("text-radial-offset").evaluate(Sn,{},oa)*hs,To=yh),E.allowVerticalPlacement&&J.vertical){var Lo=Fe.layout.get("text-rotate").evaluate(Sn,{},oa),qo=Lo+90,Vo=J.vertical;La=new Uc($e,C,ft,pt,Ot,Vo,rr,qt,dr,qo),Te&&(Da=new Uc($e,C,ft,pt,Ot,Te,an,$r,dr,qo))}if(he){var Ls=Fe.layout.get("icon-rotate").evaluate(Sn,{}),Ps=Fe.layout.get("icon-text-fit")!=="none",es=mv(he,Ls,Gn,Ps),Ns=Te?mv(Te,Ls,Gn,Ps):void 0;ti=new Uc($e,C,ft,pt,Ot,he,an,$r,!1,Ls),fi=es.length*4;var Us=E.iconSizeData,Zo=null;Us.kind==="source"?(Zo=[Au*Fe.layout.get("icon-size").evaluate(Sn,{})],Zo[0]>lf&&O(E.layerIds[0]+': Value for "icon-size" is >= '+gc+'. Reduce your "icon-size".')):Us.kind==="composite"&&(Zo=[Au*In.compositeIconSizes[0].evaluate(Sn,{},oa),Au*In.compositeIconSizes[1].evaluate(Sn,{},oa)],(Zo[0]>lf||Zo[1]>lf)&&O(E.layerIds[0]+': Value for "icon-size" is >= '+gc+'. Reduce your "icon-size".')),E.addSymbols(E.icon,es,Zo,mn,kn,Sn,!1,C,wa.lineStartIndex,wa.lineLength,-1,oa),Ei=E.icon.placedSymbolArray.length-1,Ns&&(qa=Ns.length*4,E.addSymbols(E.icon,Ns,Zo,mn,kn,Sn,El.vertical,C,wa.lineStartIndex,wa.lineLength,-1,oa),Ci=E.icon.placedSymbolArray.length-1)}for(var Hs in J.horizontal){var Cl=J.horizontal[Hs];if(!Sa){$i=Re(Cl.text);var Qu=Fe.layout.get("text-rotate").evaluate(Sn,{},oa);Sa=new Uc($e,C,ft,pt,Ot,Cl,rr,qt,dr,Qu)}var ff=Cl.positionedLines.length===1;if(ki+=_v(E,C,Cl,xe,Fe,dr,Sn,Fr,wa,J.vertical?El.horizontal:El.horizontalOnly,ff?Object.keys(J.horizontal):[Hs],Ti,Ei,In,oa),ff)break}J.vertical&&(Wi+=_v(E,C,J.vertical,xe,Fe,dr,Sn,Fr,wa,El.vertical,["vertical"],Ti,Ci,In,oa));var cf=Sa?Sa.boxStartIndex:E.collisionBoxArray.length,hf=Sa?Sa.boxEndIndex:E.collisionBoxArray.length,Jf=La?La.boxStartIndex:E.collisionBoxArray.length,nu=La?La.boxEndIndex:E.collisionBoxArray.length,Wc=ti?ti.boxStartIndex:E.collisionBoxArray.length,Ah=ti?ti.boxEndIndex:E.collisionBoxArray.length,Xc=Da?Da.boxStartIndex:E.collisionBoxArray.length,Mh=Da?Da.boxEndIndex:E.collisionBoxArray.length,Gl=-1,Qf=function(xc,Bv){return xc&&xc.circleDiameter?Math.max(xc.circleDiameter,Bv):Bv};Gl=Qf(Sa,Gl),Gl=Qf(La,Gl),Gl=Qf(ti,Gl),Gl=Qf(Da,Gl);var Zc=Gl>-1?1:0;Zc&&(Gl*=na/hs),E.glyphOffsetArray.length>=Yi.MAX_GLYPHS&&O("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Sn.sortKey!==void 0&&E.addToSortKeyRanges(E.symbolInstances.length,Sn.sortKey),E.symbolInstances.emplaceBack(C.x,C.y,Ti.right>=0?Ti.right:-1,Ti.center>=0?Ti.center:-1,Ti.left>=0?Ti.left:-1,Ti.vertical||-1,Ei,Ci,$i,cf,hf,Jf,nu,Wc,Ah,Xc,Mh,ft,ki,Wi,fi,qa,Zc,0,rr,ro,To,Gl)}function l0(E,C,B,J){var he=E.compareText;if(!(C in he))he[C]=[];else for(var xe=he[C],Te=xe.length-1;Te>=0;Te--)if(J.dist(xe[Te])<B)return!0;return he[C].push(J),!1}var u0=Of.VectorTileFeature.types,f0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Hc(E,C,B,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr){var qt=Fe?Math.min(lf,Math.round(Fe[0])):0,dr=Fe?Math.min(lf,Math.round(Fe[1])):0;E.emplaceBack(C,B,Math.round(J*32),Math.round(he*32),xe,Te,(qt<<1)+($e?1:0),dr,ft*16,pt*16,Ot*256,rr*256)}function xh(E,C,B){E.emplaceBack(C.x,C.y,B),E.emplaceBack(C.x,C.y,B),E.emplaceBack(C.x,C.y,B),E.emplaceBack(C.x,C.y,B)}function c0(E){for(var C=0,B=E.sections;C<B.length;C+=1){var J=B[C];if(ra(J.text))return!0}return!1}var Xf=function(C){this.layoutVertexArray=new Bu,this.indexArray=new bu,this.programConfigurations=C,this.segments=new V,this.dynamicLayoutVertexArray=new $f,this.opacityVertexArray=new qf,this.placedSymbolArray=new nf};Xf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Xf.prototype.upload=function(C,B,J,he){this.isEmpty()||(J&&(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,ch.members),this.indexBuffer=C.createIndexBuffer(this.indexArray,B),this.dynamicLayoutVertexBuffer=C.createVertexBuffer(this.dynamicLayoutVertexArray,hd.members,!0),this.opacityVertexBuffer=C.createVertexBuffer(this.opacityVertexArray,f0,!0),this.opacityVertexBuffer.itemSize=1),(J||he)&&this.programConfigurations.upload(C))},Xf.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Oe("SymbolBuffers",Xf);var yc=function(C,B,J){this.layoutVertexArray=new C,this.layoutAttributes=B,this.indexArray=new J,this.segments=new V,this.collisionVertexArray=new Qs};yc.prototype.upload=function(C){this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=C.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=C.createVertexBuffer(this.collisionVertexArray,vd.members,!0)},yc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Oe("CollisionBuffers",yc);var Yi=function(C){this.collisionBoxArray=C.collisionBoxArray,this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function($e){return $e.id}),this.index=C.index,this.pixelRatio=C.pixelRatio,this.sourceLayerIndex=C.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Df([]),this.placementViewportMatrix=Df([]);var B=this.layers[0],J=B._unevaluatedLayout._values;this.textSizeData=gh(this.zoom,J["text-size"]),this.iconSizeData=gh(this.zoom,J["icon-size"]);var he=this.layers[0].layout,xe=he.get("symbol-sort-key"),Te=he.get("symbol-z-order");this.sortFeaturesByKey=Te!=="viewport-y"&&xe.constantOr(1)!==void 0;var Fe=Te==="viewport-y"||Te==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=Fe&&(he.get("text-allow-overlap")||he.get("icon-allow-overlap")||he.get("text-ignore-placement")||he.get("icon-ignore-placement")),he.get("symbol-placement")==="point"&&(this.writingModes=he.get("text-writing-mode").map(function($e){return El[$e]})),this.stateDependentLayerIds=this.layers.filter(function($e){return $e.isStateDependent()}).map(function($e){return $e.id}),this.sourceID=C.sourceID};Yi.prototype.createArrays=function(){this.text=new Xf(new ni(ch.members,this.layers,this.zoom,function(C){return/^text/.test(C)})),this.icon=new Xf(new ni(ch.members,this.layers,this.zoom,function(C){return/^icon/.test(C)})),this.glyphOffsetArray=new Hl,this.lineVertexArray=new Tc,this.symbolInstances=new wc},Yi.prototype.calculateGlyphDependencies=function(C,B,J,he,xe){for(var Te=0;Te<C.length;Te++)if(B[C.charCodeAt(Te)]=!0,(J||he)&&xe){var Fe=hc[C.charAt(Te)];Fe&&(B[Fe.charCodeAt(0)]=!0)}},Yi.prototype.populate=function(C,B,J){var he=this.layers[0],xe=he.layout,Te=xe.get("text-font"),Fe=xe.get("text-field"),$e=xe.get("icon-image"),ft=(Fe.value.kind!=="constant"||Fe.value.value instanceof Ui&&!Fe.value.value.isEmpty()||Fe.value.value.toString().length>0)&&(Te.value.kind!=="constant"||Te.value.value.length>0),pt=$e.value.kind!=="constant"||!!$e.value.value||Object.keys($e.parameters).length>0,Ot=xe.get("symbol-sort-key");if(this.features=[],!(!ft&&!pt)){for(var rr=B.iconDependencies,qt=B.glyphDependencies,dr=B.availableImages,Fr=new si(this.zoom),an=0,$r=C;an<$r.length;an+=1){var kn=$r[an],mn=kn.feature,Sn=kn.id,In=kn.index,Gn=kn.sourceLayerIndex,oa=he._featureFilter.needGeometry,na={type:mn.type,id:Sn,properties:mn.properties,geometry:oa?Ni(mn):[]};if(he._featureFilter.filter(Fr,na,J)){oa||(na.geometry=Ni(mn));var Ra=void 0;if(ft){var wa=he.getValueAndResolveTokens("text-field",na,J,dr),Sa=Ui.factory(wa);c0(Sa)&&(this.hasRTLText=!0),(!this.hasRTLText||co()==="unavailable"||this.hasRTLText&&Xa.isParsed())&&(Ra=gd(Sa,he,na))}var ti=void 0;if(pt){var La=he.getValueAndResolveTokens("icon-image",na,J,dr);La instanceof Mo?ti=La:ti=Mo.fromString(La)}if(!(!Ra&&!ti)){var Da=this.sortFeaturesByKey?Ot.evaluate(na,{},J):void 0,fi={id:Sn,text:Ra,icon:ti,index:In,sourceLayerIndex:Gn,geometry:Ni(mn),properties:mn.properties,type:u0[mn.type],sortKey:Da};if(this.features.push(fi),ti&&(rr[ti.name]=!0),Ra){var qa=Te.evaluate(na,{},J).join(","),ki=xe.get("text-rotation-alignment")==="map"&&xe.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(El.vertical)>=0;for(var Wi=0,Ei=Ra.sections;Wi<Ei.length;Wi+=1){var Ci=Ei[Wi];if(Ci.image)rr[Ci.image.name]=!0;else{var Ti=Ar(Ra.toString()),$i=Ci.fontStack||qa,ro=qt[$i]=qt[$i]||{};this.calculateGlyphDependencies(Ci.text,ro,ki,this.allowVerticalPlacement,Ti)}}}}}}xe.get("symbol-placement")==="line"&&(this.features=yd(this.features)),this.sortFeaturesByKey&&this.features.sort(function(To,Lo){return To.sortKey-Lo.sortKey})}},Yi.prototype.update=function(C,B,J){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(C,B,this.layers,J),this.icon.programConfigurations.updatePaintArrays(C,B,this.layers,J))},Yi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Yi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Yi.prototype.upload=function(C){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(C),this.iconCollisionBox.upload(C)),this.text.upload(C,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(C,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Yi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Yi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Yi.prototype.addToLineVertexArray=function(C,B){var J=this.lineVertexArray.length;if(C.segment!==void 0){for(var he=C.dist(B[C.segment+1]),xe=C.dist(B[C.segment]),Te={},Fe=C.segment+1;Fe<B.length;Fe++)Te[Fe]={x:B[Fe].x,y:B[Fe].y,tileUnitDistanceFromAnchor:he},Fe<B.length-1&&(he+=B[Fe+1].dist(B[Fe]));for(var $e=C.segment||0;$e>=0;$e--)Te[$e]={x:B[$e].x,y:B[$e].y,tileUnitDistanceFromAnchor:xe},$e>0&&(xe+=B[$e-1].dist(B[$e]));for(var ft=0;ft<B.length;ft++){var pt=Te[ft];this.lineVertexArray.emplaceBack(pt.x,pt.y,pt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:J,lineLength:this.lineVertexArray.length-J}},Yi.prototype.addSymbols=function(C,B,J,he,xe,Te,Fe,$e,ft,pt,Ot,rr){for(var qt=C.indexArray,dr=C.layoutVertexArray,Fr=C.segments.prepareSegment(4*B.length,dr,qt,Te.sortKey),an=this.glyphOffsetArray.length,$r=Fr.vertexLength,kn=this.allowVerticalPlacement&&Fe===El.vertical?Math.PI/2:0,mn=Te.text&&Te.text.sections,Sn=0;Sn<B.length;Sn++){var In=B[Sn],Gn=In.tl,oa=In.tr,na=In.bl,Ra=In.br,wa=In.tex,Sa=In.pixelOffsetTL,ti=In.pixelOffsetBR,La=In.minFontScaleX,Da=In.minFontScaleY,fi=In.glyphOffset,qa=In.isSDF,ki=In.sectionIndex,Wi=Fr.vertexLength,Ei=fi[1];Hc(dr,$e.x,$e.y,Gn.x,Ei+Gn.y,wa.x,wa.y,J,qa,Sa.x,Sa.y,La,Da),Hc(dr,$e.x,$e.y,oa.x,Ei+oa.y,wa.x+wa.w,wa.y,J,qa,ti.x,Sa.y,La,Da),Hc(dr,$e.x,$e.y,na.x,Ei+na.y,wa.x,wa.y+wa.h,J,qa,Sa.x,ti.y,La,Da),Hc(dr,$e.x,$e.y,Ra.x,Ei+Ra.y,wa.x+wa.w,wa.y+wa.h,J,qa,ti.x,ti.y,La,Da),xh(C.dynamicLayoutVertexArray,$e,kn),qt.emplaceBack(Wi,Wi+1,Wi+2),qt.emplaceBack(Wi+1,Wi+2,Wi+3),Fr.vertexLength+=4,Fr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fi[0]),(Sn===B.length-1||ki!==B[Sn+1].sectionIndex)&&C.programConfigurations.populatePaintArrays(dr.length,Te,Te.index,{},rr,mn&&mn[ki])}C.placedSymbolArray.emplaceBack($e.x,$e.y,an,this.glyphOffsetArray.length-an,$r,ft,pt,$e.segment,J?J[0]:0,J?J[1]:0,he[0],he[1],Fe,0,!1,0,Ot)},Yi.prototype._addCollisionDebugVertex=function(C,B,J,he,xe,Te){return B.emplaceBack(0,0),C.emplaceBack(J.x,J.y,he,xe,Math.round(Te.x),Math.round(Te.y))},Yi.prototype.addCollisionDebugVertices=function(C,B,J,he,xe,Te,Fe){var $e=xe.segments.prepareSegment(4,xe.layoutVertexArray,xe.indexArray),ft=$e.vertexLength,pt=xe.layoutVertexArray,Ot=xe.collisionVertexArray,rr=Fe.anchorX,qt=Fe.anchorY;this._addCollisionDebugVertex(pt,Ot,Te,rr,qt,new h(C,B)),this._addCollisionDebugVertex(pt,Ot,Te,rr,qt,new h(J,B)),this._addCollisionDebugVertex(pt,Ot,Te,rr,qt,new h(J,he)),this._addCollisionDebugVertex(pt,Ot,Te,rr,qt,new h(C,he)),$e.vertexLength+=4;var dr=xe.indexArray;dr.emplaceBack(ft,ft+1),dr.emplaceBack(ft+1,ft+2),dr.emplaceBack(ft+2,ft+3),dr.emplaceBack(ft+3,ft),$e.primitiveLength+=4},Yi.prototype.addDebugCollisionBoxes=function(C,B,J,he){for(var xe=C;xe<B;xe++){var Te=this.collisionBoxArray.get(xe),Fe=Te.x1,$e=Te.y1,ft=Te.x2,pt=Te.y2;this.addCollisionDebugVertices(Fe,$e,ft,pt,he?this.textCollisionBox:this.iconCollisionBox,Te.anchorPoint,J)}},Yi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new yc(kf,Jh.members,yf),this.iconCollisionBox=new yc(kf,Jh.members,yf);for(var C=0;C<this.symbolInstances.length;C++){var B=this.symbolInstances.get(C);this.addDebugCollisionBoxes(B.textBoxStartIndex,B.textBoxEndIndex,B,!0),this.addDebugCollisionBoxes(B.verticalTextBoxStartIndex,B.verticalTextBoxEndIndex,B,!0),this.addDebugCollisionBoxes(B.iconBoxStartIndex,B.iconBoxEndIndex,B,!1),this.addDebugCollisionBoxes(B.verticalIconBoxStartIndex,B.verticalIconBoxEndIndex,B,!1)}},Yi.prototype._deserializeCollisionBoxesForSymbol=function(C,B,J,he,xe,Te,Fe,$e,ft){for(var pt={},Ot=B;Ot<J;Ot++){var rr=C.get(Ot);pt.textBox={x1:rr.x1,y1:rr.y1,x2:rr.x2,y2:rr.y2,anchorPointX:rr.anchorPointX,anchorPointY:rr.anchorPointY},pt.textFeatureIndex=rr.featureIndex;break}for(var qt=he;qt<xe;qt++){var dr=C.get(qt);pt.verticalTextBox={x1:dr.x1,y1:dr.y1,x2:dr.x2,y2:dr.y2,anchorPointX:dr.anchorPointX,anchorPointY:dr.anchorPointY},pt.verticalTextFeatureIndex=dr.featureIndex;break}for(var Fr=Te;Fr<Fe;Fr++){var an=C.get(Fr);pt.iconBox={x1:an.x1,y1:an.y1,x2:an.x2,y2:an.y2,anchorPointX:an.anchorPointX,anchorPointY:an.anchorPointY},pt.iconFeatureIndex=an.featureIndex;break}for(var $r=$e;$r<ft;$r++){var kn=C.get($r);pt.verticalIconBox={x1:kn.x1,y1:kn.y1,x2:kn.x2,y2:kn.y2,anchorPointX:kn.anchorPointX,anchorPointY:kn.anchorPointY},pt.verticalIconFeatureIndex=kn.featureIndex;break}return pt},Yi.prototype.deserializeCollisionBoxes=function(C){this.collisionArrays=[];for(var B=0;B<this.symbolInstances.length;B++){var J=this.symbolInstances.get(B);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(C,J.textBoxStartIndex,J.textBoxEndIndex,J.verticalTextBoxStartIndex,J.verticalTextBoxEndIndex,J.iconBoxStartIndex,J.iconBoxEndIndex,J.verticalIconBoxStartIndex,J.verticalIconBoxEndIndex))}},Yi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Yi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Yi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Yi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Yi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Yi.prototype.addIndicesForPlacedSymbol=function(C,B){for(var J=C.placedSymbolArray.get(B),he=J.vertexStartIndex+J.numGlyphs*4,xe=J.vertexStartIndex;xe<he;xe+=4)C.indexArray.emplaceBack(xe,xe+1,xe+2),C.indexArray.emplaceBack(xe+1,xe+2,xe+3)},Yi.prototype.getSortedSymbolIndexes=function(C){if(this.sortedAngle===C&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var B=Math.sin(C),J=Math.cos(C),he=[],xe=[],Te=[],Fe=0;Fe<this.symbolInstances.length;++Fe){Te.push(Fe);var $e=this.symbolInstances.get(Fe);he.push(Math.round(B*$e.anchorX+J*$e.anchorY)|0),xe.push($e.featureIndex)}return Te.sort(function(ft,pt){return he[ft]-he[pt]||xe[pt]-xe[ft]}),Te},Yi.prototype.addToSortKeyRanges=function(C,B){var J=this.sortKeyRanges[this.sortKeyRanges.length-1];J&&J.sortKey===B?J.symbolInstanceEnd=C+1:this.sortKeyRanges.push({sortKey:B,symbolInstanceStart:C,symbolInstanceEnd:C+1})},Yi.prototype.sortFeatures=function(C){var B=this;if(this.sortFeaturesByY&&this.sortedAngle!==C&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(C),this.sortedAngle=C,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var J=0,he=this.symbolInstanceIndexes;J<he.length;J+=1){var xe=he[J],Te=this.symbolInstances.get(xe);this.featureSortOrder.push(Te.featureIndex),[Te.rightJustifiedTextSymbolIndex,Te.centerJustifiedTextSymbolIndex,Te.leftJustifiedTextSymbolIndex].forEach(function(Fe,$e,ft){Fe>=0&&ft.indexOf(Fe)===$e&&B.addIndicesForPlacedSymbol(B.text,Fe)}),Te.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,Te.verticalPlacedTextSymbolIndex),Te.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Te.placedIconSymbolIndex),Te.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Te.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Oe("SymbolBucket",Yi,{omit:["layers","collisionBoxArray","features","compareText"]}),Yi.MAX_GLYPHS=65535,Yi.addDynamicAttributes=xh;function h0(E,C){return C.replace(/{([^{}]+)}/g,function(B,J){return J in E?String(E[J]):""})}var v0=new Xi({"symbol-placement":new Ia(Ht.layout_symbol["symbol-placement"]),"symbol-spacing":new Ia(Ht.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ia(Ht.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Za(Ht.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ia(Ht.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ia(Ht.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ia(Ht.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ia(Ht.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ia(Ht.layout_symbol["icon-rotation-alignment"]),"icon-size":new Za(Ht.layout_symbol["icon-size"]),"icon-text-fit":new Ia(Ht.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ia(Ht.layout_symbol["icon-text-fit-padding"]),"icon-image":new Za(Ht.layout_symbol["icon-image"]),"icon-rotate":new Za(Ht.layout_symbol["icon-rotate"]),"icon-padding":new Ia(Ht.layout_symbol["icon-padding"]),"icon-keep-upright":new Ia(Ht.layout_symbol["icon-keep-upright"]),"icon-offset":new Za(Ht.layout_symbol["icon-offset"]),"icon-anchor":new Za(Ht.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ia(Ht.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ia(Ht.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ia(Ht.layout_symbol["text-rotation-alignment"]),"text-field":new Za(Ht.layout_symbol["text-field"]),"text-font":new Za(Ht.layout_symbol["text-font"]),"text-size":new Za(Ht.layout_symbol["text-size"]),"text-max-width":new Za(Ht.layout_symbol["text-max-width"]),"text-line-height":new Ia(Ht.layout_symbol["text-line-height"]),"text-letter-spacing":new Za(Ht.layout_symbol["text-letter-spacing"]),"text-justify":new Za(Ht.layout_symbol["text-justify"]),"text-radial-offset":new Za(Ht.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ia(Ht.layout_symbol["text-variable-anchor"]),"text-anchor":new Za(Ht.layout_symbol["text-anchor"]),"text-max-angle":new Ia(Ht.layout_symbol["text-max-angle"]),"text-writing-mode":new Ia(Ht.layout_symbol["text-writing-mode"]),"text-rotate":new Za(Ht.layout_symbol["text-rotate"]),"text-padding":new Ia(Ht.layout_symbol["text-padding"]),"text-keep-upright":new Ia(Ht.layout_symbol["text-keep-upright"]),"text-transform":new Za(Ht.layout_symbol["text-transform"]),"text-offset":new Za(Ht.layout_symbol["text-offset"]),"text-allow-overlap":new Ia(Ht.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ia(Ht.layout_symbol["text-ignore-placement"]),"text-optional":new Ia(Ht.layout_symbol["text-optional"])}),p0=new Xi({"icon-opacity":new Za(Ht.paint_symbol["icon-opacity"]),"icon-color":new Za(Ht.paint_symbol["icon-color"]),"icon-halo-color":new Za(Ht.paint_symbol["icon-halo-color"]),"icon-halo-width":new Za(Ht.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Za(Ht.paint_symbol["icon-halo-blur"]),"icon-translate":new Ia(Ht.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ia(Ht.paint_symbol["icon-translate-anchor"]),"text-opacity":new Za(Ht.paint_symbol["text-opacity"]),"text-color":new Za(Ht.paint_symbol["text-color"],{runtimeType:On,getOverride:function(E){return E.textColor},hasOverride:function(E){return!!E.textColor}}),"text-halo-color":new Za(Ht.paint_symbol["text-halo-color"]),"text-halo-width":new Za(Ht.paint_symbol["text-halo-width"]),"text-halo-blur":new Za(Ht.paint_symbol["text-halo-blur"]),"text-translate":new Ia(Ht.paint_symbol["text-translate"]),"text-translate-anchor":new Ia(Ht.paint_symbol["text-translate-anchor"])}),bh={paint:p0,layout:v0},Zf=function(C){this.type=C.property.overrides?C.property.overrides.runtimeType:yr,this.defaultValue=C};Zf.prototype.evaluate=function(C){if(C.formattedSection){var B=this.defaultValue.property.overrides;if(B&&B.hasOverride(C.formattedSection))return B.getOverride(C.formattedSection)}return C.feature&&C.featureState?this.defaultValue.evaluate(C.feature,C.featureState):this.defaultValue.property.specification.default},Zf.prototype.eachChild=function(C){if(!this.defaultValue.isConstant()){var B=this.defaultValue.value;C(B._styleExpression.expression)}},Zf.prototype.outputDefined=function(){return!1},Zf.prototype.serialize=function(){return null},Oe("FormatSectionOverride",Zf,{omit:["defaultValue"]});var d0=function(E){function C(B){E.call(this,B,bh)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.recalculate=function(J,he){if(E.prototype.recalculate.call(this,J,he),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var xe=this.layout.get("text-writing-mode");if(xe){for(var Te=[],Fe=0,$e=xe;Fe<$e.length;Fe+=1){var ft=$e[Fe];Te.indexOf(ft)<0&&Te.push(ft)}this.layout._values["text-writing-mode"]=Te}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},C.prototype.getValueAndResolveTokens=function(J,he,xe,Te){var Fe=this.layout.get(J).evaluate(he,{},xe,Te),$e=this._unevaluatedLayout._values[J];return!$e.isDataDriven()&&!xo($e.value)&&Fe?h0(he.properties,Fe):Fe},C.prototype.createBucket=function(J){return new Yi(J)},C.prototype.queryRadius=function(){return 0},C.prototype.queryIntersectsFeature=function(){return!1},C.prototype._setPaintOverrides=function(){for(var J=0,he=bh.paint.overridableProperties;J<he.length;J+=1){var xe=he[J];if(C.hasPaintOverride(this.layout,xe)){var Te=this.paint.get(xe),Fe=new Zf(Te),$e=new ls(Fe,Te.property.specification),ft=null;Te.value.kind==="constant"||Te.value.kind==="source"?ft=new Ql("source",$e):ft=new us("composite",$e,Te.value.zoomStops,Te.value._interpolationType),this.paint._values[xe]=new Gi(Te.property,ft,Te.parameters)}}},C.prototype._handleOverridablePaintPropertyUpdate=function(J,he,xe){return!this.layout||he.isDataDriven()||xe.isDataDriven()?!1:C.hasPaintOverride(this.layout,J)},C.hasPaintOverride=function(J,he){var xe=J.get("text-field"),Te=bh.paint.properties[he],Fe=!1,$e=function(Ot){for(var rr=0,qt=Ot;rr<qt.length;rr+=1){var dr=qt[rr];if(Te.overrides&&Te.overrides.hasOverride(dr)){Fe=!0;return}}};if(xe.value.kind==="constant"&&xe.value.value instanceof Ui)$e(xe.value.value.sections);else if(xe.value.kind==="source"){var ft=function(Ot){if(!Fe)if(Ot instanceof Ki&&Di(Ot.value)===da){var rr=Ot.value;$e(rr.sections)}else Ot instanceof ts?$e(Ot.sections):Ot.eachChild(ft)},pt=xe.value;pt._styleExpression&&ft(pt._styleExpression.expression)}return Fe},C}(xs),g0=new Xi({"background-color":new Ia(Ht.paint_background["background-color"]),"background-pattern":new eo(Ht.paint_background["background-pattern"]),"background-opacity":new Ia(Ht.paint_background["background-opacity"])}),y0={paint:g0},m0=function(E){function C(B){E.call(this,B,y0)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(xs),x0=new Xi({"raster-opacity":new Ia(Ht.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ia(Ht.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ia(Ht.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ia(Ht.paint_raster["raster-brightness-max"]),"raster-saturation":new Ia(Ht.paint_raster["raster-saturation"]),"raster-contrast":new Ia(Ht.paint_raster["raster-contrast"]),"raster-resampling":new Ia(Ht.paint_raster["raster-resampling"]),"raster-fade-duration":new Ia(Ht.paint_raster["raster-fade-duration"])}),b0={paint:x0},_0=function(E){function C(B){E.call(this,B,b0)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(xs);function w0(E){var C=[],B=E.id;return B===void 0&&C.push({message:"layers."+B+': missing required property "id"'}),E.render===void 0&&C.push({message:"layers."+B+': missing required method "render"'}),E.renderingMode&&E.renderingMode!=="2d"&&E.renderingMode!=="3d"&&C.push({message:"layers."+B+': property "renderingMode" must be either "2d" or "3d"'}),C}var T0=function(E){function C(B){E.call(this,B,{}),this.implementation=B}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},C.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},C.prototype.recalculate=function(){},C.prototype.updateTransitions=function(){},C.prototype.hasTransition=function(){},C.prototype.serialize=function(){},C.prototype.onAdd=function(J){this.implementation.onAdd&&this.implementation.onAdd(J,J.painter.context.gl)},C.prototype.onRemove=function(J){this.implementation.onRemove&&this.implementation.onRemove(J,J.painter.context.gl)},C}(xs),A0={circle:qv,heatmap:np,hillshade:op,fill:Pp,"fill-extrusion":Qp,line:fd,symbol:d0,background:m0,raster:_0};function M0(E){return E.type==="custom"?new T0(E):new A0[E.type](E)}var Tv=self.HTMLImageElement,Av=self.HTMLCanvasElement,Mv=self.HTMLVideoElement,Sv=self.ImageData,Vc=self.ImageBitmap,wf=function(C,B,J,he){this.context=C,this.format=J,this.texture=C.gl.createTexture(),this.update(B,he)};wf.prototype.update=function(C,B,J){var he=C.width,xe=C.height,Te=(!this.size||this.size[0]!==he||this.size[1]!==xe)&&!J,Fe=this,$e=Fe.context,ft=$e.gl;if(this.useMipmap=!!(B&&B.useMipmap),ft.bindTexture(ft.TEXTURE_2D,this.texture),$e.pixelStoreUnpackFlipY.set(!1),$e.pixelStoreUnpack.set(1),$e.pixelStoreUnpackPremultiplyAlpha.set(this.format===ft.RGBA&&(!B||B.premultiply!==!1)),Te)this.size=[he,xe],C instanceof Tv||C instanceof Av||C instanceof Mv||C instanceof Sv||Vc&&C instanceof Vc?ft.texImage2D(ft.TEXTURE_2D,0,this.format,this.format,ft.UNSIGNED_BYTE,C):ft.texImage2D(ft.TEXTURE_2D,0,this.format,he,xe,0,this.format,ft.UNSIGNED_BYTE,C.data);else{var pt=J||{x:0,y:0},Ot=pt.x,rr=pt.y;C instanceof Tv||C instanceof Av||C instanceof Mv||C instanceof Sv||Vc&&C instanceof Vc?ft.texSubImage2D(ft.TEXTURE_2D,0,Ot,rr,ft.RGBA,ft.UNSIGNED_BYTE,C):ft.texSubImage2D(ft.TEXTURE_2D,0,Ot,rr,he,xe,ft.RGBA,ft.UNSIGNED_BYTE,C.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ft.generateMipmap(ft.TEXTURE_2D)},wf.prototype.bind=function(C,B,J){var he=this,xe=he.context,Te=xe.gl;Te.bindTexture(Te.TEXTURE_2D,this.texture),J===Te.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(J=Te.LINEAR),C!==this.filter&&(Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,C),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,J||C),this.filter=C),B!==this.wrap&&(Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_S,B),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_T,B),this.wrap=B)},wf.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0},wf.prototype.destroy=function(){var C=this.context,B=C.gl;B.deleteTexture(this.texture),this.texture=null};var _h=function(C){var B=this;this._callback=C,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){B._triggered=!1,B._callback()})};_h.prototype.trigger=function(){var C=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){C._triggered=!1,C._callback()},0))},_h.prototype.remove=function(){delete this._channel,this._callback=function(){}};var jf=function(C,B,J){this.target=C,this.parent=B,this.mapId=J,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},T(["receive","process"],this),this.invoker=new _h(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=K()?C:self};jf.prototype.send=function(C,B,J,he,xe){var Te=this;xe===void 0&&(xe=!1);var Fe=Math.round(Math.random()*1e18).toString(36).substring(0,10);J&&(this.callbacks[Fe]=J);var $e=re(this.globalScope)?void 0:[];return this.target.postMessage({id:Fe,type:C,hasCallback:!!J,targetMapId:he,mustQueue:xe,sourceMapId:this.mapId,data:Pt(B,$e)},$e),{cancel:function(){J&&delete Te.callbacks[Fe],Te.target.postMessage({id:Fe,type:"<cancel>",targetMapId:he,sourceMapId:Te.mapId})}}},jf.prototype.receive=function(C){var B=C.data,J=B.id;if(J&&!(B.targetMapId&&this.mapId!==B.targetMapId))if(B.type==="<cancel>"){delete this.tasks[J];var he=this.cancelCallbacks[J];delete this.cancelCallbacks[J],he&&he()}else K()||B.mustQueue?(this.tasks[J]=B,this.taskQueue.push(J),this.invoker.trigger()):this.processTask(J,B)},jf.prototype.process=function(){if(this.taskQueue.length){var C=this.taskQueue.shift(),B=this.tasks[C];delete this.tasks[C],this.taskQueue.length&&this.invoker.trigger(),B&&this.processTask(C,B)}},jf.prototype.processTask=function(C,B){var J=this;if(B.type==="<response>"){var he=this.callbacks[C];delete this.callbacks[C],he&&(B.error?he(jt(B.error)):he(null,jt(B.data)))}else{var xe=!1,Te=re(this.globalScope)?void 0:[],Fe=B.hasCallback?function(rr,qt){xe=!0,delete J.cancelCallbacks[C],J.target.postMessage({id:C,type:"<response>",sourceMapId:J.mapId,error:rr?Pt(rr):null,data:Pt(qt,Te)},Te)}:function(rr){xe=!0},$e=null,ft=jt(B.data);if(this.parent[B.type])$e=this.parent[B.type](B.sourceMapId,ft,Fe);else if(this.parent.getWorkerSource){var pt=B.type.split("."),Ot=this.parent.getWorkerSource(B.sourceMapId,pt[0],ft.source);$e=Ot[pt[1]](ft,Fe)}else Fe(new Error("Could not find function "+B.type));!xe&&$e&&$e.cancel&&(this.cancelCallbacks[C]=$e.cancel)}},jf.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};function S0(E,C,B){C=Math.pow(2,B)-C-1;var J=kv(E*256,C*256,B),he=kv((E+1)*256,(C+1)*256,B);return J[0]+","+J[1]+","+he[0]+","+he[1]}function kv(E,C,B){var J=2*Math.PI*6378137/256/Math.pow(2,B),he=E*J-2*Math.PI*6378137/2,xe=C*J-2*Math.PI*6378137/2;return[he,xe]}var Uo=function(C,B){C&&(B?this.setSouthWest(C).setNorthEast(B):C.length===4?this.setSouthWest([C[0],C[1]]).setNorthEast([C[2],C[3]]):this.setSouthWest(C[0]).setNorthEast(C[1]))};Uo.prototype.setNorthEast=function(C){return this._ne=C instanceof ho?new ho(C.lng,C.lat):ho.convert(C),this},Uo.prototype.setSouthWest=function(C){return this._sw=C instanceof ho?new ho(C.lng,C.lat):ho.convert(C),this},Uo.prototype.extend=function(C){var B=this._sw,J=this._ne,he,xe;if(C instanceof ho)he=C,xe=C;else if(C instanceof Uo){if(he=C._sw,xe=C._ne,!he||!xe)return this}else{if(Array.isArray(C))if(C.length===4||C.every(Array.isArray)){var Te=C;return this.extend(Uo.convert(Te))}else{var Fe=C;return this.extend(ho.convert(Fe))}return this}return!B&&!J?(this._sw=new ho(he.lng,he.lat),this._ne=new ho(xe.lng,xe.lat)):(B.lng=Math.min(he.lng,B.lng),B.lat=Math.min(he.lat,B.lat),J.lng=Math.max(xe.lng,J.lng),J.lat=Math.max(xe.lat,J.lat)),this},Uo.prototype.getCenter=function(){return new ho((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Uo.prototype.getSouthWest=function(){return this._sw},Uo.prototype.getNorthEast=function(){return this._ne},Uo.prototype.getNorthWest=function(){return new ho(this.getWest(),this.getNorth())},Uo.prototype.getSouthEast=function(){return new ho(this.getEast(),this.getSouth())},Uo.prototype.getWest=function(){return this._sw.lng},Uo.prototype.getSouth=function(){return this._sw.lat},Uo.prototype.getEast=function(){return this._ne.lng},Uo.prototype.getNorth=function(){return this._ne.lat},Uo.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Uo.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Uo.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Uo.prototype.contains=function(C){var B=ho.convert(C),J=B.lng,he=B.lat,xe=this._sw.lat<=he&&he<=this._ne.lat,Te=this._sw.lng<=J&&J<=this._ne.lng;return this._sw.lng>this._ne.lng&&(Te=this._sw.lng>=J&&J>=this._ne.lng),xe&&Te},Uo.convert=function(C){return!C||C instanceof Uo?C:new Uo(C)};var Ev=63710088e-1,ho=function(C,B){if(isNaN(C)||isNaN(B))throw new Error("Invalid LngLat object: ("+C+", "+B+")");if(this.lng=+C,this.lat=+B,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ho.prototype.wrap=function(){return new ho(d(this.lng,-180,180),this.lat)},ho.prototype.toArray=function(){return[this.lng,this.lat]},ho.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ho.prototype.distanceTo=function(C){var B=Math.PI/180,J=this.lat*B,he=C.lat*B,xe=Math.sin(J)*Math.sin(he)+Math.cos(J)*Math.cos(he)*Math.cos((C.lng-this.lng)*B),Te=Ev*Math.acos(Math.min(xe,1));return Te},ho.prototype.toBounds=function(C){C===void 0&&(C=0);var B=40075017,J=360*C/B,he=J/Math.cos(Math.PI/180*this.lat);return new Uo(new ho(this.lng-he,this.lat-J),new ho(this.lng+he,this.lat+J))},ho.convert=function(C){if(C instanceof ho)return C;if(Array.isArray(C)&&(C.length===2||C.length===3))return new ho(Number(C[0]),Number(C[1]));if(!Array.isArray(C)&&typeof C=="object"&&C!==null)return new ho(Number("lng"in C?C.lng:C.lon),Number(C.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Cv=2*Math.PI*Ev;function Lv(E){return Cv*Math.cos(E*Math.PI/180)}function Pv(E){return(180+E)/360}function Dv(E){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360}function Rv(E,C){return E/Lv(C)}function k0(E){return E*360-180}function wh(E){var C=180-E*360;return 360/Math.PI*Math.atan(Math.exp(C*Math.PI/180))-90}function E0(E,C){return E*Lv(wh(C))}function C0(E){return 1/Math.cos(E*Math.PI/180)}var Tf=function(C,B,J){J===void 0&&(J=0),this.x=+C,this.y=+B,this.z=+J};Tf.fromLngLat=function(C,B){B===void 0&&(B=0);var J=ho.convert(C);return new Tf(Pv(J.lng),Dv(J.lat),Rv(B,J.lat))},Tf.prototype.toLngLat=function(){return new ho(k0(this.x),wh(this.y))},Tf.prototype.toAltitude=function(){return E0(this.z,this.y)},Tf.prototype.meterInMercatorCoordinateUnits=function(){return 1/Cv*C0(wh(this.y))};var Af=function(C,B,J){this.z=C,this.x=B,this.y=J,this.key=mc(0,C,C,B,J)};Af.prototype.equals=function(C){return this.z===C.z&&this.x===C.x&&this.y===C.y},Af.prototype.url=function(C,B){var J=S0(this.x,this.y,this.z),he=L0(this.z,this.x,this.y);return C[(this.x+this.y)%C.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(B==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",he).replace("{bbox-epsg-3857}",J)},Af.prototype.getTilePoint=function(C){var B=Math.pow(2,this.z);return new h((C.x*B-this.x)*Ba,(C.y*B-this.y)*Ba)},Af.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Iv=function(C,B){this.wrap=C,this.canonical=B,this.key=mc(C,B.z,B.z,B.x,B.y)},Ho=function(C,B,J,he,xe){this.overscaledZ=C,this.wrap=B,this.canonical=new Af(J,+he,+xe),this.key=mc(B,C,J,he,xe)};Ho.prototype.equals=function(C){return this.overscaledZ===C.overscaledZ&&this.wrap===C.wrap&&this.canonical.equals(C.canonical)},Ho.prototype.scaledTo=function(C){var B=this.canonical.z-C;return C>this.canonical.z?new Ho(C,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ho(C,this.wrap,C,this.canonical.x>>B,this.canonical.y>>B)},Ho.prototype.calculateScaledKey=function(C,B){var J=this.canonical.z-C;return C>this.canonical.z?mc(this.wrap*+B,C,this.canonical.z,this.canonical.x,this.canonical.y):mc(this.wrap*+B,C,C,this.canonical.x>>J,this.canonical.y>>J)},Ho.prototype.isChildOf=function(C){if(C.wrap!==this.wrap)return!1;var B=this.canonical.z-C.canonical.z;return C.overscaledZ===0||C.overscaledZ<this.overscaledZ&&C.canonical.x===this.canonical.x>>B&&C.canonical.y===this.canonical.y>>B},Ho.prototype.children=function(C){if(this.overscaledZ>=C)return[new Ho(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var B=this.canonical.z+1,J=this.canonical.x*2,he=this.canonical.y*2;return[new Ho(B,this.wrap,B,J,he),new Ho(B,this.wrap,B,J+1,he),new Ho(B,this.wrap,B,J,he+1),new Ho(B,this.wrap,B,J+1,he+1)]},Ho.prototype.isLessThan=function(C){return this.wrap<C.wrap?!0:this.wrap>C.wrap?!1:this.overscaledZ<C.overscaledZ?!0:this.overscaledZ>C.overscaledZ?!1:this.canonical.x<C.canonical.x?!0:this.canonical.x>C.canonical.x?!1:this.canonical.y<C.canonical.y},Ho.prototype.wrapped=function(){return new Ho(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ho.prototype.unwrapTo=function(C){return new Ho(this.overscaledZ,C,this.canonical.z,this.canonical.x,this.canonical.y)},Ho.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ho.prototype.toUnwrapped=function(){return new Iv(this.wrap,this.canonical)},Ho.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ho.prototype.getTilePoint=function(C){return this.canonical.getTilePoint(new Tf(C.x-this.wrap,C.y))};function mc(E,C,B,J,he){E*=2,E<0&&(E=E*-1-1);var xe=1<<B;return(xe*xe*E+xe*he+J).toString(36)+B.toString(36)+C.toString(36)}function L0(E,C,B){for(var J="",he,xe=E;xe>0;xe--)he=1<<xe-1,J+=(C&he?1:0)+(B&he?2:0);return J}Oe("CanonicalTileID",Af),Oe("OverscaledTileID",Ho,{omit:["posMatrix"]});var Ku=function(C,B,J){if(this.uid=C,B.height!==B.width)throw new RangeError("DEM tiles must be square");if(J&&J!=="mapbox"&&J!=="terrarium")return O('"'+J+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=B.height;var he=this.dim=B.height-2;this.data=new Uint32Array(B.data.buffer),this.encoding=J||"mapbox";for(var xe=0;xe<he;xe++)this.data[this._idx(-1,xe)]=this.data[this._idx(0,xe)],this.data[this._idx(he,xe)]=this.data[this._idx(he-1,xe)],this.data[this._idx(xe,-1)]=this.data[this._idx(xe,0)],this.data[this._idx(xe,he)]=this.data[this._idx(xe,he-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(he,-1)]=this.data[this._idx(he-1,0)],this.data[this._idx(-1,he)]=this.data[this._idx(0,he-1)],this.data[this._idx(he,he)]=this.data[this._idx(he-1,he-1)]};Ku.prototype.get=function(C,B){var J=new Uint8Array(this.data.buffer),he=this._idx(C,B)*4,xe=this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox;return xe(J[he],J[he+1],J[he+2])},Ku.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ku.prototype._idx=function(C,B){if(C<-1||C>=this.dim+1||B<-1||B>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(B+1)*this.stride+(C+1)},Ku.prototype._unpackMapbox=function(C,B,J){return(C*256*256+B*256+J)/10-1e4},Ku.prototype._unpackTerrarium=function(C,B,J){return C*256+B+J/256-32768},Ku.prototype.getPixels=function(){return new el({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ku.prototype.backfillBorder=function(C,B,J){if(this.dim!==C.dim)throw new Error("dem dimension mismatch");var he=B*this.dim,xe=B*this.dim+this.dim,Te=J*this.dim,Fe=J*this.dim+this.dim;switch(B){case-1:he=xe-1;break;case 1:xe=he+1;break}switch(J){case-1:Te=Fe-1;break;case 1:Fe=Te+1;break}for(var $e=-B*this.dim,ft=-J*this.dim,pt=Te;pt<Fe;pt++)for(var Ot=he;Ot<xe;Ot++)this.data[this._idx(Ot,pt)]=C.data[this._idx(Ot+$e,pt+ft)]},Oe("DEMData",Ku);function P0(E,C){var B={};if(!C)return B;for(var J=function(){var Te=xe[he],Fe=Te.layerIds.map(function(Ot){return C.getLayer(Ot)}).filter(Boolean);if(Fe.length!==0){Te.layers=Fe,Te.stateDependentLayerIds&&(Te.stateDependentLayers=Te.stateDependentLayerIds.map(function(Ot){return Fe.filter(function(rr){return rr.id===Ot})[0]}));for(var $e=0,ft=Fe;$e<ft.length;$e+=1){var pt=ft[$e];B[pt.id]=Te}}},he=0,xe=E;he<xe.length;he+=1)J();return B}var Gc=function(C){this._stringToNumber={},this._numberToString=[];for(var B=0;B<C.length;B++){var J=C[B];this._stringToNumber[J]=B,this._numberToString[B]=J}};Gc.prototype.encode=function(C){return this._stringToNumber[C]},Gc.prototype.decode=function(C){return this._numberToString[C]};var Yc=function(C,B,J,he,xe){this.type="Feature",this._vectorTileFeature=C,C._z=B,C._x=J,C._y=he,this.properties=C.properties,this.id=xe},Th={geometry:{configurable:!0}};Th.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Th.geometry.set=function(E){this._geometry=E},Yc.prototype.toJSON=function(){var C={geometry:this.geometry};for(var B in this)B==="_geometry"||B==="_vectorTileFeature"||(C[B]=this[B]);return C},Object.defineProperties(Yc.prototype,Th);var Kf=function(){this.state={},this.stateChanges={},this.deletedStates={}};Kf.prototype.updateState=function(C,B,J){var he=String(B);if(this.stateChanges[C]=this.stateChanges[C]||{},this.stateChanges[C][he]=this.stateChanges[C][he]||{},w(this.stateChanges[C][he],J),this.deletedStates[C]===null){this.deletedStates[C]={};for(var xe in this.state[C])xe!==he&&(this.deletedStates[C][xe]=null)}else{var Te=this.deletedStates[C]&&this.deletedStates[C][he]===null;if(Te){this.deletedStates[C][he]={};for(var Fe in this.state[C][he])J[Fe]||(this.deletedStates[C][he][Fe]=null)}else for(var $e in J){var ft=this.deletedStates[C]&&this.deletedStates[C][he]&&this.deletedStates[C][he][$e]===null;ft&&delete this.deletedStates[C][he][$e]}}},Kf.prototype.removeFeatureState=function(C,B,J){var he=this.deletedStates[C]===null;if(!he){var xe=String(B);if(this.deletedStates[C]=this.deletedStates[C]||{},J&&B!==void 0)this.deletedStates[C][xe]!==null&&(this.deletedStates[C][xe]=this.deletedStates[C][xe]||{},this.deletedStates[C][xe][J]=null);else if(B!==void 0){var Te=this.stateChanges[C]&&this.stateChanges[C][xe];if(Te){this.deletedStates[C][xe]={};for(J in this.stateChanges[C][xe])this.deletedStates[C][xe][J]=null}else this.deletedStates[C][xe]=null}else this.deletedStates[C]=null}},Kf.prototype.getState=function(C,B){var J=String(B),he=this.state[C]||{},xe=this.stateChanges[C]||{},Te=w({},he[J],xe[J]);if(this.deletedStates[C]===null)return{};if(this.deletedStates[C]){var Fe=this.deletedStates[C][B];if(Fe===null)return{};for(var $e in Fe)delete Te[$e]}return Te},Kf.prototype.initializeTileState=function(C,B){C.setFeatureState(this.state,B)},Kf.prototype.coalesceChanges=function(C,B){var J={};for(var he in this.stateChanges){this.state[he]=this.state[he]||{};var xe={};for(var Te in this.stateChanges[he])this.state[he][Te]||(this.state[he][Te]={}),w(this.state[he][Te],this.stateChanges[he][Te]),xe[Te]=this.state[he][Te];J[he]=xe}for(var Fe in this.deletedStates){this.state[Fe]=this.state[Fe]||{};var $e={};if(this.deletedStates[Fe]===null)for(var ft in this.state[Fe])$e[ft]={},this.state[Fe][ft]={};else for(var pt in this.deletedStates[Fe]){var Ot=this.deletedStates[Fe][pt]===null;if(Ot)this.state[Fe][pt]={};else for(var rr=0,qt=Object.keys(this.deletedStates[Fe][pt]);rr<qt.length;rr+=1){var dr=qt[rr];delete this.state[Fe][pt][dr]}$e[pt]=this.state[Fe][pt]}J[Fe]=J[Fe]||{},w(J[Fe],$e)}if(this.stateChanges={},this.deletedStates={},Object.keys(J).length!==0)for(var Fr in C){var an=C[Fr];an.setFeatureState(J,B)}};var Ju=function(C,B){this.tileID=C,this.x=C.canonical.x,this.y=C.canonical.y,this.z=C.canonical.z,this.grid=new Po(Ba,16,0),this.grid3D=new Po(Ba,16,0),this.featureIndexArray=new nc,this.promoteId=B};Ju.prototype.insert=function(C,B,J,he,xe,Te){var Fe=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(J,he,xe);for(var $e=Te?this.grid3D:this.grid,ft=0;ft<B.length;ft++){for(var pt=B[ft],Ot=[1/0,1/0,-1/0,-1/0],rr=0;rr<pt.length;rr++){var qt=pt[rr];Ot[0]=Math.min(Ot[0],qt.x),Ot[1]=Math.min(Ot[1],qt.y),Ot[2]=Math.max(Ot[2],qt.x),Ot[3]=Math.max(Ot[3],qt.y)}Ot[0]<Ba&&Ot[1]<Ba&&Ot[2]>=0&&Ot[3]>=0&&$e.insert(Fe,Ot[0],Ot[1],Ot[2],Ot[3])}},Ju.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Of.VectorTile(new Rc(this.rawTileData)).layers,this.sourceLayerCoder=new Gc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ju.prototype.query=function(C,B,J,he){var xe=this;this.loadVTLayers();for(var Te=C.params||{},Fe=Ba/C.tileSize/C.scale,$e=Fu(Te.filter),ft=C.queryGeometry,pt=C.queryPadding*Fe,Ot=Fv(ft),rr=this.grid.query(Ot.minX-pt,Ot.minY-pt,Ot.maxX+pt,Ot.maxY+pt),qt=Fv(C.cameraQueryGeometry),dr=this.grid3D.query(qt.minX-pt,qt.minY-pt,qt.maxX+pt,qt.maxY+pt,function(Gn,oa,na,Ra){return Vu(C.cameraQueryGeometry,Gn-pt,oa-pt,na+pt,Ra+pt)}),Fr=0,an=dr;Fr<an.length;Fr+=1){var $r=an[Fr];rr.push($r)}rr.sort(D0);for(var kn={},mn,Sn=function(Gn){var oa=rr[Gn];if(oa!==mn){mn=oa;var na=xe.featureIndexArray.get(oa),Ra=null;xe.loadMatchingFeature(kn,na.bucketIndex,na.sourceLayerIndex,na.featureIndex,$e,Te.layers,Te.availableImages,B,J,he,function(wa,Sa,ti){return Ra||(Ra=Ni(wa)),Sa.queryIntersectsFeature(ft,wa,ti,Ra,xe.z,C.transform,Fe,C.pixelPosMatrix)})}},In=0;In<rr.length;In++)Sn(In);return kn},Ju.prototype.loadMatchingFeature=function(C,B,J,he,xe,Te,Fe,$e,ft,pt,Ot){var rr=this.bucketLayerIDs[B];if(!(Te&&!D(Te,rr))){var qt=this.sourceLayerCoder.decode(J),dr=this.vtLayers[qt],Fr=dr.feature(he);if(xe.filter(new si(this.tileID.overscaledZ),Fr))for(var an=this.getId(Fr,qt),$r=0;$r<rr.length;$r++){var kn=rr[$r];if(!(Te&&Te.indexOf(kn)<0)){var mn=$e[kn];if(mn){var Sn={};an!==void 0&&pt&&(Sn=pt.getState(mn.sourceLayer||"_geojsonTileLayer",an));var In=ft[kn];In.paint=zv(In.paint,mn.paint,Fr,Sn,Fe),In.layout=zv(In.layout,mn.layout,Fr,Sn,Fe);var Gn=!Ot||Ot(Fr,mn,Sn);if(Gn){var oa=new Yc(Fr,this.z,this.x,this.y,an);oa.layer=In;var na=C[kn];na===void 0&&(na=C[kn]=[]),na.push({featureIndex:he,feature:oa,intersectionZ:Gn})}}}}}},Ju.prototype.lookupSymbolFeatures=function(C,B,J,he,xe,Te,Fe,$e){var ft={};this.loadVTLayers();for(var pt=Fu(xe),Ot=0,rr=C;Ot<rr.length;Ot+=1){var qt=rr[Ot];this.loadMatchingFeature(ft,J,he,qt,pt,Te,Fe,$e,B)}return ft},Ju.prototype.hasLayer=function(C){for(var B=0,J=this.bucketLayerIDs;B<J.length;B+=1)for(var he=J[B],xe=0,Te=he;xe<Te.length;xe+=1){var Fe=Te[xe];if(C===Fe)return!0}return!1},Ju.prototype.getId=function(C,B){var J=C.id;if(this.promoteId){var he=typeof this.promoteId=="string"?this.promoteId:this.promoteId[B];J=C.properties[he],typeof J=="boolean"&&(J=Number(J))}return J},Oe("FeatureIndex",Ju,{omit:["rawTileData","sourceLayerCoder"]});function zv(E,C,B,J,he){return P(E,function(xe,Te){var Fe=C instanceof Bi?C.get(Te):null;return Fe&&Fe.evaluate?Fe.evaluate(B,J,he):Fe})}function Fv(E){for(var C=1/0,B=1/0,J=-1/0,he=-1/0,xe=0,Te=E;xe<Te.length;xe+=1){var Fe=Te[xe];C=Math.min(C,Fe.x),B=Math.min(B,Fe.y),J=Math.max(J,Fe.x),he=Math.max(he,Fe.y)}return{minX:C,minY:B,maxX:J,maxY:he}}function D0(E,C){return C-E}var R0=3e4,$o=function(C,B){this.tileID=C,this.uid=b(),this.uses=0,this.tileSize=B,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};$o.prototype.registerFadeDuration=function(C){var B=C+this.timeAdded;B<Q.now()||this.fadeEndTime&&B<this.fadeEndTime||(this.fadeEndTime=B)},$o.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},$o.prototype.loadVectorData=function(C,B,J){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!C){this.collisionBoxArray=new Hu;return}C.featureIndex&&(this.latestFeatureIndex=C.featureIndex,C.rawTileData?(this.latestRawTileData=C.rawTileData,this.latestFeatureIndex.rawTileData=C.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=C.collisionBoxArray,this.buckets=P0(C.buckets,B.style),this.hasSymbolBuckets=!1;for(var he in this.buckets){var xe=this.buckets[he];if(xe instanceof Yi)if(this.hasSymbolBuckets=!0,J)xe.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var Te in this.buckets){var Fe=this.buckets[Te];if(Fe instanceof Yi&&Fe.hasRTLText){this.hasRTLText=!0,Si();break}}this.queryPadding=0;for(var $e in this.buckets){var ft=this.buckets[$e];this.queryPadding=Math.max(this.queryPadding,B.style.getLayer($e).queryRadius(ft))}C.imageAtlas&&(this.imageAtlas=C.imageAtlas),C.glyphAtlasImage&&(this.glyphAtlasImage=C.glyphAtlasImage)},$o.prototype.unloadVectorData=function(){for(var C in this.buckets)this.buckets[C].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},$o.prototype.getBucket=function(C){return this.buckets[C.id]},$o.prototype.upload=function(C){for(var B in this.buckets){var J=this.buckets[B];J.uploadPending()&&J.upload(C)}var he=C.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new wf(C,this.imageAtlas.image,he.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new wf(C,this.glyphAtlasImage,he.ALPHA),this.glyphAtlasImage=null)},$o.prototype.prepare=function(C){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(C,this.imageAtlasTexture)},$o.prototype.queryRenderedFeatures=function(C,B,J,he,xe,Te,Fe,$e,ft,pt){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:he,cameraQueryGeometry:xe,scale:Te,tileSize:this.tileSize,pixelPosMatrix:pt,transform:$e,params:Fe,queryPadding:this.queryPadding*ft},C,B,J)},$o.prototype.querySourceFeatures=function(C,B){var J=this.latestFeatureIndex;if(!(!J||!J.rawTileData)){var he=J.loadVTLayers(),xe=B?B.sourceLayer:"",Te=he._geojsonTileLayer||he[xe];if(Te)for(var Fe=Fu(B&&B.filter),$e=this.tileID.canonical,ft=$e.z,pt=$e.x,Ot=$e.y,rr={z:ft,x:pt,y:Ot},qt=0;qt<Te.length;qt++){var dr=Te.feature(qt);if(Fe.filter(new si(this.tileID.overscaledZ),dr)){var Fr=J.getId(dr,xe),an=new Yc(dr,ft,pt,Ot,Fr);an.tile=rr,C.push(an)}}}},$o.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},$o.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},$o.prototype.setExpiryData=function(C){var B=this.expirationTime;if(C.cacheControl){var J=W(C.cacheControl);J["max-age"]&&(this.expirationTime=Date.now()+J["max-age"]*1e3)}else C.expires&&(this.expirationTime=new Date(C.expires).getTime());if(this.expirationTime){var he=Date.now(),xe=!1;if(this.expirationTime>he)xe=!1;else if(!B)xe=!0;else if(this.expirationTime<B)xe=!0;else{var Te=this.expirationTime-B;Te?this.expirationTime=he+Math.max(Te,R0):xe=!0}xe?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},$o.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},$o.prototype.setFeatureState=function(C,B){if(!(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(C).length===0)){var J=this.latestFeatureIndex.loadVTLayers();for(var he in this.buckets)if(B.style.hasLayer(he)){var xe=this.buckets[he],Te=xe.layers[0].sourceLayer||"_geojsonTileLayer",Fe=J[Te],$e=C[Te];if(!(!Fe||!$e||Object.keys($e).length===0)){xe.update($e,Fe,this.imageAtlas&&this.imageAtlas.patternPositions||{});var ft=B&&B.style&&B.style.getLayer(he);ft&&(this.queryPadding=Math.max(this.queryPadding,ft.queryRadius(xe)))}}}},$o.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},$o.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Q.now()},$o.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},$o.prototype.setHoldDuration=function(C){this.symbolFadeHoldUntil=Q.now()+C},$o.prototype.setDependencies=function(C,B){for(var J={},he=0,xe=B;he<xe.length;he+=1){var Te=xe[he];J[Te]=!0}this.dependencies[C]=J},$o.prototype.hasDependency=function(C,B){for(var J=0,he=C;J<he.length;J+=1){var xe=he[J],Te=this.dependencies[xe];if(Te)for(var Fe=0,$e=B;Fe<$e.length;Fe+=1){var ft=$e[Fe];if(Te[ft])return!0}}return!1};var I0=["type","source","source-layer","minzoom","maxzoom","filter","layout"],uf=self.performance,Ov=function(C){this._marks={start:[C.url,"start"].join("#"),end:[C.url,"end"].join("#"),measure:C.url.toString()},uf.mark(this._marks.start)};Ov.prototype.finish=function(){uf.mark(this._marks.end);var C=uf.getEntriesByName(this._marks.measure);return C.length===0&&(uf.measure(this._marks.measure,this._marks.start,this._marks.end),C=uf.getEntriesByName(this._marks.measure),uf.clearMarks(this._marks.start),uf.clearMarks(this._marks.end),uf.clearMeasures(this._marks.measure)),C},e.Actor=jf,e.AlphaImage=_f,e.CanonicalTileID=Af,e.CollisionBoxArray=Hu,e.Color=vi,e.DEMData=Ku,e.DataConstantProperty=Ia,e.DictionaryCoder=Gc,e.EXTENT=Ba,e.ErrorEvent=br,e.EvaluationParameters=si,e.Event=kr,e.Evented=Mr,e.FeatureIndex=Ju,e.FillBucket=wu,e.FillExtrusionBucket=Tu,e.ImageAtlas=pc,e.ImagePosition=zc,e.LineBucket=tl,e.LngLat=ho,e.LngLatBounds=Uo,e.MercatorCoordinate=Tf,e.ONE_EM=hs,e.OverscaledTileID=Ho,e.Point=h,e.Point$1=h,e.Properties=Xi,e.Protobuf=Rc,e.RGBAImage=el,e.RequestManager=Ee,e.RequestPerformance=Ov,e.ResourceType=at,e.SegmentVector=V,e.SourceFeatureState=Kf,e.StructArrayLayout1ui2=rf,e.StructArrayLayout2f1f2i16=xu,e.StructArrayLayout2i4=pf,e.StructArrayLayout3ui6=bu,e.StructArrayLayout4i8=Ou,e.SymbolBucket=Yi,e.Texture=wf,e.Tile=$o,e.Transitionable=yo,e.Uniform1f=Ur,e.Uniform1i=Wr,e.Uniform2f=Jr,e.Uniform3f=hn,e.Uniform4f=Cn,e.UniformColor=Fn,e.UniformMatrix4f=qn,e.UnwrappedTileID=Iv,e.ValidationError=hr,e.WritingMode=El,e.ZoomHistory=er,e.add=If,e.addDynamicAttributes=xh,e.asyncAll=o,e.bezier=p,e.bindAll=T,e.browser=Q,e.cacheEntryPossiblyAdded=Wt,e.clamp=f,e.clearTileCache=ir,e.clipLine=yv,e.clone=Sc,e.clone$1=I,e.clone$2=$c,e.collisionCircleLayout=pd,e.config=ie,e.create=Pf,e.create$1=xf,e.create$2=mf,e.createCommonjsModule=a,e.createExpression=Bl,e.createLayout=Ro,e.createStyleLayer=M0,e.cross=Yv,e.deepEqual=i,e.dot=Gv,e.dot$1=Kv,e.ease=v,e.emitValidationErrors=go,e.endsWith=k,e.enforceCacheSizeLimit=Vt,e.evaluateSizeForFeature=fv,e.evaluateSizeForZoom=cv,e.evaluateVariableOffset=bv,e.evented=yi,e.extend=w,e.featureFilter=Fu,e.filterObject=z,e.fromRotation=Lf,e.getAnchorAlignment=dh,e.getAnchorJustification=mh,e.getArrayBuffer=lt,e.getImage=gt,e.getJSON=st,e.getRTLTextPluginStatus=co,e.getReferrer=Jt,e.getVideo=St,e.identity=Df,e.invert=af,e.isChar=tr,e.isMapboxURL=Pe,e.keysDifference=l,e.makeRequest=Je,e.mapObject=P,e.mercatorXfromLng=Pv,e.mercatorYfromLat=Dv,e.mercatorZfromAltitude=Rv,e.mul=Qc,e.multiply=of,e.mvt=Of,e.normalize=ic,e.number=so,e.offscreenCanvasSupported=jr,e.ortho=Jc,e.parseGlyphPBF=Hd,e.pbf=Rc,e.performSymbolLayout=i0,e.perspective=ac,e.pick=_,e.plugin=Xa,e.polygonIntersectsPolygon=ii,e.postMapLoadEvent=At,e.postTurnstileEvent=Xt,e.potpack=rv,e.refProperties=I0,e.register=Oe,e.registerForPluginStateChange=Ii,e.rotate=Es,e.rotateX=qs,e.rotateZ=Rf,e.scale=$s,e.scale$1=jv,e.scale$2=eh,e.setCacheLimits=Hr,e.setRTLTextPlugin=fa,e.sphericalToCartesian=G,e.sqrLen=$v,e.styleSpec=Ht,e.sub=Xv,e.symbolSize=Jd,e.transformMat3=Wv,e.transformMat4=kc,e.translate=Co,e.triggerPluginCompletionEvent=Pa,e.uniqueId=b,e.validateCustomStyleLayer=w0,e.validateLight=bi,e.validateStyle=_o,e.values=m,e.vectorTile=Of,e.version=n,e.warnOnce=O,e.webpSupported=se,e.window=self,e.wrap=d}),M(["./shared"],function(e){function a(rt){var Je=typeof rt;if(Je==="number"||Je==="boolean"||Je==="string"||rt===void 0||rt===null)return JSON.stringify(rt);if(Array.isArray(rt)){for(var st="[",lt=0,Tt=rt;lt<Tt.length;lt+=1){var zt=Tt[lt];st+=a(zt)+","}return st+"]"}for(var Ce=Object.keys(rt).sort(),Se="{",nt=0;nt<Ce.length;nt++)Se+=JSON.stringify(Ce[nt])+":"+a(rt[Ce[nt]])+",";return Se+"}"}function n(rt){for(var Je="",st=0,lt=e.refProperties;st<lt.length;st+=1){var Tt=lt[st];Je+="/"+a(rt[Tt])}return Je}function r(rt,Je){for(var st={},lt=0;lt<rt.length;lt++){var Tt=Je&&Je[rt[lt].id]||n(rt[lt]);Je&&(Je[rt[lt].id]=Tt);var zt=st[Tt];zt||(zt=st[Tt]=[]),zt.push(rt[lt])}var Ce=[];for(var Se in st)Ce.push(st[Se]);return Ce}var t=function(Je){this.keyCache={},Je&&this.replace(Je)};t.prototype.replace=function(Je){this._layerConfigs={},this._layers={},this.update(Je,[])},t.prototype.update=function(Je,st){for(var lt=this,Tt=0,zt=Je;Tt<zt.length;Tt+=1){var Ce=zt[Tt];this._layerConfigs[Ce.id]=Ce;var Se=this._layers[Ce.id]=e.createStyleLayer(Ce);Se._featureFilter=e.featureFilter(Se.filter),this.keyCache[Ce.id]&&delete this.keyCache[Ce.id]}for(var nt=0,it=st;nt<it.length;nt+=1){var ct=it[nt];delete this.keyCache[ct],delete this._layerConfigs[ct],delete this._layers[ct]}this.familiesBySource={};for(var kt=r(e.values(this._layerConfigs),this.keyCache),gt=0,St=kt;gt<St.length;gt+=1){var Yt=St[gt],ar=Yt.map(function(gr){return lt._layers[gr.id]}),kr=ar[0];if(kr.visibility!=="none"){var br=kr.source||"",Mr=this.familiesBySource[br];Mr||(Mr=this.familiesBySource[br]={});var Yr=kr.sourceLayer||"_geojsonTileLayer",nr=Mr[Yr];nr||(nr=Mr[Yr]=[]),nr.push(ar)}}};var h=1,s=function(Je){var st={},lt=[];for(var Tt in Je){var zt=Je[Tt],Ce=st[Tt]={};for(var Se in zt){var nt=zt[+Se];if(!(!nt||nt.bitmap.width===0||nt.bitmap.height===0)){var it={x:0,y:0,w:nt.bitmap.width+2*h,h:nt.bitmap.height+2*h};lt.push(it),Ce[Se]={rect:it,metrics:nt.metrics}}}}var ct=e.potpack(lt),kt=ct.w,gt=ct.h,St=new e.AlphaImage({width:kt||1,height:gt||1});for(var Yt in Je){var ar=Je[Yt];for(var kr in ar){var br=ar[+kr];if(!(!br||br.bitmap.width===0||br.bitmap.height===0)){var Mr=st[Yt][kr].rect;e.AlphaImage.copy(br.bitmap,St,{x:0,y:0},{x:Mr.x+h,y:Mr.y+h},br.bitmap)}}}this.image=St,this.positions=st};e.register("GlyphAtlas",s);var i=function(Je){this.tileID=new e.OverscaledTileID(Je.tileID.overscaledZ,Je.tileID.wrap,Je.tileID.canonical.z,Je.tileID.canonical.x,Je.tileID.canonical.y),this.uid=Je.uid,this.zoom=Je.zoom,this.pixelRatio=Je.pixelRatio,this.tileSize=Je.tileSize,this.source=Je.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Je.showCollisionBoxes,this.collectResourceTiming=!!Je.collectResourceTiming,this.returnDependencies=!!Je.returnDependencies,this.promoteId=Je.promoteId};i.prototype.parse=function(Je,st,lt,Tt,zt){var Ce=this;this.status="parsing",this.data=Je,this.collisionBoxArray=new e.CollisionBoxArray;var Se=new e.DictionaryCoder(Object.keys(Je.layers).sort()),nt=new e.FeatureIndex(this.tileID,this.promoteId);nt.bucketLayerIDs=[];var it={},ct={featureIndex:nt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:lt},kt=st.familiesBySource[this.source];for(var gt in kt){var St=Je.layers[gt];if(St){St.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+gt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Yt=Se.encode(gt),ar=[],kr=0;kr<St.length;kr++){var br=St.feature(kr),Mr=nt.getId(br,gt);ar.push({feature:br,id:Mr,index:kr,sourceLayerIndex:Yt})}for(var Yr=0,nr=kt[gt];Yr<nr.length;Yr+=1){var gr=nr[Yr],Rr=gr[0];if(!(Rr.minzoom&&this.zoom<Math.floor(Rr.minzoom))&&!(Rr.maxzoom&&this.zoom>=Rr.maxzoom)&&Rr.visibility!=="none"){x(gr,this.zoom,lt);var Br=it[Rr.id]=Rr.createBucket({index:nt.bucketLayerIDs.length,layers:gr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Yt,sourceID:this.source});Br.populate(ar,ct,this.tileID.canonical),nt.bucketLayerIDs.push(gr.map(function(wr){return wr.id}))}}}}var Sr,et,Lt,Zt,or=e.mapObject(ct.glyphDependencies,function(wr){return Object.keys(wr).map(Number)});Object.keys(or).length?Tt.send("getGlyphs",{uid:this.uid,stacks:or},function(wr,Gr){Sr||(Sr=wr,et=Gr,Er.call(Ce))}):et={};var Ir=Object.keys(ct.iconDependencies);Ir.length?Tt.send("getImages",{icons:Ir,source:this.source,tileID:this.tileID,type:"icons"},function(wr,Gr){Sr||(Sr=wr,Lt=Gr,Er.call(Ce))}):Lt={};var Or=Object.keys(ct.patternDependencies);Or.length?Tt.send("getImages",{icons:Or,source:this.source,tileID:this.tileID,type:"patterns"},function(wr,Gr){Sr||(Sr=wr,Zt=Gr,Er.call(Ce))}):Zt={},Er.call(this);function Er(){if(Sr)return zt(Sr);if(et&&Lt&&Zt){var wr=new s(et),Gr=new e.ImageAtlas(Lt,Zt);for(var wn in it){var cn=it[wn];cn instanceof e.SymbolBucket?(x(cn.layers,this.zoom,lt),e.performSymbolLayout(cn,et,wr.positions,Lt,Gr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):cn.hasPattern&&(cn instanceof e.LineBucket||cn instanceof e.FillBucket||cn instanceof e.FillExtrusionBucket)&&(x(cn.layers,this.zoom,lt),cn.addFeatures(ct,this.tileID.canonical,Gr.patternPositions))}this.status="done",zt(null,{buckets:e.values(it).filter(function(Bn){return!Bn.isEmpty()}),featureIndex:nt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wr.image,imageAtlas:Gr,glyphMap:this.returnDependencies?et:null,iconMap:this.returnDependencies?Lt:null,glyphPositions:this.returnDependencies?wr.positions:null})}}};function x(rt,Je,st){for(var lt=new e.EvaluationParameters(Je),Tt=0,zt=rt;Tt<zt.length;Tt+=1){var Ce=zt[Tt];Ce.recalculate(lt,st)}}function p(rt,Je){var st=e.getArrayBuffer(rt.request,function(lt,Tt,zt,Ce){lt?Je(lt):Tt&&Je(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Tt)),rawData:Tt,cacheControl:zt,expires:Ce})});return function(){st.cancel(),Je()}}var v=function(Je,st,lt,Tt){this.actor=Je,this.layerIndex=st,this.availableImages=lt,this.loadVectorData=Tt||p,this.loading={},this.loaded={}};v.prototype.loadTile=function(Je,st){var lt=this,Tt=Je.uid;this.loading||(this.loading={});var zt=Je&&Je.request&&Je.request.collectResourceTiming?new e.RequestPerformance(Je.request):!1,Ce=this.loading[Tt]=new i(Je);Ce.abort=this.loadVectorData(Je,function(Se,nt){if(delete lt.loading[Tt],Se||!nt)return Ce.status="done",lt.loaded[Tt]=Ce,st(Se);var it=nt.rawData,ct={};nt.expires&&(ct.expires=nt.expires),nt.cacheControl&&(ct.cacheControl=nt.cacheControl);var kt={};if(zt){var gt=zt.finish();gt&&(kt.resourceTiming=JSON.parse(JSON.stringify(gt)))}Ce.vectorTile=nt.vectorTile,Ce.parse(nt.vectorTile,lt.layerIndex,lt.availableImages,lt.actor,function(St,Yt){if(St||!Yt)return st(St);st(null,e.extend({rawTileData:it.slice(0)},Yt,ct,kt))}),lt.loaded=lt.loaded||{},lt.loaded[Tt]=Ce})},v.prototype.reloadTile=function(Je,st){var lt=this,Tt=this.loaded,zt=Je.uid,Ce=this;if(Tt&&Tt[zt]){var Se=Tt[zt];Se.showCollisionBoxes=Je.showCollisionBoxes;var nt=function(it,ct){var kt=Se.reloadCallback;kt&&(delete Se.reloadCallback,Se.parse(Se.vectorTile,Ce.layerIndex,lt.availableImages,Ce.actor,kt)),st(it,ct)};Se.status==="parsing"?Se.reloadCallback=nt:Se.status==="done"&&(Se.vectorTile?Se.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor,nt):nt())}},v.prototype.abortTile=function(Je,st){var lt=this.loading,Tt=Je.uid;lt&&lt[Tt]&&lt[Tt].abort&&(lt[Tt].abort(),delete lt[Tt]),st()},v.prototype.removeTile=function(Je,st){var lt=this.loaded,Tt=Je.uid;lt&&lt[Tt]&&delete lt[Tt],st()};var f=e.window.ImageBitmap,d=function(){this.loaded={}};d.prototype.loadTile=function(Je,st){var lt=Je.uid,Tt=Je.encoding,zt=Je.rawImageData,Ce=f&&zt instanceof f?this.getImageData(zt):zt,Se=new e.DEMData(lt,Ce,Tt);this.loaded=this.loaded||{},this.loaded[lt]=Se,st(null,Se)},d.prototype.getImageData=function(Je){(!this.offscreenCanvas||!this.offscreenCanvasContext)&&(this.offscreenCanvas=new OffscreenCanvas(Je.width,Je.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Je.width,this.offscreenCanvas.height=Je.height,this.offscreenCanvasContext.drawImage(Je,0,0,Je.width,Je.height);var st=this.offscreenCanvasContext.getImageData(-1,-1,Je.width+2,Je.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:st.width,height:st.height},st.data)},d.prototype.removeTile=function(Je){var st=this.loaded,lt=Je.uid;st&&st[lt]&&delete st[lt]};var o=m;function m(rt,Je){var st=rt&&rt.type,lt;if(st==="FeatureCollection")for(lt=0;lt<rt.features.length;lt++)m(rt.features[lt],Je);else if(st==="GeometryCollection")for(lt=0;lt<rt.geometries.length;lt++)m(rt.geometries[lt],Je);else if(st==="Feature")m(rt.geometry,Je);else if(st==="Polygon")l(rt.coordinates,Je);else if(st==="MultiPolygon")for(lt=0;lt<rt.coordinates.length;lt++)l(rt.coordinates[lt],Je);return rt}function l(rt,Je){if(rt.length!==0){w(rt[0],Je);for(var st=1;st<rt.length;st++)w(rt[st],!Je)}}function w(rt,Je){for(var st=0,lt=0,Tt=rt.length,zt=Tt-1;lt<Tt;zt=lt++)st+=(rt[lt][0]-rt[zt][0])*(rt[zt][1]+rt[lt][1]);st>=0!=!!Je&&rt.reverse()}var _=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,c=function(Je){this._feature=Je,this.extent=e.EXTENT,this.type=Je.type,this.properties=Je.tags,"id"in Je&&!isNaN(Je.id)&&(this.id=parseInt(Je.id,10))};c.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Je=[],st=0,lt=this._feature.geometry;st<lt.length;st+=1){var Tt=lt[st];Je.push([new e.Point$1(Tt[0],Tt[1])])}return Je}else{for(var zt=[],Ce=0,Se=this._feature.geometry;Ce<Se.length;Ce+=1){for(var nt=Se[Ce],it=[],ct=0,kt=nt;ct<kt.length;ct+=1){var gt=kt[ct];it.push(new e.Point$1(gt[0],gt[1]))}zt.push(it)}return zt}},c.prototype.toGeoJSON=function(Je,st,lt){return _.call(this,Je,st,lt)};var b=function(Je){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Je.length,this._features=Je};b.prototype.feature=function(Je){return new c(this._features[Je])};var u=e.vectorTile.VectorTileFeature,L=T;function T(rt,Je){this.options=Je||{},this.features=rt,this.length=rt.length}T.prototype.feature=function(rt){return new k(this.features[rt],this.options.extent)};function k(rt,Je){this.id=typeof rt.id=="number"?rt.id:void 0,this.type=rt.type,this.rawGeometry=rt.type===1?[rt.geometry]:rt.geometry,this.properties=rt.tags,this.extent=Je||4096}k.prototype.loadGeometry=function(){var rt=this.rawGeometry;this.geometry=[];for(var Je=0;Je<rt.length;Je++){for(var st=rt[Je],lt=[],Tt=0;Tt<st.length;Tt++)lt.push(new e.Point$1(st[Tt][0],st[Tt][1]));this.geometry.push(lt)}return this.geometry},k.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var rt=this.geometry,Je=1/0,st=-1/0,lt=1/0,Tt=-1/0,zt=0;zt<rt.length;zt++)for(var Ce=rt[zt],Se=0;Se<Ce.length;Se++){var nt=Ce[Se];Je=Math.min(Je,nt.x),st=Math.max(st,nt.x),lt=Math.min(lt,nt.y),Tt=Math.max(Tt,nt.y)}return[Je,lt,st,Tt]},k.prototype.toGeoJSON=u.prototype.toGeoJSON;var P=R,z=R,I=O,D=L;function R(rt){var Je=new e.pbf;return F(rt,Je),Je.finish()}function O(rt,Je){Je=Je||{};var st={};for(var lt in rt)st[lt]=new L(rt[lt].features,Je),st[lt].name=lt,st[lt].version=Je.version,st[lt].extent=Je.extent;return R({layers:st})}function F(rt,Je){for(var st in rt.layers)Je.writeMessage(3,N,rt.layers[st])}function N(rt,Je){Je.writeVarintField(15,rt.version||1),Je.writeStringField(1,rt.name||""),Je.writeVarintField(5,rt.extent||4096);var st,lt={keys:[],values:[],keycache:{},valuecache:{}};for(st=0;st<rt.length;st++)lt.feature=rt.feature(st),Je.writeMessage(2,G,lt);var Tt=lt.keys;for(st=0;st<Tt.length;st++)Je.writeStringField(3,Tt[st]);var zt=lt.values;for(st=0;st<zt.length;st++)Je.writeMessage(4,ue,zt[st])}function G(rt,Je){var st=rt.feature;st.id!==void 0&&Je.writeVarintField(1,st.id),Je.writeMessage(2,K,rt),Je.writeVarintField(3,st.type),Je.writeMessage(4,re,st)}function K(rt,Je){var st=rt.feature,lt=rt.keys,Tt=rt.values,zt=rt.keycache,Ce=rt.valuecache;for(var Se in st.properties){var nt=zt[Se];typeof nt>"u"&&(lt.push(Se),nt=lt.length-1,zt[Se]=nt),Je.writeVarint(nt);var it=st.properties[Se],ct=typeof it;ct!=="string"&&ct!=="boolean"&&ct!=="number"&&(it=JSON.stringify(it));var kt=ct+":"+it,gt=Ce[kt];typeof gt>"u"&&(Tt.push(it),gt=Tt.length-1,Ce[kt]=gt),Je.writeVarint(gt)}}function W(rt,Je){return(Je<<3)+(rt&7)}function Y(rt){return rt<<1^rt>>31}function re(rt,Je){for(var st=rt.loadGeometry(),lt=rt.type,Tt=0,zt=0,Ce=st.length,Se=0;Se<Ce;Se++){var nt=st[Se],it=1;lt===1&&(it=nt.length),Je.writeVarint(W(1,it));for(var ct=lt===3?nt.length-1:nt.length,kt=0;kt<ct;kt++){kt===1&&lt!==1&&Je.writeVarint(W(2,ct-1));var gt=nt[kt].x-Tt,St=nt[kt].y-zt;Je.writeVarint(Y(gt)),Je.writeVarint(Y(St)),Tt+=gt,zt+=St}lt===3&&Je.writeVarint(W(7,1))}}function ue(rt,Je){var st=typeof rt;st==="string"?Je.writeStringField(1,rt):st==="boolean"?Je.writeBooleanField(7,rt):st==="number"&&(rt%1!==0?Je.writeDoubleField(3,rt):rt<0?Je.writeSVarintField(6,rt):Je.writeVarintField(5,rt))}P.fromVectorTileJs=z,P.fromGeojsonVt=I,P.GeoJSONWrapper=D;function j(rt,Je,st,lt,Tt,zt){if(!(Tt-lt<=st)){var Ce=lt+Tt>>1;q(rt,Je,Ce,lt,Tt,zt%2),j(rt,Je,st,lt,Ce-1,zt+1),j(rt,Je,st,Ce+1,Tt,zt+1)}}function q(rt,Je,st,lt,Tt,zt){for(;Tt>lt;){if(Tt-lt>600){var Ce=Tt-lt+1,Se=st-lt+1,nt=Math.log(Ce),it=.5*Math.exp(2*nt/3),ct=.5*Math.sqrt(nt*it*(Ce-it)/Ce)*(Se-Ce/2<0?-1:1),kt=Math.max(lt,Math.floor(st-Se*it/Ce+ct)),gt=Math.min(Tt,Math.floor(st+(Ce-Se)*it/Ce+ct));q(rt,Je,st,kt,gt,zt)}var St=Je[2*st+zt],Yt=lt,ar=Tt;for(H(rt,Je,lt,st),Je[2*Tt+zt]>St&&H(rt,Je,lt,Tt);Yt<ar;){for(H(rt,Je,Yt,ar),Yt++,ar--;Je[2*Yt+zt]<St;)Yt++;for(;Je[2*ar+zt]>St;)ar--}Je[2*lt+zt]===St?H(rt,Je,lt,ar):(ar++,H(rt,Je,ar,Tt)),ar<=st&&(lt=ar+1),st<=ar&&(Tt=ar-1)}}function H(rt,Je,st,lt){U(rt,st,lt),U(Je,2*st,2*lt),U(Je,2*st+1,2*lt+1)}function U(rt,Je,st){var lt=rt[Je];rt[Je]=rt[st],rt[st]=lt}function $(rt,Je,st,lt,Tt,zt,Ce){for(var Se=[0,rt.length-1,0],nt=[],it,ct;Se.length;){var kt=Se.pop(),gt=Se.pop(),St=Se.pop();if(gt-St<=Ce){for(var Yt=St;Yt<=gt;Yt++)it=Je[2*Yt],ct=Je[2*Yt+1],it>=st&&it<=Tt&&ct>=lt&&ct<=zt&&nt.push(rt[Yt]);continue}var ar=Math.floor((St+gt)/2);it=Je[2*ar],ct=Je[2*ar+1],it>=st&&it<=Tt&&ct>=lt&&ct<=zt&&nt.push(rt[ar]);var kr=(kt+1)%2;(kt===0?st<=it:lt<=ct)&&(Se.push(St),Se.push(ar-1),Se.push(kr)),(kt===0?Tt>=it:zt>=ct)&&(Se.push(ar+1),Se.push(gt),Se.push(kr))}return nt}function ne(rt,Je,st,lt,Tt,zt){for(var Ce=[0,rt.length-1,0],Se=[],nt=Tt*Tt;Ce.length;){var it=Ce.pop(),ct=Ce.pop(),kt=Ce.pop();if(ct-kt<=zt){for(var gt=kt;gt<=ct;gt++)X(Je[2*gt],Je[2*gt+1],st,lt)<=nt&&Se.push(rt[gt]);continue}var St=Math.floor((kt+ct)/2),Yt=Je[2*St],ar=Je[2*St+1];X(Yt,ar,st,lt)<=nt&&Se.push(rt[St]);var kr=(it+1)%2;(it===0?st-Tt<=Yt:lt-Tt<=ar)&&(Ce.push(kt),Ce.push(St-1),Ce.push(kr)),(it===0?st+Tt>=Yt:lt+Tt>=ar)&&(Ce.push(St+1),Ce.push(ct),Ce.push(kr))}return Se}function X(rt,Je,st,lt){var Tt=rt-st,zt=Je-lt;return Tt*Tt+zt*zt}var Q=function(rt){return rt[0]},ie=function(rt){return rt[1]},se=function(Je,st,lt,Tt,zt){st===void 0&&(st=Q),lt===void 0&&(lt=ie),Tt===void 0&&(Tt=64),zt===void 0&&(zt=Float64Array),this.nodeSize=Tt,this.points=Je;for(var Ce=Je.length<65536?Uint16Array:Uint32Array,Se=this.ids=new Ce(Je.length),nt=this.coords=new zt(Je.length*2),it=0;it<Je.length;it++)Se[it]=it,nt[2*it]=st(Je[it]),nt[2*it+1]=lt(Je[it]);j(Se,nt,Tt,0,Se.length-1,0)};se.prototype.range=function(Je,st,lt,Tt){return $(this.ids,this.coords,Je,st,lt,Tt,this.nodeSize)},se.prototype.within=function(Je,st,lt){return ne(this.ids,this.coords,Je,st,lt,this.nodeSize)};var ae={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(rt){return rt}},oe=function(Je){this.options=Ue(Object.create(ae),Je),this.trees=new Array(this.options.maxZoom+1)};oe.prototype.load=function(Je){var st=this.options,lt=st.log,Tt=st.minZoom,zt=st.maxZoom,Ce=st.nodeSize;lt&&console.time("total time");var Se="prepare "+Je.length+" points";lt&&console.time(Se),this.points=Je;for(var nt=[],it=0;it<Je.length;it++)Je[it].geometry&&nt.push(ce(Je[it],it));this.trees[zt+1]=new se(nt,we,ke,Ce,Float32Array),lt&&console.timeEnd(Se);for(var ct=zt;ct>=Tt;ct--){var kt=+Date.now();nt=this._cluster(nt,ct),this.trees[ct]=new se(nt,we,ke,Ce,Float32Array),lt&&console.log("z%d: %d clusters in %dms",ct,nt.length,+Date.now()-kt)}return lt&&console.timeEnd("total time"),this},oe.prototype.getClusters=function(Je,st){var lt=((Je[0]+180)%360+360)%360-180,Tt=Math.max(-90,Math.min(90,Je[1])),zt=Je[2]===180?180:((Je[2]+180)%360+360)%360-180,Ce=Math.max(-90,Math.min(90,Je[3]));if(Je[2]-Je[0]>=360)lt=-180,zt=180;else if(lt>zt){var Se=this.getClusters([lt,Tt,180,Ce],st),nt=this.getClusters([-180,Tt,zt,Ce],st);return Se.concat(nt)}for(var it=this.trees[this._limitZoom(st)],ct=it.range(ge(lt),me(Ce),ge(zt),me(Tt)),kt=[],gt=0,St=ct;gt<St.length;gt+=1){var Yt=St[gt],ar=it.points[Yt];kt.push(ar.numPoints?de(ar):this.points[ar.index])}return kt},oe.prototype.getChildren=function(Je){var st=this._getOriginId(Je),lt=this._getOriginZoom(Je),Tt="No cluster with the specified id.",zt=this.trees[lt];if(!zt)throw new Error(Tt);var Ce=zt.points[st];if(!Ce)throw new Error(Tt);for(var Se=this.options.radius/(this.options.extent*Math.pow(2,lt-1)),nt=zt.within(Ce.x,Ce.y,Se),it=[],ct=0,kt=nt;ct<kt.length;ct+=1){var gt=kt[ct],St=zt.points[gt];St.parentId===Je&&it.push(St.numPoints?de(St):this.points[St.index])}if(it.length===0)throw new Error(Tt);return it},oe.prototype.getLeaves=function(Je,st,lt){st=st||10,lt=lt||0;var Tt=[];return this._appendLeaves(Tt,Je,st,lt,0),Tt},oe.prototype.getTile=function(Je,st,lt){var Tt=this.trees[this._limitZoom(Je)],zt=Math.pow(2,Je),Ce=this.options,Se=Ce.extent,nt=Ce.radius,it=nt/Se,ct=(lt-it)/zt,kt=(lt+1+it)/zt,gt={features:[]};return this._addTileFeatures(Tt.range((st-it)/zt,ct,(st+1+it)/zt,kt),Tt.points,st,lt,zt,gt),st===0&&this._addTileFeatures(Tt.range(1-it/zt,ct,1,kt),Tt.points,zt,lt,zt,gt),st===zt-1&&this._addTileFeatures(Tt.range(0,ct,it/zt,kt),Tt.points,-1,lt,zt,gt),gt.features.length?gt:null},oe.prototype.getClusterExpansionZoom=function(Je){for(var st=this._getOriginZoom(Je)-1;st<=this.options.maxZoom;){var lt=this.getChildren(Je);if(st++,lt.length!==1)break;Je=lt[0].properties.cluster_id}return st},oe.prototype._appendLeaves=function(Je,st,lt,Tt,zt){for(var Ce=this.getChildren(st),Se=0,nt=Ce;Se<nt.length;Se+=1){var it=nt[Se],ct=it.properties;if(ct&&ct.cluster?zt+ct.point_count<=Tt?zt+=ct.point_count:zt=this._appendLeaves(Je,ct.cluster_id,lt,Tt,zt):zt<Tt?zt++:Je.push(it),Je.length===lt)break}return zt},oe.prototype._addTileFeatures=function(Je,st,lt,Tt,zt,Ce){for(var Se=0,nt=Je;Se<nt.length;Se+=1){var it=nt[Se],ct=st[it],kt=ct.numPoints,gt={type:1,geometry:[[Math.round(this.options.extent*(ct.x*zt-lt)),Math.round(this.options.extent*(ct.y*zt-Tt))]],tags:kt?ye(ct):this.points[ct.index].properties},St=void 0;kt?St=ct.id:this.options.generateId?St=ct.index:this.points[ct.index].id&&(St=this.points[ct.index].id),St!==void 0&&(gt.id=St),Ce.features.push(gt)}},oe.prototype._limitZoom=function(Je){return Math.max(this.options.minZoom,Math.min(Je,this.options.maxZoom+1))},oe.prototype._cluster=function(Je,st){for(var lt=[],Tt=this.options,zt=Tt.radius,Ce=Tt.extent,Se=Tt.reduce,nt=zt/(Ce*Math.pow(2,st)),it=0;it<Je.length;it++){var ct=Je[it];if(!(ct.zoom<=st)){ct.zoom=st;for(var kt=this.trees[st+1],gt=kt.within(ct.x,ct.y,nt),St=ct.numPoints||1,Yt=ct.x*St,ar=ct.y*St,kr=Se&&St>1?this._map(ct,!0):null,br=(it<<5)+(st+1)+this.points.length,Mr=0,Yr=gt;Mr<Yr.length;Mr+=1){var nr=Yr[Mr],gr=kt.points[nr];if(!(gr.zoom<=st)){gr.zoom=st;var Rr=gr.numPoints||1;Yt+=gr.x*Rr,ar+=gr.y*Rr,St+=Rr,gr.parentId=br,Se&&(kr||(kr=this._map(ct,!0)),Se(kr,this._map(gr)))}}St===1?lt.push(ct):(ct.parentId=br,lt.push(be(Yt/St,ar/St,br,St,kr)))}}return lt},oe.prototype._getOriginId=function(Je){return Je-this.points.length>>5},oe.prototype._getOriginZoom=function(Je){return(Je-this.points.length)%32},oe.prototype._map=function(Je,st){if(Je.numPoints)return st?Ue({},Je.properties):Je.properties;var lt=this.points[Je.index].properties,Tt=this.options.map(lt);return st&&Tt===lt?Ue({},Tt):Tt};function be(rt,Je,st,lt,Tt){return{x:rt,y:Je,zoom:1/0,id:st,parentId:-1,numPoints:lt,properties:Tt}}function ce(rt,Je){var st=rt.geometry.coordinates,lt=st[0],Tt=st[1];return{x:ge(lt),y:me(Tt),zoom:1/0,index:Je,parentId:-1}}function de(rt){return{type:"Feature",id:rt.id,properties:ye(rt),geometry:{type:"Point",coordinates:[Ee(rt.x),Pe(rt.y)]}}}function ye(rt){var Je=rt.numPoints,st=Je>=1e4?Math.round(Je/1e3)+"k":Je>=1e3?Math.round(Je/100)/10+"k":Je;return Ue(Ue({},rt.properties),{cluster:!0,cluster_id:rt.id,point_count:Je,point_count_abbreviated:st})}function ge(rt){return rt/360+.5}function me(rt){var Je=Math.sin(rt*Math.PI/180),st=.5-.25*Math.log((1+Je)/(1-Je))/Math.PI;return st<0?0:st>1?1:st}function Ee(rt){return(rt-.5)*360}function Pe(rt){var Je=(180-rt*360)*Math.PI/180;return 360*Math.atan(Math.exp(Je))/Math.PI-90}function Ue(rt,Je){for(var st in Je)rt[st]=Je[st];return rt}function we(rt){return rt.x}function ke(rt){return rt.y}function Xe(rt,Je,st,lt){for(var Tt=lt,zt=st-Je>>1,Ce=st-Je,Se,nt=rt[Je],it=rt[Je+1],ct=rt[st],kt=rt[st+1],gt=Je+3;gt<st;gt+=3){var St=Ve(rt[gt],rt[gt+1],nt,it,ct,kt);if(St>Tt)Se=gt,Tt=St;else if(St===Tt){var Yt=Math.abs(gt-zt);Yt<Ce&&(Se=gt,Ce=Yt)}}Tt>lt&&(Se-Je>3&&Xe(rt,Je,Se,lt),rt[Se+2]=Tt,st-Se>3&&Xe(rt,Se,st,lt))}function Ve(rt,Je,st,lt,Tt,zt){var Ce=Tt-st,Se=zt-lt;if(Ce!==0||Se!==0){var nt=((rt-st)*Ce+(Je-lt)*Se)/(Ce*Ce+Se*Se);nt>1?(st=Tt,lt=zt):nt>0&&(st+=Ce*nt,lt+=Se*nt)}return Ce=rt-st,Se=Je-lt,Ce*Ce+Se*Se}function Ie(rt,Je,st,lt){var Tt={id:typeof rt>"u"?null:rt,type:Je,geometry:st,tags:lt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return De(Tt),Tt}function De(rt){var Je=rt.geometry,st=rt.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")Ye(rt,Je);else if(st==="Polygon"||st==="MultiLineString")for(var lt=0;lt<Je.length;lt++)Ye(rt,Je[lt]);else if(st==="MultiPolygon")for(lt=0;lt<Je.length;lt++)for(var Tt=0;Tt<Je[lt].length;Tt++)Ye(rt,Je[lt][Tt])}function Ye(rt,Je){for(var st=0;st<Je.length;st+=3)rt.minX=Math.min(rt.minX,Je[st]),rt.minY=Math.min(rt.minY,Je[st+1]),rt.maxX=Math.max(rt.maxX,Je[st]),rt.maxY=Math.max(rt.maxY,Je[st+1])}function vt(rt,Je){var st=[];if(rt.type==="FeatureCollection")for(var lt=0;lt<rt.features.length;lt++)Dt(st,rt.features[lt],Je,lt);else rt.type==="Feature"?Dt(st,rt,Je):Dt(st,{geometry:rt},Je);return st}function Dt(rt,Je,st,lt){if(Je.geometry){var Tt=Je.geometry.coordinates,zt=Je.geometry.type,Ce=Math.pow(st.tolerance/((1<<st.maxZoom)*st.extent),2),Se=[],nt=Je.id;if(st.promoteId?nt=Je.properties[st.promoteId]:st.generateId&&(nt=lt||0),zt==="Point")Kt(Tt,Se);else if(zt==="MultiPoint")for(var it=0;it<Tt.length;it++)Kt(Tt[it],Se);else if(zt==="LineString")Ft(Tt,Se,Ce,!1);else if(zt==="MultiLineString")if(st.lineMetrics){for(it=0;it<Tt.length;it++)Se=[],Ft(Tt[it],Se,Ce,!1),rt.push(Ie(nt,"LineString",Se,Je.properties));return}else Mt(Tt,Se,Ce,!1);else if(zt==="Polygon")Mt(Tt,Se,Ce,!0);else if(zt==="MultiPolygon")for(it=0;it<Tt.length;it++){var ct=[];Mt(Tt[it],ct,Ce,!0),Se.push(ct)}else if(zt==="GeometryCollection"){for(it=0;it<Je.geometry.geometries.length;it++)Dt(rt,{id:nt,geometry:Je.geometry.geometries[it],properties:Je.properties},st,lt);return}else throw new Error("Input data is not a valid GeoJSON object.");rt.push(Ie(nt,zt,Se,Je.properties))}}function Kt(rt,Je){Je.push(Xt(rt[0])),Je.push(It(rt[1])),Je.push(0)}function Ft(rt,Je,st,lt){for(var Tt,zt,Ce=0,Se=0;Se<rt.length;Se++){var nt=Xt(rt[Se][0]),it=It(rt[Se][1]);Je.push(nt),Je.push(it),Je.push(0),Se>0&&(lt?Ce+=(Tt*it-nt*zt)/2:Ce+=Math.sqrt(Math.pow(nt-Tt,2)+Math.pow(it-zt,2))),Tt=nt,zt=it}var ct=Je.length-3;Je[2]=1,Xe(Je,0,ct,st),Je[ct+2]=1,Je.size=Math.abs(Ce),Je.start=0,Je.end=Je.size}function Mt(rt,Je,st,lt){for(var Tt=0;Tt<rt.length;Tt++){var zt=[];Ft(rt[Tt],zt,st,lt),Je.push(zt)}}function Xt(rt){return rt/360+.5}function It(rt){var Je=Math.sin(rt*Math.PI/180),st=.5-.25*Math.log((1+Je)/(1-Je))/Math.PI;return st<0?0:st>1?1:st}function At(rt,Je,st,lt,Tt,zt,Ce,Se){if(st/=Je,lt/=Je,zt>=st&&Ce<lt)return rt;if(Ce<st||zt>=lt)return null;for(var nt=[],it=0;it<rt.length;it++){var ct=rt[it],kt=ct.geometry,gt=ct.type,St=Tt===0?ct.minX:ct.minY,Yt=Tt===0?ct.maxX:ct.maxY;if(St>=st&&Yt<lt){nt.push(ct);continue}else if(Yt<st||St>=lt)continue;var ar=[];if(gt==="Point"||gt==="MultiPoint")Ge(kt,ar,st,lt,Tt);else if(gt==="LineString")tt(kt,ar,st,lt,Tt,!1,Se.lineMetrics);else if(gt==="MultiLineString")Ae(kt,ar,st,lt,Tt,!1);else if(gt==="Polygon")Ae(kt,ar,st,lt,Tt,!0);else if(gt==="MultiPolygon")for(var kr=0;kr<kt.length;kr++){var br=[];Ae(kt[kr],br,st,lt,Tt,!0),br.length&&ar.push(br)}if(ar.length){if(Se.lineMetrics&&gt==="LineString"){for(kr=0;kr<ar.length;kr++)nt.push(Ie(ct.id,gt,ar[kr],ct.tags));continue}(gt==="LineString"||gt==="MultiLineString")&&(ar.length===1?(gt="LineString",ar=ar[0]):gt="MultiLineString"),(gt==="Point"||gt==="MultiPoint")&&(gt=ar.length===3?"Point":"MultiPoint"),nt.push(Ie(ct.id,gt,ar,ct.tags))}}return nt.length?nt:null}function Ge(rt,Je,st,lt,Tt){for(var zt=0;zt<rt.length;zt+=3){var Ce=rt[zt+Tt];Ce>=st&&Ce<=lt&&(Je.push(rt[zt]),Je.push(rt[zt+1]),Je.push(rt[zt+2]))}}function tt(rt,Je,st,lt,Tt,zt,Ce){for(var Se=He(rt),nt=Tt===0?Ze:Qe,it=rt.start,ct,kt,gt=0;gt<rt.length-3;gt+=3){var St=rt[gt],Yt=rt[gt+1],ar=rt[gt+2],kr=rt[gt+3],br=rt[gt+4],Mr=Tt===0?St:Yt,Yr=Tt===0?kr:br,nr=!1;Ce&&(ct=Math.sqrt(Math.pow(St-kr,2)+Math.pow(Yt-br,2))),Mr<st?Yr>st&&(kt=nt(Se,St,Yt,kr,br,st),Ce&&(Se.start=it+ct*kt)):Mr>lt?Yr<lt&&(kt=nt(Se,St,Yt,kr,br,lt),Ce&&(Se.start=it+ct*kt)):Ne(Se,St,Yt,ar),Yr<st&&Mr>=st&&(kt=nt(Se,St,Yt,kr,br,st),nr=!0),Yr>lt&&Mr<=lt&&(kt=nt(Se,St,Yt,kr,br,lt),nr=!0),!zt&&nr&&(Ce&&(Se.end=it+ct*kt),Je.push(Se),Se=He(rt)),Ce&&(it+=ct)}var gr=rt.length-3;St=rt[gr],Yt=rt[gr+1],ar=rt[gr+2],Mr=Tt===0?St:Yt,Mr>=st&&Mr<=lt&&Ne(Se,St,Yt,ar),gr=Se.length-3,zt&&gr>=3&&(Se[gr]!==Se[0]||Se[gr+1]!==Se[1])&&Ne(Se,Se[0],Se[1],Se[2]),Se.length&&Je.push(Se)}function He(rt){var Je=[];return Je.size=rt.size,Je.start=rt.start,Je.end=rt.end,Je}function Ae(rt,Je,st,lt,Tt,zt){for(var Ce=0;Ce<rt.length;Ce++)tt(rt[Ce],Je,st,lt,Tt,zt,!1)}function Ne(rt,Je,st,lt){rt.push(Je),rt.push(st),rt.push(lt)}function Ze(rt,Je,st,lt,Tt,zt){var Ce=(zt-Je)/(lt-Je);return rt.push(zt),rt.push(st+(Tt-st)*Ce),rt.push(1),Ce}function Qe(rt,Je,st,lt,Tt,zt){var Ce=(zt-st)/(Tt-st);return rt.push(Je+(lt-Je)*Ce),rt.push(zt),rt.push(1),Ce}function bt(rt,Je){var st=Je.buffer/Je.extent,lt=rt,Tt=At(rt,1,-1-st,st,0,-1,2,Je),zt=At(rt,1,1-st,2+st,0,-1,2,Je);return(Tt||zt)&&(lt=At(rt,1,-st,1+st,0,-1,2,Je)||[],Tt&&(lt=dt(Tt,1).concat(lt)),zt&&(lt=lt.concat(dt(zt,-1)))),lt}function dt(rt,Je){for(var st=[],lt=0;lt<rt.length;lt++){var Tt=rt[lt],zt=Tt.type,Ce;if(zt==="Point"||zt==="MultiPoint"||zt==="LineString")Ce=wt(Tt.geometry,Je);else if(zt==="MultiLineString"||zt==="Polygon"){Ce=[];for(var Se=0;Se<Tt.geometry.length;Se++)Ce.push(wt(Tt.geometry[Se],Je))}else if(zt==="MultiPolygon")for(Ce=[],Se=0;Se<Tt.geometry.length;Se++){for(var nt=[],it=0;it<Tt.geometry[Se].length;it++)nt.push(wt(Tt.geometry[Se][it],Je));Ce.push(nt)}st.push(Ie(Tt.id,zt,Ce,Tt.tags))}return st}function wt(rt,Je){var st=[];st.size=rt.size,rt.start!==void 0&&(st.start=rt.start,st.end=rt.end);for(var lt=0;lt<rt.length;lt+=3)st.push(rt[lt]+Je,rt[lt+1],rt[lt+2]);return st}function Ut(rt,Je){if(rt.transformed)return rt;var st=1<<rt.z,lt=rt.x,Tt=rt.y,zt,Ce,Se;for(zt=0;zt<rt.features.length;zt++){var nt=rt.features[zt],it=nt.geometry,ct=nt.type;if(nt.geometry=[],ct===1)for(Ce=0;Ce<it.length;Ce+=2)nt.geometry.push(Rt(it[Ce],it[Ce+1],Je,st,lt,Tt));else for(Ce=0;Ce<it.length;Ce++){var kt=[];for(Se=0;Se<it[Ce].length;Se+=2)kt.push(Rt(it[Ce][Se],it[Ce][Se+1],Je,st,lt,Tt));nt.geometry.push(kt)}}return rt.transformed=!0,rt}function Rt(rt,Je,st,lt,Tt,zt){return[Math.round(st*(rt*lt-Tt)),Math.round(st*(Je*lt-zt))]}function Nt(rt,Je,st,lt,Tt){for(var zt=Je===Tt.maxZoom?0:Tt.tolerance/((1<<Je)*Tt.extent),Ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:st,y:lt,z:Je,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Se=0;Se<rt.length;Se++){Ce.numFeatures++,Wt(Ce,rt[Se],zt,Tt);var nt=rt[Se].minX,it=rt[Se].minY,ct=rt[Se].maxX,kt=rt[Se].maxY;nt<Ce.minX&&(Ce.minX=nt),it<Ce.minY&&(Ce.minY=it),ct>Ce.maxX&&(Ce.maxX=ct),kt>Ce.maxY&&(Ce.maxY=kt)}return Ce}function Wt(rt,Je,st,lt){var Tt=Je.geometry,zt=Je.type,Ce=[];if(zt==="Point"||zt==="MultiPoint")for(var Se=0;Se<Tt.length;Se+=3)Ce.push(Tt[Se]),Ce.push(Tt[Se+1]),rt.numPoints++,rt.numSimplified++;else if(zt==="LineString")Vt(Ce,Tt,rt,st,!1,!1);else if(zt==="MultiLineString"||zt==="Polygon")for(Se=0;Se<Tt.length;Se++)Vt(Ce,Tt[Se],rt,st,zt==="Polygon",Se===0);else if(zt==="MultiPolygon")for(var nt=0;nt<Tt.length;nt++){var it=Tt[nt];for(Se=0;Se<it.length;Se++)Vt(Ce,it[Se],rt,st,!0,Se===0)}if(Ce.length){var ct=Je.tags||null;if(zt==="LineString"&&lt.lineMetrics){ct={};for(var kt in Je.tags)ct[kt]=Je.tags[kt];ct.mapbox_clip_start=Tt.start/Tt.size,ct.mapbox_clip_end=Tt.end/Tt.size}var gt={geometry:Ce,type:zt==="Polygon"||zt==="MultiPolygon"?3:zt==="LineString"||zt==="MultiLineString"?2:1,tags:ct};Je.id!==null&&(gt.id=Je.id),rt.features.push(gt)}}function Vt(rt,Je,st,lt,Tt,zt){var Ce=lt*lt;if(lt>0&&Je.size<(Tt?Ce:lt)){st.numPoints+=Je.length/3;return}for(var Se=[],nt=0;nt<Je.length;nt+=3)(lt===0||Je[nt+2]>Ce)&&(st.numSimplified++,Se.push(Je[nt]),Se.push(Je[nt+1])),st.numPoints++;Tt&&ir(Se,zt),rt.push(Se)}function ir(rt,Je){for(var st=0,lt=0,Tt=rt.length,zt=Tt-2;lt<Tt;zt=lt,lt+=2)st+=(rt[lt]-rt[zt])*(rt[lt+1]+rt[zt+1]);if(st>0===Je)for(lt=0,Tt=rt.length;lt<Tt/2;lt+=2){var Ce=rt[lt],Se=rt[lt+1];rt[lt]=rt[Tt-2-lt],rt[lt+1]=rt[Tt-1-lt],rt[Tt-2-lt]=Ce,rt[Tt-1-lt]=Se}}function Hr(rt,Je){return new sn(rt,Je)}function sn(rt,Je){Je=this.options=at(Object.create(this.options),Je);var st=Je.debug;if(st&&console.time("preprocess data"),Je.maxZoom<0||Je.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Je.promoteId&&Je.generateId)throw new Error("promoteId and generateId cannot be used together.");var lt=vt(rt,Je);this.tiles={},this.tileCoords=[],st&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Je.indexMaxZoom,Je.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),lt=bt(lt,Je),lt.length&&this.splitTile(lt,0,0,0),st&&(lt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}sn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},sn.prototype.splitTile=function(rt,Je,st,lt,Tt,zt,Ce){for(var Se=[rt,Je,st,lt],nt=this.options,it=nt.debug;Se.length;){lt=Se.pop(),st=Se.pop(),Je=Se.pop(),rt=Se.pop();var ct=1<<Je,kt=jr(Je,st,lt),gt=this.tiles[kt];if(!gt&&(it>1&&console.time("creation"),gt=this.tiles[kt]=Nt(rt,Je,st,lt,nt),this.tileCoords.push({z:Je,x:st,y:lt}),it)){it>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Je,st,lt,gt.numFeatures,gt.numPoints,gt.numSimplified),console.timeEnd("creation"));var St="z"+Je;this.stats[St]=(this.stats[St]||0)+1,this.total++}if(gt.source=rt,Tt){if(Je===nt.maxZoom||Je===Tt)continue;var Yt=1<<Tt-Je;if(st!==Math.floor(zt/Yt)||lt!==Math.floor(Ce/Yt))continue}else if(Je===nt.indexMaxZoom||gt.numPoints<=nt.indexMaxPoints)continue;if(gt.source=null,rt.length!==0){it>1&&console.time("clipping");var ar=.5*nt.buffer/nt.extent,kr=.5-ar,br=.5+ar,Mr=1+ar,Yr,nr,gr,Rr,Br,Sr;Yr=nr=gr=Rr=null,Br=At(rt,ct,st-ar,st+br,0,gt.minX,gt.maxX,nt),Sr=At(rt,ct,st+kr,st+Mr,0,gt.minX,gt.maxX,nt),rt=null,Br&&(Yr=At(Br,ct,lt-ar,lt+br,1,gt.minY,gt.maxY,nt),nr=At(Br,ct,lt+kr,lt+Mr,1,gt.minY,gt.maxY,nt),Br=null),Sr&&(gr=At(Sr,ct,lt-ar,lt+br,1,gt.minY,gt.maxY,nt),Rr=At(Sr,ct,lt+kr,lt+Mr,1,gt.minY,gt.maxY,nt),Sr=null),it>1&&console.timeEnd("clipping"),Se.push(Yr||[],Je+1,st*2,lt*2),Se.push(nr||[],Je+1,st*2,lt*2+1),Se.push(gr||[],Je+1,st*2+1,lt*2),Se.push(Rr||[],Je+1,st*2+1,lt*2+1)}}},sn.prototype.getTile=function(rt,Je,st){var lt=this.options,Tt=lt.extent,zt=lt.debug;if(rt<0||rt>24)return null;var Ce=1<<rt;Je=(Je%Ce+Ce)%Ce;var Se=jr(rt,Je,st);if(this.tiles[Se])return Ut(this.tiles[Se],Tt);zt>1&&console.log("drilling down to z%d-%d-%d",rt,Je,st);for(var nt=rt,it=Je,ct=st,kt;!kt&&nt>0;)nt--,it=Math.floor(it/2),ct=Math.floor(ct/2),kt=this.tiles[jr(nt,it,ct)];return!kt||!kt.source?null:(zt>1&&console.log("found parent tile z%d-%d-%d",nt,it,ct),zt>1&&console.time("drilling down"),this.splitTile(kt.source,nt,it,ct,rt,Je,st),zt>1&&console.timeEnd("drilling down"),this.tiles[Se]?Ut(this.tiles[Se],Tt):null)};function jr(rt,Je,st){return((1<<rt)*st+Je)*32+rt}function at(rt,Je){for(var st in Je)rt[st]=Je[st];return rt}function $t(rt,Je){var st=rt.tileID.canonical;if(!this._geoJSONIndex)return Je(null,null);var lt=this._geoJSONIndex.getTile(st.z,st.x,st.y);if(!lt)return Je(null,null);var Tt=new b(lt.features),zt=P(Tt);(zt.byteOffset!==0||zt.byteLength!==zt.buffer.byteLength)&&(zt=new Uint8Array(zt)),Je(null,{vectorTile:Tt,rawData:zt.buffer})}var Jt=function(rt){function Je(st,lt,Tt,zt){rt.call(this,st,lt,Tt,$t),zt&&(this.loadGeoJSON=zt)}return rt&&(Je.__proto__=rt),Je.prototype=Object.create(rt&&rt.prototype),Je.prototype.constructor=Je,Je.prototype.loadData=function(lt,Tt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Tt,this._pendingLoadDataParams=lt,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Je.prototype._loadData=function(){var lt=this;if(!(!this._pendingCallback||!this._pendingLoadDataParams)){var Tt=this._pendingCallback,zt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ce=zt&&zt.request&&zt.request.collectResourceTiming?new e.RequestPerformance(zt.request):!1;this.loadGeoJSON(zt,function(Se,nt){if(Se||!nt)return Tt(Se);if(typeof nt!="object")return Tt(new Error("Input data given to '"+zt.source+"' is not a valid GeoJSON object."));o(nt,!0);try{lt._geoJSONIndex=zt.cluster?new oe(Gt(zt)).load(nt.features):Hr(nt,zt.geojsonVtOptions)}catch(kt){return Tt(kt)}lt.loaded={};var it={};if(Ce){var ct=Ce.finish();ct&&(it.resourceTiming={},it.resourceTiming[zt.source]=JSON.parse(JSON.stringify(ct)))}Tt(null,it)})}},Je.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Je.prototype.reloadTile=function(lt,Tt){var zt=this.loaded,Ce=lt.uid;return zt&&zt[Ce]?rt.prototype.reloadTile.call(this,lt,Tt):this.loadTile(lt,Tt)},Je.prototype.loadGeoJSON=function(lt,Tt){if(lt.request)e.getJSON(lt.request,Tt);else if(typeof lt.data=="string")try{return Tt(null,JSON.parse(lt.data))}catch{return Tt(new Error("Input data given to '"+lt.source+"' is not a valid GeoJSON object."))}else return Tt(new Error("Input data given to '"+lt.source+"' is not a valid GeoJSON object."))},Je.prototype.removeSource=function(lt,Tt){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Tt()},Je.prototype.getClusterExpansionZoom=function(lt,Tt){try{Tt(null,this._geoJSONIndex.getClusterExpansionZoom(lt.clusterId))}catch(zt){Tt(zt)}},Je.prototype.getClusterChildren=function(lt,Tt){try{Tt(null,this._geoJSONIndex.getChildren(lt.clusterId))}catch(zt){Tt(zt)}},Je.prototype.getClusterLeaves=function(lt,Tt){try{Tt(null,this._geoJSONIndex.getLeaves(lt.clusterId,lt.limit,lt.offset))}catch(zt){Tt(zt)}},Je}(v);function Gt(rt){var Je=rt.superclusterOptions,st=rt.clusterProperties;if(!st||!Je)return Je;for(var lt={},Tt={},zt={accumulated:null,zoom:0},Ce={properties:null},Se=Object.keys(st),nt=0,it=Se;nt<it.length;nt+=1){var ct=it[nt],kt=st[ct],gt=kt[0],St=kt[1],Yt=e.createExpression(St),ar=e.createExpression(typeof gt=="string"?[gt,["accumulated"],["get",ct]]:gt);lt[ct]=Yt.value,Tt[ct]=ar.value}return Je.map=function(kr){Ce.properties=kr;for(var br={},Mr=0,Yr=Se;Mr<Yr.length;Mr+=1){var nr=Yr[Mr];br[nr]=lt[nr].evaluate(zt,Ce)}return br},Je.reduce=function(kr,br){Ce.properties=br;for(var Mr=0,Yr=Se;Mr<Yr.length;Mr+=1){var nr=Yr[Mr];zt.accumulated=kr[nr],kr[nr]=Tt[nr].evaluate(zt,Ce)}},Je}var _r=function(Je){var st=this;this.self=Je,this.actor=new e.Actor(Je,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:v,geojson:Jt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(lt,Tt){if(st.workerSourceTypes[lt])throw new Error('Worker source with name "'+lt+'" already registered.');st.workerSourceTypes[lt]=Tt},this.self.registerRTLTextPlugin=function(lt){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=lt.applyArabicShaping,e.plugin.processBidirectionalText=lt.processBidirectionalText,e.plugin.processStyledBidirectionalText=lt.processStyledBidirectionalText}};return _r.prototype.setReferrer=function(Je,st){this.referrer=st},_r.prototype.setImages=function(Je,st,lt){this.availableImages[Je]=st;for(var Tt in this.workerSources[Je]){var zt=this.workerSources[Je][Tt];for(var Ce in zt)zt[Ce].availableImages=st}lt()},_r.prototype.setLayers=function(Je,st,lt){this.getLayerIndex(Je).replace(st),lt()},_r.prototype.updateLayers=function(Je,st,lt){this.getLayerIndex(Je).update(st.layers,st.removedIds),lt()},_r.prototype.loadTile=function(Je,st,lt){this.getWorkerSource(Je,st.type,st.source).loadTile(st,lt)},_r.prototype.loadDEMTile=function(Je,st,lt){this.getDEMWorkerSource(Je,st.source).loadTile(st,lt)},_r.prototype.reloadTile=function(Je,st,lt){this.getWorkerSource(Je,st.type,st.source).reloadTile(st,lt)},_r.prototype.abortTile=function(Je,st,lt){this.getWorkerSource(Je,st.type,st.source).abortTile(st,lt)},_r.prototype.removeTile=function(Je,st,lt){this.getWorkerSource(Je,st.type,st.source).removeTile(st,lt)},_r.prototype.removeDEMTile=function(Je,st){this.getDEMWorkerSource(Je,st.source).removeTile(st)},_r.prototype.removeSource=function(Je,st,lt){if(!(!this.workerSources[Je]||!this.workerSources[Je][st.type]||!this.workerSources[Je][st.type][st.source])){var Tt=this.workerSources[Je][st.type][st.source];delete this.workerSources[Je][st.type][st.source],Tt.removeSource!==void 0?Tt.removeSource(st,lt):lt()}},_r.prototype.loadWorkerSource=function(Je,st,lt){try{this.self.importScripts(st.url),lt()}catch(Tt){lt(Tt.toString())}},_r.prototype.syncRTLPluginState=function(Je,st,lt){try{e.plugin.setState(st);var Tt=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&Tt!=null){this.self.importScripts(Tt);var zt=e.plugin.isParsed(),Ce=zt?void 0:new Error("RTL Text Plugin failed to import scripts from "+Tt);lt(Ce,zt)}}catch(Se){lt(Se.toString())}},_r.prototype.getAvailableImages=function(Je){var st=this.availableImages[Je];return st||(st=[]),st},_r.prototype.getLayerIndex=function(Je){var st=this.layerIndexes[Je];return st||(st=this.layerIndexes[Je]=new t),st},_r.prototype.getWorkerSource=function(Je,st,lt){var Tt=this;if(this.workerSources[Je]||(this.workerSources[Je]={}),this.workerSources[Je][st]||(this.workerSources[Je][st]={}),!this.workerSources[Je][st][lt]){var zt={send:function(Ce,Se,nt){Tt.actor.send(Ce,Se,nt,Je)}};this.workerSources[Je][st][lt]=new this.workerSourceTypes[st](zt,this.getLayerIndex(Je),this.getAvailableImages(Je))}return this.workerSources[Je][st][lt]},_r.prototype.getDEMWorkerSource=function(Je,st){return this.demWorkerSources[Je]||(this.demWorkerSources[Je]={}),this.demWorkerSources[Je][st]||(this.demWorkerSources[Je][st]=new d),this.demWorkerSources[Je][st]},_r.prototype.enforceCacheSizeLimit=function(Je,st){e.enforceCacheSizeLimit(st)},typeof WorkerGlobalScope<"u"&&typeof e.window<"u"&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new _r(e.window)),_r}),M(["./shared"],function(e){var a=e.createCommonjsModule(function(fe){fe.exports?fe.exports=V:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=V,window.mapboxgl.notSupportedReason=ve);function V(Ur){return!ve(Ur)}function ve(Ur){if(!Z())return"not a browser";if(!pe())return"insufficent Array support";if(!Me())return"insufficient Function support";if(!Re())return"insufficient Object support";if(!je())return"insufficient JSON support";if(!ut())return"insufficient worker support";if(!Ct())return"insufficient Uint8ClampedArray support";if(!Qt())return"insufficient ArrayBuffer support";if(!ur())return"insufficient Canvas/getImageData support";if(!Cr(Ur&&Ur.failIfMajorPerformanceCaveat))return"insufficient WebGL support"}function Z(){return typeof window<"u"&&typeof document<"u"}function pe(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function Me(){return Function.prototype&&Function.prototype.bind}function Re(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function je(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function ut(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Ur=new Blob([""],{type:"text/javascript"}),Jr=URL.createObjectURL(Ur),hn,Cn;try{Cn=new Worker(Jr),hn=!0}catch{hn=!1}return Cn&&Cn.terminate(),URL.revokeObjectURL(Jr),hn}function Ct(){return"Uint8ClampedArray"in window}function Qt(){return ArrayBuffer.isView}function ur(){var Ur=document.createElement("canvas");Ur.width=Ur.height=1;var Jr=Ur.getContext("2d");if(!Jr)return!1;var hn=Jr.getImageData(0,0,1,1);return hn&&hn.width===Ur.width}var vr={};function Cr(Ur){return vr[Ur]===void 0&&(vr[Ur]=Wr(Ur)),vr[Ur]}V.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};function Vr(Ur){var Jr=document.createElement("canvas"),hn=Object.create(V.webGLContextAttributes);return hn.failIfMajorPerformanceCaveat=Ur,Jr.probablySupportsContext?Jr.probablySupportsContext("webgl",hn)||Jr.probablySupportsContext("experimental-webgl",hn):Jr.supportsContext?Jr.supportsContext("webgl",hn)||Jr.supportsContext("experimental-webgl",hn):Jr.getContext("webgl",hn)||Jr.getContext("experimental-webgl",hn)}function Wr(Ur){var Jr=Vr(Ur);if(!Jr)return!1;var hn=Jr.createShader(Jr.VERTEX_SHADER);return!hn||Jr.isContextLost()?!1:(Jr.shaderSource(hn,"void main() {}"),Jr.compileShader(hn),Jr.getShaderParameter(hn,Jr.COMPILE_STATUS)===!0)}}),n={};n.create=function(fe,V,ve){var Z=e.window.document.createElement(fe);return V!==void 0&&(Z.className=V),ve&&ve.appendChild(Z),Z},n.createNS=function(fe,V){var ve=e.window.document.createElementNS(fe,V);return ve};var r=e.window.document.documentElement.style;function t(fe){if(!r)return fe[0];for(var V=0;V<fe.length;V++)if(fe[V]in r)return fe[V];return fe[0]}var h=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),s;n.disableDrag=function(){r&&h&&(s=r[h],r[h]="none")},n.enableDrag=function(){r&&h&&(r[h]=s)};var i=t(["transform","WebkitTransform"]);n.setTransform=function(fe,V){fe.style[i]=V};var x=!1;try{var p=Object.defineProperty({},"passive",{get:function(){x=!0}});e.window.addEventListener("test",p,p),e.window.removeEventListener("test",p,p)}catch{x=!1}n.addEventListener=function(fe,V,ve,Z){Z===void 0&&(Z={}),"passive"in Z&&x?fe.addEventListener(V,ve,Z):fe.addEventListener(V,ve,Z.capture)},n.removeEventListener=function(fe,V,ve,Z){Z===void 0&&(Z={}),"passive"in Z&&x?fe.removeEventListener(V,ve,Z):fe.removeEventListener(V,ve,Z.capture)};var v=function(fe){fe.preventDefault(),fe.stopPropagation(),e.window.removeEventListener("click",v,!0)};n.suppressClick=function(){e.window.addEventListener("click",v,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",v,!0)},0)},n.mousePos=function(fe,V){var ve=fe.getBoundingClientRect();return new e.Point(V.clientX-ve.left-fe.clientLeft,V.clientY-ve.top-fe.clientTop)},n.touchPos=function(fe,V){for(var ve=fe.getBoundingClientRect(),Z=[],pe=0;pe<V.length;pe++)Z.push(new e.Point(V[pe].clientX-ve.left-fe.clientLeft,V[pe].clientY-ve.top-fe.clientTop));return Z},n.mouseButton=function(fe){return typeof e.window.InstallTrigger<"u"&&fe.button===2&&fe.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:fe.button},n.remove=function(fe){fe.parentNode&&fe.parentNode.removeChild(fe)};function f(fe,V,ve){var Z,pe,Me,Re=e.browser.devicePixelRatio>1?"@2x":"",je=e.getJSON(V.transformRequest(V.normalizeSpriteURL(fe,Re,".json"),e.ResourceType.SpriteJSON),function(Qt,ur){je=null,Me||(Me=Qt,Z=ur,Ct())}),ut=e.getImage(V.transformRequest(V.normalizeSpriteURL(fe,Re,".png"),e.ResourceType.SpriteImage),function(Qt,ur){ut=null,Me||(Me=Qt,pe=ur,Ct())});function Ct(){if(Me)ve(Me);else if(Z&&pe){var Qt=e.browser.getImageData(pe),ur={};for(var vr in Z){var Cr=Z[vr],Vr=Cr.width,Wr=Cr.height,Ur=Cr.x,Jr=Cr.y,hn=Cr.sdf,Cn=Cr.pixelRatio,Fn=Cr.stretchX,Kn=Cr.stretchY,qn=Cr.content,Qn=new e.RGBAImage({width:Vr,height:Wr});e.RGBAImage.copy(Qt,Qn,{x:Ur,y:Jr},{x:0,y:0},{width:Vr,height:Wr}),ur[vr]={data:Qn,pixelRatio:Cn,sdf:hn,stretchX:Fn,stretchY:Kn,content:qn}}ve(null,ur)}}return{cancel:function(){je&&(je.cancel(),je=null),ut&&(ut.cancel(),ut=null)}}}function d(fe){var V=fe.userImage;if(V&&V.render){var ve=V.render();if(ve)return fe.data.replace(new Uint8Array(V.data.buffer)),!0}return!1}var o=1,m=function(fe){function V(){fe.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.isLoaded=function(){return this.loaded},V.prototype.setLoaded=function(Z){if(this.loaded!==Z&&(this.loaded=Z,Z)){for(var pe=0,Me=this.requestors;pe<Me.length;pe+=1){var Re=Me[pe],je=Re.ids,ut=Re.callback;this._notify(je,ut)}this.requestors=[]}},V.prototype.getImage=function(Z){return this.images[Z]},V.prototype.addImage=function(Z,pe){this._validate(Z,pe)&&(this.images[Z]=pe)},V.prototype._validate=function(Z,pe){var Me=!0;return this._validateStretch(pe.stretchX,pe.data&&pe.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+Z+'" has invalid "stretchX" value'))),Me=!1),this._validateStretch(pe.stretchY,pe.data&&pe.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+Z+'" has invalid "stretchY" value'))),Me=!1),this._validateContent(pe.content,pe)||(this.fire(new e.ErrorEvent(new Error('Image "'+Z+'" has invalid "content" value'))),Me=!1),Me},V.prototype._validateStretch=function(Z,pe){if(!Z)return!0;for(var Me=0,Re=0,je=Z;Re<je.length;Re+=1){var ut=je[Re];if(ut[0]<Me||ut[1]<ut[0]||pe<ut[1])return!1;Me=ut[1]}return!0},V.prototype._validateContent=function(Z,pe){return Z?!(Z.length!==4||Z[0]<0||pe.data.width<Z[0]||Z[1]<0||pe.data.height<Z[1]||Z[2]<0||pe.data.width<Z[2]||Z[3]<0||pe.data.height<Z[3]||Z[2]<Z[0]||Z[3]<Z[1]):!0},V.prototype.updateImage=function(Z,pe){var Me=this.images[Z];pe.version=Me.version+1,this.images[Z]=pe,this.updatedImages[Z]=!0},V.prototype.removeImage=function(Z){var pe=this.images[Z];delete this.images[Z],delete this.patterns[Z],pe.userImage&&pe.userImage.onRemove&&pe.userImage.onRemove()},V.prototype.listImages=function(){return Object.keys(this.images)},V.prototype.getImages=function(Z,pe){var Me=!0;if(!this.isLoaded())for(var Re=0,je=Z;Re<je.length;Re+=1){var ut=je[Re];this.images[ut]||(Me=!1)}this.isLoaded()||Me?this._notify(Z,pe):this.requestors.push({ids:Z,callback:pe})},V.prototype._notify=function(Z,pe){for(var Me={},Re=0,je=Z;Re<je.length;Re+=1){var ut=je[Re];this.images[ut]||this.fire(new e.Event("styleimagemissing",{id:ut}));var Ct=this.images[ut];Ct?Me[ut]={data:Ct.data.clone(),pixelRatio:Ct.pixelRatio,sdf:Ct.sdf,version:Ct.version,stretchX:Ct.stretchX,stretchY:Ct.stretchY,content:Ct.content,hasRenderCallback:!!(Ct.userImage&&Ct.userImage.render)}:e.warnOnce('Image "'+ut+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}pe(null,Me)},V.prototype.getPixelSize=function(){var Z=this.atlasImage,pe=Z.width,Me=Z.height;return{width:pe,height:Me}},V.prototype.getPattern=function(Z){var pe=this.patterns[Z],Me=this.getImage(Z);if(!Me)return null;if(pe&&pe.position.version===Me.version)return pe.position;if(pe)pe.position.version=Me.version;else{var Re=Me.data.width+o*2,je=Me.data.height+o*2,ut={w:Re,h:je,x:0,y:0},Ct=new e.ImagePosition(ut,Me);this.patterns[Z]={bin:ut,position:Ct}}return this._updatePatternAtlas(),this.patterns[Z].position},V.prototype.bind=function(Z){var pe=Z.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(Z,this.atlasImage,pe.RGBA),this.atlasTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)},V.prototype._updatePatternAtlas=function(){var Z=[];for(var pe in this.patterns)Z.push(this.patterns[pe].bin);var Me=e.potpack(Z),Re=Me.w,je=Me.h,ut=this.atlasImage;ut.resize({width:Re||1,height:je||1});for(var Ct in this.patterns){var Qt=this.patterns[Ct],ur=Qt.bin,vr=ur.x+o,Cr=ur.y+o,Vr=this.images[Ct].data,Wr=Vr.width,Ur=Vr.height;e.RGBAImage.copy(Vr,ut,{x:0,y:0},{x:vr,y:Cr},{width:Wr,height:Ur}),e.RGBAImage.copy(Vr,ut,{x:0,y:Ur-1},{x:vr,y:Cr-1},{width:Wr,height:1}),e.RGBAImage.copy(Vr,ut,{x:0,y:0},{x:vr,y:Cr+Ur},{width:Wr,height:1}),e.RGBAImage.copy(Vr,ut,{x:Wr-1,y:0},{x:vr-1,y:Cr},{width:1,height:Ur}),e.RGBAImage.copy(Vr,ut,{x:0,y:0},{x:vr+Wr,y:Cr},{width:1,height:Ur})}this.dirty=!0},V.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},V.prototype.dispatchRenderCallbacks=function(Z){for(var pe=0,Me=Z;pe<Me.length;pe+=1){var Re=Me[pe];if(!this.callbackDispatchedThisFrame[Re]){this.callbackDispatchedThisFrame[Re]=!0;var je=this.images[Re],ut=d(je);ut&&this.updateImage(Re,je)}}},V}(e.Evented);function l(fe,V,ve,Z,pe){var Me=V*256,Re=Me+255,je=Z.transformRequest(Z.normalizeGlyphsURL(ve).replace("{fontstack}",fe).replace("{range}",Me+"-"+Re),e.ResourceType.Glyphs);e.getArrayBuffer(je,function(ut,Ct){if(ut)pe(ut);else if(Ct){for(var Qt={},ur=0,vr=e.parseGlyphPBF(Ct);ur<vr.length;ur+=1){var Cr=vr[ur];Qt[Cr.id]=Cr}pe(null,Qt)}})}var w=b,_=b,c=1e20;function b(fe,V,ve,Z,pe,Me){this.fontSize=fe||24,this.buffer=V===void 0?3:V,this.cutoff=Z||.25,this.fontFamily=pe||"sans-serif",this.fontWeight=Me||"normal",this.radius=ve||8;var Re=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Re,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Re*Re),this.gridInner=new Float64Array(Re*Re),this.f=new Float64Array(Re),this.d=new Float64Array(Re),this.z=new Float64Array(Re+1),this.v=new Int16Array(Re),this.middle=Math.round(Re/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}b.prototype.draw=function(fe){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(fe,this.buffer,this.middle);for(var V=this.ctx.getImageData(0,0,this.size,this.size),ve=new Uint8ClampedArray(this.size*this.size),Z=0;Z<this.size*this.size;Z++){var pe=V.data[Z*4+3]/255;this.gridOuter[Z]=pe===1?0:pe===0?c:Math.pow(Math.max(0,.5-pe),2),this.gridInner[Z]=pe===1?c:pe===0?0:Math.pow(Math.max(0,pe-.5),2)}for(u(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),u(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),Z=0;Z<this.size*this.size;Z++){var Me=this.gridOuter[Z]-this.gridInner[Z];ve[Z]=Math.max(0,Math.min(255,Math.round(255-255*(Me/this.radius+this.cutoff))))}return ve};function u(fe,V,ve,Z,pe,Me,Re){for(var je=0;je<V;je++){for(var ut=0;ut<ve;ut++)Z[ut]=fe[ut*V+je];for(L(Z,pe,Me,Re,ve),ut=0;ut<ve;ut++)fe[ut*V+je]=pe[ut]}for(ut=0;ut<ve;ut++){for(je=0;je<V;je++)Z[je]=fe[ut*V+je];for(L(Z,pe,Me,Re,V),je=0;je<V;je++)fe[ut*V+je]=Math.sqrt(pe[je])}}function L(fe,V,ve,Z,pe){ve[0]=0,Z[0]=-c,Z[1]=+c;for(var Me=1,Re=0;Me<pe;Me++){for(var je=(fe[Me]+Me*Me-(fe[ve[Re]]+ve[Re]*ve[Re]))/(2*Me-2*ve[Re]);je<=Z[Re];)Re--,je=(fe[Me]+Me*Me-(fe[ve[Re]]+ve[Re]*ve[Re]))/(2*Me-2*ve[Re]);Re++,ve[Re]=Me,Z[Re]=je,Z[Re+1]=+c}for(Me=0,Re=0;Me<pe;Me++){for(;Z[Re+1]<Me;)Re++;V[Me]=(Me-ve[Re])*(Me-ve[Re])+fe[ve[Re]]}}w.default=_;var T=function(V,ve){this.requestManager=V,this.localIdeographFontFamily=ve,this.entries={}};T.prototype.setURL=function(V){this.url=V},T.prototype.getGlyphs=function(V,ve){var Z=this,pe=[];for(var Me in V)for(var Re=0,je=V[Me];Re<je.length;Re+=1){var ut=je[Re];pe.push({stack:Me,id:ut})}e.asyncAll(pe,function(Ct,Qt){var ur=Ct.stack,vr=Ct.id,Cr=Z.entries[ur];Cr||(Cr=Z.entries[ur]={glyphs:{},requests:{},ranges:{}});var Vr=Cr.glyphs[vr];if(Vr!==void 0){Qt(null,{stack:ur,id:vr,glyph:Vr});return}if(Vr=Z._tinySDF(Cr,ur,vr),Vr){Cr.glyphs[vr]=Vr,Qt(null,{stack:ur,id:vr,glyph:Vr});return}var Wr=Math.floor(vr/256);if(Wr*256>65535){Qt(new Error("glyphs > 65535 not supported"));return}if(Cr.ranges[Wr]){Qt(null,{stack:ur,id:vr,glyph:Vr});return}var Ur=Cr.requests[Wr];Ur||(Ur=Cr.requests[Wr]=[],T.loadGlyphRange(ur,Wr,Z.url,Z.requestManager,function(Jr,hn){if(hn){for(var Cn in hn)Z._doesCharSupportLocalGlyph(+Cn)||(Cr.glyphs[+Cn]=hn[+Cn]);Cr.ranges[Wr]=!0}for(var Fn=0,Kn=Ur;Fn<Kn.length;Fn+=1){var qn=Kn[Fn];qn(Jr,hn)}delete Cr.requests[Wr]})),Ur.push(function(Jr,hn){Jr?Qt(Jr):hn&&Qt(null,{stack:ur,id:vr,glyph:hn[vr]||null})})},function(Ct,Qt){if(Ct)ve(Ct);else if(Qt){for(var ur={},vr=0,Cr=Qt;vr<Cr.length;vr+=1){var Vr=Cr[vr],Wr=Vr.stack,Ur=Vr.id,Jr=Vr.glyph;(ur[Wr]||(ur[Wr]={}))[Ur]=Jr&&{id:Jr.id,bitmap:Jr.bitmap.clone(),metrics:Jr.metrics}}ve(null,ur)}})},T.prototype._doesCharSupportLocalGlyph=function(V){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](V)||e.isChar["Hangul Syllables"](V)||e.isChar.Hiragana(V)||e.isChar.Katakana(V))},T.prototype._tinySDF=function(V,ve,Z){var pe=this.localIdeographFontFamily;if(pe&&this._doesCharSupportLocalGlyph(Z)){var Me=V.tinySDF;if(!Me){var Re="400";/bold/i.test(ve)?Re="900":/medium/i.test(ve)?Re="500":/light/i.test(ve)&&(Re="200"),Me=V.tinySDF=new T.TinySDF(24,3,8,.25,pe,Re)}return{id:Z,bitmap:new e.AlphaImage({width:30,height:30},Me.draw(String.fromCharCode(Z))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},T.loadGlyphRange=l,T.TinySDF=w;var k=function(){this.specification=e.styleSpec.light.position};k.prototype.possiblyEvaluate=function(V,ve){return e.sphericalToCartesian(V.expression.evaluate(ve))},k.prototype.interpolate=function(V,ve,Z){return{x:e.number(V.x,ve.x,Z),y:e.number(V.y,ve.y,Z),z:e.number(V.z,ve.z,Z)}};var P=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new k,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),z="-transition",I=function(fe){function V(ve){fe.call(this),this._transitionable=new e.Transitionable(P),this.setLight(ve),this._transitioning=this._transitionable.untransitioned()}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getLight=function(){return this._transitionable.serialize()},V.prototype.setLight=function(Z,pe){if(pe===void 0&&(pe={}),!this._validate(e.validateLight,Z,pe))for(var Me in Z){var Re=Z[Me];e.endsWith(Me,z)?this._transitionable.setTransition(Me.slice(0,-z.length),Re):this._transitionable.setValue(Me,Re)}},V.prototype.updateTransitions=function(Z){this._transitioning=this._transitionable.transitioned(Z,this._transitioning)},V.prototype.hasTransition=function(){return this._transitioning.hasTransition()},V.prototype.recalculate=function(Z){this.properties=this._transitioning.possiblyEvaluate(Z)},V.prototype._validate=function(Z,pe,Me){return Me&&Me.validate===!1?!1:e.emitValidationErrors(this,Z.call(e.validateStyle,e.extend({value:pe,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},V}(e.Evented),D=function(V,ve){this.width=V,this.height=ve,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};D.prototype.getDash=function(V,ve){var Z=V.join(",")+String(ve);return this.dashEntry[Z]||(this.dashEntry[Z]=this.addDash(V,ve)),this.dashEntry[Z]},D.prototype.getDashRanges=function(V,ve,Z){var pe=V.length%2===1,Me=[],Re=pe?-V[V.length-1]*Z:0,je=V[0]*Z,ut=!0;Me.push({left:Re,right:je,isDash:ut,zeroLength:V[0]===0});for(var Ct=V[0],Qt=1;Qt<V.length;Qt++){ut=!ut;var ur=V[Qt];Re=Ct*Z,Ct+=ur,je=Ct*Z,Me.push({left:Re,right:je,isDash:ut,zeroLength:ur===0})}return Me},D.prototype.addRoundDash=function(V,ve,Z){for(var pe=ve/2,Me=-Z;Me<=Z;Me++)for(var Re=this.nextRow+Z+Me,je=this.width*Re,ut=0,Ct=V[ut],Qt=0;Qt<this.width;Qt++){Qt/Ct.right>1&&(Ct=V[++ut]);var ur=Math.abs(Qt-Ct.left),vr=Math.abs(Qt-Ct.right),Cr=Math.min(ur,vr),Vr=void 0,Wr=Me/Z*(pe+1);if(Ct.isDash){var Ur=pe-Math.abs(Wr);Vr=Math.sqrt(Cr*Cr+Ur*Ur)}else Vr=pe-Math.sqrt(Cr*Cr+Wr*Wr);this.data[je+Qt]=Math.max(0,Math.min(255,Vr+128))}},D.prototype.addRegularDash=function(V){for(var ve=V.length-1;ve>=0;--ve){var Z=V[ve],pe=V[ve+1];Z.zeroLength?V.splice(ve,1):pe&&pe.isDash===Z.isDash&&(pe.left=Z.left,V.splice(ve,1))}var Me=V[0],Re=V[V.length-1];Me.isDash===Re.isDash&&(Me.left=Re.left-this.width,Re.right=Me.right+this.width);for(var je=this.width*this.nextRow,ut=0,Ct=V[ut],Qt=0;Qt<this.width;Qt++){Qt/Ct.right>1&&(Ct=V[++ut]);var ur=Math.abs(Qt-Ct.left),vr=Math.abs(Qt-Ct.right),Cr=Math.min(ur,vr),Vr=Ct.isDash?Cr:-Cr;this.data[je+Qt]=Math.max(0,Math.min(255,Vr+128))}},D.prototype.addDash=function(V,ve){var Z=ve?7:0,pe=2*Z+1;if(this.nextRow+pe>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var Me=0,Re=0;Re<V.length;Re++)Me+=V[Re];if(Me!==0){var je=this.width/Me,ut=this.getDashRanges(V,this.width,je);ve?this.addRoundDash(ut,je,Z):this.addRegularDash(ut)}var Ct={y:(this.nextRow+Z+.5)/this.height,height:2*Z/this.height,width:Me};return this.nextRow+=pe,this.dirty=!0,Ct},D.prototype.bind=function(V){var ve=V.gl;this.texture?(ve.bindTexture(ve.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,ve.texSubImage2D(ve.TEXTURE_2D,0,0,0,this.width,this.height,ve.ALPHA,ve.UNSIGNED_BYTE,this.data))):(this.texture=ve.createTexture(),ve.bindTexture(ve.TEXTURE_2D,this.texture),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_S,ve.REPEAT),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_T,ve.REPEAT),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MAG_FILTER,ve.LINEAR),ve.texImage2D(ve.TEXTURE_2D,0,ve.ALPHA,this.width,this.height,0,ve.ALPHA,ve.UNSIGNED_BYTE,this.data))};var R=function fe(V,ve){this.workerPool=V,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var Z=this.workerPool.acquire(this.id),pe=0;pe<Z.length;pe++){var Me=Z[pe],Re=new fe.Actor(Me,ve,this.id);Re.name="Worker "+pe,this.actors.push(Re)}};R.prototype.broadcast=function(V,ve,Z){Z=Z||function(){},e.asyncAll(this.actors,function(pe,Me){pe.send(V,ve,Me)},Z)},R.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},R.prototype.remove=function(){this.actors.forEach(function(V){V.remove()}),this.actors=[],this.workerPool.release(this.id)},R.Actor=e.Actor;function O(fe,V,ve){var Z=function(pe,Me){if(pe)return ve(pe);if(Me){var Re=e.pick(e.extend(Me,fe),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Me.vector_layers&&(Re.vectorLayers=Me.vector_layers,Re.vectorLayerIds=Re.vectorLayers.map(function(je){return je.id})),Re.tiles=V.canonicalizeTileset(Re,fe.url),ve(null,Re)}};return fe.url?e.getJSON(V.transformRequest(V.normalizeSourceURL(fe.url),e.ResourceType.Source),Z):e.browser.frame(function(){return Z(null,fe)})}var F=function(V,ve,Z){this.bounds=e.LngLatBounds.convert(this.validateBounds(V)),this.minzoom=ve||0,this.maxzoom=Z||24};F.prototype.validateBounds=function(V){return!Array.isArray(V)||V.length!==4?[-180,-90,180,90]:[Math.max(-180,V[0]),Math.max(-90,V[1]),Math.min(180,V[2]),Math.min(90,V[3])]},F.prototype.contains=function(V){var ve=Math.pow(2,V.z),Z={minX:Math.floor(e.mercatorXfromLng(this.bounds.getWest())*ve),minY:Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*ve),maxX:Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*ve),maxY:Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*ve)},pe=V.x>=Z.minX&&V.x<Z.maxX&&V.y>=Z.minY&&V.y<Z.maxY;return pe};var N=function(fe){function V(ve,Z,pe,Me){if(fe.call(this),this.id=ve,this.dispatcher=pe,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(Z,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},Z),this._collectResourceTiming=Z.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(Me)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.load=function(){var Z=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,function(pe,Me){Z._tileJSONRequest=null,Z._loaded=!0,pe?Z.fire(new e.ErrorEvent(pe)):Me&&(e.extend(Z,Me),Me.bounds&&(Z.tileBounds=new F(Me.bounds,Z.minzoom,Z.maxzoom)),e.postTurnstileEvent(Me.tiles,Z.map._requestManager._customAccessToken),e.postMapLoadEvent(Me.tiles,Z.map._getMapId(),Z.map._requestManager._skuToken,Z.map._requestManager._customAccessToken),Z.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),Z.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},V.prototype.loaded=function(){return this._loaded},V.prototype.hasTile=function(Z){return!this.tileBounds||this.tileBounds.contains(Z.canonical)},V.prototype.onAdd=function(Z){this.map=Z,this.load()},V.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},V.prototype.serialize=function(){return e.extend({},this._options)},V.prototype.loadTile=function(Z,pe){var Me=this.map._requestManager.normalizeTileURL(Z.tileID.canonical.url(this.tiles,this.scheme)),Re={request:this.map._requestManager.transformRequest(Me,e.ResourceType.Tile),uid:Z.uid,tileID:Z.tileID,zoom:Z.tileID.overscaledZ,tileSize:this.tileSize*Z.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};Re.request.collectResourceTiming=this._collectResourceTiming,!Z.actor||Z.state==="expired"?(Z.actor=this.dispatcher.getActor(),Z.request=Z.actor.send("loadTile",Re,je.bind(this))):Z.state==="loading"?Z.reloadCallback=pe:Z.request=Z.actor.send("reloadTile",Re,je.bind(this));function je(ut,Ct){if(delete Z.request,Z.aborted)return pe(null);if(ut&&ut.status!==404)return pe(ut);Ct&&Ct.resourceTiming&&(Z.resourceTiming=Ct.resourceTiming),this.map._refreshExpiredTiles&&Ct&&Z.setExpiryData(Ct),Z.loadVectorData(Ct,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),pe(null),Z.reloadCallback&&(this.loadTile(Z,Z.reloadCallback),Z.reloadCallback=null)}},V.prototype.abortTile=function(Z){Z.request&&(Z.request.cancel(),delete Z.request),Z.actor&&Z.actor.send("abortTile",{uid:Z.uid,type:this.type,source:this.id},void 0)},V.prototype.unloadTile=function(Z){Z.unloadVectorData(),Z.actor&&Z.actor.send("removeTile",{uid:Z.uid,type:this.type,source:this.id},void 0)},V.prototype.hasTransition=function(){return!1},V}(e.Evented),G=function(fe){function V(ve,Z,pe,Me){fe.call(this),this.id=ve,this.dispatcher=pe,this.setEventedParent(Me),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},Z),e.extend(this,e.pick(Z,["url","scheme","tileSize"]))}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.load=function(){var Z=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=O(this._options,this.map._requestManager,function(pe,Me){Z._tileJSONRequest=null,Z._loaded=!0,pe?Z.fire(new e.ErrorEvent(pe)):Me&&(e.extend(Z,Me),Me.bounds&&(Z.tileBounds=new F(Me.bounds,Z.minzoom,Z.maxzoom)),e.postTurnstileEvent(Me.tiles),e.postMapLoadEvent(Me.tiles,Z.map._getMapId(),Z.map._requestManager._skuToken),Z.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),Z.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},V.prototype.loaded=function(){return this._loaded},V.prototype.onAdd=function(Z){this.map=Z,this.load()},V.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},V.prototype.serialize=function(){return e.extend({},this._options)},V.prototype.hasTile=function(Z){return!this.tileBounds||this.tileBounds.contains(Z.canonical)},V.prototype.loadTile=function(Z,pe){var Me=this,Re=this.map._requestManager.normalizeTileURL(Z.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);Z.request=e.getImage(this.map._requestManager.transformRequest(Re,e.ResourceType.Tile),function(je,ut){if(delete Z.request,Z.aborted)Z.state="unloaded",pe(null);else if(je)Z.state="errored",pe(je);else if(ut){Me.map._refreshExpiredTiles&&Z.setExpiryData(ut),delete ut.cacheControl,delete ut.expires;var Ct=Me.map.painter.context,Qt=Ct.gl;Z.texture=Me.map.painter.getTileTexture(ut.width),Z.texture?Z.texture.update(ut,{useMipmap:!0}):(Z.texture=new e.Texture(Ct,ut,Qt.RGBA,{useMipmap:!0}),Z.texture.bind(Qt.LINEAR,Qt.CLAMP_TO_EDGE,Qt.LINEAR_MIPMAP_NEAREST),Ct.extTextureFilterAnisotropic&&Qt.texParameterf(Qt.TEXTURE_2D,Ct.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ct.extTextureFilterAnisotropicMax)),Z.state="loaded",e.cacheEntryPossiblyAdded(Me.dispatcher),pe(null)}})},V.prototype.abortTile=function(Z,pe){Z.request&&(Z.request.cancel(),delete Z.request),pe()},V.prototype.unloadTile=function(Z,pe){Z.texture&&this.map.painter.saveTileTexture(Z.texture),pe()},V.prototype.hasTransition=function(){return!1},V}(e.Evented),K=function(fe){function V(ve,Z,pe,Me){fe.call(this,ve,Z,pe,Me),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},Z),this.encoding=Z.encoding||"mapbox"}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},V.prototype.loadTile=function(Z,pe){var Me=this.map._requestManager.normalizeTileURL(Z.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);Z.request=e.getImage(this.map._requestManager.transformRequest(Me,e.ResourceType.Tile),Re.bind(this)),Z.neighboringTiles=this._getNeighboringTiles(Z.tileID);function Re(ut,Ct){if(delete Z.request,Z.aborted)Z.state="unloaded",pe(null);else if(ut)Z.state="errored",pe(ut);else if(Ct){this.map._refreshExpiredTiles&&Z.setExpiryData(Ct),delete Ct.cacheControl,delete Ct.expires;var Qt=e.window.ImageBitmap&&Ct instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported(),ur=Qt?Ct:e.browser.getImageData(Ct,1),vr={uid:Z.uid,coord:Z.tileID,source:this.id,rawImageData:ur,encoding:this.encoding};(!Z.actor||Z.state==="expired")&&(Z.actor=this.dispatcher.getActor(),Z.actor.send("loadDEMTile",vr,je.bind(this)))}}function je(ut,Ct){ut&&(Z.state="errored",pe(ut)),Ct&&(Z.dem=Ct,Z.needsHillshadePrepare=!0,Z.state="loaded",pe(null))}},V.prototype._getNeighboringTiles=function(Z){var pe=Z.canonical,Me=Math.pow(2,pe.z),Re=(pe.x-1+Me)%Me,je=pe.x===0?Z.wrap-1:Z.wrap,ut=(pe.x+1+Me)%Me,Ct=pe.x+1===Me?Z.wrap+1:Z.wrap,Qt={};return Qt[new e.OverscaledTileID(Z.overscaledZ,je,pe.z,Re,pe.y).key]={backfilled:!1},Qt[new e.OverscaledTileID(Z.overscaledZ,Ct,pe.z,ut,pe.y).key]={backfilled:!1},pe.y>0&&(Qt[new e.OverscaledTileID(Z.overscaledZ,je,pe.z,Re,pe.y-1).key]={backfilled:!1},Qt[new e.OverscaledTileID(Z.overscaledZ,Z.wrap,pe.z,pe.x,pe.y-1).key]={backfilled:!1},Qt[new e.OverscaledTileID(Z.overscaledZ,Ct,pe.z,ut,pe.y-1).key]={backfilled:!1}),pe.y+1<Me&&(Qt[new e.OverscaledTileID(Z.overscaledZ,je,pe.z,Re,pe.y+1).key]={backfilled:!1},Qt[new e.OverscaledTileID(Z.overscaledZ,Z.wrap,pe.z,pe.x,pe.y+1).key]={backfilled:!1},Qt[new e.OverscaledTileID(Z.overscaledZ,Ct,pe.z,ut,pe.y+1).key]={backfilled:!1}),Qt},V.prototype.unloadTile=function(Z){Z.demTexture&&this.map.painter.saveTileTexture(Z.demTexture),Z.fbo&&(Z.fbo.destroy(),delete Z.fbo),Z.dem&&delete Z.dem,delete Z.neighboringTiles,Z.state="unloaded",Z.actor&&Z.actor.send("removeDEMTile",{uid:Z.uid,source:this.id})},V}(G),W=function(fe){function V(ve,Z,pe,Me){fe.call(this),this.id=ve,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=pe.getActor(),this.setEventedParent(Me),this._data=Z.data,this._options=e.extend({},Z),this._collectResourceTiming=Z.collectResourceTiming,this._resourceTiming=[],Z.maxzoom!==void 0&&(this.maxzoom=Z.maxzoom),Z.type&&(this.type=Z.type),Z.attribution&&(this.attribution=Z.attribution),this.promoteId=Z.promoteId;var Re=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:Z.cluster||!1,geojsonVtOptions:{buffer:(Z.buffer!==void 0?Z.buffer:128)*Re,tolerance:(Z.tolerance!==void 0?Z.tolerance:.375)*Re,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:Z.lineMetrics||!1,generateId:Z.generateId||!1},superclusterOptions:{maxZoom:Z.clusterMaxZoom!==void 0?Math.min(Z.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(Z.clusterRadius||50)*Re,log:!1,generateId:Z.generateId||!1},clusterProperties:Z.clusterProperties},Z.workerOptions)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.load=function(){var Z=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(pe){if(pe){Z.fire(new e.ErrorEvent(pe));return}var Me={dataType:"source",sourceDataType:"metadata"};Z._collectResourceTiming&&Z._resourceTiming&&Z._resourceTiming.length>0&&(Me.resourceTiming=Z._resourceTiming,Z._resourceTiming=[]),Z.fire(new e.Event("data",Me))})},V.prototype.onAdd=function(Z){this.map=Z,this.load()},V.prototype.setData=function(Z){var pe=this;return this._data=Z,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(Me){if(Me){pe.fire(new e.ErrorEvent(Me));return}var Re={dataType:"source",sourceDataType:"content"};pe._collectResourceTiming&&pe._resourceTiming&&pe._resourceTiming.length>0&&(Re.resourceTiming=pe._resourceTiming,pe._resourceTiming=[]),pe.fire(new e.Event("data",Re))}),this},V.prototype.getClusterExpansionZoom=function(Z,pe){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:Z,source:this.id},pe),this},V.prototype.getClusterChildren=function(Z,pe){return this.actor.send("geojson.getClusterChildren",{clusterId:Z,source:this.id},pe),this},V.prototype.getClusterLeaves=function(Z,pe,Me,Re){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:Z,limit:pe,offset:Me},Re),this},V.prototype._updateWorkerData=function(Z){var pe=this;this._loaded=!1;var Me=e.extend({},this.workerOptions),Re=this._data;typeof Re=="string"?(Me.request=this.map._requestManager.transformRequest(e.browser.resolveURL(Re),e.ResourceType.Source),Me.request.collectResourceTiming=this._collectResourceTiming):Me.data=JSON.stringify(Re),this.actor.send(this.type+".loadData",Me,function(je,ut){pe._removed||ut&&ut.abandoned||(pe._loaded=!0,ut&&ut.resourceTiming&&ut.resourceTiming[pe.id]&&(pe._resourceTiming=ut.resourceTiming[pe.id].slice(0)),pe.actor.send(pe.type+".coalesce",{source:Me.source},null),Z(je))})},V.prototype.loaded=function(){return this._loaded},V.prototype.loadTile=function(Z,pe){var Me=this,Re=Z.actor?"reloadTile":"loadTile";Z.actor=this.actor;var je={type:this.type,uid:Z.uid,tileID:Z.tileID,zoom:Z.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};Z.request=this.actor.send(Re,je,function(ut,Ct){return delete Z.request,Z.unloadVectorData(),Z.aborted?pe(null):ut?pe(ut):(Z.loadVectorData(Ct,Me.map.painter,Re==="reloadTile"),pe(null))})},V.prototype.abortTile=function(Z){Z.request&&(Z.request.cancel(),delete Z.request),Z.aborted=!0},V.prototype.unloadTile=function(Z){Z.unloadVectorData(),this.actor.send("removeTile",{uid:Z.uid,type:this.type,source:this.id})},V.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},V.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},V.prototype.hasTransition=function(){return!1},V}(e.Evented),Y=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),re=function(fe){function V(ve,Z,pe,Me){fe.call(this),this.id=ve,this.dispatcher=pe,this.coordinates=Z.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(Me),this.options=Z}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.load=function(Z,pe){var Me=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(Re,je){Me._loaded=!0,Re?Me.fire(new e.ErrorEvent(Re)):je&&(Me.image=je,Z&&(Me.coordinates=Z),pe&&pe(),Me._finishLoading())})},V.prototype.loaded=function(){return this._loaded},V.prototype.updateImage=function(Z){var pe=this;return!this.image||!Z.url?this:(this.options.url=Z.url,this.load(Z.coordinates,function(){pe.texture=null}),this)},V.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},V.prototype.onAdd=function(Z){this.map=Z,this.load()},V.prototype.setCoordinates=function(Z){var pe=this;this.coordinates=Z;var Me=Z.map(e.MercatorCoordinate.fromLngLat);this.tileID=ue(Me),this.minzoom=this.maxzoom=this.tileID.z;var Re=Me.map(function(je){return pe.tileID.getTilePoint(je)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(Re[0].x,Re[0].y,0,0),this._boundsArray.emplaceBack(Re[1].x,Re[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(Re[3].x,Re[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(Re[2].x,Re[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},V.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||!this.image)){var Z=this.map.painter.context,pe=Z.gl;this.boundsBuffer||(this.boundsBuffer=Z.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(Z,this.image,pe.RGBA),this.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE));for(var Me in this.tiles){var Re=this.tiles[Me];Re.state!=="loaded"&&(Re.state="loaded",Re.texture=this.texture)}}},V.prototype.loadTile=function(Z,pe){this.tileID&&this.tileID.equals(Z.tileID.canonical)?(this.tiles[String(Z.tileID.wrap)]=Z,Z.buckets={},pe(null)):(Z.state="errored",pe(null))},V.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},V.prototype.hasTransition=function(){return!1},V}(e.Evented);function ue(fe){for(var V=1/0,ve=1/0,Z=-1/0,pe=-1/0,Me=0,Re=fe;Me<Re.length;Me+=1){var je=Re[Me];V=Math.min(V,je.x),ve=Math.min(ve,je.y),Z=Math.max(Z,je.x),pe=Math.max(pe,je.y)}var ut=Z-V,Ct=pe-ve,Qt=Math.max(ut,Ct),ur=Math.max(0,Math.floor(-Math.log(Qt)/Math.LN2)),vr=Math.pow(2,ur);return new e.CanonicalTileID(ur,Math.floor((V+Z)/2*vr),Math.floor((ve+pe)/2*vr))}var j=function(fe){function V(ve,Z,pe,Me){fe.call(this,ve,Z,pe,Me),this.roundZoom=!0,this.type="video",this.options=Z}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.load=function(){var Z=this;this._loaded=!1;var pe=this.options;this.urls=[];for(var Me=0,Re=pe.urls;Me<Re.length;Me+=1){var je=Re[Me];this.urls.push(this.map._requestManager.transformRequest(je,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ut,Ct){Z._loaded=!0,ut?Z.fire(new e.ErrorEvent(ut)):Ct&&(Z.video=Ct,Z.video.loop=!0,Z.video.addEventListener("playing",function(){Z.map.triggerRepaint()}),Z.map&&Z.video.play(),Z._finishLoading())})},V.prototype.pause=function(){this.video&&this.video.pause()},V.prototype.play=function(){this.video&&this.video.play()},V.prototype.seek=function(Z){if(this.video){var pe=this.video.seekable;Z<pe.start(0)||Z>pe.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+pe.start(0)+" and "+pe.end(0)+"-second mark."))):this.video.currentTime=Z}},V.prototype.getVideo=function(){return this.video},V.prototype.onAdd=function(Z){this.map||(this.map=Z,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},V.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var Z=this.map.painter.context,pe=Z.gl;this.boundsBuffer||(this.boundsBuffer=Z.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),pe.texSubImage2D(pe.TEXTURE_2D,0,0,0,pe.RGBA,pe.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(Z,this.video,pe.RGBA),this.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE));for(var Me in this.tiles){var Re=this.tiles[Me];Re.state!=="loaded"&&(Re.state="loaded",Re.texture=this.texture)}}},V.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},V.prototype.hasTransition=function(){return this.video&&!this.video.paused},V}(re),q=function(fe){function V(ve,Z,pe,Me){fe.call(this,ve,Z,pe,Me),Z.coordinates?(!Array.isArray(Z.coordinates)||Z.coordinates.length!==4||Z.coordinates.some(function(Re){return!Array.isArray(Re)||Re.length!==2||Re.some(function(je){return typeof je!="number"})}))&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'missing required property "coordinates"'))),Z.animate&&typeof Z.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'optional "animate" property must be a boolean value'))),Z.canvas?typeof Z.canvas!="string"&&!(Z.canvas instanceof e.window.HTMLCanvasElement)&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'missing required property "canvas"'))),this.options=Z,this.animate=Z.animate!==void 0?Z.animate:!0}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.load=function(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()},V.prototype.getCanvas=function(){return this.canvas},V.prototype.onAdd=function(Z){this.map=Z,this.load(),this.canvas&&this.animate&&this.play()},V.prototype.onRemove=function(){this.pause()},V.prototype.prepare=function(){var Z=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,Z=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,Z=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var pe=this.map.painter.context,Me=pe.gl;this.boundsBuffer||(this.boundsBuffer=pe.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(Z||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(pe,this.canvas,Me.RGBA,{premultiply:!0});for(var Re in this.tiles){var je=this.tiles[Re];je.state!=="loaded"&&(je.state="loaded",je.texture=this.texture)}}},V.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},V.prototype.hasTransition=function(){return this._playing},V.prototype._hasInvalidDimensions=function(){for(var Z=0,pe=[this.canvas.width,this.canvas.height];Z<pe.length;Z+=1){var Me=pe[Z];if(isNaN(Me)||Me<=0)return!0}return!1},V}(re),H={vector:N,raster:G,"raster-dem":K,geojson:W,video:j,image:re,canvas:q},U=function(fe,V,ve,Z){var pe=new H[V.type](fe,V,ve,Z);if(pe.id!==fe)throw new Error("Expected Source id to be "+fe+" instead of "+pe.id);return e.bindAll(["load","abort","unload","serialize","prepare"],pe),pe},$=function(fe){return H[fe]},ne=function(fe,V){H[fe]=V};function X(fe,V){var ve=e.identity([]);return e.translate(ve,ve,[1,1,0]),e.scale(ve,ve,[fe.width*.5,fe.height*.5,1]),e.multiply(ve,ve,fe.calculatePosMatrix(V.toUnwrapped()))}function Q(fe,V,ve){if(fe)for(var Z=0,pe=fe;Z<pe.length;Z+=1){var Me=pe[Z],Re=V[Me];if(Re&&Re.source===ve&&Re.type==="fill-extrusion")return!0}else for(var je in V){var ut=V[je];if(ut.source===ve&&ut.type==="fill-extrusion")return!0}return!1}function ie(fe,V,ve,Z,pe,Me){var Re=Q(pe&&pe.layers,V,fe.id),je=Me.maxPitchScaleFactor(),ut=fe.tilesIn(Z,je,Re);ut.sort(oe);for(var Ct=[],Qt=0,ur=ut;Qt<ur.length;Qt+=1){var vr=ur[Qt];Ct.push({wrappedTileID:vr.tileID.wrapped().key,queryResults:vr.tile.queryRenderedFeatures(V,ve,fe._state,vr.queryGeometry,vr.cameraQueryGeometry,vr.scale,pe,Me,je,X(fe.transform,vr.tileID))})}var Cr=be(Ct);for(var Vr in Cr)Cr[Vr].forEach(function(Wr){var Ur=Wr.feature,Jr=fe.getFeatureState(Ur.layer["source-layer"],Ur.id);Ur.source=Ur.layer.source,Ur.layer["source-layer"]&&(Ur.sourceLayer=Ur.layer["source-layer"]),Ur.state=Jr});return Cr}function se(fe,V,ve,Z,pe,Me,Re){for(var je={},ut=Me.queryRenderedSymbols(Z),Ct=[],Qt=0,ur=Object.keys(ut).map(Number);Qt<ur.length;Qt+=1){var vr=ur[Qt];Ct.push(Re[vr])}Ct.sort(oe);for(var Cr=function(){var hn=Wr[Vr],Cn=hn.featureIndex.lookupSymbolFeatures(ut[hn.bucketInstanceId],V,hn.bucketIndex,hn.sourceLayerIndex,pe.filter,pe.layers,pe.availableImages,fe);for(var Fn in Cn){var Kn=je[Fn]=je[Fn]||[],qn=Cn[Fn];qn.sort(function(ya,Ta){var Ca=hn.featureSortOrder;if(Ca){var Ha=Ca.indexOf(ya.featureIndex),ni=Ca.indexOf(Ta.featureIndex);return ni-Ha}else return Ta.featureIndex-ya.featureIndex});for(var Qn=0,ca=qn;Qn<ca.length;Qn+=1){var ba=ca[Qn];Kn.push(ba)}}},Vr=0,Wr=Ct;Vr<Wr.length;Vr+=1)Cr();var Ur=function(hn){je[hn].forEach(function(Cn){var Fn=Cn.feature,Kn=fe[hn],qn=ve[Kn.source],Qn=qn.getFeatureState(Fn.layer["source-layer"],Fn.id);Fn.source=Fn.layer.source,Fn.layer["source-layer"]&&(Fn.sourceLayer=Fn.layer["source-layer"]),Fn.state=Qn})};for(var Jr in je)Ur(Jr);return je}function ae(fe,V){for(var ve=fe.getRenderableIds().map(function(ut){return fe.getTileByID(ut)}),Z=[],pe={},Me=0;Me<ve.length;Me++){var Re=ve[Me],je=Re.tileID.canonical.key;pe[je]||(pe[je]=!0,Re.querySourceFeatures(Z,V))}return Z}function oe(fe,V){var ve=fe.tileID,Z=V.tileID;return ve.overscaledZ-Z.overscaledZ||ve.canonical.y-Z.canonical.y||ve.wrap-Z.wrap||ve.canonical.x-Z.canonical.x}function be(fe){for(var V={},ve={},Z=0,pe=fe;Z<pe.length;Z+=1){var Me=pe[Z],Re=Me.queryResults,je=Me.wrappedTileID,ut=ve[je]=ve[je]||{};for(var Ct in Re)for(var Qt=Re[Ct],ur=ut[Ct]=ut[Ct]||{},vr=V[Ct]=V[Ct]||[],Cr=0,Vr=Qt;Cr<Vr.length;Cr+=1){var Wr=Vr[Cr];ur[Wr.featureIndex]||(ur[Wr.featureIndex]=!0,vr.push(Wr))}}return V}var ce=function(V,ve){this.max=V,this.onRemove=ve,this.reset()};ce.prototype.reset=function(){for(var V in this.data)for(var ve=0,Z=this.data[V];ve<Z.length;ve+=1){var pe=Z[ve];pe.timeout&&clearTimeout(pe.timeout),this.onRemove(pe.value)}return this.data={},this.order=[],this},ce.prototype.add=function(V,ve,Z){var pe=this,Me=V.wrapped().key;this.data[Me]===void 0&&(this.data[Me]=[]);var Re={value:ve,timeout:void 0};if(Z!==void 0&&(Re.timeout=setTimeout(function(){pe.remove(V,Re)},Z)),this.data[Me].push(Re),this.order.push(Me),this.order.length>this.max){var je=this._getAndRemoveByKey(this.order[0]);je&&this.onRemove(je)}return this},ce.prototype.has=function(V){return V.wrapped().key in this.data},ce.prototype.getAndRemove=function(V){return this.has(V)?this._getAndRemoveByKey(V.wrapped().key):null},ce.prototype._getAndRemoveByKey=function(V){var ve=this.data[V].shift();return ve.timeout&&clearTimeout(ve.timeout),this.data[V].length===0&&delete this.data[V],this.order.splice(this.order.indexOf(V),1),ve.value},ce.prototype.getByKey=function(V){var ve=this.data[V];return ve?ve[0].value:null},ce.prototype.get=function(V){if(!this.has(V))return null;var ve=this.data[V.wrapped().key][0];return ve.value},ce.prototype.remove=function(V,ve){if(!this.has(V))return this;var Z=V.wrapped().key,pe=ve===void 0?0:this.data[Z].indexOf(ve),Me=this.data[Z][pe];return this.data[Z].splice(pe,1),Me.timeout&&clearTimeout(Me.timeout),this.data[Z].length===0&&delete this.data[Z],this.onRemove(Me.value),this.order.splice(this.order.indexOf(Z),1),this},ce.prototype.setMaxSize=function(V){for(this.max=V;this.order.length>this.max;){var ve=this._getAndRemoveByKey(this.order[0]);ve&&this.onRemove(ve)}return this},ce.prototype.filter=function(V){var ve=[];for(var Z in this.data)for(var pe=0,Me=this.data[Z];pe<Me.length;pe+=1){var Re=Me[pe];V(Re.value)||ve.push(Re)}for(var je=0,ut=ve;je<ut.length;je+=1){var Ct=ut[je];this.remove(Ct.value.tileID,Ct)}};var de=function(V,ve,Z){this.context=V;var pe=V.gl;this.buffer=pe.createBuffer(),this.dynamicDraw=!!Z,this.context.unbindVAO(),V.bindElementBuffer.set(this.buffer),pe.bufferData(pe.ELEMENT_ARRAY_BUFFER,ve.arrayBuffer,this.dynamicDraw?pe.DYNAMIC_DRAW:pe.STATIC_DRAW),this.dynamicDraw||delete ve.arrayBuffer};de.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},de.prototype.updateData=function(V){var ve=this.context.gl;this.context.unbindVAO(),this.bind(),ve.bufferSubData(ve.ELEMENT_ARRAY_BUFFER,0,V.arrayBuffer)},de.prototype.destroy=function(){var V=this.context.gl;this.buffer&&(V.deleteBuffer(this.buffer),delete this.buffer)};var ye={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ge=function(V,ve,Z,pe){this.length=ve.length,this.attributes=Z,this.itemSize=ve.bytesPerElement,this.dynamicDraw=pe,this.context=V;var Me=V.gl;this.buffer=Me.createBuffer(),V.bindVertexBuffer.set(this.buffer),Me.bufferData(Me.ARRAY_BUFFER,ve.arrayBuffer,this.dynamicDraw?Me.DYNAMIC_DRAW:Me.STATIC_DRAW),this.dynamicDraw||delete ve.arrayBuffer};ge.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ge.prototype.updateData=function(V){var ve=this.context.gl;this.bind(),ve.bufferSubData(ve.ARRAY_BUFFER,0,V.arrayBuffer)},ge.prototype.enableAttributes=function(V,ve){for(var Z=0;Z<this.attributes.length;Z++){var pe=this.attributes[Z],Me=ve.attributes[pe.name];Me!==void 0&&V.enableVertexAttribArray(Me)}},ge.prototype.setVertexAttribPointers=function(V,ve,Z){for(var pe=0;pe<this.attributes.length;pe++){var Me=this.attributes[pe],Re=ve.attributes[Me.name];Re!==void 0&&V.vertexAttribPointer(Re,Me.components,V[ye[Me.type]],!1,this.itemSize,Me.offset+this.itemSize*(Z||0))}},ge.prototype.destroy=function(){var V=this.context.gl;this.buffer&&(V.deleteBuffer(this.buffer),delete this.buffer)};var me=function(V){this.gl=V.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};me.prototype.get=function(){return this.current},me.prototype.set=function(V){},me.prototype.getDefault=function(){return this.default},me.prototype.setDefault=function(){this.set(this.default)};var Ee=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return e.Color.transparent},V.prototype.set=function(Z){var pe=this.current;Z.r===pe.r&&Z.g===pe.g&&Z.b===pe.b&&Z.a===pe.a&&!this.dirty||(this.gl.clearColor(Z.r,Z.g,Z.b,Z.a),this.current=Z,this.dirty=!1)},V}(me),Pe=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return 1},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.clearDepth(Z),this.current=Z,this.dirty=!1)},V}(me),Ue=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return 0},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.clearStencil(Z),this.current=Z,this.dirty=!1)},V}(me),we=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return[!0,!0,!0,!0]},V.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&Z[2]===pe[2]&&Z[3]===pe[3]&&!this.dirty||(this.gl.colorMask(Z[0],Z[1],Z[2],Z[3]),this.current=Z,this.dirty=!1)},V}(me),ke=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!0},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.depthMask(Z),this.current=Z,this.dirty=!1)},V}(me),Xe=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return 255},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.stencilMask(Z),this.current=Z,this.dirty=!1)},V}(me),Ve=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},V.prototype.set=function(Z){var pe=this.current;Z.func===pe.func&&Z.ref===pe.ref&&Z.mask===pe.mask&&!this.dirty||(this.gl.stencilFunc(Z.func,Z.ref,Z.mask),this.current=Z,this.dirty=!1)},V}(me),Ie=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){var Z=this.gl;return[Z.KEEP,Z.KEEP,Z.KEEP]},V.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&Z[2]===pe[2]&&!this.dirty||(this.gl.stencilOp(Z[0],Z[1],Z[2]),this.current=Z,this.dirty=!1)},V}(me),De=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;Z?pe.enable(pe.STENCIL_TEST):pe.disable(pe.STENCIL_TEST),this.current=Z,this.dirty=!1}},V}(me),Ye=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return[0,1]},V.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&!this.dirty||(this.gl.depthRange(Z[0],Z[1]),this.current=Z,this.dirty=!1)},V}(me),vt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;Z?pe.enable(pe.DEPTH_TEST):pe.disable(pe.DEPTH_TEST),this.current=Z,this.dirty=!1}},V}(me),Dt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.LESS},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.depthFunc(Z),this.current=Z,this.dirty=!1)},V}(me),Kt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;Z?pe.enable(pe.BLEND):pe.disable(pe.BLEND),this.current=Z,this.dirty=!1}},V}(me),Ft=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){var Z=this.gl;return[Z.ONE,Z.ZERO]},V.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&!this.dirty||(this.gl.blendFunc(Z[0],Z[1]),this.current=Z,this.dirty=!1)},V}(me),Mt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return e.Color.transparent},V.prototype.set=function(Z){var pe=this.current;Z.r===pe.r&&Z.g===pe.g&&Z.b===pe.b&&Z.a===pe.a&&!this.dirty||(this.gl.blendColor(Z.r,Z.g,Z.b,Z.a),this.current=Z,this.dirty=!1)},V}(me),Xt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.FUNC_ADD},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.blendEquation(Z),this.current=Z,this.dirty=!1)},V}(me),It=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;Z?pe.enable(pe.CULL_FACE):pe.disable(pe.CULL_FACE),this.current=Z,this.dirty=!1}},V}(me),At=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.BACK},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.cullFace(Z),this.current=Z,this.dirty=!1)},V}(me),Ge=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.CCW},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.frontFace(Z),this.current=Z,this.dirty=!1)},V}(me),tt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.useProgram(Z),this.current=Z,this.dirty=!1)},V}(me),He=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return this.gl.TEXTURE0},V.prototype.set=function(Z){Z===this.current&&!this.dirty||(this.gl.activeTexture(Z),this.current=Z,this.dirty=!1)},V}(me),Ae=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){var Z=this.gl;return[0,0,Z.drawingBufferWidth,Z.drawingBufferHeight]},V.prototype.set=function(Z){var pe=this.current;Z[0]===pe[0]&&Z[1]===pe[1]&&Z[2]===pe[2]&&Z[3]===pe[3]&&!this.dirty||(this.gl.viewport(Z[0],Z[1],Z[2],Z[3]),this.current=Z,this.dirty=!1)},V}(me),Ne=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.bindFramebuffer(pe.FRAMEBUFFER,Z),this.current=Z,this.dirty=!1}},V}(me),Ze=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.bindRenderbuffer(pe.RENDERBUFFER,Z),this.current=Z,this.dirty=!1}},V}(me),Qe=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.bindTexture(pe.TEXTURE_2D,Z),this.current=Z,this.dirty=!1}},V}(me),bt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.bindBuffer(pe.ARRAY_BUFFER,Z),this.current=Z,this.dirty=!1}},V}(me),dt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(Z){var pe=this.gl;pe.bindBuffer(pe.ELEMENT_ARRAY_BUFFER,Z),this.current=Z,this.dirty=!1},V}(me),wt=function(fe){function V(ve){fe.call(this,ve),this.vao=ve.extVertexArrayObject}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V.prototype.set=function(Z){!this.vao||Z===this.current&&!this.dirty||(this.vao.bindVertexArrayOES(Z),this.current=Z,this.dirty=!1)},V}(me),Ut=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return 4},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.pixelStorei(pe.UNPACK_ALIGNMENT,Z),this.current=Z,this.dirty=!1}},V}(me),Rt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.pixelStorei(pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Z),this.current=Z,this.dirty=!1}},V}(me),Nt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return!1},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){var pe=this.gl;pe.pixelStorei(pe.UNPACK_FLIP_Y_WEBGL,Z),this.current=Z,this.dirty=!1}},V}(me),Wt=function(fe){function V(ve,Z){fe.call(this,ve),this.context=ve,this.parent=Z}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getDefault=function(){return null},V}(me),Vt=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.setDirty=function(){this.dirty=!0},V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var pe=this.gl;pe.framebufferTexture2D(pe.FRAMEBUFFER,pe.COLOR_ATTACHMENT0,pe.TEXTURE_2D,Z,0),this.current=Z,this.dirty=!1}},V}(Wt),ir=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.set=function(Z){if(!(Z===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var pe=this.gl;pe.framebufferRenderbuffer(pe.FRAMEBUFFER,pe.DEPTH_ATTACHMENT,pe.RENDERBUFFER,Z),this.current=Z,this.dirty=!1}},V}(Wt),Hr=function(V,ve,Z,pe){this.context=V,this.width=ve,this.height=Z;var Me=V.gl,Re=this.framebuffer=Me.createFramebuffer();this.colorAttachment=new Vt(V,Re),pe&&(this.depthAttachment=new ir(V,Re))};Hr.prototype.destroy=function(){var V=this.context.gl,ve=this.colorAttachment.get();if(ve&&V.deleteTexture(ve),this.depthAttachment){var Z=this.depthAttachment.get();Z&&V.deleteRenderbuffer(Z)}V.deleteFramebuffer(this.framebuffer)};var sn=519,jr=function(V,ve,Z){this.func=V,this.mask=ve,this.range=Z};jr.ReadOnly=!1,jr.ReadWrite=!0,jr.disabled=new jr(sn,jr.ReadOnly,[0,1]);var at=519,$t=7680,Jt=function(V,ve,Z,pe,Me,Re){this.test=V,this.ref=ve,this.mask=Z,this.fail=pe,this.depthFail=Me,this.pass=Re};Jt.disabled=new Jt({func:at,mask:0},0,0,$t,$t,$t);var Gt=0,_r=1,rt=771,Je=function(V,ve,Z){this.blendFunction=V,this.blendColor=ve,this.mask=Z};Je.Replace=[_r,Gt],Je.disabled=new Je(Je.Replace,e.Color.transparent,[!1,!1,!1,!1]),Je.unblended=new Je(Je.Replace,e.Color.transparent,[!0,!0,!0,!0]),Je.alphaBlended=new Je([_r,rt],e.Color.transparent,[!0,!0,!0,!0]);var st=1029,lt=2305,Tt=function(V,ve,Z){this.enable=V,this.mode=ve,this.frontFace=Z};Tt.disabled=new Tt(!1,st,lt),Tt.backCCW=new Tt(!0,st,lt);var zt=function(V){this.gl=V,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ee(this),this.clearDepth=new Pe(this),this.clearStencil=new Ue(this),this.colorMask=new we(this),this.depthMask=new ke(this),this.stencilMask=new Xe(this),this.stencilFunc=new Ve(this),this.stencilOp=new Ie(this),this.stencilTest=new De(this),this.depthRange=new Ye(this),this.depthTest=new vt(this),this.depthFunc=new Dt(this),this.blend=new Kt(this),this.blendFunc=new Ft(this),this.blendColor=new Mt(this),this.blendEquation=new Xt(this),this.cullFace=new It(this),this.cullFaceSide=new At(this),this.frontFace=new Ge(this),this.program=new tt(this),this.activeTexture=new He(this),this.viewport=new Ae(this),this.bindFramebuffer=new Ne(this),this.bindRenderbuffer=new Ze(this),this.bindTexture=new Qe(this),this.bindVertexBuffer=new bt(this),this.bindElementBuffer=new dt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new wt(this),this.pixelStoreUnpack=new Ut(this),this.pixelStoreUnpackPremultiplyAlpha=new Rt(this),this.pixelStoreUnpackFlipY=new Nt(this),this.extTextureFilterAnisotropic=V.getExtension("EXT_texture_filter_anisotropic")||V.getExtension("MOZ_EXT_texture_filter_anisotropic")||V.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=V.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=V.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(V.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=V.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=V.getExtension("EXT_disjoint_timer_query")};zt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},zt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},zt.prototype.createIndexBuffer=function(V,ve){return new de(this,V,ve)},zt.prototype.createVertexBuffer=function(V,ve,Z){return new ge(this,V,ve,Z)},zt.prototype.createRenderbuffer=function(V,ve,Z){var pe=this.gl,Me=pe.createRenderbuffer();return this.bindRenderbuffer.set(Me),pe.renderbufferStorage(pe.RENDERBUFFER,V,ve,Z),this.bindRenderbuffer.set(null),Me},zt.prototype.createFramebuffer=function(V,ve,Z){return new Hr(this,V,ve,Z)},zt.prototype.clear=function(V){var ve=V.color,Z=V.depth,pe=this.gl,Me=0;ve&&(Me|=pe.COLOR_BUFFER_BIT,this.clearColor.set(ve),this.colorMask.set([!0,!0,!0,!0])),typeof Z<"u"&&(Me|=pe.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(Z),this.depthMask.set(!0)),pe.clear(Me)},zt.prototype.setCullFace=function(V){V.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(V.mode),this.frontFace.set(V.frontFace))},zt.prototype.setDepthMode=function(V){V.func===this.gl.ALWAYS&&!V.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(V.func),this.depthMask.set(V.mask),this.depthRange.set(V.range))},zt.prototype.setStencilMode=function(V){V.test.func===this.gl.ALWAYS&&!V.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(V.mask),this.stencilOp.set([V.fail,V.depthFail,V.pass]),this.stencilFunc.set({func:V.test.func,ref:V.ref,mask:V.test.mask}))},zt.prototype.setColorMode=function(V){e.deepEqual(V.blendFunction,Je.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(V.blendFunction),this.blendColor.set(V.blendColor)),this.colorMask.set(V.mask)},zt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ce=function(fe){function V(ve,Z,pe){var Me=this;fe.call(this),this.id=ve,this.dispatcher=pe,this.on("data",function(Re){Re.dataType==="source"&&Re.sourceDataType==="metadata"&&(Me._sourceLoaded=!0),Me._sourceLoaded&&!Me._paused&&Re.dataType==="source"&&Re.sourceDataType==="content"&&(Me.reload(),Me.transform&&Me.update(Me.transform))}),this.on("error",function(){Me._sourceErrored=!0}),this._source=U(ve,Z,pe,this),this._tiles={},this._cache=new ce(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.onAdd=function(Z){this.map=Z,this._maxTileCacheSize=Z?Z._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(Z)},V.prototype.onRemove=function(Z){this._source&&this._source.onRemove&&this._source.onRemove(Z)},V.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var Z in this._tiles){var pe=this._tiles[Z];if(pe.state!=="loaded"&&pe.state!=="errored")return!1}return!0},V.prototype.getSource=function(){return this._source},V.prototype.pause=function(){this._paused=!0},V.prototype.resume=function(){if(this._paused){var Z=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,Z&&this.reload(),this.transform&&this.update(this.transform)}},V.prototype._loadTile=function(Z,pe){return this._source.loadTile(Z,pe)},V.prototype._unloadTile=function(Z){if(this._source.unloadTile)return this._source.unloadTile(Z,function(){})},V.prototype._abortTile=function(Z){if(this._source.abortTile)return this._source.abortTile(Z,function(){})},V.prototype.serialize=function(){return this._source.serialize()},V.prototype.prepare=function(Z){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(var pe in this._tiles){var Me=this._tiles[pe];Me.upload(Z),Me.prepare(this.map.style.imageManager)}},V.prototype.getIds=function(){return e.values(this._tiles).map(function(Z){return Z.tileID}).sort(Se).map(function(Z){return Z.key})},V.prototype.getRenderableIds=function(Z){var pe=this,Me=[];for(var Re in this._tiles)this._isIdRenderable(Re,Z)&&Me.push(this._tiles[Re]);return Z?Me.sort(function(je,ut){var Ct=je.tileID,Qt=ut.tileID,ur=new e.Point(Ct.canonical.x,Ct.canonical.y)._rotate(pe.transform.angle),vr=new e.Point(Qt.canonical.x,Qt.canonical.y)._rotate(pe.transform.angle);return Ct.overscaledZ-Qt.overscaledZ||vr.y-ur.y||vr.x-ur.x}).map(function(je){return je.tileID.key}):Me.map(function(je){return je.tileID}).sort(Se).map(function(je){return je.key})},V.prototype.hasRenderableParent=function(Z){var pe=this.findLoadedParent(Z,0);return pe?this._isIdRenderable(pe.tileID.key):!1},V.prototype._isIdRenderable=function(Z,pe){return this._tiles[Z]&&this._tiles[Z].hasData()&&!this._coveredTiles[Z]&&(pe||!this._tiles[Z].holdingForFade())},V.prototype.reload=function(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(var Z in this._tiles)this._tiles[Z].state!=="errored"&&this._reloadTile(Z,"reloading")},V.prototype._reloadTile=function(Z,pe){var Me=this._tiles[Z];Me&&(Me.state!=="loading"&&(Me.state=pe),this._loadTile(Me,this._tileLoaded.bind(this,Me,Z,pe)))},V.prototype._tileLoaded=function(Z,pe,Me,Re){if(Re){Z.state="errored",Re.status!==404?this._source.fire(new e.ErrorEvent(Re,{tile:Z})):this.update(this.transform);return}Z.timeAdded=e.browser.now(),Me==="expired"&&(Z.refreshedUponExpiration=!0),this._setTileReloadTimer(pe,Z),this.getSource().type==="raster-dem"&&Z.dem&&this._backfillDEM(Z),this._state.initializeTileState(Z,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:Z,coord:Z.tileID}))},V.prototype._backfillDEM=function(Z){for(var pe=this.getRenderableIds(),Me=0;Me<pe.length;Me++){var Re=pe[Me];if(Z.neighboringTiles&&Z.neighboringTiles[Re]){var je=this.getTileByID(Re);ut(Z,je),ut(je,Z)}}function ut(Ct,Qt){Ct.needsHillshadePrepare=!0;var ur=Qt.tileID.canonical.x-Ct.tileID.canonical.x,vr=Qt.tileID.canonical.y-Ct.tileID.canonical.y,Cr=Math.pow(2,Ct.tileID.canonical.z),Vr=Qt.tileID.key;ur===0&&vr===0||Math.abs(vr)>1||(Math.abs(ur)>1&&(Math.abs(ur+Cr)===1?ur+=Cr:Math.abs(ur-Cr)===1&&(ur-=Cr)),!(!Qt.dem||!Ct.dem)&&(Ct.dem.backfillBorder(Qt.dem,ur,vr),Ct.neighboringTiles&&Ct.neighboringTiles[Vr]&&(Ct.neighboringTiles[Vr].backfilled=!0)))}},V.prototype.getTile=function(Z){return this.getTileByID(Z.key)},V.prototype.getTileByID=function(Z){return this._tiles[Z]},V.prototype._retainLoadedChildren=function(Z,pe,Me,Re){for(var je in this._tiles){var ut=this._tiles[je];if(!(Re[je]||!ut.hasData()||ut.tileID.overscaledZ<=pe||ut.tileID.overscaledZ>Me)){for(var Ct=ut.tileID;ut&&ut.tileID.overscaledZ>pe+1;){var Qt=ut.tileID.scaledTo(ut.tileID.overscaledZ-1);ut=this._tiles[Qt.key],ut&&ut.hasData()&&(Ct=Qt)}for(var ur=Ct;ur.overscaledZ>pe;)if(ur=ur.scaledTo(ur.overscaledZ-1),Z[ur.key]){Re[Ct.key]=Ct;break}}}},V.prototype.findLoadedParent=function(Z,pe){if(Z.key in this._loadedParentTiles){var Me=this._loadedParentTiles[Z.key];return Me&&Me.tileID.overscaledZ>=pe?Me:null}for(var Re=Z.overscaledZ-1;Re>=pe;Re--){var je=Z.scaledTo(Re),ut=this._getLoadedTile(je);if(ut)return ut}},V.prototype._getLoadedTile=function(Z){var pe=this._tiles[Z.key];if(pe&&pe.hasData())return pe;var Me=this._cache.getByKey(Z.wrapped().key);return Me},V.prototype.updateCacheSize=function(Z){var pe=Math.ceil(Z.width/this._source.tileSize)+1,Me=Math.ceil(Z.height/this._source.tileSize)+1,Re=pe*Me,je=5,ut=Math.floor(Re*je),Ct=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ut):ut;this._cache.setMaxSize(Ct)},V.prototype.handleWrapJump=function(Z){var pe=this._prevLng===void 0?Z:this._prevLng,Me=Z-pe,Re=Me/360,je=Math.round(Re);if(this._prevLng=Z,je){var ut={};for(var Ct in this._tiles){var Qt=this._tiles[Ct];Qt.tileID=Qt.tileID.unwrapTo(Qt.tileID.wrap+je),ut[Qt.tileID.key]=Qt}this._tiles=ut;for(var ur in this._timers)clearTimeout(this._timers[ur]),delete this._timers[ur];for(var vr in this._tiles){var Cr=this._tiles[vr];this._setTileReloadTimer(vr,Cr)}}},V.prototype.update=function(Z){var pe=this;if(this.transform=Z,!(!this._sourceLoaded||this._paused)){this.updateCacheSize(Z),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};var Me;this.used?this._source.tileID?Me=Z.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ya){return new e.OverscaledTileID(ya.canonical.z,ya.wrap,ya.canonical.z,ya.canonical.x,ya.canonical.y)}):(Me=Z.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(Me=Me.filter(function(ya){return pe._source.hasTile(ya)}))):Me=[];var Re=Z.coveringZoomLevel(this._source),je=Math.max(Re-V.maxOverzooming,this._source.minzoom),ut=Math.max(Re+V.maxUnderzooming,this._source.minzoom),Ct=this._updateRetainedTiles(Me,Re);if(nt(this._source.type)){for(var Qt={},ur={},vr=Object.keys(Ct),Cr=0,Vr=vr;Cr<Vr.length;Cr+=1){var Wr=Vr[Cr],Ur=Ct[Wr],Jr=this._tiles[Wr];if(!(!Jr||Jr.fadeEndTime&&Jr.fadeEndTime<=e.browser.now())){var hn=this.findLoadedParent(Ur,je);hn&&(this._addTile(hn.tileID),Qt[hn.tileID.key]=hn.tileID),ur[Wr]=Ur}}this._retainLoadedChildren(ur,Re,ut,Ct);for(var Cn in Qt)Ct[Cn]||(this._coveredTiles[Cn]=!0,Ct[Cn]=Qt[Cn])}for(var Fn in Ct)this._tiles[Fn].clearFadeHold();for(var Kn=e.keysDifference(this._tiles,Ct),qn=0,Qn=Kn;qn<Qn.length;qn+=1){var ca=Qn[qn],ba=this._tiles[ca];ba.hasSymbolBuckets&&!ba.holdingForFade()?ba.setHoldDuration(this.map._fadeDuration):(!ba.hasSymbolBuckets||ba.symbolFadeFinished())&&this._removeTile(ca)}this._updateLoadedParentTileCache()}},V.prototype.releaseSymbolFadeTiles=function(){for(var Z in this._tiles)this._tiles[Z].holdingForFade()&&this._removeTile(Z)},V.prototype._updateRetainedTiles=function(Z,pe){for(var Me={},Re={},je=Math.max(pe-V.maxOverzooming,this._source.minzoom),ut=Math.max(pe+V.maxUnderzooming,this._source.minzoom),Ct={},Qt=0,ur=Z;Qt<ur.length;Qt+=1){var vr=ur[Qt],Cr=this._addTile(vr);Me[vr.key]=vr,!Cr.hasData()&&pe<this._source.maxzoom&&(Ct[vr.key]=vr)}this._retainLoadedChildren(Ct,pe,ut,Me);for(var Vr=0,Wr=Z;Vr<Wr.length;Vr+=1){var Ur=Wr[Vr],Jr=this._tiles[Ur.key];if(!Jr.hasData()){if(pe+1>this._source.maxzoom){var hn=Ur.children(this._source.maxzoom)[0],Cn=this.getTile(hn);if(Cn&&Cn.hasData()){Me[hn.key]=hn;continue}}else{var Fn=Ur.children(this._source.maxzoom);if(Me[Fn[0].key]&&Me[Fn[1].key]&&Me[Fn[2].key]&&Me[Fn[3].key])continue}for(var Kn=Jr.wasRequested(),qn=Ur.overscaledZ-1;qn>=je;--qn){var Qn=Ur.scaledTo(qn);if(Re[Qn.key]||(Re[Qn.key]=!0,Jr=this.getTile(Qn),!Jr&&Kn&&(Jr=this._addTile(Qn)),Jr&&(Me[Qn.key]=Qn,Kn=Jr.wasRequested(),Jr.hasData())))break}}}return Me},V.prototype._updateLoadedParentTileCache=function(){this._loadedParentTiles={};for(var Z in this._tiles){for(var pe=[],Me=void 0,Re=this._tiles[Z].tileID;Re.overscaledZ>0;){if(Re.key in this._loadedParentTiles){Me=this._loadedParentTiles[Re.key];break}pe.push(Re.key);var je=Re.scaledTo(Re.overscaledZ-1);if(Me=this._getLoadedTile(je),Me)break;Re=je}for(var ut=0,Ct=pe;ut<Ct.length;ut+=1){var Qt=Ct[ut];this._loadedParentTiles[Qt]=Me}}},V.prototype._addTile=function(Z){var pe=this._tiles[Z.key];if(pe)return pe;pe=this._cache.getAndRemove(Z),pe&&(this._setTileReloadTimer(Z.key,pe),pe.tileID=Z,this._state.initializeTileState(pe,this.map?this.map.painter:null),this._cacheTimers[Z.key]&&(clearTimeout(this._cacheTimers[Z.key]),delete this._cacheTimers[Z.key],this._setTileReloadTimer(Z.key,pe)));var Me=!!pe;return Me||(pe=new e.Tile(Z,this._source.tileSize*Z.overscaleFactor()),this._loadTile(pe,this._tileLoaded.bind(this,pe,Z.key,pe.state))),pe?(pe.uses++,this._tiles[Z.key]=pe,Me||this._source.fire(new e.Event("dataloading",{tile:pe,coord:pe.tileID,dataType:"source"})),pe):null},V.prototype._setTileReloadTimer=function(Z,pe){var Me=this;Z in this._timers&&(clearTimeout(this._timers[Z]),delete this._timers[Z]);var Re=pe.getExpiryTimeout();Re&&(this._timers[Z]=setTimeout(function(){Me._reloadTile(Z,"expired"),delete Me._timers[Z]},Re))},V.prototype._removeTile=function(Z){var pe=this._tiles[Z];pe&&(pe.uses--,delete this._tiles[Z],this._timers[Z]&&(clearTimeout(this._timers[Z]),delete this._timers[Z]),!(pe.uses>0)&&(pe.hasData()&&pe.state!=="reloading"?this._cache.add(pe.tileID,pe,pe.getExpiryTimeout()):(pe.aborted=!0,this._abortTile(pe),this._unloadTile(pe))))},V.prototype.clearTiles=function(){this._shouldReloadOnResume=!1,this._paused=!1;for(var Z in this._tiles)this._removeTile(Z);this._cache.reset()},V.prototype.tilesIn=function(Z,pe,Me){var Re=this,je=[],ut=this.transform;if(!ut)return je;for(var Ct=Me?ut.getCameraQueryGeometry(Z):Z,Qt=Z.map(function(qn){return ut.pointCoordinate(qn)}),ur=Ct.map(function(qn){return ut.pointCoordinate(qn)}),vr=this.getIds(),Cr=1/0,Vr=1/0,Wr=-1/0,Ur=-1/0,Jr=0,hn=ur;Jr<hn.length;Jr+=1){var Cn=hn[Jr];Cr=Math.min(Cr,Cn.x),Vr=Math.min(Vr,Cn.y),Wr=Math.max(Wr,Cn.x),Ur=Math.max(Ur,Cn.y)}for(var Fn=function(qn){var Qn=Re._tiles[vr[qn]];if(!Qn.holdingForFade()){var ca=Qn.tileID,ba=Math.pow(2,ut.zoom-Qn.tileID.overscaledZ),ya=pe*Qn.queryPadding*e.EXTENT/Qn.tileSize/ba,Ta=[ca.getTilePoint(new e.MercatorCoordinate(Cr,Vr)),ca.getTilePoint(new e.MercatorCoordinate(Wr,Ur))];if(Ta[0].x-ya<e.EXTENT&&Ta[0].y-ya<e.EXTENT&&Ta[1].x+ya>=0&&Ta[1].y+ya>=0){var Ca=Qt.map(function(ni){return ca.getTilePoint(ni)}),Ha=ur.map(function(ni){return ca.getTilePoint(ni)});je.push({tile:Qn,tileID:ca,queryGeometry:Ca,cameraQueryGeometry:Ha,scale:ba})}}},Kn=0;Kn<vr.length;Kn++)Fn(Kn);return je},V.prototype.getVisibleCoordinates=function(Z){for(var pe=this,Me=this.getRenderableIds(Z).map(function(Ct){return pe._tiles[Ct].tileID}),Re=0,je=Me;Re<je.length;Re+=1){var ut=je[Re];ut.posMatrix=this.transform.calculatePosMatrix(ut.toUnwrapped())}return Me},V.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(nt(this._source.type))for(var Z in this._tiles){var pe=this._tiles[Z];if(pe.fadeEndTime!==void 0&&pe.fadeEndTime>=e.browser.now())return!0}return!1},V.prototype.setFeatureState=function(Z,pe,Me){Z=Z||"_geojsonTileLayer",this._state.updateState(Z,pe,Me)},V.prototype.removeFeatureState=function(Z,pe,Me){Z=Z||"_geojsonTileLayer",this._state.removeFeatureState(Z,pe,Me)},V.prototype.getFeatureState=function(Z,pe){return Z=Z||"_geojsonTileLayer",this._state.getState(Z,pe)},V.prototype.setDependencies=function(Z,pe,Me){var Re=this._tiles[Z];Re&&Re.setDependencies(pe,Me)},V.prototype.reloadTilesForDependencies=function(Z,pe){for(var Me in this._tiles){var Re=this._tiles[Me];Re.hasDependency(Z,pe)&&this._reloadTile(Me,"reloading")}this._cache.filter(function(je){return!je.hasDependency(Z,pe)})},V}(e.Evented);Ce.maxOverzooming=10,Ce.maxUnderzooming=3;function Se(fe,V){var ve=Math.abs(fe.wrap*2)-+(fe.wrap<0),Z=Math.abs(V.wrap*2)-+(V.wrap<0);return fe.overscaledZ-V.overscaledZ||Z-ve||V.canonical.y-fe.canonical.y||V.canonical.x-fe.canonical.x}function nt(fe){return fe==="raster"||fe==="image"||fe==="video"}function it(){return new e.window.Worker(Mc.workerUrl)}var ct="mapboxgl_preloaded_worker_pool",kt=function(){this.active={}};kt.prototype.acquire=function(V){if(!this.workers)for(this.workers=[];this.workers.length<kt.workerCount;)this.workers.push(new it);return this.active[V]=!0,this.workers.slice()},kt.prototype.release=function(V){delete this.active[V],this.numActive()===0&&(this.workers.forEach(function(ve){ve.terminate()}),this.workers=null)},kt.prototype.isPreloaded=function(){return!!this.active[ct]},kt.prototype.numActive=function(){return Object.keys(this.active).length};var gt=Math.floor(e.browser.hardwareConcurrency/2);kt.workerCount=Math.max(Math.min(gt,6),1);var St;function Yt(){return St||(St=new kt),St}function ar(){var fe=Yt();fe.acquire(ct)}function kr(){var fe=St;fe&&(fe.isPreloaded()&&fe.numActive()===1?(fe.release(ct),St=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}function br(fe,V){var ve={};for(var Z in fe)Z!=="ref"&&(ve[Z]=fe[Z]);return e.refProperties.forEach(function(pe){pe in V&&(ve[pe]=V[pe])}),ve}function Mr(fe){fe=fe.slice();for(var V=Object.create(null),ve=0;ve<fe.length;ve++)V[fe[ve].id]=fe[ve];for(var Z=0;Z<fe.length;Z++)"ref"in fe[Z]&&(fe[Z]=br(fe[Z],V[fe[Z].ref]));return fe}function Yr(){var fe={},V=e.styleSpec.$version;for(var ve in e.styleSpec.$root){var Z=e.styleSpec.$root[ve];if(Z.required){var pe=null;ve==="version"?pe=V:Z.type==="array"?pe=[]:pe={},pe!=null&&(fe[ve]=pe)}}return fe}var nr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function gr(fe,V,ve){ve.push({command:nr.addSource,args:[fe,V[fe]]})}function Rr(fe,V,ve){V.push({command:nr.removeSource,args:[fe]}),ve[fe]=!0}function Br(fe,V,ve,Z){Rr(fe,ve,Z),gr(fe,V,ve)}function Sr(fe,V,ve){var Z;for(Z in fe[ve])if(fe[ve].hasOwnProperty(Z)&&Z!=="data"&&!e.deepEqual(fe[ve][Z],V[ve][Z]))return!1;for(Z in V[ve])if(V[ve].hasOwnProperty(Z)&&Z!=="data"&&!e.deepEqual(fe[ve][Z],V[ve][Z]))return!1;return!0}function et(fe,V,ve,Z){fe=fe||{},V=V||{};var pe;for(pe in fe)fe.hasOwnProperty(pe)&&(V.hasOwnProperty(pe)||Rr(pe,ve,Z));for(pe in V)V.hasOwnProperty(pe)&&(fe.hasOwnProperty(pe)?e.deepEqual(fe[pe],V[pe])||(fe[pe].type==="geojson"&&V[pe].type==="geojson"&&Sr(fe,V,pe)?ve.push({command:nr.setGeoJSONSourceData,args:[pe,V[pe].data]}):Br(pe,V,ve,Z)):gr(pe,V,ve))}function Lt(fe,V,ve,Z,pe,Me){fe=fe||{},V=V||{};var Re;for(Re in fe)fe.hasOwnProperty(Re)&&(e.deepEqual(fe[Re],V[Re])||ve.push({command:Me,args:[Z,Re,V[Re],pe]}));for(Re in V)!V.hasOwnProperty(Re)||fe.hasOwnProperty(Re)||e.deepEqual(fe[Re],V[Re])||ve.push({command:Me,args:[Z,Re,V[Re],pe]})}function Zt(fe){return fe.id}function or(fe,V){return fe[V.id]=V,fe}function Ir(fe,V,ve){fe=fe||[],V=V||[];var Z=fe.map(Zt),pe=V.map(Zt),Me=fe.reduce(or,{}),Re=V.reduce(or,{}),je=Z.slice(),ut=Object.create(null),Ct,Qt,ur,vr,Cr,Vr,Wr;for(Ct=0,Qt=0;Ct<Z.length;Ct++)ur=Z[Ct],Re.hasOwnProperty(ur)?Qt++:(ve.push({command:nr.removeLayer,args:[ur]}),je.splice(je.indexOf(ur,Qt),1));for(Ct=0,Qt=0;Ct<pe.length;Ct++)ur=pe[pe.length-1-Ct],je[je.length-1-Ct]!==ur&&(Me.hasOwnProperty(ur)?(ve.push({command:nr.removeLayer,args:[ur]}),je.splice(je.lastIndexOf(ur,je.length-Qt),1)):Qt++,Vr=je[je.length-Ct],ve.push({command:nr.addLayer,args:[Re[ur],Vr]}),je.splice(je.length-Ct,0,ur),ut[ur]=!0);for(Ct=0;Ct<pe.length;Ct++)if(ur=pe[Ct],vr=Me[ur],Cr=Re[ur],!(ut[ur]||e.deepEqual(vr,Cr))){if(!e.deepEqual(vr.source,Cr.source)||!e.deepEqual(vr["source-layer"],Cr["source-layer"])||!e.deepEqual(vr.type,Cr.type)){ve.push({command:nr.removeLayer,args:[ur]}),Vr=je[je.lastIndexOf(ur)+1],ve.push({command:nr.addLayer,args:[Cr,Vr]});continue}Lt(vr.layout,Cr.layout,ve,ur,null,nr.setLayoutProperty),Lt(vr.paint,Cr.paint,ve,ur,null,nr.setPaintProperty),e.deepEqual(vr.filter,Cr.filter)||ve.push({command:nr.setFilter,args:[ur,Cr.filter]}),(!e.deepEqual(vr.minzoom,Cr.minzoom)||!e.deepEqual(vr.maxzoom,Cr.maxzoom))&&ve.push({command:nr.setLayerZoomRange,args:[ur,Cr.minzoom,Cr.maxzoom]});for(Wr in vr)vr.hasOwnProperty(Wr)&&(Wr==="layout"||Wr==="paint"||Wr==="filter"||Wr==="metadata"||Wr==="minzoom"||Wr==="maxzoom"||(Wr.indexOf("paint.")===0?Lt(vr[Wr],Cr[Wr],ve,ur,Wr.slice(6),nr.setPaintProperty):e.deepEqual(vr[Wr],Cr[Wr])||ve.push({command:nr.setLayerProperty,args:[ur,Wr,Cr[Wr]]})));for(Wr in Cr)!Cr.hasOwnProperty(Wr)||vr.hasOwnProperty(Wr)||Wr==="layout"||Wr==="paint"||Wr==="filter"||Wr==="metadata"||Wr==="minzoom"||Wr==="maxzoom"||(Wr.indexOf("paint.")===0?Lt(vr[Wr],Cr[Wr],ve,ur,Wr.slice(6),nr.setPaintProperty):e.deepEqual(vr[Wr],Cr[Wr])||ve.push({command:nr.setLayerProperty,args:[ur,Wr,Cr[Wr]]}))}}function Or(fe,V){if(!fe)return[{command:nr.setStyle,args:[V]}];var ve=[];try{if(!e.deepEqual(fe.version,V.version))return[{command:nr.setStyle,args:[V]}];e.deepEqual(fe.center,V.center)||ve.push({command:nr.setCenter,args:[V.center]}),e.deepEqual(fe.zoom,V.zoom)||ve.push({command:nr.setZoom,args:[V.zoom]}),e.deepEqual(fe.bearing,V.bearing)||ve.push({command:nr.setBearing,args:[V.bearing]}),e.deepEqual(fe.pitch,V.pitch)||ve.push({command:nr.setPitch,args:[V.pitch]}),e.deepEqual(fe.sprite,V.sprite)||ve.push({command:nr.setSprite,args:[V.sprite]}),e.deepEqual(fe.glyphs,V.glyphs)||ve.push({command:nr.setGlyphs,args:[V.glyphs]}),e.deepEqual(fe.transition,V.transition)||ve.push({command:nr.setTransition,args:[V.transition]}),e.deepEqual(fe.light,V.light)||ve.push({command:nr.setLight,args:[V.light]});var Z={},pe=[];et(fe.sources,V.sources,pe,Z);var Me=[];fe.layers&&fe.layers.forEach(function(Re){Z[Re.source]?ve.push({command:nr.removeLayer,args:[Re.id]}):Me.push(Re)}),ve=ve.concat(pe),Ir(Me,V.layers,ve)}catch(Re){console.warn("Unable to compute style diff:",Re),ve=[{command:nr.setStyle,args:[V]}]}return ve}var Er=function(V,ve){this.reset(V,ve)};Er.prototype.reset=function(V,ve){this.points=V||[],this._distances=[0];for(var Z=1;Z<this.points.length;Z++)this._distances[Z]=this._distances[Z-1]+this.points[Z].dist(this.points[Z-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(ve||0,this.length*.5),this.paddedLength=this.length-this.padding*2},Er.prototype.lerp=function(V){if(this.points.length===1)return this.points[0];V=e.clamp(V,0,1);for(var ve=1,Z=this._distances[ve],pe=V*this.paddedLength+this.padding;Z<pe&&ve<this._distances.length;)Z=this._distances[++ve];var Me=ve-1,Re=this._distances[Me],je=Z-Re,ut=je>0?(pe-Re)/je:0;return this.points[Me].mult(1-ut).add(this.points[ve].mult(ut))};var wr=function(V,ve,Z){var pe=this.boxCells=[],Me=this.circleCells=[];this.xCellCount=Math.ceil(V/Z),this.yCellCount=Math.ceil(ve/Z);for(var Re=0;Re<this.xCellCount*this.yCellCount;Re++)pe.push([]),Me.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=V,this.height=ve,this.xScale=this.xCellCount/V,this.yScale=this.yCellCount/ve,this.boxUid=0,this.circleUid=0};wr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},wr.prototype.insert=function(V,ve,Z,pe,Me){this._forEachCell(ve,Z,pe,Me,this._insertBoxCell,this.boxUid++),this.boxKeys.push(V),this.bboxes.push(ve),this.bboxes.push(Z),this.bboxes.push(pe),this.bboxes.push(Me)},wr.prototype.insertCircle=function(V,ve,Z,pe){this._forEachCell(ve-pe,Z-pe,ve+pe,Z+pe,this._insertCircleCell,this.circleUid++),this.circleKeys.push(V),this.circles.push(ve),this.circles.push(Z),this.circles.push(pe)},wr.prototype._insertBoxCell=function(V,ve,Z,pe,Me,Re){this.boxCells[Me].push(Re)},wr.prototype._insertCircleCell=function(V,ve,Z,pe,Me,Re){this.circleCells[Me].push(Re)},wr.prototype._query=function(V,ve,Z,pe,Me,Re){if(Z<0||V>this.width||pe<0||ve>this.height)return Me?!1:[];var je=[];if(V<=0&&ve<=0&&this.width<=Z&&this.height<=pe){if(Me)return!0;for(var ut=0;ut<this.boxKeys.length;ut++)je.push({key:this.boxKeys[ut],x1:this.bboxes[ut*4],y1:this.bboxes[ut*4+1],x2:this.bboxes[ut*4+2],y2:this.bboxes[ut*4+3]});for(var Ct=0;Ct<this.circleKeys.length;Ct++){var Qt=this.circles[Ct*3],ur=this.circles[Ct*3+1],vr=this.circles[Ct*3+2];je.push({key:this.circleKeys[Ct],x1:Qt-vr,y1:ur-vr,x2:Qt+vr,y2:ur+vr})}return Re?je.filter(Re):je}else{var Cr={hitTest:Me,seenUids:{box:{},circle:{}}};return this._forEachCell(V,ve,Z,pe,this._queryCell,je,Cr,Re),Me?je.length>0:je}},wr.prototype._queryCircle=function(V,ve,Z,pe,Me){var Re=V-Z,je=V+Z,ut=ve-Z,Ct=ve+Z;if(je<0||Re>this.width||Ct<0||ut>this.height)return pe?!1:[];var Qt=[],ur={hitTest:pe,circle:{x:V,y:ve,radius:Z},seenUids:{box:{},circle:{}}};return this._forEachCell(Re,ut,je,Ct,this._queryCellCircle,Qt,ur,Me),pe?Qt.length>0:Qt},wr.prototype.query=function(V,ve,Z,pe,Me){return this._query(V,ve,Z,pe,!1,Me)},wr.prototype.hitTest=function(V,ve,Z,pe,Me){return this._query(V,ve,Z,pe,!0,Me)},wr.prototype.hitTestCircle=function(V,ve,Z,pe){return this._queryCircle(V,ve,Z,!0,pe)},wr.prototype._queryCell=function(V,ve,Z,pe,Me,Re,je,ut){var Ct=je.seenUids,Qt=this.boxCells[Me];if(Qt!==null)for(var ur=this.bboxes,vr=0,Cr=Qt;vr<Cr.length;vr+=1){var Vr=Cr[vr];if(!Ct.box[Vr]){Ct.box[Vr]=!0;var Wr=Vr*4;if(V<=ur[Wr+2]&&ve<=ur[Wr+3]&&Z>=ur[Wr+0]&&pe>=ur[Wr+1]&&(!ut||ut(this.boxKeys[Vr]))){if(je.hitTest)return Re.push(!0),!0;Re.push({key:this.boxKeys[Vr],x1:ur[Wr],y1:ur[Wr+1],x2:ur[Wr+2],y2:ur[Wr+3]})}}}var Ur=this.circleCells[Me];if(Ur!==null)for(var Jr=this.circles,hn=0,Cn=Ur;hn<Cn.length;hn+=1){var Fn=Cn[hn];if(!Ct.circle[Fn]){Ct.circle[Fn]=!0;var Kn=Fn*3;if(this._circleAndRectCollide(Jr[Kn],Jr[Kn+1],Jr[Kn+2],V,ve,Z,pe)&&(!ut||ut(this.circleKeys[Fn]))){if(je.hitTest)return Re.push(!0),!0;var qn=Jr[Kn],Qn=Jr[Kn+1],ca=Jr[Kn+2];Re.push({key:this.circleKeys[Fn],x1:qn-ca,y1:Qn-ca,x2:qn+ca,y2:Qn+ca})}}}},wr.prototype._queryCellCircle=function(V,ve,Z,pe,Me,Re,je,ut){var Ct=je.circle,Qt=je.seenUids,ur=this.boxCells[Me];if(ur!==null)for(var vr=this.bboxes,Cr=0,Vr=ur;Cr<Vr.length;Cr+=1){var Wr=Vr[Cr];if(!Qt.box[Wr]){Qt.box[Wr]=!0;var Ur=Wr*4;if(this._circleAndRectCollide(Ct.x,Ct.y,Ct.radius,vr[Ur+0],vr[Ur+1],vr[Ur+2],vr[Ur+3])&&(!ut||ut(this.boxKeys[Wr])))return Re.push(!0),!0}}var Jr=this.circleCells[Me];if(Jr!==null)for(var hn=this.circles,Cn=0,Fn=Jr;Cn<Fn.length;Cn+=1){var Kn=Fn[Cn];if(!Qt.circle[Kn]){Qt.circle[Kn]=!0;var qn=Kn*3;if(this._circlesCollide(hn[qn],hn[qn+1],hn[qn+2],Ct.x,Ct.y,Ct.radius)&&(!ut||ut(this.circleKeys[Kn])))return Re.push(!0),!0}}},wr.prototype._forEachCell=function(V,ve,Z,pe,Me,Re,je,ut){for(var Ct=this._convertToXCellCoord(V),Qt=this._convertToYCellCoord(ve),ur=this._convertToXCellCoord(Z),vr=this._convertToYCellCoord(pe),Cr=Ct;Cr<=ur;Cr++)for(var Vr=Qt;Vr<=vr;Vr++){var Wr=this.xCellCount*Vr+Cr;if(Me.call(this,V,ve,Z,pe,Wr,Re,je,ut))return}},wr.prototype._convertToXCellCoord=function(V){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(V*this.xScale)))},wr.prototype._convertToYCellCoord=function(V){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(V*this.yScale)))},wr.prototype._circlesCollide=function(V,ve,Z,pe,Me,Re){var je=pe-V,ut=Me-ve,Ct=Z+Re;return Ct*Ct>je*je+ut*ut},wr.prototype._circleAndRectCollide=function(V,ve,Z,pe,Me,Re,je){var ut=(Re-pe)/2,Ct=Math.abs(V-(pe+ut));if(Ct>ut+Z)return!1;var Qt=(je-Me)/2,ur=Math.abs(ve-(Me+Qt));if(ur>Qt+Z)return!1;if(Ct<=ut||ur<=Qt)return!0;var vr=Ct-ut,Cr=ur-Qt;return vr*vr+Cr*Cr<=Z*Z};function Gr(fe,V,ve,Z,pe){var Me=e.create();return V?(e.scale(Me,Me,[1/pe,1/pe,1]),ve||e.rotateZ(Me,Me,Z.angle)):e.multiply(Me,Z.labelPlaneMatrix,fe),Me}function wn(fe,V,ve,Z,pe){if(V){var Me=e.clone(fe);return e.scale(Me,Me,[pe,pe,1]),ve||e.rotateZ(Me,Me,-Z.angle),Me}else return Z.glCoordMatrix}function cn(fe,V){var ve=[fe.x,fe.y,0,1];Tr(ve,ve,V);var Z=ve[3];return{point:new e.Point(ve[0]/Z,ve[1]/Z),signedDistanceFromCamera:Z}}function Bn(fe,V){return .5+.5*(fe/V)}function En(fe,V){var ve=fe[0]/fe[3],Z=fe[1]/fe[3],pe=ve>=-V[0]&&ve<=V[0]&&Z>=-V[1]&&Z<=V[1];return pe}function Yn(fe,V,ve,Z,pe,Me,Re,je){var ut=Z?fe.textSizeData:fe.iconSizeData,Ct=e.evaluateSizeForZoom(ut,ve.transform.zoom),Qt=[256/ve.width*2+1,256/ve.height*2+1],ur=Z?fe.text.dynamicLayoutVertexArray:fe.icon.dynamicLayoutVertexArray;ur.clear();for(var vr=fe.lineVertexArray,Cr=Z?fe.text.placedSymbolArray:fe.icon.placedSymbolArray,Vr=ve.transform.width/ve.transform.height,Wr=!1,Ur=0;Ur<Cr.length;Ur++){var Jr=Cr.get(Ur);if(Jr.hidden||Jr.writingMode===e.WritingMode.vertical&&!Wr){Wa(Jr.numGlyphs,ur);continue}Wr=!1;var hn=[Jr.anchorX,Jr.anchorY,0,1];if(e.transformMat4(hn,hn,V),!En(hn,Qt)){Wa(Jr.numGlyphs,ur);continue}var Cn=hn[3],Fn=Bn(ve.transform.cameraToCenterDistance,Cn),Kn=e.evaluateSizeForFeature(ut,Ct,Jr),qn=Re?Kn/Fn:Kn*Fn,Qn=new e.Point(Jr.anchorX,Jr.anchorY),ca=cn(Qn,pe).point,ba={},ya=Ma(Jr,qn,!1,je,V,pe,Me,fe.glyphOffsetArray,vr,ur,ca,Qn,ba,Vr);Wr=ya.useVertical,(ya.notEnoughRoom||Wr||ya.needsFlipping&&Ma(Jr,qn,!0,je,V,pe,Me,fe.glyphOffsetArray,vr,ur,ca,Qn,ba,Vr).notEnoughRoom)&&Wa(Jr.numGlyphs,ur)}Z?fe.text.dynamicLayoutVertexBuffer.updateData(ur):fe.icon.dynamicLayoutVertexBuffer.updateData(ur)}function Vn(fe,V,ve,Z,pe,Me,Re,je,ut,Ct,Qt){var ur=je.glyphStartIndex+je.numGlyphs,vr=je.lineStartIndex,Cr=je.lineStartIndex+je.lineLength,Vr=V.getoffsetX(je.glyphStartIndex),Wr=V.getoffsetX(ur-1),Ur=Va(fe*Vr,ve,Z,pe,Me,Re,je.segment,vr,Cr,ut,Ct,Qt);if(!Ur)return null;var Jr=Va(fe*Wr,ve,Z,pe,Me,Re,je.segment,vr,Cr,ut,Ct,Qt);return Jr?{first:Ur,last:Jr}:null}function pa(fe,V,ve,Z){if(fe===e.WritingMode.horizontal){var pe=Math.abs(ve.y-V.y),Me=Math.abs(ve.x-V.x)*Z;if(pe>Me)return{useVertical:!0}}return(fe===e.WritingMode.vertical?V.y<ve.y:V.x>ve.x)?{needsFlipping:!0}:null}function Ma(fe,V,ve,Z,pe,Me,Re,je,ut,Ct,Qt,ur,vr,Cr){var Vr=V/24,Wr=fe.lineOffsetX*Vr,Ur=fe.lineOffsetY*Vr,Jr;if(fe.numGlyphs>1){var hn=fe.glyphStartIndex+fe.numGlyphs,Cn=fe.lineStartIndex,Fn=fe.lineStartIndex+fe.lineLength,Kn=Vn(Vr,je,Wr,Ur,ve,Qt,ur,fe,ut,Me,vr);if(!Kn)return{notEnoughRoom:!0};var qn=cn(Kn.first.point,Re).point,Qn=cn(Kn.last.point,Re).point;if(Z&&!ve){var ca=pa(fe.writingMode,qn,Qn,Cr);if(ca)return ca}Jr=[Kn.first];for(var ba=fe.glyphStartIndex+1;ba<hn-1;ba++)Jr.push(Va(Vr*je.getoffsetX(ba),Wr,Ur,ve,Qt,ur,fe.segment,Cn,Fn,ut,Me,vr));Jr.push(Kn.last)}else{if(Z&&!ve){var ya=cn(ur,pe).point,Ta=fe.lineStartIndex+fe.segment+1,Ca=new e.Point(ut.getx(Ta),ut.gety(Ta)),Ha=cn(Ca,pe),ni=Ha.signedDistanceFromCamera>0?Ha.point:ci(ur,Ca,ya,1,pe),Li=pa(fe.writingMode,ya,ni,Cr);if(Li)return Li}var ui=Va(Vr*je.getoffsetX(fe.glyphStartIndex),Wr,Ur,ve,Qt,ur,fe.segment,fe.lineStartIndex,fe.lineStartIndex+fe.lineLength,ut,Me,vr);if(!ui)return{notEnoughRoom:!0};Jr=[ui]}for(var pi=0,Ba=Jr;pi<Ba.length;pi+=1){var Pi=Ba[pi];e.addDynamicAttributes(Ct,Pi.point,Pi.angle)}return{}}function ci(fe,V,ve,Z,pe){var Me=cn(fe.add(fe.sub(V)._unit()),pe).point,Re=ve.sub(Me);return ve.add(Re._mult(Z/Re.mag()))}function Va(fe,V,ve,Z,pe,Me,Re,je,ut,Ct,Qt,ur){var vr=Z?fe-V:fe+V,Cr=vr>0?1:-1,Vr=0;Z&&(Cr*=-1,Vr=Math.PI),Cr<0&&(Vr+=Math.PI);for(var Wr=Cr>0?je+Re:je+Re+1,Ur=pe,Jr=pe,hn=0,Cn=0,Fn=Math.abs(vr),Kn=[];hn+Cn<=Fn;){if(Wr+=Cr,Wr<je||Wr>=ut)return null;if(Jr=Ur,Kn.push(Ur),Ur=ur[Wr],Ur===void 0){var qn=new e.Point(Ct.getx(Wr),Ct.gety(Wr)),Qn=cn(qn,Qt);if(Qn.signedDistanceFromCamera>0)Ur=ur[Wr]=Qn.point;else{var ca=Wr-Cr,ba=hn===0?Me:new e.Point(Ct.getx(ca),Ct.gety(ca));Ur=ci(ba,qn,Jr,Fn-hn+1,Qt)}}hn+=Cn,Cn=Jr.dist(Ur)}var ya=(Fn-hn)/Cn,Ta=Ur.sub(Jr),Ca=Ta.mult(ya)._add(Jr);Ca._add(Ta._unit()._perp()._mult(ve*Cr));var Ha=Vr+Math.atan2(Ur.y-Jr.y,Ur.x-Jr.x);return Kn.push(Ca),{point:Ca,angle:Ha,path:Kn}}var ja=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wa(fe,V){for(var ve=0;ve<fe;ve++){var Z=V.length;V.resize(Z+4),V.float32.set(ja,Z*3)}}function Tr(fe,V,ve){var Z=V[0],pe=V[1];return fe[0]=ve[0]*Z+ve[4]*pe+ve[12],fe[1]=ve[1]*Z+ve[5]*pe+ve[13],fe[3]=ve[3]*Z+ve[7]*pe+ve[15],fe}var pn=100,fn=function(V,ve,Z){ve===void 0&&(ve=new wr(V.width+2*pn,V.height+2*pn,25)),Z===void 0&&(Z=new wr(V.width+2*pn,V.height+2*pn,25)),this.transform=V,this.grid=ve,this.ignoredGrid=Z,this.pitchfactor=Math.cos(V._pitch)*V.cameraToCenterDistance,this.screenRightBoundary=V.width+pn,this.screenBottomBoundary=V.height+pn,this.gridRightBoundary=V.width+2*pn,this.gridBottomBoundary=V.height+2*pn};fn.prototype.placeCollisionBox=function(V,ve,Z,pe,Me){var Re=this.projectAndGetPerspectiveRatio(pe,V.anchorPointX,V.anchorPointY),je=Z*Re.perspectiveRatio,ut=V.x1*je+Re.point.x,Ct=V.y1*je+Re.point.y,Qt=V.x2*je+Re.point.x,ur=V.y2*je+Re.point.y;return!this.isInsideGrid(ut,Ct,Qt,ur)||!ve&&this.grid.hitTest(ut,Ct,Qt,ur,Me)?{box:[],offscreen:!1}:{box:[ut,Ct,Qt,ur],offscreen:this.isOffscreen(ut,Ct,Qt,ur)}},fn.prototype.placeCollisionCircles=function(V,ve,Z,pe,Me,Re,je,ut,Ct,Qt,ur,vr,Cr){var Vr=[],Wr=new e.Point(ve.anchorX,ve.anchorY),Ur=cn(Wr,Re),Jr=Bn(this.transform.cameraToCenterDistance,Ur.signedDistanceFromCamera),hn=Qt?Me/Jr:Me*Jr,Cn=hn/e.ONE_EM,Fn=cn(Wr,je).point,Kn={},qn=ve.lineOffsetX*Cn,Qn=ve.lineOffsetY*Cn,ca=Vn(Cn,pe,qn,Qn,!1,Fn,Wr,ve,Z,je,Kn),ba=!1,ya=!1,Ta=!0;if(ca){for(var Ca=vr*.5*Jr+Cr,Ha=new e.Point(-pn,-pn),ni=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),Li=new Er,ui=ca.first,pi=ca.last,Ba=[],Pi=ui.path.length-1;Pi>=1;Pi--)Ba.push(ui.path[Pi]);for(var zi=1;zi<pi.path.length;zi++)Ba.push(pi.path[zi]);var Ni=Ca*2.5;if(ut){var _i=Ba.map(function(ru){return cn(ru,ut)});_i.some(function(ru){return ru.signedDistanceFromCamera<=0})?Ba=[]:Ba=_i.map(function(ru){return ru.point})}var ji=[];if(Ba.length>0){for(var ii=Ba[0].clone(),wi=Ba[0].clone(),wo=1;wo<Ba.length;wo++)ii.x=Math.min(ii.x,Ba[wo].x),ii.y=Math.min(ii.y,Ba[wo].y),wi.x=Math.max(wi.x,Ba[wo].x),wi.y=Math.max(wi.y,Ba[wo].y);ii.x>=Ha.x&&wi.x<=ni.x&&ii.y>=Ha.y&&wi.y<=ni.y?ji=[Ba]:wi.x<Ha.x||ii.x>ni.x||wi.y<Ha.y||ii.y>ni.y?ji=[]:ji=e.clipLine([Ba],Ha.x,Ha.y,ni.x,ni.y)}for(var Bo=0,Sl=ji;Bo<Sl.length;Bo+=1){var kl=Sl[Bo];Li.reset(kl,Ca*.25);var $l=0;Li.length<=.5*Ca?$l=1:$l=Math.ceil(Li.paddedLength/Ni)+1;for(var ql=0;ql<$l;ql++){var _u=ql/Math.max($l-1,1),eu=Li.lerp(_u),Bs=eu.x+pn,Vu=eu.y+pn;Vr.push(Bs,Vu,Ca,0);var bs=Bs-Ca,cl=Vu-Ca,tu=Bs+Ca,Vl=Vu+Ca;if(Ta=Ta&&this.isOffscreen(bs,cl,tu,Vl),ya=ya||this.isInsideGrid(bs,cl,tu,Vl),!V&&this.grid.hitTestCircle(Bs,Vu,Ca,ur)&&(ba=!0,!Ct))return{circles:[],offscreen:!1,collisionDetected:ba}}}}return{circles:!Ct&&ba||!ya?[]:Vr,offscreen:Ta,collisionDetected:ba}},fn.prototype.queryRenderedSymbols=function(V){if(V.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var ve=[],Z=1/0,pe=1/0,Me=-1/0,Re=-1/0,je=0,ut=V;je<ut.length;je+=1){var Ct=ut[je],Qt=new e.Point(Ct.x+pn,Ct.y+pn);Z=Math.min(Z,Qt.x),pe=Math.min(pe,Qt.y),Me=Math.max(Me,Qt.x),Re=Math.max(Re,Qt.y),ve.push(Qt)}for(var ur=this.grid.query(Z,pe,Me,Re).concat(this.ignoredGrid.query(Z,pe,Me,Re)),vr={},Cr={},Vr=0,Wr=ur;Vr<Wr.length;Vr+=1){var Ur=Wr[Vr],Jr=Ur.key;if(vr[Jr.bucketInstanceId]===void 0&&(vr[Jr.bucketInstanceId]={}),!vr[Jr.bucketInstanceId][Jr.featureIndex]){var hn=[new e.Point(Ur.x1,Ur.y1),new e.Point(Ur.x2,Ur.y1),new e.Point(Ur.x2,Ur.y2),new e.Point(Ur.x1,Ur.y2)];e.polygonIntersectsPolygon(ve,hn)&&(vr[Jr.bucketInstanceId][Jr.featureIndex]=!0,Cr[Jr.bucketInstanceId]===void 0&&(Cr[Jr.bucketInstanceId]=[]),Cr[Jr.bucketInstanceId].push(Jr.featureIndex))}}return Cr},fn.prototype.insertCollisionBox=function(V,ve,Z,pe,Me){var Re=ve?this.ignoredGrid:this.grid,je={bucketInstanceId:Z,featureIndex:pe,collisionGroupID:Me};Re.insert(je,V[0],V[1],V[2],V[3])},fn.prototype.insertCollisionCircles=function(V,ve,Z,pe,Me){for(var Re=ve?this.ignoredGrid:this.grid,je={bucketInstanceId:Z,featureIndex:pe,collisionGroupID:Me},ut=0;ut<V.length;ut+=4)Re.insertCircle(je,V[ut],V[ut+1],V[ut+2])},fn.prototype.projectAndGetPerspectiveRatio=function(V,ve,Z){var pe=[ve,Z,0,1];Tr(pe,pe,V);var Me=new e.Point((pe[0]/pe[3]+1)/2*this.transform.width+pn,(-pe[1]/pe[3]+1)/2*this.transform.height+pn);return{point:Me,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/pe[3])}},fn.prototype.isOffscreen=function(V,ve,Z,pe){return Z<pn||V>=this.screenRightBoundary||pe<pn||ve>this.screenBottomBoundary},fn.prototype.isInsideGrid=function(V,ve,Z,pe){return Z>=0&&V<this.gridRightBoundary&&pe>=0&&ve<this.gridBottomBoundary},fn.prototype.getViewportMatrix=function(){var V=e.identity([]);return e.translate(V,V,[-pn,-pn,0]),V};function An(fe,V,ve){return V*(e.EXTENT/(fe.tileSize*Math.pow(2,ve-fe.tileID.overscaledZ)))}var Zn=function(V,ve,Z,pe){V?this.opacity=Math.max(0,Math.min(1,V.opacity+(V.placed?ve:-ve))):this.opacity=pe&&Z?1:0,this.placed=Z};Zn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ua=function(V,ve,Z,pe,Me){this.text=new Zn(V?V.text:null,ve,Z,Me),this.icon=new Zn(V?V.icon:null,ve,pe,Me)};ua.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ea=function(V,ve,Z){this.text=V,this.icon=ve,this.skipFade=Z},Rn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},Xn=function(V,ve,Z,pe,Me){this.bucketInstanceId=V,this.featureIndex=ve,this.sourceLayerIndex=Z,this.bucketIndex=pe,this.tileID=Me},Ua=function(V){this.crossSourceCollisions=V,this.maxGroupID=0,this.collisionGroups={}};Ua.prototype.get=function(V){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[V]){var ve=++this.maxGroupID;this.collisionGroups[V]={ID:ve,predicate:function(Z){return Z.collisionGroupID===ve}}}return this.collisionGroups[V]};function li(fe,V,ve,Z,pe){var Me=e.getAnchorAlignment(fe),Re=Me.horizontalAlign,je=Me.verticalAlign,ut=-(Re-.5)*V,Ct=-(je-.5)*ve,Qt=e.evaluateVariableOffset(fe,Z);return new e.Point(ut+Qt[0]*pe,Ct+Qt[1]*pe)}function Ht(fe,V,ve,Z,pe,Me){var Re=fe.x1,je=fe.x2,ut=fe.y1,Ct=fe.y2,Qt=fe.anchorPointX,ur=fe.anchorPointY,vr=new e.Point(V,ve);return Z&&vr._rotate(pe?Me:-Me),{x1:Re+vr.x,y1:ut+vr.y,x2:je+vr.x,y2:Ct+vr.y,anchorPointX:Qt,anchorPointY:ur}}var hr=function(V,ve,Z,pe){this.transform=V.clone(),this.collisionIndex=new fn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=ve,this.retainedQueryData={},this.collisionGroups=new Ua(Z),this.collisionCircleArrays={},this.prevPlacement=pe,pe&&(pe.prevPlacement=void 0),this.placedOrientations={}};hr.prototype.getBucketParts=function(V,ve,Z,pe){var Me=Z.getBucket(ve),Re=Z.latestFeatureIndex;if(!(!Me||!Re||ve.id!==Me.layerIds[0])){var je=Z.collisionBoxArray,ut=Me.layers[0].layout,Ct=Math.pow(2,this.transform.zoom-Z.tileID.overscaledZ),Qt=Z.tileSize/e.EXTENT,ur=this.transform.calculatePosMatrix(Z.tileID.toUnwrapped()),vr=ut.get("text-pitch-alignment")==="map",Cr=ut.get("text-rotation-alignment")==="map",Vr=An(Z,1,this.transform.zoom),Wr=Gr(ur,vr,Cr,this.transform,Vr),Ur=null;if(vr){var Jr=wn(ur,vr,Cr,this.transform,Vr);Ur=e.multiply([],this.transform.labelPlaneMatrix,Jr)}this.retainedQueryData[Me.bucketInstanceId]=new Xn(Me.bucketInstanceId,Re,Me.sourceLayerIndex,Me.index,Z.tileID);var hn={bucket:Me,layout:ut,posMatrix:ur,textLabelPlaneMatrix:Wr,labelToScreenMatrix:Ur,scale:Ct,textPixelRatio:Qt,holdingForFade:Z.holdingForFade(),collisionBoxArray:je,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(Me.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(Me.sourceID)};if(pe)for(var Cn=0,Fn=Me.sortKeyRanges;Cn<Fn.length;Cn+=1){var Kn=Fn[Cn],qn=Kn.sortKey,Qn=Kn.symbolInstanceStart,ca=Kn.symbolInstanceEnd;V.push({sortKey:qn,symbolInstanceStart:Qn,symbolInstanceEnd:ca,parameters:hn})}else V.push({symbolInstanceStart:0,symbolInstanceEnd:Me.symbolInstances.length,parameters:hn})}},hr.prototype.attemptAnchorPlacement=function(V,ve,Z,pe,Me,Re,je,ut,Ct,Qt,ur,vr,Cr,Vr,Wr){var Ur=[vr.textOffset0,vr.textOffset1],Jr=li(V,Z,pe,Ur,Me),hn=this.collisionIndex.placeCollisionBox(Ht(ve,Jr.x,Jr.y,Re,je,this.transform.angle),ur,ut,Ct,Qt.predicate);if(Wr){var Cn=this.collisionIndex.placeCollisionBox(Ht(Wr,Jr.x,Jr.y,Re,je,this.transform.angle),ur,ut,Ct,Qt.predicate);if(Cn.box.length===0)return}if(hn.box.length>0){var Fn;return this.prevPlacement&&this.prevPlacement.variableOffsets[vr.crossTileID]&&this.prevPlacement.placements[vr.crossTileID]&&this.prevPlacement.placements[vr.crossTileID].text&&(Fn=this.prevPlacement.variableOffsets[vr.crossTileID].anchor),this.variableOffsets[vr.crossTileID]={textOffset:Ur,width:Z,height:pe,anchor:V,textBoxScale:Me,prevAnchor:Fn},this.markUsedJustification(Cr,V,vr,Vr),Cr.allowVerticalPlacement&&(this.markUsedOrientation(Cr,Vr,vr),this.placedOrientations[vr.crossTileID]=Vr),{shift:Jr,placedGlyphBoxes:hn}}},hr.prototype.placeLayerBucketPart=function(V,ve,Z){var pe=this,Me=V.parameters,Re=Me.bucket,je=Me.layout,ut=Me.posMatrix,Ct=Me.textLabelPlaneMatrix,Qt=Me.labelToScreenMatrix,ur=Me.textPixelRatio,vr=Me.holdingForFade,Cr=Me.collisionBoxArray,Vr=Me.partiallyEvaluatedTextSize,Wr=Me.collisionGroup,Ur=je.get("text-optional"),Jr=je.get("icon-optional"),hn=je.get("text-allow-overlap"),Cn=je.get("icon-allow-overlap"),Fn=je.get("text-rotation-alignment")==="map",Kn=je.get("text-pitch-alignment")==="map",qn=je.get("icon-text-fit")!=="none",Qn=je.get("symbol-z-order")==="viewport-y",ca=hn&&(Cn||!Re.hasIconData()||Jr),ba=Cn&&(hn||!Re.hasTextData()||Ur);!Re.collisionArrays&&Cr&&Re.deserializeCollisionBoxes(Cr);var ya=function(ui,pi){if(!ve[ui.crossTileID]){if(vr){pe.placements[ui.crossTileID]=new ea(!1,!1,!1);return}var Ba=!1,Pi=!1,zi=!0,Ni=null,_i={box:null,offscreen:null},ji={box:null,offscreen:null},ii=null,wi=null,wo=null,Bo=0,Sl=0,kl=0;pi.textFeatureIndex?Bo=pi.textFeatureIndex:ui.useRuntimeCollisionCircles&&(Bo=ui.featureIndex),pi.verticalTextFeatureIndex&&(Sl=pi.verticalTextFeatureIndex);var $l=pi.textBox;if($l){var ql=function(Co){var $s=e.WritingMode.horizontal;if(Re.allowVerticalPlacement&&!Co&&pe.prevPlacement){var qs=pe.prevPlacement.placedOrientations[ui.crossTileID];qs&&(pe.placedOrientations[ui.crossTileID]=qs,$s=qs,pe.markUsedOrientation(Re,$s,ui))}return $s},_u=function(Co,$s){if(Re.allowVerticalPlacement&&ui.numVerticalGlyphVertices>0&&pi.verticalTextBox)for(var qs=0,Rf=Re.writingModes;qs<Rf.length;qs+=1){var ac=Rf[qs];if(ac===e.WritingMode.vertical?(_i=$s(),ji=_i):_i=Co(),_i&&_i.box&&_i.box.length)break}else _i=Co()};if(je.get("text-variable-anchor")){var bs=je.get("text-variable-anchor");if(pe.prevPlacement&&pe.prevPlacement.variableOffsets[ui.crossTileID]){var cl=pe.prevPlacement.variableOffsets[ui.crossTileID];bs.indexOf(cl.anchor)>0&&(bs=bs.filter(function(Co){return Co!==cl.anchor}),bs.unshift(cl.anchor))}var tu=function(Co,$s,qs){for(var Rf=Co.x2-Co.x1,ac=Co.y2-Co.y1,Jc=ui.textBoxScale,Qc=qn&&!Cn?$s:null,bf={box:[],offscreen:!1},$c=hn?bs.length*2:bs.length,If=0;If<$c;++If){var qc=bs[If%bs.length],eh=If>=bs.length,ic=pe.attemptAnchorPlacement(qc,Co,Rf,ac,Jc,Fn,Kn,ur,ut,Wr,eh,ui,Re,qs,Qc);if(ic&&(bf=ic.placedGlyphBoxes,bf&&bf.box&&bf.box.length)){Ba=!0,Ni=ic.shift;break}}return bf},Vl=function(){return tu($l,pi.iconBox,e.WritingMode.horizontal)},ru=function(){var Co=pi.verticalTextBox,$s=_i&&_i.box&&_i.box.length;return Re.allowVerticalPlacement&&!$s&&ui.numVerticalGlyphVertices>0&&Co?tu(Co,pi.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}};_u(Vl,ru),_i&&(Ba=_i.box,zi=_i.offscreen);var Cf=ql(_i&&_i.box);if(!Ba&&pe.prevPlacement){var Zu=pe.prevPlacement.variableOffsets[ui.crossTileID];Zu&&(pe.variableOffsets[ui.crossTileID]=Zu,pe.markUsedJustification(Re,Zu.anchor,ui,Cf))}}else{var eu=function(Co,$s){var qs=pe.collisionIndex.placeCollisionBox(Co,hn,ur,ut,Wr.predicate);return qs&&qs.box&&qs.box.length&&(pe.markUsedOrientation(Re,$s,ui),pe.placedOrientations[ui.crossTileID]=$s),qs},Bs=function(){return eu($l,e.WritingMode.horizontal)},Vu=function(){var Co=pi.verticalTextBox;return Re.allowVerticalPlacement&&ui.numVerticalGlyphVertices>0&&Co?eu(Co,e.WritingMode.vertical):{box:null,offscreen:null}};_u(Bs,Vu),ql(_i&&_i.box&&_i.box.length)}}if(ii=_i,Ba=ii&&ii.box&&ii.box.length>0,zi=ii&&ii.offscreen,ui.useRuntimeCollisionCircles){var cs=Re.text.placedSymbolArray.get(ui.centerJustifiedTextSymbolIndex),mf=e.evaluateSizeForFeature(Re.textSizeData,Vr,cs),Es=je.get("text-padding"),xf=ui.collisionCircleDiameter;wi=pe.collisionIndex.placeCollisionCircles(hn,cs,Re.lineVertexArray,Re.glyphOffsetArray,mf,ut,Ct,Qt,Z,Kn,Wr.predicate,xf,Es),Ba=hn||wi.circles.length>0&&!wi.collisionDetected,zi=zi&&wi.offscreen}if(pi.iconFeatureIndex&&(kl=pi.iconFeatureIndex),pi.iconBox){var Lf=function(Co){var $s=qn&&Ni?Ht(Co,Ni.x,Ni.y,Fn,Kn,pe.transform.angle):Co;return pe.collisionIndex.placeCollisionBox($s,Cn,ur,ut,Wr.predicate)};ji&&ji.box&&ji.box.length&&pi.verticalIconBox?(wo=Lf(pi.verticalIconBox),Pi=wo.box.length>0):(wo=Lf(pi.iconBox),Pi=wo.box.length>0),zi=zi&&wo.offscreen}var Pf=Ur||ui.numHorizontalGlyphVertices===0&&ui.numVerticalGlyphVertices===0,Sc=Jr||ui.numIconVertices===0;if(!Pf&&!Sc?Pi=Ba=Pi&&Ba:Sc?Pf||(Pi=Pi&&Ba):Ba=Pi&&Ba,Ba&&ii&&ii.box&&(ji&&ji.box&&Sl?pe.collisionIndex.insertCollisionBox(ii.box,je.get("text-ignore-placement"),Re.bucketInstanceId,Sl,Wr.ID):pe.collisionIndex.insertCollisionBox(ii.box,je.get("text-ignore-placement"),Re.bucketInstanceId,Bo,Wr.ID)),Pi&&wo&&pe.collisionIndex.insertCollisionBox(wo.box,je.get("icon-ignore-placement"),Re.bucketInstanceId,kl,Wr.ID),wi&&(Ba&&pe.collisionIndex.insertCollisionCircles(wi.circles,je.get("text-ignore-placement"),Re.bucketInstanceId,Bo,Wr.ID),Z)){var Df=Re.bucketInstanceId,af=pe.collisionCircleArrays[Df];af===void 0&&(af=pe.collisionCircleArrays[Df]=new Rn);for(var of=0;of<wi.circles.length;of+=4)af.circles.push(wi.circles[of+0]),af.circles.push(wi.circles[of+1]),af.circles.push(wi.circles[of+2]),af.circles.push(wi.collisionDetected?1:0)}pe.placements[ui.crossTileID]=new ea(Ba||ca,Pi||ba,zi||Re.justReloaded),ve[ui.crossTileID]=!0}};if(Qn)for(var Ta=Re.getSortedSymbolIndexes(this.transform.angle),Ca=Ta.length-1;Ca>=0;--Ca){var Ha=Ta[Ca];ya(Re.symbolInstances.get(Ha),Re.collisionArrays[Ha])}else for(var ni=V.symbolInstanceStart;ni<V.symbolInstanceEnd;ni++)ya(Re.symbolInstances.get(ni),Re.collisionArrays[ni]);if(Z&&Re.bucketInstanceId in this.collisionCircleArrays){var Li=this.collisionCircleArrays[Re.bucketInstanceId];e.invert(Li.invProjMatrix,ut),Li.viewportMatrix=this.collisionIndex.getViewportMatrix()}Re.justReloaded=!1},hr.prototype.markUsedJustification=function(V,ve,Z,pe){var Me={left:Z.leftJustifiedTextSymbolIndex,center:Z.centerJustifiedTextSymbolIndex,right:Z.rightJustifiedTextSymbolIndex},Re;pe===e.WritingMode.vertical?Re=Z.verticalPlacedTextSymbolIndex:Re=Me[e.getAnchorJustification(ve)];for(var je=[Z.leftJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.rightJustifiedTextSymbolIndex,Z.verticalPlacedTextSymbolIndex],ut=0,Ct=je;ut<Ct.length;ut+=1){var Qt=Ct[ut];Qt>=0&&(Re>=0&&Qt!==Re?V.text.placedSymbolArray.get(Qt).crossTileID=0:V.text.placedSymbolArray.get(Qt).crossTileID=Z.crossTileID)}},hr.prototype.markUsedOrientation=function(V,ve,Z){for(var pe=ve===e.WritingMode.horizontal||ve===e.WritingMode.horizontalOnly?ve:0,Me=ve===e.WritingMode.vertical?ve:0,Re=[Z.leftJustifiedTextSymbolIndex,Z.centerJustifiedTextSymbolIndex,Z.rightJustifiedTextSymbolIndex],je=0,ut=Re;je<ut.length;je+=1){var Ct=ut[je];V.text.placedSymbolArray.get(Ct).placedOrientation=pe}Z.verticalPlacedTextSymbolIndex&&(V.text.placedSymbolArray.get(Z.verticalPlacedTextSymbolIndex).placedOrientation=Me)},hr.prototype.commit=function(V){this.commitTime=V,this.zoomAtLastRecencyCheck=this.transform.zoom;var ve=this.prevPlacement,Z=!1;this.prevZoomAdjustment=ve?ve.zoomAdjustment(this.transform.zoom):0;var pe=ve?ve.symbolFadeChange(V):1,Me=ve?ve.opacities:{},Re=ve?ve.variableOffsets:{},je=ve?ve.placedOrientations:{};for(var ut in this.placements){var Ct=this.placements[ut],Qt=Me[ut];Qt?(this.opacities[ut]=new ua(Qt,pe,Ct.text,Ct.icon),Z=Z||Ct.text!==Qt.text.placed||Ct.icon!==Qt.icon.placed):(this.opacities[ut]=new ua(null,pe,Ct.text,Ct.icon,Ct.skipFade),Z=Z||Ct.text||Ct.icon)}for(var ur in Me){var vr=Me[ur];if(!this.opacities[ur]){var Cr=new ua(vr,pe,!1,!1);Cr.isHidden()||(this.opacities[ur]=Cr,Z=Z||vr.text.placed||vr.icon.placed)}}for(var Vr in Re)!this.variableOffsets[Vr]&&this.opacities[Vr]&&!this.opacities[Vr].isHidden()&&(this.variableOffsets[Vr]=Re[Vr]);for(var Wr in je)!this.placedOrientations[Wr]&&this.opacities[Wr]&&!this.opacities[Wr].isHidden()&&(this.placedOrientations[Wr]=je[Wr]);Z?this.lastPlacementChangeTime=V:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=ve?ve.lastPlacementChangeTime:V)},hr.prototype.updateLayerOpacities=function(V,ve){for(var Z={},pe=0,Me=ve;pe<Me.length;pe+=1){var Re=Me[pe],je=Re.getBucket(V);je&&Re.latestFeatureIndex&&V.id===je.layerIds[0]&&this.updateBucketOpacities(je,Z,Re.collisionBoxArray)}},hr.prototype.updateBucketOpacities=function(V,ve,Z){var pe=this;V.hasTextData()&&V.text.opacityVertexArray.clear(),V.hasIconData()&&V.icon.opacityVertexArray.clear(),V.hasIconCollisionBoxData()&&V.iconCollisionBox.collisionVertexArray.clear(),V.hasTextCollisionBoxData()&&V.textCollisionBox.collisionVertexArray.clear();var Me=V.layers[0].layout,Re=new ua(null,0,!1,!1,!0),je=Me.get("text-allow-overlap"),ut=Me.get("icon-allow-overlap"),Ct=Me.get("text-variable-anchor"),Qt=Me.get("text-rotation-alignment")==="map",ur=Me.get("text-pitch-alignment")==="map",vr=Me.get("icon-text-fit")!=="none",Cr=new ua(null,0,je&&(ut||!V.hasIconData()||Me.get("icon-optional")),ut&&(je||!V.hasTextData()||Me.get("text-optional")),!0);!V.collisionArrays&&Z&&(V.hasIconCollisionBoxData()||V.hasTextCollisionBoxData())&&V.deserializeCollisionBoxes(Z);for(var Vr=function(hn,Cn,Fn){for(var Kn=0;Kn<Cn/4;Kn++)hn.opacityVertexArray.emplaceBack(Fn)},Wr=function(hn){var Cn=V.symbolInstances.get(hn),Fn=Cn.numHorizontalGlyphVertices,Kn=Cn.numVerticalGlyphVertices,qn=Cn.crossTileID,Qn=ve[qn],ca=pe.opacities[qn];Qn?ca=Re:ca||(ca=Cr,pe.opacities[qn]=ca),ve[qn]=!0;var ba=Fn>0||Kn>0,ya=Cn.numIconVertices>0,Ta=pe.placedOrientations[Cn.crossTileID],Ca=Ta===e.WritingMode.vertical,Ha=Ta===e.WritingMode.horizontal||Ta===e.WritingMode.horizontalOnly;if(ba){var ni=zr(ca.text),Li=Ca?gn:ni;Vr(V.text,Fn,Li);var ui=Ha?gn:ni;Vr(V.text,Kn,ui);var pi=ca.text.isHidden();[Cn.rightJustifiedTextSymbolIndex,Cn.centerJustifiedTextSymbolIndex,Cn.leftJustifiedTextSymbolIndex].forEach(function(kl){kl>=0&&(V.text.placedSymbolArray.get(kl).hidden=pi||Ca?1:0)}),Cn.verticalPlacedTextSymbolIndex>=0&&(V.text.placedSymbolArray.get(Cn.verticalPlacedTextSymbolIndex).hidden=pi||Ha?1:0);var Ba=pe.variableOffsets[Cn.crossTileID];Ba&&pe.markUsedJustification(V,Ba.anchor,Cn,Ta);var Pi=pe.placedOrientations[Cn.crossTileID];Pi&&(pe.markUsedJustification(V,"left",Cn,Pi),pe.markUsedOrientation(V,Pi,Cn))}if(ya){var zi=zr(ca.icon),Ni=!(vr&&Cn.verticalPlacedIconSymbolIndex&&Ca);if(Cn.placedIconSymbolIndex>=0){var _i=Ni?zi:gn;Vr(V.icon,Cn.numIconVertices,_i),V.icon.placedSymbolArray.get(Cn.placedIconSymbolIndex).hidden=ca.icon.isHidden()}if(Cn.verticalPlacedIconSymbolIndex>=0){var ji=Ni?gn:zi;Vr(V.icon,Cn.numVerticalIconVertices,ji),V.icon.placedSymbolArray.get(Cn.verticalPlacedIconSymbolIndex).hidden=ca.icon.isHidden()}}if(V.hasIconCollisionBoxData()||V.hasTextCollisionBoxData()){var ii=V.collisionArrays[hn];if(ii){var wi=new e.Point(0,0);if(ii.textBox||ii.verticalTextBox){var wo=!0;if(Ct){var Bo=pe.variableOffsets[qn];Bo?(wi=li(Bo.anchor,Bo.width,Bo.height,Bo.textOffset,Bo.textBoxScale),Qt&&wi._rotate(ur?pe.transform.angle:-pe.transform.angle)):wo=!1}ii.textBox&&rn(V.textCollisionBox.collisionVertexArray,ca.text.placed,!wo||Ca,wi.x,wi.y),ii.verticalTextBox&&rn(V.textCollisionBox.collisionVertexArray,ca.text.placed,!wo||Ha,wi.x,wi.y)}var Sl=!!(!Ha&&ii.verticalIconBox);ii.iconBox&&rn(V.iconCollisionBox.collisionVertexArray,ca.icon.placed,Sl,vr?wi.x:0,vr?wi.y:0),ii.verticalIconBox&&rn(V.iconCollisionBox.collisionVertexArray,ca.icon.placed,!Sl,vr?wi.x:0,vr?wi.y:0)}}},Ur=0;Ur<V.symbolInstances.length;Ur++)Wr(Ur);if(V.sortFeatures(this.transform.angle),this.retainedQueryData[V.bucketInstanceId]&&(this.retainedQueryData[V.bucketInstanceId].featureSortOrder=V.featureSortOrder),V.hasTextData()&&V.text.opacityVertexBuffer&&V.text.opacityVertexBuffer.updateData(V.text.opacityVertexArray),V.hasIconData()&&V.icon.opacityVertexBuffer&&V.icon.opacityVertexBuffer.updateData(V.icon.opacityVertexArray),V.hasIconCollisionBoxData()&&V.iconCollisionBox.collisionVertexBuffer&&V.iconCollisionBox.collisionVertexBuffer.updateData(V.iconCollisionBox.collisionVertexArray),V.hasTextCollisionBoxData()&&V.textCollisionBox.collisionVertexBuffer&&V.textCollisionBox.collisionVertexBuffer.updateData(V.textCollisionBox.collisionVertexArray),V.bucketInstanceId in this.collisionCircleArrays){var Jr=this.collisionCircleArrays[V.bucketInstanceId];V.placementInvProjMatrix=Jr.invProjMatrix,V.placementViewportMatrix=Jr.viewportMatrix,V.collisionCircleArray=Jr.circles,delete this.collisionCircleArrays[V.bucketInstanceId]}},hr.prototype.symbolFadeChange=function(V){return this.fadeDuration===0?1:(V-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},hr.prototype.zoomAdjustment=function(V){return Math.max(0,(this.transform.zoom-V)/1.5)},hr.prototype.hasTransitions=function(V){return this.stale||V-this.lastPlacementChangeTime<this.fadeDuration},hr.prototype.stillRecent=function(V,ve){var Z=this.zoomAtLastRecencyCheck===ve?1-this.zoomAdjustment(ve):1;return this.zoomAtLastRecencyCheck=ve,this.commitTime+this.fadeDuration*Z>V},hr.prototype.setStale=function(){this.stale=!0};function rn(fe,V,ve,Z,pe){fe.emplaceBack(V?1:0,ve?1:0,Z||0,pe||0),fe.emplaceBack(V?1:0,ve?1:0,Z||0,pe||0),fe.emplaceBack(V?1:0,ve?1:0,Z||0,pe||0),fe.emplaceBack(V?1:0,ve?1:0,Z||0,pe||0)}var vn=Math.pow(2,25),en=Math.pow(2,24),Tn=Math.pow(2,17),xn=Math.pow(2,16),un=Math.pow(2,9),yr=Math.pow(2,8),mr=Math.pow(2,1);function zr(fe){if(fe.opacity===0&&!fe.placed)return 0;if(fe.opacity===1&&fe.placed)return 4294967295;var V=fe.placed?1:0,ve=Math.floor(fe.opacity*127);return ve*vn+V*en+ve*Tn+V*xn+ve*un+V*yr+ve*mr+V}var gn=0,On=function(V){this._sortAcrossTiles=V.layout.get("symbol-z-order")!=="viewport-y"&&V.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};On.prototype.continuePlacement=function(V,ve,Z,pe,Me){for(var Re=this._bucketParts;this._currentTileIndex<V.length;){var je=V[this._currentTileIndex];if(ve.getBucketParts(Re,pe,je,this._sortAcrossTiles),this._currentTileIndex++,Me())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Re.sort(function(Ct,Qt){return Ct.sortKey-Qt.sortKey}));this._currentPartIndex<Re.length;){var ut=Re[this._currentPartIndex];if(ve.placeLayerBucketPart(ut,this._seenCrossTileIDs,Z),this._currentPartIndex++,Me())return!0}return!1};var ta=function(V,ve,Z,pe,Me,Re,je){this.placement=new hr(V,Me,Re,je),this._currentPlacementIndex=ve.length-1,this._forceFullPlacement=Z,this._showCollisionBoxes=pe,this._done=!1};ta.prototype.isDone=function(){return this._done},ta.prototype.continuePlacement=function(V,ve,Z){for(var pe=this,Me=e.browser.now(),Re=function(){var ur=e.browser.now()-Me;return pe._forceFullPlacement?!1:ur>2};this._currentPlacementIndex>=0;){var je=V[this._currentPlacementIndex],ut=ve[je],Ct=this.placement.collisionIndex.transform.zoom;if(ut.type==="symbol"&&(!ut.minzoom||ut.minzoom<=Ct)&&(!ut.maxzoom||ut.maxzoom>Ct)){this._inProgressLayer||(this._inProgressLayer=new On(ut));var Qt=this._inProgressLayer.continuePlacement(Z[ut.source],this.placement,this._showCollisionBoxes,ut,Re);if(Qt)return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ta.prototype.commit=function(V){return this.placement.commit(V),this.placement};var _n=512/e.EXTENT/2,jn=function(V,ve,Z){this.tileID=V,this.indexedSymbolInstances={},this.bucketInstanceId=Z;for(var pe=0;pe<ve.length;pe++){var Me=ve.get(pe),Re=Me.key;this.indexedSymbolInstances[Re]||(this.indexedSymbolInstances[Re]=[]),this.indexedSymbolInstances[Re].push({crossTileID:Me.crossTileID,coord:this.getScaledCoordinates(Me,V)})}};jn.prototype.getScaledCoordinates=function(V,ve){var Z=ve.canonical.z-this.tileID.canonical.z,pe=_n/Math.pow(2,Z);return{x:Math.floor((ve.canonical.x*e.EXTENT+V.anchorX)*pe),y:Math.floor((ve.canonical.y*e.EXTENT+V.anchorY)*pe)}},jn.prototype.findMatches=function(V,ve,Z){for(var pe=this.tileID.canonical.z<ve.canonical.z?1:Math.pow(2,this.tileID.canonical.z-ve.canonical.z),Me=0;Me<V.length;Me++){var Re=V.get(Me);if(!Re.crossTileID){var je=this.indexedSymbolInstances[Re.key];if(je)for(var ut=this.getScaledCoordinates(Re,ve),Ct=0,Qt=je;Ct<Qt.length;Ct+=1){var ur=Qt[Ct];if(Math.abs(ur.coord.x-ut.x)<=pe&&Math.abs(ur.coord.y-ut.y)<=pe&&!Z[ur.crossTileID]){Z[ur.crossTileID]=!0,Re.crossTileID=ur.crossTileID;break}}}}};var aa=function(){this.maxCrossTileID=0};aa.prototype.generate=function(){return++this.maxCrossTileID};var da=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};da.prototype.handleWrapJump=function(V){var ve=Math.round((V-this.lng)/360);if(ve!==0)for(var Z in this.indexes){var pe=this.indexes[Z],Me={};for(var Re in pe){var je=pe[Re];je.tileID=je.tileID.unwrapTo(je.tileID.wrap+ve),Me[je.tileID.key]=je}this.indexes[Z]=Me}this.lng=V},da.prototype.addBucket=function(V,ve,Z){if(this.indexes[V.overscaledZ]&&this.indexes[V.overscaledZ][V.key]){if(this.indexes[V.overscaledZ][V.key].bucketInstanceId===ve.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(V.overscaledZ,this.indexes[V.overscaledZ][V.key])}for(var pe=0;pe<ve.symbolInstances.length;pe++){var Me=ve.symbolInstances.get(pe);Me.crossTileID=0}this.usedCrossTileIDs[V.overscaledZ]||(this.usedCrossTileIDs[V.overscaledZ]={});var Re=this.usedCrossTileIDs[V.overscaledZ];for(var je in this.indexes){var ut=this.indexes[je];if(Number(je)>V.overscaledZ)for(var Ct in ut){var Qt=ut[Ct];Qt.tileID.isChildOf(V)&&Qt.findMatches(ve.symbolInstances,V,Re)}else{var ur=V.scaledTo(Number(je)),vr=ut[ur.key];vr&&vr.findMatches(ve.symbolInstances,V,Re)}}for(var Cr=0;Cr<ve.symbolInstances.length;Cr++){var Vr=ve.symbolInstances.get(Cr);Vr.crossTileID||(Vr.crossTileID=Z.generate(),Re[Vr.crossTileID]=!0)}return this.indexes[V.overscaledZ]===void 0&&(this.indexes[V.overscaledZ]={}),this.indexes[V.overscaledZ][V.key]=new jn(V,ve.symbolInstances,ve.bucketInstanceId),!0},da.prototype.removeBucketCrossTileIDs=function(V,ve){for(var Z in ve.indexedSymbolInstances)for(var pe=0,Me=ve.indexedSymbolInstances[Z];pe<Me.length;pe+=1){var Re=Me[pe];delete this.usedCrossTileIDs[V][Re.crossTileID]}},da.prototype.removeStaleBuckets=function(V){var ve=!1;for(var Z in this.indexes){var pe=this.indexes[Z];for(var Me in pe)V[pe[Me].bucketInstanceId]||(this.removeBucketCrossTileIDs(Z,pe[Me]),delete pe[Me],ve=!0)}return ve};var ma=function(){this.layerIndexes={},this.crossTileIDs=new aa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ma.prototype.addLayer=function(V,ve,Z){var pe=this.layerIndexes[V.id];pe===void 0&&(pe=this.layerIndexes[V.id]=new da);var Me=!1,Re={};pe.handleWrapJump(Z);for(var je=0,ut=ve;je<ut.length;je+=1){var Ct=ut[je],Qt=Ct.getBucket(V);!Qt||V.id!==Qt.layerIds[0]||(Qt.bucketInstanceId||(Qt.bucketInstanceId=++this.maxBucketInstanceId),pe.addBucket(Ct.tileID,Qt,this.crossTileIDs)&&(Me=!0),Re[Qt.bucketInstanceId]=!0)}return pe.removeStaleBuckets(Re)&&(Me=!0),Me},ma.prototype.pruneUnusedLayers=function(V){var ve={};V.forEach(function(pe){ve[pe]=!0});for(var Z in this.layerIndexes)ve[Z]||delete this.layerIndexes[Z]};var sa=function(fe,V){return e.emitValidationErrors(fe,V&&V.filter(function(ve){return ve.identifier!=="source.canvas"}))},Aa=e.pick(nr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),vo=e.pick(nr,["setCenter","setZoom","setBearing","setPitch"]),Io=Yr(),jo=function(fe){function V(ve,Z){var pe=this;Z===void 0&&(Z={}),fe.call(this),this.map=ve,this.dispatcher=new R(Yt(),this),this.imageManager=new m,this.imageManager.setEventedParent(this),this.glyphManager=new T(ve._requestManager,Z.localIdeographFontFamily),this.lineAtlas=new D(256,512),this.crossTileSymbolIndex=new ma,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var Me=this;this._rtlTextPluginCallback=V.registerForPluginStateChange(function(Re){var je={pluginStatus:Re.pluginStatus,pluginURL:Re.pluginURL};Me.dispatcher.broadcast("syncRTLPluginState",je,function(ut,Ct){if(e.triggerPluginCompletionEvent(ut),Ct){var Qt=Ct.every(function(vr){return vr});if(Qt)for(var ur in Me.sourceCaches)Me.sourceCaches[ur].reload()}})}),this.on("data",function(Re){if(!(Re.dataType!=="source"||Re.sourceDataType!=="metadata")){var je=pe.sourceCaches[Re.sourceId];if(je){var ut=je.getSource();if(!(!ut||!ut.vectorLayerIds))for(var Ct in pe._layers){var Qt=pe._layers[Ct];Qt.source===ut.id&&pe._validateLayer(Qt)}}}})}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.loadURL=function(Z,pe){var Me=this;pe===void 0&&(pe={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var Re=typeof pe.validate=="boolean"?pe.validate:!e.isMapboxURL(Z);Z=this.map._requestManager.normalizeStyleURL(Z,pe.accessToken);var je=this.map._requestManager.transformRequest(Z,e.ResourceType.Style);this._request=e.getJSON(je,function(ut,Ct){Me._request=null,ut?Me.fire(new e.ErrorEvent(ut)):Ct&&Me._load(Ct,Re)})},V.prototype.loadJSON=function(Z,pe){var Me=this;pe===void 0&&(pe={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){Me._request=null,Me._load(Z,pe.validate!==!1)})},V.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Io,!1)},V.prototype._load=function(Z,pe){if(!(pe&&sa(this,e.validateStyle(Z)))){this._loaded=!0,this.stylesheet=Z;for(var Me in Z.sources)this.addSource(Me,Z.sources[Me],{validate:!1});Z.sprite?this._loadSprite(Z.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(Z.glyphs);var Re=Mr(this.stylesheet.layers);this._order=Re.map(function(Qt){return Qt.id}),this._layers={},this._serializedLayers={};for(var je=0,ut=Re;je<ut.length;je+=1){var Ct=ut[je];Ct=e.createStyleLayer(Ct),Ct.setEventedParent(this,{layer:{id:Ct.id}}),this._layers[Ct.id]=Ct,this._serializedLayers[Ct.id]=Ct.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},V.prototype._loadSprite=function(Z){var pe=this;this._spriteRequest=f(Z,this.map._requestManager,function(Me,Re){if(pe._spriteRequest=null,Me)pe.fire(new e.ErrorEvent(Me));else if(Re)for(var je in Re)pe.imageManager.addImage(je,Re[je]);pe.imageManager.setLoaded(!0),pe._availableImages=pe.imageManager.listImages(),pe.dispatcher.broadcast("setImages",pe._availableImages),pe.fire(new e.Event("data",{dataType:"style"}))})},V.prototype._validateLayer=function(Z){var pe=this.sourceCaches[Z.source];if(pe){var Me=Z.sourceLayer;if(Me){var Re=pe.getSource();(Re.type==="geojson"||Re.vectorLayerIds&&Re.vectorLayerIds.indexOf(Me)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+Me+'" does not exist on source "'+Re.id+'" as specified by style layer "'+Z.id+'"')))}}},V.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var Z in this.sourceCaches)if(!this.sourceCaches[Z].loaded())return!1;return!!this.imageManager.isLoaded()},V.prototype._serializeLayers=function(Z){for(var pe=[],Me=0,Re=Z;Me<Re.length;Me+=1){var je=Re[Me],ut=this._layers[je];ut.type!=="custom"&&pe.push(ut.serialize())}return pe},V.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var Z in this.sourceCaches)if(this.sourceCaches[Z].hasTransition())return!0;for(var pe in this._layers)if(this._layers[pe].hasTransition())return!0;return!1},V.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},V.prototype.update=function(Z){if(this._loaded){var pe=this._changed;if(this._changed){var Me=Object.keys(this._updatedLayers),Re=Object.keys(this._removedLayers);(Me.length||Re.length)&&this._updateWorkerLayers(Me,Re);for(var je in this._updatedSources){var ut=this._updatedSources[je];ut==="reload"?this._reloadSource(je):ut==="clear"&&this._clearSource(je)}this._updateTilesForChangedImages();for(var Ct in this._updatedPaintProps)this._layers[Ct].updateTransitions(Z);this.light.updateTransitions(Z),this._resetUpdates()}for(var Qt in this.sourceCaches)this.sourceCaches[Qt].used=!1;for(var ur=0,vr=this._order;ur<vr.length;ur+=1){var Cr=vr[ur],Vr=this._layers[Cr];Vr.recalculate(Z,this._availableImages),!Vr.isHidden(Z.zoom)&&Vr.source&&(this.sourceCaches[Vr.source].used=!0)}this.light.recalculate(Z),this.z=Z.zoom,pe&&this.fire(new e.Event("data",{dataType:"style"}))}},V.prototype._updateTilesForChangedImages=function(){var Z=Object.keys(this._changedImages);if(Z.length){for(var pe in this.sourceCaches)this.sourceCaches[pe].reloadTilesForDependencies(["icons","patterns"],Z);this._changedImages={}}},V.prototype._updateWorkerLayers=function(Z,pe){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(Z),removedIds:pe})},V.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},V.prototype.setState=function(Z){var pe=this;if(this._checkLoaded(),sa(this,e.validateStyle(Z)))return!1;Z=e.clone$1(Z),Z.layers=Mr(Z.layers);var Me=Or(this.serialize(),Z).filter(function(je){return!(je.command in vo)});if(Me.length===0)return!1;var Re=Me.filter(function(je){return!(je.command in Aa)});if(Re.length>0)throw new Error("Unimplemented: "+Re.map(function(je){return je.command}).join(", ")+".");return Me.forEach(function(je){je.command!=="setTransition"&&pe[je.command].apply(pe,je.args)}),this.stylesheet=Z,!0},V.prototype.addImage=function(Z,pe){if(this.getImage(Z))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(Z,pe),this._availableImages=this.imageManager.listImages(),this._changedImages[Z]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},V.prototype.updateImage=function(Z,pe){this.imageManager.updateImage(Z,pe)},V.prototype.getImage=function(Z){return this.imageManager.getImage(Z)},V.prototype.removeImage=function(Z){if(!this.getImage(Z))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(Z),this._availableImages=this.imageManager.listImages(),this._changedImages[Z]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},V.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},V.prototype.addSource=function(Z,pe,Me){var Re=this;if(Me===void 0&&(Me={}),this._checkLoaded(),this.sourceCaches[Z]!==void 0)throw new Error("There is already a source with this ID");if(!pe.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(pe).join(", ")+".");var je=["vector","raster","geojson","video","image"],ut=je.indexOf(pe.type)>=0;if(!(ut&&this._validate(e.validateStyle.source,"sources."+Z,pe,null,Me))){this.map&&this.map._collectResourceTiming&&(pe.collectResourceTiming=!0);var Ct=this.sourceCaches[Z]=new Ce(Z,pe,this.dispatcher);Ct.style=this,Ct.setEventedParent(this,function(){return{isSourceLoaded:Re.loaded(),source:Ct.serialize(),sourceId:Z}}),Ct.onAdd(this.map),this._changed=!0}},V.prototype.removeSource=function(Z){if(this._checkLoaded(),this.sourceCaches[Z]===void 0)throw new Error("There is no source with this ID");for(var pe in this._layers)if(this._layers[pe].source===Z)return this.fire(new e.ErrorEvent(new Error('Source "'+Z+'" cannot be removed while layer "'+pe+'" is using it.')));var Me=this.sourceCaches[Z];delete this.sourceCaches[Z],delete this._updatedSources[Z],Me.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:Z})),Me.setEventedParent(null),Me.clearTiles(),Me.onRemove&&Me.onRemove(this.map),this._changed=!0},V.prototype.setGeoJSONSourceData=function(Z,pe){this._checkLoaded();var Me=this.sourceCaches[Z].getSource();Me.setData(pe),this._changed=!0},V.prototype.getSource=function(Z){return this.sourceCaches[Z]&&this.sourceCaches[Z].getSource()},V.prototype.addLayer=function(Z,pe,Me){Me===void 0&&(Me={}),this._checkLoaded();var Re=Z.id;if(this.getLayer(Re)){this.fire(new e.ErrorEvent(new Error('Layer with id "'+Re+'" already exists on this map')));return}var je;if(Z.type==="custom"){if(sa(this,e.validateCustomStyleLayer(Z)))return;je=e.createStyleLayer(Z)}else{if(typeof Z.source=="object"&&(this.addSource(Re,Z.source),Z=e.clone$1(Z),Z=e.extend(Z,{source:Re})),this._validate(e.validateStyle.layer,"layers."+Re,Z,{arrayIndex:-1},Me))return;je=e.createStyleLayer(Z),this._validateLayer(je),je.setEventedParent(this,{layer:{id:Re}}),this._serializedLayers[je.id]=je.serialize()}var ut=pe?this._order.indexOf(pe):this._order.length;if(pe&&ut===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+pe+'" does not exist on this map.')));return}if(this._order.splice(ut,0,Re),this._layerOrderChanged=!0,this._layers[Re]=je,this._removedLayers[Re]&&je.source&&je.type!=="custom"){var Ct=this._removedLayers[Re];delete this._removedLayers[Re],Ct.type!==je.type?this._updatedSources[je.source]="clear":(this._updatedSources[je.source]="reload",this.sourceCaches[je.source].pause())}this._updateLayer(je),je.onAdd&&je.onAdd(this.map)},V.prototype.moveLayer=function(Z,pe){this._checkLoaded(),this._changed=!0;var Me=this._layers[Z];if(!Me){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be moved.")));return}if(Z!==pe){var Re=this._order.indexOf(Z);this._order.splice(Re,1);var je=pe?this._order.indexOf(pe):this._order.length;if(pe&&je===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+pe+'" does not exist on this map.')));return}this._order.splice(je,0,Z),this._layerOrderChanged=!0}},V.prototype.removeLayer=function(Z){this._checkLoaded();var pe=this._layers[Z];if(!pe){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be removed.")));return}pe.setEventedParent(null);var Me=this._order.indexOf(Z);this._order.splice(Me,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[Z]=pe,delete this._layers[Z],delete this._serializedLayers[Z],delete this._updatedLayers[Z],delete this._updatedPaintProps[Z],pe.onRemove&&pe.onRemove(this.map)},V.prototype.getLayer=function(Z){return this._layers[Z]},V.prototype.hasLayer=function(Z){return Z in this._layers},V.prototype.setLayerZoomRange=function(Z,pe,Me){this._checkLoaded();var Re=this.getLayer(Z);if(!Re){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot have zoom extent.")));return}Re.minzoom===pe&&Re.maxzoom===Me||(pe!=null&&(Re.minzoom=pe),Me!=null&&(Re.maxzoom=Me),this._updateLayer(Re))},V.prototype.setFilter=function(Z,pe,Me){Me===void 0&&(Me={}),this._checkLoaded();var Re=this.getLayer(Z);if(!Re){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be filtered.")));return}if(!e.deepEqual(Re.filter,pe)){if(pe==null){Re.filter=void 0,this._updateLayer(Re);return}this._validate(e.validateStyle.filter,"layers."+Re.id+".filter",pe,null,Me)||(Re.filter=e.clone$1(pe),this._updateLayer(Re))}},V.prototype.getFilter=function(Z){return e.clone$1(this.getLayer(Z).filter)},V.prototype.setLayoutProperty=function(Z,pe,Me,Re){Re===void 0&&(Re={}),this._checkLoaded();var je=this.getLayer(Z);if(!je){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be styled.")));return}e.deepEqual(je.getLayoutProperty(pe),Me)||(je.setLayoutProperty(pe,Me,Re),this._updateLayer(je))},V.prototype.getLayoutProperty=function(Z,pe){var Me=this.getLayer(Z);if(!Me){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style.")));return}return Me.getLayoutProperty(pe)},V.prototype.setPaintProperty=function(Z,pe,Me,Re){Re===void 0&&(Re={}),this._checkLoaded();var je=this.getLayer(Z);if(!je){this.fire(new e.ErrorEvent(new Error("The layer '"+Z+"' does not exist in the map's style and cannot be styled.")));return}if(!e.deepEqual(je.getPaintProperty(pe),Me)){var ut=je.setPaintProperty(pe,Me,Re);ut&&this._updateLayer(je),this._changed=!0,this._updatedPaintProps[Z]=!0}},V.prototype.getPaintProperty=function(Z,pe){return this.getLayer(Z).getPaintProperty(pe)},V.prototype.setFeatureState=function(Z,pe){this._checkLoaded();var Me=Z.source,Re=Z.sourceLayer,je=this.sourceCaches[Me];if(je===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Me+"' does not exist in the map's style.")));return}var ut=je.getSource().type;if(ut==="geojson"&&Re){this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(ut==="vector"&&!Re){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}Z.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),je.setFeatureState(Re,Z.id,pe)},V.prototype.removeFeatureState=function(Z,pe){this._checkLoaded();var Me=Z.source,Re=this.sourceCaches[Me];if(Re===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Me+"' does not exist in the map's style.")));return}var je=Re.getSource().type,ut=je==="vector"?Z.sourceLayer:void 0;if(je==="vector"&&!ut){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(pe&&typeof Z.id!="string"&&typeof Z.id!="number"){this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property.")));return}Re.removeFeatureState(ut,Z.id,pe)},V.prototype.getFeatureState=function(Z){this._checkLoaded();var pe=Z.source,Me=Z.sourceLayer,Re=this.sourceCaches[pe];if(Re===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+pe+"' does not exist in the map's style.")));return}var je=Re.getSource().type;if(je==="vector"&&!Me){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return Z.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Re.getFeatureState(Me,Z.id)},V.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},V.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(Z){return Z.serialize()}),layers:this._serializeLayers(this._order)},function(Z){return Z!==void 0})},V.prototype._updateLayer=function(Z){this._updatedLayers[Z.id]=!0,Z.source&&!this._updatedSources[Z.source]&&this.sourceCaches[Z.source].getSource().type!=="raster"&&(this._updatedSources[Z.source]="reload",this.sourceCaches[Z.source].pause()),this._changed=!0},V.prototype._flattenAndSortRenderedFeatures=function(Z){for(var pe=this,Me=function(Ha){return pe._layers[Ha].type==="fill-extrusion"},Re={},je=[],ut=this._order.length-1;ut>=0;ut--){var Ct=this._order[ut];if(Me(Ct)){Re[Ct]=ut;for(var Qt=0,ur=Z;Qt<ur.length;Qt+=1){var vr=ur[Qt],Cr=vr[Ct];if(Cr)for(var Vr=0,Wr=Cr;Vr<Wr.length;Vr+=1){var Ur=Wr[Vr];je.push(Ur)}}}}je.sort(function(Ha,ni){return ni.intersectionZ-Ha.intersectionZ});for(var Jr=[],hn=this._order.length-1;hn>=0;hn--){var Cn=this._order[hn];if(Me(Cn))for(var Fn=je.length-1;Fn>=0;Fn--){var Kn=je[Fn].feature;if(Re[Kn.layer.id]<hn)break;Jr.push(Kn),je.pop()}else for(var qn=0,Qn=Z;qn<Qn.length;qn+=1){var ca=Qn[qn],ba=ca[Cn];if(ba)for(var ya=0,Ta=ba;ya<Ta.length;ya+=1){var Ca=Ta[ya];Jr.push(Ca.feature)}}}return Jr},V.prototype.queryRenderedFeatures=function(Z,pe,Me){pe&&pe.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",pe.filter,null,pe);var Re={};if(pe&&pe.layers){if(!Array.isArray(pe.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var je=0,ut=pe.layers;je<ut.length;je+=1){var Ct=ut[je],Qt=this._layers[Ct];if(!Qt)return this.fire(new e.ErrorEvent(new Error("The layer '"+Ct+"' does not exist in the map's style and cannot be queried for features."))),[];Re[Qt.source]=!0}}var ur=[];pe.availableImages=this._availableImages;for(var vr in this.sourceCaches)pe.layers&&!Re[vr]||ur.push(ie(this.sourceCaches[vr],this._layers,this._serializedLayers,Z,pe,Me));return this.placement&&ur.push(se(this._layers,this._serializedLayers,this.sourceCaches,Z,pe,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(ur)},V.prototype.querySourceFeatures=function(Z,pe){pe&&pe.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",pe.filter,null,pe);var Me=this.sourceCaches[Z];return Me?ae(Me,pe):[]},V.prototype.addSourceType=function(Z,pe,Me){if(V.getSourceType(Z))return Me(new Error('A source type called "'+Z+'" already exists.'));if(V.setSourceType(Z,pe),!pe.workerSourceURL)return Me(null,null);this.dispatcher.broadcast("loadWorkerSource",{name:Z,url:pe.workerSourceURL},Me)},V.prototype.getLight=function(){return this.light.getLight()},V.prototype.setLight=function(Z,pe){pe===void 0&&(pe={}),this._checkLoaded();var Me=this.light.getLight(),Re=!1;for(var je in Z)if(!e.deepEqual(Z[je],Me[je])){Re=!0;break}if(Re){var ut={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(Z,pe),this.light.updateTransitions(ut)}},V.prototype._validate=function(Z,pe,Me,Re,je){return je===void 0&&(je={}),je&&je.validate===!1?!1:sa(this,Z.call(e.validateStyle,e.extend({key:pe,style:this.serialize(),value:Me,styleSpec:e.styleSpec},Re)))},V.prototype._remove=function(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(var Z in this._layers){var pe=this._layers[Z];pe.setEventedParent(null)}for(var Me in this.sourceCaches)this.sourceCaches[Me].clearTiles(),this.sourceCaches[Me].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},V.prototype._clearSource=function(Z){this.sourceCaches[Z].clearTiles()},V.prototype._reloadSource=function(Z){this.sourceCaches[Z].resume(),this.sourceCaches[Z].reload()},V.prototype._updateSources=function(Z){for(var pe in this.sourceCaches)this.sourceCaches[pe].update(Z)},V.prototype._generateCollisionBoxes=function(){for(var Z in this.sourceCaches)this._reloadSource(Z)},V.prototype._updatePlacement=function(Z,pe,Me,Re,je){je===void 0&&(je=!1);for(var ut=!1,Ct=!1,Qt={},ur=0,vr=this._order;ur<vr.length;ur+=1){var Cr=vr[ur],Vr=this._layers[Cr];if(Vr.type==="symbol"){if(!Qt[Vr.source]){var Wr=this.sourceCaches[Vr.source];Qt[Vr.source]=Wr.getRenderableIds(!0).map(function(qn){return Wr.getTileByID(qn)}).sort(function(qn,Qn){return Qn.tileID.overscaledZ-qn.tileID.overscaledZ||(qn.tileID.isLessThan(Qn.tileID)?-1:1)})}var Ur=this.crossTileSymbolIndex.addLayer(Vr,Qt[Vr.source],Z.center.lng);ut=ut||Ur}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),je=je||this._layerOrderChanged||Me===0,(je||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),Z.zoom))&&(this.pauseablePlacement=new ta(Z,this._order,je,pe,Me,Re,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Qt),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Ct=!0),ut&&this.pauseablePlacement.placement.setStale()),Ct||ut)for(var Jr=0,hn=this._order;Jr<hn.length;Jr+=1){var Cn=hn[Jr],Fn=this._layers[Cn];Fn.type==="symbol"&&this.placement.updateLayerOpacities(Fn,Qt[Fn.source])}var Kn=!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now());return Kn},V.prototype._releaseSymbolFadeTiles=function(){for(var Z in this.sourceCaches)this.sourceCaches[Z].releaseSymbolFadeTiles()},V.prototype.getImages=function(Z,pe,Me){this.imageManager.getImages(pe.icons,Me),this._updateTilesForChangedImages();var Re=this.sourceCaches[pe.source];Re&&Re.setDependencies(pe.tileID.key,pe.type,pe.icons)},V.prototype.getGlyphs=function(Z,pe,Me){this.glyphManager.getGlyphs(pe.stacks,Me)},V.prototype.getResource=function(Z,pe,Me){return e.makeRequest(pe,Me)},V}(e.Evented);jo.getSourceType=$,jo.setSourceType=ne,jo.registerForPluginStateChange=e.registerForPluginStateChange;var nl=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),pl=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,Yl=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`,vi=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Vs="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",Ds=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ui="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}",Mo=`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,dl=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`,vs="void main() {gl_FragColor=vec4(1.0);}",Di="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",al=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ki=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`,Fi=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,ao="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}",Ji="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}",ts="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}",Gs="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",au="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}",Ko="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",iu="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}",Rs=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,So=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`,Mu=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Is=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,_s=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ll=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,Su=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ku=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`,Ys=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pl=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`,ws=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Wl=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`,il=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Xl="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}",ou=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Dl="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}",Eu=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ws=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,Zl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Rl=`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,ps=`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,yl=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`,jl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,su=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`,lu=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Il="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}",Cu=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,uu=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`,Jo=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ol=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`,sl=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Kl=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`,ds=Ri(pl,Yl),ko=Ri(vi,Vs),zl=Ri(Ds,Ui),Ts=Ri(Mo,dl),As=Ri(vs,Di),so=Ri(al,Ki),ml=Ri(Fi,ao),xl=Ri(Ji,ts),Xs=Ri(Gs,au),gs=Ri(Ko,iu),bl=Ri(Rs,So),ll=Ri(Mu,Is),Fl=Ri(_s,Ll),_l=Ri(Su,ku),Zs=Ri(Ys,Pl),Lu=Ri(ws,Wl),rs=Ri(il,Xl),Yu=Ri(ou,Dl),Jl=Ri(Eu,Ws),ul=Ri(Zl,Rl),wl=Ri(ps,yl),js=Ri(jl,su),Tl=Ri(lu,Il),fu=Ri(Cu,uu),cu=Ri(Jo,ol),Wu=Ri(sl,Kl);function Ri(fe,V){var ve=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,Z={};return fe=fe.replace(ve,function(pe,Me,Re,je,ut){return Z[ut]=!0,Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
varying `+Re+" "+je+" "+ut+`;
#else
uniform `+Re+" "+je+" u_"+ut+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`}),V=V.replace(ve,function(pe,Me,Re,je,ut){var Ct=je==="float"?"vec2":"vec4",Qt=ut.match(/color/)?"color":Ct;return Z[ut]?Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
uniform lowp float u_`+ut+`_t;
attribute `+Re+" "+Ct+" a_"+ut+`;
varying `+Re+" "+je+" "+ut+`;
#else
uniform `+Re+" "+je+" u_"+ut+`;
#endif
`:Qt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+ut+" = a_"+ut+`;
#else
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+ut+" = unpack_mix_"+Qt+"(a_"+ut+", u_"+ut+`_t);
#else
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`:Me==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
uniform lowp float u_`+ut+`_t;
attribute `+Re+" "+Ct+" a_"+ut+`;
#else
uniform `+Re+" "+je+" u_"+ut+`;
#endif
`:Qt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+je+" "+ut+" = a_"+ut+`;
#else
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+je+" "+ut+" = unpack_mix_"+Qt+"(a_"+ut+", u_"+ut+`_t);
#else
    `+Re+" "+je+" "+ut+" = u_"+ut+`;
#endif
`}),{fragmentSource:fe,vertexSource:V}}var fl=Object.freeze({__proto__:null,prelude:ds,background:ko,backgroundPattern:zl,circle:Ts,clippingMask:As,heatmap:so,heatmapTexture:ml,collisionBox:xl,collisionCircle:Xs,debug:gs,fill:bl,fillOutline:ll,fillOutlinePattern:Fl,fillPattern:_l,fillExtrusion:Zs,fillExtrusionPattern:Lu,hillshadePrepare:rs,hillshade:Yu,line:Jl,lineGradient:ul,linePattern:wl,lineSDF:js,raster:Tl,symbolIcon:fu,symbolSDF:cu,symbolTextAndIcon:Wu}),Ks=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Ks.prototype.bind=function(V,ve,Z,pe,Me,Re,je,ut){this.context=V;for(var Ct=this.boundPaintVertexBuffers.length!==pe.length,Qt=0;!Ct&&Qt<pe.length;Qt++)this.boundPaintVertexBuffers[Qt]!==pe[Qt]&&(Ct=!0);var ur=!this.vao||this.boundProgram!==ve||this.boundLayoutVertexBuffer!==Z||Ct||this.boundIndexBuffer!==Me||this.boundVertexOffset!==Re||this.boundDynamicVertexBuffer!==je||this.boundDynamicVertexBuffer2!==ut;!V.extVertexArrayObject||ur?this.freshBind(ve,Z,pe,Me,Re,je,ut):(V.bindVertexArrayOES.set(this.vao),je&&je.bind(),Me&&Me.dynamicDraw&&Me.bind(),ut&&ut.bind())},Ks.prototype.freshBind=function(V,ve,Z,pe,Me,Re,je){var ut,Ct=V.numAttributes,Qt=this.context,ur=Qt.gl;if(Qt.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Qt.extVertexArrayObject.createVertexArrayOES(),Qt.bindVertexArrayOES.set(this.vao),ut=0,this.boundProgram=V,this.boundLayoutVertexBuffer=ve,this.boundPaintVertexBuffers=Z,this.boundIndexBuffer=pe,this.boundVertexOffset=Me,this.boundDynamicVertexBuffer=Re,this.boundDynamicVertexBuffer2=je;else{ut=Qt.currentNumAttributes||0;for(var vr=Ct;vr<ut;vr++)ur.disableVertexAttribArray(vr)}ve.enableAttributes(ur,V);for(var Cr=0,Vr=Z;Cr<Vr.length;Cr+=1){var Wr=Vr[Cr];Wr.enableAttributes(ur,V)}Re&&Re.enableAttributes(ur,V),je&&je.enableAttributes(ur,V),ve.bind(),ve.setVertexAttribPointers(ur,V,Me);for(var Ur=0,Jr=Z;Ur<Jr.length;Ur+=1){var hn=Jr[Ur];hn.bind(),hn.setVertexAttribPointers(ur,V,Me)}Re&&(Re.bind(),Re.setVertexAttribPointers(ur,V,Me)),pe&&pe.bind(),je&&(je.bind(),je.setVertexAttribPointers(ur,V,Me)),Qt.currentNumAttributes=Ct},Ks.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Qo=function(V,ve,Z,pe,Me){var Re=V.gl;this.program=Re.createProgram();var je=Z?Z.defines():[];Me&&je.push("#define OVERDRAW_INSPECTOR;");var ut=je.concat(ds.fragmentSource,ve.fragmentSource).join(`
`),Ct=je.concat(ds.vertexSource,ve.vertexSource).join(`
`),Qt=Re.createShader(Re.FRAGMENT_SHADER);if(Re.isContextLost()){this.failedToCreate=!0;return}Re.shaderSource(Qt,ut),Re.compileShader(Qt),Re.attachShader(this.program,Qt);var ur=Re.createShader(Re.VERTEX_SHADER);if(Re.isContextLost()){this.failedToCreate=!0;return}Re.shaderSource(ur,Ct),Re.compileShader(ur),Re.attachShader(this.program,ur);for(var vr=Z?Z.layoutAttributes:[],Cr=0;Cr<vr.length;Cr++)Re.bindAttribLocation(this.program,Cr,vr[Cr].name);Re.linkProgram(this.program),Re.deleteShader(ur),Re.deleteShader(Qt),this.numAttributes=Re.getProgramParameter(this.program,Re.ACTIVE_ATTRIBUTES),this.attributes={};for(var Vr={},Wr=0;Wr<this.numAttributes;Wr++){var Ur=Re.getActiveAttrib(this.program,Wr);Ur&&(this.attributes[Ur.name]=Re.getAttribLocation(this.program,Ur.name))}for(var Jr=Re.getProgramParameter(this.program,Re.ACTIVE_UNIFORMS),hn=0;hn<Jr;hn++){var Cn=Re.getActiveUniform(this.program,hn);Cn&&(Vr[Cn.name]=Re.getUniformLocation(this.program,Cn.name))}this.fixedUniforms=pe(V,Vr),this.binderUniforms=Z?Z.getUniforms(V,Vr):[]};Qo.prototype.draw=function(V,ve,Z,pe,Me,Re,je,ut,Ct,Qt,ur,vr,Cr,Vr,Wr,Ur){var Jr,hn=V.gl;if(!this.failedToCreate){V.program.set(this.program),V.setDepthMode(Z),V.setStencilMode(pe),V.setColorMode(Me),V.setCullFace(Re);for(var Cn in this.fixedUniforms)this.fixedUniforms[Cn].set(je[Cn]);Vr&&Vr.setUniforms(V,this.binderUniforms,vr,{zoom:Cr});for(var Fn=(Jr={},Jr[hn.LINES]=2,Jr[hn.TRIANGLES]=3,Jr[hn.LINE_STRIP]=1,Jr)[ve],Kn=0,qn=ur.get();Kn<qn.length;Kn+=1){var Qn=qn[Kn],ca=Qn.vaos||(Qn.vaos={}),ba=ca[ut]||(ca[ut]=new Ks);ba.bind(V,this,Ct,Vr?Vr.getPaintVertexBuffers():[],Qt,Qn.vertexOffset,Wr,Ur),hn.drawElements(ve,Qn.primitiveLength*Fn,hn.UNSIGNED_SHORT,Qn.primitiveOffset*Fn*2)}}};function ns(fe,V,ve){var Z=1/An(ve,1,V.transform.tileZoom),pe=Math.pow(2,ve.tileID.overscaledZ),Me=ve.tileSize*Math.pow(2,V.transform.tileZoom)/pe,Re=Me*(ve.tileID.canonical.x+ve.tileID.wrap*pe),je=Me*ve.tileID.canonical.y;return{u_image:0,u_texsize:ve.imageAtlasTexture.size,u_scale:[Z,fe.fromScale,fe.toScale],u_fade:fe.t,u_pixel_coord_upper:[Re>>16,je>>16],u_pixel_coord_lower:[Re&65535,je&65535]}}function Al(fe,V,ve,Z){var pe=ve.imageManager.getPattern(fe.from.toString()),Me=ve.imageManager.getPattern(fe.to.toString()),Re=ve.imageManager.getPixelSize(),je=Re.width,ut=Re.height,Ct=Math.pow(2,Z.tileID.overscaledZ),Qt=Z.tileSize*Math.pow(2,ve.transform.tileZoom)/Ct,ur=Qt*(Z.tileID.canonical.x+Z.tileID.wrap*Ct),vr=Qt*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:pe.tl,u_pattern_br_a:pe.br,u_pattern_tl_b:Me.tl,u_pattern_br_b:Me.br,u_texsize:[je,ut],u_mix:V.t,u_pattern_size_a:pe.displaySize,u_pattern_size_b:Me.displaySize,u_scale_a:V.fromScale,u_scale_b:V.toScale,u_tile_units_to_pixels:1/An(Z,1,ve.transform.tileZoom),u_pixel_coord_upper:[ur>>16,vr>>16],u_pixel_coord_lower:[ur&65535,vr&65535]}}var lo=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_lightpos:new e.Uniform3f(fe,V.u_lightpos),u_lightintensity:new e.Uniform1f(fe,V.u_lightintensity),u_lightcolor:new e.Uniform3f(fe,V.u_lightcolor),u_vertical_gradient:new e.Uniform1f(fe,V.u_vertical_gradient),u_opacity:new e.Uniform1f(fe,V.u_opacity)}},hu=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_lightpos:new e.Uniform3f(fe,V.u_lightpos),u_lightintensity:new e.Uniform1f(fe,V.u_lightintensity),u_lightcolor:new e.Uniform3f(fe,V.u_lightcolor),u_vertical_gradient:new e.Uniform1f(fe,V.u_vertical_gradient),u_height_factor:new e.Uniform1f(fe,V.u_height_factor),u_image:new e.Uniform1i(fe,V.u_image),u_texsize:new e.Uniform2f(fe,V.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,V.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,V.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,V.u_scale),u_fade:new e.Uniform1f(fe,V.u_fade),u_opacity:new e.Uniform1f(fe,V.u_opacity)}},as=function(fe,V,ve,Z){var pe=V.style.light,Me=pe.properties.get("position"),Re=[Me.x,Me.y,Me.z],je=e.create$1();pe.properties.get("anchor")==="viewport"&&e.fromRotation(je,-V.transform.angle),e.transformMat3(Re,Re,je);var ut=pe.properties.get("color");return{u_matrix:fe,u_lightpos:Re,u_lightintensity:pe.properties.get("intensity"),u_lightcolor:[ut.r,ut.g,ut.b],u_vertical_gradient:+ve,u_opacity:Z}},zs=function(fe,V,ve,Z,pe,Me,Re){return e.extend(as(fe,V,ve,Z),ns(Me,V,Re),{u_height_factor:-Math.pow(2,pe.overscaledZ)/Re.tileSize/8})},Fs=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix)}},Ms=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_image:new e.Uniform1i(fe,V.u_image),u_texsize:new e.Uniform2f(fe,V.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,V.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,V.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,V.u_scale),u_fade:new e.Uniform1f(fe,V.u_fade)}},is=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_world:new e.Uniform2f(fe,V.u_world)}},Hi=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_world:new e.Uniform2f(fe,V.u_world),u_image:new e.Uniform1i(fe,V.u_image),u_texsize:new e.Uniform2f(fe,V.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,V.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,V.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,V.u_scale),u_fade:new e.Uniform1f(fe,V.u_fade)}},Eo=function(fe){return{u_matrix:fe}},os=function(fe,V,ve,Z){return e.extend(Eo(fe),ns(ve,V,Z))},vu=function(fe,V){return{u_matrix:fe,u_world:V}},Ol=function(fe,V,ve,Z,pe){return e.extend(os(fe,V,ve,Z),{u_world:pe})},pu=function(fe,V){return{u_camera_to_center_distance:new e.Uniform1f(fe,V.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(fe,V.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(fe,V.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(fe,V.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(fe,V.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(fe,V.u_matrix)}},yt=function(fe,V,ve,Z){var pe=fe.transform,Me,Re;if(Z.paint.get("circle-pitch-alignment")==="map"){var je=An(ve,1,pe.zoom);Me=!0,Re=[je,je]}else Me=!1,Re=pe.pixelsToGLUnits;return{u_camera_to_center_distance:pe.cameraToCenterDistance,u_scale_with_map:+(Z.paint.get("circle-pitch-scale")==="map"),u_matrix:fe.translatePosMatrix(V.posMatrix,ve,Z.paint.get("circle-translate"),Z.paint.get("circle-translate-anchor")),u_pitch_with_map:+Me,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:Re}},Bt=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_camera_to_center_distance:new e.Uniform1f(fe,V.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(fe,V.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(fe,V.u_extrude_scale),u_overscale_factor:new e.Uniform1f(fe,V.u_overscale_factor)}},cr=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_inv_matrix:new e.UniformMatrix4f(fe,V.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(fe,V.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(fe,V.u_viewport_size)}},sr=function(fe,V,ve){var Z=An(ve,1,V.zoom),pe=Math.pow(2,V.zoom-ve.tileID.overscaledZ),Me=ve.tileID.overscaleFactor();return{u_matrix:fe,u_camera_to_center_distance:V.cameraToCenterDistance,u_pixels_to_tile_units:Z,u_extrude_scale:[V.pixelsToGLUnits[0]/(Z*pe),V.pixelsToGLUnits[1]/(Z*pe)],u_overscale_factor:Me}},Dr=function(fe,V,ve){return{u_matrix:fe,u_inv_matrix:V,u_camera_to_center_distance:ve.cameraToCenterDistance,u_viewport_size:[ve.width,ve.height]}},tn=function(fe,V){return{u_color:new e.UniformColor(fe,V.u_color),u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_overlay:new e.Uniform1i(fe,V.u_overlay),u_overlay_scale:new e.Uniform1f(fe,V.u_overlay_scale)}},dn=function(fe,V,ve){return ve===void 0&&(ve=1),{u_matrix:fe,u_color:V,u_overlay:0,u_overlay_scale:ve}},Mn=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix)}},Ln=function(fe){return{u_matrix:fe}},Nn=function(fe,V){return{u_extrude_scale:new e.Uniform1f(fe,V.u_extrude_scale),u_intensity:new e.Uniform1f(fe,V.u_intensity),u_matrix:new e.UniformMatrix4f(fe,V.u_matrix)}},yn=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_world:new e.Uniform2f(fe,V.u_world),u_image:new e.Uniform1i(fe,V.u_image),u_color_ramp:new e.Uniform1i(fe,V.u_color_ramp),u_opacity:new e.Uniform1f(fe,V.u_opacity)}},zn=function(fe,V,ve,Z){return{u_matrix:fe,u_extrude_scale:An(V,1,ve),u_intensity:Z}},Pn=function(fe,V,ve,Z){var pe=e.create();e.ortho(pe,0,fe.width,fe.height,0,0,1);var Me=fe.context.gl;return{u_matrix:pe,u_world:[Me.drawingBufferWidth,Me.drawingBufferHeight],u_image:ve,u_color_ramp:Z,u_opacity:V.paint.get("heatmap-opacity")}},Hn=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_image:new e.Uniform1i(fe,V.u_image),u_latrange:new e.Uniform2f(fe,V.u_latrange),u_light:new e.Uniform2f(fe,V.u_light),u_shadow:new e.UniformColor(fe,V.u_shadow),u_highlight:new e.UniformColor(fe,V.u_highlight),u_accent:new e.UniformColor(fe,V.u_accent)}},$n=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_image:new e.Uniform1i(fe,V.u_image),u_dimension:new e.Uniform2f(fe,V.u_dimension),u_zoom:new e.Uniform1f(fe,V.u_zoom),u_maxzoom:new e.Uniform1f(fe,V.u_maxzoom),u_unpack:new e.Uniform4f(fe,V.u_unpack)}},za=function(fe,V,ve){var Z=ve.paint.get("hillshade-shadow-color"),pe=ve.paint.get("hillshade-highlight-color"),Me=ve.paint.get("hillshade-accent-color"),Re=ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);ve.paint.get("hillshade-illumination-anchor")==="viewport"&&(Re-=fe.transform.angle);var je=!fe.options.moving;return{u_matrix:fe.transform.calculatePosMatrix(V.tileID.toUnwrapped(),je),u_image:0,u_latrange:Fa(fe,V.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),Re],u_shadow:Z,u_highlight:pe,u_accent:Me}},Ea=function(fe,V,ve){var Z=V.stride,pe=e.create();return e.ortho(pe,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(pe,pe,[0,-e.EXTENT,0]),{u_matrix:pe,u_image:1,u_dimension:[Z,Z],u_zoom:fe.overscaledZ,u_maxzoom:ve,u_unpack:V.getUnpackVector()}};function Fa(fe,V){var ve=Math.pow(2,V.canonical.z),Z=V.canonical.y;return[new e.MercatorCoordinate(0,Z/ve).toLngLat().lat,new e.MercatorCoordinate(0,(Z+1)/ve).toLngLat().lat]}var Oa=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_ratio:new e.Uniform1f(fe,V.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,V.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,V.u_units_to_pixels)}},Jn=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_ratio:new e.Uniform1f(fe,V.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,V.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,V.u_units_to_pixels),u_image:new e.Uniform1i(fe,V.u_image)}},ha=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_texsize:new e.Uniform2f(fe,V.u_texsize),u_ratio:new e.Uniform1f(fe,V.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,V.u_device_pixel_ratio),u_image:new e.Uniform1i(fe,V.u_image),u_units_to_pixels:new e.Uniform2f(fe,V.u_units_to_pixels),u_scale:new e.Uniform3f(fe,V.u_scale),u_fade:new e.Uniform1f(fe,V.u_fade)}},Ga=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_ratio:new e.Uniform1f(fe,V.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,V.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,V.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(fe,V.u_patternscale_a),u_patternscale_b:new e.Uniform2f(fe,V.u_patternscale_b),u_sdfgamma:new e.Uniform1f(fe,V.u_sdfgamma),u_image:new e.Uniform1i(fe,V.u_image),u_tex_y_a:new e.Uniform1f(fe,V.u_tex_y_a),u_tex_y_b:new e.Uniform1f(fe,V.u_tex_y_b),u_mix:new e.Uniform1f(fe,V.u_mix)}},Qa=function(fe,V,ve){var Z=fe.transform;return{u_matrix:oi(fe,V,ve),u_ratio:1/An(V,1,Z.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/Z.pixelsToGLUnits[0],1/Z.pixelsToGLUnits[1]]}},di=function(fe,V,ve){return e.extend(Qa(fe,V,ve),{u_image:0})},gi=function(fe,V,ve,Z){var pe=fe.transform,Me=Ai(V,pe);return{u_matrix:oi(fe,V,ve),u_texsize:V.imageAtlasTexture.size,u_ratio:1/An(V,1,pe.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[Me,Z.fromScale,Z.toScale],u_fade:Z.t,u_units_to_pixels:[1/pe.pixelsToGLUnits[0],1/pe.pixelsToGLUnits[1]]}},mi=function(fe,V,ve,Z,pe){var Me=fe.transform,Re=fe.lineAtlas,je=Ai(V,Me),ut=ve.layout.get("line-cap")==="round",Ct=Re.getDash(Z.from,ut),Qt=Re.getDash(Z.to,ut),ur=Ct.width*pe.fromScale,vr=Qt.width*pe.toScale;return e.extend(Qa(fe,V,ve),{u_patternscale_a:[je/ur,-Ct.height/2],u_patternscale_b:[je/vr,-Qt.height/2],u_sdfgamma:Re.width/(Math.min(ur,vr)*256*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ct.y,u_tex_y_b:Qt.y,u_mix:pe.t})};function Ai(fe,V){return 1/An(fe,1,V.tileZoom)}function oi(fe,V,ve){return fe.translatePosMatrix(V.tileID.posMatrix,V,ve.paint.get("line-translate"),ve.paint.get("line-translate-anchor"))}var mo=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_tl_parent:new e.Uniform2f(fe,V.u_tl_parent),u_scale_parent:new e.Uniform1f(fe,V.u_scale_parent),u_buffer_scale:new e.Uniform1f(fe,V.u_buffer_scale),u_fade_t:new e.Uniform1f(fe,V.u_fade_t),u_opacity:new e.Uniform1f(fe,V.u_opacity),u_image0:new e.Uniform1i(fe,V.u_image0),u_image1:new e.Uniform1i(fe,V.u_image1),u_brightness_low:new e.Uniform1f(fe,V.u_brightness_low),u_brightness_high:new e.Uniform1f(fe,V.u_brightness_high),u_saturation_factor:new e.Uniform1f(fe,V.u_saturation_factor),u_contrast_factor:new e.Uniform1f(fe,V.u_contrast_factor),u_spin_weights:new e.Uniform3f(fe,V.u_spin_weights)}},qi=function(fe,V,ve,Z,pe){return{u_matrix:fe,u_tl_parent:V,u_scale_parent:ve,u_buffer_scale:1,u_fade_t:Z.mix,u_opacity:Z.opacity*pe.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:pe.paint.get("raster-brightness-min"),u_brightness_high:pe.paint.get("raster-brightness-max"),u_saturation_factor:xi(pe.paint.get("raster-saturation")),u_contrast_factor:va(pe.paint.get("raster-contrast")),u_spin_weights:Ja(pe.paint.get("raster-hue-rotate"))}};function Ja(fe){fe*=Math.PI/180;var V=Math.sin(fe),ve=Math.cos(fe);return[(2*ve+1)/3,(-Math.sqrt(3)*V-ve+1)/3,(Math.sqrt(3)*V-ve+1)/3]}function va(fe){return fe>0?1/(1-fe):1+fe}function xi(fe){return fe>0?1-1/(1.001-fe):-fe}var uo=function(fe,V){return{u_is_size_zoom_constant:new e.Uniform1i(fe,V.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,V.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,V.u_size_t),u_size:new e.Uniform1f(fe,V.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,V.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,V.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,V.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,V.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,V.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,V.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,V.u_coord_matrix),u_is_text:new e.Uniform1i(fe,V.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,V.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,V.u_texsize),u_texture:new e.Uniform1i(fe,V.u_texture)}},po=function(fe,V){return{u_is_size_zoom_constant:new e.Uniform1i(fe,V.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,V.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,V.u_size_t),u_size:new e.Uniform1f(fe,V.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,V.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,V.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,V.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,V.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,V.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,V.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,V.u_coord_matrix),u_is_text:new e.Uniform1i(fe,V.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,V.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,V.u_texsize),u_texture:new e.Uniform1i(fe,V.u_texture),u_gamma_scale:new e.Uniform1f(fe,V.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(fe,V.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(fe,V.u_is_halo)}},ss=function(fe,V){return{u_is_size_zoom_constant:new e.Uniform1i(fe,V.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,V.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,V.u_size_t),u_size:new e.Uniform1f(fe,V.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,V.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,V.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,V.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,V.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,V.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,V.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,V.u_coord_matrix),u_is_text:new e.Uniform1i(fe,V.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,V.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,V.u_texsize),u_texsize_icon:new e.Uniform2f(fe,V.u_texsize_icon),u_texture:new e.Uniform1i(fe,V.u_texture),u_texture_icon:new e.Uniform1i(fe,V.u_texture_icon),u_gamma_scale:new e.Uniform1f(fe,V.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(fe,V.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(fe,V.u_is_halo)}},Ss=function(fe,V,ve,Z,pe,Me,Re,je,ut,Ct){var Qt=pe.transform;return{u_is_size_zoom_constant:+(fe==="constant"||fe==="source"),u_is_size_feature_constant:+(fe==="constant"||fe==="camera"),u_size_t:V?V.uSizeT:0,u_size:V?V.uSize:0,u_camera_to_center_distance:Qt.cameraToCenterDistance,u_pitch:Qt.pitch/360*2*Math.PI,u_rotate_symbol:+ve,u_aspect_ratio:Qt.width/Qt.height,u_fade_change:pe.options.fadeDuration?pe.symbolFadeChange:1,u_matrix:Me,u_label_plane_matrix:Re,u_coord_matrix:je,u_is_text:+ut,u_pitch_with_map:+Z,u_texsize:Ct,u_texture:0}},zo=function(fe,V,ve,Z,pe,Me,Re,je,ut,Ct,Qt){var ur=pe.transform;return e.extend(Ss(fe,V,ve,Z,pe,Me,Re,je,ut,Ct),{u_gamma_scale:Z?Math.cos(ur._pitch)*ur.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Qt})},Js=function(fe,V,ve,Z,pe,Me,Re,je,ut,Ct){return e.extend(zo(fe,V,ve,Z,pe,Me,Re,je,!0,ut,!0),{u_texsize_icon:Ct,u_texture_icon:1})},ys=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_opacity:new e.Uniform1f(fe,V.u_opacity),u_color:new e.UniformColor(fe,V.u_color)}},ls=function(fe,V){return{u_matrix:new e.UniformMatrix4f(fe,V.u_matrix),u_opacity:new e.Uniform1f(fe,V.u_opacity),u_image:new e.Uniform1i(fe,V.u_image),u_pattern_tl_a:new e.Uniform2f(fe,V.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(fe,V.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(fe,V.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(fe,V.u_pattern_br_b),u_texsize:new e.Uniform2f(fe,V.u_texsize),u_mix:new e.Uniform1f(fe,V.u_mix),u_pattern_size_a:new e.Uniform2f(fe,V.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(fe,V.u_pattern_size_b),u_scale_a:new e.Uniform1f(fe,V.u_scale_a),u_scale_b:new e.Uniform1f(fe,V.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(fe,V.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,V.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(fe,V.u_tile_units_to_pixels)}},xo=function(fe,V,ve){return{u_matrix:fe,u_opacity:V,u_color:ve}},Bl=function(fe,V,ve,Z,pe,Me){return e.extend(Al(Z,Me,ve,pe),{u_matrix:fe,u_opacity:V})},Ql={fillExtrusion:lo,fillExtrusionPattern:hu,fill:Fs,fillPattern:Ms,fillOutline:is,fillOutlinePattern:Hi,circle:pu,collisionBox:Bt,collisionCircle:cr,debug:tn,clippingMask:Mn,heatmap:Nn,heatmapTexture:yn,hillshade:Hn,hillshadePrepare:$n,line:Oa,lineGradient:Jn,linePattern:ha,lineSDF:Ga,raster:mo,symbolIcon:uo,symbolSDF:po,symbolTextAndIcon:ss,background:ys,backgroundPattern:ls},us;function du(fe,V,ve,Z,pe,Me,Re){for(var je=fe.context,ut=je.gl,Ct=fe.useProgram("collisionBox"),Qt=[],ur=0,vr=0,Cr=0;Cr<Z.length;Cr++){var Vr=Z[Cr],Wr=V.getTile(Vr),Ur=Wr.getBucket(ve);if(Ur){var Jr=Vr.posMatrix;(pe[0]!==0||pe[1]!==0)&&(Jr=fe.translatePosMatrix(Vr.posMatrix,Wr,pe,Me));var hn=Re?Ur.textCollisionBox:Ur.iconCollisionBox,Cn=Ur.collisionCircleArray;if(Cn.length>0){var Fn=e.create(),Kn=Jr;e.mul(Fn,Ur.placementInvProjMatrix,fe.transform.glCoordMatrix),e.mul(Fn,Fn,Ur.placementViewportMatrix),Qt.push({circleArray:Cn,circleOffset:vr,transform:Kn,invTransform:Fn}),ur+=Cn.length/4,vr=ur}hn&&Ct.draw(je,ut.LINES,jr.disabled,Jt.disabled,fe.colorModeForRenderPass(),Tt.disabled,sr(Jr,fe.transform,Wr),ve.id,hn.layoutVertexBuffer,hn.indexBuffer,hn.segments,null,fe.transform.zoom,null,null,hn.collisionVertexBuffer)}}if(!(!Re||!Qt.length)){var qn=fe.useProgram("collisionCircle"),Qn=new e.StructArrayLayout2f1f2i16;Qn.resize(ur*4),Qn._trim();for(var ca=0,ba=0,ya=Qt;ba<ya.length;ba+=1)for(var Ta=ya[ba],Ca=0;Ca<Ta.circleArray.length/4;Ca++){var Ha=Ca*4,ni=Ta.circleArray[Ha+0],Li=Ta.circleArray[Ha+1],ui=Ta.circleArray[Ha+2],pi=Ta.circleArray[Ha+3];Qn.emplace(ca++,ni,Li,ui,pi,0),Qn.emplace(ca++,ni,Li,ui,pi,1),Qn.emplace(ca++,ni,Li,ui,pi,2),Qn.emplace(ca++,ni,Li,ui,pi,3)}(!us||us.length<ur*2)&&(us=Nl(ur));for(var Ba=je.createIndexBuffer(us,!0),Pi=je.createVertexBuffer(Qn,e.collisionCircleLayout.members,!0),zi=0,Ni=Qt;zi<Ni.length;zi+=1){var _i=Ni[zi],ji=Dr(_i.transform,_i.invTransform,fe.transform);qn.draw(je,ut.TRIANGLES,jr.disabled,Jt.disabled,fe.colorModeForRenderPass(),Tt.disabled,ji,ve.id,Pi,Ba,e.SegmentVector.simpleSegment(0,_i.circleOffset*2,_i.circleArray.length,_i.circleArray.length/2),null,fe.transform.zoom,null,null,null)}Pi.destroy(),Ba.destroy()}}function Nl(fe){var V=fe*2,ve=new e.StructArrayLayout3ui6;ve.resize(V),ve._trim();for(var Z=0;Z<V;Z++){var pe=Z*6;ve.uint16[pe+0]=Z*4+0,ve.uint16[pe+1]=Z*4+1,ve.uint16[pe+2]=Z*4+2,ve.uint16[pe+3]=Z*4+2,ve.uint16[pe+4]=Z*4+3,ve.uint16[pe+5]=Z*4+0}return ve}var vf=e.identity(new Float32Array(16));function Pu(fe,V,ve,Z,pe){if(fe.renderPass==="translucent"){var Me=Jt.disabled,Re=fe.colorModeForRenderPass(),je=ve.layout.get("text-variable-anchor");je&&Du(Z,fe,ve,V,ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),pe),ve.paint.get("icon-opacity").constantOr(1)!==0&&Ru(fe,V,ve,Z,!1,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),ve.layout.get("icon-rotation-alignment"),ve.layout.get("icon-pitch-alignment"),ve.layout.get("icon-keep-upright"),Me,Re),ve.paint.get("text-opacity").constantOr(1)!==0&&Ru(fe,V,ve,Z,!0,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),ve.layout.get("text-keep-upright"),Me,Re),V.map.showCollisionBoxes&&(du(fe,V,ve,Z,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),!0),du(fe,V,ve,Z,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),!1))}}function gu(fe,V,ve,Z,pe,Me){var Re=e.getAnchorAlignment(fe),je=Re.horizontalAlign,ut=Re.verticalAlign,Ct=-(je-.5)*V,Qt=-(ut-.5)*ve,ur=e.evaluateVariableOffset(fe,Z);return new e.Point((Ct/pe+ur[0])*Me,(Qt/pe+ur[1])*Me)}function Du(fe,V,ve,Z,pe,Me,Re){for(var je=V.transform,ut=pe==="map",Ct=Me==="map",Qt=0,ur=fe;Qt<ur.length;Qt+=1){var vr=ur[Qt],Cr=Z.getTile(vr),Vr=Cr.getBucket(ve);if(!(!Vr||!Vr.text||!Vr.text.segments.get().length)){var Wr=Vr.textSizeData,Ur=e.evaluateSizeForZoom(Wr,je.zoom),Jr=An(Cr,1,V.transform.zoom),hn=Gr(vr.posMatrix,Ct,ut,V.transform,Jr),Cn=ve.layout.get("icon-text-fit")!=="none"&&Vr.hasIconData();if(Ur){var Fn=Math.pow(2,je.zoom-Cr.tileID.overscaledZ);ks(Vr,ut,Ct,Re,e.symbolSize,je,hn,vr.posMatrix,Fn,Ur,Cn)}}}}function ks(fe,V,ve,Z,pe,Me,Re,je,ut,Ct,Qt){var ur=fe.text.placedSymbolArray,vr=fe.text.dynamicLayoutVertexArray,Cr=fe.icon.dynamicLayoutVertexArray,Vr={};vr.clear();for(var Wr=0;Wr<ur.length;Wr++){var Ur=ur.get(Wr),Jr=fe.allowVerticalPlacement&&!Ur.placedOrientation,hn=!Ur.hidden&&Ur.crossTileID&&!Jr?Z[Ur.crossTileID]:null;if(!hn)Wa(Ur.numGlyphs,vr);else{var Cn=new e.Point(Ur.anchorX,Ur.anchorY),Fn=cn(Cn,ve?je:Re),Kn=Bn(Me.cameraToCenterDistance,Fn.signedDistanceFromCamera),qn=pe.evaluateSizeForFeature(fe.textSizeData,Ct,Ur)*Kn/e.ONE_EM;ve&&(qn*=fe.tilePixelRatio/ut);for(var Qn=hn.width,ca=hn.height,ba=hn.anchor,ya=hn.textOffset,Ta=hn.textBoxScale,Ca=gu(ba,Qn,ca,ya,Ta,qn),Ha=ve?cn(Cn.add(Ca),Re).point:Fn.point.add(V?Ca.rotate(-Me.angle):Ca),ni=fe.allowVerticalPlacement&&Ur.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Li=0;Li<Ur.numGlyphs;Li++)e.addDynamicAttributes(vr,Ha,ni);Qt&&Ur.associatedIconIndex>=0&&(Vr[Ur.associatedIconIndex]={shiftedAnchor:Ha,angle:ni})}}if(Qt){Cr.clear();for(var ui=fe.icon.placedSymbolArray,pi=0;pi<ui.length;pi++){var Ba=ui.get(pi);if(Ba.hidden)Wa(Ba.numGlyphs,Cr);else{var Pi=Vr[pi];if(!Pi)Wa(Ba.numGlyphs,Cr);else for(var zi=0;zi<Ba.numGlyphs;zi++)e.addDynamicAttributes(Cr,Pi.shiftedAnchor,Pi.angle)}}fe.icon.dynamicLayoutVertexBuffer.updateData(Cr)}fe.text.dynamicLayoutVertexBuffer.updateData(vr)}function Xu(fe,V,ve){return ve.iconsInText&&V?"symbolTextAndIcon":fe?"symbolSDF":"symbolIcon"}function Ru(fe,V,ve,Z,pe,Me,Re,je,ut,Ct,Qt,ur){for(var vr=fe.context,Cr=vr.gl,Vr=fe.transform,Wr=je==="map",Ur=ut==="map",Jr=Wr&&ve.layout.get("symbol-placement")!=="point",hn=Wr&&!Ur&&!Jr,Cn=ve.layout.get("symbol-sort-key").constantOr(1)!==void 0,Fn=fe.depthModeForSublayer(0,jr.ReadOnly),Kn=ve.layout.get("text-variable-anchor"),qn=[],Qn=0,ca=Z;Qn<ca.length;Qn+=1){var ba=ca[Qn],ya=V.getTile(ba),Ta=ya.getBucket(ve);if(Ta){var Ca=pe?Ta.text:Ta.icon;if(!(!Ca||!Ca.segments.get().length)){var Ha=Ca.programConfigurations.get(ve.id),ni=pe||Ta.sdfIcons,Li=pe?Ta.textSizeData:Ta.iconSizeData,ui=Ur||Vr.pitch!==0,pi=fe.useProgram(Xu(ni,pe,Ta),Ha),Ba=e.evaluateSizeForZoom(Li,Vr.zoom),Pi=void 0,zi=[0,0],Ni=void 0,_i=void 0,ji=null,ii=void 0;if(pe){if(Ni=ya.glyphAtlasTexture,_i=Cr.LINEAR,Pi=ya.glyphAtlasTexture.size,Ta.iconsInText){zi=ya.imageAtlasTexture.size,ji=ya.imageAtlasTexture;var wi=Li.kind==="composite"||Li.kind==="camera";ii=ui||fe.options.rotating||fe.options.zooming||wi?Cr.LINEAR:Cr.NEAREST}}else{var wo=ve.layout.get("icon-size").constantOr(0)!==1||Ta.iconsNeedLinear;Ni=ya.imageAtlasTexture,_i=ni||fe.options.rotating||fe.options.zooming||wo||ui?Cr.LINEAR:Cr.NEAREST,Pi=ya.imageAtlasTexture.size}var Bo=An(ya,1,fe.transform.zoom),Sl=Gr(ba.posMatrix,Ur,Wr,fe.transform,Bo),kl=wn(ba.posMatrix,Ur,Wr,fe.transform,Bo),$l=Kn&&Ta.hasTextData(),ql=ve.layout.get("icon-text-fit")!=="none"&&$l&&Ta.hasIconData();Jr&&Yn(Ta,ba.posMatrix,fe,pe,Sl,kl,Ur,Ct);var _u=fe.translatePosMatrix(ba.posMatrix,ya,Me,Re),eu=Jr||pe&&Kn||ql?vf:Sl,Bs=fe.translatePosMatrix(kl,ya,Me,Re,!0),Vu=ni&&ve.paint.get(pe?"text-halo-width":"icon-halo-width").constantOr(1)!==0,bs=void 0;ni?Ta.iconsInText?bs=Js(Li.kind,Ba,hn,Ur,fe,_u,eu,Bs,Pi,zi):bs=zo(Li.kind,Ba,hn,Ur,fe,_u,eu,Bs,pe,Pi,!0):bs=Ss(Li.kind,Ba,hn,Ur,fe,_u,eu,Bs,pe,Pi);var cl={program:pi,buffers:Ca,uniformValues:bs,atlasTexture:Ni,atlasTextureIcon:ji,atlasInterpolation:_i,atlasInterpolationIcon:ii,isSDF:ni,hasHalo:Vu};if(Cn)for(var tu=Ca.segments.get(),Vl=0,ru=tu;Vl<ru.length;Vl+=1){var Cf=ru[Vl];qn.push({segments:new e.SegmentVector([Cf]),sortKey:Cf.sortKey,state:cl})}else qn.push({segments:Ca.segments,sortKey:0,state:cl})}}}Cn&&qn.sort(function(Lf,Pf){return Lf.sortKey-Pf.sortKey});for(var Zu=0,cs=qn;Zu<cs.length;Zu+=1){var mf=cs[Zu],Es=mf.state;if(vr.activeTexture.set(Cr.TEXTURE0),Es.atlasTexture.bind(Es.atlasInterpolation,Cr.CLAMP_TO_EDGE),Es.atlasTextureIcon&&(vr.activeTexture.set(Cr.TEXTURE1),Es.atlasTextureIcon&&Es.atlasTextureIcon.bind(Es.atlasInterpolationIcon,Cr.CLAMP_TO_EDGE)),Es.isSDF){var xf=Es.uniformValues;Es.hasHalo&&(xf.u_is_halo=1,Iu(Es.buffers,mf.segments,ve,fe,Es.program,Fn,Qt,ur,xf)),xf.u_is_halo=0}Iu(Es.buffers,mf.segments,ve,fe,Es.program,Fn,Qt,ur,Es.uniformValues)}}function Iu(fe,V,ve,Z,pe,Me,Re,je,ut){var Ct=Z.context,Qt=Ct.gl;pe.draw(Ct,Qt.TRIANGLES,Me,Re,je,Tt.disabled,ut,ve.id,fe.layoutVertexBuffer,fe.indexBuffer,V,ve.paint,Z.transform.zoom,fe.programConfigurations.get(ve.id),fe.dynamicLayoutVertexBuffer,fe.opacityVertexBuffer)}function Fo(fe,V,ve,Z){if(fe.renderPass==="translucent"){var pe=ve.paint.get("circle-opacity"),Me=ve.paint.get("circle-stroke-width"),Re=ve.paint.get("circle-stroke-opacity"),je=ve.layout.get("circle-sort-key").constantOr(1)!==void 0;if(!(pe.constantOr(1)===0&&(Me.constantOr(1)===0||Re.constantOr(1)===0))){for(var ut=fe.context,Ct=ut.gl,Qt=fe.depthModeForSublayer(0,jr.ReadOnly),ur=Jt.disabled,vr=fe.colorModeForRenderPass(),Cr=[],Vr=0;Vr<Z.length;Vr++){var Wr=Z[Vr],Ur=V.getTile(Wr),Jr=Ur.getBucket(ve);if(Jr){var hn=Jr.programConfigurations.get(ve.id),Cn=fe.useProgram("circle",hn),Fn=Jr.layoutVertexBuffer,Kn=Jr.indexBuffer,qn=yt(fe,Wr,Ur,ve),Qn={programConfiguration:hn,program:Cn,layoutVertexBuffer:Fn,indexBuffer:Kn,uniformValues:qn};if(je)for(var ca=Jr.segments.get(),ba=0,ya=ca;ba<ya.length;ba+=1){var Ta=ya[ba];Cr.push({segments:new e.SegmentVector([Ta]),sortKey:Ta.sortKey,state:Qn})}else Cr.push({segments:Jr.segments,sortKey:0,state:Qn})}}je&&Cr.sort(function(_i,ji){return _i.sortKey-ji.sortKey});for(var Ca=0,Ha=Cr;Ca<Ha.length;Ca+=1){var ni=Ha[Ca],Li=ni.state,ui=Li.programConfiguration,pi=Li.program,Ba=Li.layoutVertexBuffer,Pi=Li.indexBuffer,zi=Li.uniformValues,Ni=ni.segments;pi.draw(ut,Ct.TRIANGLES,Qt,ur,vr,Tt.disabled,zi,ve.id,Ba,Pi,Ni,ve.paint,fe.transform.zoom,ui)}}}}function zu(fe,V,ve,Z){if(ve.paint.get("heatmap-opacity")!==0)if(fe.renderPass==="offscreen"){var pe=fe.context,Me=pe.gl,Re=Jt.disabled,je=new Je([Me.ONE,Me.ONE],e.Color.transparent,[!0,!0,!0,!0]);$u(pe,fe,ve),pe.clear({color:e.Color.transparent});for(var ut=0;ut<Z.length;ut++){var Ct=Z[ut];if(!V.hasRenderableParent(Ct)){var Qt=V.getTile(Ct),ur=Qt.getBucket(ve);if(ur){var vr=ur.programConfigurations.get(ve.id),Cr=fe.useProgram("heatmap",vr),Vr=fe.transform,Wr=Vr.zoom;Cr.draw(pe,Me.TRIANGLES,jr.disabled,Re,je,Tt.disabled,zn(Ct.posMatrix,Qt,Wr,ve.paint.get("heatmap-intensity")),ve.id,ur.layoutVertexBuffer,ur.indexBuffer,ur.segments,ve.paint,fe.transform.zoom,vr)}}}pe.viewport.set([0,0,fe.width,fe.height])}else fe.renderPass==="translucent"&&(fe.context.setColorMode(fe.colorModeForRenderPass()),yu(fe,ve))}function $u(fe,V,ve){var Z=fe.gl;fe.activeTexture.set(Z.TEXTURE1),fe.viewport.set([0,0,V.width/4,V.height/4]);var pe=ve.heatmapFbo;if(pe)Z.bindTexture(Z.TEXTURE_2D,pe.colorAttachment.get()),fe.bindFramebuffer.set(pe.framebuffer);else{var Me=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,Me),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),pe=ve.heatmapFbo=fe.createFramebuffer(V.width/4,V.height/4,!1),ms(fe,V,Me,pe)}}function ms(fe,V,ve,Z){var pe=fe.gl,Me=fe.extRenderToTextureHalfFloat?fe.extTextureHalfFloat.HALF_FLOAT_OES:pe.UNSIGNED_BYTE;pe.texImage2D(pe.TEXTURE_2D,0,pe.RGBA,V.width/4,V.height/4,0,pe.RGBA,Me,null),Z.colorAttachment.set(ve)}function yu(fe,V){var ve=fe.context,Z=ve.gl,pe=V.heatmapFbo;if(pe){ve.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,pe.colorAttachment.get()),ve.activeTexture.set(Z.TEXTURE1);var Me=V.colorRampTexture;Me||(Me=V.colorRampTexture=new e.Texture(ve,V.colorRamp,Z.RGBA)),Me.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),fe.useProgram("heatmapTexture").draw(ve,Z.TRIANGLES,jr.disabled,Jt.disabled,fe.colorModeForRenderPass(),Tt.disabled,Pn(fe,V,0,1),V.id,fe.viewportBuffer,fe.quadTriangleIndexBuffer,fe.viewportSegments,V.paint,fe.transform.zoom)}}function mu(fe,V,ve,Z){if(fe.renderPass==="translucent"){var pe=ve.paint.get("line-opacity"),Me=ve.paint.get("line-width");if(!(pe.constantOr(1)===0||Me.constantOr(1)===0)){var Re=fe.depthModeForSublayer(0,jr.ReadOnly),je=fe.colorModeForRenderPass(),ut=ve.paint.get("line-dasharray"),Ct=ve.paint.get("line-pattern"),Qt=Ct.constantOr(1),ur=ve.paint.get("line-gradient"),vr=ve.getCrossfadeParameters(),Cr=Qt?"linePattern":ut?"lineSDF":ur?"lineGradient":"line",Vr=fe.context,Wr=Vr.gl,Ur=!0;if(ur){Vr.activeTexture.set(Wr.TEXTURE0);var Jr=ve.gradientTexture;if(!ve.gradient)return;Jr||(Jr=ve.gradientTexture=new e.Texture(Vr,ve.gradient,Wr.RGBA)),Jr.bind(Wr.LINEAR,Wr.CLAMP_TO_EDGE)}for(var hn=0,Cn=Z;hn<Cn.length;hn+=1){var Fn=Cn[hn],Kn=V.getTile(Fn);if(!(Qt&&!Kn.patternsLoaded())){var qn=Kn.getBucket(ve);if(qn){var Qn=qn.programConfigurations.get(ve.id),ca=fe.context.program.get(),ba=fe.useProgram(Cr,Qn),ya=Ur||ba.program!==ca,Ta=Ct.constantOr(null);if(Ta&&Kn.imageAtlas){var Ca=Kn.imageAtlas,Ha=Ca.patternPositions[Ta.to.toString()],ni=Ca.patternPositions[Ta.from.toString()];Ha&&ni&&Qn.setConstantPatternPositions(Ha,ni)}var Li=Qt?gi(fe,Kn,ve,vr):ut?mi(fe,Kn,ve,ut,vr):ur?di(fe,Kn,ve):Qa(fe,Kn,ve);Qt?(Vr.activeTexture.set(Wr.TEXTURE0),Kn.imageAtlasTexture.bind(Wr.LINEAR,Wr.CLAMP_TO_EDGE),Qn.updatePaintBuffers(vr)):ut&&(ya||fe.lineAtlas.dirty)&&(Vr.activeTexture.set(Wr.TEXTURE0),fe.lineAtlas.bind(Vr)),ba.draw(Vr,Wr.TRIANGLES,Re,fe.stencilModeForClipping(Fn),je,Tt.disabled,Li,ve.id,qn.layoutVertexBuffer,qn.indexBuffer,qn.segments,ve.paint,fe.transform.zoom,Qn),Ur=!1}}}}}}function Fu(fe,V,ve,Z){var pe=ve.paint.get("fill-color"),Me=ve.paint.get("fill-opacity");if(Me.constantOr(1)!==0){var Re=fe.colorModeForRenderPass(),je=ve.paint.get("fill-pattern"),ut=fe.opaquePassEnabledForLayer()&&!je.constantOr(1)&&pe.constantOr(e.Color.transparent).a===1&&Me.constantOr(0)===1?"opaque":"translucent";if(fe.renderPass===ut){var Ct=fe.depthModeForSublayer(1,fe.renderPass==="opaque"?jr.ReadWrite:jr.ReadOnly);ze(fe,V,ve,Z,Ct,Re,!1)}if(fe.renderPass==="translucent"&&ve.paint.get("fill-antialias")){var Qt=fe.depthModeForSublayer(ve.getPaintProperty("fill-outline-color")?2:0,jr.ReadOnly);ze(fe,V,ve,Z,Qt,Re,!0)}}}function ze(fe,V,ve,Z,pe,Me,Re){var je=fe.context.gl,ut=ve.paint.get("fill-pattern"),Ct=ut&&ut.constantOr(1),Qt=ve.getCrossfadeParameters(),ur,vr,Cr,Vr,Wr;Re?(vr=Ct&&!ve.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ur=je.LINES):(vr=Ct?"fillPattern":"fill",ur=je.TRIANGLES);for(var Ur=0,Jr=Z;Ur<Jr.length;Ur+=1){var hn=Jr[Ur],Cn=V.getTile(hn);if(!(Ct&&!Cn.patternsLoaded())){var Fn=Cn.getBucket(ve);if(Fn){var Kn=Fn.programConfigurations.get(ve.id),qn=fe.useProgram(vr,Kn);Ct&&(fe.context.activeTexture.set(je.TEXTURE0),Cn.imageAtlasTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE),Kn.updatePaintBuffers(Qt));var Qn=ut.constantOr(null);if(Qn&&Cn.imageAtlas){var ca=Cn.imageAtlas,ba=ca.patternPositions[Qn.to.toString()],ya=ca.patternPositions[Qn.from.toString()];ba&&ya&&Kn.setConstantPatternPositions(ba,ya)}var Ta=fe.translatePosMatrix(hn.posMatrix,Cn,ve.paint.get("fill-translate"),ve.paint.get("fill-translate-anchor"));if(!Re)Vr=Fn.indexBuffer,Wr=Fn.segments,Cr=Ct?os(Ta,fe,Qt,Cn):Eo(Ta);else{Vr=Fn.indexBuffer2,Wr=Fn.segments2;var Ca=[je.drawingBufferWidth,je.drawingBufferHeight];Cr=vr==="fillOutlinePattern"&&Ct?Ol(Ta,fe,Qt,Cn,Ca):vu(Ta,Ca)}qn.draw(fe.context,ur,pe,fe.stencilModeForClipping(hn),Me,Tt.disabled,Cr,ve.id,Fn.layoutVertexBuffer,Vr,Wr,ve.paint,fe.transform.zoom,Kn)}}}}function We(fe,V,ve,Z){var pe=ve.paint.get("fill-extrusion-opacity");if(pe!==0&&fe.renderPass==="translucent"){var Me=new jr(fe.context.gl.LEQUAL,jr.ReadWrite,fe.depthRangeFor3D);if(pe===1&&!ve.paint.get("fill-extrusion-pattern").constantOr(1)){var Re=fe.colorModeForRenderPass();qe(fe,V,ve,Z,Me,Jt.disabled,Re)}else qe(fe,V,ve,Z,Me,Jt.disabled,Je.disabled),qe(fe,V,ve,Z,Me,fe.stencilModeFor3D(),fe.colorModeForRenderPass())}}function qe(fe,V,ve,Z,pe,Me,Re){for(var je=fe.context,ut=je.gl,Ct=ve.paint.get("fill-extrusion-pattern"),Qt=Ct.constantOr(1),ur=ve.getCrossfadeParameters(),vr=ve.paint.get("fill-extrusion-opacity"),Cr=0,Vr=Z;Cr<Vr.length;Cr+=1){var Wr=Vr[Cr],Ur=V.getTile(Wr),Jr=Ur.getBucket(ve);if(Jr){var hn=Jr.programConfigurations.get(ve.id),Cn=fe.useProgram(Qt?"fillExtrusionPattern":"fillExtrusion",hn);Qt&&(fe.context.activeTexture.set(ut.TEXTURE0),Ur.imageAtlasTexture.bind(ut.LINEAR,ut.CLAMP_TO_EDGE),hn.updatePaintBuffers(ur));var Fn=Ct.constantOr(null);if(Fn&&Ur.imageAtlas){var Kn=Ur.imageAtlas,qn=Kn.patternPositions[Fn.to.toString()],Qn=Kn.patternPositions[Fn.from.toString()];qn&&Qn&&hn.setConstantPatternPositions(qn,Qn)}var ca=fe.translatePosMatrix(Wr.posMatrix,Ur,ve.paint.get("fill-extrusion-translate"),ve.paint.get("fill-extrusion-translate-anchor")),ba=ve.paint.get("fill-extrusion-vertical-gradient"),ya=Qt?zs(ca,fe,ba,vr,Wr,ur,Ur):as(ca,fe,ba,vr);Cn.draw(je,je.gl.TRIANGLES,pe,Me,Re,Tt.backCCW,ya,ve.id,Jr.layoutVertexBuffer,Jr.indexBuffer,Jr.segments,ve.paint,fe.transform.zoom,hn)}}}function ot(fe,V,ve,Z){if(!(fe.renderPass!=="offscreen"&&fe.renderPass!=="translucent")){for(var pe=fe.context,Me=V.getSource().maxzoom,Re=fe.depthModeForSublayer(0,jr.ReadOnly),je=fe.colorModeForRenderPass(),ut=fe.renderPass==="translucent"?fe.stencilConfigForOverlap(Z):[{},Z],Ct=ut[0],Qt=ut[1],ur=0,vr=Qt;ur<vr.length;ur+=1){var Cr=vr[ur],Vr=V.getTile(Cr);Vr.needsHillshadePrepare&&fe.renderPass==="offscreen"?mt(fe,Vr,ve,Me,Re,Jt.disabled,je):fe.renderPass==="translucent"&&_t(fe,Vr,ve,Re,Ct[Cr.overscaledZ],je)}pe.viewport.set([0,0,fe.width,fe.height])}}function _t(fe,V,ve,Z,pe,Me){var Re=fe.context,je=Re.gl,ut=V.fbo;if(ut){var Ct=fe.useProgram("hillshade");Re.activeTexture.set(je.TEXTURE0),je.bindTexture(je.TEXTURE_2D,ut.colorAttachment.get());var Qt=za(fe,V,ve);Ct.draw(Re,je.TRIANGLES,Z,pe,Me,Tt.disabled,Qt,ve.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments)}}function mt(fe,V,ve,Z,pe,Me,Re){var je=fe.context,ut=je.gl,Ct=V.dem;if(Ct&&Ct.data){var Qt=Ct.dim,ur=Ct.stride,vr=Ct.getPixels();if(je.activeTexture.set(ut.TEXTURE1),je.pixelStoreUnpackPremultiplyAlpha.set(!1),V.demTexture=V.demTexture||fe.getTileTexture(ur),V.demTexture){var Cr=V.demTexture;Cr.update(vr,{premultiply:!1}),Cr.bind(ut.NEAREST,ut.CLAMP_TO_EDGE)}else V.demTexture=new e.Texture(je,vr,ut.RGBA,{premultiply:!1}),V.demTexture.bind(ut.NEAREST,ut.CLAMP_TO_EDGE);je.activeTexture.set(ut.TEXTURE0);var Vr=V.fbo;if(!Vr){var Wr=new e.Texture(je,{width:Qt,height:Qt,data:null},ut.RGBA);Wr.bind(ut.LINEAR,ut.CLAMP_TO_EDGE),Vr=V.fbo=je.createFramebuffer(Qt,Qt,!0),Vr.colorAttachment.set(Wr.texture)}je.bindFramebuffer.set(Vr.framebuffer),je.viewport.set([0,0,Qt,Qt]),fe.useProgram("hillshadePrepare").draw(je,ut.TRIANGLES,pe,Me,Re,Tt.disabled,Ea(V.tileID,Ct,Z),ve.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments),V.needsHillshadePrepare=!1}}function Et(fe,V,ve,Z){if(fe.renderPass==="translucent"&&ve.paint.get("raster-opacity")!==0&&Z.length)for(var pe=fe.context,Me=pe.gl,Re=V.getSource(),je=fe.useProgram("raster"),ut=fe.colorModeForRenderPass(),Ct=Re instanceof re?[{},Z]:fe.stencilConfigForOverlap(Z),Qt=Ct[0],ur=Ct[1],vr=ur[ur.length-1].overscaledZ,Cr=!fe.options.moving,Vr=0,Wr=ur;Vr<Wr.length;Vr+=1){var Ur=Wr[Vr],Jr=fe.depthModeForSublayer(Ur.overscaledZ-vr,ve.paint.get("raster-opacity")===1?jr.ReadWrite:jr.ReadOnly,Me.LESS),hn=V.getTile(Ur),Cn=fe.transform.calculatePosMatrix(Ur.toUnwrapped(),Cr);hn.registerFadeDuration(ve.paint.get("raster-fade-duration"));var Fn=V.findLoadedParent(Ur,0),Kn=fr(hn,Fn,V,ve,fe.transform),qn=void 0,Qn=void 0,ca=ve.paint.get("raster-resampling")==="nearest"?Me.NEAREST:Me.LINEAR;pe.activeTexture.set(Me.TEXTURE0),hn.texture.bind(ca,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST),pe.activeTexture.set(Me.TEXTURE1),Fn?(Fn.texture.bind(ca,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST),qn=Math.pow(2,Fn.tileID.overscaledZ-hn.tileID.overscaledZ),Qn=[hn.tileID.canonical.x*qn%1,hn.tileID.canonical.y*qn%1]):hn.texture.bind(ca,Me.CLAMP_TO_EDGE,Me.LINEAR_MIPMAP_NEAREST);var ba=qi(Cn,Qn||[0,0],qn||1,Kn,ve);Re instanceof re?je.draw(pe,Me.TRIANGLES,Jr,Jt.disabled,ut,Tt.disabled,ba,ve.id,Re.boundsBuffer,fe.quadTriangleIndexBuffer,Re.boundsSegments):je.draw(pe,Me.TRIANGLES,Jr,Qt[Ur.overscaledZ],ut,Tt.disabled,ba,ve.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments)}}function fr(fe,V,ve,Z,pe){var Me=Z.paint.get("raster-fade-duration");if(Me>0){var Re=e.browser.now(),je=(Re-fe.timeAdded)/Me,ut=V?(Re-V.timeAdded)/Me:-1,Ct=ve.getSource(),Qt=pe.coveringZoomLevel({tileSize:Ct.tileSize,roundZoom:Ct.roundZoom}),ur=!V||Math.abs(V.tileID.overscaledZ-Qt)>Math.abs(fe.tileID.overscaledZ-Qt),vr=ur&&fe.refreshedUponExpiration?1:e.clamp(ur?je:1-ut,0,1);return fe.refreshedUponExpiration&&je>=1&&(fe.refreshedUponExpiration=!1),V?{opacity:1,mix:1-vr}:{opacity:vr,mix:0}}else return{opacity:1,mix:0}}function pr(fe,V,ve){var Z=ve.paint.get("background-color"),pe=ve.paint.get("background-opacity");if(pe!==0){var Me=fe.context,Re=Me.gl,je=fe.transform,ut=je.tileSize,Ct=ve.paint.get("background-pattern");if(!fe.isPatternMissing(Ct)){var Qt=!Ct&&Z.a===1&&pe===1&&fe.opaquePassEnabledForLayer()?"opaque":"translucent";if(fe.renderPass===Qt){var ur=Jt.disabled,vr=fe.depthModeForSublayer(0,Qt==="opaque"?jr.ReadWrite:jr.ReadOnly),Cr=fe.colorModeForRenderPass(),Vr=fe.useProgram(Ct?"backgroundPattern":"background"),Wr=je.coveringTiles({tileSize:ut});Ct&&(Me.activeTexture.set(Re.TEXTURE0),fe.imageManager.bind(fe.context));for(var Ur=ve.getCrossfadeParameters(),Jr=0,hn=Wr;Jr<hn.length;Jr+=1){var Cn=hn[Jr],Fn=fe.transform.calculatePosMatrix(Cn.toUnwrapped()),Kn=Ct?Bl(Fn,pe,fe,Ct,{tileID:Cn,tileSize:ut},Ur):xo(Fn,pe,Z);Vr.draw(Me,Re.TRIANGLES,vr,ur,Cr,Tt.disabled,Kn,ve.id,fe.tileExtentBuffer,fe.quadTriangleIndexBuffer,fe.tileExtentSegments)}}}}}var lr=new e.Color(1,0,0,1),xr=new e.Color(0,1,0,1),Pr=new e.Color(0,0,1,1),Xr=new e.Color(1,0,1,1),qr=new e.Color(0,1,1,1);function bn(fe){var V=fe.transform.padding,ve=3;Wn(fe,fe.transform.height-(V.top||0),ve,lr),Wn(fe,V.bottom||0,ve,xr),ga(fe,V.left||0,ve,Pr),ga(fe,fe.transform.width-(V.right||0),ve,Xr);var Z=fe.transform.centerPoint;Dn(fe,Z.x,fe.transform.height-Z.y,qr)}function Dn(fe,V,ve,Z){var pe=20,Me=2;xa(fe,V-Me/2,ve-pe/2,Me,pe,Z),xa(fe,V-pe/2,ve-Me/2,pe,Me,Z)}function Wn(fe,V,ve,Z){xa(fe,0,V+ve/2,fe.transform.width,ve,Z)}function ga(fe,V,ve,Z){xa(fe,V-ve/2,0,ve,fe.transform.height,Z)}function xa(fe,V,ve,Z,pe,Me){var Re=fe.context,je=Re.gl;je.enable(je.SCISSOR_TEST),je.scissor(V*e.browser.devicePixelRatio,ve*e.browser.devicePixelRatio,Z*e.browser.devicePixelRatio,pe*e.browser.devicePixelRatio),Re.clear({color:Me}),je.disable(je.SCISSOR_TEST)}function Ka(fe,V,ve){for(var Z=0;Z<ve.length;Z++)Ya(fe,V,ve[Z])}function Ya(fe,V,ve){var Z=fe.context,pe=Z.gl,Me=ve.posMatrix,Re=fe.useProgram("debug"),je=jr.disabled,ut=Jt.disabled,Ct=fe.colorModeForRenderPass(),Qt="$debug";Z.activeTexture.set(pe.TEXTURE0),fe.emptyTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),Re.draw(Z,pe.LINE_STRIP,je,ut,Ct,Tt.disabled,dn(Me,e.Color.red),Qt,fe.debugBuffer,fe.tileBorderIndexBuffer,fe.debugSegments);var ur=V.getTileByID(ve.key).latestRawTileData,vr=ur&&ur.byteLength||0,Cr=Math.floor(vr/1024),Vr=V.getTile(ve).tileSize,Wr=512/Math.min(Vr,512)*(ve.overscaledZ/fe.transform.zoom)*.5,Ur=ve.canonical.toString();ve.overscaledZ!==ve.canonical.z&&(Ur+=" => "+ve.overscaledZ);var Jr=Ur+" "+Cr+"kb";ei(fe,Jr),Re.draw(Z,pe.TRIANGLES,je,ut,Je.alphaBlended,Tt.disabled,dn(Me,e.Color.transparent,Wr),Qt,fe.debugBuffer,fe.quadTriangleIndexBuffer,fe.debugSegments)}function ei(fe,V){fe.initDebugOverlayCanvas();var ve=fe.debugOverlayCanvas,Z=fe.context.gl,pe=fe.debugOverlayCanvas.getContext("2d");pe.clearRect(0,0,ve.width,ve.height),pe.shadowColor="white",pe.shadowBlur=2,pe.lineWidth=1.5,pe.strokeStyle="white",pe.textBaseline="top",pe.font="bold 36px Open Sans, sans-serif",pe.fillText(V,5,5),pe.strokeText(V,5,5),fe.debugOverlayTexture.update(ve),fe.debugOverlayTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}function hi(fe,V,ve){var Z=fe.context,pe=ve.implementation;if(fe.renderPass==="offscreen"){var Me=pe.prerender;Me&&(fe.setCustomLayerDefaults(),Z.setColorMode(fe.colorModeForRenderPass()),Me.call(pe,Z.gl,fe.transform.customLayerMatrix()),Z.setDirty(),fe.setBaseState())}else if(fe.renderPass==="translucent"){fe.setCustomLayerDefaults(),Z.setColorMode(fe.colorModeForRenderPass()),Z.setStencilMode(Jt.disabled);var Re=pe.renderingMode==="3d"?new jr(fe.context.gl.LEQUAL,jr.ReadWrite,fe.depthRangeFor3D):fe.depthModeForSublayer(0,jr.ReadOnly);Z.setDepthMode(Re),pe.render(Z.gl,fe.transform.customLayerMatrix()),Z.setDirty(),fe.setBaseState(),Z.bindFramebuffer.set(null)}}var io={symbol:Pu,circle:Fo,heatmap:zu,line:mu,fill:Fu,"fill-extrusion":We,hillshade:ot,raster:Et,background:pr,debug:Ka,custom:hi},ri=function(V,ve){this.context=new zt(V),this.transform=ve,this._tileTextures={},this.setup(),this.numSublayers=Ce.maxUnderzooming+Ce.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ma,this.gpuTimers={}};ri.prototype.resize=function(V,ve){if(this.width=V*e.browser.devicePixelRatio,this.height=ve*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var Z=0,pe=this.style._order;Z<pe.length;Z+=1){var Me=pe[Z];this.style._layers[Me].resize()}},ri.prototype.setup=function(){var V=this.context,ve=new e.StructArrayLayout2i4;ve.emplaceBack(0,0),ve.emplaceBack(e.EXTENT,0),ve.emplaceBack(0,e.EXTENT),ve.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=V.createVertexBuffer(ve,nl.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Z=new e.StructArrayLayout2i4;Z.emplaceBack(0,0),Z.emplaceBack(e.EXTENT,0),Z.emplaceBack(0,e.EXTENT),Z.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=V.createVertexBuffer(Z,nl.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var pe=new e.StructArrayLayout4i8;pe.emplaceBack(0,0,0,0),pe.emplaceBack(e.EXTENT,0,e.EXTENT,0),pe.emplaceBack(0,e.EXTENT,0,e.EXTENT),pe.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=V.createVertexBuffer(pe,Y.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Me=new e.StructArrayLayout2i4;Me.emplaceBack(0,0),Me.emplaceBack(1,0),Me.emplaceBack(0,1),Me.emplaceBack(1,1),this.viewportBuffer=V.createVertexBuffer(Me,nl.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Re=new e.StructArrayLayout1ui2;Re.emplaceBack(0),Re.emplaceBack(1),Re.emplaceBack(3),Re.emplaceBack(2),Re.emplaceBack(0),this.tileBorderIndexBuffer=V.createIndexBuffer(Re);var je=new e.StructArrayLayout3ui6;je.emplaceBack(0,1,2),je.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=V.createIndexBuffer(je),this.emptyTexture=new e.Texture(V,{width:1,height:1,data:new Uint8Array([0,0,0,0])},V.gl.RGBA);var ut=this.context.gl;this.stencilClearMode=new Jt({func:ut.ALWAYS,mask:0},0,255,ut.ZERO,ut.ZERO,ut.ZERO)},ri.prototype.clearStencil=function(){var V=this.context,ve=V.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var Z=e.create();e.ortho(Z,0,this.width,this.height,0,0,1),e.scale(Z,Z,[ve.drawingBufferWidth,ve.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(V,ve.TRIANGLES,jr.disabled,this.stencilClearMode,Je.disabled,Tt.disabled,Ln(Z),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},ri.prototype._renderTileClippingMasks=function(V,ve){if(!(this.currentStencilSource===V.source||!V.isTileClipped()||!ve||!ve.length)){this.currentStencilSource=V.source;var Z=this.context,pe=Z.gl;this.nextStencilID+ve.length>256&&this.clearStencil(),Z.setColorMode(Je.disabled),Z.setDepthMode(jr.disabled);var Me=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var Re=0,je=ve;Re<je.length;Re+=1){var ut=je[Re],Ct=this._tileClippingMaskIDs[ut.key]=this.nextStencilID++;Me.draw(Z,pe.TRIANGLES,jr.disabled,new Jt({func:pe.ALWAYS,mask:0},Ct,255,pe.KEEP,pe.KEEP,pe.REPLACE),Je.disabled,Tt.disabled,Ln(ut.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},ri.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var V=this.nextStencilID++,ve=this.context.gl;return new Jt({func:ve.NOTEQUAL,mask:255},V,255,ve.KEEP,ve.KEEP,ve.REPLACE)},ri.prototype.stencilModeForClipping=function(V){var ve=this.context.gl;return new Jt({func:ve.EQUAL,mask:255},this._tileClippingMaskIDs[V.key],0,ve.KEEP,ve.KEEP,ve.REPLACE)},ri.prototype.stencilConfigForOverlap=function(V){var ve,Z=this.context.gl,pe=V.sort(function(Ct,Qt){return Qt.overscaledZ-Ct.overscaledZ}),Me=pe[pe.length-1].overscaledZ,Re=pe[0].overscaledZ-Me+1;if(Re>1){this.currentStencilSource=void 0,this.nextStencilID+Re>256&&this.clearStencil();for(var je={},ut=0;ut<Re;ut++)je[ut+Me]=new Jt({func:Z.GEQUAL,mask:255},ut+this.nextStencilID,255,Z.KEEP,Z.KEEP,Z.REPLACE);return this.nextStencilID+=Re,[je,pe]}return[(ve={},ve[Me]=Jt.disabled,ve),pe]},ri.prototype.colorModeForRenderPass=function(){var V=this.context.gl;if(this._showOverdrawInspector){var ve=8,Z=1/ve;return new Je([V.CONSTANT_COLOR,V.ONE],new e.Color(Z,Z,Z,0),[!0,!0,!0,!0])}else return this.renderPass==="opaque"?Je.unblended:Je.alphaBlended},ri.prototype.depthModeForSublayer=function(V,ve,Z){if(!this.opaquePassEnabledForLayer())return jr.disabled;var pe=1-((1+this.currentLayer)*this.numSublayers+V)*this.depthEpsilon;return new jr(Z||this.context.gl.LEQUAL,ve,[pe,pe])},ri.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},ri.prototype.render=function(V,ve){var Z=this;this.style=V,this.options=ve,this.lineAtlas=V.lineAtlas,this.imageManager=V.imageManager,this.glyphManager=V.glyphManager,this.symbolFadeChange=V.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var pe=this.style._order,Me=this.style.sourceCaches;for(var Re in Me){var je=Me[Re];je.used&&je.prepare(this.context)}var ut={},Ct={},Qt={};for(var ur in Me){var vr=Me[ur];ut[ur]=vr.getVisibleCoordinates(),Ct[ur]=ut[ur].slice().reverse(),Qt[ur]=vr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Cr=0;Cr<pe.length;Cr++){var Vr=pe[Cr];if(this.style._layers[Vr].is3D()){this.opaquePassCutoff=Cr;break}}this.renderPass="offscreen";for(var Wr=0,Ur=pe;Wr<Ur.length;Wr+=1){var Jr=Ur[Wr],hn=this.style._layers[Jr];if(!(!hn.hasOffscreenPass()||hn.isHidden(this.transform.zoom))){var Cn=Ct[hn.source];hn.type!=="custom"&&!Cn.length||this.renderLayer(this,Me[hn.source],hn,Cn)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:ve.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=ve.showOverdrawInspector,this.depthRangeFor3D=[0,1-(V._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=pe.length-1;this.currentLayer>=0;this.currentLayer--){var Fn=this.style._layers[pe[this.currentLayer]],Kn=Me[Fn.source],qn=ut[Fn.source];this._renderTileClippingMasks(Fn,qn),this.renderLayer(this,Kn,Fn,qn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<pe.length;this.currentLayer++){var Qn=this.style._layers[pe[this.currentLayer]],ca=Me[Qn.source],ba=(Qn.type==="symbol"?Qt:Ct)[Qn.source];this._renderTileClippingMasks(Qn,ut[Qn.source]),this.renderLayer(this,ca,Qn,ba)}if(this.options.showTileBoundaries){var ya,Ta,Ca=e.values(this.style._layers);Ca.forEach(function(Ha){Ha.source&&!Ha.isHidden(Z.transform.zoom)&&(Ha.source!==(Ta&&Ta.id)&&(Ta=Z.style.sourceCaches[Ha.source]),(!ya||ya.getSource().maxzoom<Ta.getSource().maxzoom)&&(ya=Ta))}),ya&&io.debug(this,ya,ya.getVisibleCoordinates())}this.options.showPadding&&bn(this),this.context.setDefault()},ri.prototype.renderLayer=function(V,ve,Z,pe){Z.isHidden(this.transform.zoom)||Z.type!=="background"&&Z.type!=="custom"&&!pe.length||(this.id=Z.id,this.gpuTimingStart(Z),io[Z.type](V,ve,Z,pe,this.style.placement.variableOffsets),this.gpuTimingEnd())},ri.prototype.gpuTimingStart=function(V){if(this.options.gpuTiming){var ve=this.context.extTimerQuery,Z=this.gpuTimers[V.id];Z||(Z=this.gpuTimers[V.id]={calls:0,cpuTime:0,query:ve.createQueryEXT()}),Z.calls++,ve.beginQueryEXT(ve.TIME_ELAPSED_EXT,Z.query)}},ri.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var V=this.context.extTimerQuery;V.endQueryEXT(V.TIME_ELAPSED_EXT)}},ri.prototype.collectGpuTimers=function(){var V=this.gpuTimers;return this.gpuTimers={},V},ri.prototype.queryGpuTimers=function(V){var ve={};for(var Z in V){var pe=V[Z],Me=this.context.extTimerQuery,Re=Me.getQueryObjectEXT(pe.query,Me.QUERY_RESULT_EXT)/(1e3*1e3);Me.deleteQueryEXT(pe.query),ve[Z]=Re}return ve},ri.prototype.translatePosMatrix=function(V,ve,Z,pe,Me){if(!Z[0]&&!Z[1])return V;var Re=Me?pe==="map"?this.transform.angle:0:pe==="viewport"?-this.transform.angle:0;if(Re){var je=Math.sin(Re),ut=Math.cos(Re);Z=[Z[0]*ut-Z[1]*je,Z[0]*je+Z[1]*ut]}var Ct=[Me?Z[0]:An(ve,Z[0],this.transform.zoom),Me?Z[1]:An(ve,Z[1],this.transform.zoom),0],Qt=new Float32Array(16);return e.translate(Qt,V,Ct),Qt},ri.prototype.saveTileTexture=function(V){var ve=this._tileTextures[V.size[0]];ve?ve.push(V):this._tileTextures[V.size[0]]=[V]},ri.prototype.getTileTexture=function(V){var ve=this._tileTextures[V];return ve&&ve.length>0?ve.pop():null},ri.prototype.isPatternMissing=function(V){if(!V)return!1;if(!V.from||!V.to)return!0;var ve=this.imageManager.getPattern(V.from.toString()),Z=this.imageManager.getPattern(V.to.toString());return!ve||!Z},ri.prototype.useProgram=function(V,ve){this.cache=this.cache||{};var Z=""+V+(ve?ve.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[Z]||(this.cache[Z]=new Qo(this.context,fl[V],ve,Ql[V],this._showOverdrawInspector)),this.cache[Z]},ri.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},ri.prototype.setBaseState=function(){var V=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(V.FUNC_ADD)},ri.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var V=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,V.RGBA)}},ri.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Vi=function(V,ve){this.points=V,this.planes=ve};Vi.fromInvProjectionMatrix=function(V,ve,Z){var pe=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],Me=Math.pow(2,Z),Re=pe.map(function(Ct){return e.transformMat4([],Ct,V)}).map(function(Ct){return e.scale$1([],Ct,1/Ct[3]/ve*Me)}),je=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],ut=je.map(function(Ct){var Qt=e.sub([],Re[Ct[0]],Re[Ct[1]]),ur=e.sub([],Re[Ct[2]],Re[Ct[1]]),vr=e.normalize([],e.cross([],Qt,ur)),Cr=-e.dot(vr,Re[Ct[1]]);return vr.concat(Cr)});return new Vi(Re,ut)};var fo=function(V,ve){this.min=V,this.max=ve,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};fo.prototype.quadrant=function(V){for(var ve=[V%2===0,V<2],Z=e.clone$2(this.min),pe=e.clone$2(this.max),Me=0;Me<ve.length;Me++)Z[Me]=ve[Me]?this.min[Me]:this.center[Me],pe[Me]=ve[Me]?this.center[Me]:this.max[Me];return pe[2]=this.max[2],new fo(Z,pe)},fo.prototype.distanceX=function(V){var ve=Math.max(Math.min(this.max[0],V[0]),this.min[0]);return ve-V[0]},fo.prototype.distanceY=function(V){var ve=Math.max(Math.min(this.max[1],V[1]),this.min[1]);return ve-V[1]},fo.prototype.intersects=function(V){for(var ve=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],Z=!0,pe=0;pe<V.planes.length;pe++){for(var Me=V.planes[pe],Re=0,je=0;je<ve.length;je++)Re+=e.dot$1(Me,ve[je])>=0;if(Re===0)return 0;Re!==ve.length&&(Z=!1)}if(Z)return 2;for(var ut=0;ut<3;ut++){for(var Ct=Number.MAX_VALUE,Qt=-Number.MAX_VALUE,ur=0;ur<V.points.length;ur++){var vr=V.points[ur][ut]-this.min[ut];Ct=Math.min(Ct,vr),Qt=Math.max(Qt,vr)}if(Qt<0||Ct>this.max[ut]-this.min[ut])return 0}return 1};var _o=function(V,ve,Z,pe){if(V===void 0&&(V=0),ve===void 0&&(ve=0),Z===void 0&&(Z=0),pe===void 0&&(pe=0),isNaN(V)||V<0||isNaN(ve)||ve<0||isNaN(Z)||Z<0||isNaN(pe)||pe<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=V,this.bottom=ve,this.left=Z,this.right=pe};_o.prototype.interpolate=function(V,ve,Z){return ve.top!=null&&V.top!=null&&(this.top=e.number(V.top,ve.top,Z)),ve.bottom!=null&&V.bottom!=null&&(this.bottom=e.number(V.bottom,ve.bottom,Z)),ve.left!=null&&V.left!=null&&(this.left=e.number(V.left,ve.left,Z)),ve.right!=null&&V.right!=null&&(this.right=e.number(V.right,ve.right,Z)),this},_o.prototype.getCenter=function(V,ve){var Z=e.clamp((this.left+V-this.right)/2,0,V),pe=e.clamp((this.top+ve-this.bottom)/2,0,ve);return new e.Point(Z,pe)},_o.prototype.equals=function(V){return this.top===V.top&&this.bottom===V.bottom&&this.left===V.left&&this.right===V.right},_o.prototype.clone=function(){return new _o(this.top,this.bottom,this.left,this.right)},_o.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var bi=function(V,ve,Z,pe,Me){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=Me===void 0?!0:Me,this._minZoom=V||0,this._maxZoom=ve||22,this._minPitch=Z??0,this._maxPitch=pe??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new _o,this._posMatrixCache={},this._alignedPosMatrixCache={}},Mi={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};bi.prototype.clone=function(){var V=new bi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return V.tileSize=this.tileSize,V.latRange=this.latRange,V.width=this.width,V.height=this.height,V._center=this._center,V.zoom=this.zoom,V.angle=this.angle,V._fov=this._fov,V._pitch=this._pitch,V._unmodified=this._unmodified,V._edgeInsets=this._edgeInsets.clone(),V._calcMatrices(),V},Mi.minZoom.get=function(){return this._minZoom},Mi.minZoom.set=function(fe){this._minZoom!==fe&&(this._minZoom=fe,this.zoom=Math.max(this.zoom,fe))},Mi.maxZoom.get=function(){return this._maxZoom},Mi.maxZoom.set=function(fe){this._maxZoom!==fe&&(this._maxZoom=fe,this.zoom=Math.min(this.zoom,fe))},Mi.minPitch.get=function(){return this._minPitch},Mi.minPitch.set=function(fe){this._minPitch!==fe&&(this._minPitch=fe,this.pitch=Math.max(this.pitch,fe))},Mi.maxPitch.get=function(){return this._maxPitch},Mi.maxPitch.set=function(fe){this._maxPitch!==fe&&(this._maxPitch=fe,this.pitch=Math.min(this.pitch,fe))},Mi.renderWorldCopies.get=function(){return this._renderWorldCopies},Mi.renderWorldCopies.set=function(fe){fe===void 0?fe=!0:fe===null&&(fe=!1),this._renderWorldCopies=fe},Mi.worldSize.get=function(){return this.tileSize*this.scale},Mi.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Mi.size.get=function(){return new e.Point(this.width,this.height)},Mi.bearing.get=function(){return-this.angle/Math.PI*180},Mi.bearing.set=function(fe){var V=-e.wrap(fe,-180,180)*Math.PI/180;this.angle!==V&&(this._unmodified=!1,this.angle=V,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Mi.pitch.get=function(){return this._pitch/Math.PI*180},Mi.pitch.set=function(fe){var V=e.clamp(fe,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==V&&(this._unmodified=!1,this._pitch=V,this._calcMatrices())},Mi.fov.get=function(){return this._fov/Math.PI*180},Mi.fov.set=function(fe){fe=Math.max(.01,Math.min(60,fe)),this._fov!==fe&&(this._unmodified=!1,this._fov=fe/180*Math.PI,this._calcMatrices())},Mi.zoom.get=function(){return this._zoom},Mi.zoom.set=function(fe){var V=Math.min(Math.max(fe,this.minZoom),this.maxZoom);this._zoom!==V&&(this._unmodified=!1,this._zoom=V,this.scale=this.zoomScale(V),this.tileZoom=Math.floor(V),this.zoomFraction=V-this.tileZoom,this._constrain(),this._calcMatrices())},Mi.center.get=function(){return this._center},Mi.center.set=function(fe){fe.lat===this._center.lat&&fe.lng===this._center.lng||(this._unmodified=!1,this._center=fe,this._constrain(),this._calcMatrices())},Mi.padding.get=function(){return this._edgeInsets.toJSON()},Mi.padding.set=function(fe){this._edgeInsets.equals(fe)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,fe,1),this._calcMatrices())},Mi.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},bi.prototype.isPaddingEqual=function(V){return this._edgeInsets.equals(V)},bi.prototype.interpolatePadding=function(V,ve,Z){this._unmodified=!1,this._edgeInsets.interpolate(V,ve,Z),this._constrain(),this._calcMatrices()},bi.prototype.coveringZoomLevel=function(V){var ve=(V.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/V.tileSize));return Math.max(0,ve)},bi.prototype.getVisibleUnwrappedCoordinates=function(V){var ve=[new e.UnwrappedTileID(0,V)];if(this._renderWorldCopies)for(var Z=this.pointCoordinate(new e.Point(0,0)),pe=this.pointCoordinate(new e.Point(this.width,0)),Me=this.pointCoordinate(new e.Point(this.width,this.height)),Re=this.pointCoordinate(new e.Point(0,this.height)),je=Math.floor(Math.min(Z.x,pe.x,Me.x,Re.x)),ut=Math.floor(Math.max(Z.x,pe.x,Me.x,Re.x)),Ct=1,Qt=je-Ct;Qt<=ut+Ct;Qt++)Qt!==0&&ve.push(new e.UnwrappedTileID(Qt,V));return ve},bi.prototype.coveringTiles=function(V){var ve=this.coveringZoomLevel(V),Z=ve;if(V.minzoom!==void 0&&ve<V.minzoom)return[];V.maxzoom!==void 0&&ve>V.maxzoom&&(ve=V.maxzoom);var pe=e.MercatorCoordinate.fromLngLat(this.center),Me=Math.pow(2,ve),Re=[Me*pe.x,Me*pe.y,0],je=Vi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,ve),ut=V.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ut=ve);var Ct=3,Qt=function(Ca){return{aabb:new fo([Ca*Me,0,0],[(Ca+1)*Me,Me,0]),zoom:0,x:0,y:0,wrap:Ca,fullyVisible:!1}},ur=[],vr=[],Cr=ve,Vr=V.reparseOverscaled?Z:ve;if(this._renderWorldCopies)for(var Wr=1;Wr<=3;Wr++)ur.push(Qt(-Wr)),ur.push(Qt(Wr));for(ur.push(Qt(0));ur.length>0;){var Ur=ur.pop(),Jr=Ur.x,hn=Ur.y,Cn=Ur.fullyVisible;if(!Cn){var Fn=Ur.aabb.intersects(je);if(Fn===0)continue;Cn=Fn===2}var Kn=Ur.aabb.distanceX(Re),qn=Ur.aabb.distanceY(Re),Qn=Math.max(Math.abs(Kn),Math.abs(qn)),ca=Ct+(1<<Cr-Ur.zoom)-2;if(Ur.zoom===Cr||Qn>ca&&Ur.zoom>=ut){vr.push({tileID:new e.OverscaledTileID(Ur.zoom===Cr?Vr:Ur.zoom,Ur.wrap,Ur.zoom,Jr,hn),distanceSq:e.sqrLen([Re[0]-.5-Jr,Re[1]-.5-hn])});continue}for(var ba=0;ba<4;ba++){var ya=(Jr<<1)+ba%2,Ta=(hn<<1)+(ba>>1);ur.push({aabb:Ur.aabb.quadrant(ba),zoom:Ur.zoom+1,x:ya,y:Ta,wrap:Ur.wrap,fullyVisible:Cn})}}return vr.sort(function(Ca,Ha){return Ca.distanceSq-Ha.distanceSq}).map(function(Ca){return Ca.tileID})},bi.prototype.resize=function(V,ve){this.width=V,this.height=ve,this.pixelsToGLUnits=[2/V,-2/ve],this._constrain(),this._calcMatrices()},Mi.unmodified.get=function(){return this._unmodified},bi.prototype.zoomScale=function(V){return Math.pow(2,V)},bi.prototype.scaleZoom=function(V){return Math.log(V)/Math.LN2},bi.prototype.project=function(V){var ve=e.clamp(V.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(V.lng)*this.worldSize,e.mercatorYfromLat(ve)*this.worldSize)},bi.prototype.unproject=function(V){return new e.MercatorCoordinate(V.x/this.worldSize,V.y/this.worldSize).toLngLat()},Mi.point.get=function(){return this.project(this.center)},bi.prototype.setLocationAtPoint=function(V,ve){var Z=this.pointCoordinate(ve),pe=this.pointCoordinate(this.centerPoint),Me=this.locationCoordinate(V),Re=new e.MercatorCoordinate(Me.x-(Z.x-pe.x),Me.y-(Z.y-pe.y));this.center=this.coordinateLocation(Re),this._renderWorldCopies&&(this.center=this.center.wrap())},bi.prototype.locationPoint=function(V){return this.coordinatePoint(this.locationCoordinate(V))},bi.prototype.pointLocation=function(V){return this.coordinateLocation(this.pointCoordinate(V))},bi.prototype.locationCoordinate=function(V){return e.MercatorCoordinate.fromLngLat(V)},bi.prototype.coordinateLocation=function(V){return V.toLngLat()},bi.prototype.pointCoordinate=function(V){var ve=0,Z=[V.x,V.y,0,1],pe=[V.x,V.y,1,1];e.transformMat4(Z,Z,this.pixelMatrixInverse),e.transformMat4(pe,pe,this.pixelMatrixInverse);var Me=Z[3],Re=pe[3],je=Z[0]/Me,ut=pe[0]/Re,Ct=Z[1]/Me,Qt=pe[1]/Re,ur=Z[2]/Me,vr=pe[2]/Re,Cr=ur===vr?0:(ve-ur)/(vr-ur);return new e.MercatorCoordinate(e.number(je,ut,Cr)/this.worldSize,e.number(Ct,Qt,Cr)/this.worldSize)},bi.prototype.coordinatePoint=function(V){var ve=[V.x*this.worldSize,V.y*this.worldSize,0,1];return e.transformMat4(ve,ve,this.pixelMatrix),new e.Point(ve[0]/ve[3],ve[1]/ve[3])},bi.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},bi.prototype.getMaxBounds=function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])},bi.prototype.setMaxBounds=function(V){V?(this.lngRange=[V.getWest(),V.getEast()],this.latRange=[V.getSouth(),V.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},bi.prototype.calculatePosMatrix=function(V,ve){ve===void 0&&(ve=!1);var Z=V.key,pe=ve?this._alignedPosMatrixCache:this._posMatrixCache;if(pe[Z])return pe[Z];var Me=V.canonical,Re=this.worldSize/this.zoomScale(Me.z),je=Me.x+Math.pow(2,Me.z)*V.wrap,ut=e.identity(new Float64Array(16));return e.translate(ut,ut,[je*Re,Me.y*Re,0]),e.scale(ut,ut,[Re/e.EXTENT,Re/e.EXTENT,1]),e.multiply(ut,ve?this.alignedProjMatrix:this.projMatrix,ut),pe[Z]=new Float32Array(ut),pe[Z]},bi.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},bi.prototype._constrain=function(){if(!(!this.center||!this.width||!this.height||this._constraining)){this._constraining=!0;var V=-90,ve=90,Z=-180,pe=180,Me,Re,je,ut,Ct=this.size,Qt=this._unmodified;if(this.latRange){var ur=this.latRange;V=e.mercatorYfromLat(ur[1])*this.worldSize,ve=e.mercatorYfromLat(ur[0])*this.worldSize,Me=ve-V<Ct.y?Ct.y/(ve-V):0}if(this.lngRange){var vr=this.lngRange;Z=e.mercatorXfromLng(vr[0])*this.worldSize,pe=e.mercatorXfromLng(vr[1])*this.worldSize,Re=pe-Z<Ct.x?Ct.x/(pe-Z):0}var Cr=this.point,Vr=Math.max(Re||0,Me||0);if(Vr){this.center=this.unproject(new e.Point(Re?(pe+Z)/2:Cr.x,Me?(ve+V)/2:Cr.y)),this.zoom+=this.scaleZoom(Vr),this._unmodified=Qt,this._constraining=!1;return}if(this.latRange){var Wr=Cr.y,Ur=Ct.y/2;Wr-Ur<V&&(ut=V+Ur),Wr+Ur>ve&&(ut=ve-Ur)}if(this.lngRange){var Jr=Cr.x,hn=Ct.x/2;Jr-hn<Z&&(je=Z+hn),Jr+hn>pe&&(je=pe-hn)}(je!==void 0||ut!==void 0)&&(this.center=this.unproject(new e.Point(je!==void 0?je:Cr.x,ut!==void 0?ut:Cr.y))),this._unmodified=Qt,this._constraining=!1}},bi.prototype._calcMatrices=function(){if(this.height){var V=this._fov/2,ve=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(V)*this.height;var Z=Math.PI/2+this._pitch,pe=this._fov*(.5+ve.y/this.height),Me=Math.sin(pe)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-Z-pe,.01,Math.PI-.01)),Re=this.point,je=Re.x,ut=Re.y,Ct=Math.cos(Math.PI/2-this._pitch)*Me+this.cameraToCenterDistance,Qt=Ct*1.01,ur=this.height/50,vr=new Float64Array(16);e.perspective(vr,this._fov,this.width/this.height,ur,Qt),vr[8]=-ve.x*2/this.width,vr[9]=ve.y*2/this.height,e.scale(vr,vr,[1,-1,1]),e.translate(vr,vr,[0,0,-this.cameraToCenterDistance]),e.rotateX(vr,vr,this._pitch),e.rotateZ(vr,vr,this.angle),e.translate(vr,vr,[-je,-ut,0]),this.mercatorMatrix=e.scale([],vr,[this.worldSize,this.worldSize,this.worldSize]),e.scale(vr,vr,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=vr,this.invProjMatrix=e.invert([],this.projMatrix);var Cr=this.width%2/2,Vr=this.height%2/2,Wr=Math.cos(this.angle),Ur=Math.sin(this.angle),Jr=je-Math.round(je)+Wr*Cr+Ur*Vr,hn=ut-Math.round(ut)+Wr*Vr+Ur*Cr,Cn=new Float64Array(vr);if(e.translate(Cn,Cn,[Jr>.5?Jr-1:Jr,hn>.5?hn-1:hn,0]),this.alignedProjMatrix=Cn,vr=e.create(),e.scale(vr,vr,[this.width/2,-this.height/2,1]),e.translate(vr,vr,[1,-1,0]),this.labelPlaneMatrix=vr,vr=e.create(),e.scale(vr,vr,[1,-1,1]),e.translate(vr,vr,[-1,-1,0]),e.scale(vr,vr,[2/this.width,2/this.height,1]),this.glCoordMatrix=vr,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),vr=e.invert(new Float64Array(16),this.pixelMatrix),!vr)throw new Error("failed to invert matrix");this.pixelMatrixInverse=vr,this._posMatrixCache={},this._alignedPosMatrixCache={}}},bi.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var V=this.pointCoordinate(new e.Point(0,0)),ve=[V.x*this.worldSize,V.y*this.worldSize,0,1],Z=e.transformMat4(ve,ve,this.pixelMatrix);return Z[3]/this.cameraToCenterDistance},bi.prototype.getCameraPoint=function(){var V=this._pitch,ve=Math.tan(V)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,ve))},bi.prototype.getCameraQueryGeometry=function(V){var ve=this.getCameraPoint();if(V.length===1)return[V[0],ve];for(var Z=ve.x,pe=ve.y,Me=ve.x,Re=ve.y,je=0,ut=V;je<ut.length;je+=1){var Ct=ut[je];Z=Math.min(Z,Ct.x),pe=Math.min(pe,Ct.y),Me=Math.max(Me,Ct.x),Re=Math.max(Re,Ct.y)}return[new e.Point(Z,pe),new e.Point(Me,pe),new e.Point(Me,Re),new e.Point(Z,Re),new e.Point(Z,pe)]},Object.defineProperties(bi.prototype,Mi);function fs(fe,V){var ve=!1,Z=null,pe=function(){Z=null,ve&&(fe(),Z=setTimeout(pe,V),ve=!1)};return function(){return ve=!0,Z||pe(),Z}}var go=function(V){this._hashName=V&&encodeURIComponent(V),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=fs(this._updateHashUnthrottled.bind(this),30*1e3/100)};go.prototype.addTo=function(V){return this._map=V,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},go.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},go.prototype.getHashString=function(V){var ve=this._map.getCenter(),Z=Math.round(this._map.getZoom()*100)/100,pe=Math.ceil((Z*Math.LN2+Math.log(512/360/.5))/Math.LN10),Me=Math.pow(10,pe),Re=Math.round(ve.lng*Me)/Me,je=Math.round(ve.lat*Me)/Me,ut=this._map.getBearing(),Ct=this._map.getPitch(),Qt="";if(V?Qt+="/"+Re+"/"+je+"/"+Z:Qt+=Z+"/"+je+"/"+Re,(ut||Ct)&&(Qt+="/"+Math.round(ut*10)/10),Ct&&(Qt+="/"+Math.round(Ct)),this._hashName){var ur=this._hashName,vr=!1,Cr=e.window.location.hash.slice(1).split("&").map(function(Vr){var Wr=Vr.split("=")[0];return Wr===ur?(vr=!0,Wr+"="+Qt):Vr}).filter(function(Vr){return Vr});return vr||Cr.push(ur+"="+Qt),"#"+Cr.join("&")}return"#"+Qt},go.prototype._getCurrentHash=function(){var V=this,ve=e.window.location.hash.replace("#","");if(this._hashName){var Z;return ve.split("&").map(function(pe){return pe.split("=")}).forEach(function(pe){pe[0]===V._hashName&&(Z=pe)}),(Z&&Z[1]||"").split("/")}return ve.split("/")},go.prototype._onHashChange=function(){var V=this._getCurrentHash();if(V.length>=3&&!V.some(function(Z){return isNaN(Z)})){var ve=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(V[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+V[2],+V[1]],zoom:+V[0],bearing:ve,pitch:+(V[4]||0)}),!0}return!1},go.prototype._updateHashUnthrottled=function(){var V=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",V)}catch{}};var Po={linearity:.3,easing:e.bezier(0,0,.3,1)},Go=e.extend({deceleration:2500,maxSpeed:1400},Po),le=e.extend({deceleration:20,maxSpeed:1400},Po),_e=e.extend({deceleration:1e3,maxSpeed:360},Po),Le=e.extend({deceleration:1e3,maxSpeed:90},Po),Be=function(V){this._map=V,this.clear()};Be.prototype.clear=function(){this._inertiaBuffer=[]},Be.prototype.record=function(V){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:V})},Be.prototype._drainInertiaBuffer=function(){for(var V=this._inertiaBuffer,ve=e.browser.now(),Z=160;V.length>0&&ve-V[0].time>Z;)V.shift()},Be.prototype._onMoveEnd=function(V){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var ve={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},Z=0,pe=this._inertiaBuffer;Z<pe.length;Z+=1){var Me=pe[Z],Re=Me.settings;ve.zoom+=Re.zoomDelta||0,ve.bearing+=Re.bearingDelta||0,ve.pitch+=Re.pitchDelta||0,Re.panDelta&&ve.pan._add(Re.panDelta),Re.around&&(ve.around=Re.around),Re.pinchAround&&(ve.pinchAround=Re.pinchAround)}var je=this._inertiaBuffer[this._inertiaBuffer.length-1],ut=je.time-this._inertiaBuffer[0].time,Ct={};if(ve.pan.mag()){var Qt=Ke(ve.pan.mag(),ut,e.extend({},Go,V||{}));Ct.offset=ve.pan.mult(Qt.amount/ve.pan.mag()),Ct.center=this._map.transform.center,Oe(Ct,Qt)}if(ve.zoom){var ur=Ke(ve.zoom,ut,le);Ct.zoom=this._map.transform.zoom+ur.amount,Oe(Ct,ur)}if(ve.bearing){var vr=Ke(ve.bearing,ut,_e);Ct.bearing=this._map.transform.bearing+e.clamp(vr.amount,-179,179),Oe(Ct,vr)}if(ve.pitch){var Cr=Ke(ve.pitch,ut,Le);Ct.pitch=this._map.transform.pitch+Cr.amount,Oe(Ct,Cr)}if(Ct.zoom||Ct.bearing){var Vr=ve.pinchAround===void 0?ve.around:ve.pinchAround;Ct.around=Vr?this._map.unproject(Vr):this._map.getCenter()}return this.clear(),e.extend(Ct,{noMoveStart:!0})}};function Oe(fe,V){(!fe.duration||fe.duration<V.duration)&&(fe.duration=V.duration,fe.easing=V.easing)}function Ke(fe,V,ve){var Z=ve.maxSpeed,pe=ve.linearity,Me=ve.deceleration,Re=e.clamp(fe*pe/(V/1e3),-Z,Z),je=Math.abs(Re)/(Me*pe);return{easing:ve.easing,duration:je*1e3,amount:Re*(je/2)}}var xt=function(fe){function V(Z,pe,Me,Re){Re===void 0&&(Re={});var je=n.mousePos(pe.getCanvasContainer(),Me),ut=pe.unproject(je);fe.call(this,Z,e.extend({point:je,lngLat:ut,originalEvent:Me},Re)),this._defaultPrevented=!1,this.target=pe}fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V;var ve={defaultPrevented:{configurable:!0}};return V.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(V.prototype,ve),V}(e.Event),ht=function(fe){function V(Z,pe,Me){var Re=Z==="touchend"?Me.changedTouches:Me.touches,je=n.touchPos(pe.getCanvasContainer(),Re),ut=je.map(function(ur){return pe.unproject(ur)}),Ct=je.reduce(function(ur,vr,Cr,Vr){return ur.add(vr.div(Vr.length))},new e.Point(0,0)),Qt=pe.unproject(Ct);fe.call(this,Z,{points:je,point:Ct,lngLats:ut,lngLat:Qt,originalEvent:Me}),this._defaultPrevented=!1}fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V;var ve={defaultPrevented:{configurable:!0}};return V.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(V.prototype,ve),V}(e.Event),Pt=function(fe){function V(Z,pe,Me){fe.call(this,Z,{originalEvent:Me}),this._defaultPrevented=!1}fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V;var ve={defaultPrevented:{configurable:!0}};return V.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(V.prototype,ve),V}(e.Event),jt=function(V,ve){this._map=V,this._clickTolerance=ve.clickTolerance};jt.prototype.reset=function(){delete this._mousedownPos},jt.prototype.wheel=function(V){return this._firePreventable(new Pt(V.type,this._map,V))},jt.prototype.mousedown=function(V,ve){return this._mousedownPos=ve,this._firePreventable(new xt(V.type,this._map,V))},jt.prototype.mouseup=function(V){this._map.fire(new xt(V.type,this._map,V))},jt.prototype.click=function(V,ve){this._mousedownPos&&this._mousedownPos.dist(ve)>=this._clickTolerance||this._map.fire(new xt(V.type,this._map,V))},jt.prototype.dblclick=function(V){return this._firePreventable(new xt(V.type,this._map,V))},jt.prototype.mouseover=function(V){this._map.fire(new xt(V.type,this._map,V))},jt.prototype.mouseout=function(V){this._map.fire(new xt(V.type,this._map,V))},jt.prototype.touchstart=function(V){return this._firePreventable(new ht(V.type,this._map,V))},jt.prototype.touchmove=function(V){this._map.fire(new ht(V.type,this._map,V))},jt.prototype.touchend=function(V){this._map.fire(new ht(V.type,this._map,V))},jt.prototype.touchcancel=function(V){this._map.fire(new ht(V.type,this._map,V))},jt.prototype._firePreventable=function(V){if(this._map.fire(V),V.defaultPrevented)return{}},jt.prototype.isEnabled=function(){return!0},jt.prototype.isActive=function(){return!1},jt.prototype.enable=function(){},jt.prototype.disable=function(){};var er=function(V){this._map=V};er.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},er.prototype.mousemove=function(V){this._map.fire(new xt(V.type,this._map,V))},er.prototype.mousedown=function(){this._delayContextMenu=!0},er.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xt("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},er.prototype.contextmenu=function(V){this._delayContextMenu?this._contextMenuEvent=V:this._map.fire(new xt(V.type,this._map,V)),this._map.listens("contextmenu")&&V.preventDefault()},er.prototype.isEnabled=function(){return!0},er.prototype.isActive=function(){return!1},er.prototype.enable=function(){},er.prototype.disable=function(){};var tr=function(V,ve){this._map=V,this._el=V.getCanvasContainer(),this._container=V.getContainer(),this._clickTolerance=ve.clickTolerance||1};tr.prototype.isEnabled=function(){return!!this._enabled},tr.prototype.isActive=function(){return!!this._active},tr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},tr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},tr.prototype.mousedown=function(V,ve){this.isEnabled()&&V.shiftKey&&V.button===0&&(n.disableDrag(),this._startPos=this._lastPos=ve,this._active=!0)},tr.prototype.mousemoveWindow=function(V,ve){if(this._active){var Z=ve;if(!(this._lastPos.equals(Z)||!this._box&&Z.dist(this._startPos)<this._clickTolerance)){var pe=this._startPos;this._lastPos=Z,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",V));var Me=Math.min(pe.x,Z.x),Re=Math.max(pe.x,Z.x),je=Math.min(pe.y,Z.y),ut=Math.max(pe.y,Z.y);n.setTransform(this._box,"translate("+Me+"px,"+je+"px)"),this._box.style.width=Re-Me+"px",this._box.style.height=ut-je+"px"}}},tr.prototype.mouseupWindow=function(V,ve){var Z=this;if(this._active&&V.button===0){var pe=this._startPos,Me=ve;if(this.reset(),n.suppressClick(),pe.x===Me.x&&pe.y===Me.y)this._fireEvent("boxzoomcancel",V);else return this._map.fire(new e.Event("boxzoomend",{originalEvent:V})),{cameraAnimation:function(Re){return Re.fitScreenCoordinates(pe,Me,Z._map.getBearing(),{linear:!0})}}}},tr.prototype.keydown=function(V){this._active&&V.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",V))},tr.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},tr.prototype._fireEvent=function(V,ve){return this._map.fire(new e.Event(V,{originalEvent:ve}))};function Ar(fe,V){for(var ve={},Z=0;Z<fe.length;Z++)ve[fe[Z].identifier]=V[Z];return ve}function Qr(fe){for(var V=new e.Point(0,0),ve=0,Z=fe;ve<Z.length;ve+=1){var pe=Z[ve];V._add(pe)}return V.div(fe.length)}var ln=500,Lr=500,Nr=30,Zr=function(V){this.reset(),this.numTouches=V.numTouches};Zr.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Zr.prototype.touchstart=function(V,ve,Z){(this.centroid||Z.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=V.timeStamp),Z.length===this.numTouches&&(this.centroid=Qr(ve),this.touches=Ar(Z,ve)))},Zr.prototype.touchmove=function(V,ve,Z){if(!(this.aborted||!this.centroid)){var pe=Ar(Z,ve);for(var Me in this.touches){var Re=this.touches[Me],je=pe[Me];(!je||je.dist(Re)>Nr)&&(this.aborted=!0)}}},Zr.prototype.touchend=function(V,ve,Z){if((!this.centroid||V.timeStamp-this.startTime>Lr)&&(this.aborted=!0),Z.length===0){var pe=!this.aborted&&this.centroid;if(this.reset(),pe)return pe}};var nn=function(V){this.singleTap=new Zr(V),this.numTaps=V.numTaps,this.reset()};nn.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},nn.prototype.touchstart=function(V,ve,Z){this.singleTap.touchstart(V,ve,Z)},nn.prototype.touchmove=function(V,ve,Z){this.singleTap.touchmove(V,ve,Z)},nn.prototype.touchend=function(V,ve,Z){var pe=this.singleTap.touchend(V,ve,Z);if(pe){var Me=V.timeStamp-this.lastTime<ln,Re=!this.lastTap||this.lastTap.dist(pe)<Nr;if((!Me||!Re)&&this.reset(),this.count++,this.lastTime=V.timeStamp,this.lastTap=pe,this.count===this.numTaps)return this.reset(),pe}};var on=function(){this._zoomIn=new nn({numTouches:1,numTaps:2}),this._zoomOut=new nn({numTouches:2,numTaps:1}),this.reset()};on.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},on.prototype.touchstart=function(V,ve,Z){this._zoomIn.touchstart(V,ve,Z),this._zoomOut.touchstart(V,ve,Z)},on.prototype.touchmove=function(V,ve,Z){this._zoomIn.touchmove(V,ve,Z),this._zoomOut.touchmove(V,ve,Z)},on.prototype.touchend=function(V,ve,Z){var pe=this,Me=this._zoomIn.touchend(V,ve,Z),Re=this._zoomOut.touchend(V,ve,Z);if(Me)return this._active=!0,V.preventDefault(),setTimeout(function(){return pe.reset()},0),{cameraAnimation:function(je){return je.easeTo({duration:300,zoom:je.getZoom()+1,around:je.unproject(Me)},{originalEvent:V})}};if(Re)return this._active=!0,V.preventDefault(),setTimeout(function(){return pe.reset()},0),{cameraAnimation:function(je){return je.easeTo({duration:300,zoom:je.getZoom()-1,around:je.unproject(Re)},{originalEvent:V})}}},on.prototype.touchcancel=function(){this.reset()},on.prototype.enable=function(){this._enabled=!0},on.prototype.disable=function(){this._enabled=!1,this.reset()},on.prototype.isEnabled=function(){return this._enabled},on.prototype.isActive=function(){return this._active};var Kr=0,Un=2,ra=function(V){this.reset(),this._clickTolerance=V.clickTolerance||1};ra.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},ra.prototype._correctButton=function(V,ve){return!1},ra.prototype._move=function(V,ve){return{}},ra.prototype.mousedown=function(V,ve){if(!this._lastPoint){var Z=n.mouseButton(V);this._correctButton(V,Z)&&(this._lastPoint=ve,this._eventButton=Z)}},ra.prototype.mousemoveWindow=function(V,ve){var Z=this._lastPoint;if(Z&&(V.preventDefault(),!(!this._moved&&ve.dist(Z)<this._clickTolerance)))return this._moved=!0,this._lastPoint=ve,this._move(Z,ve)},ra.prototype.mouseupWindow=function(V){var ve=n.mouseButton(V);ve===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},ra.prototype.enable=function(){this._enabled=!0},ra.prototype.disable=function(){this._enabled=!1,this.reset()},ra.prototype.isEnabled=function(){return this._enabled},ra.prototype.isActive=function(){return this._active};var _a=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.mousedown=function(Z,pe){fe.prototype.mousedown.call(this,Z,pe),this._lastPoint&&(this._active=!0)},V.prototype._correctButton=function(Z,pe){return pe===Kr&&!Z.ctrlKey},V.prototype._move=function(Z,pe){return{around:pe,panDelta:pe.sub(Z)}},V}(ra),ia=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype._correctButton=function(Z,pe){return pe===Kr&&Z.ctrlKey||pe===Un},V.prototype._move=function(Z,pe){var Me=.8,Re=(pe.x-Z.x)*Me;if(Re)return this._active=!0,{bearingDelta:Re}},V.prototype.contextmenu=function(Z){Z.preventDefault()},V}(ra),ka=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype._correctButton=function(Z,pe){return pe===Kr&&Z.ctrlKey||pe===Un},V.prototype._move=function(Z,pe){var Me=-.5,Re=(pe.y-Z.y)*Me;if(Re)return this._active=!0,{pitchDelta:Re}},V.prototype.contextmenu=function(Z){Z.preventDefault()},V}(ra),la=function(V){this._minTouches=1,this._clickTolerance=V.clickTolerance||1,this.reset()};la.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},la.prototype.touchstart=function(V,ve,Z){return this._calculateTransform(V,ve,Z)},la.prototype.touchmove=function(V,ve,Z){if(this._active)return V.preventDefault(),this._calculateTransform(V,ve,Z)},la.prototype.touchend=function(V,ve,Z){this._calculateTransform(V,ve,Z),this._active&&Z.length<this._minTouches&&this.reset()},la.prototype.touchcancel=function(){this.reset()},la.prototype._calculateTransform=function(V,ve,Z){Z.length>0&&(this._active=!0);var pe=Ar(Z,ve),Me=new e.Point(0,0),Re=new e.Point(0,0),je=0;for(var ut in pe){var Ct=pe[ut],Qt=this._touches[ut];Qt&&(Me._add(Ct),Re._add(Ct.sub(Qt)),je++,pe[ut]=Ct)}if(this._touches=pe,!(je<this._minTouches||!Re.mag())){var ur=Re.div(je);if(this._sum._add(ur),!(this._sum.mag()<this._clickTolerance)){var vr=Me.div(je);return{around:vr,panDelta:ur}}}},la.prototype.enable=function(){this._enabled=!0},la.prototype.disable=function(){this._enabled=!1,this.reset()},la.prototype.isEnabled=function(){return this._enabled},la.prototype.isActive=function(){return this._active};var Na=function(){this.reset()};Na.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Na.prototype._start=function(V){},Na.prototype._move=function(V,ve,Z){return{}},Na.prototype.touchstart=function(V,ve,Z){this._firstTwoTouches||Z.length<2||(this._firstTwoTouches=[Z[0].identifier,Z[1].identifier],this._start([ve[0],ve[1]]))},Na.prototype.touchmove=function(V,ve,Z){if(this._firstTwoTouches){V.preventDefault();var pe=this._firstTwoTouches,Me=pe[0],Re=pe[1],je=Pa(Z,ve,Me),ut=Pa(Z,ve,Re);if(!(!je||!ut)){var Ct=this._aroundCenter?null:je.add(ut).div(2);return this._move([je,ut],Ct,V)}}},Na.prototype.touchend=function(V,ve,Z){if(this._firstTwoTouches){var pe=this._firstTwoTouches,Me=pe[0],Re=pe[1],je=Pa(Z,ve,Me),ut=Pa(Z,ve,Re);je&&ut||(this._active&&n.suppressClick(),this.reset())}},Na.prototype.touchcancel=function(){this.reset()},Na.prototype.enable=function(V){this._enabled=!0,this._aroundCenter=!!V&&V.around==="center"},Na.prototype.disable=function(){this._enabled=!1,this.reset()},Na.prototype.isEnabled=function(){return this._enabled},Na.prototype.isActive=function(){return this._active};function Pa(fe,V,ve){for(var Z=0;Z<fe.length;Z++)if(fe[Z].identifier===ve)return V[Z]}var $a=.1;function yi(fe,V){return Math.log(fe/V)/Math.LN2}var co=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.reset=function(){fe.prototype.reset.call(this),delete this._distance,delete this._startDistance},V.prototype._start=function(Z){this._startDistance=this._distance=Z[0].dist(Z[1])},V.prototype._move=function(Z,pe){var Me=this._distance;if(this._distance=Z[0].dist(Z[1]),!(!this._active&&Math.abs(yi(this._distance,this._startDistance))<$a))return this._active=!0,{zoomDelta:yi(this._distance,Me),pinchAround:pe}},V}(Na),Ii=25;function fa(fe,V){return fe.angleWith(V)*180/Math.PI}var ai=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.reset=function(){fe.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},V.prototype._start=function(Z){this._startVector=this._vector=Z[0].sub(Z[1]),this._minDiameter=Z[0].dist(Z[1])},V.prototype._move=function(Z,pe){var Me=this._vector;if(this._vector=Z[0].sub(Z[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:fa(this._vector,Me),pinchAround:pe}},V.prototype._isBelowThreshold=function(Z){this._minDiameter=Math.min(this._minDiameter,Z.mag());var pe=Math.PI*this._minDiameter,Me=Ii/pe*360,Re=fa(Z,this._startVector);return Math.abs(Re)<Me},V}(Na);function Xa(fe){return Math.abs(fe.y)>Math.abs(fe.x)}var Si=100,si=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.reset=function(){fe.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},V.prototype._start=function(Z){this._lastPoints=Z,Xa(Z[0].sub(Z[1]))&&(this._valid=!1)},V.prototype._move=function(Z,pe,Me){var Re=Z[0].sub(this._lastPoints[0]),je=Z[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(Re,je,Me.timeStamp),!!this._valid){this._lastPoints=Z,this._active=!0;var ut=(Re.y+je.y)/2,Ct=-.5;return{pitchDelta:ut*Ct}}},V.prototype.gestureBeginsVertically=function(Z,pe,Me){if(this._valid!==void 0)return this._valid;var Re=2,je=Z.mag()>=Re,ut=pe.mag()>=Re;if(!(!je&&!ut)){if(!je||!ut)return this._firstMove===void 0&&(this._firstMove=Me),Me-this._firstMove<Si?void 0:!1;var Ct=Z.y>0==pe.y>0;return Xa(Z)&&Xa(pe)&&Ct}},V}(Na),oo={panStep:100,bearingStep:15,pitchStep:10},Qi=function(){var V=oo;this._panStep=V.panStep,this._bearingStep=V.bearingStep,this._pitchStep=V.pitchStep};Qi.prototype.reset=function(){this._active=!1},Qi.prototype.keydown=function(V){var ve=this;if(!(V.altKey||V.ctrlKey||V.metaKey)){var Z=0,pe=0,Me=0,Re=0,je=0;switch(V.keyCode){case 61:case 107:case 171:case 187:Z=1;break;case 189:case 109:case 173:Z=-1;break;case 37:V.shiftKey?pe=-1:(V.preventDefault(),Re=-1);break;case 39:V.shiftKey?pe=1:(V.preventDefault(),Re=1);break;case 38:V.shiftKey?Me=1:(V.preventDefault(),je=-1);break;case 40:V.shiftKey?Me=-1:(V.preventDefault(),je=1);break;default:return}return{cameraAnimation:function(ut){var Ct=ut.getZoom();ut.easeTo({duration:300,easeId:"keyboardHandler",easing:yo,zoom:Z?Math.round(Ct)+Z*(V.shiftKey?2:1):Ct,bearing:ut.getBearing()+pe*ve._bearingStep,pitch:ut.getPitch()+Me*ve._pitchStep,offset:[-Re*ve._panStep,-je*ve._panStep],center:ut.getCenter()},{originalEvent:V})}}}},Qi.prototype.enable=function(){this._enabled=!0},Qi.prototype.disable=function(){this._enabled=!1,this.reset()},Qi.prototype.isEnabled=function(){return this._enabled},Qi.prototype.isActive=function(){return this._active};function yo(fe){return fe*(2-fe)}var Yo=4.000244140625,Oo=1/100,Wo=1/450,Gi=2,Bi=function(V,ve){this._map=V,this._el=V.getCanvasContainer(),this._handler=ve,this._delta=0,this._defaultZoomRate=Oo,this._wheelZoomRate=Wo,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Bi.prototype.setZoomRate=function(V){this._defaultZoomRate=V},Bi.prototype.setWheelZoomRate=function(V){this._wheelZoomRate=V},Bi.prototype.isEnabled=function(){return!!this._enabled},Bi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Bi.prototype.isZooming=function(){return!!this._zooming},Bi.prototype.enable=function(V){this.isEnabled()||(this._enabled=!0,this._aroundCenter=V&&V.around==="center")},Bi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Bi.prototype.wheel=function(V){if(this.isEnabled()){var ve=V.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?V.deltaY*40:V.deltaY,Z=e.browser.now(),pe=Z-(this._lastWheelEventTime||0);this._lastWheelEventTime=Z,ve!==0&&ve%Yo===0?this._type="wheel":ve!==0&&Math.abs(ve)<4?this._type="trackpad":pe>400?(this._type=null,this._lastValue=ve,this._timeout=setTimeout(this._onTimeout,40,V)):this._type||(this._type=Math.abs(pe*ve)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,ve+=this._lastValue)),V.shiftKey&&ve&&(ve=ve/4),this._type&&(this._lastWheelEvent=V,this._delta-=ve,this._active||this._start(V)),V.preventDefault()}},Bi.prototype._onTimeout=function(V){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(V)},Bi.prototype._start=function(V){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var ve=n.mousePos(this._el,V);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(ve)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Bi.prototype.renderFrame=function(){return this._onScrollFrame()},Bi.prototype._onScrollFrame=function(){var V=this;if(this._frameId&&(this._frameId=null,!!this.isActive())){var ve=this._map.transform;if(this._delta!==0){var Z=this._type==="wheel"&&Math.abs(this._delta)>Yo?this._wheelZoomRate:this._defaultZoomRate,pe=Gi/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&pe!==0&&(pe=1/pe);var Me=typeof this._targetZoom=="number"?ve.zoomScale(this._targetZoom):ve.scale;this._targetZoom=Math.min(ve.maxZoom,Math.max(ve.minZoom,ve.scaleZoom(Me*pe))),this._type==="wheel"&&(this._startZoom=ve.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var Re=typeof this._targetZoom=="number"?this._targetZoom:ve.zoom,je=this._startZoom,ut=this._easing,Ct=!1,Qt;if(this._type==="wheel"&&je&&ut){var ur=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),vr=ut(ur);Qt=e.number(je,Re,vr),ur<1?this._frameId||(this._frameId=!0):Ct=!0}else Qt=Re,Ct=!0;return this._active=!0,Ct&&(this._active=!1,this._finishTimeout=setTimeout(function(){V._zooming=!1,V._handler._triggerRenderFrame(),delete V._targetZoom,delete V._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ct,zoomDelta:Qt-ve.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Bi.prototype._smoothOutEasing=function(V){var ve=e.ease;if(this._prevEase){var Z=this._prevEase,pe=(e.browser.now()-Z.start)/Z.duration,Me=Z.easing(pe+.01)-Z.easing(pe),Re=.27/Math.sqrt(Me*Me+1e-4)*.01,je=Math.sqrt(.27*.27-Re*Re);ve=e.bezier(Re,je,.25,1)}return this._prevEase={start:e.browser.now(),duration:V,easing:ve},ve},Bi.prototype.reset=function(){this._active=!1};var Ia=function(V,ve){this._clickZoom=V,this._tapZoom=ve};Ia.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ia.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ia.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ia.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Za=function(){this.reset()};Za.prototype.reset=function(){this._active=!1},Za.prototype.dblclick=function(V,ve){return V.preventDefault(),{cameraAnimation:function(Z){Z.easeTo({duration:300,zoom:Z.getZoom()+(V.shiftKey?-1:1),around:Z.unproject(ve)},{originalEvent:V})}}},Za.prototype.enable=function(){this._enabled=!0},Za.prototype.disable=function(){this._enabled=!1,this.reset()},Za.prototype.isEnabled=function(){return this._enabled},Za.prototype.isActive=function(){return this._active};var bo=function(){this._tap=new nn({numTouches:1,numTaps:1}),this.reset()};bo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},bo.prototype.touchstart=function(V,ve,Z){this._swipePoint||(this._tapTime&&V.timeStamp-this._tapTime>ln&&this.reset(),this._tapTime?Z.length>0&&(this._swipePoint=ve[0],this._swipeTouch=Z[0].identifier):this._tap.touchstart(V,ve,Z))},bo.prototype.touchmove=function(V,ve,Z){if(!this._tapTime)this._tap.touchmove(V,ve,Z);else if(this._swipePoint){if(Z[0].identifier!==this._swipeTouch)return;var pe=ve[0],Me=pe.y-this._swipePoint.y;return this._swipePoint=pe,V.preventDefault(),this._active=!0,{zoomDelta:Me/128}}},bo.prototype.touchend=function(V,ve,Z){if(this._tapTime)this._swipePoint&&Z.length===0&&this.reset();else{var pe=this._tap.touchend(V,ve,Z);pe&&(this._tapTime=V.timeStamp)}},bo.prototype.touchcancel=function(){this.reset()},bo.prototype.enable=function(){this._enabled=!0},bo.prototype.disable=function(){this._enabled=!1,this.reset()},bo.prototype.isEnabled=function(){return this._enabled},bo.prototype.isActive=function(){return this._active};var eo=function(V,ve,Z){this._el=V,this._mousePan=ve,this._touchPan=Z};eo.prototype.enable=function(V){this._inertiaOptions=V||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},eo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},eo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},eo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Do=function(V,ve,Z){this._pitchWithRotate=V.pitchWithRotate,this._mouseRotate=ve,this._mousePitch=Z};Do.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Do.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Do.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Do.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Xi=function(V,ve,Z,pe){this._el=V,this._touchZoom=ve,this._touchRotate=Z,this._tapDragZoom=pe,this._rotationDisabled=!1,this._enabled=!0};Xi.prototype.enable=function(V){this._touchZoom.enable(V),this._rotationDisabled||this._touchRotate.enable(V),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Xi.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Xi.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Xi.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Xi.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Xi.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Xo=function(fe){return fe.zoom||fe.drag||fe.pitch||fe.rotate},xs=function(fe){function V(){fe.apply(this,arguments)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V}(e.Event);function Ul(fe){return fe.panDelta&&fe.panDelta.mag()||fe.zoomDelta||fe.bearingDelta||fe.pitchDelta}var Zi=function(V,ve){this._map=V,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Be(V),this._bearingSnap=ve.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(ve),e.bindAll(["handleEvent","handleWindowEvent"],this);var Z=this._el;this._listeners=[[Z,"touchstart",{passive:!1}],[Z,"touchmove",{passive:!1}],[Z,"touchend",void 0],[Z,"touchcancel",void 0],[Z,"mousedown",void 0],[Z,"mousemove",void 0],[Z,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[Z,"mouseover",void 0],[Z,"mouseout",void 0],[Z,"dblclick",void 0],[Z,"click",void 0],[Z,"keydown",{capture:!1}],[Z,"keyup",void 0],[Z,"wheel",{passive:!1}],[Z,"contextmenu",void 0],[e.window,"blur",void 0]];for(var pe=0,Me=this._listeners;pe<Me.length;pe+=1){var Re=Me[pe],je=Re[0],ut=Re[1],Ct=Re[2];n.addEventListener(je,ut,je===e.window.document?this.handleWindowEvent:this.handleEvent,Ct)}};Zi.prototype.destroy=function(){for(var V=0,ve=this._listeners;V<ve.length;V+=1){var Z=ve[V],pe=Z[0],Me=Z[1],Re=Z[2];n.removeEventListener(pe,Me,pe===e.window.document?this.handleWindowEvent:this.handleEvent,Re)}},Zi.prototype._addDefaultHandlers=function(V){var ve=this._map,Z=ve.getCanvasContainer();this._add("mapEvent",new jt(ve,V));var pe=ve.boxZoom=new tr(ve,V);this._add("boxZoom",pe);var Me=new on,Re=new Za;ve.doubleClickZoom=new Ia(Re,Me),this._add("tapZoom",Me),this._add("clickZoom",Re);var je=new bo;this._add("tapDragZoom",je);var ut=ve.touchPitch=new si;this._add("touchPitch",ut);var Ct=new ia(V),Qt=new ka(V);ve.dragRotate=new Do(V,Ct,Qt),this._add("mouseRotate",Ct,["mousePitch"]),this._add("mousePitch",Qt,["mouseRotate"]);var ur=new _a(V),vr=new la(V);ve.dragPan=new eo(Z,ur,vr),this._add("mousePan",ur),this._add("touchPan",vr,["touchZoom","touchRotate"]);var Cr=new ai,Vr=new co;ve.touchZoomRotate=new Xi(Z,Vr,Cr,je),this._add("touchRotate",Cr,["touchPan","touchZoom"]),this._add("touchZoom",Vr,["touchPan","touchRotate"]);var Wr=ve.scrollZoom=new Bi(ve,this);this._add("scrollZoom",Wr,["mousePan"]);var Ur=ve.keyboard=new Qi;this._add("keyboard",Ur),this._add("blockableMapEvent",new er(ve));for(var Jr=0,hn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Jr<hn.length;Jr+=1){var Cn=hn[Jr];V.interactive&&V[Cn]&&ve[Cn].enable(V[Cn])}},Zi.prototype._add=function(V,ve,Z){this._handlers.push({handlerName:V,handler:ve,allowed:Z}),this._handlersById[V]=ve},Zi.prototype.stop=function(){if(!this._updatingCamera){for(var V=0,ve=this._handlers;V<ve.length;V+=1){var Z=ve[V],pe=Z.handler;pe.reset()}this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Zi.prototype.isActive=function(){for(var V=0,ve=this._handlers;V<ve.length;V+=1){var Z=ve[V],pe=Z.handler;if(pe.isActive())return!0}return!1},Zi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Zi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Zi.prototype.isMoving=function(){return!!Xo(this._eventsInProgress)||this.isZooming()},Zi.prototype._blockedByActive=function(V,ve,Z){for(var pe in V)if(pe!==Z&&(!ve||ve.indexOf(pe)<0))return!0;return!1},Zi.prototype.handleWindowEvent=function(V){this.handleEvent(V,V.type+"Window")},Zi.prototype._getMapTouches=function(V){for(var ve=[],Z=0,pe=V;Z<pe.length;Z+=1){var Me=pe[Z],Re=Me.target;this._el.contains(Re)&&ve.push(Me)}return ve},Zi.prototype.handleEvent=function(V,ve){if(V.type==="blur"){this.stop();return}this._updatingCamera=!0;for(var Z=V.type==="renderFrame"?void 0:V,pe={needsRenderFrame:!1},Me={},Re={},je=V.touches?this._getMapTouches(V.touches):void 0,ut=je?n.touchPos(this._el,je):n.mousePos(this._el,V),Ct=0,Qt=this._handlers;Ct<Qt.length;Ct+=1){var ur=Qt[Ct],vr=ur.handlerName,Cr=ur.handler,Vr=ur.allowed;if(Cr.isEnabled()){var Wr=void 0;this._blockedByActive(Re,Vr,vr)?Cr.reset():Cr[ve||V.type]&&(Wr=Cr[ve||V.type](V,ut,je),this.mergeHandlerResult(pe,Me,Wr,vr,Z),Wr&&Wr.needsRenderFrame&&this._triggerRenderFrame()),(Wr||Cr.isActive())&&(Re[vr]=Cr)}}var Ur={};for(var Jr in this._previousActiveHandlers)Re[Jr]||(Ur[Jr]=Z);this._previousActiveHandlers=Re,(Object.keys(Ur).length||Ul(pe))&&(this._changes.push([pe,Me,Ur]),this._triggerRenderFrame()),(Object.keys(Re).length||Ul(pe))&&this._map._stop(!0),this._updatingCamera=!1;var hn=pe.cameraAnimation;hn&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],hn(this._map))},Zi.prototype.mergeHandlerResult=function(V,ve,Z,pe,Me){if(Z){e.extend(V,Z);var Re={handlerName:pe,originalEvent:Z.originalEvent||Me};Z.zoomDelta!==void 0&&(ve.zoom=Re),Z.panDelta!==void 0&&(ve.drag=Re),Z.pitchDelta!==void 0&&(ve.pitch=Re),Z.bearingDelta!==void 0&&(ve.rotate=Re)}},Zi.prototype._applyChanges=function(){for(var V={},ve={},Z={},pe=0,Me=this._changes;pe<Me.length;pe+=1){var Re=Me[pe],je=Re[0],ut=Re[1],Ct=Re[2];je.panDelta&&(V.panDelta=(V.panDelta||new e.Point(0,0))._add(je.panDelta)),je.zoomDelta&&(V.zoomDelta=(V.zoomDelta||0)+je.zoomDelta),je.bearingDelta&&(V.bearingDelta=(V.bearingDelta||0)+je.bearingDelta),je.pitchDelta&&(V.pitchDelta=(V.pitchDelta||0)+je.pitchDelta),je.around!==void 0&&(V.around=je.around),je.pinchAround!==void 0&&(V.pinchAround=je.pinchAround),je.noInertia&&(V.noInertia=je.noInertia),e.extend(ve,ut),e.extend(Z,Ct)}this._updateMapTransform(V,ve,Z),this._changes=[]},Zi.prototype._updateMapTransform=function(V,ve,Z){var pe=this._map,Me=pe.transform;if(!Ul(V))return this._fireEvents(ve,Z);var Re=V.panDelta,je=V.zoomDelta,ut=V.bearingDelta,Ct=V.pitchDelta,Qt=V.around,ur=V.pinchAround;ur!==void 0&&(Qt=ur),pe._stop(!0),Qt=Qt||pe.transform.centerPoint;var vr=Me.pointLocation(Re?Qt.sub(Re):Qt);ut&&(Me.bearing+=ut),Ct&&(Me.pitch+=Ct),je&&(Me.zoom+=je),Me.setLocationAtPoint(vr,Qt),this._map._update(),V.noInertia||this._inertia.record(V),this._fireEvents(ve,Z)},Zi.prototype._fireEvents=function(V,ve){var Z=this,pe=Xo(this._eventsInProgress),Me=Xo(V),Re={};for(var je in V){var ut=V[je],Ct=ut.originalEvent;this._eventsInProgress[je]||(Re[je+"start"]=Ct),this._eventsInProgress[je]=V[je]}!pe&&Me&&this._fireEvent("movestart",Me.originalEvent);for(var Qt in Re)this._fireEvent(Qt,Re[Qt]);V.rotate&&(this._bearingChanged=!0),Me&&this._fireEvent("move",Me.originalEvent);for(var ur in V){var vr=V[ur],Cr=vr.originalEvent;this._fireEvent(ur,Cr)}var Vr={},Wr;for(var Ur in this._eventsInProgress){var Jr=this._eventsInProgress[Ur],hn=Jr.handlerName,Cn=Jr.originalEvent;this._handlersById[hn].isActive()||(delete this._eventsInProgress[Ur],Wr=ve[hn]||Cn,Vr[Ur+"end"]=Wr)}for(var Fn in Vr)this._fireEvent(Fn,Vr[Fn]);var Kn=Xo(this._eventsInProgress);if((pe||Me)&&!Kn){this._updatingCamera=!0;var qn=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Qn=function(ca){return ca!==0&&-Z._bearingSnap<ca&&ca<Z._bearingSnap};qn?(Qn(qn.bearing||this._map.getBearing())&&(qn.bearing=0),this._map.easeTo(qn,{originalEvent:Wr})):(this._map.fire(new e.Event("moveend",{originalEvent:Wr})),Qn(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Zi.prototype._fireEvent=function(V,ve){this._map.fire(new e.Event(V,ve?{originalEvent:ve}:{}))},Zi.prototype._triggerRenderFrame=function(){var V=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(ve){delete V._frameId,V.handleEvent(new xs("renderFrame",{timeStamp:ve})),V._applyChanges()}))};var qu=function(fe){function V(ve,Z){fe.call(this),this._moving=!1,this._zooming=!1,this.transform=ve,this._bearingSnap=Z.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},V.prototype.setCenter=function(Z,pe){return this.jumpTo({center:Z},pe)},V.prototype.panBy=function(Z,pe,Me){return Z=e.Point.convert(Z).mult(-1),this.panTo(this.transform.center,e.extend({offset:Z},pe),Me)},V.prototype.panTo=function(Z,pe,Me){return this.easeTo(e.extend({center:Z},pe),Me)},V.prototype.getZoom=function(){return this.transform.zoom},V.prototype.setZoom=function(Z,pe){return this.jumpTo({zoom:Z},pe),this},V.prototype.zoomTo=function(Z,pe,Me){return this.easeTo(e.extend({zoom:Z},pe),Me)},V.prototype.zoomIn=function(Z,pe){return this.zoomTo(this.getZoom()+1,Z,pe),this},V.prototype.zoomOut=function(Z,pe){return this.zoomTo(this.getZoom()-1,Z,pe),this},V.prototype.getBearing=function(){return this.transform.bearing},V.prototype.setBearing=function(Z,pe){return this.jumpTo({bearing:Z},pe),this},V.prototype.getPadding=function(){return this.transform.padding},V.prototype.setPadding=function(Z,pe){return this.jumpTo({padding:Z},pe),this},V.prototype.rotateTo=function(Z,pe,Me){return this.easeTo(e.extend({bearing:Z},pe),Me)},V.prototype.resetNorth=function(Z,pe){return this.rotateTo(0,e.extend({duration:1e3},Z),pe),this},V.prototype.resetNorthPitch=function(Z,pe){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},Z),pe),this},V.prototype.snapToNorth=function(Z,pe){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(Z,pe):this},V.prototype.getPitch=function(){return this.transform.pitch},V.prototype.setPitch=function(Z,pe){return this.jumpTo({pitch:Z},pe),this},V.prototype.cameraForBounds=function(Z,pe){return Z=e.LngLatBounds.convert(Z),this._cameraForBoxAndBearing(Z.getNorthWest(),Z.getSouthEast(),0,pe)},V.prototype._cameraForBoxAndBearing=function(Z,pe,Me,Re){var je={top:0,bottom:0,right:0,left:0};if(Re=e.extend({padding:je,offset:[0,0],maxZoom:this.transform.maxZoom},Re),typeof Re.padding=="number"){var ut=Re.padding;Re.padding={top:ut,bottom:ut,right:ut,left:ut}}Re.padding=e.extend(je,Re.padding);var Ct=this.transform,Qt=Ct.padding,ur=Ct.project(e.LngLat.convert(Z)),vr=Ct.project(e.LngLat.convert(pe)),Cr=ur.rotate(-Me*Math.PI/180),Vr=vr.rotate(-Me*Math.PI/180),Wr=new e.Point(Math.max(Cr.x,Vr.x),Math.max(Cr.y,Vr.y)),Ur=new e.Point(Math.min(Cr.x,Vr.x),Math.min(Cr.y,Vr.y)),Jr=Wr.sub(Ur),hn=(Ct.width-(Qt.left+Qt.right+Re.padding.left+Re.padding.right))/Jr.x,Cn=(Ct.height-(Qt.top+Qt.bottom+Re.padding.top+Re.padding.bottom))/Jr.y;if(Cn<0||hn<0){e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}var Fn=Math.min(Ct.scaleZoom(Ct.scale*Math.min(hn,Cn)),Re.maxZoom),Kn=e.Point.convert(Re.offset),qn=(Re.padding.left-Re.padding.right)/2,Qn=(Re.padding.top-Re.padding.bottom)/2,ca=new e.Point(Kn.x+qn,Kn.y+Qn),ba=ca.mult(Ct.scale/Ct.zoomScale(Fn)),ya=Ct.unproject(ur.add(vr).div(2).sub(ba));return{center:ya,zoom:Fn,bearing:Me}},V.prototype.fitBounds=function(Z,pe,Me){return this._fitInternal(this.cameraForBounds(Z,pe),pe,Me)},V.prototype.fitScreenCoordinates=function(Z,pe,Me,Re,je){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(Z)),this.transform.pointLocation(e.Point.convert(pe)),Me,Re),Re,je)},V.prototype._fitInternal=function(Z,pe,Me){return Z?(pe=e.extend(Z,pe),delete pe.padding,pe.linear?this.easeTo(pe,Me):this.flyTo(pe,Me)):this},V.prototype.jumpTo=function(Z,pe){this.stop();var Me=this.transform,Re=!1,je=!1,ut=!1;return"zoom"in Z&&Me.zoom!==+Z.zoom&&(Re=!0,Me.zoom=+Z.zoom),Z.center!==void 0&&(Me.center=e.LngLat.convert(Z.center)),"bearing"in Z&&Me.bearing!==+Z.bearing&&(je=!0,Me.bearing=+Z.bearing),"pitch"in Z&&Me.pitch!==+Z.pitch&&(ut=!0,Me.pitch=+Z.pitch),Z.padding!=null&&!Me.isPaddingEqual(Z.padding)&&(Me.padding=Z.padding),this.fire(new e.Event("movestart",pe)).fire(new e.Event("move",pe)),Re&&this.fire(new e.Event("zoomstart",pe)).fire(new e.Event("zoom",pe)).fire(new e.Event("zoomend",pe)),je&&this.fire(new e.Event("rotatestart",pe)).fire(new e.Event("rotate",pe)).fire(new e.Event("rotateend",pe)),ut&&this.fire(new e.Event("pitchstart",pe)).fire(new e.Event("pitch",pe)).fire(new e.Event("pitchend",pe)),this.fire(new e.Event("moveend",pe))},V.prototype.easeTo=function(Z,pe){var Me=this;this._stop(!1,Z.easeId),Z=e.extend({offset:[0,0],duration:500,easing:e.ease},Z),(Z.animate===!1||!Z.essential&&e.browser.prefersReducedMotion)&&(Z.duration=0);var Re=this.transform,je=this.getZoom(),ut=this.getBearing(),Ct=this.getPitch(),Qt=this.getPadding(),ur="zoom"in Z?+Z.zoom:je,vr="bearing"in Z?this._normalizeBearing(Z.bearing,ut):ut,Cr="pitch"in Z?+Z.pitch:Ct,Vr="padding"in Z?Z.padding:Re.padding,Wr=e.Point.convert(Z.offset),Ur=Re.centerPoint.add(Wr),Jr=Re.pointLocation(Ur),hn=e.LngLat.convert(Z.center||Jr);this._normalizeCenter(hn);var Cn=Re.project(Jr),Fn=Re.project(hn).sub(Cn),Kn=Re.zoomScale(ur-je),qn,Qn;Z.around&&(qn=e.LngLat.convert(Z.around),Qn=Re.locationPoint(qn));var ca={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ur!==je,this._rotating=this._rotating||ut!==vr,this._pitching=this._pitching||Cr!==Ct,this._padding=!Re.isPaddingEqual(Vr),this._easeId=Z.easeId,this._prepareEase(pe,Z.noMoveStart,ca),clearTimeout(this._easeEndTimeoutID),this._ease(function(ba){if(Me._zooming&&(Re.zoom=e.number(je,ur,ba)),Me._rotating&&(Re.bearing=e.number(ut,vr,ba)),Me._pitching&&(Re.pitch=e.number(Ct,Cr,ba)),Me._padding&&(Re.interpolatePadding(Qt,Vr,ba),Ur=Re.centerPoint.add(Wr)),qn)Re.setLocationAtPoint(qn,Qn);else{var ya=Re.zoomScale(Re.zoom-je),Ta=ur>je?Math.min(2,Kn):Math.max(.5,Kn),Ca=Math.pow(Ta,1-ba),Ha=Re.unproject(Cn.add(Fn.mult(ba*Ca)).mult(ya));Re.setLocationAtPoint(Re.renderWorldCopies?Ha.wrap():Ha,Ur)}Me._fireMoveEvents(pe)},function(ba){Me._afterEase(pe,ba)},Z),this},V.prototype._prepareEase=function(Z,pe,Me){Me===void 0&&(Me={}),this._moving=!0,!pe&&!Me.moving&&this.fire(new e.Event("movestart",Z)),this._zooming&&!Me.zooming&&this.fire(new e.Event("zoomstart",Z)),this._rotating&&!Me.rotating&&this.fire(new e.Event("rotatestart",Z)),this._pitching&&!Me.pitching&&this.fire(new e.Event("pitchstart",Z))},V.prototype._fireMoveEvents=function(Z){this.fire(new e.Event("move",Z)),this._zooming&&this.fire(new e.Event("zoom",Z)),this._rotating&&this.fire(new e.Event("rotate",Z)),this._pitching&&this.fire(new e.Event("pitch",Z))},V.prototype._afterEase=function(Z,pe){if(!(this._easeId&&pe&&this._easeId===pe)){delete this._easeId;var Me=this._zooming,Re=this._rotating,je=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,Me&&this.fire(new e.Event("zoomend",Z)),Re&&this.fire(new e.Event("rotateend",Z)),je&&this.fire(new e.Event("pitchend",Z)),this.fire(new e.Event("moveend",Z))}},V.prototype.flyTo=function(Z,pe){var Me=this;if(!Z.essential&&e.browser.prefersReducedMotion){var Re=e.pick(Z,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Re,pe)}this.stop(),Z=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},Z);var je=this.transform,ut=this.getZoom(),Ct=this.getBearing(),Qt=this.getPitch(),ur=this.getPadding(),vr="zoom"in Z?e.clamp(+Z.zoom,je.minZoom,je.maxZoom):ut,Cr="bearing"in Z?this._normalizeBearing(Z.bearing,Ct):Ct,Vr="pitch"in Z?+Z.pitch:Qt,Wr="padding"in Z?Z.padding:je.padding,Ur=je.zoomScale(vr-ut),Jr=e.Point.convert(Z.offset),hn=je.centerPoint.add(Jr),Cn=je.pointLocation(hn),Fn=e.LngLat.convert(Z.center||Cn);this._normalizeCenter(Fn);var Kn=je.project(Cn),qn=je.project(Fn).sub(Kn),Qn=Z.curve,ca=Math.max(je.width,je.height),ba=ca/Ur,ya=qn.mag();if("minZoom"in Z){var Ta=e.clamp(Math.min(Z.minZoom,ut,vr),je.minZoom,je.maxZoom),Ca=ca/je.zoomScale(Ta-ut);Qn=Math.sqrt(Ca/ya*2)}var Ha=Qn*Qn;function ni(ii){var wi=(ba*ba-ca*ca+(ii?-1:1)*Ha*Ha*ya*ya)/(2*(ii?ba:ca)*Ha*ya);return Math.log(Math.sqrt(wi*wi+1)-wi)}function Li(ii){return(Math.exp(ii)-Math.exp(-ii))/2}function ui(ii){return(Math.exp(ii)+Math.exp(-ii))/2}function pi(ii){return Li(ii)/ui(ii)}var Ba=ni(0),Pi=function(ii){return ui(Ba)/ui(Ba+Qn*ii)},zi=function(ii){return ca*((ui(Ba)*pi(Ba+Qn*ii)-Li(Ba))/Ha)/ya},Ni=(ni(1)-Ba)/Qn;if(Math.abs(ya)<1e-6||!isFinite(Ni)){if(Math.abs(ca-ba)<1e-6)return this.easeTo(Z,pe);var _i=ba<ca?-1:1;Ni=Math.abs(Math.log(ba/ca))/Qn,zi=function(){return 0},Pi=function(ii){return Math.exp(_i*Qn*ii)}}if("duration"in Z)Z.duration=+Z.duration;else{var ji="screenSpeed"in Z?+Z.screenSpeed/Qn:+Z.speed;Z.duration=1e3*Ni/ji}return Z.maxDuration&&Z.duration>Z.maxDuration&&(Z.duration=0),this._zooming=!0,this._rotating=Ct!==Cr,this._pitching=Vr!==Qt,this._padding=!je.isPaddingEqual(Wr),this._prepareEase(pe,!1),this._ease(function(ii){var wi=ii*Ni,wo=1/Pi(wi);je.zoom=ii===1?vr:ut+je.scaleZoom(wo),Me._rotating&&(je.bearing=e.number(Ct,Cr,ii)),Me._pitching&&(je.pitch=e.number(Qt,Vr,ii)),Me._padding&&(je.interpolatePadding(ur,Wr,ii),hn=je.centerPoint.add(Jr));var Bo=ii===1?Fn:je.unproject(Kn.add(qn.mult(zi(wi))).mult(wo));je.setLocationAtPoint(je.renderWorldCopies?Bo.wrap():Bo,hn),Me._fireMoveEvents(pe)},function(){return Me._afterEase(pe)},Z),this},V.prototype.isEasing=function(){return!!this._easeFrameId},V.prototype.stop=function(){return this._stop()},V.prototype._stop=function(Z,pe){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var Me=this._onEaseEnd;delete this._onEaseEnd,Me.call(this,pe)}if(!Z){var Re=this.handlers;Re&&Re.stop()}return this},V.prototype._ease=function(Z,pe,Me){Me.animate===!1||Me.duration===0?(Z(1),pe()):(this._easeStart=e.browser.now(),this._easeOptions=Me,this._onEaseFrame=Z,this._onEaseEnd=pe,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},V.prototype._renderFrameCallback=function(){var Z=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(Z)),Z<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},V.prototype._normalizeBearing=function(Z,pe){Z=e.wrap(Z,-180,180);var Me=Math.abs(Z-pe);return Math.abs(Z-360-pe)<Me&&(Z-=360),Math.abs(Z+360-pe)<Me&&(Z+=360),Z},V.prototype._normalizeCenter=function(Z){var pe=this.transform;if(!(!pe.renderWorldCopies||pe.lngRange)){var Me=Z.lng-pe.center.lng;Z.lng+=Me>180?-360:Me<-180?360:0}},V}(e.Evented),Ml=function(V){V===void 0&&(V={}),this.options=V,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ml.prototype.getDefaultPosition=function(){return"bottom-right"},Ml.prototype.onAdd=function(V){var ve=this.options&&this.options.compact;return this._map=V,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),ve&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),ve===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ml.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ml.prototype._updateEditLink=function(){var V=this._editLink;V||(V=this._editLink=this._container.querySelector(".mapbox-improve-map"));var ve=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(V){var Z=ve.reduce(function(pe,Me,Re){return Me.value&&(pe+=Me.key+"="+Me.value+(Re<ve.length-1?"&":"")),pe},"?");V.href=e.config.FEEDBACK_URL+"/"+Z+(this._map._hash?this._map._hash.getHashString(!0):""),V.rel="noopener nofollow"}},Ml.prototype._updateData=function(V){V&&(V.sourceDataType==="metadata"||V.dataType==="style")&&(this._updateAttributions(),this._updateEditLink())},Ml.prototype._updateAttributions=function(){if(this._map.style){var V=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?V=V.concat(this.options.customAttribution.map(function(ut){return typeof ut!="string"?"":ut})):typeof this.options.customAttribution=="string"&&V.push(this.options.customAttribution)),this._map.style.stylesheet){var ve=this._map.style.stylesheet;this.styleOwner=ve.owner,this.styleId=ve.id}var Z=this._map.style.sourceCaches;for(var pe in Z){var Me=Z[pe];if(Me.used){var Re=Me.getSource();Re.attribution&&V.indexOf(Re.attribution)<0&&V.push(Re.attribution)}}V.sort(function(ut,Ct){return ut.length-Ct.length}),V=V.filter(function(ut,Ct){for(var Qt=Ct+1;Qt<V.length;Qt++)if(V[Qt].indexOf(ut)>=0)return!1;return!0});var je=V.join(" | ");je!==this._attribHTML&&(this._attribHTML=je,V.length?(this._innerContainer.innerHTML=je,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ml.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Oi=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};Oi.prototype.onAdd=function(V){this._map=V,this._container=n.create("div","mapboxgl-ctrl");var ve=n.create("a","mapboxgl-ctrl-logo");return ve.target="_blank",ve.rel="noopener nofollow",ve.href="https://www.mapbox.com/",ve.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),ve.setAttribute("rel","noopener nofollow"),this._container.appendChild(ve),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Oi.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Oi.prototype.getDefaultPosition=function(){return"bottom-left"},Oi.prototype._updateLogo=function(V){(!V||V.sourceDataType==="metadata")&&(this._container.style.display=this._logoRequired()?"block":"none")},Oi.prototype._logoRequired=function(){if(this._map.style){var V=this._map.style.sourceCaches;for(var ve in V){var Z=V[ve].getSource();if(Z.mapbox_logo)return!0}return!1}},Oi.prototype._updateCompact=function(){var V=this._container.children;if(V.length){var ve=V[0];this._map.getCanvasContainer().offsetWidth<250?ve.classList.add("mapboxgl-compact"):ve.classList.remove("mapboxgl-compact")}};var Ro=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ro.prototype.add=function(V){var ve=++this._id,Z=this._queue;return Z.push({callback:V,id:ve,cancelled:!1}),ve},Ro.prototype.remove=function(V){for(var ve=this._currentlyRunning,Z=ve?this._queue.concat(ve):this._queue,pe=0,Me=Z;pe<Me.length;pe+=1){var Re=Me[pe];if(Re.id===V){Re.cancelled=!0;return}}},Ro.prototype.run=function(V){V===void 0&&(V=0);var ve=this._currentlyRunning=this._queue;this._queue=[];for(var Z=0,pe=ve;Z<pe.length;Z+=1){var Me=pe[Z];if(!Me.cancelled&&(Me.callback(V),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ro.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Kc={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Mf=e.window.HTMLImageElement,pf=e.window.HTMLElement,Ou=e.window.ImageBitmap,ef=-2,Sf=22,Os=0,Bu=60,$f={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:ef,maxZoom:Sf,minPitch:Os,maxPitch:Bu,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},qf=function(fe){function V(Z){var pe=this;if(Z=e.extend({},$f,Z),Z.minZoom!=null&&Z.maxZoom!=null&&Z.minZoom>Z.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(Z.minPitch!=null&&Z.maxPitch!=null&&Z.minPitch>Z.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(Z.minPitch!=null&&Z.minPitch<Os)throw new Error("minPitch must be greater than or equal to "+Os);if(Z.maxPitch!=null&&Z.maxPitch>Bu)throw new Error("maxPitch must be less than or equal to "+Bu);var Me=new bi(Z.minZoom,Z.maxZoom,Z.minPitch,Z.maxPitch,Z.renderWorldCopies);if(fe.call(this,Me,Z),this._interactive=Z.interactive,this._maxTileCacheSize=Z.maxTileCacheSize,this._failIfMajorPerformanceCaveat=Z.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Z.preserveDrawingBuffer,this._antialias=Z.antialias,this._trackResize=Z.trackResize,this._bearingSnap=Z.bearingSnap,this._refreshExpiredTiles=Z.refreshExpiredTiles,this._fadeDuration=Z.fadeDuration,this._crossSourceCollisions=Z.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Z.collectResourceTiming,this._renderTaskQueue=new Ro,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},Kc,Z.locale),this._requestManager=new e.RequestManager(Z.transformRequest,Z.accessToken),typeof Z.container=="string"){if(this._container=e.window.document.getElementById(Z.container),!this._container)throw new Error("Container '"+Z.container+"' not found.")}else if(Z.container instanceof pf)this._container=Z.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(Z.maxBounds&&this.setMaxBounds(Z.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return pe._update(!1)}),this.on("moveend",function(){return pe._update(!1)}),this.on("zoom",function(){return pe._update(!0)}),typeof e.window<"u"&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Zi(this,Z);var Re=typeof Z.hash=="string"&&Z.hash||void 0;this._hash=Z.hash&&new go(Re).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:Z.center,zoom:Z.zoom,bearing:Z.bearing,pitch:Z.pitch}),Z.bounds&&(this.resize(),this.fitBounds(Z.bounds,e.extend({},Z.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Z.localIdeographFontFamily,Z.style&&this.setStyle(Z.style,{localIdeographFontFamily:Z.localIdeographFontFamily}),Z.attributionControl&&this.addControl(new Ml({customAttribution:Z.customAttribution})),this.addControl(new Oi,Z.logoPosition),this.on("style.load",function(){pe.transform.unmodified&&pe.jumpTo(pe.style.stylesheet)}),this.on("data",function(je){pe._update(je.dataType==="style"),pe.fire(new e.Event(je.dataType+"data",je))}),this.on("dataloading",function(je){pe.fire(new e.Event(je.dataType+"dataloading",je))})}fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V;var ve={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return V.prototype._getMapId=function(){return this._mapId},V.prototype.addControl=function(pe,Me){if(Me===void 0&&pe.getDefaultPosition&&(Me=pe.getDefaultPosition()),Me===void 0&&(Me="top-right"),!pe||!pe.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var Re=pe.onAdd(this);this._controls.push(pe);var je=this._controlPositions[Me];return Me.indexOf("bottom")!==-1?je.insertBefore(Re,je.firstChild):je.appendChild(Re),this},V.prototype.removeControl=function(pe){if(!pe||!pe.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var Me=this._controls.indexOf(pe);return Me>-1&&this._controls.splice(Me,1),pe.onRemove(this),this},V.prototype.resize=function(pe){var Me=this._containerDimensions(),Re=Me[0],je=Me[1];this._resizeCanvas(Re,je),this.transform.resize(Re,je),this.painter.resize(Re,je);var ut=!this._moving;return ut&&(this.stop(),this.fire(new e.Event("movestart",pe)).fire(new e.Event("move",pe))),this.fire(new e.Event("resize",pe)),ut&&this.fire(new e.Event("moveend",pe)),this},V.prototype.getBounds=function(){return this.transform.getBounds()},V.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},V.prototype.setMaxBounds=function(pe){return this.transform.setMaxBounds(e.LngLatBounds.convert(pe)),this._update()},V.prototype.setMinZoom=function(pe){if(pe=pe??ef,pe>=ef&&pe<=this.transform.maxZoom)return this.transform.minZoom=pe,this._update(),this.getZoom()<pe&&this.setZoom(pe),this;throw new Error("minZoom must be between "+ef+" and the current maxZoom, inclusive")},V.prototype.getMinZoom=function(){return this.transform.minZoom},V.prototype.setMaxZoom=function(pe){if(pe=pe??Sf,pe>=this.transform.minZoom)return this.transform.maxZoom=pe,this._update(),this.getZoom()>pe&&this.setZoom(pe),this;throw new Error("maxZoom must be greater than the current minZoom")},V.prototype.getMaxZoom=function(){return this.transform.maxZoom},V.prototype.setMinPitch=function(pe){if(pe=pe??Os,pe<Os)throw new Error("minPitch must be greater than or equal to "+Os);if(pe>=Os&&pe<=this.transform.maxPitch)return this.transform.minPitch=pe,this._update(),this.getPitch()<pe&&this.setPitch(pe),this;throw new Error("minPitch must be between "+Os+" and the current maxPitch, inclusive")},V.prototype.getMinPitch=function(){return this.transform.minPitch},V.prototype.setMaxPitch=function(pe){if(pe=pe??Bu,pe>Bu)throw new Error("maxPitch must be less than or equal to "+Bu);if(pe>=this.transform.minPitch)return this.transform.maxPitch=pe,this._update(),this.getPitch()>pe&&this.setPitch(pe),this;throw new Error("maxPitch must be greater than the current minPitch")},V.prototype.getMaxPitch=function(){return this.transform.maxPitch},V.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},V.prototype.setRenderWorldCopies=function(pe){return this.transform.renderWorldCopies=pe,this._update()},V.prototype.project=function(pe){return this.transform.locationPoint(e.LngLat.convert(pe))},V.prototype.unproject=function(pe){return this.transform.pointLocation(e.Point.convert(pe))},V.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},V.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},V.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},V.prototype._createDelegatedListener=function(pe,Me,Re){var je=this,ut;if(pe==="mouseenter"||pe==="mouseover"){var Ct=!1,Qt=function(Ur){var Jr=je.getLayer(Me)?je.queryRenderedFeatures(Ur.point,{layers:[Me]}):[];Jr.length?Ct||(Ct=!0,Re.call(je,new xt(pe,je,Ur.originalEvent,{features:Jr}))):Ct=!1},ur=function(){Ct=!1};return{layer:Me,listener:Re,delegates:{mousemove:Qt,mouseout:ur}}}else if(pe==="mouseleave"||pe==="mouseout"){var vr=!1,Cr=function(Ur){var Jr=je.getLayer(Me)?je.queryRenderedFeatures(Ur.point,{layers:[Me]}):[];Jr.length?vr=!0:vr&&(vr=!1,Re.call(je,new xt(pe,je,Ur.originalEvent)))},Vr=function(Ur){vr&&(vr=!1,Re.call(je,new xt(pe,je,Ur.originalEvent)))};return{layer:Me,listener:Re,delegates:{mousemove:Cr,mouseout:Vr}}}else{var Wr=function(Ur){var Jr=je.getLayer(Me)?je.queryRenderedFeatures(Ur.point,{layers:[Me]}):[];Jr.length&&(Ur.features=Jr,Re.call(je,Ur),delete Ur.features)};return{layer:Me,listener:Re,delegates:(ut={},ut[pe]=Wr,ut)}}},V.prototype.on=function(pe,Me,Re){if(Re===void 0)return fe.prototype.on.call(this,pe,Me);var je=this._createDelegatedListener(pe,Me,Re);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[pe]=this._delegatedListeners[pe]||[],this._delegatedListeners[pe].push(je);for(var ut in je.delegates)this.on(ut,je.delegates[ut]);return this},V.prototype.once=function(pe,Me,Re){if(Re===void 0)return fe.prototype.once.call(this,pe,Me);var je=this._createDelegatedListener(pe,Me,Re);for(var ut in je.delegates)this.once(ut,je.delegates[ut]);return this},V.prototype.off=function(pe,Me,Re){var je=this;if(Re===void 0)return fe.prototype.off.call(this,pe,Me);var ut=function(Ct){for(var Qt=Ct[pe],ur=0;ur<Qt.length;ur++){var vr=Qt[ur];if(vr.layer===Me&&vr.listener===Re){for(var Cr in vr.delegates)je.off(Cr,vr.delegates[Cr]);return Qt.splice(ur,1),je}}};return this._delegatedListeners&&this._delegatedListeners[pe]&&ut(this._delegatedListeners),this},V.prototype.queryRenderedFeatures=function(pe,Me){if(!this.style)return[];Me===void 0&&pe!==void 0&&!(pe instanceof e.Point)&&!Array.isArray(pe)&&(Me=pe,pe=void 0),Me=Me||{},pe=pe||[[0,0],[this.transform.width,this.transform.height]];var Re;if(pe instanceof e.Point||typeof pe[0]=="number")Re=[e.Point.convert(pe)];else{var je=e.Point.convert(pe[0]),ut=e.Point.convert(pe[1]);Re=[je,new e.Point(ut.x,je.y),ut,new e.Point(je.x,ut.y),je]}return this.style.queryRenderedFeatures(Re,Me,this.transform)},V.prototype.querySourceFeatures=function(pe,Me){return this.style.querySourceFeatures(pe,Me)},V.prototype.setStyle=function(pe,Me){return Me=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},Me),Me.diff!==!1&&Me.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&pe?(this._diffStyle(pe,Me),this):(this._localIdeographFontFamily=Me.localIdeographFontFamily,this._updateStyle(pe,Me))},V.prototype._getUIString=function(pe){var Me=this._locale[pe];if(Me==null)throw new Error("Missing UI string '"+pe+"'");return Me},V.prototype._updateStyle=function(pe,Me){if(this.style&&(this.style.setEventedParent(null),this.style._remove()),pe)this.style=new jo(this,Me||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof pe=="string"?this.style.loadURL(pe):this.style.loadJSON(pe),this},V.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new jo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},V.prototype._diffStyle=function(pe,Me){var Re=this;if(typeof pe=="string"){var je=this._requestManager.normalizeStyleURL(pe),ut=this._requestManager.transformRequest(je,e.ResourceType.Style);e.getJSON(ut,function(Ct,Qt){Ct?Re.fire(new e.ErrorEvent(Ct)):Qt&&Re._updateDiff(Qt,Me)})}else typeof pe=="object"&&this._updateDiff(pe,Me)},V.prototype._updateDiff=function(pe,Me){try{this.style.setState(pe)&&this._update(!0)}catch(Re){e.warnOnce("Unable to perform style diff: "+(Re.message||Re.error||Re)+".  Rebuilding the style from scratch."),this._updateStyle(pe,Me)}},V.prototype.getStyle=function(){if(this.style)return this.style.serialize()},V.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},V.prototype.addSource=function(pe,Me){return this._lazyInitEmptyStyle(),this.style.addSource(pe,Me),this._update(!0)},V.prototype.isSourceLoaded=function(pe){var Me=this.style&&this.style.sourceCaches[pe];if(Me===void 0){this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+pe+"'")));return}return Me.loaded()},V.prototype.areTilesLoaded=function(){var pe=this.style&&this.style.sourceCaches;for(var Me in pe){var Re=pe[Me],je=Re._tiles;for(var ut in je){var Ct=je[ut];if(!(Ct.state==="loaded"||Ct.state==="errored"))return!1}}return!0},V.prototype.addSourceType=function(pe,Me,Re){return this._lazyInitEmptyStyle(),this.style.addSourceType(pe,Me,Re)},V.prototype.removeSource=function(pe){return this.style.removeSource(pe),this._update(!0)},V.prototype.getSource=function(pe){return this.style.getSource(pe)},V.prototype.addImage=function(pe,Me,Re){Re===void 0&&(Re={});var je=Re.pixelRatio;je===void 0&&(je=1);var ut=Re.sdf;ut===void 0&&(ut=!1);var Ct=Re.stretchX,Qt=Re.stretchY,ur=Re.content;this._lazyInitEmptyStyle();var vr=0;if(Me instanceof Mf||Ou&&Me instanceof Ou){var Cr=e.browser.getImageData(Me),Vr=Cr.width,Wr=Cr.height,Ur=Cr.data;this.style.addImage(pe,{data:new e.RGBAImage({width:Vr,height:Wr},Ur),pixelRatio:je,stretchX:Ct,stretchY:Qt,content:ur,sdf:ut,version:vr})}else{if(Me.width===void 0||Me.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Jr=Me.width,hn=Me.height,Cn=Me.data,Fn=Me;this.style.addImage(pe,{data:new e.RGBAImage({width:Jr,height:hn},new Uint8Array(Cn)),pixelRatio:je,stretchX:Ct,stretchY:Qt,content:ur,sdf:ut,version:vr,userImage:Fn}),Fn.onAdd&&Fn.onAdd(this,pe)}},V.prototype.updateImage=function(pe,Me){var Re=this.style.getImage(pe);if(!Re)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var je=Me instanceof Mf||Ou&&Me instanceof Ou?e.browser.getImageData(Me):Me,ut=je.width,Ct=je.height,Qt=je.data;if(ut===void 0||Ct===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ut!==Re.data.width||Ct!==Re.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var ur=!(Me instanceof Mf||Ou&&Me instanceof Ou);Re.data.replace(Qt,ur),this.style.updateImage(pe,Re)},V.prototype.hasImage=function(pe){return pe?!!this.style.getImage(pe):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},V.prototype.removeImage=function(pe){this.style.removeImage(pe)},V.prototype.loadImage=function(pe,Me){e.getImage(this._requestManager.transformRequest(pe,e.ResourceType.Image),Me)},V.prototype.listImages=function(){return this.style.listImages()},V.prototype.addLayer=function(pe,Me){return this._lazyInitEmptyStyle(),this.style.addLayer(pe,Me),this._update(!0)},V.prototype.moveLayer=function(pe,Me){return this.style.moveLayer(pe,Me),this._update(!0)},V.prototype.removeLayer=function(pe){return this.style.removeLayer(pe),this._update(!0)},V.prototype.getLayer=function(pe){return this.style.getLayer(pe)},V.prototype.setLayerZoomRange=function(pe,Me,Re){return this.style.setLayerZoomRange(pe,Me,Re),this._update(!0)},V.prototype.setFilter=function(pe,Me,Re){return Re===void 0&&(Re={}),this.style.setFilter(pe,Me,Re),this._update(!0)},V.prototype.getFilter=function(pe){return this.style.getFilter(pe)},V.prototype.setPaintProperty=function(pe,Me,Re,je){return je===void 0&&(je={}),this.style.setPaintProperty(pe,Me,Re,je),this._update(!0)},V.prototype.getPaintProperty=function(pe,Me){return this.style.getPaintProperty(pe,Me)},V.prototype.setLayoutProperty=function(pe,Me,Re,je){return je===void 0&&(je={}),this.style.setLayoutProperty(pe,Me,Re,je),this._update(!0)},V.prototype.getLayoutProperty=function(pe,Me){return this.style.getLayoutProperty(pe,Me)},V.prototype.setLight=function(pe,Me){return Me===void 0&&(Me={}),this._lazyInitEmptyStyle(),this.style.setLight(pe,Me),this._update(!0)},V.prototype.getLight=function(){return this.style.getLight()},V.prototype.setFeatureState=function(pe,Me){return this.style.setFeatureState(pe,Me),this._update()},V.prototype.removeFeatureState=function(pe,Me){return this.style.removeFeatureState(pe,Me),this._update()},V.prototype.getFeatureState=function(pe){return this.style.getFeatureState(pe)},V.prototype.getContainer=function(){return this._container},V.prototype.getCanvasContainer=function(){return this._canvasContainer},V.prototype.getCanvas=function(){return this._canvas},V.prototype._containerDimensions=function(){var pe=0,Me=0;return this._container&&(pe=this._container.clientWidth||400,Me=this._container.clientHeight||300),[pe,Me]},V.prototype._detectMissingCSS=function(){var pe=e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color");pe!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},V.prototype._setupContainer=function(){var pe=this._container;pe.classList.add("mapboxgl-map");var Me=this._missingCSSCanary=n.create("div","mapboxgl-canary",pe);Me.style.visibility="hidden",this._detectMissingCSS();var Re=this._canvasContainer=n.create("div","mapboxgl-canvas-container",pe);this._interactive&&Re.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",Re),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var je=this._containerDimensions();this._resizeCanvas(je[0],je[1]);var ut=this._controlContainer=n.create("div","mapboxgl-control-container",pe),Ct=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Qt){Ct[Qt]=n.create("div","mapboxgl-ctrl-"+Qt,ut)})},V.prototype._resizeCanvas=function(pe,Me){var Re=e.browser.devicePixelRatio||1;this._canvas.width=Re*pe,this._canvas.height=Re*Me,this._canvas.style.width=pe+"px",this._canvas.style.height=Me+"px"},V.prototype._setupPainter=function(){var pe=e.extend({},a.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),Me=this._canvas.getContext("webgl",pe)||this._canvas.getContext("experimental-webgl",pe);if(!Me){this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new ri(Me,this.transform),e.webpSupported.testSupport(Me)},V.prototype._contextLost=function(pe){pe.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:pe}))},V.prototype._contextRestored=function(pe){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:pe}))},V.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},V.prototype._update=function(pe){return this.style?(this._styleDirty=this._styleDirty||pe,this._sourcesDirty=!0,this.triggerRepaint(),this):this},V.prototype._requestRenderFrame=function(pe){return this._update(),this._renderTaskQueue.add(pe)},V.prototype._cancelRenderFrame=function(pe){this._renderTaskQueue.remove(pe)},V.prototype._render=function(pe){var Me=this,Re,je=0,ut=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(Re=ut.createQueryEXT(),ut.beginQueryEXT(ut.TIME_ELAPSED_EXT,Re),je=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(pe),!this._removed){var Ct=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Qt=this.transform.zoom,ur=e.browser.now();this.style.zoomHistory.update(Qt,ur);var vr=new e.EvaluationParameters(Qt,{now:ur,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Cr=vr.crossFadingFactor();(Cr!==1||Cr!==this._crossFadingFactor)&&(Ct=!0,this._crossFadingFactor=Cr),this.style.update(vr)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Ct)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Vr=e.browser.now()-je;ut.endQueryEXT(ut.TIME_ELAPSED_EXT,Re),setTimeout(function(){var Jr=ut.getQueryObjectEXT(Re,ut.QUERY_RESULT_EXT)/1e6;ut.deleteQueryEXT(Re),Me.fire(new e.Event("gpu-timing-frame",{cpuTime:Vr,gpuTime:Jr}))},50)}if(this.listens("gpu-timing-layer")){var Wr=this.painter.collectGpuTimers();setTimeout(function(){var Jr=Me.painter.queryGpuTimers(Wr);Me.fire(new e.Event("gpu-timing-layer",{layerTimes:Jr}))},50)}var Ur=this._sourcesDirty||this._styleDirty||this._placementDirty;return Ur||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},V.prototype.remove=function(){this._hash&&this._hash.remove();for(var pe=0,Me=this._controls;pe<Me.length;pe+=1){var Re=Me[pe];Re.onRemove(this)}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof e.window<"u"&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var je=this.painter.context.gl.getExtension("WEBGL_lose_context");je&&je.loseContext(),df(this._canvasContainer),df(this._controlContainer),df(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},V.prototype.triggerRepaint=function(){var pe=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(Me){pe._frame=null,pe._render(Me)}))},V.prototype._onWindowOnline=function(){this._update()},V.prototype._onWindowResize=function(pe){this._trackResize&&this.resize({originalEvent:pe})._update()},ve.showTileBoundaries.get=function(){return!!this._showTileBoundaries},ve.showTileBoundaries.set=function(Z){this._showTileBoundaries!==Z&&(this._showTileBoundaries=Z,this._update())},ve.showPadding.get=function(){return!!this._showPadding},ve.showPadding.set=function(Z){this._showPadding!==Z&&(this._showPadding=Z,this._update())},ve.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},ve.showCollisionBoxes.set=function(Z){this._showCollisionBoxes!==Z&&(this._showCollisionBoxes=Z,Z?this.style._generateCollisionBoxes():this._update())},ve.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},ve.showOverdrawInspector.set=function(Z){this._showOverdrawInspector!==Z&&(this._showOverdrawInspector=Z,this._update())},ve.repaint.get=function(){return!!this._repaint},ve.repaint.set=function(Z){this._repaint!==Z&&(this._repaint=Z,this.triggerRepaint())},ve.vertices.get=function(){return!!this._vertices},ve.vertices.set=function(Z){this._vertices=Z,this._update()},V.prototype._setCacheLimits=function(pe,Me){e.setCacheLimits(pe,Me)},ve.version.get=function(){return e.version},Object.defineProperties(V.prototype,ve),V}(qu);function df(fe){fe.parentNode&&fe.parentNode.removeChild(fe)}var kf={showCompass:!0,showZoom:!0,visualizePitch:!1},xu=function(V){var ve=this;this.options=e.extend({},kf,V),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(Z){return Z.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(Z){return ve._map.zoomIn({},{originalEvent:Z})}),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(Z){return ve._map.zoomOut({},{originalEvent:Z})}),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(Z){ve.options.visualizePitch?ve._map.resetNorthPitch({},{originalEvent:Z}):ve._map.resetNorth({},{originalEvent:Z})}),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};xu.prototype._updateZoomButtons=function(){var V=this._map.getZoom();this._zoomInButton.disabled=V===this._map.getMaxZoom(),this._zoomOutButton.disabled=V===this._map.getMinZoom()},xu.prototype._rotateCompassArrow=function(){var V=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=V},xu.prototype.onAdd=function(V){return this._map=V,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Qs(this._map,this._compass,this.options.visualizePitch)),this._container},xu.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},xu.prototype._createButton=function(V,ve){var Z=n.create("button",V,this._container);return Z.type="button",Z.addEventListener("click",ve),Z},xu.prototype._setButtonTitle=function(V,ve){var Z=this._map._getUIString("NavigationControl."+ve);V.title=Z,V.setAttribute("aria-label",Z)};var Qs=function(V,ve,Z){Z===void 0&&(Z=!1),this._clickTolerance=10,this.element=ve,this.mouseRotate=new ia({clickTolerance:V.dragRotate._mouseRotate._clickTolerance}),this.map=V,Z&&(this.mousePitch=new ka({clickTolerance:V.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(ve,"mousedown",this.mousedown),n.addEventListener(ve,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(ve,"touchmove",this.touchmove),n.addEventListener(ve,"touchend",this.touchend),n.addEventListener(ve,"touchcancel",this.reset)};Qs.prototype.down=function(V,ve){this.mouseRotate.mousedown(V,ve),this.mousePitch&&this.mousePitch.mousedown(V,ve),n.disableDrag()},Qs.prototype.move=function(V,ve){var Z=this.map,pe=this.mouseRotate.mousemoveWindow(V,ve);if(pe&&pe.bearingDelta&&Z.setBearing(Z.getBearing()+pe.bearingDelta),this.mousePitch){var Me=this.mousePitch.mousemoveWindow(V,ve);Me&&Me.pitchDelta&&Z.setPitch(Z.getPitch()+Me.pitchDelta)}},Qs.prototype.off=function(){var V=this.element;n.removeEventListener(V,"mousedown",this.mousedown),n.removeEventListener(V,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(V,"touchmove",this.touchmove),n.removeEventListener(V,"touchend",this.touchend),n.removeEventListener(V,"touchcancel",this.reset),this.offTemp()},Qs.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(e.window,"mousemove",this.mousemove),n.removeEventListener(e.window,"mouseup",this.mouseup)},Qs.prototype.mousedown=function(V){this.down(e.extend({},V,{ctrlKey:!0,preventDefault:function(){return V.preventDefault()}}),n.mousePos(this.element,V)),n.addEventListener(e.window,"mousemove",this.mousemove),n.addEventListener(e.window,"mouseup",this.mouseup)},Qs.prototype.mousemove=function(V){this.move(V,n.mousePos(this.element,V))},Qs.prototype.mouseup=function(V){this.mouseRotate.mouseupWindow(V),this.mousePitch&&this.mousePitch.mouseupWindow(V),this.offTemp()},Qs.prototype.touchstart=function(V){V.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,V.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return V.preventDefault()}},this._startPos))},Qs.prototype.touchmove=function(V){V.targetTouches.length!==1?this.reset():(this._lastPos=n.touchPos(this.element,V.targetTouches)[0],this.move({preventDefault:function(){return V.preventDefault()}},this._lastPos))},Qs.prototype.touchend=function(V){V.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Qs.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};function bu(fe,V,ve){if(fe=new e.LngLat(fe.lng,fe.lat),V){var Z=new e.LngLat(fe.lng-360,fe.lat),pe=new e.LngLat(fe.lng+360,fe.lat),Me=ve.locationPoint(fe).distSqr(V);ve.locationPoint(Z).distSqr(V)<Me?fe=Z:ve.locationPoint(pe).distSqr(V)<Me&&(fe=pe)}for(;Math.abs(fe.lng-ve.center.lng)>180;){var Re=ve.locationPoint(fe);if(Re.x>=0&&Re.y>=0&&Re.x<=ve.width&&Re.y<=ve.height)break;fe.lng>ve.center.lng?fe.lng-=360:fe.lng+=360}return fe}var gf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ef(fe,V,ve){var Z=fe.classList;for(var pe in gf)Z.remove("mapboxgl-"+ve+"-anchor-"+pe);Z.add("mapboxgl-"+ve+"-anchor-"+V)}var tf=function(fe){function V(ve,Z){var pe=this;if(fe.call(this),(ve instanceof e.window.HTMLElement||Z)&&(ve=e.extend({element:ve},Z)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=ve&&ve.anchor||"center",this._color=ve&&ve.color||"#3FB1CE",this._draggable=ve&&ve.draggable||!1,this._state="inactive",this._rotation=ve&&ve.rotation||0,this._rotationAlignment=ve&&ve.rotationAlignment||"auto",this._pitchAlignment=ve&&ve.pitchAlignment&&ve.pitchAlignment!=="auto"?ve.pitchAlignment:this._rotationAlignment,!ve||!ve.element){this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var Me=n.createNS("http://www.w3.org/2000/svg","svg");Me.setAttributeNS(null,"display","block"),Me.setAttributeNS(null,"height","41px"),Me.setAttributeNS(null,"width","27px"),Me.setAttributeNS(null,"viewBox","0 0 27 41");var Re=n.createNS("http://www.w3.org/2000/svg","g");Re.setAttributeNS(null,"stroke","none"),Re.setAttributeNS(null,"stroke-width","1"),Re.setAttributeNS(null,"fill","none"),Re.setAttributeNS(null,"fill-rule","evenodd");var je=n.createNS("http://www.w3.org/2000/svg","g");je.setAttributeNS(null,"fill-rule","nonzero");var ut=n.createNS("http://www.w3.org/2000/svg","g");ut.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ut.setAttributeNS(null,"fill","#000000");for(var Ct=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}],Qt=0,ur=Ct;Qt<ur.length;Qt+=1){var vr=ur[Qt],Cr=n.createNS("http://www.w3.org/2000/svg","ellipse");Cr.setAttributeNS(null,"opacity","0.04"),Cr.setAttributeNS(null,"cx","10.5"),Cr.setAttributeNS(null,"cy","5.80029008"),Cr.setAttributeNS(null,"rx",vr.rx),Cr.setAttributeNS(null,"ry",vr.ry),ut.appendChild(Cr)}var Vr=n.createNS("http://www.w3.org/2000/svg","g");Vr.setAttributeNS(null,"fill",this._color);var Wr=n.createNS("http://www.w3.org/2000/svg","path");Wr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Vr.appendChild(Wr);var Ur=n.createNS("http://www.w3.org/2000/svg","g");Ur.setAttributeNS(null,"opacity","0.25"),Ur.setAttributeNS(null,"fill","#000000");var Jr=n.createNS("http://www.w3.org/2000/svg","path");Jr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ur.appendChild(Jr);var hn=n.createNS("http://www.w3.org/2000/svg","g");hn.setAttributeNS(null,"transform","translate(6.0, 7.0)"),hn.setAttributeNS(null,"fill","#FFFFFF");var Cn=n.createNS("http://www.w3.org/2000/svg","g");Cn.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Fn=n.createNS("http://www.w3.org/2000/svg","circle");Fn.setAttributeNS(null,"fill","#000000"),Fn.setAttributeNS(null,"opacity","0.25"),Fn.setAttributeNS(null,"cx","5.5"),Fn.setAttributeNS(null,"cy","5.5"),Fn.setAttributeNS(null,"r","5.4999962");var Kn=n.createNS("http://www.w3.org/2000/svg","circle");Kn.setAttributeNS(null,"fill","#FFFFFF"),Kn.setAttributeNS(null,"cx","5.5"),Kn.setAttributeNS(null,"cy","5.5"),Kn.setAttributeNS(null,"r","5.4999962"),Cn.appendChild(Fn),Cn.appendChild(Kn),je.appendChild(ut),je.appendChild(Vr),je.appendChild(Ur),je.appendChild(hn),je.appendChild(Cn),Me.appendChild(je),this._element.appendChild(Me),this._offset=e.Point.convert(ve&&ve.offset||[0,-14])}else this._element=ve.element,this._offset=e.Point.convert(ve&&ve.offset||[0,0]);this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(qn){qn.preventDefault()}),this._element.addEventListener("mousedown",function(qn){qn.preventDefault()}),this._element.addEventListener("focus",function(){var qn=pe._map.getContainer();qn.scrollTop=0,qn.scrollLeft=0}),Ef(this._element,this._anchor,"marker"),this._popup=null}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.addTo=function(Z){return this.remove(),this._map=Z,Z.getCanvasContainer().appendChild(this._element),Z.on("move",this._update),Z.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},V.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},V.prototype.getLngLat=function(){return this._lngLat},V.prototype.setLngLat=function(Z){return this._lngLat=e.LngLat.convert(Z),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},V.prototype.getElement=function(){return this._element},V.prototype.setPopup=function(Z){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),Z){if(!("offset"in Z.options)){var pe=38.1,Me=13.5,Re=Math.sqrt(Math.pow(Me,2)/2);Z.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-pe],"bottom-left":[Re,(pe-Me+Re)*-1],"bottom-right":[-Re,(pe-Me+Re)*-1],left:[Me,(pe-Me)*-1],right:[-Me,(pe-Me)*-1]}:this._offset}this._popup=Z,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},V.prototype._onKeyPress=function(Z){var pe=Z.code,Me=Z.charCode||Z.keyCode;(pe==="Space"||pe==="Enter"||Me===32||Me===13)&&this.togglePopup()},V.prototype._onMapClick=function(Z){var pe=Z.originalEvent.target,Me=this._element;this._popup&&(pe===Me||Me.contains(pe))&&this.togglePopup()},V.prototype.getPopup=function(){return this._popup},V.prototype.togglePopup=function(){var Z=this._popup;if(Z)Z.isOpen()?Z.remove():Z.addTo(this._map);else return this;return this},V.prototype._update=function(Z){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=bu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var pe="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?pe="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(pe="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var Me="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?Me="rotateX(0deg)":this._pitchAlignment==="map"&&(Me="rotateX("+this._map.getPitch()+"deg)"),(!Z||Z.type==="moveend")&&(this._pos=this._pos.round()),n.setTransform(this._element,gf[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+Me+" "+pe)}},V.prototype.getOffset=function(){return this._offset},V.prototype.setOffset=function(Z){return this._offset=e.Point.convert(Z),this._update(),this},V.prototype._onMove=function(Z){this._pos=Z.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},V.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},V.prototype._addDragHandler=function(Z){this._element.contains(Z.originalEvent.target)&&(Z.preventDefault(),this._positionDelta=Z.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},V.prototype.setDraggable=function(Z){return this._draggable=!!Z,this._map&&(Z?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},V.prototype.isDraggable=function(){return this._draggable},V.prototype.setRotation=function(Z){return this._rotation=Z||0,this._update(),this},V.prototype.getRotation=function(){return this._rotation},V.prototype.setRotationAlignment=function(Z){return this._rotationAlignment=Z||"auto",this._update(),this},V.prototype.getRotationAlignment=function(){return this._rotationAlignment},V.prototype.setPitchAlignment=function(Z){return this._pitchAlignment=Z&&Z!=="auto"?Z:this._rotationAlignment,this._update(),this},V.prototype.getPitchAlignment=function(){return this._pitchAlignment},V}(e.Evented),ec={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Nu;function yf(fe){Nu!==void 0?fe(Nu):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(V){Nu=V.state!=="denied",fe(Nu)}):(Nu=!!e.window.navigator.geolocation,fe(Nu))}var rf=0,Uu=!1,tc=function(fe){function V(ve){fe.call(this),this.options=e.extend({},ec,ve),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.onAdd=function(Z){return this._map=Z,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),yf(this._setupUI),this._container},V.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,rf=0,Uu=!1},V.prototype._isOutOfMapMaxBounds=function(Z){var pe=this._map.getMaxBounds(),Me=Z.coords;return pe&&(Me.longitude<pe.getWest()||Me.longitude>pe.getEast()||Me.latitude<pe.getSouth()||Me.latitude>pe.getNorth())},V.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break}},V.prototype._onSuccess=function(Z){if(this._map){if(this._isOutOfMapMaxBounds(Z)){this._setErrorState(),this.fire(new e.Event("outofmaxbounds",Z)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=Z,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(Z),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(Z),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",Z)),this._finish()}},V.prototype._updateCamera=function(Z){var pe=new e.LngLat(Z.coords.longitude,Z.coords.latitude),Me=Z.coords.accuracy,Re=this._map.getBearing(),je=e.extend({bearing:Re},this.options.fitBoundsOptions);this._map.fitBounds(pe.toBounds(Me),je,{geolocateSource:!0})},V.prototype._updateMarker=function(Z){if(Z){var pe=new e.LngLat(Z.coords.longitude,Z.coords.latitude);this._accuracyCircleMarker.setLngLat(pe).addTo(this._map),this._userLocationDotMarker.setLngLat(pe).addTo(this._map),this._accuracy=Z.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},V.prototype._updateCircleRadius=function(){var Z=this._map._container.clientHeight/2,pe=this._map.unproject([0,Z]),Me=this._map.unproject([1,Z]),Re=pe.distanceTo(Me),je=Math.ceil(2*this._accuracy/Re);this._circleElement.style.width=je+"px",this._circleElement.style.height=je+"px"},V.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},V.prototype._onError=function(Z){if(this._map){if(this.options.trackUserLocation)if(Z.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var pe=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=pe,this._geolocateButton.setAttribute("aria-label",pe),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(Z.code===3&&Uu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",Z)),this._finish()}},V.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},V.prototype._setupUI=function(Z){var pe=this;if(this._container.addEventListener("contextmenu",function(je){return je.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",Z===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var Me=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=Me,this._geolocateButton.setAttribute("aria-label",Me)}else{var Re=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=Re,this._geolocateButton.setAttribute("aria-label",Re)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new tf(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new tf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(je){var ut=je.originalEvent&&je.originalEvent.type==="resize";!je.geolocateSource&&pe._watchState==="ACTIVE_LOCK"&&!ut&&(pe._watchState="BACKGROUND",pe._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),pe._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),pe.fire(new e.Event("trackuserlocationend")))})},V.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":rf--,Uu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"));break}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),rf++;var Z;rf>1?(Z={maximumAge:6e5,timeout:0},Uu=!0):(Z=this.options.positionOptions,Uu=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Z)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},V.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},V}(e.Evented),bc={maxWidth:100,unit:"metric"},Hu=function(V){this.options=e.extend({},bc,V),e.bindAll(["_onMove","setUnit"],this)};Hu.prototype.getDefaultPosition=function(){return"bottom-left"},Hu.prototype._onMove=function(){rc(this._map,this._container,this.options)},Hu.prototype.onAdd=function(V){return this._map=V,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",V.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Hu.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Hu.prototype.setUnit=function(V){this.options.unit=V,rc(this._map,this._container,this.options)};function rc(fe,V,ve){var Z=ve&&ve.maxWidth||100,pe=fe._container.clientHeight/2,Me=fe.unproject([0,pe]),Re=fe.unproject([Z,pe]),je=Me.distanceTo(Re);if(ve&&ve.unit==="imperial"){var ut=3.2808*je;if(ut>5280){var Ct=ut/5280;nf(V,Z,Ct,fe._getUIString("ScaleControl.Miles"))}else nf(V,Z,ut,fe._getUIString("ScaleControl.Feet"))}else if(ve&&ve.unit==="nautical"){var Qt=je/1852;nf(V,Z,Qt,fe._getUIString("ScaleControl.NauticalMiles"))}else je>=1e3?nf(V,Z,je/1e3,fe._getUIString("ScaleControl.Kilometers")):nf(V,Z,je,fe._getUIString("ScaleControl.Meters"))}function nf(fe,V,ve,Z){var pe=wc(ve),Me=pe/ve;fe.style.width=V*Me+"px",fe.innerHTML=pe+"&nbsp;"+Z}function _c(fe){var V=Math.pow(10,Math.ceil(-Math.log(fe)/Math.LN10));return Math.round(fe*V)/V}function wc(fe){var V=Math.pow(10,(""+Math.floor(fe)).length-1),ve=fe/V;return ve=ve>=10?10:ve>=5?5:ve>=3?3:ve>=2?2:ve>=1?1:_c(ve),V*ve}var Hl=function(V){this._fullscreen=!1,V&&V.container&&(V.container instanceof e.window.HTMLElement?this._container=V.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Hl.prototype.onAdd=function(V){return this._map=V,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Hl.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Hl.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Hl.prototype._setupUI=function(){var V=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",V).setAttribute("aria-hidden",!0),V.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Hl.prototype._updateTitle=function(){var V=this._getTitle();this._fullscreenButton.setAttribute("aria-label",V),this._fullscreenButton.title=V},Hl.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Hl.prototype._isFullscreen=function(){return this._fullscreen},Hl.prototype._changeIcon=function(){var V=e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement;V===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Hl.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Tc={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Ac=function(fe){function V(ve){fe.call(this),this.options=e.extend(Object.create(Tc),ve),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return fe&&(V.__proto__=fe),V.prototype=Object.create(fe&&fe.prototype),V.prototype.constructor=V,V.prototype.addTo=function(Z){return this._map&&this.remove(),this._map=Z,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},V.prototype.isOpen=function(){return!!this._map},V.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},V.prototype.getLngLat=function(){return this._lngLat},V.prototype.setLngLat=function(Z){return this._lngLat=e.LngLat.convert(Z),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},V.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},V.prototype.getElement=function(){return this._container},V.prototype.setText=function(Z){return this.setDOMContent(e.window.document.createTextNode(Z))},V.prototype.setHTML=function(Z){var pe=e.window.document.createDocumentFragment(),Me=e.window.document.createElement("body"),Re;for(Me.innerHTML=Z;Re=Me.firstChild,!!Re;)pe.appendChild(Re);return this.setDOMContent(pe)},V.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},V.prototype.setMaxWidth=function(Z){return this.options.maxWidth=Z,this._update(),this},V.prototype.setDOMContent=function(Z){return this._createContent(),this._content.appendChild(Z),this._update(),this},V.prototype.addClassName=function(Z){this._container&&this._container.classList.add(Z)},V.prototype.removeClassName=function(Z){this._container&&this._container.classList.remove(Z)},V.prototype.toggleClassName=function(Z){if(this._container)return this._container.classList.toggle(Z)},V.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},V.prototype._onMouseUp=function(Z){this._update(Z.point)},V.prototype._onMouseMove=function(Z){this._update(Z.point)},V.prototype._onDrag=function(Z){this._update(Z.point)},V.prototype._update=function(Z){var pe=this,Me=this._lngLat||this._trackPointer;if(!(!this._map||!Me||!this._content)&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Cr){return pe._container.classList.add(Cr)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bu(this._lngLat,this._pos,this._map.transform)),!(this._trackPointer&&!Z))){var Re=this._pos=this._trackPointer&&Z?Z:this._map.project(this._lngLat),je=this.options.anchor,ut=nc(this.options.offset);if(!je){var Ct=this._container.offsetWidth,Qt=this._container.offsetHeight,ur;Re.y+ut.bottom.y<Qt?ur=["top"]:Re.y>this._map.transform.height-Qt?ur=["bottom"]:ur=[],Re.x<Ct/2?ur.push("left"):Re.x>this._map.transform.width-Ct/2&&ur.push("right"),ur.length===0?je="bottom":je=ur.join("-")}var vr=Re.add(ut[je]).round();n.setTransform(this._container,gf[je]+" translate("+vr.x+"px,"+vr.y+"px)"),Ef(this._container,je,"popup")}},V.prototype._onClose=function(){this.remove()},V}(e.Evented);function nc(fe){if(fe)if(typeof fe=="number"){var V=Math.round(Math.sqrt(.5*Math.pow(fe,2)));return{center:new e.Point(0,0),top:new e.Point(0,fe),"top-left":new e.Point(V,V),"top-right":new e.Point(-V,V),bottom:new e.Point(0,-fe),"bottom-left":new e.Point(V,-V),"bottom-right":new e.Point(-V,-V),left:new e.Point(fe,0),right:new e.Point(-fe,0)}}else if(fe instanceof e.Point||Array.isArray(fe)){var ve=e.Point.convert(fe);return{center:ve,top:ve,"top-left":ve,"top-right":ve,bottom:ve,"bottom-left":ve,"bottom-right":ve,left:ve,right:ve}}else return{center:e.Point.convert(fe.center||[0,0]),top:e.Point.convert(fe.top||[0,0]),"top-left":e.Point.convert(fe["top-left"]||[0,0]),"top-right":e.Point.convert(fe["top-right"]||[0,0]),bottom:e.Point.convert(fe.bottom||[0,0]),"bottom-left":e.Point.convert(fe["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(fe["bottom-right"]||[0,0]),left:e.Point.convert(fe.left||[0,0]),right:e.Point.convert(fe.right||[0,0])};else return nc(new e.Point(0,0))}var Mc={version:e.version,supported:a,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:qf,NavigationControl:xu,GeolocateControl:tc,AttributionControl:Ml,ScaleControl:Hu,FullscreenControl:Hl,Popup:Ac,Marker:tf,Style:jo,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:ar,clearPrewarmedResources:kr,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(fe){e.config.ACCESS_TOKEN=fe},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(fe){e.config.API_URL=fe},get workerCount(){return kt.workerCount},set workerCount(fe){kt.workerCount=fe},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(fe){e.config.MAX_PARALLEL_IMAGE_REQUESTS=fe},clearStorage:function(V){e.clearTileCache(V)},workerUrl:""};return Mc}),S})},{}],240:[function(y,ee,te){ee.exports=Math.log2||function(A){return Math.log(A)*Math.LOG2E}},{}],241:[function(y,ee,te){ee.exports=g;var A=y("mouse-event");function g(S,M){M||(M=S,S=window);var e=0,a=0,n=0,r={shift:!1,alt:!1,control:!1,meta:!1},t=!1;function h(w){var _=!1;return"altKey"in w&&(_=_||w.altKey!==r.alt,r.alt=!!w.altKey),"shiftKey"in w&&(_=_||w.shiftKey!==r.shift,r.shift=!!w.shiftKey),"ctrlKey"in w&&(_=_||w.ctrlKey!==r.control,r.control=!!w.ctrlKey),"metaKey"in w&&(_=_||w.metaKey!==r.meta,r.meta=!!w.metaKey),_}function s(w,_){var c=A.x(_),b=A.y(_);"buttons"in _&&(w=_.buttons|0),(w!==e||c!==a||b!==n||h(_))&&(e=w|0,a=c||0,n=b||0,M&&M(e,a,n,r))}function i(w){s(0,w)}function x(){(e||a||n||r.shift||r.alt||r.meta||r.control)&&(a=n=0,e=0,r.shift=r.alt=r.control=r.meta=!1,M&&M(0,0,0,r))}function p(w){h(w)&&M&&M(e,a,n,r)}function v(w){A.buttons(w)===0?s(0,w):s(e,w)}function f(w){s(e|A.buttons(w),w)}function d(w){s(e&~A.buttons(w),w)}function o(){t||(t=!0,S.addEventListener("mousemove",v),S.addEventListener("mousedown",f),S.addEventListener("mouseup",d),S.addEventListener("mouseleave",i),S.addEventListener("mouseenter",i),S.addEventListener("mouseout",i),S.addEventListener("mouseover",i),S.addEventListener("blur",x),S.addEventListener("keyup",p),S.addEventListener("keydown",p),S.addEventListener("keypress",p),S!==window&&(window.addEventListener("blur",x),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}function m(){t&&(t=!1,S.removeEventListener("mousemove",v),S.removeEventListener("mousedown",f),S.removeEventListener("mouseup",d),S.removeEventListener("mouseleave",i),S.removeEventListener("mouseenter",i),S.removeEventListener("mouseout",i),S.removeEventListener("mouseover",i),S.removeEventListener("blur",x),S.removeEventListener("keyup",p),S.removeEventListener("keydown",p),S.removeEventListener("keypress",p),S!==window&&(window.removeEventListener("blur",x),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))}o();var l={element:S};return Object.defineProperties(l,{enabled:{get:function(){return t},set:function(w){w?o():m()},enumerable:!0},buttons:{get:function(){return e},enumerable:!0},x:{get:function(){return a},enumerable:!0},y:{get:function(){return n},enumerable:!0},mods:{get:function(){return r},enumerable:!0}}),l}},{"mouse-event":243}],242:[function(y,ee,te){var A={left:0,top:0};ee.exports=g;function g(M,e,a){e=e||M.currentTarget||M.srcElement,Array.isArray(a)||(a=[0,0]);var n=M.clientX||0,r=M.clientY||0,t=S(e);return a[0]=n-t.left,a[1]=r-t.top,a}function S(M){return M===window||M===document||M===document.body?A:M.getBoundingClientRect()}},{}],243:[function(y,ee,te){function A(e){if(typeof e=="object"){if("buttons"in e)return e.buttons;if("which"in e){var a=e.which;if(a===2)return 4;if(a===3)return 2;if(a>0)return 1<<a-1}else if("button"in e){var a=e.button;if(a===1)return 4;if(a===2)return 2;if(a>=0)return 1<<a}}return 0}te.buttons=A;function g(e){return e.target||e.srcElement||window}te.element=g;function S(e){if(typeof e=="object"){if("offsetX"in e)return e.offsetX;var a=g(e),n=a.getBoundingClientRect();return e.clientX-n.left}return 0}te.x=S;function M(e){if(typeof e=="object"){if("offsetY"in e)return e.offsetY;var a=g(e),n=a.getBoundingClientRect();return e.clientY-n.top}return 0}te.y=M},{}],244:[function(y,ee,te){var A=y("to-px");ee.exports=g;function g(S,M,e){typeof S=="function"&&(e=!!M,M=S,S=window);var a=A("ex",S),n=function(r){e&&r.preventDefault();var t=r.deltaX||0,h=r.deltaY||0,s=r.deltaZ||0,i=r.deltaMode,x=1;switch(i){case 1:x=a;break;case 2:x=window.innerHeight;break}if(t*=x,h*=x,s*=x,t||h||s)return M(t,h,s,r)};return S.addEventListener("wheel",n),n}},{"to-px":315}],245:[function(y,ee,te){(function(A,g){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(M,e,a){e[M]=e[M]||a(),typeof ee<"u"&&ee.exports&&(ee.exports=e[M])})("Promise",typeof A<"u"?A:this,function(){var M,e,a,n=Object.prototype.toString,r=typeof g<"u"?function(w){return g(w)}:setTimeout;try{Object.defineProperty({},"x",{}),M=function(w,_,c,b){return Object.defineProperty(w,_,{value:c,writable:!0,configurable:b!==!1})}}catch{M=function(_,c,b){return _[c]=b,_}}a=function(){var w,_,c;function b(u,L){this.fn=u,this.self=L,this.next=void 0}return{add:function(L,T){c=new b(L,T),_?_.next=c:w=c,_=c,c=void 0},drain:function(){var L=w;for(w=_=e=void 0;L;)L.fn.call(L.self),L=L.next}}}();function t(l,w){a.add(l,w),e||(e=r(a.drain))}function h(l){var w,_=typeof l;return l!=null&&(_=="object"||_=="function")&&(w=l.then),typeof w=="function"?w:!1}function s(){for(var l=0;l<this.chain.length;l++)i(this,this.state===1?this.chain[l].success:this.chain[l].failure,this.chain[l]);this.chain.length=0}function i(l,w,_){var c,b;try{w===!1?_.reject(l.msg):(w===!0?c=l.msg:c=w.call(void 0,l.msg),c===_.promise?_.reject(TypeError("Promise-chain cycle")):(b=h(c))?b.call(c,_.resolve,_.reject):_.resolve(c))}catch(u){_.reject(u)}}function x(l){var w,_=this;if(!_.triggered){_.triggered=!0,_.def&&(_=_.def);try{(w=h(l))?t(function(){var c=new f(_);try{w.call(l,function(){x.apply(c,arguments)},function(){p.apply(c,arguments)})}catch(b){p.call(c,b)}}):(_.msg=l,_.state=1,_.chain.length>0&&t(s,_))}catch(c){p.call(new f(_),c)}}}function p(l){var w=this;w.triggered||(w.triggered=!0,w.def&&(w=w.def),w.msg=l,w.state=2,w.chain.length>0&&t(s,w))}function v(l,w,_,c){for(var b=0;b<w.length;b++)(function(L){l.resolve(w[L]).then(function(k){_(L,k)},c)})(b)}function f(l){this.def=l,this.triggered=!1}function d(l){this.promise=l,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function o(l){if(typeof l!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var w=new d(this);this.then=function(c,b){var u={success:typeof c=="function"?c:!0,failure:typeof b=="function"?b:!1};return u.promise=new this.constructor(function(T,k){if(typeof T!="function"||typeof k!="function")throw TypeError("Not a function");u.resolve=T,u.reject=k}),w.chain.push(u),w.state!==0&&t(s,w),u.promise},this.catch=function(c){return this.then(void 0,c)};try{l.call(void 0,function(c){x.call(w,c)},function(c){p.call(w,c)})}catch(_){p.call(w,_)}}var m=M({},"constructor",o,!1);return o.prototype=m,M(m,"__NPO__",0,!1),M(o,"resolve",function(w){var _=this;return w&&typeof w=="object"&&w.__NPO__===1?w:new _(function(b,u){if(typeof b!="function"||typeof u!="function")throw TypeError("Not a function");b(w)})}),M(o,"reject",function(w){return new this(function(c,b){if(typeof c!="function"||typeof b!="function")throw TypeError("Not a function");b(w)})}),M(o,"all",function(w){var _=this;return n.call(w)!="[object Array]"?_.reject(TypeError("Not an array")):w.length===0?_.resolve([]):new _(function(b,u){if(typeof b!="function"||typeof u!="function")throw TypeError("Not a function");var L=w.length,T=Array(L),k=0;v(_,w,function(z,I){T[z]=I,++k===L&&b(T)},u)})}),M(o,"race",function(w){var _=this;return n.call(w)!="[object Array]"?_.reject(TypeError("Not an array")):new _(function(b,u){if(typeof b!="function"||typeof u!="function")throw TypeError("Not a function");v(_,w,function(T,k){b(k)},u)})}),o})}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{},y("timers").setImmediate)},{timers:312}],246:[function(y,ee,te){var A=Math.PI,g=r(120);ee.exports=S;function S(t){for(var h,s=[],i=0,x=0,p=0,v=0,f=null,d=null,o=0,m=0,l=0,w=t.length;l<w;l++){var _=t[l],c=_[0];switch(c){case"M":p=_[1],v=_[2];break;case"A":_=a(o,m,_[1],_[2],r(_[3]),_[4],_[5],_[6],_[7]),_.unshift("C"),_.length>7&&(s.push(_.splice(0,7)),_.unshift("C"));break;case"S":var b=o,u=m;(h=="C"||h=="S")&&(b+=b-i,u+=u-x),_=["C",b,u,_[1],_[2],_[3],_[4]];break;case"T":h=="Q"||h=="T"?(f=o*2-f,d=m*2-d):(f=o,d=m),_=e(o,m,f,d,_[1],_[2]);break;case"Q":f=_[1],d=_[2],_=e(o,m,_[1],_[2],_[3],_[4]);break;case"L":_=M(o,m,_[1],_[2]);break;case"H":_=M(o,m,_[1],m);break;case"V":_=M(o,m,o,_[1]);break;case"Z":_=M(o,m,p,v);break}h=c,o=_[_.length-2],m=_[_.length-1],_.length>4?(i=_[_.length-4],x=_[_.length-3]):(i=o,x=m),s.push(_)}return s}function M(t,h,s,i){return["C",t,h,s,i,s,i]}function e(t,h,s,i,x,p){return["C",t/3+2/3*s,h/3+2/3*i,x/3+2/3*s,p/3+2/3*i,x,p]}function a(t,h,s,i,x,p,v,f,d,o){if(o)k=o[0],P=o[1],L=o[2],T=o[3];else{var m=n(t,h,-x);t=m.x,h=m.y,m=n(f,d,-x),f=m.x,d=m.y;var l=(t-f)/2,w=(h-d)/2,_=l*l/(s*s)+w*w/(i*i);_>1&&(_=Math.sqrt(_),s=_*s,i=_*i);var c=s*s,b=i*i,u=(p==v?-1:1)*Math.sqrt(Math.abs((c*b-c*w*w-b*l*l)/(c*w*w+b*l*l)));u==1/0&&(u=1);var L=u*s*w/i+(t+f)/2,T=u*-i*l/s+(h+d)/2,k=Math.asin(((h-T)/i).toFixed(9)),P=Math.asin(((d-T)/i).toFixed(9));k=t<L?A-k:k,P=f<L?A-P:P,k<0&&(k=A*2+k),P<0&&(P=A*2+P),v&&k>P&&(k=k-A*2),!v&&P>k&&(P=P-A*2)}if(Math.abs(P-k)>g){var z=P,I=f,D=d;P=k+g*(v&&P>k?1:-1),f=L+s*Math.cos(P),d=T+i*Math.sin(P);var R=a(f,d,s,i,x,0,v,I,D,[P,z,L,T])}var O=Math.tan((P-k)/4),F=4/3*s*O,N=4/3*i*O,G=[2*t-(t+F*Math.sin(k)),2*h-(h-N*Math.cos(k)),f+F*Math.sin(P),d-N*Math.cos(P),f,d];if(o)return G;R&&(G=G.concat(R));for(var K=0;K<G.length;){var W=n(G[K],G[K+1],x);G[K++]=W.x,G[K++]=W.y}return G}function n(t,h,s){return{x:t*Math.cos(s)-h*Math.sin(s),y:t*Math.sin(s)+h*Math.cos(s)}}function r(t){return t*(A/180)}},{}],247:[function(y,ee,te){var A=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;function M(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function e(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var n={},r=0;r<10;r++)n["_"+String.fromCharCode(r)]=r;var t=Object.getOwnPropertyNames(n).map(function(s){return n[s]});if(t.join("")!=="0123456789")return!1;var h={};return"abcdefghijklmnopqrst".split("").forEach(function(s){h[s]=s}),Object.keys(Object.assign({},h)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}ee.exports=e()?Object.assign:function(a,n){for(var r,t=M(a),h,s=1;s<arguments.length;s++){r=Object(arguments[s]);for(var i in r)g.call(r,i)&&(t[i]=r[i]);if(A){h=A(r);for(var x=0;x<h.length;x++)S.call(r,h[x])&&(t[h[x]]=r[h[x]])}}return t}},{}],248:[function(y,ee,te){function A(M,e){if(typeof M!="string")return[M];var a=[M];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],r=e.escape||"___",t=!!e.flat;n.forEach(function(i){var x=new RegExp(["\\",i[0],"[^\\",i[0],"\\",i[1],"]*\\",i[1]].join("")),p=[];function v(f,d,o){var m=a.push(f.slice(i[0].length,-i[1].length))-1;return p.push(m),r+m+r}a.forEach(function(f,d){for(var o,m=0;f!=o;)if(o=f,f=f.replace(x,v),m++>1e4)throw Error("References have circular dependency. Please, check them.");a[d]=f}),p=p.reverse(),a=a.map(function(f){return p.forEach(function(d){f=f.replace(new RegExp("(\\"+r+d+"\\"+r+")","g"),i[0]+"$1"+i[1])}),f})});var h=new RegExp("\\"+r+"([0-9]+)\\"+r);function s(i,x,p){for(var v=[],f,d=0;f=h.exec(i);){if(d++>1e4)throw Error("Circular references in parenthesis");v.push(i.slice(0,f.index)),v.push(s(x[f[1]],x)),i=i.slice(f.index+f[0].length)}return v.push(i),v}return t?a:s(a[0],a)}function g(M,e){if(e&&e.flat){var a=e&&e.escape||"___",n=M[0],r;if(!n)return"";for(var t=new RegExp("\\"+a+"([0-9]+)\\"+a),h=0;n!=r;){if(h++>1e4)throw Error("Circular references in "+M);r=n,n=n.replace(t,s)}return n}return M.reduce(function i(x,p){return Array.isArray(p)&&(p=p.reduce(i,"")),x+p},"");function s(i,x){if(M[x]==null)throw Error("Reference "+x+"is undefined");return M[x]}}function S(M,e){return Array.isArray(M)?g(M,e):A(M,e)}S.parse=A,S.stringify=g,ee.exports=S},{}],249:[function(y,ee,te){var A=y("pick-by-alias");ee.exports=g;function g(S){var M;return arguments.length>1&&(S=arguments),typeof S=="string"?S=S.split(/\s/).map(parseFloat):typeof S=="number"&&(S=[S]),S.length&&typeof S[0]=="number"?S.length===1?M={width:S[0],height:S[0],x:0,y:0}:S.length===2?M={width:S[0],height:S[1],x:0,y:0}:M={x:S[0],y:S[1],width:S[2]-S[0]||0,height:S[3]-S[1]||0}:S&&(S=A(S,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),M={x:S.left||0,y:S.top||0},S.width==null?S.right?M.width=S.right-M.x:M.width=0:M.width=S.width,S.height==null?S.bottom?M.height=S.bottom-M.y:M.height=0:M.height=S.height),M}},{"pick-by-alias":253}],250:[function(y,ee,te){ee.exports=S;var A={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},g=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function S(a){var n=[];return a.replace(g,function(r,t,h){var s=t.toLowerCase();for(h=e(h),s=="m"&&h.length>2&&(n.push([t].concat(h.splice(0,2))),s="l",t=t=="m"?"l":"L");;){if(h.length==A[s])return h.unshift(t),n.push(h);if(h.length<A[s])throw new Error("malformed path data");n.push([t].concat(h.splice(0,A[s])))}}),n}var M=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function e(a){var n=a.match(M);return n?n.map(Number):[]}},{}],251:[function(y,ee,te){ee.exports=function(g,S){S||(S=[0,""]),g=String(g);var M=parseFloat(g,10);return S[0]=M,S[1]=g.match(/[\d.\-\+]*\s*(.*)/)[1]||"",S}},{}],252:[function(y,ee,te){(function(A){(function(){(function(){var g,S,M,e,a,n;typeof performance<"u"&&performance!==null&&performance.now?ee.exports=function(){return performance.now()}:typeof A<"u"&&A!==null&&A.hrtime?(ee.exports=function(){return(g()-a)/1e6},S=A.hrtime,g=function(){var r;return r=S(),r[0]*1e9+r[1]},e=g(),n=A.uptime()*1e9,a=e-n):Date.now?(ee.exports=function(){return Date.now()-M},M=Date.now()):(ee.exports=function(){return new Date().getTime()-M},M=new Date().getTime())}).call(this)}).call(this)}).call(this,y("_process"))},{_process:278}],253:[function(y,ee,te){ee.exports=function(M,e,a){var n={},r,t;if(typeof e=="string"&&(e=g(e)),Array.isArray(e)){var h={};for(t=0;t<e.length;t++)h[e[t]]=!0;e=h}for(r in e)e[r]=g(e[r]);var s={};for(r in e){var i=e[r];if(Array.isArray(i))for(t=0;t<i.length;t++){var x=i[t];if(a&&(s[x]=!0),x in M){if(n[r]=M[x],a)for(var p=t;p<i.length;p++)s[i[p]]=!0;break}}else r in M&&(e[r]&&(n[r]=M[r]),a&&(s[r]=!0))}if(a)for(r in M)s[r]||(n[r]=M[r]);return n};var A={};function g(S){return A[S]?A[S]:(typeof S=="string"&&(S=A[S]=S.split(/\s*,\s*|\s+/)),S)}},{}],254:[function(y,ee,te){ee.exports=function(g,S,M,e){var a=g[0],n=g[1],r=!1;M===void 0&&(M=0),e===void 0&&(e=S.length);for(var t=e-M,h=0,s=t-1;h<t;s=h++){var i=S[h+M][0],x=S[h+M][1],p=S[s+M][0],v=S[s+M][1],f=x>n!=v>n&&a<(p-i)*(n-x)/(v-x)+i;f&&(r=!r)}return r}},{}],255:[function(y,ee,te){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var A=y("./lib/build-log"),g=y("./lib/epsilon"),S=y("./lib/intersecter"),M=y("./lib/segment-chainer"),e=y("./lib/segment-selector"),a=y("./lib/geojson"),n=!1,r=g(),t;t={buildLog:function(s){return s===!0?n=A():s===!1&&(n=!1),n===!1?!1:n.list},epsilon:function(s){return r.epsilon(s)},segments:function(s){var i=S(!0,r,n);return s.regions.forEach(i.addRegion),{segments:i.calculate(s.inverted),inverted:s.inverted}},combine:function(s,i){var x=S(!1,r,n);return{combined:x.calculate(s.segments,s.inverted,i.segments,i.inverted),inverted1:s.inverted,inverted2:i.inverted}},selectUnion:function(s){return{segments:e.union(s.combined,n),inverted:s.inverted1||s.inverted2}},selectIntersect:function(s){return{segments:e.intersect(s.combined,n),inverted:s.inverted1&&s.inverted2}},selectDifference:function(s){return{segments:e.difference(s.combined,n),inverted:s.inverted1&&!s.inverted2}},selectDifferenceRev:function(s){return{segments:e.differenceRev(s.combined,n),inverted:!s.inverted1&&s.inverted2}},selectXor:function(s){return{segments:e.xor(s.combined,n),inverted:s.inverted1!==s.inverted2}},polygon:function(s){return{regions:M(s.segments,r,n),inverted:s.inverted}},polygonFromGeoJSON:function(s){return a.toPolygon(t,s)},polygonToGeoJSON:function(s){return a.fromPolygon(t,r,s)},union:function(s,i){return h(s,i,t.selectUnion)},intersect:function(s,i){return h(s,i,t.selectIntersect)},difference:function(s,i){return h(s,i,t.selectDifference)},differenceRev:function(s,i){return h(s,i,t.selectDifferenceRev)},xor:function(s,i){return h(s,i,t.selectXor)}};function h(s,i,x){var p=t.segments(s),v=t.segments(i),f=t.combine(p,v),d=x(f);return t.polygon(d)}typeof window=="object"&&(window.PolyBool=t),ee.exports=t},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(y,ee,te){function A(){var g,S=0,M=!1;function e(a,n){return g.list.push({type:a,data:n?JSON.parse(JSON.stringify(n)):void 0}),g}return g={list:[],segmentId:function(){return S++},checkIntersection:function(a,n){return e("check",{seg1:a,seg2:n})},segmentChop:function(a,n){return e("div_seg",{seg:a,pt:n}),e("chop",{seg:a,pt:n})},statusRemove:function(a){return e("pop_seg",{seg:a})},segmentUpdate:function(a){return e("seg_update",{seg:a})},segmentNew:function(a,n){return e("new_seg",{seg:a,primary:n})},segmentRemove:function(a){return e("rem_seg",{seg:a})},tempStatus:function(a,n,r){return e("temp_status",{seg:a,above:n,below:r})},rewind:function(a){return e("rewind",{seg:a})},status:function(a,n,r){return e("status",{seg:a,above:n,below:r})},vert:function(a){return a===M?g:(M=a,e("vert",{x:a}))},log:function(a){return typeof a!="string"&&(a=JSON.stringify(a,!1,"  ")),e("log",{txt:a})},reset:function(){return e("reset")},selected:function(a){return e("selected",{segs:a})},chainStart:function(a){return e("chain_start",{seg:a})},chainRemoveHead:function(a,n){return e("chain_rem_head",{index:a,pt:n})},chainRemoveTail:function(a,n){return e("chain_rem_tail",{index:a,pt:n})},chainNew:function(a,n){return e("chain_new",{pt1:a,pt2:n})},chainMatch:function(a){return e("chain_match",{index:a})},chainClose:function(a){return e("chain_close",{index:a})},chainAddHead:function(a,n){return e("chain_add_head",{index:a,pt:n})},chainAddTail:function(a,n){return e("chain_add_tail",{index:a,pt:n})},chainConnect:function(a,n){return e("chain_con",{index1:a,index2:n})},chainReverse:function(a){return e("chain_rev",{index:a})},chainJoin:function(a,n){return e("chain_join",{index1:a,index2:n})},done:function(){return e("done")}},g}ee.exports=A},{}],257:[function(y,ee,te){function A(g){typeof g!="number"&&(g=1e-10);var S={epsilon:function(M){return typeof M=="number"&&(g=M),g},pointAboveOrOnLine:function(M,e,a){var n=e[0],r=e[1],t=a[0],h=a[1],s=M[0],i=M[1];return(t-n)*(i-r)-(h-r)*(s-n)>=-g},pointBetween:function(M,e,a){var n=M[1]-e[1],r=a[0]-e[0],t=M[0]-e[0],h=a[1]-e[1],s=t*r+n*h;if(s<g)return!1;var i=r*r+h*h;return!(s-i>-g)},pointsSameX:function(M,e){return Math.abs(M[0]-e[0])<g},pointsSameY:function(M,e){return Math.abs(M[1]-e[1])<g},pointsSame:function(M,e){return S.pointsSameX(M,e)&&S.pointsSameY(M,e)},pointsCompare:function(M,e){return S.pointsSameX(M,e)?S.pointsSameY(M,e)?0:M[1]<e[1]?-1:1:M[0]<e[0]?-1:1},pointsCollinear:function(M,e,a){var n=M[0]-e[0],r=M[1]-e[1],t=e[0]-a[0],h=e[1]-a[1];return Math.abs(n*h-t*r)<g},linesIntersect:function(M,e,a,n){var r=e[0]-M[0],t=e[1]-M[1],h=n[0]-a[0],s=n[1]-a[1],i=r*s-t*h;if(Math.abs(i)<g)return!1;var x=M[0]-a[0],p=M[1]-a[1],v=(h*p-s*x)/i,f=(r*p-t*x)/i,d={alongA:0,alongB:0,pt:[M[0]+v*r,M[1]+v*t]};return v<=-g?d.alongA=-2:v<g?d.alongA=-1:v-1<=-g?d.alongA=0:v-1<g?d.alongA=1:d.alongA=2,f<=-g?d.alongB=-2:f<g?d.alongB=-1:f-1<=-g?d.alongB=0:f-1<g?d.alongB=1:d.alongB=2,d},pointInsideRegion:function(M,e){for(var a=M[0],n=M[1],r=e[e.length-1][0],t=e[e.length-1][1],h=!1,s=0;s<e.length;s++){var i=e[s][0],x=e[s][1];x-n>g!=t-n>g&&(r-i)*(n-x)/(t-x)+i-a>g&&(h=!h),r=i,t=x}return h}};return S}ee.exports=A},{}],258:[function(y,ee,te){var A={toPolygon:function(g,S){function M(n){if(n.length<=0)return g.segments({inverted:!1,regions:[]});function r(s){var i=s.slice(0,s.length-1);return g.segments({inverted:!1,regions:[i]})}for(var t=r(n[0]),h=1;h<n.length;h++)t=g.selectDifference(g.combine(t,r(n[h])));return t}if(S.type==="Polygon")return g.polygon(M(S.coordinates));if(S.type==="MultiPolygon"){for(var e=g.segments({inverted:!1,regions:[]}),a=0;a<S.coordinates.length;a++)e=g.selectUnion(g.combine(e,M(S.coordinates[a])));return g.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(g,S,M){M=g.polygon(g.segments(M));function e(v,f){return S.pointInsideRegion([(v[0][0]+v[1][0])*.5,(v[0][1]+v[1][1])*.5],f)}function a(v){return{region:v,children:[]}}var n=a(null);function r(v,f){for(var d=0;d<v.children.length;d++){var o=v.children[d];if(e(f,o.region)){r(o,f);return}}for(var m=a(f),d=0;d<v.children.length;d++){var o=v.children[d];e(o.region,f)&&(m.children.push(o),v.children.splice(d,1),d--)}v.children.push(m)}for(var t=0;t<M.regions.length;t++){var h=M.regions[t];h.length<3||r(n,h)}function s(v,f){for(var d=0,o=v[v.length-1][0],m=v[v.length-1][1],l=[],w=0;w<v.length;w++){var _=v[w][0],c=v[w][1];l.push([_,c]),d+=c*o-_*m,o=_,m=c}var b=d<0;return b!==f&&l.reverse(),l.push([l[0][0],l[0][1]]),l}var i=[];function x(v){var f=[s(v.region,!1)];i.push(f);for(var d=0;d<v.children.length;d++)f.push(p(v.children[d]))}function p(v){for(var f=0;f<v.children.length;f++)x(v.children[f]);return s(v.region,!0)}for(var t=0;t<n.children.length;t++)x(n.children[t]);return i.length<=0?{type:"Polygon",coordinates:[]}:i.length==1?{type:"Polygon",coordinates:i[0]}:{type:"MultiPolygon",coordinates:i}}};ee.exports=A},{}],259:[function(y,ee,te){var A=y("./linked-list");function g(S,M,e){function a(d,o){return{id:e?e.segmentId():-1,start:d,end:o,myFill:{above:null,below:null},otherFill:null}}function n(d,o,m){return{id:e?e.segmentId():-1,start:d,end:o,myFill:{above:m.myFill.above,below:m.myFill.below},otherFill:null}}var r=A.create();function t(d,o,m,l,w,_){var c=M.pointsCompare(o,w);return c!==0?c:M.pointsSame(m,_)?0:d!==l?d?1:-1:M.pointAboveOrOnLine(m,l?w:_,l?_:w)?1:-1}function h(d,o){r.insertBefore(d,function(m){var l=t(d.isStart,d.pt,o,m.isStart,m.pt,m.other.pt);return l<0})}function s(d,o){var m=A.node({isStart:!0,pt:d.start,seg:d,primary:o,other:null,status:null});return h(m,d.end),m}function i(d,o,m){var l=A.node({isStart:!1,pt:o.end,seg:o,primary:m,other:d,status:null});d.other=l,h(l,d.pt)}function x(d,o){var m=s(d,o);return i(m,d,o),m}function p(d,o){e&&e.segmentChop(d.seg,o),d.other.remove(),d.seg.end=o,d.other.pt=o,h(d.other,d.pt)}function v(d,o){var m=n(o,d.seg.end,d.seg);return p(d,o),x(m,d.primary)}function f(d,o){var m=A.create();function l(R,O){var F=R.seg.start,N=R.seg.end,G=O.seg.start,K=O.seg.end;return M.pointsCollinear(F,G,K)?M.pointsCollinear(N,G,K)||M.pointAboveOrOnLine(N,G,K)?1:-1:M.pointAboveOrOnLine(F,G,K)?1:-1}function w(R){return m.findTransition(function(O){var F=l(R,O.ev);return F>0})}function _(R,O){var F=R.seg,N=O.seg,G=F.start,K=F.end,W=N.start,Y=N.end;e&&e.checkIntersection(F,N);var re=M.linesIntersect(G,K,W,Y);if(re===!1){if(!M.pointsCollinear(G,K,W)||M.pointsSame(G,Y)||M.pointsSame(K,W))return!1;var ue=M.pointsSame(G,W),j=M.pointsSame(K,Y);if(ue&&j)return O;var q=!ue&&M.pointBetween(G,W,Y),H=!j&&M.pointBetween(K,W,Y);if(ue)return H?v(O,K):v(R,Y),O;q&&(j||(H?v(O,K):v(R,Y)),v(O,G))}else re.alongA===0&&(re.alongB===-1?v(R,W):re.alongB===0?v(R,re.pt):re.alongB===1&&v(R,Y)),re.alongB===0&&(re.alongA===-1?v(O,G):re.alongA===0?v(O,re.pt):re.alongA===1&&v(O,K));return!1}for(var c=[];!r.isEmpty();){var b=r.getHead();if(e&&e.vert(b.pt[0]),b.isStart){let R=function(){if(L){var O=_(b,L);if(O)return O}return T?_(b,T):!1};e&&e.segmentNew(b.seg,b.primary);var u=w(b),L=u.before?u.before.ev:null,T=u.after?u.after.ev:null;e&&e.tempStatus(b.seg,L?L.seg:!1,T?T.seg:!1);var k=R();if(k){if(S){var P;b.seg.myFill.below===null?P=!0:P=b.seg.myFill.above!==b.seg.myFill.below,P&&(k.seg.myFill.above=!k.seg.myFill.above)}else k.seg.otherFill=b.seg.myFill;e&&e.segmentUpdate(k.seg),b.other.remove(),b.remove()}if(r.getHead()!==b){e&&e.rewind(b.seg);continue}if(S){var P;b.seg.myFill.below===null?P=!0:P=b.seg.myFill.above!==b.seg.myFill.below,T?b.seg.myFill.below=T.seg.myFill.above:b.seg.myFill.below=d,P?b.seg.myFill.above=!b.seg.myFill.below:b.seg.myFill.above=b.seg.myFill.below}else if(b.seg.otherFill===null){var z;T?b.primary===T.primary?z=T.seg.otherFill.above:z=T.seg.myFill.above:z=b.primary?o:d,b.seg.otherFill={above:z,below:z}}e&&e.status(b.seg,L?L.seg:!1,T?T.seg:!1),b.other.status=u.insert(A.node({ev:b}))}else{var I=b.status;if(I===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(m.exists(I.prev)&&m.exists(I.next)&&_(I.prev.ev,I.next.ev),e&&e.statusRemove(I.ev.seg),I.remove(),!b.primary){var D=b.seg.myFill;b.seg.myFill=b.seg.otherFill,b.seg.otherFill=D}c.push(b.seg)}r.getHead().remove()}return e&&e.done(),c}return S?{addRegion:function(d){for(var o,m=d[d.length-1],l=0;l<d.length;l++){o=m,m=d[l];var w=M.pointsCompare(o,m);w!==0&&x(a(w<0?o:m,w<0?m:o),!0)}},calculate:function(d){return f(d,!1)}}:{calculate:function(d,o,m,l){return d.forEach(function(w){x(n(w.start,w.end,w),!0)}),m.forEach(function(w){x(n(w.start,w.end,w),!1)}),f(o,l)}}}ee.exports=g},{"./linked-list":260}],260:[function(y,ee,te){var A={create:function(){var g={root:{root:!0,next:null},exists:function(S){return!(S===null||S===g.root)},isEmpty:function(){return g.root.next===null},getHead:function(){return g.root.next},insertBefore:function(S,M){for(var e=g.root,a=g.root.next;a!==null;){if(M(a)){S.prev=a.prev,S.next=a,a.prev.next=S,a.prev=S;return}e=a,a=a.next}e.next=S,S.prev=e,S.next=null},findTransition:function(S){for(var M=g.root,e=g.root.next;e!==null&&!S(e);)M=e,e=e.next;return{before:M===g.root?null:M,after:e,insert:function(a){return a.prev=M,a.next=e,M.next=a,e!==null&&(e.prev=a),a}}}};return g},node:function(g){return g.prev=null,g.next=null,g.remove=function(){g.prev.next=g.next,g.next&&(g.next.prev=g.prev),g.prev=null,g.next=null},g}};ee.exports=A},{}],261:[function(y,ee,te){function A(g,S,M){var e=[],a=[];return g.forEach(function(n){var r=n.start,t=n.end;if(S.pointsSame(r,t)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");return}M&&M.chainStart(n);var h={index:0,matches_head:!1,matches_pt1:!1},s={index:0,matches_head:!1,matches_pt1:!1},i=h;function x(z,I,D){return i.index=z,i.matches_head=I,i.matches_pt1=D,i===h?(i=s,!1):(i=null,!0)}for(var p=0;p<e.length;p++){var v=e[p],f=v[0];v[1];var d=v[v.length-1];if(v[v.length-2],S.pointsSame(f,r)){if(x(p,!0,!0))break}else if(S.pointsSame(f,t)){if(x(p,!0,!1))break}else if(S.pointsSame(d,r)){if(x(p,!1,!0))break}else if(S.pointsSame(d,t)&&x(p,!1,!1))break}if(i===h){e.push([r,t]),M&&M.chainNew(r,t);return}if(i===s){M&&M.chainMatch(h.index);var o=h.index,m=h.matches_pt1?t:r,l=h.matches_head,v=e[o],w=l?v[0]:v[v.length-1],_=l?v[1]:v[v.length-2],c=l?v[v.length-1]:v[0],b=l?v[v.length-2]:v[1];if(S.pointsCollinear(_,w,m)&&(l?(M&&M.chainRemoveHead(h.index,m),v.shift()):(M&&M.chainRemoveTail(h.index,m),v.pop()),w=_),S.pointsSame(c,m)){e.splice(o,1),S.pointsCollinear(b,c,w)&&(l?(M&&M.chainRemoveTail(h.index,w),v.pop()):(M&&M.chainRemoveHead(h.index,w),v.shift())),M&&M.chainClose(h.index),a.push(v);return}l?(M&&M.chainAddHead(h.index,m),v.unshift(m)):(M&&M.chainAddTail(h.index,m),v.push(m));return}function u(z){M&&M.chainReverse(z),e[z].reverse()}function L(z,I){var D=e[z],R=e[I],O=D[D.length-1],F=D[D.length-2],N=R[0],G=R[1];S.pointsCollinear(F,O,N)&&(M&&M.chainRemoveTail(z,O),D.pop(),O=F),S.pointsCollinear(O,N,G)&&(M&&M.chainRemoveHead(I,N),R.shift()),M&&M.chainJoin(z,I),e[z]=D.concat(R),e.splice(I,1)}var T=h.index,k=s.index;M&&M.chainConnect(T,k);var P=e[T].length<e[k].length;h.matches_head?s.matches_head?P?(u(T),L(T,k)):(u(k),L(k,T)):L(k,T):s.matches_head?L(T,k):P?(u(T),L(k,T)):(u(k),L(T,k))}),a}ee.exports=A},{}],262:[function(y,ee,te){function A(S,M,e){var a=[];return S.forEach(function(n){var r=(n.myFill.above?8:0)+(n.myFill.below?4:0)+(n.otherFill&&n.otherFill.above?2:0)+(n.otherFill&&n.otherFill.below?1:0);M[r]!==0&&a.push({id:e?e.segmentId():-1,start:n.start,end:n.end,myFill:{above:M[r]===1,below:M[r]===2},otherFill:null})}),e&&e.selected(a),a}var g={union:function(S,M){return A(S,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],M)},intersect:function(S,M){return A(S,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],M)},difference:function(S,M){return A(S,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],M)},differenceRev:function(S,M){return A(S,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],M)},xor:function(S,M){return A(S,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],M)}};ee.exports=g},{}],263:[function(y,ee,te){var A=y("stream").Transform,g=y("stream-parser");function S(){A.call(this,{readableObjectMode:!0})}S.prototype=Object.create(A.prototype),S.prototype.constructor=S,g(S.prototype),te.ParserStream=S,te.sliceEq=function(e,a,n){for(var r=a,t=0;t<n.length;)if(e[r++]!==n[t++])return!1;return!0},te.str2arr=function(e,a){var n=[],r=0;if(a&&a==="hex")for(;r<e.length;)n.push(parseInt(e.slice(r,r+2),16)),r+=2;else for(;r<e.length;r++)n.push(e.charCodeAt(r)&255);return n},te.readUInt16LE=function(e,a){return e[a]|e[a+1]<<8},te.readUInt16BE=function(e,a){return e[a+1]|e[a]<<8},te.readUInt32LE=function(e,a){return e[a]|e[a+1]<<8|e[a+2]<<16|e[a+3]*16777216},te.readUInt32BE=function(e,a){return e[a+3]|e[a+2]<<8|e[a+1]<<16|e[a]*16777216};function M(e,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,a&&(this.code=a),n&&(this.statusCode=n)}M.prototype=Object.create(Error.prototype),M.prototype.constructor=M,te.ProbeError=M},{stream:286,"stream-parser":302}],264:[function(y,ee,te){function A(M,e){var a=new Error(M);return a.code=e,a}function g(M){try{return decodeURIComponent(escape(M))}catch{return M}}function S(M,e,a){this.input=M.subarray(e,a),this.start=e;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*")throw A("invalid TIFF signature","EBADDATA");this.big_endian=n[0]==="M"}S.prototype.each=function(M){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var a=this.ifds_to_read.shift();a.offset&&this.scan_ifd(a.id,a.offset,M)}},S.prototype.read_uint16=function(M){var e=this.input;if(M+2>e.length)throw A("unexpected EOF","EBADDATA");return this.big_endian?e[M]*256+e[M+1]:e[M]+e[M+1]*256},S.prototype.read_uint32=function(M){var e=this.input;if(M+4>e.length)throw A("unexpected EOF","EBADDATA");return this.big_endian?e[M]*16777216+e[M+1]*65536+e[M+2]*256+e[M+3]:e[M]+e[M+1]*256+e[M+2]*65536+e[M+3]*16777216},S.prototype.is_subifd_link=function(M,e){return M===0&&e===34665||M===0&&e===34853||M===34665&&e===40965},S.prototype.exif_format_length=function(M){switch(M){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},S.prototype.exif_format_read=function(M,e){var a;switch(M){case 1:case 2:return a=this.input[e],a;case 6:return a=this.input[e],a|(a&128)*33554430;case 3:return a=this.read_uint16(e),a;case 8:return a=this.read_uint16(e),a|(a&32768)*131070;case 4:return a=this.read_uint32(e),a;case 9:return a=this.read_uint32(e),a|0;case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}},S.prototype.scan_ifd=function(M,e,a){var n=this.read_uint16(e);e+=2;for(var r=0;r<n;r++){var t=this.read_uint16(e),h=this.read_uint16(e+2),s=this.read_uint32(e+4),i=this.exif_format_length(h),x=s*i,p=x<=4?e+8:this.read_uint32(e+8),v=!1;if(p+x>this.input.length)throw A("unexpected EOF","EBADDATA");for(var f=[],d=p,o=0;o<s;o++,d+=i){var m=this.exif_format_read(h,d);if(m===null){f=null;break}f.push(m)}Array.isArray(f)&&h===2&&(f=g(String.fromCharCode.apply(null,f)),f&&f[f.length-1]==="\0"&&(f=f.slice(0,-1))),this.is_subifd_link(M,t)&&Array.isArray(f)&&Number.isInteger(f[0])&&f[0]>0&&(this.ifds_to_read.push({id:t,offset:f[0]}),v=!0);var l={is_big_endian:this.big_endian,ifd:M,tag:t,format:h,count:s,entry_offset:e+this.start,data_length:x,data_offset:p+this.start,value:f,is_subifd_link:v};if(a(l)===!1){this.aborted=!0;return}e+=12}M===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},ee.exports.ExifParser=S,ee.exports.get_orientation=function(M){var e=0;try{return new S(M,0,M.length).each(function(a){if(a.ifd===0&&a.tag===274&&Array.isArray(a.value))return e=a.value[0],!1}),e}catch{return-1}}},{}],265:[function(y,ee,te){var A=y("./common").readUInt16BE,g=y("./common").readUInt32BE;function S(s,i){if(s.length<4+i)return null;var x=g(s,i);return s.length<x+i||x<8?null:{boxtype:String.fromCharCode.apply(null,s.slice(i+4,i+8)),data:s.slice(i+8,i+x),end:i+x}}ee.exports.unbox=S;function M(s,i){for(var x=0;;){var p=S(s,x);if(!p)break;switch(p.boxtype){case"ispe":i.sizes.push({width:g(p.data,4),height:g(p.data,8)});break;case"irot":i.transforms.push({type:"irot",value:p.data[0]&3});break;case"imir":i.transforms.push({type:"imir",value:p.data[0]&1});break}x=p.end}}function e(s,i,x){for(var p=0,v=0;v<x;v++)p=p*256+(s[i+v]||0);return p}function a(s,i){for(var x=s[4]>>4&15,p=s[4]&15,v=s[5]>>4&15,f=A(s,6),d=8,o=0;o<f;o++){var m=A(s,d);d+=2;var l=A(s,d);d+=2;var w=e(s,d,v);d+=v;var _=A(s,d);if(d+=2,l===0&&_===1){var c=e(s,d,x),b=e(s,d+x,p);i.item_loc[m]={length:b,offset:c+w}}d+=_*(x+p)}}function n(s,i){for(var x=A(s,4),p=6,v=0;v<x;v++){var f=S(s,p);if(!f)break;if(f.boxtype==="infe"){for(var d=A(f.data,4),o="",m=8;m<f.data.length&&f.data[m];m++)o+=String.fromCharCode(f.data[m]);i.item_inf[o]=d}p=f.end}}function r(s,i){for(var x=0;;){var p=S(s,x);if(!p)break;p.boxtype==="ipco"&&M(p.data,i),x=p.end}}function t(s,i){for(var x=4;;){var p=S(s,x);if(!p)break;p.boxtype==="iprp"&&r(p.data,i),p.boxtype==="iloc"&&a(p.data,i),p.boxtype==="iinf"&&n(p.data,i),x=p.end}}function h(s){var i=s.reduce(function(v,f){return v.width>f.width||v.width===f.width&&v.height>f.height?v:f}),x=s.reduce(function(v,f){return v.height>f.height||v.height===f.height&&v.width>f.width?v:f}),p;return i.width>x.height||i.width===x.height&&i.height>x.width?p=i:p=x,p}ee.exports.readSizeFromMeta=function(s){var i={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(t(s,i),!!i.sizes.length){var x=h(i.sizes),p=1;i.transforms.forEach(function(f){var d={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},o={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(f.type==="imir"&&(f.value===0?p=o[p]:(p=o[p],p=d[p],p=d[p])),f.type==="irot")for(var m=0;m<f.value;m++)p=d[p]});var v=null;return i.item_inf.Exif&&(v=i.item_loc[i.item_inf.Exif]),{width:x.width,height:x.height,orientation:i.transforms.length?p:null,variants:i.sizes,exif_location:v}}},ee.exports.getMimeType=function(s){var i=String.fromCharCode.apply(null,s.slice(0,4)),x={};x[i]=!0;for(var p=8;p<s.length;p+=4)x[String.fromCharCode.apply(null,s.slice(p,p+4))]=!0;if(!(!x.mif1&&!x.msf1&&!x.miaf))return i==="avif"||i==="avis"||i==="avio"?{type:"avif",mime:"image/avif"}:i==="heic"||i==="heix"?{type:"heic",mime:"image/heic"}:i==="hevc"||i==="hevx"?{type:"heic",mime:"image/heic-sequence"}:x.avif||x.avis?{type:"avif",mime:"image/avif"}:x.heic||x.heix||x.hevc||x.hevx||x.heis?x.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(y,ee,te){var A=y("../common").str2arr,g=y("../common").sliceEq,S=y("../common").readUInt32BE,M=y("../miaf_utils"),e=y("../exif_utils"),a=A("ftyp");ee.exports=function(n){if(g(n,4,a)){var r=M.unbox(n,0);if(r){var t=M.getMimeType(r.data);if(t){for(var h,s=r.end;;){var i=M.unbox(n,s);if(!i)break;if(s=i.end,i.boxtype==="mdat")return;if(i.boxtype==="meta"){h=i.data;break}}if(h){var x=M.readSizeFromMeta(h);if(x){var p={width:x.width,height:x.height,type:t.type,mime:t.mime,wUnits:"px",hUnits:"px"};if(x.variants.length>1&&(p.variants=x.variants),x.orientation&&(p.orientation=x.orientation),x.exif_location&&x.exif_location.offset+x.exif_location.length<=n.length){var v=S(n,x.exif_location.offset),f=n.slice(x.exif_location.offset+v+4,x.exif_location.offset+x.exif_location.length),d=e.get_orientation(f);d>0&&(p.orientation=d)}return p}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(y,ee,te){var A=y("../common").str2arr,g=y("../common").sliceEq,S=y("../common").readUInt16LE,M=A("BM");ee.exports=function(e){if(!(e.length<26)&&g(e,0,M))return{width:S(e,18),height:S(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(y,ee,te){var A=y("../common").str2arr,g=y("../common").sliceEq,S=y("../common").readUInt16LE,M=A("GIF87a"),e=A("GIF89a");ee.exports=function(a){if(!(a.length<10)&&!(!g(a,0,M)&&!g(a,0,e)))return{width:S(a,6),height:S(a,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(y,ee,te){var A=y("../common").readUInt16LE,g=0,S=1,M=16;ee.exports=function(e){var a=A(e,0),n=A(e,2),r=A(e,4);if(!(a!==g||n!==S||!r)){for(var t=[],h={width:0,height:0},s=0;s<r;s++){var i=e[6+M*s]||256,x=e[6+M*s+1]||256,p={width:i,height:x};t.push(p),(i>h.width||x>h.height)&&(h=p)}return{width:h.width,height:h.height,variants:t,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(y,ee,te){var A=y("../common").readUInt16BE,g=y("../common").str2arr,S=y("../common").sliceEq,M=y("../exif_utils"),e=g("Exif\0\0");ee.exports=function(a){if(!(a.length<2)&&!(a[0]!==255||a[1]!==216||a[2]!==255))for(var n=2;;){for(;;){if(a.length-n<2)return;if(a[n++]===255)break}for(var r=a[n++],t;r===255;)r=a[n++];if(208<=r&&r<=217||r===1)t=0;else if(192<=r&&r<=254){if(a.length-n<2)return;t=A(a,n)-2,n+=2}else return;if(r===217||r===218)return;var h;if(r===225&&t>=10&&S(a,n,e)&&(h=M.get_orientation(a.slice(n+6,n+t))),t>=5&&192<=r&&r<=207&&r!==196&&r!==200&&r!==204){if(a.length-n<t)return;var s={width:A(a,n+3),height:A(a,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return h>0&&(s.orientation=h),s}n+=t}}},{"../common":263,"../exif_utils":264}],271:[function(y,ee,te){var A=y("../common").str2arr,g=y("../common").sliceEq,S=y("../common").readUInt32BE,M=A(`PNG\r

`),e=A("IHDR");ee.exports=function(a){if(!(a.length<24)&&g(a,0,M)&&g(a,12,e))return{width:S(a,16),height:S(a,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(y,ee,te){var A=y("../common").str2arr,g=y("../common").sliceEq,S=y("../common").readUInt32BE,M=A("8BPS\0");ee.exports=function(e){if(!(e.length<6+16)&&g(e,0,M))return{width:S(e,6+12),height:S(e,6+8),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(y,ee,te){function A(i){return i===32||i===9||i===13||i===10}function g(i){return typeof i=="number"&&isFinite(i)&&i>0}function S(i){var x=0,p=i.length;for(i[0]===239&&i[1]===187&&i[2]===191&&(x=3);x<p&&A(i[x]);)x++;return x===p?!1:i[x]===60}var M=/<[-_.:a-zA-Z0-9][^>]*>/,e=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,a=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,n=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,r=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,t=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function h(i){var x=i.match(a),p=i.match(n),v=i.match(r);return{width:x&&(x[1]||x[2]),height:p&&(p[1]||p[2]),viewbox:v&&(v[1]||v[2])}}function s(i){return t.test(i)?i.match(t)[0]:"px"}ee.exports=function(i){if(S(i)){for(var x="",p=0;p<i.length;p++)x+=String.fromCharCode(i[p]);var v=(x.match(M)||[""])[0];if(e.test(v)){var f=h(v),d=parseFloat(f.width),o=parseFloat(f.height);if(f.width&&f.height)return!g(d)||!g(o)?void 0:{width:d,height:o,type:"svg",mime:"image/svg+xml",wUnits:s(f.width),hUnits:s(f.height)};var m=(f.viewbox||"").split(" "),l={width:m[2],height:m[3]},w=parseFloat(l.width),_=parseFloat(l.height);if(!(!g(w)||!g(_))&&s(l.width)===s(l.height)){var c=w/_;return f.width?g(d)?{width:d,height:d/c,type:"svg",mime:"image/svg+xml",wUnits:s(f.width),hUnits:s(f.width)}:void 0:f.height?g(o)?{width:o*c,height:o,type:"svg",mime:"image/svg+xml",wUnits:s(f.height),hUnits:s(f.height)}:void 0:{width:w,height:_,type:"svg",mime:"image/svg+xml",wUnits:s(l.width),hUnits:s(l.height)}}}}}},{}],274:[function(y,ee,te){var A=y("../common").str2arr,g=y("../common").sliceEq,S=y("../common").readUInt16LE,M=y("../common").readUInt16BE,e=y("../common").readUInt32LE,a=y("../common").readUInt32BE,n=A("II*\0"),r=A("MM\0*");function t(i,x,p){return p?M(i,x):S(i,x)}function h(i,x,p){return p?a(i,x):e(i,x)}function s(i,x,p){var v=t(i,x+2,p),f=h(i,x+4,p);return f!==1||v!==3&&v!==4?null:v===3?t(i,x+8,p):h(i,x+8,p)}ee.exports=function(i){if(!(i.length<8)&&!(!g(i,0,n)&&!g(i,0,r))){var x=i[0]===77,p=h(i,4,x)-8;if(!(p<0)){var v=p+8;if(!(i.length-v<2)){var f=t(i,v+0,x)*12;if(!(f<=0)&&(v+=2,!(i.length-v<f))){var d,o,m,l;for(d=0;d<f;d+=12)l=t(i,v+d,x),l===256?o=s(i,v+d,x):l===257&&(m=s(i,v+d,x));if(o&&m)return{width:o,height:m,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}}}}}}},{"../common":263}],275:[function(y,ee,te){var A=y("../common").str2arr,g=y("../common").sliceEq,S=y("../common").readUInt16LE,M=y("../common").readUInt32LE,e=y("../exif_utils"),a=A("RIFF"),n=A("WEBP");function r(s,i){if(!(s[i+3]!==157||s[i+4]!==1||s[i+5]!==42))return{width:S(s,i+6)&16383,height:S(s,i+8)&16383,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function t(s,i){if(s[i]===47){var x=M(s,i+1);return{width:(x&16383)+1,height:(x>>14&16383)+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function h(s,i){return{width:(s[i+6]<<16|s[i+5]<<8|s[i+4])+1,height:(s[i+9]<<i|s[i+8]<<8|s[i+7])+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}ee.exports=function(s){if(!(s.length<16)&&!(!g(s,0,a)&&!g(s,8,n))){var i=12,x=null,p=0,v=M(s,4)+8;if(!(v>s.length)){for(;i+8<v;){if(s[i]===0){i++;continue}var f=String.fromCharCode.apply(null,s.slice(i,i+4)),d=M(s,i+4);f==="VP8 "&&d>=10?x=x||r(s,i+8):f==="VP8L"&&d>=9?x=x||t(s,i+8):f==="VP8X"&&d>=10?x=x||h(s,i+8):f==="EXIF"&&(p=e.get_orientation(s.slice(i+8,i+8+d)),i=1/0),i+=8+d}if(x)return p>0&&(x.orientation=p),x}}}},{"../common":263,"../exif_utils":264}],276:[function(y,ee,te){ee.exports={avif:y("./parse_sync/avif"),bmp:y("./parse_sync/bmp"),gif:y("./parse_sync/gif"),ico:y("./parse_sync/ico"),jpeg:y("./parse_sync/jpeg"),png:y("./parse_sync/png"),psd:y("./parse_sync/psd"),svg:y("./parse_sync/svg"),tiff:y("./parse_sync/tiff"),webp:y("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(y,ee,te){var A=y("./lib/parsers_sync");function g(S){for(var M=Object.keys(A),e=0;e<M.length;e++){var a=A[M[e]](S);if(a)return a}return null}ee.exports=function(M){return g(M)},ee.exports.parsers=A},{"./lib/parsers_sync":276}],278:[function(y,ee,te){var A=ee.exports={},g,S;function M(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?g=setTimeout:g=M}catch{g=M}try{typeof clearTimeout=="function"?S=clearTimeout:S=e}catch{S=e}})();function a(f){if(g===setTimeout)return setTimeout(f,0);if((g===M||!g)&&setTimeout)return g=setTimeout,setTimeout(f,0);try{return g(f,0)}catch{try{return g.call(null,f,0)}catch{return g.call(this,f,0)}}}function n(f){if(S===clearTimeout)return clearTimeout(f);if((S===e||!S)&&clearTimeout)return S=clearTimeout,clearTimeout(f);try{return S(f)}catch{try{return S.call(null,f)}catch{return S.call(this,f)}}}var r=[],t=!1,h,s=-1;function i(){!t||!h||(t=!1,h.length?r=h.concat(r):s=-1,r.length&&x())}function x(){if(!t){var f=a(i);t=!0;for(var d=r.length;d;){for(h=r,r=[];++s<d;)h&&h[s].run();s=-1,d=r.length}h=null,t=!1,n(f)}}A.nextTick=function(f){var d=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)d[o-1]=arguments[o];r.push(new p(f,d)),r.length===1&&!t&&a(x)};function p(f,d){this.fun=f,this.array=d}p.prototype.run=function(){this.fun.apply(null,this.array)},A.title="browser",A.browser=!0,A.env={},A.argv=[],A.version="",A.versions={};function v(){}A.on=v,A.addListener=v,A.once=v,A.off=v,A.removeListener=v,A.removeAllListeners=v,A.emit=v,A.prependListener=v,A.prependOnceListener=v,A.listeners=function(f){return[]},A.binding=function(f){throw new Error("process.binding is not supported")},A.cwd=function(){return"/"},A.chdir=function(f){throw new Error("process.chdir is not supported")},A.umask=function(){return 0}},{}],279:[function(y,ee,te){(function(A){(function(){for(var g=y("performance-now"),S=typeof window>"u"?A:window,M=["moz","webkit"],e="AnimationFrame",a=S["request"+e],n=S["cancel"+e]||S["cancelRequest"+e],r=0;!a&&r<M.length;r++)a=S[M[r]+"Request"+e],n=S[M[r]+"Cancel"+e]||S[M[r]+"CancelRequest"+e];if(!a||!n){var t=0,h=0,s=[],i=1e3/60;a=function(x){if(s.length===0){var p=g(),v=Math.max(0,i-(p-t));t=v+p,setTimeout(function(){var f=s.slice(0);s.length=0;for(var d=0;d<f.length;d++)if(!f[d].cancelled)try{f[d].callback(t)}catch(o){setTimeout(function(){throw o},0)}},Math.round(v))}return s.push({handle:++h,callback:x,cancelled:!1}),h},n=function(x){for(var p=0;p<s.length;p++)s[p].handle===x&&(s[p].cancelled=!0)}}ee.exports=function(x){return a.call(S,x)},ee.exports.cancel=function(){n.apply(S,arguments)},ee.exports.polyfill=function(x){x||(x=S),x.requestAnimationFrame=a,x.cancelAnimationFrame=n}}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(y,ee,te){var A=y("array-bounds"),g=y("color-normalize"),S=y("update-diff"),M=y("pick-by-alias"),e=y("object-assign"),a=y("flatten-vertex-data"),n=y("to-float32"),r=n.float32,t=n.fract32;ee.exports=s;var h=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function s(i,x){if(typeof i=="function"?(x||(x={}),x.regl=i):x=i,x.length&&(x.positions=x),i=x.regl,!i.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var p=i._gl,v,f,d,o,m,l,w={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[];return o=i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),f=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),d=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),m=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),l=i.buffer({usage:"static",type:"float",data:h}),L(x),v=i({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:i.prop("range"),lineWidth:i.prop("lineWidth"),capSize:i.prop("capSize"),opacity:i.prop("opacity"),scale:i.prop("scale"),translate:i.prop("translate"),scaleFract:i.prop("scaleFract"),translateFract:i.prop("translateFract"),viewport:function(k,P){return[P.viewport.x,P.viewport.y,k.viewportWidth,k.viewportHeight]}},attributes:{color:{buffer:o,offset:function(k,P){return P.offset*4},divisor:1},position:{buffer:f,offset:function(k,P){return P.offset*8},divisor:1},positionFract:{buffer:d,offset:function(k,P){return P.offset*8},divisor:1},error:{buffer:m,offset:function(k,P){return P.offset*16},divisor:1},direction:{buffer:l,stride:24,offset:0},lineOffset:{buffer:l,stride:24,offset:8},capOffset:{buffer:l,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:i.prop("viewport")},viewport:i.prop("viewport"),stencil:!1,instances:i.prop("count"),count:h.length}),e(c,{update:L,draw:b,destroy:T,regl:i,gl:p,canvas:p.canvas,groups:_}),c;function c(k){k?L(k):k===null&&T(),b()}function b(k){if(typeof k=="number")return u(k);k&&!Array.isArray(k)&&(k=[k]),i._refresh(),_.forEach(function(P,z){if(P){if(k&&(k[z]?P.draw=!0:P.draw=!1),!P.draw){P.draw=!0;return}u(z)}})}function u(k){typeof k=="number"&&(k=_[k]),k!=null&&k&&k.count&&k.color&&k.opacity&&k.positions&&k.positions.length>1&&(k.scaleRatio=[k.scale[0]*k.viewport.width,k.scale[1]*k.viewport.height],v(k),k.after&&k.after(k))}function L(k){if(k){k.length!=null?typeof k[0]=="number"&&(k=[{positions:k}]):Array.isArray(k)||(k=[k]);var P=0,z=0;if(c.groups=_=k.map(function(G,K){var W=_[K];if(G)typeof G=="function"?G={after:G}:typeof G[0]=="number"&&(G={positions:G});else return W;return G=M(G,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),W||(_[K]=W={id:K,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},G=e({},w,G)),S(W,G,[{lineWidth:function(Y){return+Y*.5},capSize:function(Y){return+Y*.5},opacity:parseFloat,errors:function(Y){return Y=a(Y),z+=Y.length,Y},positions:function(Y,re){return Y=a(Y,"float64"),re.count=Math.floor(Y.length/2),re.bounds=A(Y,2),re.offset=P,P+=re.count,Y}},{color:function(Y,re){var ue=re.count;if(Y||(Y="transparent"),!Array.isArray(Y)||typeof Y[0]=="number"){var j=Y;Y=Array(ue);for(var q=0;q<ue;q++)Y[q]=j}if(Y.length<ue)throw Error("Not enough colors");for(var H=new Uint8Array(ue*4),U=0;U<ue;U++){var $=g(Y[U],"uint8");H.set($,U*4)}return H},range:function(Y,re,ue){var j=re.bounds;return Y||(Y=j),re.scale=[1/(Y[2]-Y[0]),1/(Y[3]-Y[1])],re.translate=[-Y[0],-Y[1]],re.scaleFract=t(re.scale),re.translateFract=t(re.translate),Y},viewport:function(Y){var re;return Array.isArray(Y)?re={x:Y[0],y:Y[1],width:Y[2]-Y[0],height:Y[3]-Y[1]}:Y?(re={x:Y.x||Y.left||0,y:Y.y||Y.top||0},Y.right?re.width=Y.right-re.x:re.width=Y.w||Y.width||0,Y.bottom?re.height=Y.bottom-re.y:re.height=Y.h||Y.height||0):re={x:0,y:0,width:p.drawingBufferWidth,height:p.drawingBufferHeight},re}}]),W}),P||z){var I=_.reduce(function(G,K,W){return G+(K?K.count:0)},0),D=new Float64Array(I*2),R=new Uint8Array(I*4),O=new Float32Array(I*4);_.forEach(function(G,K){if(G){var W=G.positions,Y=G.count,re=G.offset,ue=G.color,j=G.errors;Y&&(R.set(ue,re*4),O.set(j,re*4),D.set(W,re*2))}});var F=r(D);f(F);var N=t(D,F);d(N),o(R),m(O)}}}function T(){f.destroy(),d.destroy(),o.destroy(),m.destroy(),l.destroy()}}},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(y,ee,te){var A=y("color-normalize"),g=y("array-bounds"),S=y("object-assign"),M=y("glslify"),e=y("pick-by-alias"),a=y("flatten-vertex-data"),n=y("earcut"),r=y("array-normalize"),t=y("to-float32"),h=t.float32,s=t.fract32,i=y("es6-weak-map"),x=y("parse-rect"),p=y("array-find-index");ee.exports=v;function v(f,d){if(!(this instanceof v))return new v(f,d);if(typeof f=="function"?(d||(d={}),d.regl=f):d=f,d.length&&(d.positions=d),f=d.regl,!f.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=f._gl,this.regl=f,this.passes=[],this.shaders=v.shaders.has(f)?v.shaders.get(f):v.shaders.set(f,v.createShaders(f)).get(f),this.update(d)}v.dashMult=2,v.maxPatternLength=256,v.precisionThreshold=3e6,v.maxPoints=1e4,v.maxLines=2048,v.shaders=new i,v.createShaders=function(f){var d=f.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),o={primitive:"triangle strip",instances:f.prop("count"),count:4,offset:0,uniforms:{miterMode:function(_,c){return c.join==="round"?2:1},miterLimit:f.prop("miterLimit"),scale:f.prop("scale"),scaleFract:f.prop("scaleFract"),translateFract:f.prop("translateFract"),translate:f.prop("translate"),thickness:f.prop("thickness"),dashTexture:f.prop("dashTexture"),opacity:f.prop("opacity"),pixelRatio:f.context("pixelRatio"),id:f.prop("id"),dashLength:f.prop("dashLength"),viewport:function(_,c){return[c.viewport.x,c.viewport.y,_.viewportWidth,_.viewportHeight]},depth:f.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(_,c){return!c.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:f.prop("viewport")},viewport:f.prop("viewport")},m=f(S({vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:d,divisor:0,stride:8,offset:0},lineTop:{buffer:d,divisor:0,stride:8,offset:4},aCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:f.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:f.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:f.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},o)),l;try{l=f(S({cull:{enable:!0,face:"back"},vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:d,divisor:0,stride:8,offset:0},lineTop:{buffer:d,divisor:0,stride:8,offset:4},aColor:{buffer:f.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:f.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:f.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},o))}catch{l=m}var w=f({primitive:"triangle",elements:function(_,c){return c.triangles},offset:0,vert:M([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:M([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:f.prop("scale"),color:f.prop("fill"),scaleFract:f.prop("scaleFract"),translateFract:f.prop("translateFract"),translate:f.prop("translate"),opacity:f.prop("opacity"),pixelRatio:f.context("pixelRatio"),id:f.prop("id"),viewport:function(_,c){return[c.viewport.x,c.viewport.y,_.viewportWidth,_.viewportHeight]}},attributes:{position:{buffer:f.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:f.prop("positionFractBuffer"),stride:8,offset:8}},blend:o.blend,depth:{enable:!1},scissor:o.scissor,stencil:o.stencil,viewport:o.viewport});return{fill:w,rect:m,miter:l}},v.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},v.prototype.render=function(){for(var f,d=[],o=arguments.length;o--;)d[o]=arguments[o];d.length&&(f=this).update.apply(f,d),this.draw()},v.prototype.draw=function(){for(var f=this,d=[],o=arguments.length;o--;)d[o]=arguments[o];return(d.length?d:this.passes).forEach(function(m,l){var w;if(m&&Array.isArray(m))return(w=f).draw.apply(w,m);typeof m=="number"&&(m=f.passes[m]),m&&m.count>1&&m.opacity&&(f.regl._refresh(),m.fill&&m.triangles&&m.triangles.length>2&&f.shaders.fill(m),m.thickness&&(m.scale[0]*m.viewport.width>v.precisionThreshold||m.scale[1]*m.viewport.height>v.precisionThreshold||m.join==="rect"||!m.join&&(m.thickness<=2||m.count>=v.maxPoints)?f.shaders.rect(m):f.shaders.miter(m)))}),this},v.prototype.update=function(f){var d=this;if(f){f.length!=null?typeof f[0]=="number"&&(f=[{positions:f}]):Array.isArray(f)||(f=[f]);var o=this,m=o.regl,l=o.gl;if(f.forEach(function(u,L){var T=d.passes[L];if(u!==void 0){if(u===null){d.passes[L]=null;return}if(typeof u[0]=="number"&&(u={positions:u}),u=e(u,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),T||(d.passes[L]=T={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:m.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:m.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:m.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:m.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},u=S({},v.defaults,u)),u.thickness!=null&&(T.thickness=parseFloat(u.thickness)),u.opacity!=null&&(T.opacity=parseFloat(u.opacity)),u.miterLimit!=null&&(T.miterLimit=parseFloat(u.miterLimit)),u.overlay!=null&&(T.overlay=!!u.overlay,L<v.maxLines&&(T.depth=2*(v.maxLines-1-L%v.maxLines)/v.maxLines-1)),u.join!=null&&(T.join=u.join),u.hole!=null&&(T.hole=u.hole),u.fill!=null&&(T.fill=u.fill?A(u.fill,"uint8"):null),u.viewport!=null&&(T.viewport=x(u.viewport)),T.viewport||(T.viewport=x([l.drawingBufferWidth,l.drawingBufferHeight])),u.close!=null&&(T.close=u.close),u.positions===null&&(u.positions=[]),u.positions){var k,P;if(u.positions.x&&u.positions.y){var z=u.positions.x,I=u.positions.y;P=T.count=Math.max(z.length,I.length),k=new Float64Array(P*2);for(var D=0;D<P;D++)k[D*2]=z[D],k[D*2+1]=I[D]}else k=a(u.positions,"float64"),P=T.count=Math.floor(k.length/2);var R=T.bounds=g(k,2);if(T.fill){for(var O=[],F={},N=0,G=0,K=0,W=T.count;G<W;G++){var Y=k[G*2],re=k[G*2+1];isNaN(Y)||isNaN(re)||Y==null||re==null?(Y=k[N*2],re=k[N*2+1],F[G]=N):N=G,O[K++]=Y,O[K++]=re}if(u.splitNull){T.count-1 in F||(F[T.count]=T.count-1);var ue=Object.keys(F).map(Number).sort(function(Ge,tt){return Ge-tt}),j=[],q=0,H=T.hole!=null?T.hole[0]:null;if(H!=null){var U=p(ue,function(Ge){return Ge>=H});ue=ue.slice(0,U),ue.push(H)}for(var $=function(Ge){var tt=O.slice(q*2,ue[Ge]*2).concat(H?O.slice(H*2):[]),He=(T.hole||[]).map(function(Ne){return Ne-H+(ue[Ge]-q)}),Ae=n(tt,He);Ae=Ae.map(function(Ne){return Ne+q+(Ne+q<ue[Ge]?0:H-ue[Ge])}),j.push.apply(j,Ae),q=ue[Ge]+1},ne=0;ne<ue.length;ne++)$(ne);for(var X=0,Q=j.length;X<Q;X++)F[j[X]]!=null&&(j[X]=F[j[X]]);T.triangles=j}else{for(var ie=n(O,T.hole||[]),se=0,ae=ie.length;se<ae;se++)F[ie[se]]!=null&&(ie[se]=F[ie[se]]);T.triangles=ie}}var oe=new Float64Array(k);r(oe,2,R);var be=new Float64Array(P*2+6);T.close?k[0]===k[P*2-2]&&k[1]===k[P*2-1]?(be[0]=oe[P*2-4],be[1]=oe[P*2-3]):(be[0]=oe[P*2-2],be[1]=oe[P*2-1]):(be[0]=oe[0],be[1]=oe[1]),be.set(oe,2),T.close?k[0]===k[P*2-2]&&k[1]===k[P*2-1]?(be[P*2+2]=oe[2],be[P*2+3]=oe[3],T.count-=1):(be[P*2+2]=oe[0],be[P*2+3]=oe[1],be[P*2+4]=oe[2],be[P*2+5]=oe[3]):(be[P*2+2]=oe[P*2-2],be[P*2+3]=oe[P*2-1],be[P*2+4]=oe[P*2-2],be[P*2+5]=oe[P*2-1]);var ce=h(be);T.positionBuffer(ce);var de=s(be,ce);T.positionFractBuffer(de)}if(u.range?T.range=u.range:T.range||(T.range=T.bounds),(u.range||u.positions)&&T.count){var ye=T.bounds,ge=ye[2]-ye[0],me=ye[3]-ye[1],Ee=T.range[2]-T.range[0],Pe=T.range[3]-T.range[1];T.scale=[ge/Ee,me/Pe],T.translate=[-T.range[0]/Ee+ye[0]/Ee||0,-T.range[1]/Pe+ye[1]/Pe||0],T.scaleFract=s(T.scale),T.translateFract=s(T.translate)}if(u.dashes){var Ue=0,we;if(!u.dashes||u.dashes.length<2)Ue=1,we=new Uint8Array([255,255,255,255,255,255,255,255]);else{Ue=0;for(var ke=0;ke<u.dashes.length;++ke)Ue+=u.dashes[ke];we=new Uint8Array(Ue*v.dashMult);for(var Xe=0,Ve=255,Ie=0;Ie<2;Ie++)for(var De=0;De<u.dashes.length;++De){for(var Ye=0,vt=u.dashes[De]*v.dashMult*.5;Ye<vt;++Ye)we[Xe++]=Ve;Ve^=255}}T.dashLength=Ue,T.dashTexture({channels:1,data:we,width:we.length,height:1,mag:"linear",min:"linear"},0,0)}if(u.color){var Dt=T.count,Kt=u.color;Kt||(Kt="transparent");var Ft=new Uint8Array(Dt*4+4);if(!Array.isArray(Kt)||typeof Kt[0]=="number")for(var Mt=A(Kt,"uint8"),Xt=0;Xt<Dt+1;Xt++)Ft.set(Mt,Xt*4);else{for(var It=0;It<Dt;It++){var At=A(Kt[It],"uint8");Ft.set(At,It*4)}Ft.set(A(Kt[0],"uint8"),Dt*4)}T.colorBuffer({usage:"dynamic",type:"uint8",data:Ft})}}}),f.length<this.passes.length){for(var w=f.length;w<this.passes.length;w++){var _=this.passes[w];_&&(_.colorBuffer.destroy(),_.positionBuffer.destroy(),_.dashTexture.destroy())}this.passes.length=f.length}for(var c=[],b=0;b<this.passes.length;b++)this.passes[b]!==null&&c.push(this.passes[b]);return this.passes=c,this}},v.prototype.destroy=function(){return this.passes.forEach(function(f){f.colorBuffer.destroy(),f.positionBuffer.destroy(),f.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(y,ee,te){function A(T,k){return M(T)||a(T,k)||n(T,k)||h()}function g(T){return S(T)||e(T)||n(T)||t()}function S(T){if(Array.isArray(T))return r(T)}function M(T){if(Array.isArray(T))return T}function e(T){if(typeof Symbol<"u"&&T[Symbol.iterator]!=null||T["@@iterator"]!=null)return Array.from(T)}function a(T,k){var P=T==null?null:typeof Symbol<"u"&&T[Symbol.iterator]||T["@@iterator"];if(P!=null){var z=[],I=!0,D=!1,R,O;try{for(P=P.call(T);!(I=(R=P.next()).done)&&(z.push(R.value),!(k&&z.length===k));I=!0);}catch(F){D=!0,O=F}finally{try{!I&&P.return!=null&&P.return()}finally{if(D)throw O}}return z}}function n(T,k){if(T){if(typeof T=="string")return r(T,k);var P=Object.prototype.toString.call(T).slice(8,-1);if(P==="Object"&&T.constructor&&(P=T.constructor.name),P==="Map"||P==="Set")return Array.from(T);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return r(T,k)}}function r(T,k){(k==null||k>T.length)&&(k=T.length);for(var P=0,z=new Array(k);P<k;P++)z[P]=T[P];return z}function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=y("color-normalize"),i=y("array-bounds"),x=y("color-id"),p=y("@plotly/point-cluster"),v=y("object-assign"),f=y("glslify"),d=y("pick-by-alias"),o=y("update-diff"),m=y("flatten-vertex-data"),l=y("is-iexplorer"),w=y("to-float32"),_=y("parse-rect"),c=b;function b(T,k){var P=this;if(!(this instanceof b))return new b(T,k);typeof T=="function"?(k||(k={}),k.regl=T):(k=T,T=null),k&&k.length&&(k.positions=k),T=k.regl;var z=T._gl,I,D=[],R={},O=[],F=[null],N=[null],G=255,K=100;this.tooManyColors=l,I=T.texture({data:new Uint8Array(G*4),width:G,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),v(this,{regl:T,gl:z,groups:O,markerCache:N,markerTextures:F,palette:D,paletteIds:R,paletteTexture:I,maxColors:G,maxSize:K,canvas:z.canvas}),this.update(k);var W={uniforms:{constPointSize:!!k.constPointSize,opacity:T.prop("opacity"),paletteSize:function(j,q){return[P.tooManyColors?0:G,I.height]},pixelRatio:T.context("pixelRatio"),scale:T.prop("scale"),scaleFract:T.prop("scaleFract"),translate:T.prop("translate"),translateFract:T.prop("translateFract"),markerTexture:T.prop("markerTexture"),paletteTexture:I},attributes:{x:function(j,q){return q.xAttr||{buffer:q.positionBuffer,stride:8,offset:0}},y:function(j,q){return q.yAttr||{buffer:q.positionBuffer,stride:8,offset:4}},xFract:function(j,q){return q.xAttr?{constant:[0,0]}:{buffer:q.positionFractBuffer,stride:8,offset:0}},yFract:function(j,q){return q.yAttr?{constant:[0,0]}:{buffer:q.positionFractBuffer,stride:8,offset:4}},size:function(j,q){return q.size.length?{buffer:q.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(q.size*255/P.maxSize)]}},borderSize:function(j,q){return q.borderSize.length?{buffer:q.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(q.borderSize*255/P.maxSize)]}},colorId:function(j,q){return q.color.length?{buffer:q.colorBuffer,stride:P.tooManyColors?8:4,offset:0}:{constant:P.tooManyColors?D.slice(q.color*4,q.color*4+4):[q.color]}},borderColorId:function(j,q){return q.borderColor.length?{buffer:q.colorBuffer,stride:P.tooManyColors?8:4,offset:P.tooManyColors?4:2}:{constant:P.tooManyColors?D.slice(q.borderColor*4,q.borderColor*4+4):[q.borderColor]}},isActive:function(j,q){return q.activation===!0?{constant:[1]}:q.activation?q.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:T.prop("viewport")},viewport:T.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:T.prop("elements"),count:T.prop("count"),offset:T.prop("offset"),primitive:"points"},Y=v({},W);Y.frag=f([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),Y.vert=f([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=T(Y);var re=v({},W);re.frag=f([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),re.vert=f([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),l&&(re.frag=re.frag.replace("smoothstep","smoothStep"),Y.frag=Y.frag.replace("smoothstep","smoothStep")),this.drawCircle=T(re)}b.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},b.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},b.prototype.draw=function(){for(var T=this,k=arguments.length,P=new Array(k),z=0;z<k;z++)P[z]=arguments[z];var I=this.groups;if(P.length===1&&Array.isArray(P[0])&&(P[0][0]===null||Array.isArray(P[0][0]))&&(P=P[0]),this.regl._refresh(),P.length)for(var D=0;D<P.length;D++)this.drawItem(D,P[D]);else I.forEach(function(R,O){T.drawItem(O)});return this},b.prototype.drawItem=function(T,k){var P=this.groups,z=P[T];if(typeof k=="number"&&(T=k,z=P[k],k=null),!!(z&&z.count&&z.opacity)){z.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,z,k));for(var I=[],D=1;D<z.activation.length;D++)!z.activation[D]||z.activation[D]!==!0&&!z.activation[D].data.length||I.push.apply(I,g(this.getMarkerDrawOptions(D,z,k)));I.length&&this.drawMarker(I)}},b.prototype.getMarkerDrawOptions=function(T,k,P){var z=k.range,I=k.tree,D=k.viewport,R=k.activation,O=k.selectionBuffer,F=k.count;if(this.regl,!I)return P?[v({},k,{markerTexture:this.markerTextures[T],activation:R[T],count:P.length,elements:P,offset:0})]:[v({},k,{markerTexture:this.markerTextures[T],activation:R[T],offset:0})];var N=[],G=I.range(z,{lod:!0,px:[(z[2]-z[0])/D.width,(z[3]-z[1])/D.height]});if(P){for(var K=R[T],W=K.data,Y=new Uint8Array(F),re=0;re<P.length;re++){var ue=P[re];Y[ue]=W?W[ue]:1}O.subdata(Y)}for(var j=G.length;j--;){var q=A(G[j],2),H=q[0],U=q[1];N.push(v({},k,{markerTexture:this.markerTextures[T],activation:P?O:R[T],offset:H,count:U-H}))}return N},b.prototype.update=function(){for(var T=this,k=arguments.length,P=new Array(k),z=0;z<k;z++)P[z]=arguments[z];if(P.length){P.length===1&&Array.isArray(P[0])&&(P=P[0]);var I=this.groups,D=this.gl,R=this.regl,O=this.maxSize,F=this.maxColors,N=this.palette;this.groups=I=P.map(function(G,K){var W=I[K];if(G===void 0)return W;G===null?G={positions:null}:typeof G=="function"?G={ondraw:G}:typeof G[0]=="number"&&(G={positions:G}),G=d(G,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),G.positions===null&&(G.positions=[]),G.tooManyColors!=null&&(T.tooManyColors=G.tooManyColors),W||(I[K]=W={id:K,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:R.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},G=v({},b.defaults,G)),G.positions&&!("marker"in G)&&(G.marker=W.marker,delete W.marker),G.marker&&!("positions"in G)&&(G.positions=W.positions,delete W.positions);var Y=0,re=0;if(o(W,G,[{snap:!0,size:function(me,Ee){return me==null&&(me=b.defaults.size),Y+=me&&me.length?1:0,me},borderSize:function(me,Ee){return me==null&&(me=b.defaults.borderSize),Y+=me&&me.length?1:0,me},opacity:parseFloat,color:function(me,Ee){return me==null&&(me=b.defaults.color),me=T.updateColor(me),re++,me},borderColor:function(me,Ee){return me==null&&(me=b.defaults.borderColor),me=T.updateColor(me),re++,me},bounds:function(me,Ee,Pe){return"range"in Pe||(Pe.range=null),me},positions:function(me,Ee,Pe){var Ue=Ee.snap,we=Ee.positionBuffer,ke=Ee.positionFractBuffer,Xe=Ee.selectionBuffer;if(me.x||me.y)return me.x.length?Ee.xAttr={buffer:R.buffer(me.x),offset:0,stride:4,count:me.x.length}:Ee.xAttr={buffer:me.x.buffer,offset:me.x.offset*4||0,stride:(me.x.stride||1)*4,count:me.x.count},me.y.length?Ee.yAttr={buffer:R.buffer(me.y),offset:0,stride:4,count:me.y.length}:Ee.yAttr={buffer:me.y.buffer,offset:me.y.offset*4||0,stride:(me.y.stride||1)*4,count:me.y.count},Ee.count=Math.max(Ee.xAttr.count,Ee.yAttr.count),me;me=m(me,"float64");var Ve=Ee.count=Math.floor(me.length/2),Ie=Ee.bounds=Ve?i(me,2):null;if(!Pe.range&&!Ee.range&&(delete Ee.range,Pe.range=Ie),!Pe.marker&&!Ee.marker&&(delete Ee.marker,Pe.marker=null),Ue&&(Ue===!0||Ve>Ue)?Ee.tree=p(me,{bounds:Ie}):Ue&&Ue.length&&(Ee.tree=Ue),Ee.tree){var De={primitive:"points",usage:"static",data:Ee.tree,type:"uint32"};Ee.elements?Ee.elements(De):Ee.elements=R.elements(De)}var Ye=w.float32(me);we({data:Ye,usage:"dynamic"});var vt=w.fract32(me,Ye);return ke({data:vt,usage:"dynamic"}),Xe({data:new Uint8Array(Ve),type:"uint8",usage:"stream"}),me}},{marker:function(me,Ee,Pe){var Ue=Ee.activation;if(Ue.forEach(function(vt){return vt&&vt.destroy&&vt.destroy()}),Ue.length=0,!me||typeof me[0]=="number"){var we=T.addMarker(me);Ue[we]=!0}else{for(var ke=[],Xe=0,Ve=Math.min(me.length,Ee.count);Xe<Ve;Xe++){var Ie=T.addMarker(me[Xe]);ke[Ie]||(ke[Ie]=new Uint8Array(Ee.count)),ke[Ie][Xe]=1}for(var De=0;De<ke.length;De++)if(ke[De]){var Ye={data:ke[De],type:"uint8",usage:"static"};Ue[De]?Ue[De](Ye):Ue[De]=R.buffer(Ye),Ue[De].data=ke[De]}}return me},range:function(me,Ee,Pe){var Ue=Ee.bounds;if(Ue)return me||(me=Ue),Ee.scale=[1/(me[2]-me[0]),1/(me[3]-me[1])],Ee.translate=[-me[0],-me[1]],Ee.scaleFract=w.fract(Ee.scale),Ee.translateFract=w.fract(Ee.translate),me},viewport:function(me){var Ee=_(me||[D.drawingBufferWidth,D.drawingBufferHeight]);return Ee}}]),Y){var ue=W,j=ue.count,q=ue.size,H=ue.borderSize,U=ue.sizeBuffer,$=new Uint8Array(j*2);if(q.length||H.length)for(var ne=0;ne<j;ne++)$[ne*2]=Math.round((q[ne]==null?q:q[ne])*255/O),$[ne*2+1]=Math.round((H[ne]==null?H:H[ne])*255/O);U({data:$,usage:"dynamic"})}if(re){var X=W,Q=X.count,ie=X.color,se=X.borderColor,ae=X.colorBuffer,oe;if(T.tooManyColors){if(ie.length||se.length){oe=new Uint8Array(Q*8);for(var be=0;be<Q;be++){var ce=ie[be];oe[be*8]=N[ce*4],oe[be*8+1]=N[ce*4+1],oe[be*8+2]=N[ce*4+2],oe[be*8+3]=N[ce*4+3];var de=se[be];oe[be*8+4]=N[de*4],oe[be*8+5]=N[de*4+1],oe[be*8+6]=N[de*4+2],oe[be*8+7]=N[de*4+3]}}}else if(ie.length||se.length){oe=new Uint8Array(Q*4+2);for(var ye=0;ye<Q;ye++)ie[ye]!=null&&(oe[ye*4]=ie[ye]%F,oe[ye*4+1]=Math.floor(ie[ye]/F)),se[ye]!=null&&(oe[ye*4+2]=se[ye]%F,oe[ye*4+3]=Math.floor(se[ye]/F))}ae({data:oe||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return W})}},b.prototype.addMarker=function(T){var k=this.markerTextures,P=this.regl,z=this.markerCache,I=T==null?0:z.indexOf(T);if(I>=0)return I;var D;if(T instanceof Uint8Array||T instanceof Uint8ClampedArray)D=T;else{D=new Uint8Array(T.length);for(var R=0,O=T.length;R<O;R++)D[R]=T[R]*255}var F=Math.floor(Math.sqrt(D.length));return I=k.length,z.push(T),k.push(P.texture({channels:1,data:D,radius:F,mag:"linear",min:"linear"})),I},b.prototype.updateColor=function(T){var k=this.paletteIds,P=this.palette,z=this.maxColors;Array.isArray(T)||(T=[T]);var I=[];if(typeof T[0]=="number"){var D=[];if(Array.isArray(T))for(var R=0;R<T.length;R+=4)D.push(T.slice(R,R+4));else for(var O=0;O<T.length;O+=4)D.push(T.subarray(O,O+4));T=D}for(var F=0;F<T.length;F++){var N=T[F];N=s(N,"uint8");var G=x(N,!1);if(k[G]==null){var K=P.length;k[G]=Math.floor(K/4),P[K]=N[0],P[K+1]=N[1],P[K+2]=N[2],P[K+3]=N[3]}I[F]=k[G]}return!this.tooManyColors&&P.length>z*4&&(this.tooManyColors=!0),this.updatePalette(P),I.length===1?I[0]:I},b.prototype.updatePalette=function(T){if(!this.tooManyColors){var k=this.maxColors,P=this.paletteTexture,z=Math.ceil(T.length*.25/k);if(z>1){T=T.slice();for(var I=T.length*.25%k;I<z*k;I++)T.push(0,0,0,0)}P.height<z&&P.resize(k,z),P.subimage({width:Math.min(T.length*.25,k),height:z,data:T},0,0)}},b.prototype.destroy=function(){return this.groups.forEach(function(T){T.sizeBuffer.destroy(),T.positionBuffer.destroy(),T.positionFractBuffer.destroy(),T.colorBuffer.destroy(),T.activation.forEach(function(k){return k&&k.destroy&&k.destroy()}),T.selectionBuffer.destroy(),T.elements&&T.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(T){return T&&T.destroy&&T.destroy()}),this};var u=y("object-assign"),L=function(k,P){var z=new c(k,P),I=z.render.bind(z);return u(I,{render:I,update:z.update.bind(z),draw:z.draw.bind(z),destroy:z.destroy.bind(z),regl:z.regl,gl:z.gl,canvas:z.gl.canvas,groups:z.groups,markers:z.markerCache,palette:z.palette}),I};ee.exports=L},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(y,ee,te){var A=y("regl-scatter2d"),g=y("pick-by-alias"),S=y("array-bounds"),M=y("raf"),e=y("array-range"),a=y("parse-rect"),n=y("flatten-vertex-data");ee.exports=r;function r(i,x){if(!(this instanceof r))return new r(i);this.traces=[],this.passes={},this.regl=i,this.scatter=A(i),this.canvas=this.scatter.canvas}r.prototype.render=function(){for(var i=this,x,p=[],v=arguments.length;v--;)p[v]=arguments[v];return p.length&&(x=this).update.apply(x,p),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=M(function(){i.draw(),i.dirty=!0,i.planned=null})):(this.draw(),this.dirty=!0,M(function(){i.dirty=!1})),this)},r.prototype.update=function(){for(var i,x=[],p=arguments.length;p--;)x[p]=arguments[p];if(x.length){for(var v=0;v<x.length;v++)this.updateItem(v,x[v]);this.traces=this.traces.filter(Boolean);for(var f=[],d=0,o=0;o<this.traces.length;o++){for(var m=this.traces[o],l=this.traces[o].passes,w=0;w<l.length;w++)f.push(this.passes[l[w]]);m.passOffset=d,d+=m.passes.length}return(i=this.scatter).update.apply(i,f),this}},r.prototype.updateItem=function(i,x){var p=this,v=p.regl;if(x===null)return this.traces[i]=null,this;if(!x)return this;var f=g(x,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),d=this.traces[i]||(this.traces[i]={id:i,buffer:v.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:a([v._gl.drawingBufferWidth,v._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(f.color!=null&&(d.color=f.color),f.size!=null&&(d.size=f.size),f.marker!=null&&(d.marker=f.marker),f.borderColor!=null&&(d.borderColor=f.borderColor),f.borderSize!=null&&(d.borderSize=f.borderSize),f.opacity!=null&&(d.opacity=f.opacity),f.viewport&&(d.viewport=a(f.viewport)),f.diagonal!=null&&(d.diagonal=f.diagonal),f.upper!=null&&(d.upper=f.upper),f.lower!=null&&(d.lower=f.lower),f.data){d.buffer(n(f.data)),d.columns=f.data.length,d.count=f.data[0].length,d.bounds=[];for(var o=0;o<d.columns;o++)d.bounds[o]=S(f.data[o],1)}var m;f.range&&(d.range=f.range,m=d.range&&typeof d.range[0]!="number"),f.domain&&(d.domain=f.domain);var l=!1;f.padding!=null&&(Array.isArray(f.padding)&&f.padding.length===d.columns&&typeof f.padding[f.padding.length-1]=="number"?(d.padding=f.padding.map(s),l=!0):d.padding=s(f.padding));var w=d.columns,_=d.count,c=d.viewport.width,b=d.viewport.height,u=d.viewport.x,L=d.viewport.y,T=c/w,k=b/w;d.passes=[];for(var P=0;P<w;P++)for(var z=0;z<w;z++)if(!(!d.diagonal&&z===P)&&!(!d.upper&&P>z)&&!(!d.lower&&P<z)){var I=t(d.id,P,z),D=this.passes[I]||(this.passes[I]={});if(f.data&&(f.transpose?D.positions={x:{buffer:d.buffer,offset:z,count:_,stride:w},y:{buffer:d.buffer,offset:P,count:_,stride:w}}:D.positions={x:{buffer:d.buffer,offset:z*_,count:_},y:{buffer:d.buffer,offset:P*_,count:_}},D.bounds=h(d.bounds,P,z)),f.domain||f.viewport||f.data){var R=l?h(d.padding,P,z):d.padding;if(d.domain){var O=h(d.domain,P,z),F=O[0],N=O[1],G=O[2],K=O[3];D.viewport=[u+F*c+R[0],L+N*b+R[1],u+G*c-R[2],L+K*b-R[3]]}else D.viewport=[u+z*T+T*R[0],L+P*k+k*R[1],u+(z+1)*T-T*R[2],L+(P+1)*k-k*R[3]]}f.color&&(D.color=d.color),f.size&&(D.size=d.size),f.marker&&(D.marker=d.marker),f.borderSize&&(D.borderSize=d.borderSize),f.borderColor&&(D.borderColor=d.borderColor),f.opacity&&(D.opacity=d.opacity),f.range&&(D.range=m?h(d.range,P,z):d.range||D.bounds),d.passes.push(I)}return this},r.prototype.draw=function(){for(var i,x=[],p=arguments.length;p--;)x[p]=arguments[p];if(!x.length)this.scatter.draw();else{for(var v=[],f=0;f<x.length;f++)if(typeof x[f]=="number"){var d=this.traces[x[f]],o=d.passes,m=d.passOffset;v.push.apply(v,e(m,m+o.length))}else if(x[f].length){var l=x[f],w=this.traces[f],_=w.passes,c=w.passOffset;_=_.map(function(b,u){v[c+u]=l})}(i=this.scatter).draw.apply(i,v)}return this},r.prototype.destroy=function(){return this.traces.forEach(function(i){i.buffer&&i.buffer.destroy&&i.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this};function t(i,x,p){var v=i.id!=null?i.id:i,f=x,d=p,o=v<<16|(f&255)<<8|d&255;return o}function h(i,x,p){var v,f,d,o,m=i[x],l=i[p];return m.length>2?(m[0],m[2],v=m[1],f=m[3]):m.length?(v=m[0],f=m[1]):(m.x,v=m.y,m.x+m.width,f=m.y+m.height),l.length>2?(d=l[0],o=l[2],l[1],l[3]):l.length?(d=l[0],o=l[1]):(d=l.x,l.y,o=l.x+l.width,l.y+l.height),[d,v,o,f]}function s(i){if(typeof i=="number")return[i,i,i,i];if(i.length===2)return[i[0],i[1],i[0],i[1]];var x=a(i);return[x.x,x.y,x.x+x.width,x.y+x.height]}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?ee.exports=g():A.createREGL=g()})(this,function(){function A(at,$t){this.id=be++,this.type=at,this.data=$t}function g(at){if(at.length===0)return[];var $t=at.charAt(0),Jt=at.charAt(at.length-1);if(1<at.length&&$t===Jt&&($t==='"'||$t==="'"))return['"'+at.substr(1,at.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if($t=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(at))return g(at.substr(0,$t.index)).concat(g($t[1])).concat(g(at.substr($t.index+$t[0].length)));if($t=at.split("."),$t.length===1)return['"'+at.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(at=[],Jt=0;Jt<$t.length;++Jt)at=at.concat(g($t[Jt]));return at}function S(at){return"["+g(at).join("][")+"]"}function M(at,$t){if(typeof at=="function")return new A(0,at);if(typeof at=="number"||typeof at=="boolean")return new A(5,at);if(Array.isArray(at))return new A(6,at.map(function(Jt,Gt){return M(Jt)}));if(at instanceof A)return at}function e(){var at={"":0},$t=[""];return{id:function(Jt){var Gt=at[Jt];return Gt||(Gt=at[Jt]=$t.length,$t.push(Jt),Gt)},str:function(Jt){return $t[Jt]}}}function a(at,$t,Jt){function Gt(){var Je=window.innerWidth,st=window.innerHeight;at!==document.body&&(st=_r.getBoundingClientRect(),Je=st.right-st.left,st=st.bottom-st.top),_r.width=Jt*Je,_r.height=Jt*st}var _r=document.createElement("canvas");oe(_r.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),at.appendChild(_r),at===document.body&&(_r.style.position="absolute",oe(at.style,{margin:0,padding:0}));var rt;return at!==document.body&&typeof ResizeObserver=="function"?(rt=new ResizeObserver(function(){setTimeout(Gt)}),rt.observe(at)):window.addEventListener("resize",Gt,!1),Gt(),{canvas:_r,onDestroy:function(){rt?rt.disconnect():window.removeEventListener("resize",Gt),at.removeChild(_r)}}}function n(at,$t){function Jt(Gt){try{return at.getContext(Gt,$t)}catch{return null}}return Jt("webgl")||Jt("experimental-webgl")||Jt("webgl-experimental")}function r(at){return typeof at=="string"?at.split():at}function t(at){return typeof at=="string"?document.querySelector(at):at}function h(at){var $t=at||{},Jt,Gt,_r,rt;at={};var Je=[],st=[],lt=typeof window>"u"?1:window.devicePixelRatio,Tt=!1,zt={},Ce=function(nt){},Se=function(){};if(typeof $t=="string"?Jt=document.querySelector($t):typeof $t=="object"&&(typeof $t.nodeName=="string"&&typeof $t.appendChild=="function"&&typeof $t.getBoundingClientRect=="function"?Jt=$t:typeof $t.drawArrays=="function"||typeof $t.drawElements=="function"?(rt=$t,_r=rt.canvas):("gl"in $t?rt=$t.gl:"canvas"in $t?_r=t($t.canvas):"container"in $t&&(Gt=t($t.container)),"attributes"in $t&&(at=$t.attributes),"extensions"in $t&&(Je=r($t.extensions)),"optionalExtensions"in $t&&(st=r($t.optionalExtensions)),"onDone"in $t&&(Ce=$t.onDone),"profile"in $t&&(Tt=!!$t.profile),"pixelRatio"in $t&&(lt=+$t.pixelRatio),"cachedCode"in $t&&(zt=$t.cachedCode))),Jt&&(Jt.nodeName.toLowerCase()==="canvas"?_r=Jt:Gt=Jt),!rt){if(!_r){if(Jt=a(Gt||document.body,Ce,lt),!Jt)return null;_r=Jt.canvas,Se=Jt.onDestroy}at.premultipliedAlpha===void 0&&(at.premultipliedAlpha=!0),rt=n(_r,at)}return rt?{gl:rt,canvas:_r,container:Gt,extensions:Je,optionalExtensions:st,pixelRatio:lt,profile:Tt,cachedCode:zt,onDone:Ce,onDestroy:Se}:(Se(),Ce("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function s(at,$t){function Jt(Je){Je=Je.toLowerCase();var st;try{st=Gt[Je]=at.getExtension(Je)}catch{}return!!st}for(var Gt={},_r=0;_r<$t.extensions.length;++_r){var rt=$t.extensions[_r];if(!Jt(rt))return $t.onDestroy(),$t.onDone('"'+rt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return $t.optionalExtensions.forEach(Jt),{extensions:Gt,restore:function(){Object.keys(Gt).forEach(function(Je){if(Gt[Je]&&!Jt(Je))throw Error("(regl): error restoring extension "+Je)})}}}function i(at,$t){for(var Jt=Array(at),Gt=0;Gt<at;++Gt)Jt[Gt]=$t(Gt);return Jt}function x(at){var $t,Jt;return $t=(65535<at)<<4,at>>>=$t,Jt=(255<at)<<3,at>>>=Jt,$t|=Jt,Jt=(15<at)<<2,at>>>=Jt,$t|=Jt,Jt=(3<at)<<1,$t|Jt|at>>>Jt>>1}function p(){function at(Gt){e:{for(var _r=16;268435456>=_r;_r*=16)if(Gt<=_r){Gt=_r;break e}Gt=0}return _r=Jt[x(Gt)>>2],0<_r.length?_r.pop():new ArrayBuffer(Gt)}function $t(Gt){Jt[x(Gt.byteLength)>>2].push(Gt)}var Jt=i(8,function(){return[]});return{alloc:at,free:$t,allocType:function(Gt,_r){var rt=null;switch(Gt){case 5120:rt=new Int8Array(at(_r),0,_r);break;case 5121:rt=new Uint8Array(at(_r),0,_r);break;case 5122:rt=new Int16Array(at(2*_r),0,_r);break;case 5123:rt=new Uint16Array(at(2*_r),0,_r);break;case 5124:rt=new Int32Array(at(4*_r),0,_r);break;case 5125:rt=new Uint32Array(at(4*_r),0,_r);break;case 5126:rt=new Float32Array(at(4*_r),0,_r);break;default:return null}return rt.length!==_r?rt.subarray(0,_r):rt},freeType:function(Gt){$t(Gt.buffer)}}}function v(at){return!!at&&typeof at=="object"&&Array.isArray(at.shape)&&Array.isArray(at.stride)&&typeof at.offset=="number"&&at.shape.length===at.stride.length&&(Array.isArray(at.data)||Ee(at.data))}function f(at,$t,Jt,Gt,_r,rt){for(var Je=0;Je<$t;++Je)for(var st=at[Je],lt=0;lt<Jt;++lt)for(var Tt=st[lt],zt=0;zt<Gt;++zt)_r[rt++]=Tt[zt]}function d(at,$t,Jt,Gt,_r){for(var rt=1,Je=Jt+1;Je<$t.length;++Je)rt*=$t[Je];var st=$t[Jt];if($t.length-Jt===4){var lt=$t[Jt+1],Tt=$t[Jt+2];for($t=$t[Jt+3],Je=0;Je<st;++Je)f(at[Je],lt,Tt,$t,Gt,_r),_r+=rt}else for(Je=0;Je<st;++Je)d(at[Je],$t,Jt+1,Gt,_r),_r+=rt}function o(at){return we[Object.prototype.toString.call(at)]|0}function m(at,$t){for(var Jt=0;Jt<$t.length;++Jt)at[Jt]=$t[Jt]}function l(at,$t,Jt,Gt,_r,rt,Je){for(var st=0,lt=0;lt<Jt;++lt)for(var Tt=0;Tt<Gt;++Tt)at[st++]=$t[_r*lt+rt*Tt+Je]}function w(at,$t,Jt,Gt){function _r(Ce){this.id=lt++,this.buffer=at.createBuffer(),this.type=Ce,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Jt.profile&&(this.stats={size:0})}function rt(Ce,Se,nt){Ce.byteLength=Se.byteLength,at.bufferData(Ce.type,Se,nt)}function Je(Ce,Se,nt,it,ct,kt){if(Ce.usage=nt,Array.isArray(Se)){if(Ce.dtype=it||5126,0<Se.length)if(Array.isArray(Se[0])){ct=Ie(Se);for(var gt=it=1;gt<ct.length;++gt)it*=ct[gt];Ce.dimension=it,Se=Ve(Se,ct,Ce.dtype),rt(Ce,Se,nt),kt?Ce.persistentData=Se:ge.freeType(Se)}else typeof Se[0]=="number"?(Ce.dimension=ct,ct=ge.allocType(Ce.dtype,Se.length),m(ct,Se),rt(Ce,ct,nt),kt?Ce.persistentData=ct:ge.freeType(ct)):Ee(Se[0])&&(Ce.dimension=Se[0].length,Ce.dtype=it||o(Se[0])||5126,Se=Ve(Se,[Se.length,Se[0].length],Ce.dtype),rt(Ce,Se,nt),kt?Ce.persistentData=Se:ge.freeType(Se))}else if(Ee(Se))Ce.dtype=it||o(Se),Ce.dimension=ct,rt(Ce,Se,nt),kt&&(Ce.persistentData=new Uint8Array(new Uint8Array(Se.buffer)));else if(v(Se)){ct=Se.shape;var St=Se.stride,gt=Se.offset,Yt=0,ar=0,kr=0,br=0;ct.length===1?(Yt=ct[0],ar=1,kr=St[0],br=0):ct.length===2&&(Yt=ct[0],ar=ct[1],kr=St[0],br=St[1]),Ce.dtype=it||o(Se.data)||5126,Ce.dimension=ar,ct=ge.allocType(Ce.dtype,Yt*ar),l(ct,Se.data,Yt,ar,kr,br,gt),rt(Ce,ct,nt),kt?Ce.persistentData=ct:ge.freeType(ct)}else Se instanceof ArrayBuffer&&(Ce.dtype=5121,Ce.dimension=ct,rt(Ce,Se,nt),kt&&(Ce.persistentData=new Uint8Array(new Uint8Array(Se))))}function st(Ce){$t.bufferCount--,Gt(Ce),at.deleteBuffer(Ce.buffer),Ce.buffer=null,delete Tt[Ce.id]}var lt=0,Tt={};_r.prototype.bind=function(){at.bindBuffer(this.type,this.buffer)},_r.prototype.destroy=function(){st(this)};var zt=[];return Jt.profile&&($t.getTotalBufferSize=function(){var Ce=0;return Object.keys(Tt).forEach(function(Se){Ce+=Tt[Se].stats.size}),Ce}),{create:function(Ce,Se,nt,it){function ct(gt){var St=35044,Yt=null,ar=0,kr=0,br=1;return Array.isArray(gt)||Ee(gt)||v(gt)||gt instanceof ArrayBuffer?Yt=gt:typeof gt=="number"?ar=gt|0:gt&&("data"in gt&&(Yt=gt.data),"usage"in gt&&(St=Xe[gt.usage]),"type"in gt&&(kr=ke[gt.type]),"dimension"in gt&&(br=gt.dimension|0),"length"in gt&&(ar=gt.length|0)),kt.bind(),Yt?Je(kt,Yt,St,kr,br,it):(ar&&at.bufferData(kt.type,ar,St),kt.dtype=kr||5121,kt.usage=St,kt.dimension=br,kt.byteLength=ar),Jt.profile&&(kt.stats.size=kt.byteLength*De[kt.dtype]),ct}$t.bufferCount++;var kt=new _r(Se);return Tt[kt.id]=kt,nt||ct(Ce),ct._reglType="buffer",ct._buffer=kt,ct.subdata=function(gt,St){var Yt=(St||0)|0,ar;if(kt.bind(),Ee(gt)||gt instanceof ArrayBuffer)at.bufferSubData(kt.type,Yt,gt);else if(Array.isArray(gt)){if(0<gt.length)if(typeof gt[0]=="number"){var kr=ge.allocType(kt.dtype,gt.length);m(kr,gt),at.bufferSubData(kt.type,Yt,kr),ge.freeType(kr)}else(Array.isArray(gt[0])||Ee(gt[0]))&&(ar=Ie(gt),kr=Ve(gt,ar,kt.dtype),at.bufferSubData(kt.type,Yt,kr),ge.freeType(kr))}else if(v(gt)){ar=gt.shape;var br=gt.stride,Mr=kr=0,Yr=0,nr=0;ar.length===1?(kr=ar[0],Mr=1,Yr=br[0],nr=0):ar.length===2&&(kr=ar[0],Mr=ar[1],Yr=br[0],nr=br[1]),ar=Array.isArray(gt.data)?kt.dtype:o(gt.data),ar=ge.allocType(ar,kr*Mr),l(ar,gt.data,kr,Mr,Yr,nr,gt.offset),at.bufferSubData(kt.type,Yt,ar),ge.freeType(ar)}return ct},Jt.profile&&(ct.stats=kt.stats),ct.destroy=function(){st(kt)},ct},createStream:function(Ce,Se){var nt=zt.pop();return nt||(nt=new _r(Ce)),nt.bind(),Je(nt,Se,35040,0,1,!1),nt},destroyStream:function(Ce){zt.push(Ce)},clear:function(){Pe(Tt).forEach(st),zt.forEach(st)},getBuffer:function(Ce){return Ce&&Ce._buffer instanceof _r?Ce._buffer:null},restore:function(){Pe(Tt).forEach(function(Ce){Ce.buffer=at.createBuffer(),at.bindBuffer(Ce.type,Ce.buffer),at.bufferData(Ce.type,Ce.persistentData||Ce.byteLength,Ce.usage)})},_initBuffer:Je}}function _(at,$t,Jt,Gt){function _r(Ce){this.id=lt++,st[this.id]=this,this.buffer=Ce,this.primType=4,this.type=this.vertCount=0}function rt(Ce,Se,nt,it,ct,kt,gt){Ce.buffer.bind();var St;if(Se?((St=gt)||Ee(Se)&&(!v(Se)||Ee(Se.data))||(St=$t.oes_element_index_uint?5125:5123),Jt._initBuffer(Ce.buffer,Se,nt,St,3)):(at.bufferData(34963,kt,nt),Ce.buffer.dtype=St||5121,Ce.buffer.usage=nt,Ce.buffer.dimension=3,Ce.buffer.byteLength=kt),St=gt,!gt){switch(Ce.buffer.dtype){case 5121:case 5120:St=5121;break;case 5123:case 5122:St=5123;break;case 5125:case 5124:St=5125}Ce.buffer.dtype=St}Ce.type=St,Se=ct,0>Se&&(Se=Ce.buffer.byteLength,St===5123?Se>>=1:St===5125&&(Se>>=2)),Ce.vertCount=Se,Se=it,0>it&&(Se=4,it=Ce.buffer.dimension,it===1&&(Se=0),it===2&&(Se=1),it===3&&(Se=4)),Ce.primType=Se}function Je(Ce){Gt.elementsCount--,delete st[Ce.id],Ce.buffer.destroy(),Ce.buffer=null}var st={},lt=0,Tt={uint8:5121,uint16:5123};$t.oes_element_index_uint&&(Tt.uint32=5125),_r.prototype.bind=function(){this.buffer.bind()};var zt=[];return{create:function(Ce,Se){function nt(kt){if(kt)if(typeof kt=="number")it(kt),ct.primType=4,ct.vertCount=kt|0,ct.type=5121;else{var gt=null,St=35044,Yt=-1,ar=-1,kr=0,br=0;Array.isArray(kt)||Ee(kt)||v(kt)?gt=kt:("data"in kt&&(gt=kt.data),"usage"in kt&&(St=Xe[kt.usage]),"primitive"in kt&&(Yt=Ye[kt.primitive]),"count"in kt&&(ar=kt.count|0),"type"in kt&&(br=Tt[kt.type]),"length"in kt?kr=kt.length|0:(kr=ar,br===5123||br===5122?kr*=2:(br===5125||br===5124)&&(kr*=4))),rt(ct,gt,St,Yt,ar,kr,br)}else it(),ct.primType=4,ct.vertCount=0,ct.type=5121;return nt}var it=Jt.create(null,34963,!0),ct=new _r(it._buffer);return Gt.elementsCount++,nt(Ce),nt._reglType="elements",nt._elements=ct,nt.subdata=function(kt,gt){return it.subdata(kt,gt),nt},nt.destroy=function(){Je(ct)},nt},createStream:function(Ce){var Se=zt.pop();return Se||(Se=new _r(Jt.create(null,34963,!0,!1)._buffer)),rt(Se,Ce,35040,-1,-1,0,0),Se},destroyStream:function(Ce){zt.push(Ce)},getElements:function(Ce){return typeof Ce=="function"&&Ce._elements instanceof _r?Ce._elements:null},clear:function(){Pe(st).forEach(Je)}}}function c(at){for(var $t=ge.allocType(5123,at.length),Jt=0;Jt<at.length;++Jt)if(isNaN(at[Jt]))$t[Jt]=65535;else if(at[Jt]===1/0)$t[Jt]=31744;else if(at[Jt]===-1/0)$t[Jt]=64512;else{vt[0]=at[Jt];var rt=Dt[0],Gt=rt>>>31<<15,_r=(rt<<1>>>24)-127,rt=rt>>13&1023;$t[Jt]=-24>_r?Gt:-14>_r?Gt+(rt+1024>>-14-_r):15<_r?Gt+31744:Gt+(_r+15<<10)+rt}return $t}function b(at){return Array.isArray(at)||Ee(at)}function u(at){return"[object "+at+"]"}function L(at){return Array.isArray(at)&&(at.length===0||typeof at[0]=="number")}function T(at){return!!(Array.isArray(at)&&at.length!==0&&b(at[0]))}function k(at){return Object.prototype.toString.call(at)}function P(at){if(!at)return!1;var $t=k(at);return 0<=Ae.indexOf($t)?!0:L(at)||T(at)||v(at)}function z(at,$t){at.type===36193?(at.data=c($t),ge.freeType($t)):at.data=$t}function I(at,$t,Jt,Gt,_r,rt){if(at=typeof Ze[at]<"u"?Ze[at]:Mt[at]*Ne[$t],rt&&(at*=6),_r){for(Gt=0;1<=Jt;)Gt+=at*Jt*Jt,Jt/=2;return Gt}return at*Jt*Gt}function D(at,$t,Jt,Gt,_r,rt,Je){function st(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function lt(Tr,pn){Tr.internalformat=pn.internalformat,Tr.format=pn.format,Tr.type=pn.type,Tr.compressed=pn.compressed,Tr.premultiplyAlpha=pn.premultiplyAlpha,Tr.flipY=pn.flipY,Tr.unpackAlignment=pn.unpackAlignment,Tr.colorSpace=pn.colorSpace,Tr.width=pn.width,Tr.height=pn.height,Tr.channels=pn.channels}function Tt(Tr,pn){if(typeof pn=="object"&&pn){"premultiplyAlpha"in pn&&(Tr.premultiplyAlpha=pn.premultiplyAlpha),"flipY"in pn&&(Tr.flipY=pn.flipY),"alignment"in pn&&(Tr.unpackAlignment=pn.alignment),"colorSpace"in pn&&(Tr.colorSpace=or[pn.colorSpace]),"type"in pn&&(Tr.type=Ir[pn.type]);var fn=Tr.width,An=Tr.height,Zn=Tr.channels,ua=!1;"shape"in pn?(fn=pn.shape[0],An=pn.shape[1],pn.shape.length===3&&(Zn=pn.shape[2],ua=!0)):("radius"in pn&&(fn=An=pn.radius),"width"in pn&&(fn=pn.width),"height"in pn&&(An=pn.height),"channels"in pn&&(Zn=pn.channels,ua=!0)),Tr.width=fn|0,Tr.height=An|0,Tr.channels=Zn|0,fn=!1,"format"in pn&&(fn=pn.format,An=Tr.internalformat=Or[fn],Tr.format=Vn[An],fn in Ir&&!("type"in pn)&&(Tr.type=Ir[fn]),fn in Er&&(Tr.compressed=!0),fn=!0),!ua&&fn?Tr.channels=Mt[Tr.format]:ua&&!fn&&Tr.channels!==Ft[Tr.format]&&(Tr.format=Tr.internalformat=Ft[Tr.channels])}}function zt(Tr){at.pixelStorei(37440,Tr.flipY),at.pixelStorei(37441,Tr.premultiplyAlpha),at.pixelStorei(37443,Tr.colorSpace),at.pixelStorei(3317,Tr.unpackAlignment)}function Ce(){st.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Se(Tr,pn){var fn=null;if(P(pn)?fn=pn:pn&&(Tt(Tr,pn),"x"in pn&&(Tr.xOffset=pn.x|0),"y"in pn&&(Tr.yOffset=pn.y|0),P(pn.data)&&(fn=pn.data)),pn.copy){var An=_r.viewportWidth,Zn=_r.viewportHeight;Tr.width=Tr.width||An-Tr.xOffset,Tr.height=Tr.height||Zn-Tr.yOffset,Tr.needsCopy=!0}else if(!fn)Tr.width=Tr.width||1,Tr.height=Tr.height||1,Tr.channels=Tr.channels||4;else if(Ee(fn))Tr.channels=Tr.channels||4,Tr.data=fn,"type"in pn||Tr.type!==5121||(Tr.type=we[Object.prototype.toString.call(fn)]|0);else if(L(fn)){switch(Tr.channels=Tr.channels||4,An=fn,Zn=An.length,Tr.type){case 5121:case 5123:case 5125:case 5126:Zn=ge.allocType(Tr.type,Zn),Zn.set(An),Tr.data=Zn;break;case 36193:Tr.data=c(An)}Tr.alignment=1,Tr.needsFree=!0}else if(v(fn)){An=fn.data,Array.isArray(An)||Tr.type!==5121||(Tr.type=we[Object.prototype.toString.call(An)]|0);var Zn=fn.shape,ua=fn.stride,ea,Rn,Xn,Ua;Zn.length===3?(Xn=Zn[2],Ua=ua[2]):Ua=Xn=1,ea=Zn[0],Rn=Zn[1],Zn=ua[0],ua=ua[1],Tr.alignment=1,Tr.width=ea,Tr.height=Rn,Tr.channels=Xn,Tr.format=Tr.internalformat=Ft[Xn],Tr.needsFree=!0,ea=Ua,fn=fn.offset,Xn=Tr.width,Ua=Tr.height,Rn=Tr.channels;for(var li=ge.allocType(Tr.type===36193?5126:Tr.type,Xn*Ua*Rn),Ht=0,hr=0;hr<Ua;++hr)for(var rn=0;rn<Xn;++rn)for(var vn=0;vn<Rn;++vn)li[Ht++]=An[Zn*rn+ua*hr+ea*vn+fn];z(Tr,li)}else if(k(fn)===Xt||k(fn)===It||k(fn)===At)k(fn)===Xt||k(fn)===It?Tr.element=fn:Tr.element=fn.canvas,Tr.width=Tr.element.width,Tr.height=Tr.element.height,Tr.channels=4;else if(k(fn)===Ge)Tr.element=fn,Tr.width=fn.width,Tr.height=fn.height,Tr.channels=4;else if(k(fn)===tt)Tr.element=fn,Tr.width=fn.naturalWidth,Tr.height=fn.naturalHeight,Tr.channels=4;else if(k(fn)===He)Tr.element=fn,Tr.width=fn.videoWidth,Tr.height=fn.videoHeight,Tr.channels=4;else if(T(fn)){for(An=Tr.width||fn[0].length,Zn=Tr.height||fn.length,ua=Tr.channels,ua=b(fn[0][0])?ua||fn[0][0].length:ua||1,ea=Ue.shape(fn),Xn=1,Ua=0;Ua<ea.length;++Ua)Xn*=ea[Ua];Xn=ge.allocType(Tr.type===36193?5126:Tr.type,Xn),Ue.flatten(fn,ea,"",Xn),z(Tr,Xn),Tr.alignment=1,Tr.width=An,Tr.height=Zn,Tr.channels=ua,Tr.format=Tr.internalformat=Ft[ua],Tr.needsFree=!0}}function nt(Tr,pn,fn,An,Zn){var ua=Tr.element,ea=Tr.data,Rn=Tr.internalformat,Xn=Tr.format,Ua=Tr.type,li=Tr.width,Ht=Tr.height;zt(Tr),ua?at.texSubImage2D(pn,Zn,fn,An,Xn,Ua,ua):Tr.compressed?at.compressedTexSubImage2D(pn,Zn,fn,An,Rn,li,Ht,ea):Tr.needsCopy?(Gt(),at.copyTexSubImage2D(pn,Zn,fn,An,Tr.xOffset,Tr.yOffset,li,Ht)):at.texSubImage2D(pn,Zn,fn,An,li,Ht,Xn,Ua,ea)}function it(){return pa.pop()||new Ce}function ct(Tr){Tr.needsFree&&ge.freeType(Tr.data),Ce.call(Tr),pa.push(Tr)}function kt(){st.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function gt(Tr,pn,fn){var An=Tr.images[0]=it();Tr.mipmask=1,An.width=Tr.width=pn,An.height=Tr.height=fn,An.channels=Tr.channels=4}function St(Tr,pn){var fn=null;if(P(pn))fn=Tr.images[0]=it(),lt(fn,Tr),Se(fn,pn),Tr.mipmask=1;else if(Tt(Tr,pn),Array.isArray(pn.mipmap))for(var An=pn.mipmap,Zn=0;Zn<An.length;++Zn)fn=Tr.images[Zn]=it(),lt(fn,Tr),fn.width>>=Zn,fn.height>>=Zn,Se(fn,An[Zn]),Tr.mipmask|=1<<Zn;else fn=Tr.images[0]=it(),lt(fn,Tr),Se(fn,pn),Tr.mipmask=1;lt(Tr,Tr.images[0])}function Yt(Tr,pn){for(var fn=Tr.images,An=0;An<fn.length&&fn[An];++An){var Zn=fn[An],ua=pn,ea=An,Rn=Zn.element,Xn=Zn.data,Ua=Zn.internalformat,li=Zn.format,Ht=Zn.type,hr=Zn.width,rn=Zn.height;zt(Zn),Rn?at.texImage2D(ua,ea,li,li,Ht,Rn):Zn.compressed?at.compressedTexImage2D(ua,ea,Ua,hr,rn,0,Xn):Zn.needsCopy?(Gt(),at.copyTexImage2D(ua,ea,li,Zn.xOffset,Zn.yOffset,hr,rn,0)):at.texImage2D(ua,ea,li,hr,rn,0,li,Ht,Xn||null)}}function ar(){var Tr=Ma.pop()||new kt;st.call(Tr);for(var pn=Tr.mipmask=0;16>pn;++pn)Tr.images[pn]=null;return Tr}function kr(Tr){for(var pn=Tr.images,fn=0;fn<pn.length;++fn)pn[fn]&&ct(pn[fn]),pn[fn]=null;Ma.push(Tr)}function br(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Mr(Tr,pn){"min"in pn&&(Tr.minFilter=Zt[pn.min],0<=Kt.indexOf(Tr.minFilter)&&!("faces"in pn)&&(Tr.genMipmaps=!0)),"mag"in pn&&(Tr.magFilter=Lt[pn.mag]);var fn=Tr.wrapS,An=Tr.wrapT;if("wrap"in pn){var Zn=pn.wrap;typeof Zn=="string"?fn=An=et[Zn]:Array.isArray(Zn)&&(fn=et[Zn[0]],An=et[Zn[1]])}else"wrapS"in pn&&(fn=et[pn.wrapS]),"wrapT"in pn&&(An=et[pn.wrapT]);if(Tr.wrapS=fn,Tr.wrapT=An,"anisotropic"in pn&&(Tr.anisotropic=pn.anisotropic),"mipmap"in pn){switch(fn=!1,typeof pn.mipmap){case"string":Tr.mipmapHint=Sr[pn.mipmap],fn=Tr.genMipmaps=!0;break;case"boolean":fn=Tr.genMipmaps=pn.mipmap;break;case"object":Tr.genMipmaps=!1,fn=!0}!fn||"min"in pn||(Tr.minFilter=9984)}}function Yr(Tr,pn){at.texParameteri(pn,10241,Tr.minFilter),at.texParameteri(pn,10240,Tr.magFilter),at.texParameteri(pn,10242,Tr.wrapS),at.texParameteri(pn,10243,Tr.wrapT),$t.ext_texture_filter_anisotropic&&at.texParameteri(pn,34046,Tr.anisotropic),Tr.genMipmaps&&(at.hint(33170,Tr.mipmapHint),at.generateMipmap(pn))}function nr(Tr){st.call(this),this.mipmask=0,this.internalformat=6408,this.id=ci++,this.refCount=1,this.target=Tr,this.texture=at.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new br,Je.profile&&(this.stats={size:0})}function gr(Tr){at.activeTexture(33984),at.bindTexture(Tr.target,Tr.texture)}function Rr(){var Tr=Wa[0];Tr?at.bindTexture(Tr.target,Tr.texture):at.bindTexture(3553,null)}function Br(Tr){var pn=Tr.texture,fn=Tr.unit,An=Tr.target;0<=fn&&(at.activeTexture(33984+fn),at.bindTexture(An,null),Wa[fn]=null),at.deleteTexture(pn),Tr.texture=null,Tr.params=null,Tr.pixels=null,Tr.refCount=0,delete Va[Tr.id],rt.textureCount--}var Sr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},et={repeat:10497,clamp:33071,mirror:33648},Lt={nearest:9728,linear:9729},Zt=oe({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Lt),or={none:0,browser:37444},Ir={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Or={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Er={};$t.ext_srgb&&(Or.srgb=35904,Or.srgba=35906),$t.oes_texture_float&&(Ir.float32=Ir.float=5126),$t.oes_texture_half_float&&(Ir.float16=Ir["half float"]=36193),$t.webgl_depth_texture&&(oe(Or,{depth:6402,"depth stencil":34041}),oe(Ir,{uint16:5123,uint32:5125,"depth stencil":34042})),$t.webgl_compressed_texture_s3tc&&oe(Er,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),$t.webgl_compressed_texture_atc&&oe(Er,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),$t.webgl_compressed_texture_pvrtc&&oe(Er,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),$t.webgl_compressed_texture_etc1&&(Er["rgb etc1"]=36196);var wr=Array.prototype.slice.call(at.getParameter(34467));Object.keys(Er).forEach(function(Tr){var pn=Er[Tr];0<=wr.indexOf(pn)&&(Or[Tr]=pn)});var Gr=Object.keys(Or);Jt.textureFormats=Gr;var wn=[];Object.keys(Or).forEach(function(Tr){wn[Or[Tr]]=Tr});var cn=[];Object.keys(Ir).forEach(function(Tr){cn[Ir[Tr]]=Tr});var Bn=[];Object.keys(Lt).forEach(function(Tr){Bn[Lt[Tr]]=Tr});var En=[];Object.keys(Zt).forEach(function(Tr){En[Zt[Tr]]=Tr});var Yn=[];Object.keys(et).forEach(function(Tr){Yn[et[Tr]]=Tr});var Vn=Gr.reduce(function(Tr,pn){var fn=Or[pn];return fn===6409||fn===6406||fn===6409||fn===6410||fn===6402||fn===34041||$t.ext_srgb&&(fn===35904||fn===35906)?Tr[fn]=fn:fn===32855||0<=pn.indexOf("rgba")?Tr[fn]=6408:Tr[fn]=6407,Tr},{}),pa=[],Ma=[],ci=0,Va={},ja=Jt.maxTextureUnits,Wa=Array(ja).map(function(){return null});return oe(nr.prototype,{bind:function(){this.bindCount+=1;var Tr=this.unit;if(0>Tr){for(var pn=0;pn<ja;++pn){var fn=Wa[pn];if(fn){if(0<fn.bindCount)continue;fn.unit=-1}Wa[pn]=this,Tr=pn;break}Je.profile&&rt.maxTextureUnits<Tr+1&&(rt.maxTextureUnits=Tr+1),this.unit=Tr,at.activeTexture(33984+Tr),at.bindTexture(this.target,this.texture)}return Tr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Br(this)}}),Je.profile&&(rt.getTotalTextureSize=function(){var Tr=0;return Object.keys(Va).forEach(function(pn){Tr+=Va[pn].stats.size}),Tr}),{create2D:function(Tr,pn){function fn(Zn,ua){var ea=An.texInfo;br.call(ea);var Rn=ar();return typeof Zn=="number"?typeof ua=="number"?gt(Rn,Zn|0,ua|0):gt(Rn,Zn|0,Zn|0):Zn?(Mr(ea,Zn),St(Rn,Zn)):gt(Rn,1,1),ea.genMipmaps&&(Rn.mipmask=(Rn.width<<1)-1),An.mipmask=Rn.mipmask,lt(An,Rn),An.internalformat=Rn.internalformat,fn.width=Rn.width,fn.height=Rn.height,gr(An),Yt(Rn,3553),Yr(ea,3553),Rr(),kr(Rn),Je.profile&&(An.stats.size=I(An.internalformat,An.type,Rn.width,Rn.height,ea.genMipmaps,!1)),fn.format=wn[An.internalformat],fn.type=cn[An.type],fn.mag=Bn[ea.magFilter],fn.min=En[ea.minFilter],fn.wrapS=Yn[ea.wrapS],fn.wrapT=Yn[ea.wrapT],fn}var An=new nr(3553);return Va[An.id]=An,rt.textureCount++,fn(Tr,pn),fn.subimage=function(Zn,ua,ea,Rn){ua|=0,ea|=0,Rn|=0;var Xn=it();return lt(Xn,An),Xn.width=0,Xn.height=0,Se(Xn,Zn),Xn.width=Xn.width||(An.width>>Rn)-ua,Xn.height=Xn.height||(An.height>>Rn)-ea,gr(An),nt(Xn,3553,ua,ea,Rn),Rr(),ct(Xn),fn},fn.resize=function(Zn,ua){var ea=Zn|0,Rn=ua|0||ea;if(ea===An.width&&Rn===An.height)return fn;fn.width=An.width=ea,fn.height=An.height=Rn,gr(An);for(var Xn=0;An.mipmask>>Xn;++Xn){var Ua=ea>>Xn,li=Rn>>Xn;if(!Ua||!li)break;at.texImage2D(3553,Xn,An.format,Ua,li,0,An.format,An.type,null)}return Rr(),Je.profile&&(An.stats.size=I(An.internalformat,An.type,ea,Rn,!1,!1)),fn},fn._reglType="texture2d",fn._texture=An,Je.profile&&(fn.stats=An.stats),fn.destroy=function(){An.decRef()},fn},createCube:function(Tr,pn,fn,An,Zn,ua){function ea(Ua,li,Ht,hr,rn,vn){var en,Tn=Rn.texInfo;for(br.call(Tn),en=0;6>en;++en)Xn[en]=ar();if(typeof Ua=="number"||!Ua)for(Ua=Ua|0||1,en=0;6>en;++en)gt(Xn[en],Ua,Ua);else if(typeof Ua=="object")if(li)St(Xn[0],Ua),St(Xn[1],li),St(Xn[2],Ht),St(Xn[3],hr),St(Xn[4],rn),St(Xn[5],vn);else if(Mr(Tn,Ua),Tt(Rn,Ua),"faces"in Ua)for(Ua=Ua.faces,en=0;6>en;++en)lt(Xn[en],Rn),St(Xn[en],Ua[en]);else for(en=0;6>en;++en)St(Xn[en],Ua);for(lt(Rn,Xn[0]),Rn.mipmask=Tn.genMipmaps?(Xn[0].width<<1)-1:Xn[0].mipmask,Rn.internalformat=Xn[0].internalformat,ea.width=Xn[0].width,ea.height=Xn[0].height,gr(Rn),en=0;6>en;++en)Yt(Xn[en],34069+en);for(Yr(Tn,34067),Rr(),Je.profile&&(Rn.stats.size=I(Rn.internalformat,Rn.type,ea.width,ea.height,Tn.genMipmaps,!0)),ea.format=wn[Rn.internalformat],ea.type=cn[Rn.type],ea.mag=Bn[Tn.magFilter],ea.min=En[Tn.minFilter],ea.wrapS=Yn[Tn.wrapS],ea.wrapT=Yn[Tn.wrapT],en=0;6>en;++en)kr(Xn[en]);return ea}var Rn=new nr(34067);Va[Rn.id]=Rn,rt.cubeCount++;var Xn=Array(6);return ea(Tr,pn,fn,An,Zn,ua),ea.subimage=function(Ua,li,Ht,hr,rn){Ht|=0,hr|=0,rn|=0;var vn=it();return lt(vn,Rn),vn.width=0,vn.height=0,Se(vn,li),vn.width=vn.width||(Rn.width>>rn)-Ht,vn.height=vn.height||(Rn.height>>rn)-hr,gr(Rn),nt(vn,34069+Ua,Ht,hr,rn),Rr(),ct(vn),ea},ea.resize=function(Ua){if(Ua|=0,Ua!==Rn.width){ea.width=Rn.width=Ua,ea.height=Rn.height=Ua,gr(Rn);for(var li=0;6>li;++li)for(var Ht=0;Rn.mipmask>>Ht;++Ht)at.texImage2D(34069+li,Ht,Rn.format,Ua>>Ht,Ua>>Ht,0,Rn.format,Rn.type,null);return Rr(),Je.profile&&(Rn.stats.size=I(Rn.internalformat,Rn.type,ea.width,ea.height,!1,!0)),ea}},ea._reglType="textureCube",ea._texture=Rn,Je.profile&&(ea.stats=Rn.stats),ea.destroy=function(){Rn.decRef()},ea},clear:function(){for(var Tr=0;Tr<ja;++Tr)at.activeTexture(33984+Tr),at.bindTexture(3553,null),Wa[Tr]=null;Pe(Va).forEach(Br),rt.cubeCount=0,rt.textureCount=0},getTexture:function(Tr){return null},restore:function(){for(var Tr=0;Tr<ja;++Tr){var pn=Wa[Tr];pn&&(pn.bindCount=0,pn.unit=-1,Wa[Tr]=null)}Pe(Va).forEach(function(fn){fn.texture=at.createTexture(),at.bindTexture(fn.target,fn.texture);for(var An=0;32>An;++An)if(fn.mipmask&1<<An)if(fn.target===3553)at.texImage2D(3553,An,fn.internalformat,fn.width>>An,fn.height>>An,0,fn.internalformat,fn.type,null);else for(var Zn=0;6>Zn;++Zn)at.texImage2D(34069+Zn,An,fn.internalformat,fn.width>>An,fn.height>>An,0,fn.internalformat,fn.type,null);Yr(fn.texInfo,fn.target)})},refresh:function(){for(var Tr=0;Tr<ja;++Tr){var pn=Wa[Tr];pn&&(pn.bindCount=0,pn.unit=-1,Wa[Tr]=null),at.activeTexture(33984+Tr),at.bindTexture(3553,null),at.bindTexture(34067,null)}}}}function R(at,$t,Jt,Gt,_r,rt){function Je(nr,gr,Rr){this.target=nr,this.texture=gr,this.renderbuffer=Rr;var Br=nr=0;gr?(nr=gr.width,Br=gr.height):Rr&&(nr=Rr.width,Br=Rr.height),this.width=nr,this.height=Br}function st(nr){nr&&(nr.texture&&nr.texture._texture.decRef(),nr.renderbuffer&&nr.renderbuffer._renderbuffer.decRef())}function lt(nr,gr,Rr){nr&&(nr.texture?nr.texture._texture.refCount+=1:nr.renderbuffer._renderbuffer.refCount+=1)}function Tt(nr,gr){gr&&(gr.texture?at.framebufferTexture2D(36160,nr,gr.target,gr.texture._texture.texture,0):at.framebufferRenderbuffer(36160,nr,36161,gr.renderbuffer._renderbuffer.renderbuffer))}function zt(nr){var gr=3553,Rr=null,Br=null,Sr=nr;return typeof nr=="object"&&(Sr=nr.data,"target"in nr&&(gr=nr.target|0)),nr=Sr._reglType,nr==="texture2d"||nr==="textureCube"?Rr=Sr:nr==="renderbuffer"&&(Br=Sr,gr=36161),new Je(gr,Rr,Br)}function Ce(nr,gr,Rr,Br,Sr){return Rr?(nr=Gt.create2D({width:nr,height:gr,format:Br,type:Sr}),nr._texture.refCount=0,new Je(3553,nr,null)):(nr=_r.create({width:nr,height:gr,format:Br}),nr._renderbuffer.refCount=0,new Je(36161,null,nr))}function Se(nr){return nr&&(nr.texture||nr.renderbuffer)}function nt(nr,gr,Rr){nr&&(nr.texture?nr.texture.resize(gr,Rr):nr.renderbuffer&&nr.renderbuffer.resize(gr,Rr),nr.width=gr,nr.height=Rr)}function it(){this.id=Mr++,Yr[this.id]=this,this.framebuffer=at.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function ct(nr){nr.colorAttachments.forEach(st),st(nr.depthAttachment),st(nr.stencilAttachment),st(nr.depthStencilAttachment)}function kt(nr){at.deleteFramebuffer(nr.framebuffer),nr.framebuffer=null,rt.framebufferCount--,delete Yr[nr.id]}function gt(nr){var gr;at.bindFramebuffer(36160,nr.framebuffer);var Rr=nr.colorAttachments;for(gr=0;gr<Rr.length;++gr)Tt(36064+gr,Rr[gr]);for(gr=Rr.length;gr<Jt.maxColorAttachments;++gr)at.framebufferTexture2D(36160,36064+gr,3553,null,0);at.framebufferTexture2D(36160,33306,3553,null,0),at.framebufferTexture2D(36160,36096,3553,null,0),at.framebufferTexture2D(36160,36128,3553,null,0),Tt(36096,nr.depthAttachment),Tt(36128,nr.stencilAttachment),Tt(33306,nr.depthStencilAttachment),at.checkFramebufferStatus(36160),at.isContextLost(),at.bindFramebuffer(36160,Yt.next?Yt.next.framebuffer:null),Yt.cur=Yt.next,at.getError()}function St(nr,gr){function Rr(Sr,et){var Lt,Zt=0,or=0,Ir=!0,Or=!0;Lt=null;var Er=!0,wr="rgba",Gr="uint8",wn=1,cn=null,Bn=null,En=null,Yn=!1;typeof Sr=="number"?(Zt=Sr|0,or=et|0||Zt):Sr?("shape"in Sr?(or=Sr.shape,Zt=or[0],or=or[1]):("radius"in Sr&&(Zt=or=Sr.radius),"width"in Sr&&(Zt=Sr.width),"height"in Sr&&(or=Sr.height)),("color"in Sr||"colors"in Sr)&&(Lt=Sr.color||Sr.colors),Lt||("colorCount"in Sr&&(wn=Sr.colorCount|0),"colorTexture"in Sr&&(Er=!!Sr.colorTexture,wr="rgba4"),"colorType"in Sr&&(Gr=Sr.colorType,!Er)&&(Gr==="half float"||Gr==="float16"?wr="rgba16f":(Gr==="float"||Gr==="float32")&&(wr="rgba32f")),"colorFormat"in Sr&&(wr=Sr.colorFormat,0<=ar.indexOf(wr)?Er=!0:0<=kr.indexOf(wr)&&(Er=!1))),("depthTexture"in Sr||"depthStencilTexture"in Sr)&&(Yn=!(!Sr.depthTexture&&!Sr.depthStencilTexture)),"depth"in Sr&&(typeof Sr.depth=="boolean"?Ir=Sr.depth:(cn=Sr.depth,Or=!1)),"stencil"in Sr&&(typeof Sr.stencil=="boolean"?Or=Sr.stencil:(Bn=Sr.stencil,Ir=!1)),"depthStencil"in Sr&&(typeof Sr.depthStencil=="boolean"?Ir=Or=Sr.depthStencil:(En=Sr.depthStencil,Or=Ir=!1))):Zt=or=1;var Vn=null,pa=null,Ma=null,ci=null;if(Array.isArray(Lt))Vn=Lt.map(zt);else if(Lt)Vn=[zt(Lt)];else for(Vn=Array(wn),Lt=0;Lt<wn;++Lt)Vn[Lt]=Ce(Zt,or,Er,wr,Gr);for(Zt=Zt||Vn[0].width,or=or||Vn[0].height,cn?pa=zt(cn):Ir&&!Or&&(pa=Ce(Zt,or,Yn,"depth","uint32")),Bn?Ma=zt(Bn):Or&&!Ir&&(Ma=Ce(Zt,or,!1,"stencil","uint8")),En?ci=zt(En):!cn&&!Bn&&Or&&Ir&&(ci=Ce(Zt,or,Yn,"depth stencil","depth stencil")),Ir=null,Lt=0;Lt<Vn.length;++Lt)lt(Vn[Lt]),Vn[Lt]&&Vn[Lt].texture&&(Or=dt[Vn[Lt].texture._texture.format]*wt[Vn[Lt].texture._texture.type],Ir===null&&(Ir=Or));return lt(pa),lt(Ma),lt(ci),ct(Br),Br.width=Zt,Br.height=or,Br.colorAttachments=Vn,Br.depthAttachment=pa,Br.stencilAttachment=Ma,Br.depthStencilAttachment=ci,Rr.color=Vn.map(Se),Rr.depth=Se(pa),Rr.stencil=Se(Ma),Rr.depthStencil=Se(ci),Rr.width=Br.width,Rr.height=Br.height,gt(Br),Rr}var Br=new it;return rt.framebufferCount++,Rr(nr,gr),oe(Rr,{resize:function(Sr,et){var Lt=Math.max(Sr|0,1),Zt=Math.max(et|0||Lt,1);if(Lt===Br.width&&Zt===Br.height)return Rr;for(var or=Br.colorAttachments,Ir=0;Ir<or.length;++Ir)nt(or[Ir],Lt,Zt);return nt(Br.depthAttachment,Lt,Zt),nt(Br.stencilAttachment,Lt,Zt),nt(Br.depthStencilAttachment,Lt,Zt),Br.width=Rr.width=Lt,Br.height=Rr.height=Zt,gt(Br),Rr},_reglType:"framebuffer",_framebuffer:Br,destroy:function(){kt(Br),ct(Br)},use:function(Sr){Yt.setFBO({framebuffer:Rr},Sr)}})}var Yt={cur:null,next:null,dirty:!1,setFBO:null},ar=["rgba"],kr=["rgba4","rgb565","rgb5 a1"];$t.ext_srgb&&kr.push("srgba"),$t.ext_color_buffer_half_float&&kr.push("rgba16f","rgb16f"),$t.webgl_color_buffer_float&&kr.push("rgba32f");var br=["uint8"];$t.oes_texture_half_float&&br.push("half float","float16"),$t.oes_texture_float&&br.push("float","float32");var Mr=0,Yr={};return oe(Yt,{getFramebuffer:function(nr){return typeof nr=="function"&&nr._reglType==="framebuffer"&&(nr=nr._framebuffer,nr instanceof it)?nr:null},create:St,createCube:function(nr){function gr(Br){var Sr,et={color:null},Lt=0,Zt=null;Sr="rgba";var or="uint8",Ir=1;if(typeof Br=="number"?Lt=Br|0:Br?("shape"in Br?Lt=Br.shape[0]:("radius"in Br&&(Lt=Br.radius|0),"width"in Br?Lt=Br.width|0:"height"in Br&&(Lt=Br.height|0)),("color"in Br||"colors"in Br)&&(Zt=Br.color||Br.colors),Zt||("colorCount"in Br&&(Ir=Br.colorCount|0),"colorType"in Br&&(or=Br.colorType),"colorFormat"in Br&&(Sr=Br.colorFormat)),"depth"in Br&&(et.depth=Br.depth),"stencil"in Br&&(et.stencil=Br.stencil),"depthStencil"in Br&&(et.depthStencil=Br.depthStencil)):Lt=1,Zt)if(Array.isArray(Zt))for(Br=[],Sr=0;Sr<Zt.length;++Sr)Br[Sr]=Zt[Sr];else Br=[Zt];else for(Br=Array(Ir),Zt={radius:Lt,format:Sr,type:or},Sr=0;Sr<Ir;++Sr)Br[Sr]=Gt.createCube(Zt);for(et.color=Array(Br.length),Sr=0;Sr<Br.length;++Sr)Ir=Br[Sr],Lt=Lt||Ir.width,et.color[Sr]={target:34069,data:Br[Sr]};for(Sr=0;6>Sr;++Sr){for(Ir=0;Ir<Br.length;++Ir)et.color[Ir].target=34069+Sr;0<Sr&&(et.depth=Rr[0].depth,et.stencil=Rr[0].stencil,et.depthStencil=Rr[0].depthStencil),Rr[Sr]?Rr[Sr](et):Rr[Sr]=St(et)}return oe(gr,{width:Lt,height:Lt,color:Br})}var Rr=Array(6);return gr(nr),oe(gr,{faces:Rr,resize:function(Br){var Sr=Br|0;if(Sr===gr.width)return gr;var et=gr.color;for(Br=0;Br<et.length;++Br)et[Br].resize(Sr);for(Br=0;6>Br;++Br)Rr[Br].resize(Sr);return gr.width=gr.height=Sr,gr},_reglType:"framebufferCube",destroy:function(){Rr.forEach(function(Br){Br.destroy()})}})},clear:function(){Pe(Yr).forEach(kt)},restore:function(){Yt.cur=null,Yt.next=null,Yt.dirty=!0,Pe(Yr).forEach(function(nr){nr.framebuffer=at.createFramebuffer(),gt(nr)})}})}function O(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function F(at,$t,Jt,Gt,_r,rt,Je){function st(gt){if(gt!==kt.currentVAO){var St=$t.oes_vertex_array_object;gt?St.bindVertexArrayOES(gt.vao):St.bindVertexArrayOES(null),kt.currentVAO=gt}}function lt(gt){if(gt!==kt.currentVAO){if(gt)gt.bindAttrs();else{for(var St=$t.angle_instanced_arrays,Yt=0;Yt<nt.length;++Yt){var ar=nt[Yt];ar.buffer?(at.enableVertexAttribArray(Yt),ar.buffer.bind(),at.vertexAttribPointer(Yt,ar.size,ar.type,ar.normalized,ar.stride,ar.offfset),St&&ar.divisor&&St.vertexAttribDivisorANGLE(Yt,ar.divisor)):(at.disableVertexAttribArray(Yt),at.vertexAttrib4f(Yt,ar.x,ar.y,ar.z,ar.w))}Je.elements?at.bindBuffer(34963,Je.elements.buffer.buffer):at.bindBuffer(34963,null)}kt.currentVAO=gt}}function Tt(){Pe(ct).forEach(function(gt){gt.destroy()})}function zt(){this.id=++it,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var gt=$t.oes_vertex_array_object;this.vao=gt?gt.createVertexArrayOES():null,ct[this.id]=this,this.buffers=[]}function Ce(){$t.oes_vertex_array_object&&Pe(ct).forEach(function(gt){gt.refresh()})}var Se=Jt.maxAttributes,nt=Array(Se);for(Jt=0;Jt<Se;++Jt)nt[Jt]=new O;var it=0,ct={},kt={Record:O,scope:{},state:nt,currentVAO:null,targetVAO:null,restore:$t.oes_vertex_array_object?Ce:function(){},createVAO:function(gt){function St(ar){var kr;Array.isArray(ar)?(kr=ar,Yt.elements&&Yt.ownsElements&&Yt.elements.destroy(),Yt.elements=null,Yt.ownsElements=!1,Yt.offset=0,Yt.count=0,Yt.instances=-1,Yt.primitive=4):(ar.elements?(kr=ar.elements,Yt.ownsElements?(typeof kr=="function"&&kr._reglType==="elements"?Yt.elements.destroy():Yt.elements(kr),Yt.ownsElements=!1):rt.getElements(ar.elements)?(Yt.elements=ar.elements,Yt.ownsElements=!1):(Yt.elements=rt.create(ar.elements),Yt.ownsElements=!0)):(Yt.elements=null,Yt.ownsElements=!1),kr=ar.attributes,Yt.offset=0,Yt.count=-1,Yt.instances=-1,Yt.primitive=4,Yt.elements&&(Yt.count=Yt.elements._elements.vertCount,Yt.primitive=Yt.elements._elements.primType),"offset"in ar&&(Yt.offset=ar.offset|0),"count"in ar&&(Yt.count=ar.count|0),"instances"in ar&&(Yt.instances=ar.instances|0),"primitive"in ar&&(Yt.primitive=Ye[ar.primitive])),ar={};var br=Yt.attributes;br.length=kr.length;for(var Mr=0;Mr<kr.length;++Mr){var Yr=kr[Mr],nr=br[Mr]=new O,gr=Yr.data||Yr;if(Array.isArray(gr)||Ee(gr)||v(gr)){var Rr;Yt.buffers[Mr]&&(Rr=Yt.buffers[Mr],Ee(gr)&&Rr._buffer.byteLength>=gr.byteLength?Rr.subdata(gr):(Rr.destroy(),Yt.buffers[Mr]=null)),Yt.buffers[Mr]||(Rr=Yt.buffers[Mr]=_r.create(Yr,34962,!1,!0)),nr.buffer=_r.getBuffer(Rr),nr.size=nr.buffer.dimension|0,nr.normalized=!1,nr.type=nr.buffer.dtype,nr.offset=0,nr.stride=0,nr.divisor=0,nr.state=1,ar[Mr]=1}else _r.getBuffer(Yr)?(nr.buffer=_r.getBuffer(Yr),nr.size=nr.buffer.dimension|0,nr.normalized=!1,nr.type=nr.buffer.dtype,nr.offset=0,nr.stride=0,nr.divisor=0,nr.state=1):_r.getBuffer(Yr.buffer)?(nr.buffer=_r.getBuffer(Yr.buffer),nr.size=(+Yr.size||nr.buffer.dimension)|0,nr.normalized=!!Yr.normalized||!1,nr.type="type"in Yr?ke[Yr.type]:nr.buffer.dtype,nr.offset=(Yr.offset||0)|0,nr.stride=(Yr.stride||0)|0,nr.divisor=(Yr.divisor||0)|0,nr.state=1):"x"in Yr&&(nr.x=+Yr.x||0,nr.y=+Yr.y||0,nr.z=+Yr.z||0,nr.w=+Yr.w||0,nr.state=2)}for(Rr=0;Rr<Yt.buffers.length;++Rr)!ar[Rr]&&Yt.buffers[Rr]&&(Yt.buffers[Rr].destroy(),Yt.buffers[Rr]=null);return Yt.refresh(),St}var Yt=new zt;return Gt.vaoCount+=1,St.destroy=function(){for(var ar=0;ar<Yt.buffers.length;++ar)Yt.buffers[ar]&&Yt.buffers[ar].destroy();Yt.buffers.length=0,Yt.ownsElements&&(Yt.elements.destroy(),Yt.elements=null,Yt.ownsElements=!1),Yt.destroy()},St._vao=Yt,St._reglType="vao",St(gt)},getVAO:function(gt){return typeof gt=="function"&&gt._vao?gt._vao:null},destroyBuffer:function(gt){for(var St=0;St<nt.length;++St){var Yt=nt[St];Yt.buffer===gt&&(at.disableVertexAttribArray(St),Yt.buffer=null)}},setVAO:$t.oes_vertex_array_object?st:lt,clear:$t.oes_vertex_array_object?Tt:function(){}};return zt.prototype.bindAttrs=function(){for(var gt=$t.angle_instanced_arrays,St=this.attributes,Yt=0;Yt<St.length;++Yt){var ar=St[Yt];ar.buffer?(at.enableVertexAttribArray(Yt),at.bindBuffer(34962,ar.buffer.buffer),at.vertexAttribPointer(Yt,ar.size,ar.type,ar.normalized,ar.stride,ar.offset),gt&&ar.divisor&&gt.vertexAttribDivisorANGLE(Yt,ar.divisor)):(at.disableVertexAttribArray(Yt),at.vertexAttrib4f(Yt,ar.x,ar.y,ar.z,ar.w))}for(gt=St.length;gt<Se;++gt)at.disableVertexAttribArray(gt);(gt=rt.getElements(this.elements))?at.bindBuffer(34963,gt.buffer.buffer):at.bindBuffer(34963,null)},zt.prototype.refresh=function(){var gt=$t.oes_vertex_array_object;gt&&(gt.bindVertexArrayOES(this.vao),this.bindAttrs(),kt.currentVAO=null,gt.bindVertexArrayOES(null))},zt.prototype.destroy=function(){if(this.vao){var gt=$t.oes_vertex_array_object;this===kt.currentVAO&&(kt.currentVAO=null,gt.bindVertexArrayOES(null)),gt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ct[this.id]&&(delete ct[this.id],--Gt.vaoCount)},kt}function N(at,$t,Jt,Gt){function _r(it,ct,kt,gt){this.name=it,this.id=ct,this.location=kt,this.info=gt}function rt(it,ct){for(var kt=0;kt<it.length;++kt)if(it[kt].id===ct.id){it[kt].location=ct.location;return}it.push(ct)}function Je(it,ct,kt){kt=it===35632?Tt:zt;var gt=kt[ct];if(!gt){var St=$t.str(ct),gt=at.createShader(it);at.shaderSource(gt,St),at.compileShader(gt),kt[ct]=gt}return gt}function st(it,ct){this.id=nt++,this.fragId=it,this.vertId=ct,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Gt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function lt(it,ct,kt){var gt;gt=Je(35632,it.fragId);var St=Je(35633,it.vertId);if(ct=it.program=at.createProgram(),at.attachShader(ct,gt),at.attachShader(ct,St),kt)for(gt=0;gt<kt.length;++gt)St=kt[gt],at.bindAttribLocation(ct,St[0],St[1]);at.linkProgram(ct),St=at.getProgramParameter(ct,35718),Gt.profile&&(it.stats.uniformsCount=St);var Yt=it.uniforms;for(gt=0;gt<St;++gt)if(kt=at.getActiveUniform(ct,gt))if(1<kt.size)for(var ar=0;ar<kt.size;++ar){var kr=kt.name.replace("[0]","["+ar+"]");rt(Yt,new _r(kr,$t.id(kr),at.getUniformLocation(ct,kr),kt))}else rt(Yt,new _r(kt.name,$t.id(kt.name),at.getUniformLocation(ct,kt.name),kt));for(St=at.getProgramParameter(ct,35721),Gt.profile&&(it.stats.attributesCount=St),it=it.attributes,gt=0;gt<St;++gt)(kt=at.getActiveAttrib(ct,gt))&&rt(it,new _r(kt.name,$t.id(kt.name),at.getAttribLocation(ct,kt.name),kt))}var Tt={},zt={},Ce={},Se=[],nt=0;return Gt.profile&&(Jt.getMaxUniformsCount=function(){var it=0;return Se.forEach(function(ct){ct.stats.uniformsCount>it&&(it=ct.stats.uniformsCount)}),it},Jt.getMaxAttributesCount=function(){var it=0;return Se.forEach(function(ct){ct.stats.attributesCount>it&&(it=ct.stats.attributesCount)}),it}),{clear:function(){var it=at.deleteShader.bind(at);Pe(Tt).forEach(it),Tt={},Pe(zt).forEach(it),zt={},Se.forEach(function(ct){at.deleteProgram(ct.program)}),Se.length=0,Ce={},Jt.shaderCount=0},program:function(it,ct,kt,gt){var St=Ce[ct];St||(St=Ce[ct]={});var Yt=St[it];if(Yt&&(Yt.refCount++,!gt))return Yt;var ar=new st(ct,it);return Jt.shaderCount++,lt(ar,kt,gt),Yt||(St[it]=ar),Se.push(ar),oe(ar,{destroy:function(){if(ar.refCount--,0>=ar.refCount){at.deleteProgram(ar.program);var kr=Se.indexOf(ar);Se.splice(kr,1),Jt.shaderCount--}0>=St[ar.vertId].refCount&&(at.deleteShader(zt[ar.vertId]),delete zt[ar.vertId],delete Ce[ar.fragId][ar.vertId]),Object.keys(Ce[ar.fragId]).length||(at.deleteShader(Tt[ar.fragId]),delete Tt[ar.fragId],delete Ce[ar.fragId])}})},restore:function(){Tt={},zt={};for(var it=0;it<Se.length;++it)lt(Se[it],null,Se[it].attributes.map(function(ct){return[ct.location,ct.name]}))},shader:Je,frag:-1,vert:-1}}function G(at,$t,Jt,Gt,_r,rt,Je){function st(Tt){var zt;zt=$t.next===null?5121:$t.next.colorAttachments[0].texture._texture.type;var Ce=0,Se=0,nt=Gt.framebufferWidth,it=Gt.framebufferHeight,ct=null;return Ee(Tt)?ct=Tt:Tt&&(Ce=Tt.x|0,Se=Tt.y|0,nt=(Tt.width||Gt.framebufferWidth-Ce)|0,it=(Tt.height||Gt.framebufferHeight-Se)|0,ct=Tt.data||null),Jt(),Tt=nt*it*4,ct||(zt===5121?ct=new Uint8Array(Tt):zt===5126&&(ct=ct||new Float32Array(Tt))),at.pixelStorei(3333,4),at.readPixels(Ce,Se,nt,it,6408,zt,ct),ct}function lt(Tt){var zt;return $t.setFBO({framebuffer:Tt.framebuffer},function(){zt=st(Tt)}),zt}return function(Tt){return Tt&&"framebuffer"in Tt?lt(Tt):st(Tt)}}function K(at){for(var $t=Array(at.length>>2),Gt=0;Gt<$t.length;Gt++)$t[Gt]=0;for(Gt=0;Gt<8*at.length;Gt+=8)$t[Gt>>5]|=(at.charCodeAt(Gt/8)&255)<<24-Gt%32;var Jt=8*at.length;at=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225];var Gt=Array(64),_r,rt,Je,st,lt,Tt,zt,Ce,Se,nt,it;for($t[Jt>>5]|=128<<24-Jt%32,$t[(Jt+64>>9<<4)+15]=Jt,Ce=0;Ce<$t.length;Ce+=16){for(Jt=at[0],_r=at[1],rt=at[2],Je=at[3],st=at[4],lt=at[5],Tt=at[6],zt=at[7],Se=0;64>Se;Se++){if(16>Se)Gt[Se]=$t[Se+Ce];else{nt=Se,it=Gt[Se-2],it=re(it,17)^re(it,19)^it>>>10,it=ue(it,Gt[Se-7]);var ct;ct=Gt[Se-15],ct=re(ct,7)^re(ct,18)^ct>>>3,Gt[nt]=ue(ue(it,ct),Gt[Se-16])}nt=st,nt=re(nt,6)^re(nt,11)^re(nt,25),nt=ue(ue(ue(ue(zt,nt),st&lt^~st&Tt),Ut[Se]),Gt[Se]),zt=Jt,zt=re(zt,2)^re(zt,13)^re(zt,22),it=ue(zt,Jt&_r^Jt&rt^_r&rt),zt=Tt,Tt=lt,lt=st,st=ue(Je,nt),Je=rt,rt=_r,_r=Jt,Jt=ue(nt,it)}at[0]=ue(Jt,at[0]),at[1]=ue(_r,at[1]),at[2]=ue(rt,at[2]),at[3]=ue(Je,at[3]),at[4]=ue(st,at[4]),at[5]=ue(lt,at[5]),at[6]=ue(Tt,at[6]),at[7]=ue(zt,at[7])}for($t="",Gt=0;Gt<32*at.length;Gt+=8)$t+=String.fromCharCode(at[Gt>>5]>>>24-Gt%32&255);return $t}function W(at){for(var $t="",Jt,Gt=0;Gt<at.length;Gt++)Jt=at.charCodeAt(Gt),$t+="0123456789abcdef".charAt(Jt>>>4&15)+"0123456789abcdef".charAt(Jt&15);return $t}function Y(at){for(var $t="",Jt=-1,Gt,_r;++Jt<at.length;)Gt=at.charCodeAt(Jt),_r=Jt+1<at.length?at.charCodeAt(Jt+1):0,55296<=Gt&&56319>=Gt&&56320<=_r&&57343>=_r&&(Gt=65536+((Gt&1023)<<10)+(_r&1023),Jt++),127>=Gt?$t+=String.fromCharCode(Gt):2047>=Gt?$t+=String.fromCharCode(192|Gt>>>6&31,128|Gt&63):65535>=Gt?$t+=String.fromCharCode(224|Gt>>>12&15,128|Gt>>>6&63,128|Gt&63):2097151>=Gt&&($t+=String.fromCharCode(240|Gt>>>18&7,128|Gt>>>12&63,128|Gt>>>6&63,128|Gt&63));return $t}function re(at,$t){return at>>>$t|at<<32-$t}function ue(at,$t){var Jt=(at&65535)+($t&65535);return(at>>16)+($t>>16)+(Jt>>16)<<16|Jt&65535}function j(at){return Array.prototype.slice.call(at)}function q(at){return j(at).join("")}function H(at){function $t(){var zt=[],Ce=[];return oe(function(){zt.push.apply(zt,j(arguments))},{def:function(){var Se="v"+_r++;return Ce.push(Se),0<arguments.length&&(zt.push(Se,"="),zt.push.apply(zt,j(arguments)),zt.push(";")),Se},toString:function(){return q([0<Ce.length?"var "+Ce.join(",")+";":"",q(zt)])}})}function Jt(){function zt(ct,kt){Se(ct,kt,"=",Ce.def(ct,kt),";")}var Ce=$t(),Se=$t(),nt=Ce.toString,it=Se.toString;return oe(function(){Ce.apply(Ce,j(arguments))},{def:Ce.def,entry:Ce,exit:Se,save:zt,set:function(ct,kt,gt){zt(ct,kt),Ce(ct,kt,"=",gt,";")},toString:function(){return nt()+it()}})}var Gt=at&&at.cache,_r=0,rt=[],Je=[],st=[],lt=$t(),Tt={};return{global:lt,link:function(zt,Ce){var Se=Ce&&Ce.stable;if(!Se){for(var nt=0;nt<Je.length;++nt)if(Je[nt]===zt&&!st[nt])return rt[nt]}return nt="g"+_r++,rt.push(nt),Je.push(zt),st.push(Se),nt},block:$t,proc:function(zt,Ce){function Se(){var kt="a"+nt.length;return nt.push(kt),kt}var nt=[];Ce=Ce||0;for(var it=0;it<Ce;++it)Se();var it=Jt(),ct=it.toString;return Tt[zt]=oe(it,{arg:Se,toString:function(){return q(["function(",nt.join(),"){",ct(),"}"])}})},scope:Jt,cond:function(){var zt=q(arguments),Ce=Jt(),Se=Jt(),nt=Ce.toString,it=Se.toString;return oe(Ce,{then:function(){return Ce.apply(Ce,j(arguments)),this},else:function(){return Se.apply(Se,j(arguments)),this},toString:function(){var ct=it();return ct&&(ct="else{"+ct+"}"),q(["if(",zt,"){",nt(),"}",ct])}})},compile:function(){var zt=['"use strict";',lt,"return {"];Object.keys(Tt).forEach(function(nt){zt.push('"',nt,'":',Tt[nt].toString(),",")}),zt.push("}");var Ce=q(zt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Se;return Gt&&(Se=W(K(Y(Ce))),Gt[Se])?Gt[Se].apply(null,Je):(Ce=Function.apply(null,rt.concat(Ce)),Gt&&(Gt[Se]=Ce),Ce.apply(null,Je))}}}function U(at){return Array.isArray(at)||Ee(at)||v(at)}function $(at){return at.sort(function($t,Jt){return $t==="viewport"?-1:Jt==="viewport"?1:$t<Jt?-1:1})}function ne(at,$t,Jt,Gt){this.thisDep=at,this.contextDep=$t,this.propDep=Jt,this.append=Gt}function X(at){return at&&!(at.thisDep||at.contextDep||at.propDep)}function Q(at){return new ne(!1,!1,!1,at)}function ie(at,$t){var Jt=at.type;if(Jt===0)return Jt=at.data.length,new ne(!0,1<=Jt,2<=Jt,$t);if(Jt===4)return Jt=at.data,new ne(Jt.thisDep,Jt.contextDep,Jt.propDep,$t);if(Jt===5)return new ne(!1,!1,!1,$t);if(Jt===6){for(var Gt=Jt=!1,_r=!1,rt=0;rt<at.data.length;++rt){var Je=at.data[rt];Je.type===1?_r=!0:Je.type===2?Gt=!0:Je.type===3?Jt=!0:Je.type===0?(Jt=!0,Je=Je.data,1<=Je&&(Gt=!0),2<=Je&&(_r=!0)):Je.type===4&&(Jt=Jt||Je.data.thisDep,Gt=Gt||Je.data.contextDep,_r=_r||Je.data.propDep)}return new ne(Jt,Gt,_r,$t)}return new ne(Jt===3,Jt===2,Jt===1,$t)}function se(at,$t,Jt,Gt,_r,rt,Je,st,lt,Tt,zt,Ce,Se,nt,it,ct){function kt(Ht){return Ht.replace(".","_")}function gt(Ht,hr,rn){var vn=kt(Ht);ua.push(Ht),Zn[vn]=An[vn]=!!rn,ea[vn]=hr}function St(Ht,hr,rn){var vn=kt(Ht);ua.push(Ht),Array.isArray(rn)?(An[vn]=rn.slice(),Zn[vn]=rn.slice()):An[vn]=Zn[vn]=rn,Rn[vn]=hr}function Yt(){var Ht=H({cache:it}),hr=Ht.link,rn=Ht.global;Ht.id=li++,Ht.batchId="0";var vn=hr(Xn),en=Ht.shared={props:"a0"};Object.keys(Xn).forEach(function(mr){en[mr]=rn.def(vn,".",mr)});var Tn=Ht.next={},xn=Ht.current={};Object.keys(Rn).forEach(function(mr){Array.isArray(An[mr])&&(Tn[mr]=rn.def(en.next,".",mr),xn[mr]=rn.def(en.current,".",mr))});var un=Ht.constants={};Object.keys(Ua).forEach(function(mr){un[mr]=rn.def(JSON.stringify(Ua[mr]))}),Ht.invoke=function(mr,zr){switch(zr.type){case 0:var gn=["this",en.context,en.props,Ht.batchId];return mr.def(hr(zr.data),".call(",gn.slice(0,Math.max(zr.data.length+1,4)),")");case 1:return mr.def(en.props,zr.data);case 2:return mr.def(en.context,zr.data);case 3:return mr.def("this",zr.data);case 4:return zr.data.append(Ht,mr),zr.data.ref;case 5:return zr.data.toString();case 6:return zr.data.map(function(On){return Ht.invoke(mr,On)})}},Ht.attribCache={};var yr={};return Ht.scopeAttrib=function(mr){if(mr=$t.id(mr),mr in yr)return yr[mr];var zr=Tt.scope[mr];return zr||(zr=Tt.scope[mr]=new ja),yr[mr]=hr(zr)},Ht}function ar(Ht){var hr=Ht.static;Ht=Ht.dynamic;var rn;if("profile"in hr){var vn=!!hr.profile;rn=Q(function(Tn,xn){return vn}),rn.enable=vn}else if("profile"in Ht){var en=Ht.profile;rn=ie(en,function(Tn,xn){return Tn.invoke(xn,en)})}return rn}function kr(Ht,hr){var rn=Ht.static,vn=Ht.dynamic;if("framebuffer"in rn){var en=rn.framebuffer;return en?(en=st.getFramebuffer(en),Q(function(xn,un){var yr=xn.link(en),mr=xn.shared;return un.set(mr.framebuffer,".next",yr),mr=mr.context,un.set(mr,".framebufferWidth",yr+".width"),un.set(mr,".framebufferHeight",yr+".height"),yr})):Q(function(xn,un){var yr=xn.shared;return un.set(yr.framebuffer,".next","null"),yr=yr.context,un.set(yr,".framebufferWidth",yr+".drawingBufferWidth"),un.set(yr,".framebufferHeight",yr+".drawingBufferHeight"),"null"})}if("framebuffer"in vn){var Tn=vn.framebuffer;return ie(Tn,function(xn,un){var zr=xn.invoke(un,Tn),yr=xn.shared,mr=yr.framebuffer,zr=un.def(mr,".getFramebuffer(",zr,")");return un.set(mr,".next",zr),yr=yr.context,un.set(yr,".framebufferWidth",zr+"?"+zr+".width:"+yr+".drawingBufferWidth"),un.set(yr,".framebufferHeight",zr+"?"+zr+".height:"+yr+".drawingBufferHeight"),zr})}return null}function br(Ht,hr,rn){function vn(un){if(un in en){var yr=en[un];un=!0;var mr=yr.x|0,zr=yr.y|0,gn,On;return"width"in yr?gn=yr.width|0:un=!1,"height"in yr?On=yr.height|0:un=!1,new ne(!un&&hr&&hr.thisDep,!un&&hr&&hr.contextDep,!un&&hr&&hr.propDep,function(_n,jn){var aa=_n.shared.context,da=gn;"width"in yr||(da=jn.def(aa,".","framebufferWidth","-",mr));var ma=On;return"height"in yr||(ma=jn.def(aa,".","framebufferHeight","-",zr)),[mr,zr,da,ma]})}if(un in Tn){var ta=Tn[un];return un=ie(ta,function(_n,jn){var Aa=_n.invoke(jn,ta),aa=_n.shared.context,da=jn.def(Aa,".x|0"),ma=jn.def(Aa,".y|0"),sa=jn.def('"width" in ',Aa,"?",Aa,".width|0:","(",aa,".","framebufferWidth","-",da,")"),Aa=jn.def('"height" in ',Aa,"?",Aa,".height|0:","(",aa,".","framebufferHeight","-",ma,")");return[da,ma,sa,Aa]}),hr&&(un.thisDep=un.thisDep||hr.thisDep,un.contextDep=un.contextDep||hr.contextDep,un.propDep=un.propDep||hr.propDep),un}return hr?new ne(hr.thisDep,hr.contextDep,hr.propDep,function(_n,jn){var aa=_n.shared.context;return[0,0,jn.def(aa,".","framebufferWidth"),jn.def(aa,".","framebufferHeight")]}):null}var en=Ht.static,Tn=Ht.dynamic;if(Ht=vn("viewport")){var xn=Ht;Ht=new ne(Ht.thisDep,Ht.contextDep,Ht.propDep,function(un,yr){var mr=xn.append(un,yr),zr=un.shared.context;return yr.set(zr,".viewportWidth",mr[2]),yr.set(zr,".viewportHeight",mr[3]),mr})}return{viewport:Ht,scissor_box:vn("scissor.box")}}function Mr(Ht,hr){var rn=Ht.static;if(typeof rn.frag=="string"&&typeof rn.vert=="string"){if(0<Object.keys(hr.dynamic).length)return null;var rn=hr.static,vn=Object.keys(rn);if(0<vn.length&&typeof rn[vn[0]]=="number"){for(var en=[],Tn=0;Tn<vn.length;++Tn)en.push([rn[vn[Tn]]|0,vn[Tn]]);return en}}return null}function Yr(Ht,hr,rn){function vn(mr){if(mr in en){var zr=$t.id(en[mr]);return mr=Q(function(){return zr}),mr.id=zr,mr}if(mr in Tn){var gn=Tn[mr];return ie(gn,function(On,ta){var _n=On.invoke(ta,gn);return ta.def(On.shared.strings,".id(",_n,")")})}return null}var en=Ht.static,Tn=Ht.dynamic,xn=vn("frag"),un=vn("vert"),yr=null;return X(xn)&&X(un)?(yr=zt.program(un.id,xn.id,null,rn),Ht=Q(function(mr,zr){return mr.link(yr)})):Ht=new ne(xn&&xn.thisDep||un&&un.thisDep,xn&&xn.contextDep||un&&un.contextDep,xn&&xn.propDep||un&&un.propDep,function(mr,zr){var gn=mr.shared.shader,On;On=xn?xn.append(mr,zr):zr.def(gn,".","frag");var ta;return ta=un?un.append(mr,zr):zr.def(gn,".","vert"),zr.def(gn+".program("+ta+","+On+")")}),{frag:xn,vert:un,progVar:Ht,program:yr}}function nr(Ht,hr){function rn(_n,jn){if(_n in vn){var aa=vn[_n]|0;return jn?Tn.offset=aa:Tn.instances=aa,Q(function(ma,sa){return jn&&(ma.OFFSET=aa),aa})}if(_n in en){var da=en[_n];return ie(da,function(ma,sa){var Aa=ma.invoke(sa,da);return jn&&(ma.OFFSET=Aa),Aa})}if(jn){if(yr)return Q(function(ma,sa){return ma.OFFSET=0});if(xn)return new ne(un.thisDep,un.contextDep,un.propDep,function(ma,sa){return sa.def(ma.shared.vao+".currentVAO?"+ma.shared.vao+".currentVAO.offset:0")})}else if(xn)return new ne(un.thisDep,un.contextDep,un.propDep,function(ma,sa){return sa.def(ma.shared.vao+".currentVAO?"+ma.shared.vao+".currentVAO.instances:-1")});return null}var vn=Ht.static,en=Ht.dynamic,Tn={},xn=!1,un=function(){if("vao"in vn){var _n=vn.vao;return _n!==null&&Tt.getVAO(_n)===null&&(_n=Tt.createVAO(_n)),xn=!0,Tn.vao=_n,Q(function(aa){var da=Tt.getVAO(_n);return da?aa.link(da):"null"})}if("vao"in en){xn=!0;var jn=en.vao;return ie(jn,function(aa,da){var ma=aa.invoke(da,jn);return da.def(aa.shared.vao+".getVAO("+ma+")")})}return null}(),yr=!1,mr=function(){if("elements"in vn){var _n=vn.elements;if(Tn.elements=_n,U(_n)){var jn=Tn.elements=rt.create(_n,!0),_n=rt.getElements(jn);yr=!0}else _n&&(_n=rt.getElements(_n),yr=!0);return jn=Q(function(da,ma){if(_n){var sa=da.link(_n);return da.ELEMENTS=sa}return da.ELEMENTS=null}),jn.value=_n,jn}if("elements"in en){yr=!0;var aa=en.elements;return ie(aa,function(da,ma){var sa=da.shared,vo=sa.isBufferArgs,sa=sa.elements,Io=da.invoke(ma,aa),Aa=ma.def("null"),vo=ma.def(vo,"(",Io,")"),Io=da.cond(vo).then(Aa,"=",sa,".createStream(",Io,");").else(Aa,"=",sa,".getElements(",Io,");");return ma.entry(Io),ma.exit(da.cond(vo).then(sa,".destroyStream(",Aa,");")),da.ELEMENTS=Aa})}return xn?new ne(un.thisDep,un.contextDep,un.propDep,function(da,ma){return ma.def(da.shared.vao+".currentVAO?"+da.shared.elements+".getElements("+da.shared.vao+".currentVAO.elements):null")}):null}(),zr=rn("offset",!0),gn=function(){if("primitive"in vn){var _n=vn.primitive;return Tn.primitive=_n,Q(function(aa,da){return Ye[_n]})}if("primitive"in en){var jn=en.primitive;return ie(jn,function(aa,da){var ma=aa.constants.primTypes,sa=aa.invoke(da,jn);return da.def(ma,"[",sa,"]")})}return yr?X(mr)?mr.value?Q(function(aa,da){return da.def(aa.ELEMENTS,".primType")}):Q(function(){return 4}):new ne(mr.thisDep,mr.contextDep,mr.propDep,function(aa,da){var ma=aa.ELEMENTS;return da.def(ma,"?",ma,".primType:",4)}):xn?new ne(un.thisDep,un.contextDep,un.propDep,function(aa,da){return da.def(aa.shared.vao+".currentVAO?"+aa.shared.vao+".currentVAO.primitive:4")}):null}(),On=function(){if("count"in vn){var _n=vn.count|0;return Tn.count=_n,Q(function(){return _n})}if("count"in en){var jn=en.count;return ie(jn,function(aa,da){return aa.invoke(da,jn)})}return yr?X(mr)?mr?zr?new ne(zr.thisDep,zr.contextDep,zr.propDep,function(aa,da){return da.def(aa.ELEMENTS,".vertCount-",aa.OFFSET)}):Q(function(aa,da){return da.def(aa.ELEMENTS,".vertCount")}):Q(function(){return-1}):new ne(mr.thisDep||zr.thisDep,mr.contextDep||zr.contextDep,mr.propDep||zr.propDep,function(aa,da){var ma=aa.ELEMENTS;return aa.OFFSET?da.def(ma,"?",ma,".vertCount-",aa.OFFSET,":-1"):da.def(ma,"?",ma,".vertCount:-1")}):xn?new ne(un.thisDep,un.contextDep,un.propDep,function(aa,da){return da.def(aa.shared.vao,".currentVAO?",aa.shared.vao,".currentVAO.count:-1")}):null}(),ta=rn("instances",!1);return{elements:mr,primitive:gn,count:On,instances:ta,offset:zr,vao:un,vaoActive:xn,elementsActive:yr,static:Tn}}function gr(Ht,hr){var rn=Ht.static,vn=Ht.dynamic,en={};return ua.forEach(function(Tn){function xn(yr,mr){if(Tn in rn){var zr=yr(rn[Tn]);en[un]=Q(function(){return zr})}else if(Tn in vn){var gn=vn[Tn];en[un]=ie(gn,function(On,ta){return mr(On,ta,On.invoke(ta,gn))})}}var un=kt(Tn);switch(Tn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return xn(function(yr){return yr},function(yr,mr,zr){return zr});case"depth.func":return xn(function(yr){return Vt[yr]},function(yr,mr,zr){return mr.def(yr.constants.compareFuncs,"[",zr,"]")});case"depth.range":return xn(function(yr){return yr},function(yr,mr,zr){return yr=mr.def("+",zr,"[0]"),mr=mr.def("+",zr,"[1]"),[yr,mr]});case"blend.func":return xn(function(yr){return[Wt["srcRGB"in yr?yr.srcRGB:yr.src],Wt["dstRGB"in yr?yr.dstRGB:yr.dst],Wt["srcAlpha"in yr?yr.srcAlpha:yr.src],Wt["dstAlpha"in yr?yr.dstAlpha:yr.dst]]},function(yr,mr,zr){function gn(jn,aa){return mr.def('"',jn,aa,'" in ',zr,"?",zr,".",jn,aa,":",zr,".",jn)}yr=yr.constants.blendFuncs;var On=gn("src","RGB"),_n=gn("dst","RGB"),On=mr.def(yr,"[",On,"]"),ta=mr.def(yr,"[",gn("src","Alpha"),"]"),_n=mr.def(yr,"[",_n,"]");return yr=mr.def(yr,"[",gn("dst","Alpha"),"]"),[On,_n,ta,yr]});case"blend.equation":return xn(function(yr){if(typeof yr=="string")return[Wa[yr],Wa[yr]];if(typeof yr=="object")return[Wa[yr.rgb],Wa[yr.alpha]]},function(yr,mr,zr){var gn=yr.constants.blendEquations,On=mr.def(),ta=mr.def();return yr=yr.cond("typeof ",zr,'==="string"'),yr.then(On,"=",ta,"=",gn,"[",zr,"];"),yr.else(On,"=",gn,"[",zr,".rgb];",ta,"=",gn,"[",zr,".alpha];"),mr(yr),[On,ta]});case"blend.color":return xn(function(yr){return i(4,function(mr){return+yr[mr]})},function(yr,mr,zr){return i(4,function(gn){return mr.def("+",zr,"[",gn,"]")})});case"stencil.mask":return xn(function(yr){return yr|0},function(yr,mr,zr){return mr.def(zr,"|0")});case"stencil.func":return xn(function(yr){return[Vt[yr.cmp||"keep"],yr.ref||0,"mask"in yr?yr.mask:-1]},function(yr,mr,zr){yr=mr.def('"cmp" in ',zr,"?",yr.constants.compareFuncs,"[",zr,".cmp]",":",7680);var gn=mr.def(zr,".ref|0");return mr=mr.def('"mask" in ',zr,"?",zr,".mask|0:-1"),[yr,gn,mr]});case"stencil.opFront":case"stencil.opBack":return xn(function(yr){return[Tn==="stencil.opBack"?1029:1028,ir[yr.fail||"keep"],ir[yr.zfail||"keep"],ir[yr.zpass||"keep"]]},function(yr,mr,zr){function gn(ta){return mr.def('"',ta,'" in ',zr,"?",On,"[",zr,".",ta,"]:",7680)}var On=yr.constants.stencilOps;return[Tn==="stencil.opBack"?1029:1028,gn("fail"),gn("zfail"),gn("zpass")]});case"polygonOffset.offset":return xn(function(yr){return[yr.factor|0,yr.units|0]},function(yr,mr,zr){return yr=mr.def(zr,".factor|0"),mr=mr.def(zr,".units|0"),[yr,mr]});case"cull.face":return xn(function(yr){var mr=0;return yr==="front"?mr=1028:yr==="back"&&(mr=1029),mr},function(yr,mr,zr){return mr.def(zr,'==="front"?',1028,":",1029)});case"lineWidth":return xn(function(yr){return yr},function(yr,mr,zr){return zr});case"frontFace":return xn(function(yr){return Hr[yr]},function(yr,mr,zr){return mr.def(zr+'==="cw"?2304:2305')});case"colorMask":return xn(function(yr){return yr.map(function(mr){return!!mr})},function(yr,mr,zr){return i(4,function(gn){return"!!"+zr+"["+gn+"]"})});case"sample.coverage":return xn(function(yr){return["value"in yr?yr.value:1,!!yr.invert]},function(yr,mr,zr){return yr=mr.def('"value" in ',zr,"?+",zr,".value:1"),mr=mr.def("!!",zr,".invert"),[yr,mr]})}}),en}function Rr(Ht,hr){var rn=Ht.static,vn=Ht.dynamic,en={};return Object.keys(rn).forEach(function(Tn){var xn=rn[Tn],un;if(typeof xn=="number"||typeof xn=="boolean")un=Q(function(){return xn});else if(typeof xn=="function"){var yr=xn._reglType;yr==="texture2d"||yr==="textureCube"?un=Q(function(mr){return mr.link(xn)}):(yr==="framebuffer"||yr==="framebufferCube")&&(un=Q(function(mr){return mr.link(xn.color[0])}))}else b(xn)&&(un=Q(function(mr){return mr.global.def("[",i(xn.length,function(zr){return xn[zr]}),"]")}));un.value=xn,en[Tn]=un}),Object.keys(vn).forEach(function(Tn){var xn=vn[Tn];en[Tn]=ie(xn,function(un,yr){return un.invoke(yr,xn)})}),en}function Br(Ht,hr){var rn=Ht.static,vn=Ht.dynamic,en={};return Object.keys(rn).forEach(function(Tn){var xn=rn[Tn],un=$t.id(Tn),yr=new ja;if(U(xn))yr.state=1,yr.buffer=_r.getBuffer(_r.create(xn,34962,!1,!0)),yr.type=0;else{var mr=_r.getBuffer(xn);if(mr)yr.state=1,yr.buffer=mr,yr.type=0;else if("constant"in xn){var zr=xn.constant;yr.buffer="null",yr.state=2,typeof zr=="number"?yr.x=zr:Rt.forEach(function(aa,da){da<zr.length&&(yr[aa]=zr[da])})}else{var mr=U(xn.buffer)?_r.getBuffer(_r.create(xn.buffer,34962,!1,!0)):_r.getBuffer(xn.buffer),gn=xn.offset|0,On=xn.stride|0,ta=xn.size|0,_n=!!xn.normalized,jn=0;"type"in xn&&(jn=ke[xn.type]),xn=xn.divisor|0,yr.buffer=mr,yr.state=1,yr.size=ta,yr.normalized=_n,yr.type=jn||mr.dtype,yr.offset=gn,yr.stride=On,yr.divisor=xn}}en[Tn]=Q(function(aa,da){var ma=aa.attribCache;if(un in ma)return ma[un];var sa={isStream:!1};return Object.keys(yr).forEach(function(Aa){sa[Aa]=yr[Aa]}),yr.buffer&&(sa.buffer=aa.link(yr.buffer),sa.type=sa.type||sa.buffer+".dtype"),ma[un]=sa})}),Object.keys(vn).forEach(function(Tn){var xn=vn[Tn];en[Tn]=ie(xn,function(un,yr){function mr(ma){yr(_n[ma],"=",zr,".",ma,"|0;")}var zr=un.invoke(yr,xn),ta=un.shared,gn=un.constants,On=ta.isBufferArgs,ta=ta.buffer,_n={isStream:yr.def(!1)},jn=new ja;jn.state=1,Object.keys(jn).forEach(function(ma){_n[ma]=yr.def(""+jn[ma])});var aa=_n.buffer,da=_n.type;return yr("if(",On,"(",zr,")){",_n.isStream,"=true;",aa,"=",ta,".createStream(",34962,",",zr,");",da,"=",aa,".dtype;","}else{",aa,"=",ta,".getBuffer(",zr,");","if(",aa,"){",da,"=",aa,".dtype;",'}else if("constant" in ',zr,"){",_n.state,"=",2,";","if(typeof "+zr+'.constant === "number"){',_n[Rt[0]],"=",zr,".constant;",Rt.slice(1).map(function(ma){return _n[ma]}).join("="),"=0;","}else{",Rt.map(function(ma,sa){return _n[ma]+"="+zr+".constant.length>"+sa+"?"+zr+".constant["+sa+"]:0;"}).join(""),"}}else{","if(",On,"(",zr,".buffer)){",aa,"=",ta,".createStream(",34962,",",zr,".buffer);","}else{",aa,"=",ta,".getBuffer(",zr,".buffer);","}",da,'="type" in ',zr,"?",gn.glTypes,"[",zr,".type]:",aa,".dtype;",_n.normalized,"=!!",zr,".normalized;"),mr("size"),mr("offset"),mr("stride"),mr("divisor"),yr("}}"),yr.exit("if(",_n.isStream,"){",ta,".destroyStream(",aa,");","}"),_n})}),en}function Sr(Ht){var hr=Ht.static,rn=Ht.dynamic,vn={};return Object.keys(hr).forEach(function(en){var Tn=hr[en];vn[en]=Q(function(xn,un){return typeof Tn=="number"||typeof Tn=="boolean"?""+Tn:xn.link(Tn)})}),Object.keys(rn).forEach(function(en){var Tn=rn[en];vn[en]=ie(Tn,function(xn,un){return xn.invoke(un,Tn)})}),vn}function et(Ht,hr,rn,vn,en){function Tn(jn){var aa=un[jn];aa&&(mr[jn]=aa)}var xn=Mr(Ht,hr),On=kr(Ht),un=br(Ht,On),yr=nr(Ht),mr=gr(Ht),zr=Yr(Ht,en,xn);Tn("viewport"),Tn(kt("scissor.box"));var gn=0<Object.keys(mr).length,On={framebuffer:On,draw:yr,shader:zr,state:mr,dirty:gn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(On.profile=ar(Ht),On.uniforms=Rr(rn),On.drawVAO=On.scopeVAO=yr.vao,!On.drawVAO&&zr.program&&!xn&&Jt.angle_instanced_arrays&&yr.static.elements){var ta=!0;if(Ht=zr.program.attributes.map(function(jn){return jn=hr.static[jn],ta=ta&&!!jn,jn}),ta&&0<Ht.length){var _n=Tt.getVAO(Tt.createVAO({attributes:Ht,elements:yr.static.elements}));On.drawVAO=new ne(null,null,null,function(jn,aa){return jn.link(_n)}),On.useVAO=!0}}return xn?On.useVAO=!0:On.attributes=Br(hr),On.context=Sr(vn),On}function Lt(Ht,hr,rn){var vn=Ht.shared.context,en=Ht.scope();Object.keys(rn).forEach(function(Tn){hr.save(vn,"."+Tn);var xn=rn[Tn].append(Ht,hr);Array.isArray(xn)?en(vn,".",Tn,"=[",xn.join(),"];"):en(vn,".",Tn,"=",xn,";")}),hr(en)}function Zt(Ht,hr,rn,vn){var un=Ht.shared,en=un.gl,Tn=un.framebuffer,xn;pn&&(xn=hr.def(un.extensions,".webgl_draw_buffers"));var yr=Ht.constants,un=yr.drawBuffer,yr=yr.backBuffer;Ht=rn?rn.append(Ht,hr):hr.def(Tn,".next"),vn||hr("if(",Ht,"!==",Tn,".cur){"),hr("if(",Ht,"){",en,".bindFramebuffer(",36160,",",Ht,".framebuffer);"),pn&&hr(xn,".drawBuffersWEBGL(",un,"[",Ht,".colorAttachments.length]);"),hr("}else{",en,".bindFramebuffer(",36160,",null);"),pn&&hr(xn,".drawBuffersWEBGL(",yr,");"),hr("}",Tn,".cur=",Ht,";"),vn||hr("}")}function or(Ht,hr,rn){var vn=Ht.shared,en=vn.gl,Tn=Ht.current,xn=Ht.next,un=vn.current,yr=vn.next,mr=Ht.cond(un,".dirty");ua.forEach(function(zr){if(zr=kt(zr),!(zr in rn.state)){var gn,On;if(zr in xn){gn=xn[zr],On=Tn[zr];var ta=i(An[zr].length,function(_n){return mr.def(gn,"[",_n,"]")});mr(Ht.cond(ta.map(function(_n,jn){return _n+"!=="+On+"["+jn+"]"}).join("||")).then(en,".",Rn[zr],"(",ta,");",ta.map(function(_n,jn){return On+"["+jn+"]="+_n}).join(";"),";"))}else gn=mr.def(yr,".",zr),ta=Ht.cond(gn,"!==",un,".",zr),mr(ta),zr in ea?ta(Ht.cond(gn).then(en,".enable(",ea[zr],");").else(en,".disable(",ea[zr],");"),un,".",zr,"=",gn,";"):ta(en,".",Rn[zr],"(",gn,");",un,".",zr,"=",gn,";")}}),Object.keys(rn.state).length===0&&mr(un,".dirty=false;"),hr(mr)}function Ir(Ht,hr,rn,vn){var en=Ht.shared,Tn=Ht.current,xn=en.current,un=en.gl,yr;$(Object.keys(rn)).forEach(function(mr){var zr=rn[mr];if(!vn||vn(zr)){var gn=zr.append(Ht,hr);if(ea[mr]){var On=ea[mr];X(zr)?(yr=Ht.link(gn,{stable:!0}),hr(Ht.cond(yr).then(un,".enable(",On,");").else(un,".disable(",On,");")),hr(xn,".",mr,"=",yr,";")):(hr(Ht.cond(gn).then(un,".enable(",On,");").else(un,".disable(",On,");")),hr(xn,".",mr,"=",gn,";"))}else if(b(gn)){var ta=Tn[mr];hr(un,".",Rn[mr],"(",gn,");",gn.map(function(_n,jn){return ta+"["+jn+"]="+_n}).join(";"),";")}else X(zr)?(yr=Ht.link(gn,{stable:!0}),hr(un,".",Rn[mr],"(",yr,");",xn,".",mr,"=",yr,";")):hr(un,".",Rn[mr],"(",gn,");",xn,".",mr,"=",gn,";")}})}function Or(Ht,hr){Tr&&(Ht.instancing=hr.def(Ht.shared.extensions,".angle_instanced_arrays"))}function Er(Ht,hr,rn,vn,en){function Tn(){return typeof performance>"u"?"Date.now()":"performance.now()"}function xn(jn){ta=hr.def(),jn(ta,"=",Tn(),";"),typeof en=="string"?jn(zr,".count+=",en,";"):jn(zr,".count++;"),nt&&(vn?(_n=hr.def(),jn(_n,"=",On,".getNumPendingQueries();")):jn(On,".beginQuery(",zr,");"))}function un(jn){jn(zr,".cpuTime+=",Tn(),"-",ta,";"),nt&&(vn?jn(On,".pushScopeStats(",_n,",",On,".getNumPendingQueries(),",zr,");"):jn(On,".endQuery();"))}function yr(jn){var aa=hr.def(gn,".profile");hr(gn,".profile=",jn,";"),hr.exit(gn,".profile=",aa,";")}var mr=Ht.shared,zr=Ht.stats,gn=mr.current,On=mr.timer;rn=rn.profile;var ta,_n;if(rn){if(X(rn)){rn.enable?(xn(hr),un(hr.exit),yr("true")):yr("false");return}rn=rn.append(Ht,hr),yr(rn)}else rn=hr.def(gn,".profile");mr=Ht.block(),xn(mr),hr("if(",rn,"){",mr,"}"),Ht=Ht.block(),un(Ht),hr.exit("if(",rn,"){",Ht,"}")}function wr(Ht,hr,rn,vn,en){function Tn(yr){switch(yr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function xn(yr,mr,zr){function gn(){hr("if(!",jn,".buffer){",ta,".enableVertexAttribArray(",_n,");}");var sa=zr.type,Aa;Aa=zr.size?hr.def(zr.size,"||",mr):mr,hr("if(",jn,".type!==",sa,"||",jn,".size!==",Aa,"||",ma.map(function(vo){return jn+"."+vo+"!=="+zr[vo]}).join("||"),"){",ta,".bindBuffer(",34962,",",aa,".buffer);",ta,".vertexAttribPointer(",[_n,Aa,sa,zr.normalized,zr.stride,zr.offset],");",jn,".type=",sa,";",jn,".size=",Aa,";",ma.map(function(vo){return jn+"."+vo+"="+zr[vo]+";"}).join(""),"}"),Tr&&(sa=zr.divisor,hr("if(",jn,".divisor!==",sa,"){",Ht.instancing,".vertexAttribDivisorANGLE(",[_n,sa],");",jn,".divisor=",sa,";}"))}function On(){hr("if(",jn,".buffer){",ta,".disableVertexAttribArray(",_n,");",jn,".buffer=null;","}if(",Rt.map(function(sa,Aa){return jn+"."+sa+"!=="+da[Aa]}).join("||"),"){",ta,".vertexAttrib4f(",_n,",",da,");",Rt.map(function(sa,Aa){return jn+"."+sa+"="+da[Aa]+";"}).join(""),"}")}var ta=un.gl,_n=hr.def(yr,".location"),jn=hr.def(un.attributes,"[",_n,"]");yr=zr.state;var aa=zr.buffer,da=[zr.x,zr.y,zr.z,zr.w],ma=["buffer","normalized","offset","stride"];yr===1?gn():yr===2?On():(hr("if(",yr,"===",1,"){"),gn(),hr("}else{"),On(),hr("}"))}var un=Ht.shared;vn.forEach(function(yr){var mr=yr.name,zr=rn.attributes[mr],gn;if(zr){if(!en(zr))return;gn=zr.append(Ht,hr)}else{if(!en(sn))return;var On=Ht.scopeAttrib(mr);gn={},Object.keys(new ja).forEach(function(ta){gn[ta]=hr.def(On,".",ta)})}xn(Ht.link(yr),Tn(yr.info.type),gn)})}function Gr(Ht,hr,rn,vn,en,Tn){for(var xn=Ht.shared,un=xn.gl,yr,mr=0;mr<vn.length;++mr){var ta=vn[mr],zr=ta.name,gn=ta.info.type,On=rn.uniforms[zr],ta=Ht.link(ta)+".location",_n;if(On){if(!en(On))continue;if(X(On)){if(zr=On.value,gn===35678||gn===35680)gn=Ht.link(zr._texture||zr.color[0]._texture),hr(un,".uniform1i(",ta,",",gn+".bind());"),hr.exit(gn,".unbind();");else if(gn===35674||gn===35675||gn===35676)zr=Ht.global.def("new Float32Array(["+Array.prototype.slice.call(zr)+"])"),On=2,gn===35675?On=3:gn===35676&&(On=4),hr(un,".uniformMatrix",On,"fv(",ta,",false,",zr,");");else{switch(gn){case 5126:yr="1f";break;case 35664:yr="2f";break;case 35665:yr="3f";break;case 35666:yr="4f";break;case 35670:yr="1i";break;case 5124:yr="1i";break;case 35671:yr="2i";break;case 35667:yr="2i";break;case 35672:yr="3i";break;case 35668:yr="3i";break;case 35673:yr="4i";break;case 35669:yr="4i"}hr(un,".uniform",yr,"(",ta,",",b(zr)?Array.prototype.slice.call(zr):zr,");")}continue}else _n=On.append(Ht,hr)}else{if(!en(sn))continue;_n=hr.def(xn.uniforms,"[",$t.id(zr),"]")}switch(gn===35678?hr("if(",_n,"&&",_n,'._reglType==="framebuffer"){',_n,"=",_n,".color[0];","}"):gn===35680&&hr("if(",_n,"&&",_n,'._reglType==="framebufferCube"){',_n,"=",_n,".color[0];","}"),zr=1,gn){case 35678:case 35680:gn=hr.def(_n,"._texture"),hr(un,".uniform1i(",ta,",",gn,".bind());"),hr.exit(gn,".unbind();");continue;case 5124:case 35670:yr="1i";break;case 35667:case 35671:yr="2i",zr=2;break;case 35668:case 35672:yr="3i",zr=3;break;case 35669:case 35673:yr="4i",zr=4;break;case 5126:yr="1f";break;case 35664:yr="2f",zr=2;break;case 35665:yr="3f",zr=3;break;case 35666:yr="4f",zr=4;break;case 35674:yr="Matrix2fv";break;case 35675:yr="Matrix3fv";break;case 35676:yr="Matrix4fv"}if(yr.charAt(0)==="M"){hr(un,".uniform",yr,"(",ta,",");var ta=Math.pow(gn-35674+2,2),jn=Ht.global.def("new Float32Array(",ta,")");Array.isArray(_n)?hr("false,(",i(ta,function(ma){return jn+"["+ma+"]="+_n[ma]}),",",jn,")"):hr("false,(Array.isArray(",_n,")||",_n," instanceof Float32Array)?",_n,":(",i(ta,function(ma){return jn+"["+ma+"]="+_n+"["+ma+"]"}),",",jn,")"),hr(");")}else{if(1<zr){for(var gn=[],aa=[],On=0;On<zr;++On)Array.isArray(_n)?aa.push(_n[On]):aa.push(hr.def(_n+"["+On+"]")),Tn&&gn.push(hr.def());Tn&&hr("if(!",Ht.batchId,"||",gn.map(function(da,ma){return da+"!=="+aa[ma]}).join("||"),"){",gn.map(function(da,ma){return da+"="+aa[ma]+";"}).join("")),hr(un,".uniform",yr,"(",ta,",",aa.join(","),");")}else Tn&&(gn=hr.def(),hr("if(!",Ht.batchId,"||",gn,"!==",_n,"){",gn,"=",_n,";")),hr(un,".uniform",yr,"(",ta,",",_n,");");Tn&&hr("}")}}}function wn(Ht,hr,rn,vn){function en(sa){var Aa=zr[sa];return Aa?Aa.contextDep&&vn.contextDynamic||Aa.propDep?Aa.append(Ht,rn):Aa.append(Ht,hr):hr.def(mr,".",sa)}function Tn(){function sa(){rn(aa,".drawElementsInstancedANGLE(",[On,_n,da,ta+"<<(("+da+"-5121)>>1)",jn],");")}function Aa(){rn(aa,".drawArraysInstancedANGLE(",[On,ta,_n,jn],");")}gn&&gn!=="null"?ma?sa():(rn("if(",gn,"){"),sa(),rn("}else{"),Aa(),rn("}")):Aa()}function xn(){function sa(){rn(yr+".drawElements("+[On,_n,da,ta+"<<(("+da+"-5121)>>1)"]+");")}function Aa(){rn(yr+".drawArrays("+[On,ta,_n]+");")}gn&&gn!=="null"?ma?sa():(rn("if(",gn,"){"),sa(),rn("}else{"),Aa(),rn("}")):Aa()}var un=Ht.shared,yr=un.gl,mr=un.draw,zr=vn.draw,gn=function(){var sa=zr.elements,Aa=hr;return sa?((sa.contextDep&&vn.contextDynamic||sa.propDep)&&(Aa=rn),sa=sa.append(Ht,Aa),zr.elementsActive&&Aa("if("+sa+")"+yr+".bindBuffer(34963,"+sa+".buffer.buffer);")):(sa=Aa.def(),Aa(sa,"=",mr,".","elements",";","if(",sa,"){",yr,".bindBuffer(",34963,",",sa,".buffer.buffer);}","else if(",un.vao,".currentVAO){",sa,"=",Ht.shared.elements+".getElements("+un.vao,".currentVAO.elements);",fn?"":"if("+sa+")"+yr+".bindBuffer(34963,"+sa+".buffer.buffer);","}")),sa}(),On=en("primitive"),ta=en("offset"),_n=function(){var sa=zr.count,Aa=hr;return sa?((sa.contextDep&&vn.contextDynamic||sa.propDep)&&(Aa=rn),sa=sa.append(Ht,Aa)):sa=Aa.def(mr,".","count"),sa}();if(typeof _n=="number"){if(_n===0)return}else rn("if(",_n,"){"),rn.exit("}");var jn,aa;Tr&&(jn=en("instances"),aa=Ht.instancing);var da=gn+".type",ma=zr.elements&&X(zr.elements)&&!zr.vaoActive;Tr&&(typeof jn!="number"||0<=jn)?typeof jn=="string"?(rn("if(",jn,">0){"),Tn(),rn("}else if(",jn,"<0){"),xn(),rn("}")):Tn():xn()}function cn(Ht,hr,rn,vn,en){return hr=Yt(),en=hr.proc("body",en),Tr&&(hr.instancing=en.def(hr.shared.extensions,".angle_instanced_arrays")),Ht(hr,en,rn,vn),hr.compile().body}function Bn(Ht,hr,rn,vn){Or(Ht,hr),rn.useVAO?rn.drawVAO?hr(Ht.shared.vao,".setVAO(",rn.drawVAO.append(Ht,hr),");"):hr(Ht.shared.vao,".setVAO(",Ht.shared.vao,".targetVAO);"):(hr(Ht.shared.vao,".setVAO(null);"),wr(Ht,hr,rn,vn.attributes,function(){return!0})),Gr(Ht,hr,rn,vn.uniforms,function(){return!0},!1),wn(Ht,hr,hr,rn)}function En(Ht,hr){var rn=Ht.proc("draw",1);Or(Ht,rn),Lt(Ht,rn,hr.context),Zt(Ht,rn,hr.framebuffer),or(Ht,rn,hr),Ir(Ht,rn,hr.state),Er(Ht,rn,hr,!1,!0);var vn=hr.shader.progVar.append(Ht,rn);if(rn(Ht.shared.gl,".useProgram(",vn,".program);"),hr.shader.program)Bn(Ht,rn,hr,hr.shader.program);else{rn(Ht.shared.vao,".setVAO(null);");var en=Ht.global.def("{}"),Tn=rn.def(vn,".id"),xn=rn.def(en,"[",Tn,"]");rn(Ht.cond(xn).then(xn,".call(this,a0);").else(xn,"=",en,"[",Tn,"]=",Ht.link(function(un){return cn(Bn,Ht,hr,un,1)}),"(",vn,");",xn,".call(this,a0);"))}0<Object.keys(hr.state).length&&rn(Ht.shared.current,".dirty=true;"),Ht.shared.vao&&rn(Ht.shared.vao,".setVAO(null);")}function Yn(Ht,hr,rn,vn){function en(){return!0}Ht.batchId="a1",Or(Ht,hr),wr(Ht,hr,rn,vn.attributes,en),Gr(Ht,hr,rn,vn.uniforms,en,!1),wn(Ht,hr,hr,rn)}function Vn(Ht,hr,rn,vn){function en(gn){return gn.contextDep&&xn||gn.propDep}function Tn(gn){return!en(gn)}Or(Ht,hr);var xn=rn.contextDep,un=hr.def(),yr=hr.def();Ht.shared.props=yr,Ht.batchId=un;var mr=Ht.scope(),zr=Ht.scope();hr(mr.entry,"for(",un,"=0;",un,"<","a1",";++",un,"){",yr,"=","a0","[",un,"];",zr,"}",mr.exit),rn.needsContext&&Lt(Ht,zr,rn.context),rn.needsFramebuffer&&Zt(Ht,zr,rn.framebuffer),Ir(Ht,zr,rn.state,en),rn.profile&&en(rn.profile)&&Er(Ht,zr,rn,!1,!0),vn?(rn.useVAO?rn.drawVAO?en(rn.drawVAO)?zr(Ht.shared.vao,".setVAO(",rn.drawVAO.append(Ht,zr),");"):mr(Ht.shared.vao,".setVAO(",rn.drawVAO.append(Ht,mr),");"):mr(Ht.shared.vao,".setVAO(",Ht.shared.vao,".targetVAO);"):(mr(Ht.shared.vao,".setVAO(null);"),wr(Ht,mr,rn,vn.attributes,Tn),wr(Ht,zr,rn,vn.attributes,en)),Gr(Ht,mr,rn,vn.uniforms,Tn,!1),Gr(Ht,zr,rn,vn.uniforms,en,!0),wn(Ht,mr,zr,rn)):(hr=Ht.global.def("{}"),vn=rn.shader.progVar.append(Ht,zr),yr=zr.def(vn,".id"),mr=zr.def(hr,"[",yr,"]"),zr(Ht.shared.gl,".useProgram(",vn,".program);","if(!",mr,"){",mr,"=",hr,"[",yr,"]=",Ht.link(function(gn){return cn(Yn,Ht,rn,gn,2)}),"(",vn,");}",mr,".call(this,a0[",un,"],",un,");"))}function pa(Ht,hr){function rn(mr){return mr.contextDep&&en||mr.propDep}var vn=Ht.proc("batch",2);Ht.batchId="0",Or(Ht,vn);var en=!1,Tn=!0;Object.keys(hr.context).forEach(function(mr){en=en||hr.context[mr].propDep}),en||(Lt(Ht,vn,hr.context),Tn=!1);var xn=hr.framebuffer,un=!1;if(xn?(xn.propDep?en=un=!0:xn.contextDep&&en&&(un=!0),un||Zt(Ht,vn,xn)):Zt(Ht,vn,null),hr.state.viewport&&hr.state.viewport.propDep&&(en=!0),or(Ht,vn,hr),Ir(Ht,vn,hr.state,function(mr){return!rn(mr)}),hr.profile&&rn(hr.profile)||Er(Ht,vn,hr,!1,"a1"),hr.contextDep=en,hr.needsContext=Tn,hr.needsFramebuffer=un,Tn=hr.shader.progVar,Tn.contextDep&&en||Tn.propDep)Vn(Ht,vn,hr,null);else if(Tn=Tn.append(Ht,vn),vn(Ht.shared.gl,".useProgram(",Tn,".program);"),hr.shader.program)Vn(Ht,vn,hr,hr.shader.program);else{vn(Ht.shared.vao,".setVAO(null);");var xn=Ht.global.def("{}"),un=vn.def(Tn,".id"),yr=vn.def(xn,"[",un,"]");vn(Ht.cond(yr).then(yr,".call(this,a0,a1);").else(yr,"=",xn,"[",un,"]=",Ht.link(function(gn){return cn(Vn,Ht,hr,gn,2)}),"(",Tn,");",yr,".call(this,a0,a1);"))}0<Object.keys(hr.state).length&&vn(Ht.shared.current,".dirty=true;"),Ht.shared.vao&&vn(Ht.shared.vao,".setVAO(null);")}function Ma(Ht,hr){function rn(un){var yr=hr.shader[un];yr&&(yr=yr.append(Ht,vn),isNaN(yr)?vn.set(en.shader,"."+un,yr):vn.set(en.shader,"."+un,Ht.link(yr,{stable:!0})))}var vn=Ht.proc("scope",3);Ht.batchId="a2";var en=Ht.shared,Tn=en.current;if(Lt(Ht,vn,hr.context),hr.framebuffer&&hr.framebuffer.append(Ht,vn),$(Object.keys(hr.state)).forEach(function(un){var yr=hr.state[un],mr=yr.append(Ht,vn);b(mr)?mr.forEach(function(zr,gn){isNaN(zr)?vn.set(Ht.next[un],"["+gn+"]",zr):vn.set(Ht.next[un],"["+gn+"]",Ht.link(zr,{stable:!0}))}):X(yr)?vn.set(en.next,"."+un,Ht.link(mr,{stable:!0})):vn.set(en.next,"."+un,mr)}),Er(Ht,vn,hr,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(un){var yr=hr.draw[un];yr&&(yr=yr.append(Ht,vn),isNaN(yr)?vn.set(en.draw,"."+un,yr):vn.set(en.draw,"."+un,Ht.link(yr),{stable:!0}))}),Object.keys(hr.uniforms).forEach(function(un){var yr=hr.uniforms[un].append(Ht,vn);Array.isArray(yr)&&(yr="["+yr.map(function(mr){return isNaN(mr)?mr:Ht.link(mr,{stable:!0})})+"]"),vn.set(en.uniforms,"["+Ht.link($t.id(un),{stable:!0})+"]",yr)}),Object.keys(hr.attributes).forEach(function(un){var yr=hr.attributes[un].append(Ht,vn),mr=Ht.scopeAttrib(un);Object.keys(new ja).forEach(function(zr){vn.set(mr,"."+zr,yr[zr])})}),hr.scopeVAO){var xn=hr.scopeVAO.append(Ht,vn);isNaN(xn)?vn.set(en.vao,".targetVAO",xn):vn.set(en.vao,".targetVAO",Ht.link(xn,{stable:!0}))}rn("vert"),rn("frag"),0<Object.keys(hr.state).length&&(vn(Tn,".dirty=true;"),vn.exit(Tn,".dirty=true;")),vn("a1(",Ht.shared.context,",a0,",Ht.batchId,");")}function ci(Ht){if(typeof Ht=="object"&&!b(Ht)){for(var hr=Object.keys(Ht),rn=0;rn<hr.length;++rn)if(ce.isDynamic(Ht[hr[rn]]))return!0;return!1}}function Va(Ht,hr,rn){function vn(gn,On){xn.forEach(function(ta){var _n=en[ta];ce.isDynamic(_n)&&(_n=gn.invoke(On,_n),On(zr,".",ta,"=",_n,";"))})}var en=hr.static[rn];if(en&&ci(en)){var Tn=Ht.global,xn=Object.keys(en),un=!1,yr=!1,mr=!1,zr=Ht.global.def("{}");xn.forEach(function(gn){var On=en[gn];if(ce.isDynamic(On))typeof On=="function"&&(On=en[gn]=ce.unbox(On)),gn=ie(On,null),un=un||gn.thisDep,mr=mr||gn.propDep,yr=yr||gn.contextDep;else{switch(Tn(zr,".",gn,"="),typeof On){case"number":Tn(On);break;case"string":Tn('"',On,'"');break;case"object":Array.isArray(On)&&Tn("[",On.join(),"]");break;default:Tn(Ht.link(On))}Tn(";")}}),hr.dynamic[rn]=new ce.DynamicVariable(4,{thisDep:un,contextDep:yr,propDep:mr,ref:zr,append:vn}),delete hr.static[rn]}}var ja=Tt.Record,Wa={add:32774,subtract:32778,"reverse subtract":32779};Jt.ext_blend_minmax&&(Wa.min=32775,Wa.max=32776);var Tr=Jt.angle_instanced_arrays,pn=Jt.webgl_draw_buffers,fn=Jt.oes_vertex_array_object,An={dirty:!0,profile:ct.profile},Zn={},ua=[],ea={},Rn={};gt("dither",3024),gt("blend.enable",3042),St("blend.color","blendColor",[0,0,0,0]),St("blend.equation","blendEquationSeparate",[32774,32774]),St("blend.func","blendFuncSeparate",[1,0,1,0]),gt("depth.enable",2929,!0),St("depth.func","depthFunc",513),St("depth.range","depthRange",[0,1]),St("depth.mask","depthMask",!0),St("colorMask","colorMask",[!0,!0,!0,!0]),gt("cull.enable",2884),St("cull.face","cullFace",1029),St("frontFace","frontFace",2305),St("lineWidth","lineWidth",1),gt("polygonOffset.enable",32823),St("polygonOffset.offset","polygonOffset",[0,0]),gt("sample.alpha",32926),gt("sample.enable",32928),St("sample.coverage","sampleCoverage",[1,!1]),gt("stencil.enable",2960),St("stencil.mask","stencilMask",-1),St("stencil.func","stencilFunc",[519,0,-1]),St("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),St("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),gt("scissor.enable",3089),St("scissor.box","scissor",[0,0,at.drawingBufferWidth,at.drawingBufferHeight]),St("viewport","viewport",[0,0,at.drawingBufferWidth,at.drawingBufferHeight]);var Xn={gl:at,context:Se,strings:$t,next:Zn,current:An,draw:Ce,elements:rt,buffer:_r,shader:zt,attributes:Tt.state,vao:Tt,uniforms:lt,framebuffer:st,extensions:Jt,timer:nt,isBufferArgs:U},Ua={primTypes:Ye,compareFuncs:Vt,blendFuncs:Wt,blendEquations:Wa,stencilOps:ir,glTypes:ke,orientationType:Hr};pn&&(Ua.backBuffer=[1029],Ua.drawBuffer=i(Gt.maxDrawbuffers,function(Ht){return Ht===0?[0]:i(Ht,function(hr){return 36064+hr})}));var li=0;return{next:Zn,current:An,procs:function(){var Ht=Yt(),hr=Ht.proc("poll"),rn=Ht.proc("refresh"),vn=Ht.block();hr(vn),rn(vn);var yr=Ht.shared,en=yr.gl,Tn=yr.next,xn=yr.current;vn(xn,".dirty=false;"),Zt(Ht,hr),Zt(Ht,rn,null,!0);var un;Tr&&(un=Ht.link(Tr)),Jt.oes_vertex_array_object&&rn(Ht.link(Jt.oes_vertex_array_object),".bindVertexArrayOES(null);");var yr=rn.def(yr.attributes),mr=rn.def(0),zr=Ht.cond(mr,".buffer");zr.then(en,".enableVertexAttribArray(i);",en,".bindBuffer(",34962,",",mr,".buffer.buffer);",en,".vertexAttribPointer(i,",mr,".size,",mr,".type,",mr,".normalized,",mr,".stride,",mr,".offset);").else(en,".disableVertexAttribArray(i);",en,".vertexAttrib4f(i,",mr,".x,",mr,".y,",mr,".z,",mr,".w);",mr,".buffer=null;");var gn=Ht.link(Gt.maxAttributes,{stable:!0});return rn("for(var i=0;i<",gn,";++i){",mr,"=",yr,"[i];",zr,"}"),Tr&&rn("for(var i=0;i<",gn,";++i){",un,".vertexAttribDivisorANGLE(i,",yr,"[i].divisor);","}"),rn(Ht.shared.vao,".currentVAO=null;",Ht.shared.vao,".setVAO(",Ht.shared.vao,".targetVAO);"),Object.keys(ea).forEach(function(On){var ta=ea[On],_n=vn.def(Tn,".",On),jn=Ht.block();jn("if(",_n,"){",en,".enable(",ta,")}else{",en,".disable(",ta,")}",xn,".",On,"=",_n,";"),rn(jn),hr("if(",_n,"!==",xn,".",On,"){",jn,"}")}),Object.keys(Rn).forEach(function(On){var ta=Rn[On],_n=An[On],jn,aa,da=Ht.block();da(en,".",ta,"("),b(_n)?(ta=_n.length,jn=Ht.global.def(Tn,".",On),aa=Ht.global.def(xn,".",On),da(i(ta,function(ma){return jn+"["+ma+"]"}),");",i(ta,function(ma){return aa+"["+ma+"]="+jn+"["+ma+"];"}).join("")),hr("if(",i(ta,function(ma){return jn+"["+ma+"]!=="+aa+"["+ma+"]"}).join("||"),"){",da,"}")):(jn=vn.def(Tn,".",On),aa=vn.def(xn,".",On),da(jn,");",xn,".",On,"=",jn,";"),hr("if(",jn,"!==",aa,"){",da,"}")),rn(da)}),Ht.compile()}(),compile:function(Ht,hr,rn,vn,en){var Tn=Yt();Tn.stats=Tn.link(en),Object.keys(hr.static).forEach(function(un){Va(Tn,hr,un)}),Nt.forEach(function(un){Va(Tn,Ht,un)});var xn=et(Ht,hr,rn,vn,Tn);return xn.shader.program&&(xn.shader.program.attributes.sort(function(un,yr){return un.name<yr.name?-1:1}),xn.shader.program.uniforms.sort(function(un,yr){return un.name<yr.name?-1:1})),En(Tn,xn),Ma(Tn,xn),pa(Tn,xn),oe(Tn.compile(),{destroy:function(){xn.shader.program.destroy()}})}}}function ae(at,$t){for(var Jt=0;Jt<at.length;++Jt)if(at[Jt]===$t)return Jt;return-1}var oe=function(at,$t){for(var Jt=Object.keys($t),Gt=0;Gt<Jt.length;++Gt)at[Jt[Gt]]=$t[Jt[Gt]];return at},be=0,ce={DynamicVariable:A,define:function(at,$t){return new A(at,S($t+""))},isDynamic:function(at){return typeof at=="function"&&!at._reglType||at instanceof A},unbox:M,accessor:S},de={next:typeof requestAnimationFrame=="function"?function(at){return requestAnimationFrame(at)}:function(at){return setTimeout(at,16)},cancel:typeof cancelAnimationFrame=="function"?function(at){return cancelAnimationFrame(at)}:clearTimeout},ye=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},ge=p();ge.zero=p();var me=function(at,$t){var Jt=1;$t.ext_texture_filter_anisotropic&&(Jt=at.getParameter(34047));var Gt=1,_r=1;$t.webgl_draw_buffers&&(Gt=at.getParameter(34852),_r=at.getParameter(36063));var rt=!!$t.oes_texture_float;if(rt){rt=at.createTexture(),at.bindTexture(3553,rt),at.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var Je=at.createFramebuffer();if(at.bindFramebuffer(36160,Je),at.framebufferTexture2D(36160,36064,3553,rt,0),at.bindTexture(3553,null),at.checkFramebufferStatus(36160)!==36053)rt=!1;else{at.viewport(0,0,1,1),at.clearColor(1,0,0,1),at.clear(16384);var st=ge.allocType(5126,4);at.readPixels(0,0,1,1,6408,5126,st),at.getError()?rt=!1:(at.deleteFramebuffer(Je),at.deleteTexture(rt),rt=st[0]===1),ge.freeType(st)}}return st=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(st=at.createTexture(),Je=ge.allocType(5121,36),at.activeTexture(33984),at.bindTexture(34067,st),at.texImage2D(34069,0,6408,3,3,0,6408,5121,Je),ge.freeType(Je),at.bindTexture(34067,null),at.deleteTexture(st),st=!at.getError()),{colorBits:[at.getParameter(3410),at.getParameter(3411),at.getParameter(3412),at.getParameter(3413)],depthBits:at.getParameter(3414),stencilBits:at.getParameter(3415),subpixelBits:at.getParameter(3408),extensions:Object.keys($t).filter(function(lt){return!!$t[lt]}),maxAnisotropic:Jt,maxDrawbuffers:Gt,maxColorAttachments:_r,pointSizeDims:at.getParameter(33901),lineWidthDims:at.getParameter(33902),maxViewportDims:at.getParameter(3386),maxCombinedTextureUnits:at.getParameter(35661),maxCubeMapSize:at.getParameter(34076),maxRenderbufferSize:at.getParameter(34024),maxTextureUnits:at.getParameter(34930),maxTextureSize:at.getParameter(3379),maxAttributes:at.getParameter(34921),maxVertexUniforms:at.getParameter(36347),maxVertexTextureUnits:at.getParameter(35660),maxVaryingVectors:at.getParameter(36348),maxFragmentUniforms:at.getParameter(36349),glsl:at.getParameter(35724),renderer:at.getParameter(7937),vendor:at.getParameter(7936),version:at.getParameter(7938),readFloat:rt,npotTextureCube:st}},Ee=function(at){return at instanceof Uint8Array||at instanceof Uint16Array||at instanceof Uint32Array||at instanceof Int8Array||at instanceof Int16Array||at instanceof Int32Array||at instanceof Float32Array||at instanceof Float64Array||at instanceof Uint8ClampedArray},Pe=function(at){return Object.keys(at).map(function($t){return at[$t]})},Ue={shape:function(at){for(var $t=[];at.length;at=at[0])$t.push(at.length);return $t},flatten:function(at,$t,Jt,Gt){var _r=1;if($t.length)for(var rt=0;rt<$t.length;++rt)_r*=$t[rt];else _r=0;switch(Jt=Gt||ge.allocType(Jt,_r),$t.length){case 0:break;case 1:for(Gt=$t[0],$t=0;$t<Gt;++$t)Jt[$t]=at[$t];break;case 2:for(Gt=$t[0],$t=$t[1],rt=_r=0;rt<Gt;++rt)for(var Je=at[rt],st=0;st<$t;++st)Jt[_r++]=Je[st];break;case 3:f(at,$t[0],$t[1],$t[2],Jt,0);break;default:d(at,$t,0,Jt,0)}return Jt}},we={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ke={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Xe={dynamic:35048,stream:35040,static:35044},Ve=Ue.flatten,Ie=Ue.shape,De=[];De[5120]=1,De[5122]=2,De[5124]=4,De[5121]=1,De[5123]=2,De[5125]=4,De[5126]=4;var Ye={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},vt=new Float32Array(1),Dt=new Uint32Array(vt.buffer),Kt=[9984,9986,9985,9987],Ft=[0,6409,6410,6407,6408],Mt={};Mt[6409]=Mt[6406]=Mt[6402]=1,Mt[34041]=Mt[6410]=2,Mt[6407]=Mt[35904]=3,Mt[6408]=Mt[35906]=4;var Xt=u("HTMLCanvasElement"),It=u("OffscreenCanvas"),At=u("CanvasRenderingContext2D"),Ge=u("ImageBitmap"),tt=u("HTMLImageElement"),He=u("HTMLVideoElement"),Ae=Object.keys(we).concat([Xt,It,At,Ge,tt,He]),Ne=[];Ne[5121]=1,Ne[5126]=4,Ne[36193]=2,Ne[5123]=2,Ne[5125]=4;var Ze=[];Ze[32854]=2,Ze[32855]=2,Ze[36194]=2,Ze[34041]=4,Ze[33776]=.5,Ze[33777]=.5,Ze[33778]=1,Ze[33779]=1,Ze[35986]=.5,Ze[35987]=1,Ze[34798]=1,Ze[35840]=.5,Ze[35841]=.25,Ze[35842]=.5,Ze[35843]=.25,Ze[36196]=.5;var Qe=[];Qe[32854]=2,Qe[32855]=2,Qe[36194]=2,Qe[33189]=2,Qe[36168]=1,Qe[34041]=4,Qe[35907]=4,Qe[34836]=16,Qe[34842]=8,Qe[34843]=6;var bt=function(at,$t,Jt,Gt,_r){function rt(Ce){this.id=Tt++,this.refCount=1,this.renderbuffer=Ce,this.format=32854,this.height=this.width=0,_r.profile&&(this.stats={size:0})}function Je(Ce){var Se=Ce.renderbuffer;at.bindRenderbuffer(36161,null),at.deleteRenderbuffer(Se),Ce.renderbuffer=null,Ce.refCount=0,delete zt[Ce.id],Gt.renderbufferCount--}var st={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};$t.ext_srgb&&(st.srgba=35907),$t.ext_color_buffer_half_float&&(st.rgba16f=34842,st.rgb16f=34843),$t.webgl_color_buffer_float&&(st.rgba32f=34836);var lt=[];Object.keys(st).forEach(function(Ce){lt[st[Ce]]=Ce});var Tt=0,zt={};return rt.prototype.decRef=function(){0>=--this.refCount&&Je(this)},_r.profile&&(Gt.getTotalRenderbufferSize=function(){var Ce=0;return Object.keys(zt).forEach(function(Se){Ce+=zt[Se].stats.size}),Ce}),{create:function(Ce,Se){function nt(ct,kt){var gt=0,St=0,Yt=32854;if(typeof ct=="object"&&ct?("shape"in ct?(St=ct.shape,gt=St[0]|0,St=St[1]|0):("radius"in ct&&(gt=St=ct.radius|0),"width"in ct&&(gt=ct.width|0),"height"in ct&&(St=ct.height|0)),"format"in ct&&(Yt=st[ct.format])):typeof ct=="number"?(gt=ct|0,St=typeof kt=="number"?kt|0:gt):ct||(gt=St=1),gt!==it.width||St!==it.height||Yt!==it.format)return nt.width=it.width=gt,nt.height=it.height=St,it.format=Yt,at.bindRenderbuffer(36161,it.renderbuffer),at.renderbufferStorage(36161,Yt,gt,St),_r.profile&&(it.stats.size=Qe[it.format]*it.width*it.height),nt.format=lt[it.format],nt}var it=new rt(at.createRenderbuffer());return zt[it.id]=it,Gt.renderbufferCount++,nt(Ce,Se),nt.resize=function(ct,kt){var gt=ct|0,St=kt|0||gt;return gt===it.width&&St===it.height||(nt.width=it.width=gt,nt.height=it.height=St,at.bindRenderbuffer(36161,it.renderbuffer),at.renderbufferStorage(36161,it.format,gt,St),_r.profile&&(it.stats.size=Qe[it.format]*it.width*it.height)),nt},nt._reglType="renderbuffer",nt._renderbuffer=it,_r.profile&&(nt.stats=it.stats),nt.destroy=function(){it.decRef()},nt},clear:function(){Pe(zt).forEach(Je)},restore:function(){Pe(zt).forEach(function(Ce){Ce.renderbuffer=at.createRenderbuffer(),at.bindRenderbuffer(36161,Ce.renderbuffer),at.renderbufferStorage(36161,Ce.format,Ce.width,Ce.height)}),at.bindRenderbuffer(36161,null)}}},dt=[];dt[6408]=4,dt[6407]=3;var wt=[];wt[5121]=1,wt[5126]=4,wt[36193]=2;var Ut=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Rt=["x","y","z","w"],Nt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Wt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Vt={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ir={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Hr={cw:2304,ccw:2305},sn=new ne(!1,!1,!1,function(){}),jr=function(at,$t){function Jt(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function Gt(zt,Ce,Se){var nt=Je.pop()||new Jt;nt.startQueryIndex=zt,nt.endQueryIndex=Ce,nt.sum=0,nt.stats=Se,st.push(nt)}if(!$t.ext_disjoint_timer_query)return null;var _r=[],rt=[],Je=[],st=[],lt=[],Tt=[];return{beginQuery:function(zt){var Ce=_r.pop()||$t.ext_disjoint_timer_query.createQueryEXT();$t.ext_disjoint_timer_query.beginQueryEXT(35007,Ce),rt.push(Ce),Gt(rt.length-1,rt.length,zt)},endQuery:function(){$t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Gt,update:function(){var zt,Ce;if(zt=rt.length,zt!==0){Tt.length=Math.max(Tt.length,zt+1),lt.length=Math.max(lt.length,zt+1),lt[0]=0;var Se=Tt[0]=0;for(Ce=zt=0;Ce<rt.length;++Ce){var nt=rt[Ce];$t.ext_disjoint_timer_query.getQueryObjectEXT(nt,34919)?(Se+=$t.ext_disjoint_timer_query.getQueryObjectEXT(nt,34918),_r.push(nt)):rt[zt++]=nt,lt[Ce+1]=Se,Tt[Ce+1]=zt}for(rt.length=zt,Ce=zt=0;Ce<st.length;++Ce){var Se=st[Ce],it=Se.startQueryIndex,nt=Se.endQueryIndex;Se.sum+=lt[nt]-lt[it],it=Tt[it],nt=Tt[nt],nt===it?(Se.stats.gpuTime+=Se.sum/1e6,Je.push(Se)):(Se.startQueryIndex=it,Se.endQueryIndex=nt,st[zt++]=Se)}st.length=zt}},getNumPendingQueries:function(){return rt.length},clear:function(){_r.push.apply(_r,rt);for(var zt=0;zt<_r.length;zt++)$t.ext_disjoint_timer_query.deleteQueryEXT(_r[zt]);rt.length=0,_r.length=0},restore:function(){rt.length=0,_r.length=0}}};return function(at){function $t(){if(Er.length===0)Yt&&Yt.update(),cn=null;else{cn=de.next($t),zt();for(var En=Er.length-1;0<=En;--En){var Yn=Er[En];Yn&&Yn(br,null,0)}nt.flush(),Yt&&Yt.update()}}function Jt(){!cn&&0<Er.length&&(cn=de.next($t))}function Gt(){cn&&(de.cancel($t),cn=null)}function _r(En){En.preventDefault(),Gt(),wr.forEach(function(Yn){Yn()})}function rt(En){nt.getError(),ct.restore(),Br.restore(),nr.restore(),Sr.restore(),et.restore(),Lt.restore(),Rr.restore(),Yt&&Yt.restore(),Zt.procs.refresh(),Jt(),Gr.forEach(function(Yn){Yn()})}function Je(En){function Yn(An,Zn){var ua={},ea={};return Object.keys(An).forEach(function(Rn){var Xn=An[Rn];if(ce.isDynamic(Xn))ea[Rn]=ce.unbox(Xn,Rn);else{if(Zn&&Array.isArray(Xn)){for(var Ua=0;Ua<Xn.length;++Ua)if(ce.isDynamic(Xn[Ua])){ea[Rn]=ce.unbox(Xn,Rn);return}}ua[Rn]=Xn}}),{dynamic:ea,static:ua}}function Vn(An){for(;fn.length<An;)fn.push(null);return fn}var pa=Yn(En.context||{},!0),Ma=Yn(En.uniforms||{},!0),ci=Yn(En.attributes||{},!1);En=Yn(function(An){function Zn(ea){if(ea in ua){var Rn=ua[ea];delete ua[ea],Object.keys(Rn).forEach(function(Xn){ua[ea+"."+Xn]=Rn[Xn]})}}var ua=oe({},An);return delete ua.uniforms,delete ua.attributes,delete ua.context,delete ua.vao,"stencil"in ua&&ua.stencil.op&&(ua.stencil.opBack=ua.stencil.opFront=ua.stencil.op,delete ua.stencil.op),Zn("blend"),Zn("depth"),Zn("cull"),Zn("stencil"),Zn("polygonOffset"),Zn("scissor"),Zn("sample"),"vao"in An&&(ua.vao=An.vao),ua}(En),!1);var Va={gpuTime:0,cpuTime:0,count:0},ja=Zt.compile(En,ci,Ma,pa,Va),Wa=ja.draw,Tr=ja.batch,pn=ja.scope,fn=[];return oe(function(An,Zn){var ua;if(typeof An=="function")return pn.call(this,null,An,0);if(typeof Zn=="function")if(typeof An=="number")for(ua=0;ua<An;++ua)pn.call(this,null,Zn,ua);else if(Array.isArray(An))for(ua=0;ua<An.length;++ua)pn.call(this,An[ua],Zn,ua);else return pn.call(this,An,Zn,0);else if(typeof An=="number"){if(0<An)return Tr.call(this,Vn(An|0),An|0)}else if(Array.isArray(An)){if(An.length)return Tr.call(this,An,An.length)}else return Wa.call(this,An)},{stats:Va,destroy:function(){ja.destroy()}})}function st(En,Yn){var Vn=0;Zt.procs.poll();var pa=Yn.color;pa&&(nt.clearColor(+pa[0]||0,+pa[1]||0,+pa[2]||0,+pa[3]||0),Vn|=16384),"depth"in Yn&&(nt.clearDepth(+Yn.depth),Vn|=256),"stencil"in Yn&&(nt.clearStencil(Yn.stencil|0),Vn|=1024),nt.clear(Vn)}function lt(En){return Er.push(En),Jt(),{cancel:function(){function Yn(){var pa=ae(Er,Yn);Er[pa]=Er[Er.length-1],--Er.length,0>=Er.length&&Gt()}var Vn=ae(Er,En);Er[Vn]=Yn}}}function Tt(){var En=Ir.viewport,Yn=Ir.scissor_box;En[0]=En[1]=Yn[0]=Yn[1]=0,br.viewportWidth=br.framebufferWidth=br.drawingBufferWidth=En[2]=Yn[2]=nt.drawingBufferWidth,br.viewportHeight=br.framebufferHeight=br.drawingBufferHeight=En[3]=Yn[3]=nt.drawingBufferHeight}function zt(){br.tick+=1,br.time=Se(),Tt(),Zt.procs.poll()}function Ce(){Sr.refresh(),Tt(),Zt.procs.refresh(),Yt&&Yt.update()}function Se(){return(ye()-ar)/1e3}if(at=h(at),!at)return null;var nt=at.gl,it=nt.getContextAttributes();nt.isContextLost();var ct=s(nt,at);if(!ct)return null;var or=e(),kt={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},gt=at.cachedCode||{},St=ct.extensions,Yt=jr(nt,St),ar=ye(),Mr=nt.drawingBufferWidth,kr=nt.drawingBufferHeight,br={tick:0,time:0,viewportWidth:Mr,viewportHeight:kr,framebufferWidth:Mr,framebufferHeight:kr,drawingBufferWidth:Mr,drawingBufferHeight:kr,pixelRatio:at.pixelRatio},Mr={elements:null,primitive:4,count:-1,offset:0,instances:-1},Yr=me(nt,St),nr=w(nt,kt,at,function(En){return Rr.destroyBuffer(En)}),gr=_(nt,St,nr,kt),Rr=F(nt,St,Yr,kt,nr,gr,Mr),Br=N(nt,or,kt,at),Sr=D(nt,St,Yr,function(){Zt.procs.poll()},br,kt,at),et=bt(nt,St,Yr,kt,at),Lt=R(nt,St,Yr,Sr,et,kt),Zt=se(nt,or,St,Yr,nr,gr,Sr,Lt,{},Rr,Br,Mr,br,Yt,gt,at),or=G(nt,Lt,Zt.procs.poll,br),Ir=Zt.next,Or=nt.canvas,Er=[],wr=[],Gr=[],wn=[at.onDestroy],cn=null;Or&&(Or.addEventListener("webglcontextlost",_r,!1),Or.addEventListener("webglcontextrestored",rt,!1));var Bn=Lt.setFBO=Je({framebuffer:ce.define.call(null,1,"framebuffer")});return Ce(),it=oe(Je,{clear:function(En){if("framebuffer"in En)if(En.framebuffer&&En.framebuffer_reglType==="framebufferCube")for(var Yn=0;6>Yn;++Yn)Bn(oe({framebuffer:En.framebuffer.faces[Yn]},En),st);else Bn(En,st);else st(null,En)},prop:ce.define.bind(null,1),context:ce.define.bind(null,2),this:ce.define.bind(null,3),draw:Je({}),buffer:function(En){return nr.create(En,34962,!1,!1)},elements:function(En){return gr.create(En,!1)},texture:Sr.create2D,cube:Sr.createCube,renderbuffer:et.create,framebuffer:Lt.create,framebufferCube:Lt.createCube,vao:Rr.createVAO,attributes:it,frame:lt,on:function(En,Yn){var Vn;switch(En){case"frame":return lt(Yn);case"lost":Vn=wr;break;case"restore":Vn=Gr;break;case"destroy":Vn=wn}return Vn.push(Yn),{cancel:function(){for(var pa=0;pa<Vn.length;++pa)if(Vn[pa]===Yn){Vn[pa]=Vn[Vn.length-1],Vn.pop();break}}}},limits:Yr,hasExtension:function(En){return 0<=Yr.extensions.indexOf(En.toLowerCase())},read:or,destroy:function(){Er.length=0,Gt(),Or&&(Or.removeEventListener("webglcontextlost",_r),Or.removeEventListener("webglcontextrestored",rt)),Br.clear(),Lt.clear(),et.clear(),Rr.clear(),Sr.clear(),gr.clear(),nr.clear(),Yt&&Yt.clear(),wn.forEach(function(En){En()})},_gl:nt,_refresh:Ce,poll:function(){zt(),Yt&&Yt.update()},now:Se,stats:kt,getCachedCode:function(){return gt},preloadCachedCode:function(En){Object.entries(En).forEach(function(Yn){gt[Yn[0]]=Yn[1]})}}),at.onDone(null,it),it}})},{}],285:[function(y,ee,te){var A=y("buffer"),g=A.Buffer;function S(e,a){for(var n in e)a[n]=e[n]}g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?ee.exports=A:(S(A,te),te.Buffer=M);function M(e,a,n){return g(e,a,n)}M.prototype=Object.create(g.prototype),S(g,M),M.from=function(e,a,n){if(typeof e=="number")throw new TypeError("Argument must not be a number");return g(e,a,n)},M.alloc=function(e,a,n){if(typeof e!="number")throw new TypeError("Argument must be a number");var r=g(e);return a!==void 0?typeof n=="string"?r.fill(a,n):r.fill(a):r.fill(0),r},M.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return g(e)},M.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return A.SlowBuffer(e)}},{buffer:85}],286:[function(y,ee,te){ee.exports=S;var A=y("events").EventEmitter,g=y("inherits");g(S,A),S.Readable=y("readable-stream/lib/_stream_readable.js"),S.Writable=y("readable-stream/lib/_stream_writable.js"),S.Duplex=y("readable-stream/lib/_stream_duplex.js"),S.Transform=y("readable-stream/lib/_stream_transform.js"),S.PassThrough=y("readable-stream/lib/_stream_passthrough.js"),S.finished=y("readable-stream/lib/internal/streams/end-of-stream.js"),S.pipeline=y("readable-stream/lib/internal/streams/pipeline.js"),S.Stream=S;function S(){A.call(this)}S.prototype.pipe=function(M,e){var a=this;function n(p){M.writable&&M.write(p)===!1&&a.pause&&a.pause()}a.on("data",n);function r(){a.readable&&a.resume&&a.resume()}M.on("drain",r),!M._isStdio&&(!e||e.end!==!1)&&(a.on("end",h),a.on("close",s));var t=!1;function h(){t||(t=!0,M.end())}function s(){t||(t=!0,typeof M.destroy=="function"&&M.destroy())}function i(p){if(x(),A.listenerCount(this,"error")===0)throw p}a.on("error",i),M.on("error",i);function x(){a.removeListener("data",n),M.removeListener("drain",r),a.removeListener("end",h),a.removeListener("close",s),a.removeListener("error",i),M.removeListener("error",i),a.removeListener("end",x),a.removeListener("close",x),M.removeListener("close",x)}return a.on("end",x),a.on("close",x),M.on("close",x),M.emit("pipe",a),M}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(y,ee,te){function A(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}var g={};function S(r,t,h){h||(h=Error);function s(x,p,v){return typeof t=="string"?t:t(x,p,v)}var i=function(x){A(p,x);function p(v,f,d){return x.call(this,s(v,f,d))||this}return p}(h);i.prototype.name=h.name,i.prototype.code=r,g[r]=i}function M(r,t){if(Array.isArray(r)){var h=r.length;return r=r.map(function(s){return String(s)}),h>2?"one of ".concat(t," ").concat(r.slice(0,h-1).join(", "),", or ")+r[h-1]:h===2?"one of ".concat(t," ").concat(r[0]," or ").concat(r[1]):"of ".concat(t," ").concat(r[0])}else return"of ".concat(t," ").concat(String(r))}function e(r,t,h){return r.substr(!h||h<0?0:+h,t.length)===t}function a(r,t,h){return(h===void 0||h>r.length)&&(h=r.length),r.substring(h-t.length,h)===t}function n(r,t,h){return typeof h!="number"&&(h=0),h+t.length>r.length?!1:r.indexOf(t,h)!==-1}S("ERR_INVALID_OPT_VALUE",function(r,t){return'The value "'+t+'" is invalid for option "'+r+'"'},TypeError),S("ERR_INVALID_ARG_TYPE",function(r,t,h){var s;typeof t=="string"&&e(t,"not ")?(s="must not be",t=t.replace(/^not /,"")):s="must be";var i;if(a(r," argument"))i="The ".concat(r," ").concat(s," ").concat(M(t,"type"));else{var x=n(r,".")?"property":"argument";i='The "'.concat(r,'" ').concat(x," ").concat(s," ").concat(M(t,"type"))}return i+=". Received type ".concat(typeof h),i},TypeError),S("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),S("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),S("ERR_STREAM_PREMATURE_CLOSE","Premature close"),S("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),S("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),S("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),S("ERR_STREAM_WRITE_AFTER_END","write after end"),S("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),S("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),S("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ee.exports.codes=g},{}],288:[function(y,ee,te){(function(A){(function(){var g=Object.keys||function(s){var i=[];for(var x in s)i.push(x);return i};ee.exports=r;var S=y("./_stream_readable"),M=y("./_stream_writable");y("inherits")(r,S);for(var e=g(M.prototype),a=0;a<e.length;a++){var n=e[a];r.prototype[n]||(r.prototype[n]=M.prototype[n])}function r(s){if(!(this instanceof r))return new r(s);S.call(this,s),M.call(this,s),this.allowHalfOpen=!0,s&&(s.readable===!1&&(this.readable=!1),s.writable===!1&&(this.writable=!1),s.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",t)))}Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function t(){this._writableState.ended||A.nextTick(h,this)}function h(s){s.end()}Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(i){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=i,this._writableState.destroyed=i)}})}).call(this)}).call(this,y("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(y,ee,te){ee.exports=g;var A=y("./_stream_transform");y("inherits")(g,A);function g(S){if(!(this instanceof g))return new g(S);A.call(this,S)}g.prototype._transform=function(S,M,e){e(null,S)}},{"./_stream_transform":291,inherits:231}],290:[function(y,ee,te){(function(A,g){(function(){ee.exports=k;var S;k.ReadableState=T,y("events").EventEmitter;var M=function(ie,se){return ie.listeners(se).length},e=y("./internal/streams/stream"),a=y("buffer").Buffer,n=g.Uint8Array||function(){};function r(Q){return a.from(Q)}function t(Q){return a.isBuffer(Q)||Q instanceof n}var h=y("util"),s;h&&h.debuglog?s=h.debuglog("stream"):s=function(){};var i=y("./internal/streams/buffer_list"),x=y("./internal/streams/destroy"),p=y("./internal/streams/state"),v=p.getHighWaterMark,f=y("../errors").codes,d=f.ERR_INVALID_ARG_TYPE,o=f.ERR_STREAM_PUSH_AFTER_EOF,m=f.ERR_METHOD_NOT_IMPLEMENTED,l=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,w,_,c;y("inherits")(k,e);var b=x.errorOrDestroy,u=["error","close","destroy","pause","resume"];function L(Q,ie,se){if(typeof Q.prependListener=="function")return Q.prependListener(ie,se);!Q._events||!Q._events[ie]?Q.on(ie,se):Array.isArray(Q._events[ie])?Q._events[ie].unshift(se):Q._events[ie]=[se,Q._events[ie]]}function T(Q,ie,se){S=S||y("./_stream_duplex"),Q=Q||{},typeof se!="boolean"&&(se=ie instanceof S),this.objectMode=!!Q.objectMode,se&&(this.objectMode=this.objectMode||!!Q.readableObjectMode),this.highWaterMark=v(this,Q,"readableHighWaterMark",se),this.buffer=new i,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Q.emitClose!==!1,this.autoDestroy=!!Q.autoDestroy,this.destroyed=!1,this.defaultEncoding=Q.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Q.encoding&&(w||(w=y("string_decoder/").StringDecoder),this.decoder=new w(Q.encoding),this.encoding=Q.encoding)}function k(Q){if(S=S||y("./_stream_duplex"),!(this instanceof k))return new k(Q);var ie=this instanceof S;this._readableState=new T(Q,this,ie),this.readable=!0,Q&&(typeof Q.read=="function"&&(this._read=Q.read),typeof Q.destroy=="function"&&(this._destroy=Q.destroy)),e.call(this)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ie){this._readableState&&(this._readableState.destroyed=ie)}}),k.prototype.destroy=x.destroy,k.prototype._undestroy=x.undestroy,k.prototype._destroy=function(Q,ie){ie(Q)},k.prototype.push=function(Q,ie){var se=this._readableState,ae;return se.objectMode?ae=!0:typeof Q=="string"&&(ie=ie||se.defaultEncoding,ie!==se.encoding&&(Q=a.from(Q,ie),ie=""),ae=!0),P(this,Q,ie,!1,ae)},k.prototype.unshift=function(Q){return P(this,Q,null,!0,!1)};function P(Q,ie,se,ae,oe){s("readableAddChunk",ie);var be=Q._readableState;if(ie===null)be.reading=!1,F(Q,be);else{var ce;if(oe||(ce=I(be,ie)),ce)b(Q,ce);else if(be.objectMode||ie&&ie.length>0)if(typeof ie!="string"&&!be.objectMode&&Object.getPrototypeOf(ie)!==a.prototype&&(ie=r(ie)),ae)be.endEmitted?b(Q,new l):z(Q,be,ie,!0);else if(be.ended)b(Q,new o);else{if(be.destroyed)return!1;be.reading=!1,be.decoder&&!se?(ie=be.decoder.write(ie),be.objectMode||ie.length!==0?z(Q,be,ie,!1):K(Q,be)):z(Q,be,ie,!1)}else ae||(be.reading=!1,K(Q,be))}return!be.ended&&(be.length<be.highWaterMark||be.length===0)}function z(Q,ie,se,ae){ie.flowing&&ie.length===0&&!ie.sync?(ie.awaitDrain=0,Q.emit("data",se)):(ie.length+=ie.objectMode?1:se.length,ae?ie.buffer.unshift(se):ie.buffer.push(se),ie.needReadable&&N(Q)),K(Q,ie)}function I(Q,ie){var se;return!t(ie)&&typeof ie!="string"&&ie!==void 0&&!Q.objectMode&&(se=new d("chunk",["string","Buffer","Uint8Array"],ie)),se}k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(Q){w||(w=y("string_decoder/").StringDecoder);var ie=new w(Q);this._readableState.decoder=ie,this._readableState.encoding=this._readableState.decoder.encoding;for(var se=this._readableState.buffer.head,ae="";se!==null;)ae+=ie.write(se.data),se=se.next;return this._readableState.buffer.clear(),ae!==""&&this._readableState.buffer.push(ae),this._readableState.length=ae.length,this};var D=1073741824;function R(Q){return Q>=D?Q=D:(Q--,Q|=Q>>>1,Q|=Q>>>2,Q|=Q>>>4,Q|=Q>>>8,Q|=Q>>>16,Q++),Q}function O(Q,ie){return Q<=0||ie.length===0&&ie.ended?0:ie.objectMode?1:Q!==Q?ie.flowing&&ie.length?ie.buffer.head.data.length:ie.length:(Q>ie.highWaterMark&&(ie.highWaterMark=R(Q)),Q<=ie.length?Q:ie.ended?ie.length:(ie.needReadable=!0,0))}k.prototype.read=function(Q){s("read",Q),Q=parseInt(Q,10);var ie=this._readableState,se=Q;if(Q!==0&&(ie.emittedReadable=!1),Q===0&&ie.needReadable&&((ie.highWaterMark!==0?ie.length>=ie.highWaterMark:ie.length>0)||ie.ended))return s("read: emitReadable",ie.length,ie.ended),ie.length===0&&ie.ended?$(this):N(this),null;if(Q=O(Q,ie),Q===0&&ie.ended)return ie.length===0&&$(this),null;var ae=ie.needReadable;s("need readable",ae),(ie.length===0||ie.length-Q<ie.highWaterMark)&&(ae=!0,s("length less than watermark",ae)),ie.ended||ie.reading?(ae=!1,s("reading or ended",ae)):ae&&(s("do read"),ie.reading=!0,ie.sync=!0,ie.length===0&&(ie.needReadable=!0),this._read(ie.highWaterMark),ie.sync=!1,ie.reading||(Q=O(se,ie)));var oe;return Q>0?oe=U(Q,ie):oe=null,oe===null?(ie.needReadable=ie.length<=ie.highWaterMark,Q=0):(ie.length-=Q,ie.awaitDrain=0),ie.length===0&&(ie.ended||(ie.needReadable=!0),se!==Q&&ie.ended&&$(this)),oe!==null&&this.emit("data",oe),oe};function F(Q,ie){if(s("onEofChunk"),!ie.ended){if(ie.decoder){var se=ie.decoder.end();se&&se.length&&(ie.buffer.push(se),ie.length+=ie.objectMode?1:se.length)}ie.ended=!0,ie.sync?N(Q):(ie.needReadable=!1,ie.emittedReadable||(ie.emittedReadable=!0,G(Q)))}}function N(Q){var ie=Q._readableState;s("emitReadable",ie.needReadable,ie.emittedReadable),ie.needReadable=!1,ie.emittedReadable||(s("emitReadable",ie.flowing),ie.emittedReadable=!0,A.nextTick(G,Q))}function G(Q){var ie=Q._readableState;s("emitReadable_",ie.destroyed,ie.length,ie.ended),!ie.destroyed&&(ie.length||ie.ended)&&(Q.emit("readable"),ie.emittedReadable=!1),ie.needReadable=!ie.flowing&&!ie.ended&&ie.length<=ie.highWaterMark,H(Q)}function K(Q,ie){ie.readingMore||(ie.readingMore=!0,A.nextTick(W,Q,ie))}function W(Q,ie){for(;!ie.reading&&!ie.ended&&(ie.length<ie.highWaterMark||ie.flowing&&ie.length===0);){var se=ie.length;if(s("maybeReadMore read 0"),Q.read(0),se===ie.length)break}ie.readingMore=!1}k.prototype._read=function(Q){b(this,new m("_read()"))},k.prototype.pipe=function(Q,ie){var se=this,ae=this._readableState;switch(ae.pipesCount){case 0:ae.pipes=Q;break;case 1:ae.pipes=[ae.pipes,Q];break;default:ae.pipes.push(Q);break}ae.pipesCount+=1,s("pipe count=%d opts=%j",ae.pipesCount,ie);var oe=(!ie||ie.end!==!1)&&Q!==A.stdout&&Q!==A.stderr,be=oe?de:ke;ae.endEmitted?A.nextTick(be):se.once("end",be),Q.on("unpipe",ce);function ce(Xe,Ve){s("onunpipe"),Xe===se&&Ve&&Ve.hasUnpiped===!1&&(Ve.hasUnpiped=!0,me())}function de(){s("onend"),Q.end()}var ye=Y(se);Q.on("drain",ye);var ge=!1;function me(){s("cleanup"),Q.removeListener("close",Ue),Q.removeListener("finish",we),Q.removeListener("drain",ye),Q.removeListener("error",Pe),Q.removeListener("unpipe",ce),se.removeListener("end",de),se.removeListener("end",ke),se.removeListener("data",Ee),ge=!0,ae.awaitDrain&&(!Q._writableState||Q._writableState.needDrain)&&ye()}se.on("data",Ee);function Ee(Xe){s("ondata");var Ve=Q.write(Xe);s("dest.write",Ve),Ve===!1&&((ae.pipesCount===1&&ae.pipes===Q||ae.pipesCount>1&&X(ae.pipes,Q)!==-1)&&!ge&&(s("false write response, pause",ae.awaitDrain),ae.awaitDrain++),se.pause())}function Pe(Xe){s("onerror",Xe),ke(),Q.removeListener("error",Pe),M(Q,"error")===0&&b(Q,Xe)}L(Q,"error",Pe);function Ue(){Q.removeListener("finish",we),ke()}Q.once("close",Ue);function we(){s("onfinish"),Q.removeListener("close",Ue),ke()}Q.once("finish",we);function ke(){s("unpipe"),se.unpipe(Q)}return Q.emit("pipe",se),ae.flowing||(s("pipe resume"),se.resume()),Q};function Y(Q){return function(){var se=Q._readableState;s("pipeOnDrain",se.awaitDrain),se.awaitDrain&&se.awaitDrain--,se.awaitDrain===0&&M(Q,"data")&&(se.flowing=!0,H(Q))}}k.prototype.unpipe=function(Q){var ie=this._readableState,se={hasUnpiped:!1};if(ie.pipesCount===0)return this;if(ie.pipesCount===1)return Q&&Q!==ie.pipes?this:(Q||(Q=ie.pipes),ie.pipes=null,ie.pipesCount=0,ie.flowing=!1,Q&&Q.emit("unpipe",this,se),this);if(!Q){var ae=ie.pipes,oe=ie.pipesCount;ie.pipes=null,ie.pipesCount=0,ie.flowing=!1;for(var be=0;be<oe;be++)ae[be].emit("unpipe",this,{hasUnpiped:!1});return this}var ce=X(ie.pipes,Q);return ce===-1?this:(ie.pipes.splice(ce,1),ie.pipesCount-=1,ie.pipesCount===1&&(ie.pipes=ie.pipes[0]),Q.emit("unpipe",this,se),this)},k.prototype.on=function(Q,ie){var se=e.prototype.on.call(this,Q,ie),ae=this._readableState;return Q==="data"?(ae.readableListening=this.listenerCount("readable")>0,ae.flowing!==!1&&this.resume()):Q==="readable"&&!ae.endEmitted&&!ae.readableListening&&(ae.readableListening=ae.needReadable=!0,ae.flowing=!1,ae.emittedReadable=!1,s("on readable",ae.length,ae.reading),ae.length?N(this):ae.reading||A.nextTick(ue,this)),se},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(Q,ie){var se=e.prototype.removeListener.call(this,Q,ie);return Q==="readable"&&A.nextTick(re,this),se},k.prototype.removeAllListeners=function(Q){var ie=e.prototype.removeAllListeners.apply(this,arguments);return(Q==="readable"||Q===void 0)&&A.nextTick(re,this),ie};function re(Q){var ie=Q._readableState;ie.readableListening=Q.listenerCount("readable")>0,ie.resumeScheduled&&!ie.paused?ie.flowing=!0:Q.listenerCount("data")>0&&Q.resume()}function ue(Q){s("readable nexttick read 0"),Q.read(0)}k.prototype.resume=function(){var Q=this._readableState;return Q.flowing||(s("resume"),Q.flowing=!Q.readableListening,j(this,Q)),Q.paused=!1,this};function j(Q,ie){ie.resumeScheduled||(ie.resumeScheduled=!0,A.nextTick(q,Q,ie))}function q(Q,ie){s("resume",ie.reading),ie.reading||Q.read(0),ie.resumeScheduled=!1,Q.emit("resume"),H(Q),ie.flowing&&!ie.reading&&Q.read(0)}k.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function H(Q){var ie=Q._readableState;for(s("flow",ie.flowing);ie.flowing&&Q.read()!==null;);}k.prototype.wrap=function(Q){var ie=this,se=this._readableState,ae=!1;Q.on("end",function(){if(s("wrapped end"),se.decoder&&!se.ended){var ce=se.decoder.end();ce&&ce.length&&ie.push(ce)}ie.push(null)}),Q.on("data",function(ce){if(s("wrapped data"),se.decoder&&(ce=se.decoder.write(ce)),!(se.objectMode&&ce==null)&&!(!se.objectMode&&(!ce||!ce.length))){var de=ie.push(ce);de||(ae=!0,Q.pause())}});for(var oe in Q)this[oe]===void 0&&typeof Q[oe]=="function"&&(this[oe]=function(de){return function(){return Q[de].apply(Q,arguments)}}(oe));for(var be=0;be<u.length;be++)Q.on(u[be],this.emit.bind(this,u[be]));return this._read=function(ce){s("wrapped _read",ce),ae&&(ae=!1,Q.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return _===void 0&&(_=y("./internal/streams/async_iterator")),_(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ie){this._readableState&&(this._readableState.flowing=ie)}}),k._fromList=U,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function U(Q,ie){if(ie.length===0)return null;var se;return ie.objectMode?se=ie.buffer.shift():!Q||Q>=ie.length?(ie.decoder?se=ie.buffer.join(""):ie.buffer.length===1?se=ie.buffer.first():se=ie.buffer.concat(ie.length),ie.buffer.clear()):se=ie.buffer.consume(Q,ie.decoder),se}function $(Q){var ie=Q._readableState;s("endReadable",ie.endEmitted),ie.endEmitted||(ie.ended=!0,A.nextTick(ne,ie,Q))}function ne(Q,ie){if(s("endReadableNT",Q.endEmitted,Q.length),!Q.endEmitted&&Q.length===0&&(Q.endEmitted=!0,ie.readable=!1,ie.emit("end"),Q.autoDestroy)){var se=ie._writableState;(!se||se.autoDestroy&&se.finished)&&ie.destroy()}}typeof Symbol=="function"&&(k.from=function(Q,ie){return c===void 0&&(c=y("./internal/streams/from")),c(k,Q,ie)});function X(Q,ie){for(var se=0,ae=Q.length;se<ae;se++)if(Q[se]===ie)return se;return-1}}).call(this)}).call(this,y("_process"),typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(y,ee,te){ee.exports=r;var A=y("../errors").codes,g=A.ERR_METHOD_NOT_IMPLEMENTED,S=A.ERR_MULTIPLE_CALLBACK,M=A.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=A.ERR_TRANSFORM_WITH_LENGTH_0,a=y("./_stream_duplex");y("inherits")(r,a);function n(s,i){var x=this._transformState;x.transforming=!1;var p=x.writecb;if(p===null)return this.emit("error",new S);x.writechunk=null,x.writecb=null,i!=null&&this.push(i),p(s);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function r(s){if(!(this instanceof r))return new r(s);a.call(this,s),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,s&&(typeof s.transform=="function"&&(this._transform=s.transform),typeof s.flush=="function"&&(this._flush=s.flush)),this.on("prefinish",t)}function t(){var s=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(i,x){h(s,i,x)}):h(this,null,null)}r.prototype.push=function(s,i){return this._transformState.needTransform=!1,a.prototype.push.call(this,s,i)},r.prototype._transform=function(s,i,x){x(new g("_transform()"))},r.prototype._write=function(s,i,x){var p=this._transformState;if(p.writecb=x,p.writechunk=s,p.writeencoding=i,!p.transforming){var v=this._readableState;(p.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},r.prototype._read=function(s){var i=this._transformState;i.writechunk!==null&&!i.transforming?(i.transforming=!0,this._transform(i.writechunk,i.writeencoding,i.afterTransform)):i.needTransform=!0},r.prototype._destroy=function(s,i){a.prototype._destroy.call(this,s,function(x){i(x)})};function h(s,i,x){if(i)return s.emit("error",i);if(x!=null&&s.push(x),s._writableState.length)throw new e;if(s._transformState.transforming)throw new M;return s.push(null)}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(y,ee,te){(function(A,g){(function(){ee.exports=T;function S(H){var U=this;this.next=null,this.entry=null,this.finish=function(){q(U,H)}}var M;T.WritableState=u;var e={deprecate:y("util-deprecate")},a=y("./internal/streams/stream"),n=y("buffer").Buffer,r=g.Uint8Array||function(){};function t(H){return n.from(H)}function h(H){return n.isBuffer(H)||H instanceof r}var s=y("./internal/streams/destroy"),i=y("./internal/streams/state"),x=i.getHighWaterMark,p=y("../errors").codes,v=p.ERR_INVALID_ARG_TYPE,f=p.ERR_METHOD_NOT_IMPLEMENTED,d=p.ERR_MULTIPLE_CALLBACK,o=p.ERR_STREAM_CANNOT_PIPE,m=p.ERR_STREAM_DESTROYED,l=p.ERR_STREAM_NULL_VALUES,w=p.ERR_STREAM_WRITE_AFTER_END,_=p.ERR_UNKNOWN_ENCODING,c=s.errorOrDestroy;y("inherits")(T,a);function b(){}function u(H,U,$){M=M||y("./_stream_duplex"),H=H||{},typeof $!="boolean"&&($=U instanceof M),this.objectMode=!!H.objectMode,$&&(this.objectMode=this.objectMode||!!H.writableObjectMode),this.highWaterMark=x(this,H,"writableHighWaterMark",$),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ne=H.decodeStrings===!1;this.decodeStrings=!ne,this.defaultEncoding=H.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(X){F(U,X)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=H.emitClose!==!1,this.autoDestroy=!!H.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new S(this)}u.prototype.getBuffer=function(){for(var U=this.bufferedRequest,$=[];U;)$.push(U),U=U.next;return $},function(){try{Object.defineProperty(u.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var L;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(U){return L.call(this,U)?!0:this!==T?!1:U&&U._writableState instanceof u}})):L=function(U){return U instanceof this};function T(H){M=M||y("./_stream_duplex");var U=this instanceof M;if(!U&&!L.call(T,this))return new T(H);this._writableState=new u(H,this,U),this.writable=!0,H&&(typeof H.write=="function"&&(this._write=H.write),typeof H.writev=="function"&&(this._writev=H.writev),typeof H.destroy=="function"&&(this._destroy=H.destroy),typeof H.final=="function"&&(this._final=H.final)),a.call(this)}T.prototype.pipe=function(){c(this,new o)};function k(H,U){var $=new w;c(H,$),A.nextTick(U,$)}function P(H,U,$,ne){var X;return $===null?X=new l:typeof $!="string"&&!U.objectMode&&(X=new v("chunk",["string","Buffer"],$)),X?(c(H,X),A.nextTick(ne,X),!1):!0}T.prototype.write=function(H,U,$){var ne=this._writableState,X=!1,Q=!ne.objectMode&&h(H);return Q&&!n.isBuffer(H)&&(H=t(H)),typeof U=="function"&&($=U,U=null),Q?U="buffer":U||(U=ne.defaultEncoding),typeof $!="function"&&($=b),ne.ending?k(this,$):(Q||P(this,ne,H,$))&&(ne.pendingcb++,X=I(this,ne,Q,H,U,$)),X},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var H=this._writableState;H.corked&&(H.corked--,!H.writing&&!H.corked&&!H.bufferProcessing&&H.bufferedRequest&&K(this,H))},T.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new _(U);return this._writableState.defaultEncoding=U,this},Object.defineProperty(T.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function z(H,U,$){return!H.objectMode&&H.decodeStrings!==!1&&typeof U=="string"&&(U=n.from(U,$)),U}Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function I(H,U,$,ne,X,Q){if(!$){var ie=z(U,ne,X);ne!==ie&&($=!0,X="buffer",ne=ie)}var se=U.objectMode?1:ne.length;U.length+=se;var ae=U.length<U.highWaterMark;if(ae||(U.needDrain=!0),U.writing||U.corked){var oe=U.lastBufferedRequest;U.lastBufferedRequest={chunk:ne,encoding:X,isBuf:$,callback:Q,next:null},oe?oe.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else D(H,U,!1,se,ne,X,Q);return ae}function D(H,U,$,ne,X,Q,ie){U.writelen=ne,U.writecb=ie,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new m("write")):$?H._writev(X,U.onwrite):H._write(X,Q,U.onwrite),U.sync=!1}function R(H,U,$,ne,X){--U.pendingcb,$?(A.nextTick(X,ne),A.nextTick(ue,H,U),H._writableState.errorEmitted=!0,c(H,ne)):(X(ne),H._writableState.errorEmitted=!0,c(H,ne),ue(H,U))}function O(H){H.writing=!1,H.writecb=null,H.length-=H.writelen,H.writelen=0}function F(H,U){var $=H._writableState,ne=$.sync,X=$.writecb;if(typeof X!="function")throw new d;if(O($),U)R(H,$,ne,U,X);else{var Q=W($)||H.destroyed;!Q&&!$.corked&&!$.bufferProcessing&&$.bufferedRequest&&K(H,$),ne?A.nextTick(N,H,$,Q,X):N(H,$,Q,X)}}function N(H,U,$,ne){$||G(H,U),U.pendingcb--,ne(),ue(H,U)}function G(H,U){U.length===0&&U.needDrain&&(U.needDrain=!1,H.emit("drain"))}function K(H,U){U.bufferProcessing=!0;var $=U.bufferedRequest;if(H._writev&&$&&$.next){var ne=U.bufferedRequestCount,X=new Array(ne),Q=U.corkedRequestsFree;Q.entry=$;for(var ie=0,se=!0;$;)X[ie]=$,$.isBuf||(se=!1),$=$.next,ie+=1;X.allBuffers=se,D(H,U,!0,U.length,X,"",Q.finish),U.pendingcb++,U.lastBufferedRequest=null,Q.next?(U.corkedRequestsFree=Q.next,Q.next=null):U.corkedRequestsFree=new S(U),U.bufferedRequestCount=0}else{for(;$;){var ae=$.chunk,oe=$.encoding,be=$.callback,ce=U.objectMode?1:ae.length;if(D(H,U,!1,ce,ae,oe,be),$=$.next,U.bufferedRequestCount--,U.writing)break}$===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=$,U.bufferProcessing=!1}T.prototype._write=function(H,U,$){$(new f("_write()"))},T.prototype._writev=null,T.prototype.end=function(H,U,$){var ne=this._writableState;return typeof H=="function"?($=H,H=null,U=null):typeof U=="function"&&($=U,U=null),H!=null&&this.write(H,U),ne.corked&&(ne.corked=1,this.uncork()),ne.ending||j(this,ne,$),this},Object.defineProperty(T.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function W(H){return H.ending&&H.length===0&&H.bufferedRequest===null&&!H.finished&&!H.writing}function Y(H,U){H._final(function($){U.pendingcb--,$&&c(H,$),U.prefinished=!0,H.emit("prefinish"),ue(H,U)})}function re(H,U){!U.prefinished&&!U.finalCalled&&(typeof H._final=="function"&&!U.destroyed?(U.pendingcb++,U.finalCalled=!0,A.nextTick(Y,H,U)):(U.prefinished=!0,H.emit("prefinish")))}function ue(H,U){var $=W(U);if($&&(re(H,U),U.pendingcb===0&&(U.finished=!0,H.emit("finish"),U.autoDestroy))){var ne=H._readableState;(!ne||ne.autoDestroy&&ne.endEmitted)&&H.destroy()}return $}function j(H,U,$){U.ending=!0,ue(H,U),$&&(U.finished?A.nextTick($):H.once("finish",$)),U.ended=!0,H.writable=!1}function q(H,U,$){var ne=H.entry;for(H.entry=null;ne;){var X=ne.callback;U.pendingcb--,X($),ne=ne.next}U.corkedRequestsFree.next=H}Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(U){this._writableState&&(this._writableState.destroyed=U)}}),T.prototype.destroy=s.destroy,T.prototype._undestroy=s.undestroy,T.prototype._destroy=function(H,U){U(H)}}).call(this)}).call(this,y("_process"),typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(y,ee,te){(function(A){(function(){var g;function S(m,l,w){return l in m?Object.defineProperty(m,l,{value:w,enumerable:!0,configurable:!0,writable:!0}):m[l]=w,m}var M=y("./end-of-stream"),e=Symbol("lastResolve"),a=Symbol("lastReject"),n=Symbol("error"),r=Symbol("ended"),t=Symbol("lastPromise"),h=Symbol("handlePromise"),s=Symbol("stream");function i(m,l){return{value:m,done:l}}function x(m){var l=m[e];if(l!==null){var w=m[s].read();w!==null&&(m[t]=null,m[e]=null,m[a]=null,l(i(w,!1)))}}function p(m){A.nextTick(x,m)}function v(m,l){return function(w,_){m.then(function(){if(l[r]){w(i(void 0,!0));return}l[h](w,_)},_)}}var f=Object.getPrototypeOf(function(){}),d=Object.setPrototypeOf((g={get stream(){return this[s]},next:function(){var l=this,w=this[n];if(w!==null)return Promise.reject(w);if(this[r])return Promise.resolve(i(void 0,!0));if(this[s].destroyed)return new Promise(function(u,L){A.nextTick(function(){l[n]?L(l[n]):u(i(void 0,!0))})});var _=this[t],c;if(_)c=new Promise(v(_,this));else{var b=this[s].read();if(b!==null)return Promise.resolve(i(b,!1));c=new Promise(this[h])}return this[t]=c,c}},S(g,Symbol.asyncIterator,function(){return this}),S(g,"return",function(){var l=this;return new Promise(function(w,_){l[s].destroy(null,function(c){if(c){_(c);return}w(i(void 0,!0))})})}),g),f),o=function(l){var w,_=Object.create(d,(w={},S(w,s,{value:l,writable:!0}),S(w,e,{value:null,writable:!0}),S(w,a,{value:null,writable:!0}),S(w,n,{value:null,writable:!0}),S(w,r,{value:l._readableState.endEmitted,writable:!0}),S(w,h,{value:function(b,u){var L=_[s].read();L?(_[t]=null,_[e]=null,_[a]=null,b(i(L,!1))):(_[e]=b,_[a]=u)},writable:!0}),w));return _[t]=null,M(l,function(c){if(c&&c.code!=="ERR_STREAM_PREMATURE_CLOSE"){var b=_[a];b!==null&&(_[t]=null,_[e]=null,_[a]=null,b(c)),_[n]=c;return}var u=_[e];u!==null&&(_[t]=null,_[e]=null,_[a]=null,u(i(void 0,!0))),_[r]=!0}),l.on("readable",p.bind(null,_)),_};ee.exports=o}).call(this)}).call(this,y("_process"))},{"./end-of-stream":296,_process:278}],294:[function(y,ee,te){function A(x,p){var v=Object.keys(x);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(x);p&&(f=f.filter(function(d){return Object.getOwnPropertyDescriptor(x,d).enumerable})),v.push.apply(v,f)}return v}function g(x){for(var p=1;p<arguments.length;p++){var v=arguments[p]!=null?arguments[p]:{};p%2?A(Object(v),!0).forEach(function(f){S(x,f,v[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(v)):A(Object(v)).forEach(function(f){Object.defineProperty(x,f,Object.getOwnPropertyDescriptor(v,f))})}return x}function S(x,p,v){return p in x?Object.defineProperty(x,p,{value:v,enumerable:!0,configurable:!0,writable:!0}):x[p]=v,x}function M(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function e(x,p){for(var v=0;v<p.length;v++){var f=p[v];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(x,f.key,f)}}function a(x,p,v){return p&&e(x.prototype,p),v&&e(x,v),x}var n=y("buffer"),r=n.Buffer,t=y("util"),h=t.inspect,s=h&&h.custom||"inspect";function i(x,p,v){r.prototype.copy.call(x,p,v)}ee.exports=function(){function x(){M(this,x),this.head=null,this.tail=null,this.length=0}return a(x,[{key:"push",value:function(v){var f={data:v,next:null};this.length>0?this.tail.next=f:this.head=f,this.tail=f,++this.length}},{key:"unshift",value:function(v){var f={data:v,next:this.head};this.length===0&&(this.tail=f),this.head=f,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var f=this.head,d=""+f.data;f=f.next;)d+=v+f.data;return d}},{key:"concat",value:function(v){if(this.length===0)return r.alloc(0);for(var f=r.allocUnsafe(v>>>0),d=this.head,o=0;d;)i(d.data,f,o),o+=d.data.length,d=d.next;return f}},{key:"consume",value:function(v,f){var d;return v<this.head.data.length?(d=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):v===this.head.data.length?d=this.shift():d=f?this._getString(v):this._getBuffer(v),d}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var f=this.head,d=1,o=f.data;for(v-=o.length;f=f.next;){var m=f.data,l=v>m.length?m.length:v;if(l===m.length?o+=m:o+=m.slice(0,v),v-=l,v===0){l===m.length?(++d,f.next?this.head=f.next:this.head=this.tail=null):(this.head=f,f.data=m.slice(l));break}++d}return this.length-=d,o}},{key:"_getBuffer",value:function(v){var f=r.allocUnsafe(v),d=this.head,o=1;for(d.data.copy(f),v-=d.data.length;d=d.next;){var m=d.data,l=v>m.length?m.length:v;if(m.copy(f,f.length-v,0,l),v-=l,v===0){l===m.length?(++o,d.next?this.head=d.next:this.head=this.tail=null):(this.head=d,d.data=m.slice(l));break}++o}return this.length-=o,f}},{key:s,value:function(v,f){return h(this,g({},f,{depth:0,customInspect:!1}))}}]),x}()},{buffer:85,util:83}],295:[function(y,ee,te){(function(A){(function(){function g(r,t){var h=this,s=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return s||i?(t?t(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,A.nextTick(a,this,r)):A.nextTick(a,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(x){!t&&x?h._writableState?h._writableState.errorEmitted?A.nextTick(M,h):(h._writableState.errorEmitted=!0,A.nextTick(S,h,x)):A.nextTick(S,h,x):t?(A.nextTick(M,h),t(x)):A.nextTick(M,h)}),this)}function S(r,t){a(r,t),M(r)}function M(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(r,t){r.emit("error",t)}function n(r,t){var h=r._readableState,s=r._writableState;h&&h.autoDestroy||s&&s.autoDestroy?r.destroy(t):r.emit("error",t)}ee.exports={destroy:g,undestroy:e,errorOrDestroy:n}}).call(this)}).call(this,y("_process"))},{_process:278}],296:[function(y,ee,te){var A=y("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function g(a){var n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,t=new Array(r),h=0;h<r;h++)t[h]=arguments[h];a.apply(this,t)}}}function S(){}function M(a){return a.setHeader&&typeof a.abort=="function"}function e(a,n,r){if(typeof n=="function")return e(a,null,n);n||(n={}),r=g(r||S);var t=n.readable||n.readable!==!1&&a.readable,h=n.writable||n.writable!==!1&&a.writable,s=function(){a.writable||x()},i=a._writableState&&a._writableState.finished,x=function(){h=!1,i=!0,t||r.call(a)},p=a._readableState&&a._readableState.endEmitted,v=function(){t=!1,p=!0,h||r.call(a)},f=function(l){r.call(a,l)},d=function(){var l;if(t&&!p)return(!a._readableState||!a._readableState.ended)&&(l=new A),r.call(a,l);if(h&&!i)return(!a._writableState||!a._writableState.ended)&&(l=new A),r.call(a,l)},o=function(){a.req.on("finish",x)};return M(a)?(a.on("complete",x),a.on("abort",d),a.req?o():a.on("request",o)):h&&!a._writableState&&(a.on("end",s),a.on("close",s)),a.on("end",v),a.on("finish",x),n.error!==!1&&a.on("error",f),a.on("close",d),function(){a.removeListener("complete",x),a.removeListener("abort",d),a.removeListener("request",o),a.req&&a.req.removeListener("finish",x),a.removeListener("end",s),a.removeListener("close",s),a.removeListener("finish",x),a.removeListener("end",v),a.removeListener("error",f),a.removeListener("close",d)}}ee.exports=e},{"../../../errors":287}],297:[function(y,ee,te){ee.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(y,ee,te){var A;function g(x){var p=!1;return function(){p||(p=!0,x.apply(void 0,arguments))}}var S=y("../../../errors").codes,M=S.ERR_MISSING_ARGS,e=S.ERR_STREAM_DESTROYED;function a(x){if(x)throw x}function n(x){return x.setHeader&&typeof x.abort=="function"}function r(x,p,v,f){f=g(f);var d=!1;x.on("close",function(){d=!0}),A===void 0&&(A=y("./end-of-stream")),A(x,{readable:p,writable:v},function(m){if(m)return f(m);d=!0,f()});var o=!1;return function(m){if(!d&&!o){if(o=!0,n(x))return x.abort();if(typeof x.destroy=="function")return x.destroy();f(m||new e("pipe"))}}}function t(x){x()}function h(x,p){return x.pipe(p)}function s(x){return!x.length||typeof x[x.length-1]!="function"?a:x.pop()}function i(){for(var x=arguments.length,p=new Array(x),v=0;v<x;v++)p[v]=arguments[v];var f=s(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new M("streams");var d,o=p.map(function(m,l){var w=l<p.length-1,_=l>0;return r(m,w,_,function(c){d||(d=c),c&&o.forEach(t),!w&&(o.forEach(t),f(d))})});return p.reduce(h)}ee.exports=i},{"../../../errors":287,"./end-of-stream":296}],299:[function(y,ee,te){var A=y("../../../errors").codes.ERR_INVALID_OPT_VALUE;function g(M,e,a){return M.highWaterMark!=null?M.highWaterMark:e?M[a]:null}function S(M,e,a,n){var r=g(e,n,a);if(r!=null){if(!(isFinite(r)&&Math.floor(r)===r)||r<0){var t=n?a:"highWaterMark";throw new A(t,r)}return Math.floor(r)}return M.objectMode?16:16*1024}ee.exports={getHighWaterMark:S}},{"../../../errors":287}],300:[function(y,ee,te){ee.exports=y("events").EventEmitter},{events:84}],301:[function(y,ee,te){var A=y("safe-buffer").Buffer,g=A.isEncoding||function(o){switch(o=""+o,o&&o.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function S(o){if(!o)return"utf8";for(var m;;)switch(o){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return o;default:if(m)return;o=(""+o).toLowerCase(),m=!0}}function M(o){var m=S(o);if(typeof m!="string"&&(A.isEncoding===g||!g(o)))throw new Error("Unknown encoding: "+o);return m||o}te.StringDecoder=e;function e(o){this.encoding=M(o);var m;switch(this.encoding){case"utf16le":this.text=i,this.end=x,m=4;break;case"utf8":this.fillLast=t,m=4;break;case"base64":this.text=p,this.end=v,m=3;break;default:this.write=f,this.end=d;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=A.allocUnsafe(m)}e.prototype.write=function(o){if(o.length===0)return"";var m,l;if(this.lastNeed){if(m=this.fillLast(o),m===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<o.length?m?m+this.text(o,l):this.text(o,l):m||""},e.prototype.end=s,e.prototype.text=h,e.prototype.fillLast=function(o){if(this.lastNeed<=o.length)return o.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);o.copy(this.lastChar,this.lastTotal-this.lastNeed,0,o.length),this.lastNeed-=o.length};function a(o){return o<=127?0:o>>5===6?2:o>>4===14?3:o>>3===30?4:o>>6===2?-1:-2}function n(o,m,l){var w=m.length-1;if(w<l)return 0;var _=a(m[w]);return _>=0?(_>0&&(o.lastNeed=_-1),_):--w<l||_===-2?0:(_=a(m[w]),_>=0?(_>0&&(o.lastNeed=_-2),_):--w<l||_===-2?0:(_=a(m[w]),_>=0?(_>0&&(_===2?_=0:o.lastNeed=_-3),_):0))}function r(o,m,l){if((m[0]&192)!==128)return o.lastNeed=0,"";if(o.lastNeed>1&&m.length>1){if((m[1]&192)!==128)return o.lastNeed=1,"";if(o.lastNeed>2&&m.length>2&&(m[2]&192)!==128)return o.lastNeed=2,""}}function t(o){var m=this.lastTotal-this.lastNeed,l=r(this,o);if(l!==void 0)return l;if(this.lastNeed<=o.length)return o.copy(this.lastChar,m,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);o.copy(this.lastChar,m,0,o.length),this.lastNeed-=o.length}function h(o,m){var l=n(this,o,m);if(!this.lastNeed)return o.toString("utf8",m);this.lastTotal=l;var w=o.length-(l-this.lastNeed);return o.copy(this.lastChar,0,w),o.toString("utf8",m,w)}function s(o){var m=o&&o.length?this.write(o):"";return this.lastNeed?m+"":m}function i(o,m){if((o.length-m)%2===0){var l=o.toString("utf16le",m);if(l){var w=l.charCodeAt(l.length-1);if(w>=55296&&w<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=o[o.length-1],o.toString("utf16le",m,o.length-1)}function x(o){var m=o&&o.length?this.write(o):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return m+this.lastChar.toString("utf16le",0,l)}return m}function p(o,m){var l=(o.length-m)%3;return l===0?o.toString("base64",m):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=o[o.length-1]:(this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1]),o.toString("base64",m,o.length-l))}function v(o){var m=o&&o.length?this.write(o):"";return this.lastNeed?m+this.lastChar.toString("base64",0,3-this.lastNeed):m}function f(o){return o.toString(this.encoding)}function d(o){return o&&o.length?this.write(o):""}},{"safe-buffer":285}],302:[function(y,ee,te){(function(A,g){(function(){var S=y("assert"),M=y("debug")("stream-parser");ee.exports=t;var e=-1,a=0,n=1,r=2;function t(l){var w=l&&typeof l._transform=="function",_=l&&typeof l._write=="function";if(!w&&!_)throw new Error("must pass a Writable or Transform stream in");M("extending Parser into stream"),l._bytes=s,l._skipBytes=i,w&&(l._passthrough=x),w?l._transform=v:l._write=p}function h(l){M("initializing parser stream"),l._parserBytesLeft=0,l._parserBuffers=[],l._parserBuffered=0,l._parserState=e,l._parserCallback=null,typeof l.push=="function"&&(l._parserOutput=l.push.bind(l)),l._parserInit=!0}function s(l,w){S(!this._parserCallback,'there is already a "callback" set!'),S(isFinite(l)&&l>0,'can only buffer a finite number of bytes > 0, got "'+l+'"'),this._parserInit||h(this),M("buffering %o bytes",l),this._parserBytesLeft=l,this._parserCallback=w,this._parserState=a}function i(l,w){S(!this._parserCallback,'there is already a "callback" set!'),S(l>0,'can only skip > 0 bytes, got "'+l+'"'),this._parserInit||h(this),M("skipping %o bytes",l),this._parserBytesLeft=l,this._parserCallback=w,this._parserState=n}function x(l,w){S(!this._parserCallback,'There is already a "callback" set!'),S(l>0,'can only pass through > 0 bytes, got "'+l+'"'),this._parserInit||h(this),M("passing through %o bytes",l),this._parserBytesLeft=l,this._parserCallback=w,this._parserState=r}function p(l,w,_){this._parserInit||h(this),M("write(%o bytes)",l.length),typeof w=="function"&&(_=w),o(this,l,null,_)}function v(l,w,_){this._parserInit||h(this),M("transform(%o bytes)",l.length),typeof w!="function"&&(w=this._parserOutput),o(this,l,w,_)}function f(l,w,_,c){return l._parserBytesLeft<=0?c(new Error("got data but not currently parsing anything")):w.length<=l._parserBytesLeft?function(){return d(l,w,_,c)}:function(){var b=w.slice(0,l._parserBytesLeft);return d(l,b,_,function(u){if(u)return c(u);if(w.length>b.length)return function(){return f(l,w.slice(b.length),_,c)}})}}function d(l,w,_,c){if(l._parserBytesLeft-=w.length,M("%o bytes left for stream piece",l._parserBytesLeft),l._parserState===a?(l._parserBuffers.push(w),l._parserBuffered+=w.length):l._parserState===r&&_(w),l._parserBytesLeft===0){var b=l._parserCallback;if(b&&l._parserState===a&&l._parserBuffers.length>1&&(w=g.concat(l._parserBuffers,l._parserBuffered)),l._parserState!==a&&(w=null),l._parserCallback=null,l._parserBuffered=0,l._parserState=e,l._parserBuffers.splice(0),b){var u=[];w&&u.push(w),_&&u.push(_);var L=b.length>u.length;L&&u.push(m(c));var T=b.apply(l,u);if(!L||c===T)return c}}else return c}var o=m(f);function m(l){return function(){for(var w=l.apply(this,arguments);typeof w=="function";)w=w();return w}}}).call(this)}).call(this,y("_process"),y("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(y,ee,te){(function(A){(function(){te=ee.exports=y("./debug"),te.log=M,te.formatArgs=S,te.save=e,te.load=a,te.useColors=g,te.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:n(),te.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function g(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}te.formatters.j=function(r){try{return JSON.stringify(r)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}};function S(r){var t=this.useColors;if(r[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+r[0]+(t?"%c ":" ")+"+"+te.humanize(this.diff),!!t){var h="color: "+this.color;r.splice(1,0,h,"color: inherit");var s=0,i=0;r[0].replace(/%[a-zA-Z%]/g,function(x){x!=="%%"&&(s++,x==="%c"&&(i=s))}),r.splice(i,0,h)}}function M(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function e(r){try{r==null?te.storage.removeItem("debug"):te.storage.debug=r}catch{}}function a(){var r;try{r=te.storage.debug}catch{}return!r&&typeof A<"u"&&"env"in A&&(r={}.DEBUG),r}te.enable(a());function n(){try{return window.localStorage}catch{}}}).call(this)}).call(this,y("_process"))},{"./debug":304,_process:278}],304:[function(y,ee,te){te=ee.exports=S.debug=S.default=S,te.coerce=n,te.disable=e,te.enable=M,te.enabled=a,te.humanize=y("ms"),te.names=[],te.skips=[],te.formatters={};var A;function g(r){var t=0,h;for(h in r)t=(t<<5)-t+r.charCodeAt(h),t|=0;return te.colors[Math.abs(t)%te.colors.length]}function S(r){function t(){if(t.enabled){var h=t,s=+new Date,i=s-(A||s);h.diff=i,h.prev=A,h.curr=s,A=s;for(var x=new Array(arguments.length),p=0;p<x.length;p++)x[p]=arguments[p];x[0]=te.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");var v=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,function(d,o){if(d==="%%")return d;v++;var m=te.formatters[o];if(typeof m=="function"){var l=x[v];d=m.call(h,l),x.splice(v,1),v--}return d}),te.formatArgs.call(h,x);var f=t.log||te.log||console.log.bind(console);f.apply(h,x)}}return t.namespace=r,t.enabled=te.enabled(r),t.useColors=te.useColors(),t.color=g(r),typeof te.init=="function"&&te.init(t),t}function M(r){te.save(r),te.names=[],te.skips=[];for(var t=(typeof r=="string"?r:"").split(/[\s,]+/),h=t.length,s=0;s<h;s++)t[s]&&(r=t[s].replace(/\*/g,".*?"),r[0]==="-"?te.skips.push(new RegExp("^"+r.substr(1)+"$")):te.names.push(new RegExp("^"+r+"$")))}function e(){te.enable("")}function a(r){var t,h;for(t=0,h=te.skips.length;t<h;t++)if(te.skips[t].test(r))return!1;for(t=0,h=te.names.length;t<h;t++)if(te.names[t].test(r))return!0;return!1}function n(r){return r instanceof Error?r.stack||r.message:r}},{ms:305}],305:[function(y,ee,te){var A=1e3,g=A*60,S=g*60,M=S*24,e=M*365.25;ee.exports=function(h,s){s=s||{};var i=typeof h;if(i==="string"&&h.length>0)return a(h);if(i==="number"&&isNaN(h)===!1)return s.long?r(h):n(h);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(h))};function a(h){if(h=String(h),!(h.length>100)){var s=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(h);if(s){var i=parseFloat(s[1]),x=(s[2]||"ms").toLowerCase();switch(x){case"years":case"year":case"yrs":case"yr":case"y":return i*e;case"days":case"day":case"d":return i*M;case"hours":case"hour":case"hrs":case"hr":case"h":return i*S;case"minutes":case"minute":case"mins":case"min":case"m":return i*g;case"seconds":case"second":case"secs":case"sec":case"s":return i*A;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function n(h){return h>=M?Math.round(h/M)+"d":h>=S?Math.round(h/S)+"h":h>=g?Math.round(h/g)+"m":h>=A?Math.round(h/A)+"s":h+"ms"}function r(h){return t(h,M,"day")||t(h,S,"hour")||t(h,g,"minute")||t(h,A,"second")||h+" ms"}function t(h,s,i){if(!(h<s))return h<s*1.5?Math.floor(h/s)+" "+i:Math.ceil(h/s)+" "+i+"s"}},{}],306:[function(y,ee,te){var A=y("parenthesis");ee.exports=function(S,M,e){if(S==null)throw Error("First argument should be a string");if(M==null)throw Error("Separator should be a string or a RegExp");e?(typeof e=="string"||Array.isArray(e))&&(e={ignore:e}):e={},e.escape==null&&(e.escape=!0),e.ignore==null?e.ignore=["[]","()","{}","<>",'""',"''","``","",""]:(typeof e.ignore=="string"&&(e.ignore=[e.ignore]),e.ignore=e.ignore.map(function(x){return x.length===1&&(x=x+x),x}));var a=A.parse(S,{flat:!0,brackets:e.ignore}),n=a[0],r=n.split(M);if(e.escape){for(var t=[],h=0;h<r.length;h++){var s=r[h],i=r[h+1];s[s.length-1]==="\\"&&s[s.length-2]!=="\\"?(t.push(s+M+i),h++):t.push(s)}r=t}for(var h=0;h<r.length;h++)a[0]=r[h],r[h]=A.stringify(a,{flat:!0});return r}},{parenthesis:248}],307:[function(y,ee,te){ee.exports=A;function A(g){for(var S=g.length,M=new Array(S),e=new Array(S),a=new Array(S),n=new Array(S),r=new Array(S),t=new Array(S),h=0;h<S;++h)M[h]=-1,e[h]=0,a[h]=!1,n[h]=0,r[h]=-1,t[h]=[];var s=0,i=[],x=[];function p(o){var m=[o],l=[o];for(M[o]=e[o]=s,a[o]=!0,s+=1;l.length>0;){o=l[l.length-1];var w=g[o];if(n[o]<w.length){for(var _=n[o];_<w.length;++_){var c=w[_];if(M[c]<0){M[c]=e[c]=s,a[c]=!0,s+=1,m.push(c),l.push(c);break}else a[c]&&(e[o]=Math.min(e[o],e[c])|0);r[c]>=0&&t[o].push(r[c])}n[o]=_}else{if(e[o]===M[o]){for(var b=[],u=[],L=0,_=m.length-1;_>=0;--_){var T=m[_];if(a[T]=!1,b.push(T),u.push(t[T]),L+=t[T].length,r[T]=i.length,T===o){m.length=_;break}}i.push(b);for(var k=new Array(L),_=0;_<u.length;_++)for(var P=0;P<u[_].length;P++)k[--L]=u[_][P];x.push(k)}l.pop()}}}for(var h=0;h<S;++h)M[h]<0&&p(h);for(var v,h=0;h<x.length;h++){var f=x[h];if(f.length!==0){f.sort(function(m,l){return m-l}),v=[f[0]];for(var d=1;d<f.length;d++)f[d]!==f[d-1]&&v.push(f[d]);x[h]=v}}return{components:i,adjacencyList:x}}},{}],308:[function(y,ee,te){Object.defineProperty(te,"__esModule",{value:!0});var A=function(){function r(t,h){var s=[],i=!0,x=!1,p=void 0;try{for(var v=t[Symbol.iterator](),f;!(i=(f=v.next()).done)&&(s.push(f.value),!(h&&s.length===h));i=!0);}catch(d){x=!0,p=d}finally{try{!i&&v.return&&v.return()}finally{if(x)throw p}}return s}return function(t,h){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,h);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=Math.PI*2,S=function(t,h,s,i,x,p,v){var f=t.x,d=t.y;f*=h,d*=s;var o=i*f-x*d,m=x*f+i*d;return{x:o+p,y:m+v}},M=function(t,h){var s=h===1.5707963267948966?.551915024494:h===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(h/4),i=Math.cos(t),x=Math.sin(t),p=Math.cos(t+h),v=Math.sin(t+h);return[{x:i-x*s,y:x+i*s},{x:p+v*s,y:v-p*s},{x:p,y:v}]},e=function(t,h,s,i){var x=t*i-h*s<0?-1:1,p=t*s+h*i;return p>1&&(p=1),p<-1&&(p=-1),x*Math.acos(p)},a=function(t,h,s,i,x,p,v,f,d,o,m,l){var w=Math.pow(x,2),_=Math.pow(p,2),c=Math.pow(m,2),b=Math.pow(l,2),u=w*_-w*b-_*c;u<0&&(u=0),u/=w*b+_*c,u=Math.sqrt(u)*(v===f?-1:1);var L=u*x/p*l,T=u*-p/x*m,k=o*L-d*T+(t+s)/2,P=d*L+o*T+(h+i)/2,z=(m-L)/x,I=(l-T)/p,D=(-m-L)/x,R=(-l-T)/p,O=e(1,0,z,I),F=e(z,I,D,R);return f===0&&F>0&&(F-=g),f===1&&F<0&&(F+=g),[k,P,O,F]},n=function(t){var h=t.px,s=t.py,i=t.cx,x=t.cy,p=t.rx,v=t.ry,f=t.xAxisRotation,d=f===void 0?0:f,o=t.largeArcFlag,m=o===void 0?0:o,l=t.sweepFlag,w=l===void 0?0:l,_=[];if(p===0||v===0)return[];var c=Math.sin(d*g/360),b=Math.cos(d*g/360),u=b*(h-i)/2+c*(s-x)/2,L=-c*(h-i)/2+b*(s-x)/2;if(u===0&&L===0)return[];p=Math.abs(p),v=Math.abs(v);var T=Math.pow(u,2)/Math.pow(p,2)+Math.pow(L,2)/Math.pow(v,2);T>1&&(p*=Math.sqrt(T),v*=Math.sqrt(T));var k=a(h,s,i,x,p,v,m,w,c,b,u,L),P=A(k,4),z=P[0],I=P[1],D=P[2],R=P[3],O=Math.abs(R)/(g/4);Math.abs(1-O)<1e-7&&(O=1);var F=Math.max(Math.ceil(O),1);R/=F;for(var N=0;N<F;N++)_.push(M(D,R)),D+=R;return _.map(function(G){var K=S(G[0],p,v,b,c,z,I),W=K.x,Y=K.y,re=S(G[1],p,v,b,c,z,I),ue=re.x,j=re.y,q=S(G[2],p,v,b,c,z,I),H=q.x,U=q.y;return{x1:W,y1:Y,x2:ue,y2:j,x:H,y:U}})};te.default=n,ee.exports=te.default},{}],309:[function(y,ee,te){var A=y("parse-svg-path"),g=y("abs-svg-path"),S=y("normalize-svg-path"),M=y("is-svg-path"),e=y("assert");ee.exports=a;function a(n){if(Array.isArray(n)&&n.length===1&&typeof n[0]=="string"&&(n=n[0]),typeof n=="string"&&(e(M(n),"String is not an SVG path."),n=A(n)),e(Array.isArray(n),"Argument should be a string or an array of path segments."),n=g(n),n=S(n),!n.length)return[0,0,0,0];for(var r=[1/0,1/0,-1/0,-1/0],t=0,h=n.length;t<h;t++)for(var s=n[t].slice(1),i=0;i<s.length;i+=2)s[i+0]<r[0]&&(r[0]=s[i+0]),s[i+1]<r[1]&&(r[1]=s[i+1]),s[i+0]>r[2]&&(r[2]=s[i+0]),s[i+1]>r[3]&&(r[3]=s[i+1]);return r}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(y,ee,te){ee.exports=g;var A=y("svg-arc-to-cubic-bezier");function g(e){for(var a,n=[],r=0,t=0,h=0,s=0,i=null,x=null,p=0,v=0,f=0,d=e.length;f<d;f++){var o=e[f],m=o[0];switch(m){case"M":h=o[1],s=o[2];break;case"A":var l=A({px:p,py:v,cx:o[6],cy:o[7],rx:o[1],ry:o[2],xAxisRotation:o[3],largeArcFlag:o[4],sweepFlag:o[5]});if(!l.length)continue;for(var w=0,_;w<l.length;w++)_=l[w],o=["C",_.x1,_.y1,_.x2,_.y2,_.x,_.y],w<l.length-1&&n.push(o);break;case"S":var c=p,b=v;(a=="C"||a=="S")&&(c+=c-r,b+=b-t),o=["C",c,b,o[1],o[2],o[3],o[4]];break;case"T":a=="Q"||a=="T"?(i=p*2-i,x=v*2-x):(i=p,x=v),o=M(p,v,i,x,o[1],o[2]);break;case"Q":i=o[1],x=o[2],o=M(p,v,o[1],o[2],o[3],o[4]);break;case"L":o=S(p,v,o[1],o[2]);break;case"H":o=S(p,v,o[1],v);break;case"V":o=S(p,v,p,o[1]);break;case"Z":o=S(p,v,h,s);break}a=m,p=o[o.length-2],v=o[o.length-1],o.length>4?(r=o[o.length-4],t=o[o.length-3]):(r=p,t=v),n.push(o)}return n}function S(e,a,n,r){return["C",e,a,n,r,n,r]}function M(e,a,n,r,t,h){return["C",e/3+2/3*n,a/3+2/3*r,t/3+2/3*n,h/3+2/3*r,t,h]}},{"svg-arc-to-cubic-bezier":308}],311:[function(y,ee,te){var A=y("svg-path-bounds"),g=y("parse-svg-path"),S=y("draw-svg-path"),M=y("is-svg-path"),e=y("bitmap-sdf"),a=document.createElement("canvas"),n=a.getContext("2d");ee.exports=r;function r(s,i){if(!M(s))throw Error("Argument should be valid svg path string");i||(i={});var x,p;i.shape?(x=i.shape[0],p=i.shape[1]):(x=a.width=i.w||i.width||200,p=a.height=i.h||i.height||200);var v=Math.min(x,p),f=i.stroke||0,d=i.viewbox||i.viewBox||A(s),o=[x/(d[2]-d[0]),p/(d[3]-d[1])],m=Math.min(o[0]||0,o[1]||0)/2;if(n.fillStyle="black",n.fillRect(0,0,x,p),n.fillStyle="white",f&&(typeof f!="number"&&(f=1),f>0?n.strokeStyle="white":n.strokeStyle="black",n.lineWidth=Math.abs(f)),n.translate(x*.5,p*.5),n.scale(m,m),h()){var l=new Path2D(s);n.fill(l),f&&n.stroke(l)}else{var w=g(s);S(n,w),n.fill(),f&&n.stroke()}n.setTransform(1,0,0,1,0,0);var _=e(n,{cutoff:i.cutoff!=null?i.cutoff:.5,radius:i.radius!=null?i.radius:v*.5});return _}var t;function h(){if(t!=null)return t;var s=document.createElement("canvas").getContext("2d");if(s.canvas.width=s.canvas.height=1,!window.Path2D)return t=!1;var i=new Path2D("M0,0h1v1h-1v-1Z");s.fillStyle="black",s.fill(i);var x=s.getImageData(0,0,1,1);return t=x&&x.data&&x.data[3]===255}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(y,ee,te){(function(A,g){(function(){var S=y("process/browser.js").nextTick,M=Function.prototype.apply,e=Array.prototype.slice,a={},n=0;te.setTimeout=function(){return new r(M.call(setTimeout,window,arguments),clearTimeout)},te.setInterval=function(){return new r(M.call(setInterval,window,arguments),clearInterval)},te.clearTimeout=te.clearInterval=function(t){t.close()};function r(t,h){this._id=t,this._clearFn=h}r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},te.enroll=function(t,h){clearTimeout(t._idleTimeoutId),t._idleTimeout=h},te.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},te._unrefActive=te.active=function(t){clearTimeout(t._idleTimeoutId);var h=t._idleTimeout;h>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},h))},te.setImmediate=typeof A=="function"?A:function(t){var h=n++,s=arguments.length<2?!1:e.call(arguments,1);return a[h]=!0,S(function(){a[h]&&(s?t.apply(null,s):t.call(null),te.clearImmediate(h))}),h},te.clearImmediate=typeof g=="function"?g:function(t){delete a[t]}}).call(this)}).call(this,y("timers").setImmediate,y("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(y,ee,te){(function(A){var g=/^\s+/,S=/\s+$/,M=0,e=A.round,a=A.min,n=A.max,r=A.random;function t(X,Q){if(X=X||"",Q=Q||{},X instanceof t)return X;if(!(this instanceof t))return new t(X,Q);var ie=h(X);this._originalInput=X,this._r=ie.r,this._g=ie.g,this._b=ie.b,this._a=ie.a,this._roundA=e(100*this._a)/100,this._format=Q.format||ie.format,this._gradientType=Q.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=ie.ok,this._tc_id=M++}t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var X=this.toRgb();return(X.r*299+X.g*587+X.b*114)/1e3},getLuminance:function(){var X=this.toRgb(),Q,ie,se,ae,oe,be;return Q=X.r/255,ie=X.g/255,se=X.b/255,Q<=.03928?ae=Q/12.92:ae=A.pow((Q+.055)/1.055,2.4),ie<=.03928?oe=ie/12.92:oe=A.pow((ie+.055)/1.055,2.4),se<=.03928?be=se/12.92:be=A.pow((se+.055)/1.055,2.4),.2126*ae+.7152*oe+.0722*be},setAlpha:function(X){return this._a=F(X),this._roundA=e(100*this._a)/100,this},toHsv:function(){var X=p(this._r,this._g,this._b);return{h:X.h*360,s:X.s,v:X.v,a:this._a}},toHsvString:function(){var X=p(this._r,this._g,this._b),Q=e(X.h*360),ie=e(X.s*100),se=e(X.v*100);return this._a==1?"hsv("+Q+", "+ie+"%, "+se+"%)":"hsva("+Q+", "+ie+"%, "+se+"%, "+this._roundA+")"},toHsl:function(){var X=i(this._r,this._g,this._b);return{h:X.h*360,s:X.s,l:X.l,a:this._a}},toHslString:function(){var X=i(this._r,this._g,this._b),Q=e(X.h*360),ie=e(X.s*100),se=e(X.l*100);return this._a==1?"hsl("+Q+", "+ie+"%, "+se+"%)":"hsla("+Q+", "+ie+"%, "+se+"%, "+this._roundA+")"},toHex:function(X){return f(this._r,this._g,this._b,X)},toHexString:function(X){return"#"+this.toHex(X)},toHex8:function(X){return d(this._r,this._g,this._b,this._a,X)},toHex8String:function(X){return"#"+this.toHex8(X)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(N(this._r,255)*100)+"%",g:e(N(this._g,255)*100)+"%",b:e(N(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(N(this._r,255)*100)+"%, "+e(N(this._g,255)*100)+"%, "+e(N(this._b,255)*100)+"%)":"rgba("+e(N(this._r,255)*100)+"%, "+e(N(this._g,255)*100)+"%, "+e(N(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:R[f(this._r,this._g,this._b,!0)]||!1},toFilter:function(X){var Q="#"+o(this._r,this._g,this._b,this._a),ie=Q,se=this._gradientType?"GradientType = 1, ":"";if(X){var ae=t(X);ie="#"+o(ae._r,ae._g,ae._b,ae._a)}return"progid:DXImageTransform.Microsoft.gradient("+se+"startColorstr="+Q+",endColorstr="+ie+")"},toString:function(X){var Q=!!X;X=X||this._format;var ie=!1,se=this._a<1&&this._a>=0,ae=!Q&&se&&(X==="hex"||X==="hex6"||X==="hex3"||X==="hex4"||X==="hex8"||X==="name");return ae?X==="name"&&this._a===0?this.toName():this.toRgbString():(X==="rgb"&&(ie=this.toRgbString()),X==="prgb"&&(ie=this.toPercentageRgbString()),(X==="hex"||X==="hex6")&&(ie=this.toHexString()),X==="hex3"&&(ie=this.toHexString(!0)),X==="hex4"&&(ie=this.toHex8String(!0)),X==="hex8"&&(ie=this.toHex8String()),X==="name"&&(ie=this.toName()),X==="hsl"&&(ie=this.toHslString()),X==="hsv"&&(ie=this.toHsvString()),ie||this.toHexString())},clone:function(){return t(this.toString())},_applyModification:function(X,Q){var ie=X.apply(null,[this].concat([].slice.call(Q)));return this._r=ie._r,this._g=ie._g,this._b=ie._b,this.setAlpha(ie._a),this},lighten:function(){return this._applyModification(_,arguments)},brighten:function(){return this._applyModification(c,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(m,arguments)},saturate:function(){return this._applyModification(l,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(u,arguments)},_applyCombination:function(X,Q){return X.apply(null,[this].concat([].slice.call(Q)))},analogous:function(){return this._applyCombination(z,arguments)},complement:function(){return this._applyCombination(L,arguments)},monochromatic:function(){return this._applyCombination(I,arguments)},splitcomplement:function(){return this._applyCombination(P,arguments)},triad:function(){return this._applyCombination(T,arguments)},tetrad:function(){return this._applyCombination(k,arguments)}},t.fromRatio=function(X,Q){if(typeof X=="object"){var ie={};for(var se in X)X.hasOwnProperty(se)&&(se==="a"?ie[se]=X[se]:ie[se]=ue(X[se]));X=ie}return t(X,Q)};function h(X){var Q={r:0,g:0,b:0},ie=1,se=null,ae=null,oe=null,be=!1,ce=!1;return typeof X=="string"&&(X=$(X)),typeof X=="object"&&(U(X.r)&&U(X.g)&&U(X.b)?(Q=s(X.r,X.g,X.b),be=!0,ce=String(X.r).substr(-1)==="%"?"prgb":"rgb"):U(X.h)&&U(X.s)&&U(X.v)?(se=ue(X.s),ae=ue(X.v),Q=v(X.h,se,ae),be=!0,ce="hsv"):U(X.h)&&U(X.s)&&U(X.l)&&(se=ue(X.s),oe=ue(X.l),Q=x(X.h,se,oe),be=!0,ce="hsl"),X.hasOwnProperty("a")&&(ie=X.a)),ie=F(ie),{ok:be,format:X.format||ce,r:a(255,n(Q.r,0)),g:a(255,n(Q.g,0)),b:a(255,n(Q.b,0)),a:ie}}function s(X,Q,ie){return{r:N(X,255)*255,g:N(Q,255)*255,b:N(ie,255)*255}}function i(X,Q,ie){X=N(X,255),Q=N(Q,255),ie=N(ie,255);var se=n(X,Q,ie),ae=a(X,Q,ie),oe,be,ce=(se+ae)/2;if(se==ae)oe=be=0;else{var de=se-ae;switch(be=ce>.5?de/(2-se-ae):de/(se+ae),se){case X:oe=(Q-ie)/de+(Q<ie?6:0);break;case Q:oe=(ie-X)/de+2;break;case ie:oe=(X-Q)/de+4;break}oe/=6}return{h:oe,s:be,l:ce}}function x(X,Q,ie){var se,ae,oe;X=N(X,360),Q=N(Q,100),ie=N(ie,100);function be(ye,ge,me){return me<0&&(me+=1),me>1&&(me-=1),me<1/6?ye+(ge-ye)*6*me:me<1/2?ge:me<2/3?ye+(ge-ye)*(2/3-me)*6:ye}if(Q===0)se=ae=oe=ie;else{var ce=ie<.5?ie*(1+Q):ie+Q-ie*Q,de=2*ie-ce;se=be(de,ce,X+1/3),ae=be(de,ce,X),oe=be(de,ce,X-1/3)}return{r:se*255,g:ae*255,b:oe*255}}function p(X,Q,ie){X=N(X,255),Q=N(Q,255),ie=N(ie,255);var se=n(X,Q,ie),ae=a(X,Q,ie),oe,be,ce=se,de=se-ae;if(be=se===0?0:de/se,se==ae)oe=0;else{switch(se){case X:oe=(Q-ie)/de+(Q<ie?6:0);break;case Q:oe=(ie-X)/de+2;break;case ie:oe=(X-Q)/de+4;break}oe/=6}return{h:oe,s:be,v:ce}}function v(X,Q,ie){X=N(X,360)*6,Q=N(Q,100),ie=N(ie,100);var se=A.floor(X),ae=X-se,oe=ie*(1-Q),be=ie*(1-ae*Q),ce=ie*(1-(1-ae)*Q),de=se%6,ye=[ie,be,oe,oe,ce,ie][de],ge=[ce,ie,ie,be,oe,oe][de],me=[oe,oe,ce,ie,ie,be][de];return{r:ye*255,g:ge*255,b:me*255}}function f(X,Q,ie,se){var ae=[re(e(X).toString(16)),re(e(Q).toString(16)),re(e(ie).toString(16))];return se&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0):ae.join("")}function d(X,Q,ie,se,ae){var oe=[re(e(X).toString(16)),re(e(Q).toString(16)),re(e(ie).toString(16)),re(j(se))];return ae&&oe[0].charAt(0)==oe[0].charAt(1)&&oe[1].charAt(0)==oe[1].charAt(1)&&oe[2].charAt(0)==oe[2].charAt(1)&&oe[3].charAt(0)==oe[3].charAt(1)?oe[0].charAt(0)+oe[1].charAt(0)+oe[2].charAt(0)+oe[3].charAt(0):oe.join("")}function o(X,Q,ie,se){var ae=[re(j(se)),re(e(X).toString(16)),re(e(Q).toString(16)),re(e(ie).toString(16))];return ae.join("")}t.equals=function(X,Q){return!X||!Q?!1:t(X).toRgbString()==t(Q).toRgbString()},t.random=function(){return t.fromRatio({r:r(),g:r(),b:r()})};function m(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toHsl();return ie.s-=Q/100,ie.s=G(ie.s),t(ie)}function l(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toHsl();return ie.s+=Q/100,ie.s=G(ie.s),t(ie)}function w(X){return t(X).desaturate(100)}function _(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toHsl();return ie.l+=Q/100,ie.l=G(ie.l),t(ie)}function c(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toRgb();return ie.r=n(0,a(255,ie.r-e(255*-(Q/100)))),ie.g=n(0,a(255,ie.g-e(255*-(Q/100)))),ie.b=n(0,a(255,ie.b-e(255*-(Q/100)))),t(ie)}function b(X,Q){Q=Q===0?0:Q||10;var ie=t(X).toHsl();return ie.l-=Q/100,ie.l=G(ie.l),t(ie)}function u(X,Q){var ie=t(X).toHsl(),se=(ie.h+Q)%360;return ie.h=se<0?360+se:se,t(ie)}function L(X){var Q=t(X).toHsl();return Q.h=(Q.h+180)%360,t(Q)}function T(X){var Q=t(X).toHsl(),ie=Q.h;return[t(X),t({h:(ie+120)%360,s:Q.s,l:Q.l}),t({h:(ie+240)%360,s:Q.s,l:Q.l})]}function k(X){var Q=t(X).toHsl(),ie=Q.h;return[t(X),t({h:(ie+90)%360,s:Q.s,l:Q.l}),t({h:(ie+180)%360,s:Q.s,l:Q.l}),t({h:(ie+270)%360,s:Q.s,l:Q.l})]}function P(X){var Q=t(X).toHsl(),ie=Q.h;return[t(X),t({h:(ie+72)%360,s:Q.s,l:Q.l}),t({h:(ie+216)%360,s:Q.s,l:Q.l})]}function z(X,Q,ie){Q=Q||6,ie=ie||30;var se=t(X).toHsl(),ae=360/ie,oe=[t(X)];for(se.h=(se.h-(ae*Q>>1)+720)%360;--Q;)se.h=(se.h+ae)%360,oe.push(t(se));return oe}function I(X,Q){Q=Q||6;for(var ie=t(X).toHsv(),se=ie.h,ae=ie.s,oe=ie.v,be=[],ce=1/Q;Q--;)be.push(t({h:se,s:ae,v:oe})),oe=(oe+ce)%1;return be}t.mix=function(X,Q,ie){ie=ie===0?0:ie||50;var se=t(X).toRgb(),ae=t(Q).toRgb(),oe=ie/100,be={r:(ae.r-se.r)*oe+se.r,g:(ae.g-se.g)*oe+se.g,b:(ae.b-se.b)*oe+se.b,a:(ae.a-se.a)*oe+se.a};return t(be)},t.readability=function(X,Q){var ie=t(X),se=t(Q);return(A.max(ie.getLuminance(),se.getLuminance())+.05)/(A.min(ie.getLuminance(),se.getLuminance())+.05)},t.isReadable=function(X,Q,ie){var se=t.readability(X,Q),ae,oe;switch(oe=!1,ae=ne(ie),ae.level+ae.size){case"AAsmall":case"AAAlarge":oe=se>=4.5;break;case"AAlarge":oe=se>=3;break;case"AAAsmall":oe=se>=7;break}return oe},t.mostReadable=function(X,Q,ie){var se=null,ae=0,oe,be,ce,de;ie=ie||{},be=ie.includeFallbackColors,ce=ie.level,de=ie.size;for(var ye=0;ye<Q.length;ye++)oe=t.readability(X,Q[ye]),oe>ae&&(ae=oe,se=t(Q[ye]));return t.isReadable(X,se,{level:ce,size:de})||!be?se:(ie.includeFallbackColors=!1,t.mostReadable(X,["#fff","#000"],ie))};var D=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=t.hexNames=O(D);function O(X){var Q={};for(var ie in X)X.hasOwnProperty(ie)&&(Q[X[ie]]=ie);return Q}function F(X){return X=parseFloat(X),(isNaN(X)||X<0||X>1)&&(X=1),X}function N(X,Q){W(X)&&(X="100%");var ie=Y(X);return X=a(Q,n(0,parseFloat(X))),ie&&(X=parseInt(X*Q,10)/100),A.abs(X-Q)<1e-6?1:X%Q/parseFloat(Q)}function G(X){return a(1,n(0,X))}function K(X){return parseInt(X,16)}function W(X){return typeof X=="string"&&X.indexOf(".")!=-1&&parseFloat(X)===1}function Y(X){return typeof X=="string"&&X.indexOf("%")!=-1}function re(X){return X.length==1?"0"+X:""+X}function ue(X){return X<=1&&(X=X*100+"%"),X}function j(X){return A.round(parseFloat(X)*255).toString(16)}function q(X){return K(X)/255}var H=function(){var X="[-\\+]?\\d+%?",Q="[-\\+]?\\d*\\.\\d+%?",ie="(?:"+Q+")|(?:"+X+")",se="[\\s|\\(]+("+ie+")[,|\\s]+("+ie+")[,|\\s]+("+ie+")\\s*\\)?",ae="[\\s|\\(]+("+ie+")[,|\\s]+("+ie+")[,|\\s]+("+ie+")[,|\\s]+("+ie+")\\s*\\)?";return{CSS_UNIT:new RegExp(ie),rgb:new RegExp("rgb"+se),rgba:new RegExp("rgba"+ae),hsl:new RegExp("hsl"+se),hsla:new RegExp("hsla"+ae),hsv:new RegExp("hsv"+se),hsva:new RegExp("hsva"+ae),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function U(X){return!!H.CSS_UNIT.exec(X)}function $(X){X=X.replace(g,"").replace(S,"").toLowerCase();var Q=!1;if(D[X])X=D[X],Q=!0;else if(X=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var ie;return(ie=H.rgb.exec(X))?{r:ie[1],g:ie[2],b:ie[3]}:(ie=H.rgba.exec(X))?{r:ie[1],g:ie[2],b:ie[3],a:ie[4]}:(ie=H.hsl.exec(X))?{h:ie[1],s:ie[2],l:ie[3]}:(ie=H.hsla.exec(X))?{h:ie[1],s:ie[2],l:ie[3],a:ie[4]}:(ie=H.hsv.exec(X))?{h:ie[1],s:ie[2],v:ie[3]}:(ie=H.hsva.exec(X))?{h:ie[1],s:ie[2],v:ie[3],a:ie[4]}:(ie=H.hex8.exec(X))?{r:K(ie[1]),g:K(ie[2]),b:K(ie[3]),a:q(ie[4]),format:Q?"name":"hex8"}:(ie=H.hex6.exec(X))?{r:K(ie[1]),g:K(ie[2]),b:K(ie[3]),format:Q?"name":"hex"}:(ie=H.hex4.exec(X))?{r:K(ie[1]+""+ie[1]),g:K(ie[2]+""+ie[2]),b:K(ie[3]+""+ie[3]),a:q(ie[4]+""+ie[4]),format:Q?"name":"hex8"}:(ie=H.hex3.exec(X))?{r:K(ie[1]+""+ie[1]),g:K(ie[2]+""+ie[2]),b:K(ie[3]+""+ie[3]),format:Q?"name":"hex"}:!1}function ne(X){var Q,ie;return X=X||{level:"AA",size:"small"},Q=(X.level||"AA").toUpperCase(),ie=(X.size||"small").toLowerCase(),Q!=="AA"&&Q!=="AAA"&&(Q="AA"),ie!=="small"&&ie!=="large"&&(ie="small"),{level:Q,size:ie}}typeof ee<"u"&&ee.exports?ee.exports=t:window.tinycolor=t})(Math)},{}],314:[function(y,ee,te){ee.exports=S,ee.exports.float32=ee.exports.float=S,ee.exports.fract32=ee.exports.fract=g;var A=new Float32Array(1);function g(M,e){if(M.length){if(M instanceof Float32Array)return new Float32Array(M.length);e instanceof Float32Array||(e=S(M));for(var a=0,n=e.length;a<n;a++)e[a]=M[a]-e[a];return e}return S(M-S(M))}function S(M){return M.length?M instanceof Float32Array?M:new Float32Array(M):(A[0]=M,A[0])}},{}],315:[function(y,ee,te){var A=y("parse-unit");ee.exports=e;var g=96;function S(a,n){var r=A(getComputedStyle(a).getPropertyValue(n));return r[0]*e(r[1],a)}function M(a,n){var r=document.createElement("div");r.style["font-size"]="128"+a,n.appendChild(r);var t=S(r,"font-size")/128;return n.removeChild(r),t}function e(a,n){switch(n=n||document.body,a=(a||"px").trim().toLowerCase(),(n===window||n===document)&&(n=document.body),a){case"%":return n.clientHeight/100;case"ch":case"ex":return M(a,n);case"em":return S(n,"font-size");case"rem":return S(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return g;case"cm":return g/2.54;case"mm":return g/25.4;case"pt":return g/72;case"pc":return g/6}return 1}},{"parse-unit":251}],316:[function(y,ee,te){(function(A,g){typeof te=="object"&&typeof ee<"u"?g(te):(A=A||self,g(A.topojson=A.topojson||{}))})(this,function(A){function g(l){return l}function S(l){if(l==null)return g;var w,_,c=l.scale[0],b=l.scale[1],u=l.translate[0],L=l.translate[1];return function(T,k){k||(w=_=0);var P=2,z=T.length,I=new Array(z);for(I[0]=(w+=T[0])*c+u,I[1]=(_+=T[1])*b+L;P<z;)I[P]=T[P],++P;return I}}function M(l){var w=S(l.transform),_,c=1/0,b=c,u=-c,L=-c;function T(P){P=w(P),P[0]<c&&(c=P[0]),P[0]>u&&(u=P[0]),P[1]<b&&(b=P[1]),P[1]>L&&(L=P[1])}function k(P){switch(P.type){case"GeometryCollection":P.geometries.forEach(k);break;case"Point":T(P.coordinates);break;case"MultiPoint":P.coordinates.forEach(T);break}}l.arcs.forEach(function(P){for(var z=-1,I=P.length,D;++z<I;)D=w(P[z],z),D[0]<c&&(c=D[0]),D[0]>u&&(u=D[0]),D[1]<b&&(b=D[1]),D[1]>L&&(L=D[1])});for(_ in l.objects)k(l.objects[_]);return[c,b,u,L]}function e(l,w){for(var _,c=l.length,b=c-w;b<--c;)_=l[b],l[b++]=l[c],l[c]=_}function a(l,w){return typeof w=="string"&&(w=l.objects[w]),w.type==="GeometryCollection"?{type:"FeatureCollection",features:w.geometries.map(function(_){return n(l,_)})}:n(l,w)}function n(l,w){var _=w.id,c=w.bbox,b=w.properties==null?{}:w.properties,u=r(l,w);return _==null&&c==null?{type:"Feature",properties:b,geometry:u}:c==null?{type:"Feature",id:_,properties:b,geometry:u}:{type:"Feature",id:_,bbox:c,properties:b,geometry:u}}function r(l,w){var _=S(l.transform),c=l.arcs;function b(z,I){I.length&&I.pop();for(var D=c[z<0?~z:z],R=0,O=D.length;R<O;++R)I.push(_(D[R],R));z<0&&e(I,O)}function u(z){return _(z)}function L(z){for(var I=[],D=0,R=z.length;D<R;++D)b(z[D],I);return I.length<2&&I.push(I[0]),I}function T(z){for(var I=L(z);I.length<4;)I.push(I[0]);return I}function k(z){return z.map(T)}function P(z){var I=z.type,D;switch(I){case"GeometryCollection":return{type:I,geometries:z.geometries.map(P)};case"Point":D=u(z.coordinates);break;case"MultiPoint":D=z.coordinates.map(u);break;case"LineString":D=L(z.arcs);break;case"MultiLineString":D=z.arcs.map(L);break;case"Polygon":D=k(z.arcs);break;case"MultiPolygon":D=z.arcs.map(k);break;default:return null}return{type:I,coordinates:D}}return P(w)}function t(l,w){var _={},c={},b={},u=[],L=-1;w.forEach(function(P,z){var I=l.arcs[P<0?~P:P],D;I.length<3&&!I[1][0]&&!I[1][1]&&(D=w[++L],w[L]=P,w[z]=D)}),w.forEach(function(P){var z=T(P),I=z[0],D=z[1],R,O;if(R=b[I])if(delete b[R.end],R.push(P),R.end=D,O=c[D]){delete c[O.start];var F=O===R?R:R.concat(O);c[F.start=R.start]=b[F.end=O.end]=F}else c[R.start]=b[R.end]=R;else if(R=c[D])if(delete c[R.start],R.unshift(P),R.start=I,O=b[I]){delete b[O.end];var N=O===R?R:O.concat(R);c[N.start=O.start]=b[N.end=R.end]=N}else c[R.start]=b[R.end]=R;else R=[P],c[R.start=I]=b[R.end=D]=R});function T(P){var z=l.arcs[P<0?~P:P],I=z[0],D;return l.transform?(D=[0,0],z.forEach(function(R){D[0]+=R[0],D[1]+=R[1]})):D=z[z.length-1],P<0?[D,I]:[I,D]}function k(P,z){for(var I in P){var D=P[I];delete z[D.start],delete D.start,delete D.end,D.forEach(function(R){_[R<0?~R:R]=1}),u.push(D)}}return k(b,c),k(c,b),w.forEach(function(P){_[P<0?~P:P]||u.push([P])}),u}function h(l){return r(l,s.apply(this,arguments))}function s(l,w,_){var c,b,u;if(arguments.length>1)c=i(l,w,_);else for(b=0,c=new Array(u=l.arcs.length);b<u;++b)c[b]=b;return{type:"MultiLineString",arcs:t(l,c)}}function i(l,w,_){var c=[],b=[],u;function L(I){var D=I<0?~I:I;(b[D]||(b[D]=[])).push({i:I,g:u})}function T(I){I.forEach(L)}function k(I){I.forEach(T)}function P(I){I.forEach(k)}function z(I){switch(u=I,I.type){case"GeometryCollection":I.geometries.forEach(z);break;case"LineString":T(I.arcs);break;case"MultiLineString":case"Polygon":k(I.arcs);break;case"MultiPolygon":P(I.arcs);break}}return z(w),b.forEach(_==null?function(I){c.push(I[0].i)}:function(I){_(I[0].g,I[I.length-1].g)&&c.push(I[0].i)}),c}function x(l){for(var w=-1,_=l.length,c,b=l[_-1],u=0;++w<_;)c=b,b=l[w],u+=c[0]*b[1]-c[1]*b[0];return Math.abs(u)}function p(l){return r(l,v.apply(this,arguments))}function v(l,w){var _={},c=[],b=[];w.forEach(u);function u(k){switch(k.type){case"GeometryCollection":k.geometries.forEach(u);break;case"Polygon":L(k.arcs);break;case"MultiPolygon":k.arcs.forEach(L);break}}function L(k){k.forEach(function(P){P.forEach(function(z){(_[z=z<0?~z:z]||(_[z]=[])).push(k)})}),c.push(k)}function T(k){return x(r(l,{type:"Polygon",arcs:[k]}).coordinates[0])}return c.forEach(function(k){if(!k._){var P=[],z=[k];for(k._=1,b.push(P);k=z.pop();)P.push(k),k.forEach(function(I){I.forEach(function(D){_[D<0?~D:D].forEach(function(R){R._||(R._=1,z.push(R))})})})}}),c.forEach(function(k){delete k._}),{type:"MultiPolygon",arcs:b.map(function(k){var P=[],z;if(k.forEach(function(F){F.forEach(function(N){N.forEach(function(G){_[G<0?~G:G].length<2&&P.push(G)})})}),P=t(l,P),(z=P.length)>1)for(var I=1,D=T(P[0]),R,O;I<z;++I)(R=T(P[I]))>D&&(O=P[0],P[0]=P[I],P[I]=O,D=R);return P}).filter(function(k){return k.length>0})}}function f(l,w){for(var _=0,c=l.length;_<c;){var b=_+c>>>1;l[b]<w?_=b+1:c=b}return _}function d(l){var w={},_=l.map(function(){return[]});function c(F,N){F.forEach(function(G){G<0&&(G=~G);var K=w[G];K?K.push(N):w[G]=[N]})}function b(F,N){F.forEach(function(G){c(G,N)})}function u(F,N){F.type==="GeometryCollection"?F.geometries.forEach(function(G){u(G,N)}):F.type in L&&L[F.type](F.arcs,N)}var L={LineString:c,MultiLineString:b,Polygon:b,MultiPolygon:function(F,N){F.forEach(function(G){b(G,N)})}};l.forEach(u);for(var T in w)for(var k=w[T],P=k.length,z=0;z<P;++z)for(var I=z+1;I<P;++I){var D=k[z],R=k[I],O;(O=_[D])[T=f(O,R)]!==R&&O.splice(T,0,R),(O=_[R])[T=f(O,D)]!==D&&O.splice(T,0,D)}return _}function o(l){if(l==null)return g;var w,_,c=l.scale[0],b=l.scale[1],u=l.translate[0],L=l.translate[1];return function(T,k){k||(w=_=0);var P=2,z=T.length,I=new Array(z),D=Math.round((T[0]-u)/c),R=Math.round((T[1]-L)/b);for(I[0]=D-w,w=D,I[1]=R-_,_=R;P<z;)I[P]=T[P],++P;return I}}function m(l,w){if(l.transform)throw new Error("already quantized");if(!w||!w.scale){if(!((L=Math.floor(w))>=2))throw new Error("n must be 2");k=l.bbox||M(l);var _=k[0],c=k[1],b=k[2],u=k[3],L;w={scale:[b-_?(b-_)/(L-1):1,u-c?(u-c)/(L-1):1],translate:[_,c]}}else k=l.bbox;var T=o(w),k,P,z=l.objects,I={};function D(F){return T(F)}function R(F){var N;switch(F.type){case"GeometryCollection":N={type:"GeometryCollection",geometries:F.geometries.map(R)};break;case"Point":N={type:"Point",coordinates:D(F.coordinates)};break;case"MultiPoint":N={type:"MultiPoint",coordinates:F.coordinates.map(D)};break;default:return F}return F.id!=null&&(N.id=F.id),F.bbox!=null&&(N.bbox=F.bbox),F.properties!=null&&(N.properties=F.properties),N}function O(F){var N=0,G=1,K=F.length,W,Y=new Array(K);for(Y[0]=T(F[0],0);++N<K;)((W=T(F[N],N))[0]||W[1])&&(Y[G++]=W);return G===1&&(Y[G++]=[0,0]),Y.length=G,Y}for(P in z)I[P]=R(z[P]);return{type:"Topology",bbox:k,transform:w,objects:I,arcs:l.arcs.map(O)}}A.bbox=M,A.feature=a,A.merge=p,A.mergeArcs=v,A.mesh=h,A.meshArcs=s,A.neighbors=d,A.quantize=m,A.transform=S,A.untransform=o,Object.defineProperty(A,"__esModule",{value:!0})})},{}],317:[function(y,ee,te){var A=y("../prototype/is");ee.exports=function(g){if(typeof g!="function"||!hasOwnProperty.call(g,"length"))return!1;try{if(typeof g.length!="number"||typeof g.call!="function"||typeof g.apply!="function")return!1}catch{return!1}return!A(g)}},{"../prototype/is":324}],318:[function(y,ee,te){var A=y("../value/is"),g=y("../object/is"),S=y("../string/coerce"),M=y("./to-short-string"),e=function(a,n){return a.replace("%v",M(n))};ee.exports=function(a,n,r){if(!g(r))throw new TypeError(e(n,a));if(!A(a)){if("default"in r)return r.default;if(r.isOptional)return null}var t=S(r.errorMessage);throw A(t)||(t=n),new TypeError(e(t,a))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(y,ee,te){ee.exports=function(A){try{return A.toString()}catch{try{return String(A)}catch{return null}}}},{}],320:[function(y,ee,te){var A=y("./safe-to-string"),g=/[\n\r\u2028\u2029]/g;ee.exports=function(S){var M=A(S);return M===null?"<Non-coercible to string value>":(M.length>100&&(M=M.slice(0,99)+""),M=M.replace(g,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}),M)}},{"./safe-to-string":319}],321:[function(y,ee,te){var A=y("../value/is"),g={object:!0,function:!0,undefined:!0};ee.exports=function(S){return A(S)?hasOwnProperty.call(g,typeof S):!1}},{"../value/is":327}],322:[function(y,ee,te){var A=y("../lib/resolve-exception"),g=y("./is");ee.exports=function(S){return g(S)?S:A(S,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(y,ee,te){var A=y("../function/is"),g=/^\s*class[\s{/}]/,S=Function.prototype.toString;ee.exports=function(M){return!(!A(M)||g.test(S.call(M)))}},{"../function/is":317}],324:[function(y,ee,te){var A=y("../object/is");ee.exports=function(g){if(!A(g))return!1;try{return g.constructor?g.constructor.prototype===g:!1}catch{return!1}}},{"../object/is":321}],325:[function(y,ee,te){var A=y("../value/is"),g=y("../object/is"),S=Object.prototype.toString;ee.exports=function(M){if(!A(M))return null;if(g(M)){var e=M.toString;if(typeof e!="function"||e===S)return null}try{return""+M}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(y,ee,te){var A=y("../lib/resolve-exception"),g=y("./is");ee.exports=function(S){return g(S)?S:A(S,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(y,ee,te){var A=void 0;ee.exports=function(g){return g!==A&&g!==null}},{}],328:[function(y,ee,te){(function(A){(function(){var g=y("bit-twiddle"),S=y("dup"),M=y("buffer").Buffer;A.__TYPEDARRAY_POOL||(A.__TYPEDARRAY_POOL={UINT8:S([32,0]),UINT16:S([32,0]),UINT32:S([32,0]),BIGUINT64:S([32,0]),INT8:S([32,0]),INT16:S([32,0]),INT32:S([32,0]),BIGINT64:S([32,0]),FLOAT:S([32,0]),DOUBLE:S([32,0]),DATA:S([32,0]),UINT8C:S([32,0]),BUFFER:S([32,0])});var e=typeof Uint8ClampedArray<"u",a=typeof BigUint64Array<"u",n=typeof BigInt64Array<"u",r=A.__TYPEDARRAY_POOL;r.UINT8C||(r.UINT8C=S([32,0])),r.BIGUINT64||(r.BIGUINT64=S([32,0])),r.BIGINT64||(r.BIGINT64=S([32,0])),r.BUFFER||(r.BUFFER=S([32,0]));var t=r.DATA,h=r.BUFFER;te.free=function(k){if(M.isBuffer(k))h[g.log2(k.length)].push(k);else{if(Object.prototype.toString.call(k)!=="[object ArrayBuffer]"&&(k=k.buffer),!k)return;var P=k.length||k.byteLength,z=g.log2(P)|0;t[z].push(k)}};function s(T){if(T){var k=T.length||T.byteLength,P=g.log2(k);t[P].push(T)}}function i(T){s(T.buffer)}te.freeUint8=te.freeUint16=te.freeUint32=te.freeBigUint64=te.freeInt8=te.freeInt16=te.freeInt32=te.freeBigInt64=te.freeFloat32=te.freeFloat=te.freeFloat64=te.freeDouble=te.freeUint8Clamped=te.freeDataView=i,te.freeArrayBuffer=s,te.freeBuffer=function(k){h[g.log2(k.length)].push(k)},te.malloc=function(k,P){if(P===void 0||P==="arraybuffer")return x(k);switch(P){case"uint8":return p(k);case"uint16":return v(k);case"uint32":return f(k);case"int8":return d(k);case"int16":return o(k);case"int32":return m(k);case"float":case"float32":return l(k);case"double":case"float64":return w(k);case"uint8_clamped":return _(k);case"bigint64":return b(k);case"biguint64":return c(k);case"buffer":return L(k);case"data":case"dataview":return u(k);default:return null}return null};function x(k){var k=g.nextPow2(k),P=g.log2(k),z=t[P];return z.length>0?z.pop():new ArrayBuffer(k)}te.mallocArrayBuffer=x;function p(T){return new Uint8Array(x(T),0,T)}te.mallocUint8=p;function v(T){return new Uint16Array(x(2*T),0,T)}te.mallocUint16=v;function f(T){return new Uint32Array(x(4*T),0,T)}te.mallocUint32=f;function d(T){return new Int8Array(x(T),0,T)}te.mallocInt8=d;function o(T){return new Int16Array(x(2*T),0,T)}te.mallocInt16=o;function m(T){return new Int32Array(x(4*T),0,T)}te.mallocInt32=m;function l(T){return new Float32Array(x(4*T),0,T)}te.mallocFloat32=te.mallocFloat=l;function w(T){return new Float64Array(x(8*T),0,T)}te.mallocFloat64=te.mallocDouble=w;function _(T){return e?new Uint8ClampedArray(x(T),0,T):p(T)}te.mallocUint8Clamped=_;function c(T){return a?new BigUint64Array(x(8*T),0,T):null}te.mallocBigUint64=c;function b(T){return n?new BigInt64Array(x(8*T),0,T):null}te.mallocBigInt64=b;function u(T){return new DataView(x(T),0,T)}te.mallocDataView=u;function L(T){T=g.nextPow2(T);var k=g.log2(T),P=h[k];return P.length>0?P.pop():new M(T)}te.mallocBuffer=L,te.clearCache=function(){for(var k=0;k<32;++k)r.UINT8[k].length=0,r.UINT16[k].length=0,r.UINT32[k].length=0,r.INT8[k].length=0,r.INT16[k].length=0,r.INT32[k].length=0,r.FLOAT[k].length=0,r.DOUBLE[k].length=0,r.BIGUINT64[k].length=0,r.BIGINT64[k].length=0,r.UINT8C[k].length=0,t[k].length=0,h[k].length=0}}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(y,ee,te){var A=/[\'\"]/;ee.exports=function(S){return S?(A.test(S.charAt(0))&&(S=S.substr(1)),A.test(S.charAt(S.length-1))&&(S=S.substr(0,S.length-1)),S):""}},{}],330:[function(y,ee,te){ee.exports=function(g,S,M){Array.isArray(M)||(M=[].slice.call(arguments,2));for(var e=0,a=M.length;e<a;e++){var n=M[e];for(var r in n)if(!(S[r]!==void 0&&!Array.isArray(S[r])&&g[r]===S[r])&&r in S){var t;if(n[r]===!0)t=S[r];else{if(n[r]===!1)continue;if(typeof n[r]=="function"&&(t=n[r](S[r],g,S),t===void 0))continue}g[r]=t}}return g}},{}],331:[function(y,ee,te){(function(A){(function(){ee.exports=g;function g(M,e){if(S("noDeprecation"))return M;var a=!1;function n(){if(!a){if(S("throwDeprecation"))throw new Error(e);S("traceDeprecation")?console.trace(e):console.warn(e),a=!0}return M.apply(this,arguments)}return n}function S(M){try{if(!A.localStorage)return!1}catch{return!1}var e=A.localStorage[M];return e==null?!1:String(e).toLowerCase()==="true"}}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(y,ee,te){var A=y("get-canvas-context");ee.exports=function(S){return A("webgl",S)}},{"get-canvas-context":194}],333:[function(y,ee,te){var A=y("../main"),g=y("object-assign"),S=A.instance();function M(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}M.prototype=new A.baseCalendar,g(M.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(x,p){if(typeof x=="string"){var v=x.match(a);return v?v[0]:""}var f=this._validateYear(x),d=x.month(),o=""+this.toChineseMonth(f,d);return p&&o.length<2&&(o="0"+o),this.isIntercalaryMonth(f,d)&&(o+="i"),o},monthNames:function(x){if(typeof x=="string"){var p=x.match(n);return p?p[0]:""}var v=this._validateYear(x),f=x.month(),d=this.toChineseMonth(v,f),o=["","","","","","","","","","","",""][d-1];return this.isIntercalaryMonth(v,f)&&(o=""+o),o},monthNamesShort:function(x){if(typeof x=="string"){var p=x.match(r);return p?p[0]:""}var v=this._validateYear(x),f=x.month(),d=this.toChineseMonth(v,f),o=["","","","","","","","","","","",""][d-1];return this.isIntercalaryMonth(v,f)&&(o=""+o),o},parseMonth:function(x,p){x=this._validateYear(x);var v=parseInt(p),f;if(isNaN(v))p[0]===""&&(f=!0,p=p.substring(1)),p[p.length-1]===""&&(p=p.substring(0,p.length-1)),v=1+["","","","","","","","","","","",""].indexOf(p);else{var d=p[p.length-1];f=d==="i"||d==="I"}var o=this.toMonthIndex(x,v,f);return o},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(x,p){if(x.year&&(x=x.year()),typeof x!="number"||x<1888||x>2111)throw p.replace(/\{0\}/,this.local.name);return x},toMonthIndex:function(x,p,v){var f=this.intercalaryMonth(x),d=v&&p!==f;if(d||p<1||p>12)throw A.local.invalidMonth.replace(/\{0\}/,this.local.name);var o;return f?!v&&p<=f?o=p-1:o=p:o=p-1,o},toChineseMonth:function(x,p){x.year&&(x=x.year(),p=x.month());var v=this.intercalaryMonth(x),f=v?12:11;if(p<0||p>f)throw A.local.invalidMonth.replace(/\{0\}/,this.local.name);var d;return v?p<v?d=p+1:d=p:d=p+1,d},intercalaryMonth:function(x){x=this._validateYear(x);var p=t[x-t[0]],v=p>>13;return v},isIntercalaryMonth:function(x,p){x.year&&(x=x.year(),p=x.month());var v=this.intercalaryMonth(x);return!!v&&v===p},leapYear:function(x){return this.intercalaryMonth(x)!==0},weekOfYear:function(x,p,v){var f=this._validateYear(x,A.local.invalidyear),d=h[f-h[0]],o=d>>9&4095,m=d>>5&15,l=d&31,w;w=S.newDate(o,m,l),w.add(4-(w.dayOfWeek()||7),"d");var _=this.toJD(x,p,v)-w.toJD();return 1+Math.floor(_/7)},monthsInYear:function(x){return this.leapYear(x)?13:12},daysInMonth:function(x,p){x.year&&(p=x.month(),x=x.year()),x=this._validateYear(x);var v=t[x-t[0]],f=v>>13,d=f?12:11;if(p>d)throw A.local.invalidMonth.replace(/\{0\}/,this.local.name);var o=v&1<<12-p?30:29;return o},weekDay:function(x,p,v){return(this.dayOfWeek(x,p,v)||7)<6},toJD:function(x,p,v){var f=this._validate(x,o,v,A.local.invalidDate);x=this._validateYear(f.year()),p=f.month(),v=f.day();var d=this.isIntercalaryMonth(x,p),o=this.toChineseMonth(x,p),m=i(x,o,v,d);return S.toJD(m.year,m.month,m.day)},fromJD:function(x){var p=S.fromJD(x),v=s(p.year(),p.month(),p.day()),f=this.toMonthIndex(v.year,v.month,v.isIntercalary);return this.newDate(v.year,f,v.day)},fromString:function(x){var p=x.match(e),v=this._validateYear(+p[1]),f=+p[2],d=!!p[3],o=this.toMonthIndex(v,f,d),m=+p[4];return this.newDate(v,o,m)},add:function(x,p,v){var f=x.year(),d=x.month(),o=this.isIntercalaryMonth(f,d),m=this.toChineseMonth(f,d),l=Object.getPrototypeOf(M.prototype).add.call(this,x,p,v);if(v==="y"){var w=l.year(),_=l.month(),c=this.isIntercalaryMonth(w,m),b=o&&c?this.toMonthIndex(w,m,!0):this.toMonthIndex(w,m,!1);b!==_&&l.month(b)}return l}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,a=/^\d?\d[iI]?/m,n=/^??[]?/m,r=/^??[]?/m;A.calendars.chinese=M;var t=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],h=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function s(x,p,v,f){var d,o;if(typeof x=="object")d=x,o=p||{};else{var m=typeof x=="number"&&x>=1888&&x<=2111;if(!m)throw new Error("Solar year outside range 1888-2111");var l=typeof p=="number"&&p>=1&&p<=12;if(!l)throw new Error("Solar month outside range 1 - 12");var w=typeof v=="number"&&v>=1&&v<=31;if(!w)throw new Error("Solar day outside range 1 - 31");d={year:x,month:p,day:v},o=f||{}}var _=h[d.year-h[0]],c=d.year<<9|d.month<<5|d.day;o.year=c>=_?d.year:d.year-1,_=h[o.year-h[0]];var b=_>>9&4095,u=_>>5&15,L=_&31,T,k=new Date(b,u-1,L),P=new Date(d.year,d.month-1,d.day);T=Math.round((P-k)/(24*3600*1e3));var z=t[o.year-t[0]],I;for(I=0;I<13;I++){var D=z&1<<12-I?30:29;if(T<D)break;T-=D}var R=z>>13;return!R||I<R?(o.isIntercalary=!1,o.month=1+I):I===R?(o.isIntercalary=!0,o.month=I):(o.isIntercalary=!1,o.month=I),o.day=1+T,o}function i(x,p,v,f,d){var o,m;if(typeof x=="object")m=x,o=p||{};else{var l=typeof x=="number"&&x>=1888&&x<=2111;if(!l)throw new Error("Lunar year outside range 1888-2111");var w=typeof p=="number"&&p>=1&&p<=12;if(!w)throw new Error("Lunar month outside range 1 - 12");var _=typeof v=="number"&&v>=1&&v<=30;if(!_)throw new Error("Lunar day outside range 1 - 30");var c;typeof f=="object"?(c=!1,o=f):(c=!!f,o=d||{}),m={year:x,month:p,day:v,isIntercalary:c}}var b;b=m.day-1;var u=t[m.year-t[0]],L=u>>13,T;L&&(m.month>L||m.isIntercalary)?T=m.month:T=m.month-1;for(var k=0;k<T;k++){var P=u&1<<12-k?30:29;b+=P}var z=h[m.year-h[0]],I=z>>9&4095,D=z>>5&15,R=z&31,O=new Date(I,D-1,R+b);return o.year=O.getFullYear(),o.month=1+O.getMonth(),o.day=O.getDate(),o}},{"../main":347,"object-assign":247}],334:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),a=e.year()+(e.year()<0?1:0);return a%4===3||a%4===-1},monthsInYear:function(M){return this._validate(M,this.minMonth,this.minDay,A.local.invalidYear||A.regionalOptions[""].invalidYear),13},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,A.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===13&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);return M=n.year(),M<0&&M++,n.day()+(n.month()-1)*30+(M-1)*365+Math.floor(M/4)+this.jdEpoch-1},fromJD:function(M){var e=Math.floor(M)+.5-this.jdEpoch,a=Math.floor((e-Math.floor((e+366)/1461))/365)+1;a<=0&&a--,e=Math.floor(M)+.5-this.newDate(a,1,1).toJD();var n=Math.floor(e/30)+1,r=e-(n-1)*30+1;return this.newDate(a,n,r)}}),A.calendars.coptic=S},{"../main":347,"object-assign":247}],335:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,A.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,A.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,A.local.invalidYear),400},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/8)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);return(r.day()+1)%8},weekDay:function(e,a,n){var r=this.dayOfWeek(e,a,n);return r>=2&&r<=6},extraInfo:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);return{century:M[Math.floor((r.year()-1)/100)+1]||""}},toJD:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);return e=r.year()+(r.year()<0?1:0),a=r.month(),n=r.day(),n+(a>1?16:0)+(a>2?(a-2)*32:0)+(e-1)*400+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var a=Math.floor(e/400)+1;e-=(a-1)*400,e+=e>15?16:0;var n=Math.floor(e/32)+1,r=e-(n-1)*32+1;return this.newDate(a<=0?a-1:a,n,r)}});var M={20:"Fruitbat",21:"Anchovy"};A.calendars.discworld=S},{"../main":347,"object-assign":247}],336:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),a=e.year()+(e.year()<0?1:0);return a%4===3||a%4===-1},monthsInYear:function(M){return this._validate(M,this.minMonth,this.minDay,A.local.invalidYear||A.regionalOptions[""].invalidYear),13},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,A.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===13&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);return M=n.year(),M<0&&M++,n.day()+(n.month()-1)*30+(M-1)*365+Math.floor(M/4)+this.jdEpoch-1},fromJD:function(M){var e=Math.floor(M)+.5-this.jdEpoch,a=Math.floor((e-Math.floor((e+366)/1461))/365)+1;a<=0&&a--,e=Math.floor(M)+.5-this.newDate(a,1,1).toJD();var n=Math.floor(e/30)+1,r=e-(n-1)*30+1;return this.newDate(a,n,r)}}),A.calendars.ethiopian=S},{"../main":347,"object-assign":247}],337:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear);return this._leapYear(a.year())},_leapYear:function(e){return e=e<0?e+1:e,M(e*7+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,A.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear);return e=a.year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,a){return e.year&&(a=e.month(),e=e.year()),this._validate(e,a,this.minDay,A.local.invalidMonth),a===12&&this.leapYear(e)||a===8&&M(this.daysInYear(e),10)===5?30:a===9&&M(this.daysInYear(e),10)===3?29:this.daysPerMonth[a-1]},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==6},extraInfo:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);return{yearType:(this.leapYear(r)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(r)%10-3]}},toJD:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);e=r.year(),a=r.month(),n=r.day();var t=e<=0?e+1:e,h=this.jdEpoch+this._delay1(t)+this._delay2(t)+n+1;if(a<7){for(var s=7;s<=this.monthsInYear(e);s++)h+=this.daysInMonth(e,s);for(var s=1;s<a;s++)h+=this.daysInMonth(e,s)}else for(var s=7;s<a;s++)h+=this.daysInMonth(e,s);return h},_delay1:function(e){var a=Math.floor((235*e-234)/19),n=12084+13753*a,r=a*29+Math.floor(n/25920);return M(3*(r+1),7)<3&&r++,r},_delay2:function(e){var a=this._delay1(e-1),n=this._delay1(e),r=this._delay1(e+1);return r-n===356?2:n-a===382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var a=Math.floor((e-this.jdEpoch)*98496/35975351)-1;e>=this.toJD(a===-1?1:a+1,7,1);)a++;for(var n=e<this.toJD(a,1,1)?7:1;e>this.toJD(a,n,this.daysInMonth(a,n));)n++;var r=e-this.toJD(a,n,1)+1;return this.newDate(a,n,r)}});function M(e,a){return e-a*Math.floor(e/a)}A.calendars.hebrew=S},{"../main":347,"object-assign":247}],338:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khams","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(M){var e=this._validate(M,this.minMonth,this.minDay,A.local.invalidYear);return(e.year()*11+14)%30<11},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(M){return this.leapYear(M)?355:354},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,A.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===12&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return this.dayOfWeek(M,e,a)!==5},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);return M=n.year(),e=n.month(),a=n.day(),M=M<=0?M+1:M,a+Math.ceil(29.5*(e-1))+(M-1)*354+Math.floor((3+11*M)/30)+this.jdEpoch-1},fromJD:function(M){M=Math.floor(M)+.5;var e=Math.floor((30*(M-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var a=Math.min(12,Math.ceil((M-29-this.toJD(e,1,1))/29.5)+1),n=M-this.toJD(e,a,1)+1;return this.newDate(e,a,n)}}),A.calendars.islamic=S},{"../main":347,"object-assign":247}],339:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),a=e.year()<0?e.year()+1:e.year();return a%4===0},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(M,e){var a=this._validate(M,e,this.minDay,A.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===2&&this.leapYear(a.year())?1:0)},weekDay:function(M,e,a){return(this.dayOfWeek(M,e,a)||7)<6},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);return M=n.year(),e=n.month(),a=n.day(),M<0&&M++,e<=2&&(M--,e+=12),Math.floor(365.25*(M+4716))+Math.floor(30.6001*(e+1))+a-1524.5},fromJD:function(M){var e=Math.floor(M+.5),a=e+1524,n=Math.floor((a-122.1)/365.25),r=Math.floor(365.25*n),t=Math.floor((a-r)/30.6001),h=t-Math.floor(t<14?1:13),s=n-Math.floor(h>2?4716:4715),i=a-r-Math.floor(30.6001*t);return s<=0&&s--,this.newDate(s,h,i)}}),A.calendars.julian=S},{"../main":347,"object-assign":247}],340:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(a){return this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),!1},formatYear:function(a){var n=this._validate(a,this.minMonth,this.minDay,A.local.invalidYear);a=n.year();var r=Math.floor(a/400);a=a%400,a+=a<0?400:0;var t=Math.floor(a/20);return r+"."+t+"."+a%20},forYear:function(a){if(a=a.split("."),a.length<3)throw"Invalid Mayan year";for(var n=0,r=0;r<a.length;r++){var t=parseInt(a[r],10);if(Math.abs(t)>19||r>0&&t<0)throw"Invalid Mayan year";n=n*20+t}return n},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),18},weekOfYear:function(a,n,r){return this._validate(a,n,r,A.local.invalidDate),0},daysInYear:function(a){return this._validate(a,this.minMonth,this.minDay,A.local.invalidYear),360},daysInMonth:function(a,n){return this._validate(a,n,this.minDay,A.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(a,n,r){var t=this._validate(a,n,r,A.local.invalidDate);return t.day()},weekDay:function(a,n,r){return this._validate(a,n,r,A.local.invalidDate),!0},extraInfo:function(a,n,r){var t=this._validate(a,n,r,A.local.invalidDate),h=t.toJD(),s=this._toHaab(h),i=this._toTzolkin(h);return{haabMonthName:this.local.haabMonths[s[0]-1],haabMonth:s[0],haabDay:s[1],tzolkinDayName:this.local.tzolkinMonths[i[0]-1],tzolkinDay:i[0],tzolkinTrecena:i[1]}},_toHaab:function(a){a-=this.jdEpoch;var n=M(a+8+(18-1)*20,365);return[Math.floor(n/20)+1,M(n,20)]},_toTzolkin:function(a){return a-=this.jdEpoch,[e(a+20,20),e(a+4,13)]},toJD:function(a,n,r){var t=this._validate(a,n,r,A.local.invalidDate);return t.day()+t.month()*20+t.year()*360+this.jdEpoch},fromJD:function(a){a=Math.floor(a)+.5-this.jdEpoch;var n=Math.floor(a/360);a=a%360,a+=a<0?360:0;var r=Math.floor(a/20),t=a%20;return this.newDate(n,r,t)}});function M(a,n){return a-n*Math.floor(a/n)}function e(a,n){return M(a-1,n)+1}A.calendars.mayan=S},{"../main":347,"object-assign":247}],341:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar;var M=A.instance("gregorian");g(S.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear||A.regionalOptions[""].invalidYear);return M.leapYear(a.year()+(a.year()<1?1:0)+1469)},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(1-(r.dayOfWeek()||7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,A.local.invalidMonth),t=r.year();t<0&&t++;for(var h=r.day(),s=1;s<r.month();s++)h+=this.daysPerMonth[s-1];return h+M.toJD(t+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var a=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(a+1,1,1);)a++;for(var n=e-Math.floor(this.toJD(a,1,1)+.5)+1,r=1;n>this.daysInMonth(a,r);)n-=this.daysInMonth(a,r),r++;return this.newDate(a,r,n)}}),A.calendars.nanakshahi=S},{"../main":347,"object-assign":247}],342:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(M){this.local=this.regionalOptions[M||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(M){return this.daysInYear(M)!==this.daysPerYear},weekOfYear:function(M,e,a){var n=this.newDate(M,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(M){var e=this._validate(M,this.minMonth,this.minDay,A.local.invalidYear);if(M=e.year(),typeof this.NEPALI_CALENDAR_DATA[M]>"u")return this.daysPerYear;for(var a=0,n=this.minMonth;n<=12;n++)a+=this.NEPALI_CALENDAR_DATA[M][n];return a},daysInMonth:function(M,e){return M.year&&(e=M.month(),M=M.year()),this._validate(M,e,this.minDay,A.local.invalidMonth),typeof this.NEPALI_CALENDAR_DATA[M]>"u"?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[M][e]},weekDay:function(M,e,a){return this.dayOfWeek(M,e,a)!==6},toJD:function(M,e,a){var n=this._validate(M,e,a,A.local.invalidDate);M=n.year(),e=n.month(),a=n.day();var r=A.instance(),t=0,h=e,s=M;this._createMissingCalendarData(M);var i=M-(h>9||h===9&&a>=this.NEPALI_CALENDAR_DATA[s][0]?56:57);for(e!==9&&(t=a,h--);h!==9;)h<=0&&(h=12,s--),t+=this.NEPALI_CALENDAR_DATA[s][h],h--;return e===9?(t+=a-this.NEPALI_CALENDAR_DATA[s][0],t<0&&(t+=r.daysInYear(i))):t+=this.NEPALI_CALENDAR_DATA[s][9]-this.NEPALI_CALENDAR_DATA[s][0],r.newDate(i,1,1).add(t,"d").toJD()},fromJD:function(M){var e=A.instance(),a=e.fromJD(M),n=a.year(),r=a.dayOfYear(),t=n+56;this._createMissingCalendarData(t);for(var h=9,s=this.NEPALI_CALENDAR_DATA[t][0],i=this.NEPALI_CALENDAR_DATA[t][h]-s+1;r>i;)h++,h>12&&(h=1,t++),i+=this.NEPALI_CALENDAR_DATA[t][h];var x=this.NEPALI_CALENDAR_DATA[t][h]-(i-r);return this.newDate(t,h,x)},_createMissingCalendarData:function(M){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var a=M-1;a<M+2;a++)typeof this.NEPALI_CALENDAR_DATA[a]>"u"&&(this.NEPALI_CALENDAR_DATA[a]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),A.calendars.nepali=S},{"../main":347,"object-assign":247}],343:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Chharshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear);return((a.year()-(a.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-((r.dayOfWeek()+1)%7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==5},toJD:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate);e=r.year(),a=r.month(),n=r.day();var t=e-(e>=0?474:473),h=474+M(t,2820);return n+(a<=7?(a-1)*31:(a-1)*30+6)+Math.floor((h*682-110)/2816)+(h-1)*365+Math.floor(t/2820)*1029983+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var a=e-this.toJD(475,1,1),n=Math.floor(a/1029983),r=M(a,1029983),t=2820;if(r!==1029982){var h=Math.floor(r/366),s=M(r,366);t=Math.floor((2134*h+2816*s+2815)/1028522)+h+1}var i=t+2820*n+474;i=i<=0?i-1:i;var x=e-this.toJD(i,1,1)+1,p=x<=186?Math.ceil(x/31):Math.ceil((x-6)/30),v=e-this.toJD(i,p,1)+1;return this.newDate(i,p,v)}});function M(e,a){return e-a*Math.floor(e/a)}A.calendars.persian=S,A.calendars.jalali=S},{"../main":347,"object-assign":247}],344:[function(y,ee,te){var A=y("../main"),g=y("object-assign"),S=A.instance();function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new A.baseCalendar,g(M.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(n){var a=this._validate(n,this.minMonth,this.minDay,A.local.invalidYear),n=this._t2gYear(a.year());return S.leapYear(n)},weekOfYear:function(t,a,n){var r=this._validate(t,this.minMonth,this.minDay,A.local.invalidYear),t=this._t2gYear(r.year());return S.weekOfYear(t,r.month(),r.day())},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,A.local.invalidDate),t=this._t2gYear(r.year());return S.toJD(t,r.month(),r.day())},fromJD:function(e){var a=S.fromJD(e),n=this._g2tYear(a.year());return this.newDate(n,a.month(),a.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),A.calendars.taiwan=M},{"../main":347,"object-assign":247}],345:[function(y,ee,te){var A=y("../main"),g=y("object-assign"),S=A.instance();function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new A.baseCalendar,g(M.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(n){var a=this._validate(n,this.minMonth,this.minDay,A.local.invalidYear),n=this._t2gYear(a.year());return S.leapYear(n)},weekOfYear:function(t,a,n){var r=this._validate(t,this.minMonth,this.minDay,A.local.invalidYear),t=this._t2gYear(r.year());return S.weekOfYear(t,r.month(),r.day())},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,A.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,A.local.invalidDate),t=this._t2gYear(r.year());return S.toJD(t,r.month(),r.day())},fromJD:function(e){var a=S.fromJD(e),n=this._g2tYear(a.year());return this.newDate(n,a.month(),a.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),A.calendars.thai=M},{"../main":347,"object-assign":247}],346:[function(y,ee,te){var A=y("../main"),g=y("object-assign");function S(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}S.prototype=new A.baseCalendar,g(S.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thalth","Yawm al-Arba","Yawm al-Khams","Yawm al-Juma","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,A.local.invalidYear);return this.daysInYear(a.year())===355},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var a=0,n=1;n<=12;n++)a+=this.daysInMonth(e,n);return a},daysInMonth:function(e,a){for(var n=this._validate(e,a,this.minDay,A.local.invalidMonth),r=n.toJD()-24e5+.5,t=0,h=0;h<M.length;h++){if(M[h]>r)return M[t]-M[t-1];t++}return 30},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==5},toJD:function(e,a,n){var r=this._validate(e,a,n,A.local.invalidDate),t=12*(r.year()-1)+r.month()-15292,h=r.day()+M[t-1]-1;return h+24e5-.5},fromJD:function(e){for(var a=e-24e5+.5,n=0,r=0;r<M.length&&!(M[r]>a);r++)n++;var t=n+15292,h=Math.floor((t-1)/12),s=h+1,i=t-12*h,x=a-M[n-1]+1;return this.newDate(s,i,x)},isValid:function(e,a,n){var r=A.baseCalendar.prototype.isValid.apply(this,arguments);return r&&(e=e.year!=null?e.year:e,r=e>=1276&&e<=1500),r},_validate:function(e,a,n,r){var t=A.baseCalendar.prototype._validate.apply(this,arguments);if(t.year<1276||t.year>1500)throw r.replace(/\{0\}/,this.local.name);return t}}),A.calendars.ummalqura=S;var M=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(y,ee,te){var A=y("object-assign");function g(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}A(g.prototype,{instance:function(r,t){r=(r||"gregorian").toLowerCase(),t=t||"";var h=this._localCals[r+"-"+t];if(!h&&this.calendars[r]&&(h=new this.calendars[r](t),this._localCals[r+"-"+t]=h),!h)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,r);return h},newDate:function(r,t,h,s,i){return s=(r!=null&&r.year?r.calendar():typeof s=="string"?this.instance(s,i):s)||this.instance(),s.newDate(r,t,h)},substituteDigits:function(r){return function(t){return(t+"").replace(/[0-9]/g,function(h){return r[h]})}},substituteChineseDigits:function(r,t){return function(h){for(var s="",i=0;h>0;){var x=h%10;s=(x===0?"":r[x]+t[i])+s,i++,h=Math.floor(h/10)}return s.indexOf(r[1]+t[1])===0&&(s=s.substr(1)),s||r[0]}}});function S(r,t,h,s){if(this._calendar=r,this._year=t,this._month=h,this._day=s,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function M(r,t){return r=""+r,"000000".substring(0,t-r.length)+r}A(S.prototype,{newDate:function(r,t,h){return this._calendar.newDate(r??this,t,h)},year:function(r){return arguments.length===0?this._year:this.set(r,"y")},month:function(r){return arguments.length===0?this._month:this.set(r,"m")},day:function(r){return arguments.length===0?this._day:this.set(r,"d")},date:function(r,t,h){if(!this._calendar.isValid(r,t,h))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=r,this._month=t,this._day=h,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(r,t){return this._calendar.add(this,r,t)},set:function(r,t){return this._calendar.set(this,r,t)},compareTo:function(r){if(this._calendar.name!==r._calendar.name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,r._calendar.local.name);var t=this._year!==r._year?this._year-r._year:this._month!==r._month?this.monthOfYear()-r.monthOfYear():this._day-r._day;return t===0?0:t<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(r){return this._calendar.fromJD(r)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(r){return this._calendar.fromJSDate(r)},toString:function(){return(this.year()<0?"-":"")+M(Math.abs(this.year()),4)+"-"+M(this.month(),2)+"-"+M(this.day(),2)}});function e(){this.shortYearCutoff="+10"}A(e.prototype,{_validateLevel:0,newDate:function(r,t,h){return r==null?this.today():(r.year&&(this._validate(r,t,h,n.local.invalidDate||n.regionalOptions[""].invalidDate),h=r.day(),t=r.month(),r=r.year()),new S(this,r,t,h))},today:function(){return this.fromJSDate(new Date)},epoch:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return t.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(t.year()<0?"-":"")+M(Math.abs(t.year()),4)},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),12},monthOfYear:function(r,t){var h=this._validate(r,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return(h.month()+this.monthsInYear(h)-this.firstMonth)%this.monthsInYear(h)+this.minMonth},fromMonthOfYear:function(r,t){var h=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(r)+this.minMonth;return this._validate(r,h,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth),h},daysInYear:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(r,t,h){var s=this._validate(r,t,h,n.local.invalidDate||n.regionalOptions[""].invalidDate);return s.toJD()-this.newDate(s.year(),this.fromMonthOfYear(s.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(r,t,h){var s=this._validate(r,t,h,n.local.invalidDate||n.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(s))+2)%this.daysInWeek()},extraInfo:function(r,t,h){return this._validate(r,t,h,n.local.invalidDate||n.regionalOptions[""].invalidDate),{}},add:function(r,t,h){return this._validate(r,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate),this._correctAdd(r,this._add(r,t,h),t,h)},_add:function(r,t,h){if(this._validateLevel++,h==="d"||h==="w"){var s=r.toJD()+t*(h==="w"?this.daysInWeek():1),i=r.calendar().fromJD(s);return this._validateLevel--,[i.year(),i.month(),i.day()]}try{var x=r.year()+(h==="y"?t:0),p=r.monthOfYear()+(h==="m"?t:0),i=r.day(),v=function(o){for(;p<o.minMonth;)x--,p+=o.monthsInYear(x);for(var m=o.monthsInYear(x);p>m-1+o.minMonth;)x++,p-=m,m=o.monthsInYear(x)};h==="y"?(r.month()!==this.fromMonthOfYear(x,p)&&(p=this.newDate(x,r.month(),this.minDay).monthOfYear()),p=Math.min(p,this.monthsInYear(x)),i=Math.min(i,this.daysInMonth(x,this.fromMonthOfYear(x,p)))):h==="m"&&(v(this),i=Math.min(i,this.daysInMonth(x,this.fromMonthOfYear(x,p))));var f=[x,this.fromMonthOfYear(x,p),i];return this._validateLevel--,f}catch(d){throw this._validateLevel--,d}},_correctAdd:function(r,t,h,s){if(!this.hasYearZero&&(s==="y"||s==="m")&&(t[0]===0||r.year()>0!=t[0]>0)){var i={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[s],x=h<0?-1:1;t=this._add(r,h*i[0]+x*i[1],i[2])}return r.date(t[0],t[1],t[2])},set:function(r,t,h){this._validate(r,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate);var s=h==="y"?t:r.year(),i=h==="m"?t:r.month(),x=h==="d"?t:r.day();return(h==="y"||h==="m")&&(x=Math.min(x,this.daysInMonth(s,i))),r.date(s,i,x)},isValid:function(r,t,h){this._validateLevel++;var s=this.hasYearZero||r!==0;if(s){var i=this.newDate(r,t,this.minDay);s=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(i)&&h>=this.minDay&&h-this.minDay<this.daysInMonth(i)}return this._validateLevel--,s},toJSDate:function(r,t,h){var s=this._validate(r,t,h,n.local.invalidDate||n.regionalOptions[""].invalidDate);return n.instance().fromJD(this.toJD(s)).toJSDate()},fromJSDate:function(r){return this.fromJD(n.instance().fromJSDate(r).toJD())},_validate:function(r,t,h,s){if(r.year){if(this._validateLevel===0&&this.name!==r.calendar().name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,r.calendar().local.name);return r}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(r,t,h))throw s.replace(/\{0\}/,this.local.name);var i=this.newDate(r,t,h);return this._validateLevel--,i}catch(x){throw this._validateLevel--,x}}});function a(r){this.local=this.regionalOptions[r]||this.regionalOptions[""]}a.prototype=new e,A(a.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(h){var t=this._validate(h,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),h=t.year()+(t.year()<0?1:0);return h%4===0&&(h%100!==0||h%400===0)},weekOfYear:function(r,t,h){var s=this.newDate(r,t,h);return s.add(4-(s.dayOfWeek()||7),"d"),Math.floor((s.dayOfYear()-1)/7)+1},daysInMonth:function(r,t){var h=this._validate(r,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return this.daysPerMonth[h.month()-1]+(h.month()===2&&this.leapYear(h.year())?1:0)},weekDay:function(r,t,h){return(this.dayOfWeek(r,t,h)||7)<6},toJD:function(r,t,h){var s=this._validate(r,t,h,n.local.invalidDate||n.regionalOptions[""].invalidDate);r=s.year(),t=s.month(),h=s.day(),r<0&&r++,t<3&&(t+=12,r--);var i=Math.floor(r/100),x=2-i+Math.floor(i/4);return Math.floor(365.25*(r+4716))+Math.floor(30.6001*(t+1))+h+x-1524.5},fromJD:function(r){var t=Math.floor(r+.5),h=Math.floor((t-186721625e-2)/36524.25);h=t+1+h-Math.floor(h/4);var s=h+1524,i=Math.floor((s-122.1)/365.25),x=Math.floor(365.25*i),p=Math.floor((s-x)/30.6001),v=s-x-Math.floor(p*30.6001),f=p-(p>13.5?13:1),d=i-(f>2.5?4716:4715);return d<=0&&d--,this.newDate(d,f,v)},toJSDate:function(r,t,h){var s=this._validate(r,t,h,n.local.invalidDate||n.regionalOptions[""].invalidDate),i=new Date(s.year(),s.month()-1,s.day());return i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i.setHours(i.getHours()>12?i.getHours()+2:0),i},fromJSDate:function(r){return this.newDate(r.getFullYear(),r.getMonth()+1,r.getDate())}});var n=ee.exports=new g;n.cdate=S,n.baseCalendar=e,n.calendars.gregorian=a},{"object-assign":247}],348:[function(y,ee,te){var A=y("object-assign"),g=y("./main");A(g.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),g.local=g.regionalOptions[""],A(g.cdate.prototype,{formatDate:function(S,M){return typeof S!="string"&&(M=S,S=""),this._calendar.formatDate(S||"",this,M)}}),A(g.baseCalendar.prototype,{UNIX_EPOCH:g.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:g.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(S,M,e){if(typeof S!="string"&&(e=M,M=S,S=""),!M)return"";if(M.calendar()!==this)throw g.local.invalidFormat||g.regionalOptions[""].invalidFormat;S=S||this.local.dateFormat,e=e||{};var a=e.dayNamesShort||this.local.dayNamesShort,n=e.dayNames||this.local.dayNames,r=e.monthNumbers||this.local.monthNumbers,t=e.monthNamesShort||this.local.monthNamesShort,h=e.monthNames||this.local.monthNames;e.calculateWeek||this.local.calculateWeek;for(var s=function(_,c){for(var b=1;w+b<S.length&&S.charAt(w+b)===_;)b++;return w+=b-1,Math.floor(b/(c||1))>1},i=function(_,c,b,u){var L=""+c;if(s(_,u))for(;L.length<b;)L="0"+L;return L},x=function(_,c,b,u){return s(_)?u[c]:b[c]},p=this,v=function(_){return typeof r=="function"?r.call(p,_,s("m")):o(i("m",_.month(),2))},f=function(_,c){return c?typeof h=="function"?h.call(p,_):h[_.month()-p.minMonth]:typeof t=="function"?t.call(p,_):t[_.month()-p.minMonth]},d=this.local.digits,o=function(_){return e.localNumbers&&d?d(_):_},m="",l=!1,w=0;w<S.length;w++)if(l)S.charAt(w)==="'"&&!s("'")?l=!1:m+=S.charAt(w);else switch(S.charAt(w)){case"d":m+=o(i("d",M.day(),2));break;case"D":m+=x("D",M.dayOfWeek(),a,n);break;case"o":m+=i("o",M.dayOfYear(),3);break;case"w":m+=i("w",M.weekOfYear(),2);break;case"m":m+=v(M);break;case"M":m+=f(M,s("M"));break;case"y":m+=s("y",2)?M.year():(M.year()%100<10?"0":"")+M.year()%100;break;case"Y":s("Y",2),m+=M.formatYear();break;case"J":m+=M.toJD();break;case"@":m+=(M.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":m+=(M.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":s("'")?m+="'":l=!0;break;default:m+=S.charAt(w)}return m},parseDate:function(S,M,e){if(M==null)throw g.local.invalidArguments||g.regionalOptions[""].invalidArguments;if(M=typeof M=="object"?M.toString():M+"",M==="")return null;S=S||this.local.dateFormat,e=e||{};var a=e.shortYearCutoff||this.shortYearCutoff;a=typeof a!="string"?a:this.today().year()%100+parseInt(a,10);for(var n=e.dayNamesShort||this.local.dayNamesShort,r=e.dayNames||this.local.dayNames,t=e.parseMonth||this.local.parseMonth,h=e.monthNumbers||this.local.monthNumbers,s=e.monthNamesShort||this.local.monthNamesShort,i=e.monthNames||this.local.monthNames,x=-1,p=-1,v=-1,f=-1,d=-1,o=!1,m=!1,l=function(I,D){for(var R=1;k+R<S.length&&S.charAt(k+R)===I;)R++;return k+=R-1,Math.floor(R/(D||1))>1},w=function(I,D){var R=l(I,D),O=[2,3,R?4:2,R?4:2,10,11,20]["oyYJ@!".indexOf(I)+1],F=new RegExp("^-?\\d{1,"+O+"}"),N=M.substring(T).match(F);if(!N)throw(g.local.missingNumberAt||g.regionalOptions[""].missingNumberAt).replace(/\{0\}/,T);return T+=N[0].length,parseInt(N[0],10)},_=this,c=function(){if(typeof h=="function"){l("m");var I=h.call(_,M.substring(T));return T+=I.length,I}return w("m")},b=function(I,D,R,O){for(var F=l(I,O)?R:D,N=0;N<F.length;N++)if(M.substr(T,F[N].length).toLowerCase()===F[N].toLowerCase())return T+=F[N].length,N+_.minMonth;throw(g.local.unknownNameAt||g.regionalOptions[""].unknownNameAt).replace(/\{0\}/,T)},u=function(){if(typeof i=="function"){var I=l("M")?i.call(_,M.substring(T)):s.call(_,M.substring(T));return T+=I.length,I}return b("M",s,i)},L=function(){if(M.charAt(T)!==S.charAt(k))throw(g.local.unexpectedLiteralAt||g.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,T);T++},T=0,k=0;k<S.length;k++)if(m)S.charAt(k)==="'"&&!l("'")?m=!1:L();else switch(S.charAt(k)){case"d":f=w("d");break;case"D":b("D",n,r);break;case"o":d=w("o");break;case"w":w("w");break;case"m":v=c();break;case"M":v=u();break;case"y":var P=k;o=!l("y",2),k=P,p=w("y",2);break;case"Y":p=w("Y",2);break;case"J":x=w("J")+.5,M.charAt(T)==="."&&(T++,w("J"));break;case"@":x=w("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":x=w("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":T=M.length;break;case"'":l("'")?L():m=!0;break;default:L()}if(T<M.length)throw g.local.unexpectedText||g.regionalOptions[""].unexpectedText;if(p===-1?p=this.today().year():p<100&&o&&(p+=a===-1?1900:this.today().year()-this.today().year()%100-(p<=a?0:100)),typeof v=="string"&&(v=t.call(this,p,v)),d>-1){v=1,f=d;for(var z=this.daysInMonth(p,v);f>z;z=this.daysInMonth(p,v))v++,f-=z}return x>-1?this.fromJD(x):this.newDate(p,v,f)},determineDate:function(S,M,e,a,n){e&&typeof e!="object"&&(n=a,a=e,e=null),typeof a!="string"&&(n=a,a="");var r=this,t=function(h){try{return r.parseDate(a,h,n)}catch{}h=h.toLowerCase();for(var s=(h.match(/^c/)&&e?e.newDate():null)||r.today(),i=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,x=i.exec(h);x;)s.add(parseInt(x[1],10),x[2]||"d"),x=i.exec(h);return s};return M=M?M.newDate():null,S=S==null?M:typeof S=="string"?t(S):typeof S=="number"?isNaN(S)||S===1/0||S===-1/0?M:r.today().add(S,"d"):r.newDate(S),S}})},{"./main":347,"object-assign":247}],349:[function(y,ee,te){ee.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(y,ee,te){var A=y("./arrow_paths"),g=y("../../plots/font_attributes"),S=y("../../plots/cartesian/constants"),M=y("../../plot_api/plot_template").templatedArray;y("../../constants/axis_placeable_objects"),ee.exports=M("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:g({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:A.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:A.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",S.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",S.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",S.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",S.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:g({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("./draw").draw;ee.exports=function(n){var r=n._fullLayout,t=A.filterVisible(r.annotations);if(t.length&&n._fullData.length)return A.syncOrAsync([S,M],n)};function M(a){var n=a._fullLayout;A.filterVisible(n.annotations).forEach(function(r){var t=g.getFromId(a,r.xref),h=g.getFromId(a,r.yref),s=g.getRefType(r.xref),i=g.getRefType(r.yref);r._extremes={},s==="range"&&e(r,t),i==="range"&&e(r,h)})}function e(a,n){var r=n._id,t=r.charAt(0),h=a[t],s=a["a"+t],i=a[t+"ref"],x=a["a"+t+"ref"],p=a["_"+t+"padplus"],v=a["_"+t+"padminus"],f={x:1,y:-1}[t]*a[t+"shift"],d=3*a.arrowsize*a.arrowwidth||0,o=d+f,m=d-f,l=3*a.startarrowsize*a.arrowwidth||0,w=l+f,_=l-f,c;if(x===i){var b=g.findExtremes(n,[n.r2c(h)],{ppadplus:o,ppadminus:m}),u=g.findExtremes(n,[n.r2c(s)],{ppadplus:Math.max(p,w),ppadminus:Math.max(v,_)});c={min:[b.min[0],u.min[0]],max:[b.max[0],u.max[0]]}}else w=s?w+s:w,_=s?_-s:_,c=g.findExtremes(n,[n.r2c(h)],{ppadplus:Math.max(p,o,w),ppadminus:Math.max(v,m,_)});a._extremes[r]=c}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(y,ee,te){var A=y("../../lib"),g=y("../../registry"),S=y("../../plot_api/plot_template").arrayEditor;ee.exports={hasClickToShow:M,onClick:e};function M(r,t){var h=a(r,t);return h.on.length>0||h.explicitOff.length>0}function e(r,t){var h=a(r,t),s=h.on,i=h.off.concat(h.explicitOff),x={},p=r._fullLayout.annotations,v,f;if(s.length||i.length){for(v=0;v<s.length;v++)f=S(r.layout,"annotations",p[s[v]]),f.modifyItem("visible",!0),A.extendFlat(x,f.getUpdateObj());for(v=0;v<i.length;v++)f=S(r.layout,"annotations",p[i[v]]),f.modifyItem("visible",!1),A.extendFlat(x,f.getUpdateObj());return g.call("update",r,{},x)}}function a(r,t){var h=r._fullLayout.annotations,s=[],i=[],x=[],p=(t||[]).length,v,f,d,o,m,l,w,_;for(v=0;v<h.length;v++)if(d=h[v],o=d.clicktoshow,o){for(f=0;f<p;f++)if(m=t[f],l=m.xaxis,w=m.yaxis,l._id===d.xref&&w._id===d.yref&&l.d2r(m.x)===n(d._xclick,l)&&w.d2r(m.y)===n(d._yclick,w)){d.visible?o==="onout"?_=i:_=x:_=s,_.push(v);break}f===p&&d.visible&&o==="onout"&&i.push(v)}return{on:s,off:i,explicitOff:x}}function n(r,t){return t.type==="log"?t.l2r(r):t.d2r(r)}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(y,ee,te){var A=y("../../lib"),g=y("../color");ee.exports=function(M,e,a,n){n("opacity");var r=n("bgcolor"),t=n("bordercolor"),h=g.opacity(t);n("borderpad");var s=n("borderwidth"),i=n("showarrow");n("text",i?" ":a._dfltTitle.annotation),n("textangle"),A.coerceFont(n,"font",a.font),n("width"),n("align");var x=n("height");if(x&&n("valign"),i){var p=n("arrowside"),v,f;p.indexOf("end")!==-1&&(v=n("arrowhead"),f=n("arrowsize")),p.indexOf("start")!==-1&&(n("startarrowhead",v),n("startarrowsize",f)),n("arrowcolor",h?e.bordercolor:g.defaultLine),n("arrowwidth",(h&&s||1)*2),n("standoff"),n("startstandoff")}var d=n("hovertext"),o=a.hoverlabel||{};if(d){var m=n("hoverlabel.bgcolor",o.bgcolor||(g.opacity(r)?g.rgb(r):g.defaultLine)),l=n("hoverlabel.bordercolor",o.bordercolor||g.contrast(m));A.coerceFont(n,"hoverlabel.font",{family:o.font.family,size:o.font.size,color:o.font.color||l})}n("captureevents",!!d)}},{"../../lib":515,"../color":367}],354:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib/to_log_range");ee.exports=function(M,e,a,n){e=e||{};var r=a==="log"&&e.type==="linear",t=a==="linear"&&e.type==="log";if(!(r||t))return;var h=M._fullLayout.annotations,s=e._id.charAt(0),i,x;function p(f){var d=i[f],o=null;r?o=g(d,e.range):o=Math.pow(10,d),A(o)||(o=null),n(x+f,o)}for(var v=0;v<h.length;v++)i=h[v],x="annotations["+v+"].",i[s+"ref"]===e._id&&p(s),i["a"+s+"ref"]===e._id&&p("a"+s)}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("../../plots/array_container_defaults"),M=y("./common_defaults"),e=y("./attributes");ee.exports=function(r,t){S(r,t,{name:"annotations",handleItemDefaults:a})};function a(n,r,t){function h(L,T){return A.coerce(n,r,e,L,T)}var s=h("visible"),i=h("clicktoshow");if(s||i){M(n,r,t,h);for(var x=r.showarrow,p=["x","y"],v=[-10,-30],f={_fullLayout:t},d=0;d<2;d++){var o=p[d],m=g.coerceRef(n,r,f,o,"","paper");if(m!=="paper"){var l=g.getFromId(f,m);l._annIndices.push(r._index)}if(g.coercePosition(r,f,h,m,o,.5),x){var w="a"+o,_=g.coerceRef(n,r,f,w,"pixel",["pixel","paper"]);_!=="pixel"&&_!==m&&(_=r[w]="pixel");var c=_==="pixel"?v[d]:.4;g.coercePosition(r,f,h,_,w,c)}h(o+"anchor"),h(o+"shift")}if(A.noneOrAll(n,r,["x","y"]),x&&A.noneOrAll(n,r,["ax","ay"]),i){var b=h("xclick"),u=h("yclick");r._xclick=b===void 0?r.x:g.cleanPosition(b,f,r.xref),r._yclick=u===void 0?r.y:g.cleanPosition(u,f,r.yref)}}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../registry"),S=y("../../plots/plots"),M=y("../../lib"),e=M.strTranslate,a=y("../../plots/cartesian/axes"),n=y("../color"),r=y("../drawing"),t=y("../fx"),h=y("../../lib/svg_text_utils"),s=y("../../lib/setcursor"),i=y("../dragelement"),x=y("../../plot_api/plot_template").arrayEditor,p=y("./draw_arrow_head");ee.exports={draw:v,drawOne:f,drawRaw:o};function v(m){var l=m._fullLayout;l._infolayer.selectAll(".annotation").remove();for(var w=0;w<l.annotations.length;w++)l.annotations[w].visible&&f(m,w);return S.previousPromises(m)}function f(m,l){var w=m._fullLayout,_=w.annotations[l]||{},c=a.getFromId(m,_.xref),b=a.getFromId(m,_.yref);c&&c.setScale(),b&&b.setScale(),o(m,_,l,!1,c,b)}function d(m,l,w,_,c){var b=c[w],u=c[w+"ref"],L=w.indexOf("y")!==-1,T=a.getRefType(u)==="domain",k=L?_.h:_.w;return m?T?b+(L?-l:l)/m._length:m.p2r(m.r2p(b)+l):b+(L?-l:l)/k}function o(m,l,w,_,c,b){var u=m._fullLayout,L=m._fullLayout._size,T=m._context.edits,k,P;_?(k="annotation-"+_,P=_+".annotations"):(k="annotation",P="annotations");var z=x(m.layout,P,l),I=z.modifyBase,D=z.modifyItem,R=z.getUpdateObj;u._infolayer.selectAll("."+k+'[data-index="'+w+'"]').remove();var O="clip"+u._uid+"_ann"+w;if(!l._input||l.visible===!1){A.selectAll("#"+O).remove();return}var F={x:{},y:{}},N=+l.textangle||0,G=u._infolayer.append("g").classed(k,!0).attr("data-index",String(w)).style("opacity",l.opacity),K=G.append("g").classed("annotation-text-g",!0),W=T[l.showarrow?"annotationTail":"annotationPosition"],Y=l.captureevents||T.annotationText||W;function re(oe){var be={index:w,annotation:l._input,fullAnnotation:l,event:oe};return _&&(be.subplotId=_),be}var ue=K.append("g").style("pointer-events",Y?"all":null).call(s,"pointer").on("click",function(){m._dragging=!1,m.emit("plotly_clickannotation",re(A.event))});l.hovertext&&ue.on("mouseover",function(){var oe=l.hoverlabel,be=oe.font,ce=this.getBoundingClientRect(),de=m.getBoundingClientRect();t.loneHover({x0:ce.left-de.left,x1:ce.right-de.left,y:(ce.top+ce.bottom)/2-de.top,text:l.hovertext,color:oe.bgcolor,borderColor:oe.bordercolor,fontFamily:be.family,fontSize:be.size,fontColor:be.color},{container:u._hoverlayer.node(),outerContainer:u._paper.node(),gd:m})}).on("mouseout",function(){t.loneUnhover(u._hoverlayer.node())});var j=l.borderwidth,q=l.borderpad,H=j+q,U=ue.append("rect").attr("class","bg").style("stroke-width",j+"px").call(n.stroke,l.bordercolor).call(n.fill,l.bgcolor),$=l.width||l.height,ne=u._topclips.selectAll("#"+O).data($?[0]:[]);ne.enter().append("clipPath").classed("annclip",!0).attr("id",O).append("rect"),ne.exit().remove();var X=l.font,Q=u._meta?M.templateString(l.text,u._meta):l.text,ie=ue.append("text").classed("annotation-text",!0).text(Q);function se(oe){return oe.call(r.font,X).attr({"text-anchor":{left:"start",right:"end"}[l.align]||"middle"}),h.convertToTspans(oe,m,ae),oe}function ae(){var oe=ie.selectAll("a");if(oe.size()===1&&oe.text()===ie.text()){var be=ue.insert("a",":first-child").attr({"xlink:xlink:href":oe.attr("xlink:href"),"xlink:xlink:show":oe.attr("xlink:show")}).style({cursor:"pointer"});be.node().appendChild(U.node())}var ce=ue.select(".annotation-text-math-group"),de=!ce.empty(),ye=r.bBox((de?ce:ie).node()),ge=ye.width,me=ye.height,Ee=l.width||ge,Pe=l.height||me,Ue=Math.round(Ee+2*H),we=Math.round(Pe+2*H);function ke($t,Jt){return Jt==="auto"&&($t<1/3?Jt="left":$t>2/3?Jt="right":Jt="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[Jt]}for(var Xe=!1,Ve=["x","y"],Ie=0;Ie<Ve.length;Ie++){var De=Ve[Ie],Ye=l[De+"ref"]||De,vt=l["a"+De+"ref"],Dt={x:c,y:b}[De],Kt=(N+(De==="x"?0:-90))*Math.PI/180,Ft=Ue*Math.cos(Kt),Mt=we*Math.sin(Kt),Xt=Math.abs(Ft)+Math.abs(Mt),It=l[De+"anchor"],At=l[De+"shift"]*(De==="x"?1:-1),Ge=F[De],tt,He,Ae,Ne,Ze,Qe=a.getRefType(Ye);if(Dt&&Qe!=="domain"){var bt=Dt.r2fraction(l[De]);(bt<0||bt>1)&&(vt===Ye?(bt=Dt.r2fraction(l["a"+De]),(bt<0||bt>1)&&(Xe=!0)):Xe=!0),tt=Dt._offset+Dt.r2p(l[De]),Ne=.5}else{var dt=Qe==="domain";De==="x"?(Ae=l[De],tt=dt?Dt._offset+Dt._length*Ae:tt=L.l+L.w*Ae):(Ae=1-l[De],tt=dt?Dt._offset+Dt._length*Ae:tt=L.t+L.h*Ae),Ne=l.showarrow?.5:Ae}if(l.showarrow){Ge.head=tt;var wt=l["a"+De];if(Ze=Ft*ke(.5,l.xanchor)-Mt*ke(.5,l.yanchor),vt===Ye){var Ut=a.getRefType(vt);Ut==="domain"?(De==="y"&&(wt=1-wt),Ge.tail=Dt._offset+Dt._length*wt):Ut==="paper"?De==="y"?(wt=1-wt,Ge.tail=L.t+L.h*wt):Ge.tail=L.l+L.w*wt:Ge.tail=Dt._offset+Dt.r2p(wt),He=Ze}else Ge.tail=tt+wt,He=Ze+wt;Ge.text=Ge.tail+Ze;var Rt=u[De==="x"?"width":"height"];if(Ye==="paper"&&(Ge.head=M.constrain(Ge.head,1,Rt-1)),vt==="pixel"){var Nt=-Math.max(Ge.tail-3,Ge.text),Wt=Math.min(Ge.tail+3,Ge.text)-Rt;Nt>0?(Ge.tail+=Nt,Ge.text+=Nt):Wt>0&&(Ge.tail-=Wt,Ge.text-=Wt)}Ge.tail+=At,Ge.head+=At}else Ze=Xt*ke(Ne,It),He=Ze,Ge.text=tt+Ze;Ge.text+=At,Ze+=At,He+=At,l["_"+De+"padplus"]=Xt/2+He,l["_"+De+"padminus"]=Xt/2-He,l["_"+De+"size"]=Xt,l["_"+De+"shift"]=Ze}if(Xe){ue.remove();return}var Vt=0,ir=0;if(l.align!=="left"&&(Vt=(Ee-ge)*(l.align==="center"?.5:1)),l.valign!=="top"&&(ir=(Pe-me)*(l.valign==="middle"?.5:1)),de)ce.select("svg").attr({x:H+Vt-1,y:H+ir}).call(r.setClipUrl,$?O:null,m);else{var Hr=H+ir-ye.top,sn=H+Vt-ye.left;ie.call(h.positionText,sn,Hr).call(r.setClipUrl,$?O:null,m)}ne.select("rect").call(r.setRect,H,H,Ee,Pe),U.call(r.setRect,j/2,j/2,Ue-j,we-j),ue.call(r.setTranslate,Math.round(F.x.text-Ue/2),Math.round(F.y.text-we/2)),K.attr({transform:"rotate("+N+","+F.x.text+","+F.y.text+")"});var jr=function($t,Jt){G.selectAll(".annotation-arrow-g").remove();var Gt=F.x.head,_r=F.y.head,rt=F.x.tail+$t,Je=F.y.tail+Jt,st=F.x.text+$t,lt=F.y.text+Jt,Tt=M.rotationXYMatrix(N,st,lt),zt=M.apply2DTransform(Tt),Ce=M.apply2DTransform2(Tt),Se=+U.attr("width"),nt=+U.attr("height"),it=st-.5*Se,ct=it+Se,kt=lt-.5*nt,gt=kt+nt,St=[[it,kt,it,gt],[it,gt,ct,gt],[ct,gt,ct,kt],[ct,kt,it,kt]].map(Ce);if(!St.reduce(function(et,Lt){return et^!!M.segmentsIntersect(Gt,_r,Gt+1e6,_r+1e6,Lt[0],Lt[1],Lt[2],Lt[3])},!1)){St.forEach(function(et){var Lt=M.segmentsIntersect(rt,Je,Gt,_r,et[0],et[1],et[2],et[3]);Lt&&(rt=Lt.x,Je=Lt.y)});var Yt=l.arrowwidth,ar=l.arrowcolor,kr=l.arrowside,br=G.append("g").style({opacity:n.opacity(ar)}).classed("annotation-arrow-g",!0),Mr=br.append("path").attr("d","M"+rt+","+Je+"L"+Gt+","+_r).style("stroke-width",Yt+"px").call(n.stroke,n.rgb(ar));if(p(Mr,kr,l),T.annotationPosition&&Mr.node().parentNode&&!_){var Yr=Gt,nr=_r;if(l.standoff){var gr=Math.sqrt(Math.pow(Gt-rt,2)+Math.pow(_r-Je,2));Yr+=l.standoff*(rt-Gt)/gr,nr+=l.standoff*(Je-_r)/gr}var Rr=br.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(rt-Yr)+","+(Je-nr),transform:e(Yr,nr)}).style("stroke-width",Yt+6+"px").call(n.stroke,"rgba(0,0,0,0)").call(n.fill,"rgba(0,0,0,0)"),Br,Sr;i.init({element:Rr.node(),gd:m,prepFn:function(){var et=r.getTranslate(ue);Br=et.x,Sr=et.y,c&&c.autorange&&I(c._name+".autorange",!0),b&&b.autorange&&I(b._name+".autorange",!0)},moveFn:function(et,Lt){var Zt=zt(Br,Sr),or=Zt[0]+et,Ir=Zt[1]+Lt;ue.call(r.setTranslate,or,Ir),D("x",d(c,et,"x",L,l)),D("y",d(b,Lt,"y",L,l)),l.axref===l.xref&&D("ax",d(c,et,"ax",L,l)),l.ayref===l.yref&&D("ay",d(b,Lt,"ay",L,l)),br.attr("transform",e(et,Lt)),K.attr({transform:"rotate("+N+","+or+","+Ir+")"})},doneFn:function(){g.call("_guiRelayout",m,R());var et=document.querySelector(".js-notes-box-panel");et&&et.redraw(et.selectedObj)}})}}};if(l.showarrow&&jr(0,0),W){var at;i.init({element:ue.node(),gd:m,prepFn:function(){at=K.attr("transform")},moveFn:function($t,Jt){var Gt="pointer";if(l.showarrow)l.axref===l.xref?D("ax",d(c,$t,"ax",L,l)):D("ax",l.ax+$t),l.ayref===l.yref?D("ay",d(b,Jt,"ay",L.w,l)):D("ay",l.ay+Jt),jr($t,Jt);else{if(_)return;var _r,rt;if(c)_r=d(c,$t,"x",L,l);else{var Je=l._xsize/L.w,st=l.x+(l._xshift-l.xshift)/L.w-Je/2;_r=i.align(st+$t/L.w,Je,0,1,l.xanchor)}if(b)rt=d(b,Jt,"y",L,l);else{var lt=l._ysize/L.h,Tt=l.y-(l._yshift+l.yshift)/L.h-lt/2;rt=i.align(Tt-Jt/L.h,lt,0,1,l.yanchor)}D("x",_r),D("y",rt),(!c||!b)&&(Gt=i.getCursor(c?.5:_r,b?.5:rt,l.xanchor,l.yanchor))}K.attr({transform:e($t,Jt)+at}),s(ue,Gt)},clickFn:function($t,Jt){l.captureevents&&m.emit("plotly_clickannotation",re(Jt))},doneFn:function(){s(ue),g.call("_guiRelayout",m,R());var $t=document.querySelector(".js-notes-box-panel");$t&&$t.redraw($t.selectedObj)}})}}T.annotationText?ie.call(h.makeEditable,{delegate:ue,gd:m}).call(se).on("edit",function(oe){l.text=oe,this.call(se),D("text",oe),c&&c.autorange&&I(c._name+".autorange",!0),b&&b.autorange&&I(b._name+".autorange",!0),g.call("_guiRelayout",m,R())}):ie.call(se)}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../color"),S=y("./arrow_paths"),M=y("../../lib"),e=M.strScale,a=M.strRotate,n=M.strTranslate;ee.exports=function(t,h,s){var i=t.node(),x=S[s.arrowhead||0],p=S[s.startarrowhead||0],v=(s.arrowwidth||1)*(s.arrowsize||1),f=(s.arrowwidth||1)*(s.startarrowsize||1),d=h.indexOf("start")>=0,o=h.indexOf("end")>=0,m=x.backoff*v+s.standoff,l=p.backoff*f+s.startstandoff,w,_,c,b;if(i.nodeName==="line"){w={x:+t.attr("x1"),y:+t.attr("y1")},_={x:+t.attr("x2"),y:+t.attr("y2")};var u=w.x-_.x,L=w.y-_.y;if(c=Math.atan2(L,u),b=c+Math.PI,m&&l&&m+l>Math.sqrt(u*u+L*L)){K();return}if(m){if(m*m>u*u+L*L){K();return}var T=m*Math.cos(c),k=m*Math.sin(c);_.x+=T,_.y+=k,t.attr({x2:_.x,y2:_.y})}if(l){if(l*l>u*u+L*L){K();return}var P=l*Math.cos(c),z=l*Math.sin(c);w.x-=P,w.y-=z,t.attr({x1:w.x,y1:w.y})}}else if(i.nodeName==="path"){var I=i.getTotalLength(),D="";if(I<m+l){K();return}var R=i.getPointAtLength(0),O=i.getPointAtLength(.1);c=Math.atan2(R.y-O.y,R.x-O.x),w=i.getPointAtLength(Math.min(l,I)),D="0px,"+l+"px,";var F=i.getPointAtLength(I),N=i.getPointAtLength(I-.1);b=Math.atan2(F.y-N.y,F.x-N.x),_=i.getPointAtLength(Math.max(0,I-m));var G=D?l+m:m;D+=I-G+"px,"+I+"px",t.style("stroke-dasharray",D)}function K(){t.style("stroke-dasharray","0px,100px")}function W(Y,re,ue,j){Y.path&&(Y.noRotate&&(ue=0),A.select(i.parentNode).append("path").attr({class:t.attr("class"),d:Y.path,transform:n(re.x,re.y)+a(ue*180/Math.PI)+e(j)}).style({fill:g.rgb(s.arrowcolor),"stroke-width":0}))}d&&W(p,w,c,f),o&&W(x,_,b,v)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(y,ee,te){var A=y("./draw"),g=y("./click");ee.exports={moduleType:"component",name:"annotations",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),includeBasePlot:y("../../plots/cartesian/include_components")("annotations"),calcAutorange:y("./calc_autorange"),draw:A.draw,drawOne:A.drawOne,drawRaw:A.drawRaw,hasClickToShow:g.hasClickToShow,onClick:g.onClick,convertCoords:y("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(y,ee,te){var A=y("../annotations/attributes"),g=y("../../plot_api/edit_types").overrideAll,S=y("../../plot_api/plot_template").templatedArray;ee.exports=g(S("annotation",{visible:A.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:A.xanchor,xshift:A.xshift,yanchor:A.yanchor,yshift:A.yshift,text:A.text,textangle:A.textangle,font:A.font,width:A.width,height:A.height,opacity:A.opacity,align:A.align,valign:A.valign,bgcolor:A.bgcolor,bordercolor:A.bordercolor,borderpad:A.borderpad,borderwidth:A.borderwidth,showarrow:A.showarrow,arrowcolor:A.arrowcolor,arrowhead:A.arrowhead,startarrowhead:A.startarrowhead,arrowside:A.arrowside,arrowsize:A.arrowsize,startarrowsize:A.startarrowsize,arrowwidth:A.arrowwidth,standoff:A.standoff,startstandoff:A.startstandoff,hovertext:A.hovertext,hoverlabel:A.hoverlabel,captureevents:A.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes");ee.exports=function(e){for(var a=e.fullSceneLayout,n=a.annotations,r=0;r<n.length;r++)S(n[r],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()};function S(M,e){var a=e.fullSceneLayout,n=a.domain,r=e.fullLayout._size,t={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};M._xa={},A.extendFlat(M._xa,t),g.setConvert(M._xa),M._xa._offset=r.l+n.x[0]*r.w,M._xa.l2p=function(){return .5*(1+M._pdata[0]/M._pdata[3])*r.w*(n.x[1]-n.x[0])},M._ya={},A.extendFlat(M._ya,t),g.setConvert(M._ya),M._ya._offset=r.t+(1-n.y[1])*r.h,M._ya.l2p=function(){return .5*(1-M._pdata[1]/M._pdata[3])*r.h*(n.y[1]-n.y[0])}}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("../../plots/array_container_defaults"),M=y("../annotations/common_defaults"),e=y("./attributes");ee.exports=function(r,t,h){S(r,t,{name:"annotations",handleItemDefaults:a,fullLayout:h.fullLayout})};function a(n,r,t,h){function s(p,v){return A.coerce(n,r,e,p,v)}function i(p){var v=p+"axis",f={_fullLayout:{}};return f._fullLayout[v]=t[v],g.coercePosition(r,f,s,p,p,.5)}var x=s("visible");x&&(M(n,r,h.fullLayout,s),i("x"),i("y"),i("z"),A.noneOrAll(n,r,["x","y","z"]),r.xref="x",r.yref="y",r.zref="z",s("xanchor"),s("yanchor"),s("xshift"),s("yshift"),r.showarrow&&(r.axref="pixel",r.ayref="pixel",s("ax",-10),s("ay",-30),A.noneOrAll(n,r,["ax","ay"])))}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(y,ee,te){var A=y("../annotations/draw").drawRaw,g=y("../../plots/gl3d/project"),S=["x","y","z"];ee.exports=function(e){for(var a=e.fullSceneLayout,n=e.dataScale,r=a.annotations,t=0;t<r.length;t++){for(var h=r[t],s=!1,i=0;i<3;i++){var x=S[i],p=h[x],v=a[x+"axis"],f=v.r2fraction(p);if(f<0||f>1){s=!0;break}}s?e.fullLayout._infolayer.select(".annotation-"+e.id+'[data-index="'+t+'"]').remove():(h._pdata=g(e.glplot.cameraParams,[a.xaxis.r2l(h.x)*n[0],a.yaxis.r2l(h.y)*n[1],a.zaxis.r2l(h.z)*n[2]]),A(e.graphDiv,h,t,e.id,h._xa,h._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib");ee.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:y("./attributes")}}},layoutAttributes:y("./attributes"),handleDefaults:y("./defaults"),includeBasePlot:S,convert:y("./convert"),draw:y("./draw")};function S(M,e){var a=A.subplotsRegistry.gl3d;if(a)for(var n=a.attrRegex,r=Object.keys(M),t=0;t<r.length;t++){var h=r[t];n.test(h)&&(M[h].annotations||[]).length&&(g.pushUnique(e._basePlotModules,a),g.pushUnique(e._subplots.gl3d,h))}}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(y,ee,te){ee.exports=y("world-calendars/dist/main"),y("world-calendars/dist/plus"),y("world-calendars/dist/calendars/chinese"),y("world-calendars/dist/calendars/coptic"),y("world-calendars/dist/calendars/discworld"),y("world-calendars/dist/calendars/ethiopian"),y("world-calendars/dist/calendars/hebrew"),y("world-calendars/dist/calendars/islamic"),y("world-calendars/dist/calendars/julian"),y("world-calendars/dist/calendars/mayan"),y("world-calendars/dist/calendars/nanakshahi"),y("world-calendars/dist/calendars/nepali"),y("world-calendars/dist/calendars/persian"),y("world-calendars/dist/calendars/taiwan"),y("world-calendars/dist/calendars/thai"),y("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(y,ee,te){var A=y("./calendars"),g=y("../../lib"),S=y("../../constants/numerical"),M=S.EPOCHJD,e=S.ONEDAY,a={valType:"enumerated",values:g.sortObjectKeys(A.calendars),editType:"calc",dflt:"gregorian"},n=function(c,b,u,L){var T={};return T[u]=a,g.coerce(c,b,T,u,L)},r=function(c,b,u,L){for(var T=0;T<u.length;T++)n(c,b,u[T]+"calendar",L.calendar)},t={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},h={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},s={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},i="##",x={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:i,w:i,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function p(c,b,u){for(var L=Math.floor((b+.05)/e)+M,T=f(u).fromJD(L),k=0,P,z,I,D,R;(k=c.indexOf("%",k))!==-1;)P=c.charAt(k+1),P==="0"||P==="-"||P==="_"?(I=3,z=c.charAt(k+2),P==="_"&&(P="-")):(z=P,P="0",I=2),D=x[z],D?(D===i?R=i:R=T.formatDate(D[P]),c=c.substr(0,k)+R+c.substr(k+I),k+=R.length):k+=I;return c}var v={};function f(c){var b=v[c];return b||(b=v[c]=A.instance(c),b)}function d(c){return g.extendFlat({},a,{description:c})}function o(c){return"Sets the calendar system to use with `"+c+"` date data."}var m={xcalendar:d(o("x"))},l=g.extendFlat({},m,{ycalendar:d(o("y"))}),w=g.extendFlat({},l,{zcalendar:d(o("z"))}),_=d(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));ee.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:l,bar:l,box:l,heatmap:l,contour:l,histogram:l,histogram2d:l,histogram2dcontour:l,scatter3d:w,surface:w,mesh3d:w,scattergl:l,ohlc:m,candlestick:m},layout:{calendar:d(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:_},yaxis:{calendar:_},scene:{xaxis:{calendar:_},yaxis:{calendar:_},zaxis:{calendar:_}},polar:{radialaxis:{calendar:_}}},transforms:{filter:{valuecalendar:d(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:d(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:a,handleDefaults:n,handleTraceDefaults:r,CANONICAL_SUNDAY:h,CANONICAL_TICK:t,DFLTRANGE:s,getCal:f,worldCalFmt:p}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(y,ee,te){te.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],te.defaultLine="#444",te.lightLine="#eee",te.background="#fff",te.borderLine="#BEC8D9",te.lightFraction=100*(14-4)/(15-4)},{}],367:[function(y,ee,te){var A=y("tinycolor2"),g=y("fast-isnumeric"),S=y("../../lib/array").isTypedArray,M=ee.exports={},e=y("./attributes");M.defaults=e.defaults;var a=M.defaultLine=e.defaultLine;M.lightLine=e.lightLine;var n=M.background=e.background;M.tinyRGB=function(t){var h=t.toRgb();return"rgb("+Math.round(h.r)+", "+Math.round(h.g)+", "+Math.round(h.b)+")"},M.rgb=function(t){return M.tinyRGB(A(t))},M.opacity=function(t){return t?A(t).getAlpha():0},M.addOpacity=function(t,h){var s=A(t).toRgb();return"rgba("+Math.round(s.r)+", "+Math.round(s.g)+", "+Math.round(s.b)+", "+h+")"},M.combine=function(t,h){var s=A(t).toRgb();if(s.a===1)return A(t).toRgbString();var i=A(h||n).toRgb(),x=i.a===1?i:{r:255*(1-i.a)+i.r*i.a,g:255*(1-i.a)+i.g*i.a,b:255*(1-i.a)+i.b*i.a},p={r:x.r*(1-s.a)+s.r*s.a,g:x.g*(1-s.a)+s.g*s.a,b:x.b*(1-s.a)+s.b*s.a};return A(p).toRgbString()},M.contrast=function(t,h,s){var i=A(t);i.getAlpha()!==1&&(i=A(M.combine(t,n)));var x=i.isDark()?h?i.lighten(h):n:s?i.darken(s):a;return x.toString()},M.stroke=function(t,h){var s=A(h);t.style({stroke:M.tinyRGB(s),"stroke-opacity":s.getAlpha()})},M.fill=function(t,h){var s=A(h);t.style({fill:M.tinyRGB(s),"fill-opacity":s.getAlpha()})},M.clean=function(t){if(!(!t||typeof t!="object")){var h=Object.keys(t),s,i,x,p;for(s=0;s<h.length;s++)if(x=h[s],p=t[x],x.substr(x.length-5)==="color")if(Array.isArray(p))for(i=0;i<p.length;i++)p[i]=r(p[i]);else t[x]=r(p);else if(x.substr(x.length-10)==="colorscale"&&Array.isArray(p))for(i=0;i<p.length;i++)Array.isArray(p[i])&&(p[i][1]=r(p[i][1]));else if(Array.isArray(p)){var v=p[0];if(!Array.isArray(v)&&v&&typeof v=="object")for(i=0;i<p.length;i++)M.clean(p[i])}else p&&typeof p=="object"&&!S(p)&&M.clean(p)}};function r(t){if(g(t)||typeof t!="string")return t;var h=t.trim();if(h.substr(0,3)!=="rgb")return t;var s=h.match(/^rgba?\s*\(([^()]*)\)$/);if(!s)return t;var i=s[1].trim().split(/\s*[\s,]\s*/),x=h.charAt(3)==="a"&&i.length===4;if(!x&&i.length!==3)return t;for(var p=0;p<i.length;p++){if(!i[p].length||(i[p]=Number(i[p]),!(i[p]>=0)))return t;if(p===3)i[p]>1&&(i[p]=1);else if(i[p]>=1)return t}var v=Math.round(i[0]*255)+", "+Math.round(i[1]*255)+", "+Math.round(i[2]*255);return x?"rgba("+v+", "+i[3]+")":"rgb("+v+")"}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(y,ee,te){var A=y("../../plots/cartesian/layout_attributes"),g=y("../../plots/font_attributes"),S=y("../../lib/extend").extendFlat,M=y("../../plot_api/edit_types").overrideAll;ee.exports=M({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:A.linecolor,outlinewidth:A.linewidth,bordercolor:A.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:A.tickmode,nticks:A.nticks,tick0:A.tick0,dtick:A.dtick,tickvals:A.tickvals,ticktext:A.ticktext,ticks:S({},A.ticks,{dflt:""}),ticklabeloverflow:S({},A.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:A.ticklen,tickwidth:A.tickwidth,tickcolor:A.tickcolor,ticklabelstep:A.ticklabelstep,showticklabels:A.showticklabels,tickfont:g({}),tickangle:A.tickangle,tickformat:A.tickformat,tickformatstops:A.tickformatstops,tickprefix:A.tickprefix,showtickprefix:A.showtickprefix,ticksuffix:A.ticksuffix,showticksuffix:A.showticksuffix,separatethousands:A.separatethousands,exponentformat:A.exponentformat,minexponent:A.minexponent,showexponent:A.showexponent,title:{text:{valType:"string"},font:g({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:g({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(y,ee,te){ee.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(y,ee,te){var A=y("../../lib"),g=y("../../plot_api/plot_template"),S=y("../../plots/cartesian/tick_value_defaults"),M=y("../../plots/cartesian/tick_mark_defaults"),e=y("../../plots/cartesian/tick_label_defaults"),a=y("../../plots/cartesian/prefix_suffix_defaults"),n=y("./attributes");ee.exports=function(t,h,s){var i=g.newContainer(h,"colorbar"),x=t.colorbar||{};function p(T,k){return A.coerce(x,i,n,T,k)}var v=s.margin||{t:0,b:0,l:0,r:0},f=s.width-v.l-v.r,d=s.height-v.t-v.b,o=p("orientation"),m=o==="v",l=p("thicknessmode");p("thickness",l==="fraction"?30/(m?f:d):30);var w=p("lenmode");p("len",w==="fraction"?1:m?d:f),p("x",m?1.02:.5),p("xanchor",m?"left":"center"),p("xpad"),p("y",m?.5:1.02),p("yanchor",m?"middle":"bottom"),p("ypad"),A.noneOrAll(x,i,["x","y"]),p("outlinecolor"),p("outlinewidth"),p("bordercolor"),p("borderwidth"),p("bgcolor");var _=A.coerce(x,i,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:m?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");p("ticklabeloverflow",_.indexOf("inside")!==-1?"hide past domain":"hide past div"),S(x,i,p,"linear");var c=s.font,b={outerTicks:!1,font:c};_.indexOf("inside")!==-1&&(b.bgColor="black"),a(x,i,p,"linear",b),e(x,i,p,"linear",b),M(x,i,p,"linear",b),p("title.text",s._dfltTitle.colorbar);var u=i.tickfont,L=A.extendFlat({},u,{color:c.color,size:A.bigFont(u.size)});A.coerceFont(p,"title.font",L),p("title.side",m?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(y,ee,te){var A=y("@plotly/d3"),g=y("tinycolor2"),S=y("../../plots/plots"),M=y("../../registry"),e=y("../../plots/cartesian/axes"),a=y("../dragelement"),n=y("../../lib"),r=n.strTranslate,t=y("../../lib/extend").extendFlat,h=y("../../lib/setcursor"),s=y("../drawing"),i=y("../color"),x=y("../titles"),p=y("../../lib/svg_text_utils"),v=y("../colorscale/helpers").flipScale,f=y("../../plots/cartesian/axis_defaults"),d=y("../../plots/cartesian/position_defaults"),o=y("../../plots/cartesian/layout_attributes"),m=y("../../constants/alignment"),l=m.LINE_SPACING,w=m.FROM_TL,_=m.FROM_BR,c=y("./constants").cn;function b(z){var I=z._fullLayout,D=I._infolayer.selectAll("g."+c.colorbar).data(u(z),function(R){return R._id});D.enter().append("g").attr("class",function(R){return R._id}).classed(c.colorbar,!0),D.each(function(R){var O=A.select(this);n.ensureSingle(O,"rect",c.cbbg),n.ensureSingle(O,"g",c.cbfills),n.ensureSingle(O,"g",c.cblines),n.ensureSingle(O,"g",c.cbaxis,function(N){N.classed(c.crisp,!0)}),n.ensureSingle(O,"g",c.cbtitleunshift,function(N){N.append("g").classed(c.cbtitle,!0)}),n.ensureSingle(O,"rect",c.cboutline);var F=L(O,R,z);F&&F.then&&(z._promises||[]).push(F),z._context.edits.colorbarPosition&&T(O,R,z)}),D.exit().each(function(R){S.autoMargin(z,R._id)}).remove(),D.order()}function u(z){var I=z._fullLayout,D=z.calcdata,R=[],O,F,N,G;function K(X){return t(X,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function W(){typeof G.calc=="function"?G.calc(z,N,O):(O._fillgradient=F.reversescale?v(F.colorscale):F.colorscale,O._zrange=[F[G.min],F[G.max]])}for(var Y=0;Y<D.length;Y++){var re=D[Y];N=re[0].trace;var ue=N._module.colorbar;if(N.visible===!0&&ue)for(var j=Array.isArray(ue),q=j?ue:[ue],H=0;H<q.length;H++){G=q[H];var U=G.container;F=U?N[U]:N,F&&F.showscale&&(O=K(F.colorbar),O._id="cb"+N.uid+(j&&U?"-"+U:""),O._traceIndex=N.index,O._propPrefix=(U?U+".":"")+"colorbar.",O._meta=N._meta,W(),R.push(O))}}for(var $ in I._colorAxes)if(F=I[$],F.showscale){var ne=I._colorAxes[$];O=K(F.colorbar),O._id="cb"+$,O._propPrefix=$+".colorbar.",O._meta=I._meta,G={min:"cmin",max:"cmax"},ne[0]!=="heatmap"&&(N=ne[1],G.calc=N._module.colorbar.calc),W(),R.push(O)}return R}function L(z,I,D){var R=I.orientation==="v",O=I.len,F=I.lenmode,N=I.thickness,G=I.thicknessmode,K=I.outlinewidth,W=I.borderwidth,Y=I.bgcolor,re=I.xanchor,ue=I.yanchor,j=I.xpad,q=I.ypad,H=I.x,U=R?I.y:1-I.y,$=D._fullLayout,ne=$._size,X=I._fillcolor,Q=I._line,ie=I.title,se=ie.side,ae=I._zrange||A.extent((typeof X=="function"?X:Q.color).domain()),oe=typeof Q.color=="function"?Q.color:function(){return Q.color},be=typeof X=="function"?X:function(){return X},ce=I._levels,de=k(D,I,ae),ye=de.fill,ge=de.line,me=Math.round(N*(G==="fraction"?R?ne.w:ne.h:1)),Ee=me/(R?ne.w:ne.h),Pe=Math.round(O*(F==="fraction"?R?ne.h:ne.w:1)),Ue=Pe/(R?ne.h:ne.w),we=Math.round(R?H*ne.w+j:U*ne.h+q),ke={center:.5,right:1}[re]||0,Xe={top:1,middle:.5}[ue]||0,Ve=R?H-ke*Ee:U-Xe*Ee,Ie=R?U-Xe*Ue:H-ke*Ue,De=Math.round(R?ne.h*(1-Ie):ne.w*Ie);I._lenFrac=Ue,I._thickFrac=Ee,I._uFrac=Ve,I._vFrac=Ie;var Ye=I._axis=P(D,I,ae);Ye.position=Ee+(R?H+j/ne.w:U+q/ne.h);var vt=["top","bottom"].indexOf(se)!==-1;if(R&&vt&&(Ye.title.side=se,Ye.titlex=H+j/ne.w,Ye.titley=Ie+(ie.side==="top"?Ue-q/ne.h:q/ne.h)),!R&&!vt&&(Ye.title.side=se,Ye.titley=U+q/ne.h,Ye.titlex=Ie+j/ne.w),Q.color&&I.tickmode==="auto"){Ye.tickmode="linear",Ye.tick0=ce.start;var Dt=ce.size,Kt=n.constrain(Pe/50,4,15)+1,Ft=(ae[1]-ae[0])/((I.nticks||Kt)*Dt);if(Ft>1){var Mt=Math.pow(10,Math.floor(Math.log(Ft)/Math.LN10));Dt*=Mt*n.roundUp(Ft/Mt,[2,5,10]),(Math.abs(ce.start)/ce.size+1e-6)%1<2e-6&&(Ye.tick0=0)}Ye.dtick=Dt}Ye.domain=R?[Ie+q/ne.h,Ie+Ue-q/ne.h]:[Ie+j/ne.w,Ie+Ue-j/ne.w],Ye.setScale(),z.attr("transform",r(Math.round(ne.l),Math.round(ne.t)));var Xt=z.select("."+c.cbtitleunshift).attr("transform",r(-Math.round(ne.l),-Math.round(ne.t))),It=Ye.ticklabelposition,At=Ye.title.font.size,Ge=z.select("."+c.cbaxis),tt,He=0,Ae=0;function Ne(wt,Ut){var Rt={propContainer:Ye,propName:I._propPrefix+"title",traceIndex:I._traceIndex,_meta:I._meta,placeholder:$._dfltTitle.colorbar,containerGroup:z.select("."+c.cbtitle)},Nt=wt.charAt(0)==="h"?wt.substr(1):"h"+wt;z.selectAll("."+Nt+",."+Nt+"-math-group").remove(),x.draw(D,wt,t(Rt,Ut||{}))}function Ze(){if(R&&vt||!R&&!vt){var wt,Ut;se==="top"&&(wt=j+ne.l+ne.w*H,Ut=q+ne.t+ne.h*(1-Ie-Ue)+3+At*.75),se==="bottom"&&(wt=j+ne.l+ne.w*H,Ut=q+ne.t+ne.h*(1-Ie)-3-At*.25),se==="right"&&(Ut=q+ne.t+ne.h*U+3+At*.75,wt=j+ne.l+ne.w*Ie),Ne(Ye._id+"title",{attributes:{x:wt,y:Ut,"text-anchor":R?"start":"middle"}})}}function Qe(){if(R&&!vt||!R&&vt){var wt=Ye.position||0,Ut=Ye._offset+Ye._length/2,Rt,Nt;if(se==="right")Nt=Ut,Rt=ne.l+ne.w*wt+10+At*(Ye.showticklabels?1:.5);else if(Rt=Ut,se==="bottom"&&(Nt=ne.t+ne.h*wt+10+(It.indexOf("inside")===-1?Ye.tickfont.size:0)+(Ye.ticks!=="intside"&&I.ticklen||0)),se==="top"){var Wt=ie.text.split("<br>").length;Nt=ne.t+ne.h*wt+10-me-l*At*Wt}Ne((R?"h":"v")+Ye._id+"title",{avoid:{selection:A.select(D).selectAll("g."+Ye._id+"tick"),side:se,offsetTop:R?0:ne.t,offsetLeft:R?ne.l:0,maxShift:R?$.width:$.height},attributes:{x:Rt,y:Nt,"text-anchor":"middle"},transform:{rotate:R?-90:0,offset:0}})}}function bt(){if(!R&&!vt||R&&vt){var wt=z.select("."+c.cbtitle),Ut=wt.select("text"),Rt=[-K/2,K/2],Nt=wt.select(".h"+Ye._id+"title-math-group").node(),Wt=15.6;Ut.node()&&(Wt=parseInt(Ut.node().style.fontSize,10)*l);var Vt;if(Nt?(Vt=s.bBox(Nt),Ae=Vt.width,He=Vt.height,He>Wt&&(Rt[1]-=(He-Wt)/2)):Ut.node()&&!Ut.classed(c.jsPlaceholder)&&(Vt=s.bBox(Ut.node()),Ae=Vt.width,He=Vt.height),R){if(He){if(He+=5,se==="top")Ye.domain[1]-=He/ne.h,Rt[1]*=-1;else{Ye.domain[0]+=He/ne.h;var ir=p.lineCount(Ut);Rt[1]+=(1-ir)*Wt}wt.attr("transform",r(Rt[0],Rt[1])),Ye.setScale()}}else Ae&&(se==="right"&&(Ye.domain[0]+=(Ae+At/2)/ne.w),wt.attr("transform",r(Rt[0],Rt[1])),Ye.setScale())}z.selectAll("."+c.cbfills+",."+c.cblines).attr("transform",R?r(0,Math.round(ne.h*(1-Ye.domain[1]))):r(Math.round(ne.w*Ye.domain[0]),0)),Ge.attr("transform",R?r(0,Math.round(-ne.t)):r(Math.round(-ne.l),0));var Hr=z.select("."+c.cbfills).selectAll("rect."+c.cbfill).attr("style","").data(ye);Hr.enter().append("rect").classed(c.cbfill,!0).style("stroke","none"),Hr.exit().remove();var sn=ae.map(Ye.c2p).map(Math.round).sort(function(Gt,_r){return Gt-_r});Hr.each(function(Gt,_r){var rt=[_r===0?ae[0]:(ye[_r]+ye[_r-1])/2,_r===ye.length-1?ae[1]:(ye[_r]+ye[_r+1])/2].map(Ye.c2p).map(Math.round);R&&(rt[1]=n.constrain(rt[1]+(rt[1]>rt[0])?1:-1,sn[0],sn[1]));var Je=A.select(this).attr(R?"x":"y",we).attr(R?"y":"x",A.min(rt)).attr(R?"width":"height",Math.max(me,2)).attr(R?"height":"width",Math.max(A.max(rt)-A.min(rt),2));if(I._fillgradient)s.gradient(Je,D,I._id,R?"vertical":"horizontalreversed",I._fillgradient,"fill");else{var st=be(Gt).replace("e-","");Je.attr("fill",g(st).toHexString())}});var jr=z.select("."+c.cblines).selectAll("path."+c.cbline).data(Q.color&&Q.width?ge:[]);jr.enter().append("path").classed(c.cbline,!0),jr.exit().remove(),jr.each(function(Gt){var _r=we,rt=Math.round(Ye.c2p(Gt))+Q.width/2%1;A.select(this).attr("d","M"+(R?_r+","+rt:rt+","+_r)+(R?"h":"v")+me).call(s.lineGroupStyle,Q.width,oe(Gt),Q.dash)}),Ge.selectAll("g."+Ye._id+"tick,path").remove();var at=we+me+(K||0)/2-(I.ticks==="outside"?1:0),$t=e.calcTicks(Ye),Jt=e.getTickSigns(Ye)[2];return e.drawTicks(D,Ye,{vals:Ye.ticks==="inside"?e.clipEnds(Ye,$t):$t,layer:Ge,path:e.makeTickPath(Ye,at,Jt),transFn:e.makeTransTickFn(Ye)}),e.drawLabels(D,Ye,{vals:$t,layer:Ge,transFn:e.makeTransTickLabelFn(Ye),labelFns:e.makeLabelFns(Ye,at)})}function dt(){var wt,Ut=me+K/2;It.indexOf("inside")===-1&&(wt=s.bBox(Ge.node()),Ut+=R?wt.width:wt.height),tt=Xt.select("text");var Rt=0,Nt=R&&se==="top",Wt=!R&&se==="right",Vt=0;if(tt.node()&&!tt.classed(c.jsPlaceholder)){var ir,Hr=Xt.select(".h"+Ye._id+"title-math-group").node();Hr&&(R&&vt||!R&&!vt)?(wt=s.bBox(Hr),Rt=wt.width,ir=wt.height):(wt=s.bBox(Xt.node()),Rt=wt.right-ne.l-(R?we:De),ir=wt.bottom-ne.t-(R?De:we),!R&&se==="top"&&(Ut+=wt.height,Vt=wt.height)),Wt&&(tt.attr("transform",r(Rt/2+At/2,0)),Rt*=2),Ut=Math.max(Ut,R?Rt:ir)}var sn=(R?j:q)*2+Ut+W+K/2,jr=0;!R&&ie.text&&ue==="bottom"&&U<=0&&(jr=sn/2,sn+=jr,Vt+=jr),$._hColorbarMoveTitle=jr,$._hColorbarMoveCBTitle=Vt;var at=W+K;z.select("."+c.cbbg).attr("x",(R?we:De)-at/2-(R?j:0)).attr("y",(R?De:we)-(R?Pe:q+Vt-jr)).attr(R?"width":"height",Math.max(sn-jr,2)).attr(R?"height":"width",Math.max(Pe+at,2)).call(i.fill,Y).call(i.stroke,I.bordercolor).style("stroke-width",W);var $t=Wt?Math.max(Rt-10,0):0;if(z.selectAll("."+c.cboutline).attr("x",(R?we:De+j)+$t).attr("y",(R?De+q-Pe:we)+(Nt?He:0)).attr(R?"width":"height",Math.max(me,2)).attr(R?"height":"width",Math.max(Pe-(R?2*q+He:2*j+$t),2)).call(i.stroke,I.outlinecolor).style({fill:"none","stroke-width":K}),z.attr("transform",r(ne.l-(R?ke*sn:0),ne.t-(R?0:(1-Xe)*sn-Vt))),!R&&(W||g(Y).getAlpha()&&!g.equals($.paper_bgcolor,Y))){var Jt=Ge.selectAll("text"),Gt=Jt[0].length,_r=z.select("."+c.cbbg).node(),rt=s.bBox(_r),Je=s.getTranslate(z),st=2;Jt.each(function(it,ct){var kt=0,gt=Gt-1;if(ct===kt||ct===gt){var St=s.bBox(this),Yt=s.getTranslate(this),ar;if(ct===gt){var kr=St.right+Yt.x,br=rt.right+Je.x+De-W-st+H;ar=br-kr,ar>0&&(ar=0)}else if(ct===kt){var Mr=St.left+Yt.x,Yr=rt.left+Je.x+De+W+st;ar=Yr-Mr,ar<0&&(ar=0)}ar&&(Gt<3?this.setAttribute("transform","translate("+ar+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var lt={},Tt=w[re],zt=_[re],Ce=w[ue],Se=_[ue],nt=sn-me;R?(F==="pixels"?(lt.y=U,lt.t=Pe*Ce,lt.b=Pe*Se):(lt.t=lt.b=0,lt.yt=U+O*Ce,lt.yb=U-O*Se),G==="pixels"?(lt.x=H,lt.l=sn*Tt,lt.r=sn*zt):(lt.l=nt*Tt,lt.r=nt*zt,lt.xl=H-N*Tt,lt.xr=H+N*zt)):(F==="pixels"?(lt.x=H,lt.l=Pe*Tt,lt.r=Pe*zt):(lt.l=lt.r=0,lt.xl=H+O*Tt,lt.xr=H-O*zt),G==="pixels"?(lt.y=1-U,lt.t=sn*Ce,lt.b=sn*Se):(lt.t=nt*Ce,lt.b=nt*Se,lt.yt=U-N*Ce,lt.yb=U+N*Se)),S.autoMargin(D,I._id,lt)}return n.syncOrAsync([S.previousPromises,Ze,bt,Qe,S.previousPromises,dt],D)}function T(z,I,D){var R=I.orientation==="v",O=D._fullLayout,F=O._size,N,G,K;a.init({element:z.node(),gd:D,prepFn:function(){N=z.attr("transform"),h(z)},moveFn:function(W,Y){z.attr("transform",N+r(W,Y)),G=a.align((R?I._uFrac:I._vFrac)+W/F.w,R?I._thickFrac:I._lenFrac,0,1,I.xanchor),K=a.align((R?I._vFrac:1-I._uFrac)-Y/F.h,R?I._lenFrac:I._thickFrac,0,1,I.yanchor);var re=a.getCursor(G,K,I.xanchor,I.yanchor);h(z,re)},doneFn:function(){if(h(z),G!==void 0&&K!==void 0){var W={};W[I._propPrefix+"x"]=G,W[I._propPrefix+"y"]=K,I._traceIndex!==void 0?M.call("_guiRestyle",D,W,I._traceIndex):M.call("_guiRelayout",D,W)}}})}function k(z,I,D){var R=I._levels,O=[],F=[],N,G,K=R.end+R.size/100,W=R.size,Y=1.001*D[0]-.001*D[1],re=1.001*D[1]-.001*D[0];for(G=0;G<1e5&&(N=R.start+G*W,!(W>0?N>=K:N<=K));G++)N>Y&&N<re&&O.push(N);if(I._fillgradient)F=[0];else if(typeof I._fillcolor=="function"){var ue=I._filllevels;if(ue)for(K=ue.end+ue.size/100,W=ue.size,G=0;G<1e5&&(N=ue.start+G*W,!(W>0?N>=K:N<=K));G++)N>D[0]&&N<D[1]&&F.push(N);else F=O.map(function(j){return j-R.size/2}),F.push(F[F.length-1]+R.size)}else I._fillcolor&&typeof I._fillcolor=="string"&&(F=[0]);return R.size<0&&(O.reverse(),F.reverse()),{line:O,fill:F}}function P(z,I,D){var R=z._fullLayout,O=I.orientation==="v",F={type:"linear",range:D,tickmode:I.tickmode,nticks:I.nticks,tick0:I.tick0,dtick:I.dtick,tickvals:I.tickvals,ticktext:I.ticktext,ticks:I.ticks,ticklen:I.ticklen,tickwidth:I.tickwidth,tickcolor:I.tickcolor,showticklabels:I.showticklabels,ticklabelposition:I.ticklabelposition,ticklabeloverflow:I.ticklabeloverflow,ticklabelstep:I.ticklabelstep,tickfont:I.tickfont,tickangle:I.tickangle,tickformat:I.tickformat,exponentformat:I.exponentformat,minexponent:I.minexponent,separatethousands:I.separatethousands,showexponent:I.showexponent,showtickprefix:I.showtickprefix,tickprefix:I.tickprefix,showticksuffix:I.showticksuffix,ticksuffix:I.ticksuffix,title:I.title,showline:!0,anchor:"free",side:O?"right":"bottom",position:1},N=O?"y":"x",G={type:"linear",_id:N+I._id},K={letter:N,font:R.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:R.calendar};function W(Y,re){return n.coerce(F,G,o,Y,re)}return f(F,G,W,K,R),d(F,G,W,K),G}ee.exports={draw:b}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S){return A.isPlainObject(S.colorbar)}},{"../../lib":515}],373:[function(y,ee,te){ee.exports={moduleType:"component",name:"colorbar",attributes:y("./attributes"),supplyDefaults:y("./defaults"),draw:y("./draw").draw,hasColorbar:y("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(y,ee,te){var A=y("../colorbar/attributes"),g=y("../../lib/regex").counter,S=y("../../lib/sort_object_keys"),M=y("./scales.js").scales;S(M),ee.exports=function(a,n){a=a||"",n=n||{};var r=n.cLetter||"c";"onlyIfNumerical"in n&&n.onlyIfNumerical;var t="noScale"in n?n.noScale:a==="marker.line",h="showScaleDflt"in n?n.showScaleDflt:r==="z",s=typeof n.colorscaleDflt=="string"?M[n.colorscaleDflt]:null,i=n.editTypeOverride||"",x;"colorAttr"in n?(x=n.colorAttr,n.colorAttr):x={z:"z",c:"color"}[r];var p=r+"auto",v=r+"min",f=r+"max",d=r+"mid",o={};o[v]=o[f]=void 0;var m={};m[p]=!1;var l={};return x==="color"&&(l.color={valType:"color",arrayOk:!0,editType:i||"style"},n.anim&&(l.color.anim=!0)),l[p]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:o},l[v]={valType:"number",dflt:null,editType:i||"plot",impliedEdits:m},l[f]={valType:"number",dflt:null,editType:i||"plot",impliedEdits:m},l[d]={valType:"number",dflt:null,editType:"calc",impliedEdits:o},l.colorscale={valType:"colorscale",editType:"calc",dflt:s,impliedEdits:{autocolorscale:!1}},l.autocolorscale={valType:"boolean",dflt:n.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},l.reversescale={valType:"boolean",dflt:!1,editType:"plot"},t||(l.showscale={valType:"boolean",dflt:h,editType:"calc"},l.colorbar=A),n.noColorAxis||(l.coloraxis={valType:"subplotid",regex:g("coloraxis"),dflt:null,editType:"calc"}),l}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("./helpers").extractOpts;ee.exports=function(e,a,n){var r=e._fullLayout,t=n.vals,h=n.containerStr,s=h?g.nestedProperty(a,h).get():a,i=S(s),x=i.auto!==!1,p=i.min,v=i.max,f=i.mid,d=function(){return g.aggNums(Math.min,null,t)},o=function(){return g.aggNums(Math.max,null,t)};if(p===void 0?p=d():x&&(s._colorAx&&A(p)?p=Math.min(p,d()):p=d()),v===void 0?v=o():x&&(s._colorAx&&A(v)?v=Math.max(v,o()):v=o()),x&&f!==void 0&&(v-f>f-p?p=f-(v-f):v-f<f-p&&(v=f+(f-p))),p===v&&(p-=.5,v+=.5),i._sync("min",p),i._sync("max",v),i.autocolorscale){var m;p*v<0?m=r.colorscale.diverging:p>=0?m=r.colorscale.sequential:m=r.colorscale.sequentialminus,i._sync("colorscale",m)}}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(y,ee,te){var A=y("../../lib"),g=y("./helpers").hasColorscale,S=y("./helpers").extractOpts;ee.exports=function(e,a){function n(p,v){var f=p["_"+v];f!==void 0&&(p[v]=f)}function r(p,v){var f=v.container?A.nestedProperty(p,v.container).get():p;if(f)if(f.coloraxis)f._colorAx=a[f.coloraxis];else{var d=S(f),o=d.auto;(o||d.min===void 0)&&n(f,v.min),(o||d.max===void 0)&&n(f,v.max),d.autocolorscale&&n(f,"colorscale")}}for(var t=0;t<e.length;t++){var h=e[t],s=h._module.colorbar;if(s)if(Array.isArray(s))for(var i=0;i<s.length;i++)r(h,s[i]);else r(h,s);g(h,"marker.line")&&r(h,{container:"marker.line",min:"cmin",max:"cmax"})}for(var x in a._colorAxes)r(a[x],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../colorbar/has_colorbar"),M=y("../colorbar/defaults"),e=y("./scales").isValid,a=y("../../registry").traceIs;function n(r,t){var h=t.slice(0,t.length-1);return t?g.nestedProperty(r,h).get()||{}:r}ee.exports=function r(t,h,s,i,x){var p=x.prefix,v=x.cLetter,f="_module"in h,d=n(t,p),o=n(h,p),m=n(h._template||{},p)||{},l=function(){return delete t.coloraxis,delete h.coloraxis,r(t,h,s,i,x)};if(f){var w=s._colorAxes||{},_=i(p+"coloraxis");if(_){var c=a(h,"contour")&&g.nestedProperty(h,"contours.coloring").get()||"heatmap",b=w[_];b?(b[2].push(l),b[0]!==c&&(b[0]=!1,g.warn(["Ignoring coloraxis:",_,"setting","as it is linked to incompatible colorscales."].join(" ")))):w[_]=[c,h,[l]];return}}var u=d[v+"min"],L=d[v+"max"],T=A(u)&&A(L)&&u<L,k=i(p+v+"auto",!T);k?i(p+v+"mid"):(i(p+v+"min"),i(p+v+"max"));var P=d.colorscale,z=m.colorscale,I;if(P!==void 0&&(I=!e(P)),z!==void 0&&(I=!e(z)),i(p+"autocolorscale",I),i(p+"colorscale"),i(p+"reversescale"),p!=="marker.line."){var D;p&&f&&(D=S(d));var R=i(p+"showscale",D);R&&(p&&m&&(o._template=m),M(d,o,s))}}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(y,ee,te){var A=y("@plotly/d3"),g=y("tinycolor2"),S=y("fast-isnumeric"),M=y("../../lib"),e=y("../color"),a=y("./scales").isValid;function n(f,d,o){var m=d?M.nestedProperty(f,d).get()||{}:f,l=m[o||"color"],w=!1;if(M.isArrayOrTypedArray(l)){for(var _=0;_<l.length;_++)if(S(l[_])){w=!0;break}}return M.isPlainObject(m)&&(w||m.showscale===!0||S(m.cmin)&&S(m.cmax)||a(m.colorscale)||M.isPlainObject(m.colorbar))}var r=["showscale","autocolorscale","colorscale","reversescale","colorbar"],t=["min","max","mid","auto"];function h(f){var d=f._colorAx,o=d||f,m={},l,w,_;for(w=0;w<r.length;w++)_=r[w],m[_]=o[_];if(d)for(l="c",w=0;w<t.length;w++)_=t[w],m[_]=o["c"+_];else{var c;for(w=0;w<t.length;w++){if(_=t[w],c="c"+_,c in o){m[_]=o[c];continue}c="z"+_,c in o&&(m[_]=o[c])}l=c.charAt(0)}return m._sync=function(b,u){var L=t.indexOf(b)!==-1?l+b:b;o[L]=o["_"+L]=u},m}function s(f){for(var d=h(f),o=d.min,m=d.max,l=d.reversescale?i(d.colorscale):d.colorscale,w=l.length,_=new Array(w),c=new Array(w),b=0;b<w;b++){var u=l[b];_[b]=o+u[0]*(m-o),c[b]=u[1]}return{domain:_,range:c}}function i(f){for(var d=f.length,o=new Array(d),m=d-1,l=0;m>=0;m--,l++){var w=f[m];o[l]=[1-w[0],w[1]]}return o}function x(f,d){d=d||{};for(var o=f.domain,m=f.range,l=m.length,w=new Array(l),_=0;_<l;_++){var c=g(m[_]).toRgb();w[_]=[c.r,c.g,c.b,c.a]}var b=A.scale.linear().domain(o).range(w).clamp(!0),u=d.noNumericCheck,L=d.returnArray,T;return u&&L?T=b:u?T=function(k){return v(b(k))}:L?T=function(k){return S(k)?b(k):g(k).isValid()?k:e.defaultLine}:T=function(k){return S(k)?v(b(k)):g(k).isValid()?k:e.defaultLine},T.domain=b.domain,T.range=function(){return m},T}function p(f,d){return x(s(f),d)}function v(f){var d={r:f[0],g:f[1],b:f[2],a:f[3]};return g(d).toRgbString()}ee.exports={hasColorscale:n,extractOpts:h,extractScale:s,flipScale:i,makeColorScaleFunc:x,makeColorScaleFuncFromTrace:p}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(y,ee,te){var A=y("./scales"),g=y("./helpers");ee.exports={moduleType:"component",name:"colorscale",attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyLayoutDefaults:y("./layout_defaults"),handleDefaults:y("./defaults"),crossTraceDefaults:y("./cross_trace_defaults"),calc:y("./calc"),scales:A.scales,defaultScale:A.defaultScale,getScale:A.get,isValidScale:A.isValid,hasColorscale:g.hasColorscale,extractOpts:g.extractOpts,extractScale:g.extractScale,flipScale:g.flipScale,makeColorScaleFunc:g.makeColorScaleFunc,makeColorScaleFuncFromTrace:g.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(y,ee,te){var A=y("../../lib/extend").extendFlat,g=y("./attributes"),S=y("./scales").scales;ee.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:S.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:S.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:S.RdBu,editType:"calc"}},coloraxis:A({_isSubplotObj:!0,editType:"calc"},g("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(y,ee,te){var A=y("../../lib"),g=y("../../plot_api/plot_template"),S=y("./layout_attributes"),M=y("./defaults");ee.exports=function(a,n){function r(f,d){return A.coerce(a,n,S,f,d)}r("colorscale.sequential"),r("colorscale.sequentialminus"),r("colorscale.diverging");var t=n._colorAxes,h,s;function i(f,d){return A.coerce(h,s,S.coloraxis,f,d)}for(var x in t){var p=t[x];if(p[0])h=a[x]||{},s=g.newContainer(n,x,"coloraxis"),s._name=x,M(h,s,n,i,{prefix:"",cLetter:"c"});else{for(var v=0;v<p[2].length;v++)p[2][v]();delete n._colorAxes[x]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(y,ee,te){var A=y("tinycolor2"),g={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},S=g.RdBu;function M(n,r){if(r||(r=S),!n)return r;function t(){try{n=g[n]||JSON.parse(n)}catch{n=r}}return typeof n=="string"&&(t(),typeof n=="string"&&t()),e(n)?n:r}function e(n){var r=0;if(!Array.isArray(n)||n.length<2||!n[0]||!n[n.length-1]||+n[0][0]!=0||+n[n.length-1][0]!=1)return!1;for(var t=0;t<n.length;t++){var h=n[t];if(h.length!==2||+h[0]<r||!A(h[1]).isValid())return!1;r=+h[0]}return!0}function a(n){return g[n]!==void 0?!0:e(n)}ee.exports={scales:g,defaultScale:S,get:M,isValid:a}},{tinycolor2:313}],383:[function(y,ee,te){ee.exports=function(g,S,M,e,a){var n=(g-M)/(e-M),r=n+S/(e-M),t=(n+r)/2;return a==="left"||a==="bottom"?n:a==="center"||a==="middle"?t:a==="right"||a==="top"?r:n<2/3-t?n:r>4/3-t?r:t}},{}],384:[function(y,ee,te){var A=y("../../lib"),g=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];ee.exports=function(M,e,a,n){return a==="left"?M=0:a==="center"?M=1:a==="right"?M=2:M=A.constrain(Math.floor(M*3),0,2),n==="bottom"?e=0:n==="middle"?e=1:n==="top"?e=2:e=A.constrain(Math.floor(e*3),0,2),g[e][M]}},{"../../lib":515}],385:[function(y,ee,te){te.selectMode=function(A){return A==="lasso"||A==="select"},te.drawMode=function(A){return A==="drawclosedpath"||A==="drawopenpath"||A==="drawline"||A==="drawrect"||A==="drawcircle"},te.openMode=function(A){return A==="drawline"||A==="drawopenpath"},te.rectMode=function(A){return A==="select"||A==="drawline"||A==="drawrect"||A==="drawcircle"},te.freeMode=function(A){return A==="lasso"||A==="drawclosedpath"||A==="drawopenpath"},te.selectingOrDrawing=function(A){return te.freeMode(A)||te.rectMode(A)}},{}],386:[function(y,ee,te){var A=y("mouse-event-offset"),g=y("has-hover"),S=y("has-passive-events"),M=y("../../lib").removeElement,e=y("../../plots/cartesian/constants"),a=ee.exports={};a.align=y("./align"),a.getCursor=y("./cursor");var n=y("./unhover");a.unhover=n.wrapped,a.unhoverRaw=n.raw,a.init=function(s){var i=s.gd,x=1,p=i._context.doubleClickDelay,v=s.element,f,d,o,m,l,w,_,c;i._mouseDownTime||(i._mouseDownTime=0),v.style.pointerEvents="all",v.onmousedown=L,S?(v._ontouchstart&&v.removeEventListener("touchstart",v._ontouchstart),v._ontouchstart=L,v.addEventListener("touchstart",L,{passive:!1})):v.ontouchstart=L;function b(P,z,I){return Math.abs(P)<I&&(P=0),Math.abs(z)<I&&(z=0),[P,z]}var u=s.clampFn||b;function L(P){i._dragged=!1,i._dragging=!0;var z=t(P);f=z[0],d=z[1],_=P.target,w=P,c=P.buttons===2||P.ctrlKey,typeof P.clientX>"u"&&typeof P.clientY>"u"&&(P.clientX=f,P.clientY=d),o=new Date().getTime(),o-i._mouseDownTime<p?x+=1:(x=1,i._mouseDownTime=o),s.prepFn&&s.prepFn(P,f,d),g&&!c?(l=r(),l.style.cursor=window.getComputedStyle(v).cursor):g||(l=document,m=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(v).cursor),document.addEventListener("mouseup",k),document.addEventListener("touchend",k),s.dragmode!==!1&&(P.preventDefault(),document.addEventListener("mousemove",T),document.addEventListener("touchmove",T,{passive:!1}))}function T(P){P.preventDefault();var z=t(P),I=s.minDrag||e.MINDRAG,D=u(z[0]-f,z[1]-d,I),R=D[0],O=D[1];(R||O)&&(i._dragged=!0,a.unhover(i,P)),i._dragged&&s.moveFn&&!c&&(i._dragdata={element:v,dx:R,dy:O},s.moveFn(R,O))}function k(P){if(delete i._dragdata,s.dragmode!==!1&&(P.preventDefault(),document.removeEventListener("mousemove",T),document.removeEventListener("touchmove",T)),document.removeEventListener("mouseup",k),document.removeEventListener("touchend",k),g?M(l):m&&(l.documentElement.style.cursor=m,m=null),!i._dragging){i._dragged=!1;return}if(i._dragging=!1,new Date().getTime()-i._mouseDownTime>p&&(x=Math.max(x-1,1)),i._dragged)s.doneFn&&s.doneFn();else if(s.clickFn&&s.clickFn(x,w),!c){var z;try{z=new MouseEvent("click",P)}catch{var I=t(P);z=document.createEvent("MouseEvents"),z.initMouseEvent("click",P.bubbles,P.cancelable,P.view,P.detail,P.screenX,P.screenY,I[0],I[1],P.ctrlKey,P.altKey,P.shiftKey,P.metaKey,P.button,P.relatedTarget)}_.dispatchEvent(z)}i._dragging=!1,i._dragged=!1}};function r(){var h=document.createElement("div");h.className="dragcover";var s=h.style;return s.position="fixed",s.left=0,s.right=0,s.top=0,s.bottom=0,s.zIndex=999999999,s.background="none",document.body.appendChild(h),h}a.coverSlip=r;function t(h){return A(h.changedTouches?h.changedTouches[0]:h,document.body)}},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(y,ee,te){var A=y("../../lib/events"),g=y("../../lib/throttle"),S=y("../../lib/dom").getGraphDiv,M=y("../fx/constants"),e=ee.exports={};e.wrapped=function(a,n,r){a=S(a),a._fullLayout&&g.clear(a._fullLayout._uid+M.HOVERID),e.raw(a,n,r)},e.raw=function(n,r){var t=n._fullLayout,h=n._hoverdata;r||(r={}),!(r.target&&!n._dragged&&A.triggerHandler(n,"plotly_beforehover",r)===!1)&&(t._hoverlayer.selectAll("g").remove(),t._hoverlayer.selectAll("line").remove(),t._hoverlayer.selectAll("circle").remove(),n._hoverdata=void 0,r.target&&h&&n.emit("plotly_unhover",{event:r,points:h}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(y,ee,te){te.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},te.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=g.numberFormat,M=y("fast-isnumeric"),e=y("tinycolor2"),a=y("../../registry"),n=y("../color"),r=y("../colorscale"),t=g.strTranslate,h=y("../../lib/svg_text_utils"),s=y("../../constants/xmlns_namespaces"),i=y("../../constants/alignment"),x=i.LINE_SPACING,p=y("../../constants/interactions").DESELECTDIM,v=y("../../traces/scatter/subtypes"),f=y("../../traces/scatter/make_bubble_size_func"),d=y("../../components/fx/helpers").appendArrayPointValue,o=ee.exports={};o.font=function(ge,me,Ee,Pe){g.isPlainObject(me)&&(Pe=me.color,Ee=me.size,me=me.family),me&&ge.style("font-family",me),Ee+1&&ge.style("font-size",Ee+"px"),Pe&&ge.call(n.fill,Pe)},o.setPosition=function(ge,me,Ee){ge.attr("x",me).attr("y",Ee)},o.setSize=function(ge,me,Ee){ge.attr("width",me).attr("height",Ee)},o.setRect=function(ge,me,Ee,Pe,Ue){ge.call(o.setPosition,me,Ee).call(o.setSize,Pe,Ue)},o.translatePoint=function(ge,me,Ee,Pe){var Ue=Ee.c2p(ge.x),we=Pe.c2p(ge.y);if(M(Ue)&&M(we)&&me.node())me.node().nodeName==="text"?me.attr("x",Ue).attr("y",we):me.attr("transform",t(Ue,we));else return!1;return!0},o.translatePoints=function(ge,me,Ee){ge.each(function(Pe){var Ue=A.select(this);o.translatePoint(Pe,Ue,me,Ee)})},o.hideOutsideRangePoint=function(ge,me,Ee,Pe,Ue,we){me.attr("display",Ee.isPtWithinRange(ge,Ue)&&Pe.isPtWithinRange(ge,we)?null:"none")},o.hideOutsideRangePoints=function(ge,me){if(me._hasClipOnAxisFalse){var Ee=me.xaxis,Pe=me.yaxis;ge.each(function(Ue){var we=Ue[0].trace,ke=we.xcalendar,Xe=we.ycalendar,Ve=a.traceIs(we,"bar-like")?".bartext":".point,.textpoint";ge.selectAll(Ve).each(function(Ie){o.hideOutsideRangePoint(Ie,A.select(this),Ee,Pe,ke,Xe)})})}},o.crispRound=function(ge,me,Ee){return!me||!M(me)?Ee||0:ge._context.staticPlot?me:me<1?1:Math.round(me)},o.singleLineStyle=function(ge,me,Ee,Pe,Ue){me.style("fill","none");var we=(((ge||[])[0]||{}).trace||{}).line||{},ke=Ee||we.width||0,Xe=Ue||we.dash||"";n.stroke(me,Pe||we.color),o.dashLine(me,Xe,ke)},o.lineGroupStyle=function(ge,me,Ee,Pe){ge.style("fill","none").each(function(Ue){var we=(((Ue||[])[0]||{}).trace||{}).line||{},ke=me||we.width||0,Xe=Pe||we.dash||"";A.select(this).call(n.stroke,Ee||we.color).call(o.dashLine,Xe,ke)})},o.dashLine=function(ge,me,Ee){Ee=+Ee||0,me=o.dashStyle(me,Ee),ge.style({"stroke-dasharray":me,"stroke-width":Ee+"px"})},o.dashStyle=function(ge,me){me=+me||1;var Ee=Math.max(me,3);return ge==="solid"?ge="":ge==="dot"?ge=Ee+"px,"+Ee+"px":ge==="dash"?ge=3*Ee+"px,"+3*Ee+"px":ge==="longdash"?ge=5*Ee+"px,"+5*Ee+"px":ge==="dashdot"?ge=3*Ee+"px,"+Ee+"px,"+Ee+"px,"+Ee+"px":ge==="longdashdot"&&(ge=5*Ee+"px,"+2*Ee+"px,"+Ee+"px,"+2*Ee+"px"),ge};function m(ge,me,Ee){var Pe=me.fillpattern,Ue=Pe&&o.getPatternAttr(Pe.shape,0,"");if(Ue){var we=o.getPatternAttr(Pe.bgcolor,0,null),ke=o.getPatternAttr(Pe.fgcolor,0,null),Xe=Pe.fgopacity,Ve=o.getPatternAttr(Pe.size,0,8),Ie=o.getPatternAttr(Pe.solidity,0,.3),De=me.uid;o.pattern(ge,"point",Ee,De,Ue,Ve,Ie,void 0,Pe.fillmode,we,ke,Xe)}else me.fillcolor&&ge.call(n.fill,me.fillcolor)}o.singleFillStyle=function(ge,me){var Ee=A.select(ge.node()),Pe=Ee.data(),Ue=((Pe[0]||[])[0]||{}).trace||{};m(ge,Ue,me)},o.fillGroupStyle=function(ge,me){ge.style("stroke-width",0).each(function(Ee){var Pe=A.select(this);Ee[0].trace&&m(Pe,Ee[0].trace,me)})};var l=y("./symbol_defs");o.symbolNames=[],o.symbolFuncs=[],o.symbolBackOffs=[],o.symbolNeedLines={},o.symbolNoDot={},o.symbolNoFill={},o.symbolList=[],Object.keys(l).forEach(function(ge){var me=l[ge],Ee=me.n;o.symbolList.push(Ee,String(Ee),ge,Ee+100,String(Ee+100),ge+"-open"),o.symbolNames[Ee]=ge,o.symbolFuncs[Ee]=me.f,o.symbolBackOffs[Ee]=me.backoff||0,me.needLine&&(o.symbolNeedLines[Ee]=!0),me.noDot?o.symbolNoDot[Ee]=!0:o.symbolList.push(Ee+200,String(Ee+200),ge+"-dot",Ee+300,String(Ee+300),ge+"-open-dot"),me.noFill&&(o.symbolNoFill[Ee]=!0)});var w=o.symbolNames.length,_="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";o.symbolNumber=function(ge){if(M(ge))ge=+ge;else if(typeof ge=="string"){var me=0;ge.indexOf("-open")>0&&(me=100,ge=ge.replace("-open","")),ge.indexOf("-dot")>0&&(me+=200,ge=ge.replace("-dot","")),ge=o.symbolNames.indexOf(ge),ge>=0&&(ge+=me)}return ge%100>=w||ge>=400?0:Math.floor(Math.max(ge,0))};function c(ge,me,Ee,Pe){var Ue=ge%100;return o.symbolFuncs[Ue](me,Ee,Pe)+(ge>=200?_:"")}var b={x1:1,x2:0,y1:0,y2:0},u={x1:0,x2:0,y1:1,y2:0},L=S("~f"),T={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:b},horizontalreversed:{node:"linearGradient",attrs:b,reversed:!0},vertical:{node:"linearGradient",attrs:u},verticalreversed:{node:"linearGradient",attrs:u,reversed:!0}};o.gradient=function(ge,me,Ee,Pe,Ue,we){for(var ke=Ue.length,Xe=T[Pe],Ve=new Array(ke),Ie=0;Ie<ke;Ie++)Xe.reversed?Ve[ke-1-Ie]=[L((1-Ue[Ie][0])*100),Ue[Ie][1]]:Ve[Ie]=[L(Ue[Ie][0]*100),Ue[Ie][1]];var De=me._fullLayout,Ye="g"+De._uid+"-"+Ee,vt=De._defs.select(".gradients").selectAll("#"+Ye).data([Pe+Ve.join(";")],g.identity);vt.exit().remove(),vt.enter().append(Xe.node).each(function(){var Dt=A.select(this);Xe.attrs&&Dt.attr(Xe.attrs),Dt.attr("id",Ye);var Kt=Dt.selectAll("stop").data(Ve);Kt.exit().remove(),Kt.enter().append("stop"),Kt.each(function(Ft){var Mt=e(Ft[1]);A.select(this).attr({offset:Ft[0]+"%","stop-color":n.tinyRGB(Mt),"stop-opacity":Mt.getAlpha()})})}),ge.style(we,q(Ye,me)).style(we+"-opacity",null),ge.classed("gradient_filled",!0)},o.pattern=function(ge,me,Ee,Pe,Ue,we,ke,Xe,Ve,Ie,De,Ye){var vt=me==="legend";Xe&&(Ve==="overlay"?(Ie=Xe,De=n.contrast(Ie)):(Ie=void 0,De=Xe));var Dt=Ee._fullLayout,Kt="p"+Dt._uid+"-"+Pe,Ft,Mt,Xt=function(wt,Ut,Rt,Nt,Wt){return Nt+(Wt-Nt)*(wt-Ut)/(Rt-Ut)},It,At,Ge,tt,He={},Ae=e(De),Ne=n.tinyRGB(Ae),Ze=Ae.getAlpha(),Qe=Ye*Ze;switch(Ue){case"/":Ft=we*Math.sqrt(2),Mt=we*Math.sqrt(2),It="M-"+Ft/4+","+Mt/4+"l"+Ft/2+",-"+Mt/2+"M0,"+Mt+"L"+Ft+",0M"+Ft/4*3+","+Mt/4*5+"l"+Ft/2+",-"+Mt/2,At=ke*we,tt="path",He={d:It,opacity:Qe,stroke:Ne,"stroke-width":At+"px"};break;case"\\":Ft=we*Math.sqrt(2),Mt=we*Math.sqrt(2),It="M"+Ft/4*3+",-"+Mt/4+"l"+Ft/2+","+Mt/2+"M0,0L"+Ft+","+Mt+"M-"+Ft/4+","+Mt/4*3+"l"+Ft/2+","+Mt/2,At=ke*we,tt="path",He={d:It,opacity:Qe,stroke:Ne,"stroke-width":At+"px"};break;case"x":Ft=we*Math.sqrt(2),Mt=we*Math.sqrt(2),It="M-"+Ft/4+","+Mt/4+"l"+Ft/2+",-"+Mt/2+"M0,"+Mt+"L"+Ft+",0M"+Ft/4*3+","+Mt/4*5+"l"+Ft/2+",-"+Mt/2+"M"+Ft/4*3+",-"+Mt/4+"l"+Ft/2+","+Mt/2+"M0,0L"+Ft+","+Mt+"M-"+Ft/4+","+Mt/4*3+"l"+Ft/2+","+Mt/2,At=we-we*Math.sqrt(1-ke),tt="path",He={d:It,opacity:Qe,stroke:Ne,"stroke-width":At+"px"};break;case"|":Ft=we,Mt=we,tt="path",It="M"+Ft/2+",0L"+Ft/2+","+Mt,At=ke*we,tt="path",He={d:It,opacity:Qe,stroke:Ne,"stroke-width":At+"px"};break;case"-":Ft=we,Mt=we,tt="path",It="M0,"+Mt/2+"L"+Ft+","+Mt/2,At=ke*we,tt="path",He={d:It,opacity:Qe,stroke:Ne,"stroke-width":At+"px"};break;case"+":Ft=we,Mt=we,tt="path",It="M"+Ft/2+",0L"+Ft/2+","+Mt+"M0,"+Mt/2+"L"+Ft+","+Mt/2,At=we-we*Math.sqrt(1-ke),tt="path",He={d:It,opacity:Qe,stroke:Ne,"stroke-width":At+"px"};break;case".":Ft=we,Mt=we,ke<Math.PI/4?Ge=Math.sqrt(ke*we*we/Math.PI):Ge=Xt(ke,Math.PI/4,1,we/2,we/Math.sqrt(2)),tt="circle",He={cx:Ft/2,cy:Mt/2,r:Ge,opacity:Qe,fill:Ne};break}var bt=[Ue||"noSh",Ie||"noBg",De||"noFg",we,ke].join(";"),dt=Dt._defs.select(".patterns").selectAll("#"+Kt).data([bt],g.identity);dt.exit().remove(),dt.enter().append("pattern").each(function(){var wt=A.select(this);if(wt.attr({id:Kt,width:Ft+"px",height:Mt+"px",patternUnits:"userSpaceOnUse",patternTransform:vt?"scale(0.8)":""}),Ie){var Ut=e(Ie),Rt=n.tinyRGB(Ut),Nt=Ut.getAlpha(),Wt=wt.selectAll("rect").data([0]);Wt.exit().remove(),Wt.enter().append("rect").attr({width:Ft+"px",height:Mt+"px",fill:Rt,"fill-opacity":Nt})}var Vt=wt.selectAll(tt).data([0]);Vt.exit().remove(),Vt.enter().append(tt).attr(He)}),ge.style("fill",q(Kt,Ee)).style("fill-opacity",null),ge.classed("pattern_filled",!0)},o.initGradients=function(ge){var me=ge._fullLayout,Ee=g.ensureSingle(me._defs,"g","gradients");Ee.selectAll("linearGradient,radialGradient").remove(),A.select(ge).selectAll(".gradient_filled").classed("gradient_filled",!1)},o.initPatterns=function(ge){var me=ge._fullLayout,Ee=g.ensureSingle(me._defs,"g","patterns");Ee.selectAll("pattern").remove(),A.select(ge).selectAll(".pattern_filled").classed("pattern_filled",!1)},o.getPatternAttr=function(ge,me,Ee){return ge&&g.isArrayOrTypedArray(ge)?me<ge.length?ge[me]:Ee:ge},o.pointStyle=function(ge,me,Ee){if(ge.size()){var Pe=o.makePointStyleFns(me);ge.each(function(Ue){o.singlePointStyle(Ue,A.select(this),me,Pe,Ee)})}},o.singlePointStyle=function(ge,me,Ee,Pe,Ue){var we=Ee.marker,ke=we.line;if(me.style("opacity",Pe.selectedOpacityFn?Pe.selectedOpacityFn(ge):ge.mo===void 0?we.opacity:ge.mo),Pe.ms2mrc){var Xe;ge.ms==="various"||we.size==="various"?Xe=3:Xe=Pe.ms2mrc(ge.ms),ge.mrc=Xe,Pe.selectedSizeFn&&(Xe=ge.mrc=Pe.selectedSizeFn(ge));var Ve=o.symbolNumber(ge.mx||we.symbol)||0;ge.om=Ve%200>=100;var Ie=ye(ge,Ee),De=$(ge,Ee);me.attr("d",c(Ve,Xe,Ie,De))}var Ye=!1,vt,Dt,Kt;if(ge.so)Kt=ke.outlierwidth,Dt=ke.outliercolor,vt=we.outliercolor;else{var Ft=(ke||{}).width;Kt=(ge.mlw+1||Ft+1||(ge.trace?(ge.trace.marker.line||{}).width:0)+1)-1||0,"mlc"in ge?Dt=ge.mlcc=Pe.lineScale(ge.mlc):g.isArrayOrTypedArray(ke.color)?Dt=n.defaultLine:Dt=ke.color,g.isArrayOrTypedArray(we.color)&&(vt=n.defaultLine,Ye=!0),"mc"in ge?vt=ge.mcc=Pe.markerScale(ge.mc):vt=we.color||"rgba(0,0,0,0)",Pe.selectedColorFn&&(vt=Pe.selectedColorFn(ge))}if(ge.om)me.call(n.stroke,vt).style({"stroke-width":(Kt||1)+"px",fill:"none"});else{me.style("stroke-width",(ge.isBlank?0:Kt)+"px");var Mt=we.gradient,Xt=ge.mgt;Xt?Ye=!0:Xt=Mt&&Mt.type,g.isArrayOrTypedArray(Xt)&&(Xt=Xt[0],T[Xt]||(Xt=0));var It=we.pattern,At=It&&o.getPatternAttr(It.shape,ge.i,"");if(Xt&&Xt!=="none"){var Ge=ge.mgc;Ge?Ye=!0:Ge=Mt.color;var tt=Ee.uid;Ye&&(tt+="-"+ge.i),o.gradient(me,Ue,tt,Xt,[[0,Ge],[1,vt]],"fill")}else if(At){var He=o.getPatternAttr(It.bgcolor,ge.i,null),Ae=o.getPatternAttr(It.fgcolor,ge.i,null),Ne=It.fgopacity,Ze=o.getPatternAttr(It.size,ge.i,8),Qe=o.getPatternAttr(It.solidity,ge.i,.3),bt=ge.mcc||g.isArrayOrTypedArray(It.shape)||g.isArrayOrTypedArray(It.bgcolor)||g.isArrayOrTypedArray(It.size)||g.isArrayOrTypedArray(It.solidity),dt=Ee.uid;bt&&(dt+="-"+ge.i),o.pattern(me,"point",Ue,dt,At,Ze,Qe,ge.mcc,It.fillmode,He,Ae,Ne)}else n.fill(me,vt);Kt&&n.stroke(me,Dt)}},o.makePointStyleFns=function(ge){var me={},Ee=ge.marker;return me.markerScale=o.tryColorscale(Ee,""),me.lineScale=o.tryColorscale(Ee,"line"),a.traceIs(ge,"symbols")&&(me.ms2mrc=v.isBubble(ge)?f(ge):function(){return(Ee.size||6)/2}),ge.selectedpoints&&g.extendFlat(me,o.makeSelectedPointStyleFns(ge)),me},o.makeSelectedPointStyleFns=function(ge){var me={},Ee=ge.selected||{},Pe=ge.unselected||{},Ue=ge.marker||{},we=Ee.marker||{},ke=Pe.marker||{},Xe=Ue.opacity,Ve=we.opacity,Ie=ke.opacity,De=Ve!==void 0,Ye=Ie!==void 0;(g.isArrayOrTypedArray(Xe)||De||Ye)&&(me.selectedOpacityFn=function(Ge){var tt=Ge.mo===void 0?Ue.opacity:Ge.mo;return Ge.selected?De?Ve:tt:Ye?Ie:p*tt});var vt=Ue.color,Dt=we.color,Kt=ke.color;(Dt||Kt)&&(me.selectedColorFn=function(Ge){var tt=Ge.mcc||vt;return Ge.selected?Dt||tt:Kt||tt});var Ft=Ue.size,Mt=we.size,Xt=ke.size,It=Mt!==void 0,At=Xt!==void 0;return a.traceIs(ge,"symbols")&&(It||At)&&(me.selectedSizeFn=function(Ge){var tt=Ge.mrc||Ft/2;return Ge.selected?It?Mt/2:tt:At?Xt/2:tt}),me},o.makeSelectedTextStyleFns=function(ge){var me={},Ee=ge.selected||{},Pe=ge.unselected||{},Ue=ge.textfont||{},we=Ee.textfont||{},ke=Pe.textfont||{},Xe=Ue.color,Ve=we.color,Ie=ke.color;return me.selectedTextColorFn=function(De){var Ye=De.tc||Xe;return De.selected?Ve||Ye:Ie||(Ve?Ye:n.addOpacity(Ye,p))},me},o.selectedPointStyle=function(ge,me){if(!(!ge.size()||!me.selectedpoints)){var Ee=o.makeSelectedPointStyleFns(me),Pe=me.marker||{},Ue=[];Ee.selectedOpacityFn&&Ue.push(function(we,ke){we.style("opacity",Ee.selectedOpacityFn(ke))}),Ee.selectedColorFn&&Ue.push(function(we,ke){n.fill(we,Ee.selectedColorFn(ke))}),Ee.selectedSizeFn&&Ue.push(function(we,ke){var Xe=ke.mx||Pe.symbol||0,Ve=Ee.selectedSizeFn(ke);we.attr("d",c(o.symbolNumber(Xe),Ve,ye(ke,me),$(ke,me))),ke.mrc2=Ve}),Ue.length&&ge.each(function(we){for(var ke=A.select(this),Xe=0;Xe<Ue.length;Xe++)Ue[Xe](ke,we)})}},o.tryColorscale=function(ge,me){var Ee=me?g.nestedProperty(ge,me).get():ge;if(Ee){var Pe=Ee.color;if((Ee.colorscale||Ee._colorAx)&&g.isArrayOrTypedArray(Pe))return r.makeColorScaleFuncFromTrace(Ee)}return g.identity};var k={start:1,end:-1,middle:0,bottom:1,top:-1};function P(ge,me,Ee,Pe,Ue){var we=A.select(ge.node().parentNode),ke=me.indexOf("top")!==-1?"top":me.indexOf("bottom")!==-1?"bottom":"middle",Xe=me.indexOf("left")!==-1?"end":me.indexOf("right")!==-1?"start":"middle",Ve=Pe?Pe/.8+1:0,Ie=(h.lineCount(ge)-1)*x+1,De=k[Xe]*Ve,Ye=Ee*.75+k[ke]*Ve+(k[ke]-1)*Ie*Ee/2;ge.attr("text-anchor",Xe),Ue||we.attr("transform",t(De,Ye))}function z(ge,me){var Ee=ge.ts||me.textfont.size;return M(Ee)&&Ee>0?Ee:0}o.textPointStyle=function(ge,me,Ee){if(ge.size()){var Pe;if(me.selectedpoints){var Ue=o.makeSelectedTextStyleFns(me);Pe=Ue.selectedTextColorFn}var we=me.texttemplate,ke=Ee._fullLayout;ge.each(function(Xe){var Ve=A.select(this),Ie=we?g.extractOption(Xe,me,"txt","texttemplate"):g.extractOption(Xe,me,"tx","text");if(!Ie&&Ie!==0){Ve.remove();return}if(we){var De=me._module.formatLabels,Ye=De?De(Xe,me,ke):{},vt={};d(vt,me,Xe.i);var Dt=me._meta||{};Ie=g.texttemplateString(Ie,Ye,ke._d3locale,vt,Xe,Dt)}var Kt=Xe.tp||me.textposition,Ft=z(Xe,me),Mt=Pe?Pe(Xe):Xe.tc||me.textfont.color;Ve.call(o.font,Xe.tf||me.textfont.family,Ft,Mt).text(Ie).call(h.convertToTspans,Ee).call(P,Kt,Ft,Xe.mrc)})}},o.selectedTextStyle=function(ge,me){if(!(!ge.size()||!me.selectedpoints)){var Ee=o.makeSelectedTextStyleFns(me);ge.each(function(Pe){var Ue=A.select(this),we=Ee.selectedTextColorFn(Pe),ke=Pe.tp||me.textposition,Xe=z(Pe,me);n.fill(Ue,we);var Ve=a.traceIs(me,"bar-like");P(Ue,ke,Xe,Pe.mrc2||Pe.mrc,Ve)})}};var I=.5;o.smoothopen=function(ge,me){if(ge.length<3)return"M"+ge.join("L");var Ee="M"+ge[0],Pe=[],Ue;for(Ue=1;Ue<ge.length-1;Ue++)Pe.push(G(ge[Ue-1],ge[Ue],ge[Ue+1],me));for(Ee+="Q"+Pe[0][0]+" "+ge[1],Ue=2;Ue<ge.length-1;Ue++)Ee+="C"+Pe[Ue-2][1]+" "+Pe[Ue-1][0]+" "+ge[Ue];return Ee+="Q"+Pe[ge.length-3][1]+" "+ge[ge.length-1],Ee},o.smoothclosed=function(ge,me){if(ge.length<3)return"M"+ge.join("L")+"Z";var Ee="M"+ge[0],Pe=ge.length-1,Ue=[G(ge[Pe],ge[0],ge[1],me)],we;for(we=1;we<Pe;we++)Ue.push(G(ge[we-1],ge[we],ge[we+1],me));for(Ue.push(G(ge[Pe-1],ge[Pe],ge[0],me)),we=1;we<=Pe;we++)Ee+="C"+Ue[we-1][1]+" "+Ue[we][0]+" "+ge[we];return Ee+="C"+Ue[Pe][1]+" "+Ue[0][0]+" "+ge[0]+"Z",Ee};var D,R;function O(ge,me,Ee){return Ee&&(ge=Y(ge)),me?N(ge[1]):F(ge[0])}function F(ge){var me=A.round(ge,2);return D=me,me}function N(ge){var me=A.round(ge,2);return R=me,me}function G(ge,me,Ee,Pe){var Ue=ge[0]-me[0],we=ge[1]-me[1],ke=Ee[0]-me[0],Xe=Ee[1]-me[1],Ve=Math.pow(Ue*Ue+we*we,I/2),Ie=Math.pow(ke*ke+Xe*Xe,I/2),De=(Ie*Ie*Ue-Ve*Ve*ke)*Pe,Ye=(Ie*Ie*we-Ve*Ve*Xe)*Pe,vt=3*Ie*(Ve+Ie),Dt=3*Ve*(Ve+Ie);return[[F(me[0]+(vt&&De/vt)),N(me[1]+(vt&&Ye/vt))],[F(me[0]-(Dt&&De/Dt)),N(me[1]-(Dt&&Ye/Dt))]]}var K={hv:function(ge,me,Ee){return"H"+F(me[0])+"V"+O(me,1,Ee)},vh:function(ge,me,Ee){return"V"+N(me[1])+"H"+O(me,0,Ee)},hvh:function(ge,me,Ee){return"H"+F((ge[0]+me[0])/2)+"V"+N(me[1])+"H"+O(me,0,Ee)},vhv:function(ge,me,Ee){return"V"+N((ge[1]+me[1])/2)+"H"+F(me[0])+"V"+O(me,1,Ee)}},W=function(ge,me,Ee){return"L"+O(me,0,Ee)+","+O(me,1,Ee)};o.steps=function(ge){var me=K[ge]||W;return function(Ee){for(var Pe="M"+F(Ee[0][0])+","+N(Ee[0][1]),Ue=Ee.length,we=1;we<Ue;we++)Pe+=me(Ee[we-1],Ee[we],we===Ue-1);return Pe}};function Y(ge,me){var Ee=ge.backoff,Pe=ge.trace,Ue=ge.d,we=ge.i;if(Ee&&Pe&&Pe.marker&&Pe.marker.angle%360===0&&Pe.line&&Pe.line.shape!=="spline"){var ke=g.isArrayOrTypedArray(Ee),Xe=ge,Ve=me?me[0]:D||0,Ie=me?me[1]:R||0,De=Xe[0],Ye=Xe[1],vt=De-Ve,Dt=Ye-Ie,Kt=Math.atan2(Dt,vt),Ft=ke?Ee[we]:Ee;if(Ft==="auto"){var Mt=Xe.i;Pe.type==="scatter"&&Mt--;var Xt=Xe.marker;Ft=Xt?o.symbolBackOffs[o.symbolNumber(Xt.symbol)]*Xt.size:0,Ft+=o.getMarkerStandoff(Ue[Mt],Pe)||0}var It=De-Ft*Math.cos(Kt),At=Ye-Ft*Math.sin(Kt);(It<=De&&It>=Ve||It>=De&&It<=Ve)&&(At<=Ye&&At>=Ie||At>=Ye&&At<=Ie)&&(ge=[It,At])}return ge}o.applyBackoff=Y,o.makeTester=function(){var ge=g.ensureSingleById(A.select("body"),"svg","js-plotly-tester",function(Ee){Ee.attr(s.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),me=g.ensureSingle(ge,"path","js-reference-point",function(Ee){Ee.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});o.tester=ge,o.testref=me},o.savedBBoxes={};var re=0,ue=1e4;o.bBox=function(ge,me,Ee){Ee||(Ee=j(ge));var Pe;if(Ee){if(Pe=o.savedBBoxes[Ee],Pe)return g.extendFlat({},Pe)}else if(ge.childNodes.length===1){var Ue=ge.childNodes[0];if(Ee=j(Ue),Ee){var we=+Ue.getAttribute("x")||0,ke=+Ue.getAttribute("y")||0,Xe=Ue.getAttribute("transform");if(!Xe){var Ve=o.bBox(Ue,!1,Ee);return we&&(Ve.left+=we,Ve.right+=we),ke&&(Ve.top+=ke,Ve.bottom+=ke),Ve}if(Ee+="~"+we+"~"+ke+"~"+Xe,Pe=o.savedBBoxes[Ee],Pe)return g.extendFlat({},Pe)}}var Ie,De;me?Ie=ge:(De=o.tester.node(),Ie=ge.cloneNode(!0),De.appendChild(Ie)),A.select(Ie).attr("transform",null).call(h.positionText,0,0);var Ye=Ie.getBoundingClientRect(),vt=o.testref.node().getBoundingClientRect();me||De.removeChild(Ie);var Dt={height:Ye.height,width:Ye.width,left:Ye.left-vt.left,top:Ye.top-vt.top,right:Ye.right-vt.left,bottom:Ye.bottom-vt.top};return re>=ue&&(o.savedBBoxes={},re=0),Ee&&(o.savedBBoxes[Ee]=Dt),re++,g.extendFlat({},Dt)};function j(ge){var me=ge.getAttribute("data-unformatted");if(me!==null)return me+ge.getAttribute("data-math")+ge.getAttribute("text-anchor")+ge.getAttribute("style")}o.setClipUrl=function(ge,me,Ee){ge.attr("clip-path",q(me,Ee))};function q(ge,me){if(!ge)return null;var Ee=me._context,Pe=Ee._exportedPlot?"":Ee._baseUrl||"";return Pe?"url('"+Pe+"#"+ge+"')":"url(#"+ge+")"}o.getTranslate=function(ge){var me=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,Ee=ge.attr?"attr":"getAttribute",Pe=ge[Ee]("transform")||"",Ue=Pe.replace(me,function(we,ke,Xe){return[ke,Xe].join(" ")}).split(" ");return{x:+Ue[0]||0,y:+Ue[1]||0}},o.setTranslate=function(ge,me,Ee){var Pe=/(\btranslate\(.*?\);?)/,Ue=ge.attr?"attr":"getAttribute",we=ge.attr?"attr":"setAttribute",ke=ge[Ue]("transform")||"";return me=me||0,Ee=Ee||0,ke=ke.replace(Pe,"").trim(),ke+=t(me,Ee),ke=ke.trim(),ge[we]("transform",ke),ke},o.getScale=function(ge){var me=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,Ee=ge.attr?"attr":"getAttribute",Pe=ge[Ee]("transform")||"",Ue=Pe.replace(me,function(we,ke,Xe){return[ke,Xe].join(" ")}).split(" ");return{x:+Ue[0]||1,y:+Ue[1]||1}},o.setScale=function(ge,me,Ee){var Pe=/(\bscale\(.*?\);?)/,Ue=ge.attr?"attr":"getAttribute",we=ge.attr?"attr":"setAttribute",ke=ge[Ue]("transform")||"";return me=me||1,Ee=Ee||1,ke=ke.replace(Pe,"").trim(),ke+="scale("+me+","+Ee+")",ke=ke.trim(),ge[we]("transform",ke),ke};var H=/\s*sc.*/;o.setPointGroupScale=function(ge,me,Ee){if(me=me||1,Ee=Ee||1,!!ge){var Pe=me===1&&Ee===1?"":"scale("+me+","+Ee+")";ge.each(function(){var Ue=(this.getAttribute("transform")||"").replace(H,"");Ue+=Pe,Ue=Ue.trim(),this.setAttribute("transform",Ue)})}};var U=/translate\([^)]*\)\s*$/;o.setTextPointsScale=function(ge,me,Ee){ge&&ge.each(function(){var Pe,Ue=A.select(this),we=Ue.select("text");if(we.node()){var ke=parseFloat(we.attr("x")||0),Xe=parseFloat(we.attr("y")||0),Ve=(Ue.attr("transform")||"").match(U);me===1&&Ee===1?Pe=[]:Pe=[t(ke,Xe),"scale("+me+","+Ee+")",t(-ke,-Xe)],Ve&&Pe.push(Ve),Ue.attr("transform",Pe.join(""))}})};function $(ge,me){var Ee;return ge&&(Ee=ge.mf),Ee===void 0&&(Ee=me.marker&&me.marker.standoff||0),!me._geo&&!me._xA?-Ee:Ee}o.getMarkerStandoff=$;var ne=Math.atan2,X=Math.cos,Q=Math.sin;function ie(ge,me){var Ee=me[0],Pe=me[1];return[Ee*X(ge)-Pe*Q(ge),Ee*Q(ge)+Pe*X(ge)]}var se,ae,oe,be,ce,de;function ye(ge,me){var Ee=ge.ma;Ee===void 0&&(Ee=me.marker.angle||0);var Pe,Ue,we=me.marker.angleref;if(we==="previous"||we==="north"){if(me._geo){var ke=me._geo.project(ge.lonlat);Pe=ke[0],Ue=ke[1]}else{var Xe=me._xA,Ve=me._yA;if(Xe&&Ve)Pe=Xe.c2p(ge.x),Ue=Ve.c2p(ge.y);else return 90}if(me._geo){var Ie=ge.lonlat[0],De=ge.lonlat[1],Ye=me._geo.project([Ie,De+1e-5]),vt=me._geo.project([Ie+1e-5,De]),Dt=ne(vt[1]-Ue,vt[0]-Pe),Kt=ne(Ye[1]-Ue,Ye[0]-Pe),Ft;if(we==="north")Ft=Ee/180*Math.PI;else if(we==="previous"){var Mt=Ie/180*Math.PI,Xt=De/180*Math.PI,It=se/180*Math.PI,At=ae/180*Math.PI,Ge=It-Mt,tt=X(At)*Q(Ge),He=Q(At)*X(Xt)-X(At)*Q(Xt)*X(Ge);Ft=-ne(tt,He)-Math.PI,se=Ie,ae=De}var Ae=ie(Dt,[X(Ft),0]),Ne=ie(Kt,[Q(Ft),0]);Ee=ne(Ae[1]+Ne[1],Ae[0]+Ne[0])/Math.PI*180,we==="previous"&&!(de===me.uid&&ge.i===ce+1)&&(Ee=null)}if(we==="previous"&&!me._geo)if(de===me.uid&&ge.i===ce+1&&M(Pe)&&M(Ue)){var Ze=Pe-oe,Qe=Ue-be,bt=me.line&&me.line.shape||"",dt=bt.slice(bt.length-1);dt==="h"&&(Qe=0),dt==="v"&&(Ze=0),Ee+=ne(Qe,Ze)/Math.PI*180+90}else Ee=null}return oe=Pe,be=Ue,ce=ge.i,de=me.uid,Ee}o.getMarkerAngle=ye},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(y,ee,te){var A=y("parse-svg-path"),g=y("@plotly/d3").round,S="M0,0Z",M=Math.sqrt(2),e=Math.sqrt(3),a=Math.PI,n=Math.cos,r=Math.sin;ee.exports={circle:{n:0,f:function(v,f,d){if(t(f))return S;var o=g(v,2),m="M"+o+",0A"+o+","+o+" 0 1,1 0,-"+o+"A"+o+","+o+" 0 0,1 "+o+",0Z";return d?p(f,d,m):m}},square:{n:1,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M"+o+","+o+"H-"+o+"V-"+o+"H"+o+"Z")}},diamond:{n:2,f:function(v,f,d){if(t(f))return S;var o=g(v*1.3,2);return p(f,d,"M"+o+",0L0,"+o+"L-"+o+",0L0,-"+o+"Z")}},cross:{n:3,f:function(v,f,d){if(t(f))return S;var o=g(v*.4,2),m=g(v*1.2,2);return p(f,d,"M"+m+","+o+"H"+o+"V"+m+"H-"+o+"V"+o+"H-"+m+"V-"+o+"H-"+o+"V-"+m+"H"+o+"V-"+o+"H"+m+"Z")}},x:{n:4,f:function(v,f,d){if(t(f))return S;var o=g(v*.8/M,2),m="l"+o+","+o,l="l"+o+",-"+o,w="l-"+o+",-"+o,_="l-"+o+","+o;return p(f,d,"M0,"+o+m+l+w+l+w+_+w+_+m+_+m+"Z")}},"triangle-up":{n:5,f:function(v,f,d){if(t(f))return S;var o=g(v*2/e,2),m=g(v/2,2),l=g(v,2);return p(f,d,"M-"+o+","+m+"H"+o+"L0,-"+l+"Z")}},"triangle-down":{n:6,f:function(v,f,d){if(t(f))return S;var o=g(v*2/e,2),m=g(v/2,2),l=g(v,2);return p(f,d,"M-"+o+",-"+m+"H"+o+"L0,"+l+"Z")}},"triangle-left":{n:7,f:function(v,f,d){if(t(f))return S;var o=g(v*2/e,2),m=g(v/2,2),l=g(v,2);return p(f,d,"M"+m+",-"+o+"V"+o+"L-"+l+",0Z")}},"triangle-right":{n:8,f:function(v,f,d){if(t(f))return S;var o=g(v*2/e,2),m=g(v/2,2),l=g(v,2);return p(f,d,"M-"+m+",-"+o+"V"+o+"L"+l+",0Z")}},"triangle-ne":{n:9,f:function(v,f,d){if(t(f))return S;var o=g(v*.6,2),m=g(v*1.2,2);return p(f,d,"M-"+m+",-"+o+"H"+o+"V"+m+"Z")}},"triangle-se":{n:10,f:function(v,f,d){if(t(f))return S;var o=g(v*.6,2),m=g(v*1.2,2);return p(f,d,"M"+o+",-"+m+"V"+o+"H-"+m+"Z")}},"triangle-sw":{n:11,f:function(v,f,d){if(t(f))return S;var o=g(v*.6,2),m=g(v*1.2,2);return p(f,d,"M"+m+","+o+"H-"+o+"V-"+m+"Z")}},"triangle-nw":{n:12,f:function(v,f,d){if(t(f))return S;var o=g(v*.6,2),m=g(v*1.2,2);return p(f,d,"M-"+o+","+m+"V-"+o+"H"+m+"Z")}},pentagon:{n:13,f:function(v,f,d){if(t(f))return S;var o=g(v*.951,2),m=g(v*.588,2),l=g(-v,2),w=g(v*-.309,2),_=g(v*.809,2);return p(f,d,"M"+o+","+w+"L"+m+","+_+"H-"+m+"L-"+o+","+w+"L0,"+l+"Z")}},hexagon:{n:14,f:function(v,f,d){if(t(f))return S;var o=g(v,2),m=g(v/2,2),l=g(v*e/2,2);return p(f,d,"M"+l+",-"+m+"V"+m+"L0,"+o+"L-"+l+","+m+"V-"+m+"L0,-"+o+"Z")}},hexagon2:{n:15,f:function(v,f,d){if(t(f))return S;var o=g(v,2),m=g(v/2,2),l=g(v*e/2,2);return p(f,d,"M-"+m+","+l+"H"+m+"L"+o+",0L"+m+",-"+l+"H-"+m+"L-"+o+",0Z")}},octagon:{n:16,f:function(v,f,d){if(t(f))return S;var o=g(v*.924,2),m=g(v*.383,2);return p(f,d,"M-"+m+",-"+o+"H"+m+"L"+o+",-"+m+"V"+m+"L"+m+","+o+"H-"+m+"L-"+o+","+m+"V-"+m+"Z")}},star:{n:17,f:function(v,f,d){if(t(f))return S;var o=v*1.4,m=g(o*.225,2),l=g(o*.951,2),w=g(o*.363,2),_=g(o*.588,2),c=g(-o,2),b=g(o*-.309,2),u=g(o*.118,2),L=g(o*.809,2),T=g(o*.382,2);return p(f,d,"M"+m+","+b+"H"+l+"L"+w+","+u+"L"+_+","+L+"L0,"+T+"L-"+_+","+L+"L-"+w+","+u+"L-"+l+","+b+"H-"+m+"L0,"+c+"Z")}},hexagram:{n:18,f:function(v,f,d){if(t(f))return S;var o=g(v*.66,2),m=g(v*.38,2),l=g(v*.76,2);return p(f,d,"M-"+l+",0l-"+m+",-"+o+"h"+l+"l"+m+",-"+o+"l"+m+","+o+"h"+l+"l-"+m+","+o+"l"+m+","+o+"h-"+l+"l-"+m+","+o+"l-"+m+",-"+o+"h-"+l+"Z")}},"star-triangle-up":{n:19,f:function(v,f,d){if(t(f))return S;var o=g(v*e*.8,2),m=g(v*.8,2),l=g(v*1.6,2),w=g(v*4,2),_="A "+w+","+w+" 0 0 1 ";return p(f,d,"M-"+o+","+m+_+o+","+m+_+"0,-"+l+_+"-"+o+","+m+"Z")}},"star-triangle-down":{n:20,f:function(v,f,d){if(t(f))return S;var o=g(v*e*.8,2),m=g(v*.8,2),l=g(v*1.6,2),w=g(v*4,2),_="A "+w+","+w+" 0 0 1 ";return p(f,d,"M"+o+",-"+m+_+"-"+o+",-"+m+_+"0,"+l+_+o+",-"+m+"Z")}},"star-square":{n:21,f:function(v,f,d){if(t(f))return S;var o=g(v*1.1,2),m=g(v*2,2),l="A "+m+","+m+" 0 0 1 ";return p(f,d,"M-"+o+",-"+o+l+"-"+o+","+o+l+o+","+o+l+o+",-"+o+l+"-"+o+",-"+o+"Z")}},"star-diamond":{n:22,f:function(v,f,d){if(t(f))return S;var o=g(v*1.4,2),m=g(v*1.9,2),l="A "+m+","+m+" 0 0 1 ";return p(f,d,"M-"+o+",0"+l+"0,"+o+l+o+",0"+l+"0,-"+o+l+"-"+o+",0Z")}},"diamond-tall":{n:23,f:function(v,f,d){if(t(f))return S;var o=g(v*.7,2),m=g(v*1.4,2);return p(f,d,"M0,"+m+"L"+o+",0L0,-"+m+"L-"+o+",0Z")}},"diamond-wide":{n:24,f:function(v,f,d){if(t(f))return S;var o=g(v*1.4,2),m=g(v*.7,2);return p(f,d,"M0,"+m+"L"+o+",0L0,-"+m+"L-"+o+",0Z")}},hourglass:{n:25,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M"+o+","+o+"H-"+o+"L"+o+",-"+o+"H-"+o+"Z")},noDot:!0},bowtie:{n:26,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M"+o+","+o+"V-"+o+"L-"+o+","+o+"V-"+o+"Z")},noDot:!0},"circle-cross":{n:27,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M0,"+o+"V-"+o+"M"+o+",0H-"+o+"M"+o+",0A"+o+","+o+" 0 1,1 0,-"+o+"A"+o+","+o+" 0 0,1 "+o+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(v,f,d){if(t(f))return S;var o=g(v,2),m=g(v/M,2);return p(f,d,"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m+"M"+o+",0A"+o+","+o+" 0 1,1 0,-"+o+"A"+o+","+o+" 0 0,1 "+o+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M0,"+o+"V-"+o+"M"+o+",0H-"+o+"M"+o+","+o+"H-"+o+"V-"+o+"H"+o+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M"+o+","+o+"L-"+o+",-"+o+"M"+o+",-"+o+"L-"+o+","+o+"M"+o+","+o+"H-"+o+"V-"+o+"H"+o+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(v,f,d){if(t(f))return S;var o=g(v*1.3,2);return p(f,d,"M"+o+",0L0,"+o+"L-"+o+",0L0,-"+o+"ZM0,-"+o+"V"+o+"M-"+o+",0H"+o)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(v,f,d){if(t(f))return S;var o=g(v*1.3,2),m=g(v*.65,2);return p(f,d,"M"+o+",0L0,"+o+"L-"+o+",0L0,-"+o+"ZM-"+m+",-"+m+"L"+m+","+m+"M-"+m+","+m+"L"+m+",-"+m)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(v,f,d){if(t(f))return S;var o=g(v*1.4,2);return p(f,d,"M0,"+o+"V-"+o+"M"+o+",0H-"+o)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M"+o+","+o+"L-"+o+",-"+o+"M"+o+",-"+o+"L-"+o+","+o)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(v,f,d){if(t(f))return S;var o=g(v*1.2,2),m=g(v*.85,2);return p(f,d,"M0,"+o+"V-"+o+"M"+o+",0H-"+o+"M"+m+","+m+"L-"+m+",-"+m+"M"+m+",-"+m+"L-"+m+","+m)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(v,f,d){if(t(f))return S;var o=g(v/2,2),m=g(v,2);return p(f,d,"M"+o+","+m+"V-"+m+"M"+(o-m)+",-"+m+"V"+m+"M"+m+","+o+"H-"+m+"M-"+m+","+(o-m)+"H"+m)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(v,f,d){if(t(f))return S;var o=g(v*1.2,2),m=g(v*1.6,2),l=g(v*.8,2);return p(f,d,"M-"+o+","+l+"L0,0M"+o+","+l+"L0,0M0,-"+m+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(v,f,d){if(t(f))return S;var o=g(v*1.2,2),m=g(v*1.6,2),l=g(v*.8,2);return p(f,d,"M-"+o+",-"+l+"L0,0M"+o+",-"+l+"L0,0M0,"+m+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(v,f,d){if(t(f))return S;var o=g(v*1.2,2),m=g(v*1.6,2),l=g(v*.8,2);return p(f,d,"M"+l+","+o+"L0,0M"+l+",-"+o+"L0,0M-"+m+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(v,f,d){if(t(f))return S;var o=g(v*1.2,2),m=g(v*1.6,2),l=g(v*.8,2);return p(f,d,"M-"+l+","+o+"L0,0M-"+l+",-"+o+"L0,0M"+m+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(v,f,d){if(t(f))return S;var o=g(v*1.4,2);return p(f,d,"M"+o+",0H-"+o)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(v,f,d){if(t(f))return S;var o=g(v*1.4,2);return p(f,d,"M0,"+o+"V-"+o)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M"+o+",-"+o+"L-"+o+","+o)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(v,f,d){if(t(f))return S;var o=g(v,2);return p(f,d,"M"+o+","+o+"L-"+o+",-"+o)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(v,f,d){if(t(f))return S;var o=g(v,2),m=g(v*2,2);return p(f,d,"M0,0L-"+o+","+m+"H"+o+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(v,f,d){if(t(f))return S;var o=g(v,2),m=g(v*2,2);return p(f,d,"M0,0L-"+o+",-"+m+"H"+o+"Z")},noDot:!0},"arrow-left":{n:47,f:function(v,f,d){if(t(f))return S;var o=g(v*2,2),m=g(v,2);return p(f,d,"M0,0L"+o+",-"+m+"V"+m+"Z")},noDot:!0},"arrow-right":{n:48,f:function(v,f,d){if(t(f))return S;var o=g(v*2,2),m=g(v,2);return p(f,d,"M0,0L-"+o+",-"+m+"V"+m+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(v,f,d){if(t(f))return S;var o=g(v,2),m=g(v*2,2);return p(f,d,"M-"+o+",0H"+o+"M0,0L-"+o+","+m+"H"+o+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(v,f,d){if(t(f))return S;var o=g(v,2),m=g(v*2,2);return p(f,d,"M-"+o+",0H"+o+"M0,0L-"+o+",-"+m+"H"+o+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(v,f,d){if(t(f))return S;var o=g(v*2,2),m=g(v,2);return p(f,d,"M0,-"+m+"V"+m+"M0,0L"+o+",-"+m+"V"+m+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(v,f,d){if(t(f))return S;var o=g(v*2,2),m=g(v,2);return p(f,d,"M0,-"+m+"V"+m+"M0,0L-"+o+",-"+m+"V"+m+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(v,f,d){if(t(f))return S;var o=a/2.5,m=2*v*n(o),l=2*v*r(o);return p(f,d,"M0,0L"+-m+","+l+"L"+m+","+l+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(v,f,d){if(t(f))return S;var o=a/4,m=2*v*n(o),l=2*v*r(o);return p(f,d,"M0,0L"+-m+","+l+"A "+2*v+","+2*v+" 0 0 1 "+m+","+l+"Z")},backoff:.4,noDot:!0}};function t(v){return v===null}var h,s,i,x;function p(v,f,d){if((!v||v%360===0)&&!f)return d;if(i===v&&x===f&&h===d)return s;i=v,x=f,h=d;function o(I,D){var R=n(I),O=r(I),F=D[0],N=D[1]+(f||0);return[F*R-N*O,F*O+N*R]}for(var m=v/180*a,l=0,w=0,_=A(d),c="",b=0;b<_.length;b++){var u=_[b],L=u[0],T=l,k=w;if(L==="M"||L==="L")l=+u[1],w=+u[2];else if(L==="m"||L==="l")l+=+u[1],w+=+u[2];else if(L==="H")l=+u[1];else if(L==="h")l+=+u[1];else if(L==="V")w=+u[1];else if(L==="v")w+=+u[1];else if(L==="A"){l=+u[1],w=+u[2];var P=o(m,[+u[6],+u[7]]);u[6]=P[0],u[7]=P[1],u[3]=+u[3]+v}(L==="H"||L==="V")&&(L="L"),(L==="h"||L==="v")&&(L="l"),(L==="m"||L==="l")&&(l-=T,w-=k);var z=o(m,[l,w]);(L==="H"||L==="V")&&(L="L"),(L==="M"||L==="L"||L==="m"||L==="l")&&(u[1]=z[0],u[2]=z[1]),u[0]=L,c+=u[0]+u.slice(1).join(",")}return s=c,c}},{"@plotly/d3":58,"parse-svg-path":250}],391:[function(y,ee,te){ee.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../registry"),S=y("../../plots/cartesian/axes"),M=y("../../lib"),e=y("./compute_error");ee.exports=function(r){for(var t=r.calcdata,h=0;h<t.length;h++){var s=t[h],i=s[0].trace;if(i.visible===!0&&g.traceIs(i,"errorBarsOK")){var x=S.getFromId(r,i.xaxis),p=S.getFromId(r,i.yaxis);a(s,i,x,"x"),a(s,i,p,"y")}}};function a(n,r,t,h){var s=r["error_"+h]||{},i=s.visible&&["linear","log"].indexOf(t.type)!==-1,x=[];if(i){for(var p=e(s),v=0;v<n.length;v++){var f=n[v],d=f.i;if(d===void 0)d=v;else if(d===null)continue;var o=f[h];if(A(t.c2l(o))){var m=p(o,d);if(A(m[0])&&A(m[1])){var l=f[h+"s"]=o-m[0],w=f[h+"h"]=o+m[1];x.push(l,w)}}}var _=t._id,c=r._extremes[_],b=S.findExtremes(t,x,M.extendFlat({tozero:c.opts.tozero},{padded:!0}));c.min=c.min.concat(b.min),c.max=c.max.concat(b.max)}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(y,ee,te){ee.exports=function(S){var M=S.type,e=S.symmetric;if(M==="data"){var a=S.array||[];if(e)return function(s,i){var x=+a[i];return[x,x]};var n=S.arrayminus||[];return function(s,i){var x=+a[i],p=+n[i];return!isNaN(x)||!isNaN(p)?[p||0,x||0]:[NaN,NaN]}}else{var r=A(M,S.value),t=A(M,S.valueminus);return e||S.valueminus===void 0?function(s){var i=r(s);return[i,i]}:function(s){return[t(s),r(s)]}}};function A(g,S){if(g==="percent")return function(M){return Math.abs(M*S/100)};if(g==="constant")return function(){return Math.abs(S)};if(g==="sqrt")return function(M){return Math.sqrt(Math.abs(M))}}},{}],394:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../registry"),S=y("../../lib"),M=y("../../plot_api/plot_template"),e=y("./attributes");ee.exports=function(a,n,r,t){var h="error_"+t.axis,s=M.newContainer(n,h),i=a[h]||{};function x(l,w){return S.coerce(i,s,e,l,w)}var p=i.array!==void 0||i.value!==void 0||i.type==="sqrt",v=x("visible",p);if(v!==!1){var f=x("type","array"in i?"data":"percent"),d=!0;f!=="sqrt"&&(d=x("symmetric",!((f==="data"?"arrayminus":"valueminus")in i))),f==="data"?(x("array"),x("traceref"),d||(x("arrayminus"),x("tracerefminus"))):(f==="percent"||f==="constant")&&(x("value"),d||x("valueminus"));var o="copy_"+t.inherit+"style";if(t.inherit){var m=n["error_"+t.inherit];(m||{}).visible&&x(o,!(i.color||A(i.thickness)||A(i.width)))}(!t.inherit||!s[o])&&(x("color",r),x("thickness"),x("width",g.traceIs(n,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(y,ee,te){var A=y("../../lib"),g=y("../../plot_api/edit_types").overrideAll,S=y("./attributes"),M={error_x:A.extendFlat({},S),error_y:A.extendFlat({},S)};delete M.error_x.copy_zstyle,delete M.error_y.copy_zstyle,delete M.error_y.copy_ystyle;var e={error_x:A.extendFlat({},S),error_y:A.extendFlat({},S),error_z:A.extendFlat({},S)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,ee.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:M,bar:M,histogram:M,scatter3d:g(e,"calc","nested"),scattergl:g(M,"calc","nested")}},supplyDefaults:y("./defaults"),calc:y("./calc"),makeComputeError:y("./compute_error"),plot:y("./plot"),style:y("./style"),hoverInfo:a};function a(n,r,t){(r.error_y||{}).visible&&(t.yerr=n.yh-n.y,r.error_y.symmetric||(t.yerrneg=n.y-n.ys)),(r.error_x||{}).visible&&(t.xerr=n.xh-n.x,r.error_x.symmetric||(t.xerrneg=n.x-n.xs))}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("../drawing"),M=y("../../traces/scatter/subtypes");ee.exports=function(n,r,t,h){var s,i=t.xaxis,x=t.yaxis,p=h&&h.duration>0;r.each(function(v){var f=v[0].trace,d=f.error_x||{},o=f.error_y||{},m;f.ids&&(m=function(c){return c.id});var l=M.hasMarkers(f)&&f.marker.maxdisplayed>0;!o.visible&&!d.visible&&(v=[]);var w=A.select(this).selectAll("g.errorbar").data(v,m);if(w.exit().remove(),!!v.length){d.visible||w.selectAll("path.xerror").remove(),o.visible||w.selectAll("path.yerror").remove(),w.style("opacity",1);var _=w.enter().append("g").classed("errorbar",!0);p&&_.style("opacity",0).transition().duration(h.duration).style("opacity",1),S.setClipUrl(w,t.layerClipId,n),w.each(function(c){var b=A.select(this),u=e(c,i,x);if(!(l&&!c.vis)){var L,T=b.select("path.yerror");if(o.visible&&g(u.x)&&g(u.yh)&&g(u.ys)){var k=o.width;L="M"+(u.x-k)+","+u.yh+"h"+2*k+"m-"+k+",0V"+u.ys,u.noYS||(L+="m-"+k+",0h"+2*k),s=!T.size(),s?T=b.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):p&&(T=T.transition().duration(h.duration).ease(h.easing)),T.attr("d",L)}else T.remove();var P=b.select("path.xerror");if(d.visible&&g(u.y)&&g(u.xh)&&g(u.xs)){var z=(d.copy_ystyle?o:d).width;L="M"+u.xh+","+(u.y-z)+"v"+2*z+"m0,-"+z+"H"+u.xs,u.noXS||(L+="m0,-"+z+"v"+2*z),s=!P.size(),s?P=b.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):p&&(P=P.transition().duration(h.duration).ease(h.easing)),P.attr("d",L)}else P.remove()}})}})};function e(a,n,r){var t={x:n.c2p(a.x),y:r.c2p(a.y)};return a.yh!==void 0&&(t.yh=r.c2p(a.yh),t.ys=r.c2p(a.ys),g(t.ys)||(t.noYS=!0,t.ys=r.c2p(a.ys,!0))),a.xh!==void 0&&(t.xh=n.c2p(a.xh),t.xs=n.c2p(a.xs),g(t.xs)||(t.noXS=!0,t.xs=n.c2p(a.xs,!0))),t}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../color");ee.exports=function(M){M.each(function(e){var a=e[0].trace,n=a.error_y||{},r=a.error_x||{},t=A.select(this);t.selectAll("path.yerror").style("stroke-width",n.thickness+"px").call(g.stroke,n.color),r.copy_ystyle&&(r=n),t.selectAll("path.xerror").style("stroke-width",r.thickness+"px").call(g.stroke,r.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(y,ee,te){var A=y("../../plots/font_attributes"),g=y("./layout_attributes").hoverlabel,S=y("../../lib/extend").extendFlat;ee.exports={hoverlabel:{bgcolor:S({},g.bgcolor,{arrayOk:!0}),bordercolor:S({},g.bordercolor,{arrayOk:!0}),font:A({arrayOk:!0,editType:"none"}),align:S({},g.align,{arrayOk:!0}),namelength:S({},g.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(y,ee,te){var A=y("../../lib"),g=y("../../registry");ee.exports=function(e){var a=e.calcdata,n=e._fullLayout;function r(x){return function(p){return A.coerceHoverinfo({hoverinfo:p},{_module:x._module},n)}}for(var t=0;t<a.length;t++){var h=a[t],s=h[0].trace;if(!g.traceIs(s,"pie-like")){var i=g.traceIs(s,"2dMap")?S:A.fillArray;i(s.hoverinfo,h,"hi",r(s)),s.hovertemplate&&i(s.hovertemplate,h,"ht"),s.hoverlabel&&(i(s.hoverlabel.bgcolor,h,"hbg"),i(s.hoverlabel.bordercolor,h,"hbc"),i(s.hoverlabel.font.size,h,"hts"),i(s.hoverlabel.font.color,h,"htc"),i(s.hoverlabel.font.family,h,"htf"),i(s.hoverlabel.namelength,h,"hnl"),i(s.hoverlabel.align,h,"hta"))}}};function S(M,e,a,n){n=n||A.identity,Array.isArray(M)&&(e[0][a]=n(M))}},{"../../lib":515,"../../registry":647}],400:[function(y,ee,te){var A=y("../../registry"),g=y("./hover").hover;ee.exports=function(M,e,a){var n=A.getComponentMethod("annotations","onClick")(M,M._hoverdata);a!==void 0&&g(M,e,a,!0);function r(){M.emit("plotly_click",{points:M._hoverdata,event:e})}M._hoverdata&&e&&e.target&&(n&&n.then?n.then(r):r(),e.stopImmediatePropagation&&e.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(y,ee,te){ee.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("./hoverlabel_defaults");ee.exports=function(e,a,n,r){function t(s,i){return A.coerce(e,a,g,s,i)}var h=A.extendFlat({},r.hoverlabel);a.hovertemplate&&(h.namelength=-1),S(e,a,t,h)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(y,ee,te){var A=y("../../lib");te.getSubplot=function(n){return n.subplot||n.xaxis+n.yaxis||n.geo},te.isTraceInSubplots=function(n,r){if(n.type==="splom"){for(var t=n.xaxes||[],h=n.yaxes||[],s=0;s<t.length;s++)for(var i=0;i<h.length;i++)if(r.indexOf(t[s]+h[i])!==-1)return!0;return!1}return r.indexOf(te.getSubplot(n))!==-1},te.flat=function(n,r){for(var t=new Array(n.length),h=0;h<n.length;h++)t[h]=r;return t},te.p2c=function(n,r){for(var t=new Array(n.length),h=0;h<n.length;h++)t[h]=n[h].p2c(r);return t},te.getDistanceFunction=function(n,r,t,h){return n==="closest"?h||te.quadrature(r,t):n.charAt(0)==="x"?r:t},te.getClosest=function(n,r,t){if(t.index!==!1)t.index>=0&&t.index<n.length?t.distance=0:t.index=!1;else for(var h=0;h<n.length;h++){var s=r(n[h]);s<=t.distance&&(t.index=h,t.distance=s)}return t},te.inbox=function(n,r,t){return n*r<0||n===0?t:1/0},te.quadrature=function(n,r){return function(t){var h=n(t),s=r(t);return Math.sqrt(h*h+s*s)}},te.makeEventData=function(n,r,t){var h="index"in n?n.index:n.pointNumber,s={data:r._input,fullData:r,curveNumber:r.index,pointNumber:h};if(r._indexToPoints){var i=r._indexToPoints[h];i.length===1?s.pointIndex=i[0]:s.pointIndices=i}else s.pointIndex=h;return r._module.eventData?s=r._module.eventData(s,n,r,t,h):("xVal"in n?s.x=n.xVal:"x"in n&&(s.x=n.x),"yVal"in n?s.y=n.yVal:"y"in n&&(s.y=n.y),n.xa&&(s.xaxis=n.xa),n.ya&&(s.yaxis=n.ya),n.zLabelVal!==void 0&&(s.z=n.zLabelVal)),te.appendArrayPointValue(s,r,h),s},te.appendArrayPointValue=function(n,r,t){var h=r._arrayAttrs;if(h)for(var s=0;s<h.length;s++){var i=h[s],x=S(i);if(n[x]===void 0){var p=A.nestedProperty(r,i).get(),v=M(p,t);v!==void 0&&(n[x]=v)}}},te.appendArrayMultiPointValues=function(n,r,t){var h=r._arrayAttrs;if(h)for(var s=0;s<h.length;s++){var i=h[s],x=S(i);if(n[x]===void 0){for(var p=A.nestedProperty(r,i).get(),v=new Array(t.length),f=0;f<t.length;f++)v[f]=M(p,t[f]);n[x]=v}}};var g={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function S(n){return g[n]||n}function M(n,r){if(Array.isArray(r)){if(Array.isArray(n)&&Array.isArray(n[r[0]]))return n[r[0]][r[1]]}else return n[r]}var e={x:!0,y:!0},a={"x unified":!0,"y unified":!0};te.isUnifiedHover=function(n){return typeof n!="string"?!1:!!a[n]},te.isXYhover=function(n){return typeof n!="string"?!1:!!e[n]}},{"../../lib":515}],404:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("tinycolor2"),M=y("../../lib"),e=M.strTranslate,a=M.strRotate,n=y("../../lib/events"),r=y("../../lib/svg_text_utils"),t=y("../../lib/override_cursor"),h=y("../drawing"),s=y("../color"),i=y("../dragelement"),x=y("../../plots/cartesian/axes"),p=y("../../registry"),v=y("./helpers"),f=y("./constants"),d=y("../legend/defaults"),o=y("../legend/draw"),m=f.YANGLE,l=Math.PI*m/180,w=1/Math.sin(l),_=Math.cos(l),c=Math.sin(l),b=f.HOVERARROWSIZE,u=f.HOVERTEXTPAD,L={box:!0,ohlc:!0,violin:!0,candlestick:!0},T={scatter:!0,scattergl:!0,splom:!0};te.hover=function(U,$,ne,X){U=M.getGraphDiv(U);var Q=$.target;M.throttle(U._fullLayout._uid+f.HOVERID,f.HOVERMINTIME,function(){k(U,$,ne,X,Q)})},te.loneHover=function(U,$){var ne=!0;Array.isArray(U)||(ne=!1,U=[U]);var X=$.gd,Q=ue(X),ie=j(X),se=U.map(function(me){var Ee=me._x0||me.x0||me.x||0,Pe=me._x1||me.x1||me.x||0,Ue=me._y0||me.y0||me.y||0,we=me._y1||me.y1||me.y||0,ke=me.eventData;if(ke){var Xe=Math.min(Ee,Pe),Ve=Math.max(Ee,Pe),Ie=Math.min(Ue,we),De=Math.max(Ue,we),Ye=me.trace;if(p.traceIs(Ye,"gl3d")){var vt=X._fullLayout[Ye.scene]._scene.container,Dt=vt.offsetLeft,Kt=vt.offsetTop;Xe+=Dt,Ve+=Dt,Ie+=Kt,De+=Kt}ke.bbox={x0:Xe+ie,x1:Ve+ie,y0:Ie+Q,y1:De+Q},$.inOut_bbox&&$.inOut_bbox.push(ke.bbox)}else ke=!1;return{color:me.color||s.defaultLine,x0:me.x0||me.x||0,x1:me.x1||me.x||0,y0:me.y0||me.y||0,y1:me.y1||me.y||0,xLabel:me.xLabel,yLabel:me.yLabel,zLabel:me.zLabel,text:me.text,name:me.name,idealAlign:me.idealAlign,borderColor:me.borderColor,fontFamily:me.fontFamily,fontSize:me.fontSize,fontColor:me.fontColor,nameLength:me.nameLength,textAlign:me.textAlign,trace:me.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:me.hovertemplate||!1,hovertemplateLabels:me.hovertemplateLabels||!1,eventData:ke}}),ae=!1,oe=I(se,{gd:X,hovermode:"closest",rotateLabels:ae,bgColor:$.bgColor||s.background,container:A.select($.container),outerContainer:$.outerContainer||$.container}),be=5,ce=0,de=0;oe.sort(function(me,Ee){return me.y0-Ee.y0}).each(function(me,Ee){var Pe=me.y0-me.by/2;Pe-be<ce?me.offset=ce-Pe+be:me.offset=0,ce=Pe+me.by+me.offset,Ee===$.anchorIndex&&(de=me.offset)}).each(function(me){me.offset-=de});var ye=X._fullLayout._invScaleX,ge=X._fullLayout._invScaleY;return O(oe,ae,ye,ge),ne?oe:oe.node()};function k(H,U,$,ne,X){$||($="xy");var Q=Array.isArray($)?$:[$],ie=H._fullLayout,se=ie._plots||[],ae=se[$],oe=ie._has("cartesian");if(ae){var be=ae.overlays.map(function(or){return or.id});Q=Q.concat(be)}for(var ce=Q.length,de=new Array(ce),ye=new Array(ce),ge=!1,me=0;me<ce;me++){var Ee=Q[me];if(se[Ee])ge=!0,de[me]=se[Ee].xaxis,ye[me]=se[Ee].yaxis;else if(ie[Ee]&&ie[Ee]._subplot){var Pe=ie[Ee]._subplot;de[me]=Pe.xaxis,ye[me]=Pe.yaxis}else{M.warn("Unrecognized subplot: "+Ee);return}}var Ue=U.hovermode||ie.hovermode;if(Ue&&!ge&&(Ue="closest"),["x","y","closest","x unified","y unified"].indexOf(Ue)===-1||!H.calcdata||H.querySelector(".zoombox")||H._dragging)return i.unhoverRaw(H,U);var we=ie.hoverdistance;we===-1&&(we=1/0);var ke=ie.spikedistance;ke===-1&&(ke=1/0);var Xe=[],Ve=[],Ie,De,Ye,vt,Dt,Kt,Ft,Mt,Xt,It,At,Ge,tt,He={hLinePoint:null,vLinePoint:null},Ae=!1;if(Array.isArray(U))for(Ue="array",Ye=0;Ye<U.length;Ye++)Dt=H.calcdata[U[Ye].curveNumber||0],Dt&&(Kt=Dt[0].trace,Dt[0].trace.hoverinfo!=="skip"&&(Ve.push(Dt),Kt.orientation==="h"&&(Ae=!0)));else{for(vt=0;vt<H.calcdata.length;vt++)Dt=H.calcdata[vt],Kt=Dt[0].trace,Kt.hoverinfo!=="skip"&&v.isTraceInSubplots(Kt,Q)&&(Ve.push(Dt),Kt.orientation==="h"&&(Ae=!0));var Ne=!X,Ze,Qe;if(Ne)"xpx"in U?Ze=U.xpx:Ze=de[0]._length/2,"ypx"in U?Qe=U.ypx:Qe=ye[0]._length/2;else{if(n.triggerHandler(H,"plotly_beforehover",U)===!1)return;var bt=X.getBoundingClientRect();Ze=U.clientX-bt.left,Qe=U.clientY-bt.top,ie._calcInverseTransform(H);var dt=M.apply3DTransform(ie._invTransform)(Ze,Qe);if(Ze=dt[0],Qe=dt[1],Ze<0||Ze>de[0]._length||Qe<0||Qe>ye[0]._length)return i.unhoverRaw(H,U)}if(U.pointerX=Ze+de[0]._offset,U.pointerY=Qe+ye[0]._offset,"xval"in U?Ie=v.flat(Q,U.xval):Ie=v.p2c(de,Ze),"yval"in U?De=v.flat(Q,U.yval):De=v.p2c(ye,Qe),!g(Ie[0])||!g(De[0]))return M.warn("Fx.hover failed",U,H),i.unhoverRaw(H,U)}var wt=1/0;function Ut(or,Ir){for(vt=0;vt<Ve.length;vt++)if(Dt=Ve[vt],!(!Dt||!Dt[0]||!Dt[0].trace)&&(Kt=Dt[0].trace,!(Kt.visible!==!0||Kt._length===0)&&["carpet","contourcarpet"].indexOf(Kt._module.name)===-1)){if(Kt.type==="splom"?(Mt=0,Ft=Q[Mt]):(Ft=v.getSubplot(Kt),Mt=Q.indexOf(Ft)),Xt=Ue,v.isUnifiedHover(Xt)&&(Xt=Xt.charAt(0)),Ge={cd:Dt,trace:Kt,xa:de[Mt],ya:ye[Mt],maxHoverDistance:we,maxSpikeDistance:ke,index:!1,distance:Math.min(wt,we),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:s.defaultLine,name:Kt.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ie[Ft]&&(Ge.subplot=ie[Ft]._subplot),ie._splomScenes&&ie._splomScenes[Kt.uid]&&(Ge.scene=ie._splomScenes[Kt.uid]),tt=Xe.length,Xt==="array"){var Or=U[vt];"pointNumber"in Or?(Ge.index=Or.pointNumber,Xt="closest"):(Xt="","xval"in Or&&(It=Or.xval,Xt="x"),"yval"in Or&&(At=Or.yval,Xt=Xt?"closest":"y"))}else or!==void 0&&Ir!==void 0?(It=or,At=Ir):(It=Ie[Mt],At=De[Mt]);if(we!==0)if(Kt._module&&Kt._module.hoverPoints){var Er=Kt._module.hoverPoints(Ge,It,At,Xt,{finiteRange:!0,hoverLayer:ie._hoverlayer});if(Er)for(var wr,Gr=0;Gr<Er.length;Gr++)wr=Er[Gr],g(wr.x0)&&g(wr.y0)&&Xe.push(F(wr,Ue))}else M.log("Unrecognized trace type in hover:",Kt);if(Ue==="closest"&&Xe.length>tt&&(Xe.splice(0,tt),wt=Xe[0].distance),oe&&ke!==0&&Xe.length===0){Ge.distance=ke,Ge.index=!1;var wn=Kt._module.hoverPoints(Ge,It,At,"closest",{hoverLayer:ie._hoverlayer});if(wn&&(wn=wn.filter(function(pa){return pa.spikeDistance<=ke})),wn&&wn.length){var cn,Bn=wn.filter(function(pa){return pa.xa.showspikes&&pa.xa.spikesnap!=="hovered data"});if(Bn.length){var En=Bn[0];g(En.x0)&&g(En.y0)&&(cn=Nt(En),(!He.vLinePoint||He.vLinePoint.spikeDistance>cn.spikeDistance)&&(He.vLinePoint=cn))}var Yn=wn.filter(function(pa){return pa.ya.showspikes&&pa.ya.spikesnap!=="hovered data"});if(Yn.length){var Vn=Yn[0];g(Vn.x0)&&g(Vn.y0)&&(cn=Nt(Vn),(!He.hLinePoint||He.hLinePoint.spikeDistance>cn.spikeDistance)&&(He.hLinePoint=cn))}}}}}Ut();function Rt(or,Ir,Or){for(var Er=null,wr=1/0,Gr,wn=0;wn<or.length;wn++)Gr=or[wn].spikeDistance,Or&&wn===0&&(Gr=-1/0),Gr<=wr&&Gr<=Ir&&(Er=or[wn],wr=Gr);return Er}function Nt(or){return or?{xa:or.xa,ya:or.ya,x:or.xSpike!==void 0?or.xSpike:(or.x0+or.x1)/2,y:or.ySpike!==void 0?or.ySpike:(or.y0+or.y1)/2,distance:or.distance,spikeDistance:or.spikeDistance,curveNumber:or.trace.index,color:or.color,pointNumber:or.index}:null}var Wt={fullLayout:ie,container:ie._hoverlayer,event:U},Vt=H._spikepoints,ir={vLinePoint:He.vLinePoint,hLinePoint:He.hLinePoint};H._spikepoints=ir;var Hr=function(){Xe.sort(function(or,Ir){return or.distance-Ir.distance}),Xe=Y(Xe,Ue)};Hr();var sn=Ue.charAt(0),jr=(sn==="x"||sn==="y")&&Xe[0]&&T[Xe[0].trace.type];if(oe&&ke!==0&&Xe.length!==0){var at=Xe.filter(function(or){return or.ya.showspikes}),$t=Rt(at,ke,jr);He.hLinePoint=Nt($t);var Jt=Xe.filter(function(or){return or.xa.showspikes}),Gt=Rt(Jt,ke,jr);He.vLinePoint=Nt(Gt)}if(Xe.length===0){var _r=i.unhoverRaw(H,U);return oe&&(He.hLinePoint!==null||He.vLinePoint!==null)&&K(Vt)&&N(H,He,Wt),_r}if(oe&&K(Vt)&&N(H,He,Wt),v.isXYhover(Xt)&&Xe[0].length!==0&&Xe[0].trace.type!=="splom"){var rt=Xe[0];L[rt.trace.type]?Xe=Xe.filter(function(or){return or.trace.index===rt.trace.index}):Xe=[rt];var Je=Xe.length,st=re("x",rt,ie),lt=re("y",rt,ie);Ut(st,lt);var Tt=[],zt={},Ce=0,Se=function(or){var Ir=L[or.trace.type]?P(or):or.trace.index;if(!zt[Ir])Ce++,zt[Ir]=Ce,Tt.push(or);else{var Or=zt[Ir]-1,Er=Tt[Or];Or>0&&Math.abs(or.distance)<Math.abs(Er.distance)&&(Tt[Or]=or)}},nt;for(nt=0;nt<Je;nt++)Se(Xe[nt]);for(nt=Xe.length-1;nt>Je-1;nt--)Se(Xe[nt]);Xe=Tt,Hr()}var it=H._hoverdata,ct=[],kt=ue(H),gt=j(H);for(Ye=0;Ye<Xe.length;Ye++){var St=Xe[Ye],Yt=v.makeEventData(St,St.trace,St.cd);if(St.hovertemplate!==!1){var ar=!1;St.cd[St.index]&&St.cd[St.index].ht&&(ar=St.cd[St.index].ht),St.hovertemplate=ar||St.trace.hovertemplate||!1}if(St.xa&&St.ya){var kr=St.x0+St.xa._offset,br=St.x1+St.xa._offset,Mr=St.y0+St.ya._offset,Yr=St.y1+St.ya._offset,nr=Math.min(kr,br),gr=Math.max(kr,br),Rr=Math.min(Mr,Yr),Br=Math.max(Mr,Yr);Yt.bbox={x0:nr+gt,x1:gr+gt,y0:Rr+kt,y1:Br+kt}}St.eventData=[Yt],ct.push(Yt)}H._hoverdata=ct;var Sr=Ue==="y"&&(Ve.length>1||Xe.length>1)||Ue==="closest"&&Ae&&Xe.length>1,et=s.combine(ie.plot_bgcolor||s.background,ie.paper_bgcolor),Lt=I(Xe,{gd:H,hovermode:Ue,rotateLabels:Sr,bgColor:et,container:ie._hoverlayer,outerContainer:ie._paper.node(),commonLabelOpts:ie.hoverlabel,hoverdistance:ie.hoverdistance});if(v.isUnifiedHover(Ue)||(R(Lt,Sr?"xa":"ya",ie),O(Lt,Sr,ie._invScaleX,ie._invScaleY)),X&&X.tagName){var Zt=p.getComponentMethod("annotations","hasClickToShow")(H,ct);t(A.select(X),Zt?"pointer":"")}!X||ne||!G(H,U,it)||(it&&H.emit("plotly_unhover",{event:U,points:it}),H.emit("plotly_hover",{event:U,points:H._hoverdata,xaxes:de,yaxes:ye,xvals:Ie,yvals:De}))}function P(H){return[H.trace.index,H.index,H.x0,H.y0,H.name,H.attr,H.xa?H.xa._id:"",H.ya?H.ya._id:""].join(",")}var z=/<extra>([\s\S]*)<\/extra>/;function I(H,U){var $=U.gd,ne=$._fullLayout,X=U.hovermode,Q=U.rotateLabels,ie=U.bgColor,se=U.container,ae=U.outerContainer,oe=U.commonLabelOpts||{};if(H.length===0)return[[]];var be=U.fontFamily||f.HOVERFONT,ce=U.fontSize||f.HOVERFONTSIZE,de=H[0],ye=de.xa,ge=de.ya,me=X.charAt(0),Ee=de[me+"Label"],Pe=q($,ae),Ue=Pe.top,we=Pe.width,ke=Pe.height,Xe=Ee!==void 0&&de.distance<=U.hoverdistance&&(X==="x"||X==="y");if(Xe){var Ve=!0,Ie,De;for(Ie=0;Ie<H.length;Ie++)if(Ve&&H[Ie].zLabel===void 0&&(Ve=!1),De=H[Ie].hoverinfo||H[Ie].trace.hoverinfo,De){var Ye=Array.isArray(De)?De:De.split("+");if(Ye.indexOf("all")===-1&&Ye.indexOf(X)===-1){Xe=!1;break}}Ve&&(Xe=!1)}var vt=se.selectAll("g.axistext").data(Xe?[0]:[]);if(vt.enter().append("g").classed("axistext",!0),vt.exit().remove(),vt.each(function(){var Gt=A.select(this),_r=M.ensureSingle(Gt,"path","",function(Yr){Yr.style({"stroke-width":"1px"})}),rt=M.ensureSingle(Gt,"text","",function(Yr){Yr.attr("data-notex",1)}),Je=oe.bgcolor||s.defaultLine,st=oe.bordercolor||s.contrast(Je),lt=s.contrast(Je),Tt={family:oe.font.family||be,size:oe.font.size||ce,color:oe.font.color||lt};_r.style({fill:Je,stroke:st}),rt.text(Ee).call(h.font,Tt).call(r.positionText,0,0).call(r.convertToTspans,$),Gt.attr("transform","");var zt=q($,rt.node()),Ce,Se;if(X==="x"){var nt=ye.side==="top"?"-":"";rt.attr("text-anchor","middle").call(r.positionText,0,ye.side==="top"?Ue-zt.bottom-b-u:Ue-zt.top+b+u),Ce=ye._offset+(de.x0+de.x1)/2,Se=ge._offset+(ye.side==="top"?0:ge._length);var it=zt.width/2+u;Ce<it?(Ce=it,_r.attr("d","M-"+(it-b)+",0L-"+(it-b*2)+","+nt+b+"H"+(u+zt.width/2)+"v"+nt+(u*2+zt.height)+"H-"+it+"V"+nt+b+"Z")):Ce>ne.width-it?(Ce=ne.width-it,_r.attr("d","M"+(it-b)+",0L"+it+","+nt+b+"v"+nt+(u*2+zt.height)+"H-"+it+"V"+nt+b+"H"+(it-b*2)+"Z")):_r.attr("d","M0,0L"+b+","+nt+b+"H"+(u+zt.width/2)+"v"+nt+(u*2+zt.height)+"H-"+(u+zt.width/2)+"V"+nt+b+"H-"+b+"Z")}else{var ct,kt,gt;ge.side==="right"?(ct="start",kt=1,gt="",Ce=ye._offset+ye._length):(ct="end",kt=-1,gt="-",Ce=ye._offset),Se=ge._offset+(de.y0+de.y1)/2,rt.attr("text-anchor",ct),_r.attr("d","M0,0L"+gt+b+","+b+"V"+(u+zt.height/2)+"h"+gt+(u*2+zt.width)+"V-"+(u+zt.height/2)+"H"+gt+b+"V-"+b+"Z");var St=zt.height/2,Yt=Ue-zt.top-St,ar="clip"+ne._uid+"commonlabel"+ge._id,kr;if(Ce<zt.width+2*u+b){kr="M-"+(b+u)+"-"+St+"h-"+(zt.width-u)+"V"+St+"h"+(zt.width-u)+"Z";var br=zt.width-Ce+u;r.positionText(rt,br,Yt),ct==="end"&&rt.selectAll("tspan").each(function(){var Yr=A.select(this),nr=h.tester.append("text").text(Yr.text()).call(h.font,Tt),gr=q($,nr.node());Math.round(gr.width)<Math.round(zt.width)&&Yr.attr("x",br-gr.width),nr.remove()})}else r.positionText(rt,kt*(u+b),Yt),kr=null;var Mr=ne._topclips.selectAll("#"+ar).data(kr?[0]:[]);Mr.enter().append("clipPath").attr("id",ar).append("path"),Mr.exit().remove(),Mr.select("path").attr("d",kr),h.setClipUrl(rt,kr?ar:null,$)}Gt.attr("transform",e(Ce,Se))}),v.isUnifiedHover(X)){se.selectAll("g.hovertext").remove();var Dt=H.filter(function(Gt){return Gt.hoverinfo!=="none"});if(Dt.length===0)return;var Kt=ne.hoverlabel,Ft=Kt.font,Mt={showlegend:!0,legend:{title:{text:Ee,font:Ft},font:Ft,bgcolor:Kt.bgcolor,bordercolor:Kt.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:ne.legend?ne.legend.traceorder:void 0,orientation:"v"}},Xt={font:Ft};d(Mt,Xt,$._fullData);var It=Xt.legend;It.entries=[];for(var At=0;At<Dt.length;At++){var Ge=Dt[At];if(Ge.hoverinfo!=="none"){var tt=D(Ge,!0,X,ne,Ee),He=tt[0],Ae=tt[1];Ge.name=Ae,Ae!==""?Ge.text=Ae+" : "+He:Ge.text=He;var Ne=Ge.cd[Ge.index];Ne&&(Ne.mc&&(Ge.mc=Ne.mc),Ne.mcc&&(Ge.mc=Ne.mcc),Ne.mlc&&(Ge.mlc=Ne.mlc),Ne.mlcc&&(Ge.mlc=Ne.mlcc),Ne.mlw&&(Ge.mlw=Ne.mlw),Ne.mrc&&(Ge.mrc=Ne.mrc),Ne.dir&&(Ge.dir=Ne.dir)),Ge._distinct=!0,It.entries.push([Ge])}}It.entries.sort(function(Gt,_r){return Gt[0].trace.index-_r[0].trace.index}),It.layer=se,It._inHover=!0,It._groupTitleFont=Kt.grouptitlefont,o($,It);var Ze=se.select("g.legend"),Qe=q($,Ze.node()),bt=Qe.width+2*u,dt=Qe.height+2*u,wt=Dt[0],Ut=(wt.x0+wt.x1)/2,Rt=(wt.y0+wt.y1)/2,Nt=!(p.traceIs(wt.trace,"bar-like")||p.traceIs(wt.trace,"box-violin")),Wt,Vt;me==="y"?Nt?(Vt=Rt-u,Wt=Rt+u):(Vt=Math.min.apply(null,Dt.map(function(Gt){return Math.min(Gt.y0,Gt.y1)})),Wt=Math.max.apply(null,Dt.map(function(Gt){return Math.max(Gt.y0,Gt.y1)}))):Vt=Wt=M.mean(Dt.map(function(Gt){return(Gt.y0+Gt.y1)/2}))-dt/2;var ir,Hr;me==="x"?Nt?(ir=Ut+u,Hr=Ut-u):(ir=Math.max.apply(null,Dt.map(function(Gt){return Math.max(Gt.x0,Gt.x1)})),Hr=Math.min.apply(null,Dt.map(function(Gt){return Math.min(Gt.x0,Gt.x1)}))):ir=Hr=M.mean(Dt.map(function(Gt){return(Gt.x0+Gt.x1)/2}))-bt/2;var sn=ye._offset,jr=ge._offset;Wt+=jr,ir+=sn,Hr+=sn-bt,Vt+=jr-dt;var at,$t;return ir+bt<we&&ir>=0?at=ir:Hr+bt<we&&Hr>=0?at=Hr:sn+bt<we?at=sn:ir-Ut<Ut-Hr+bt?at=we-bt:at=0,at+=u,Wt+dt<ke&&Wt>=0?$t=Wt:Vt+dt<ke&&Vt>=0?$t=Vt:jr+dt<ke?$t=jr:Wt-Rt<Rt-Vt+dt?$t=ke-dt:$t=0,$t+=u,Ze.attr("transform",e(at-1,$t-1)),Ze}var Jt=se.selectAll("g.hovertext").data(H,function(Gt){return P(Gt)});return Jt.enter().append("g").classed("hovertext",!0).each(function(){var Gt=A.select(this);Gt.append("rect").call(s.fill,s.addOpacity(ie,.8)),Gt.append("text").classed("name",!0),Gt.append("path").style("stroke-width","1px"),Gt.append("text").classed("nums",!0).call(h.font,be,ce)}),Jt.exit().remove(),Jt.each(function(Gt){var _r=A.select(this).attr("transform",""),rt=Gt.color;Array.isArray(rt)&&(rt=rt[Gt.eventData[0].pointNumber]);var Je=Gt.bgcolor||rt,st=s.combine(s.opacity(Je)?Je:s.defaultLine,ie),lt=s.combine(s.opacity(rt)?rt:s.defaultLine,ie),Tt=Gt.borderColor||s.contrast(st),zt=D(Gt,Xe,X,ne,Ee,_r),Ce=zt[0],Se=zt[1],nt=_r.select("text.nums").call(h.font,Gt.fontFamily||be,Gt.fontSize||ce,Gt.fontColor||Tt).text(Ce).attr("data-notex",1).call(r.positionText,0,0).call(r.convertToTspans,$),it=_r.select("text.name"),ct=0,kt=0;if(Se&&Se!==Ce){it.call(h.font,Gt.fontFamily||be,Gt.fontSize||ce,lt).text(Se).attr("data-notex",1).call(r.positionText,0,0).call(r.convertToTspans,$);var gt=q($,it.node());ct=gt.width+2*u,kt=gt.height+2*u}else it.remove(),_r.select("rect").remove();_r.select("path").style({fill:st,stroke:Tt});var St=Gt.xa._offset+(Gt.x0+Gt.x1)/2,Yt=Gt.ya._offset+(Gt.y0+Gt.y1)/2,ar=Math.abs(Gt.x1-Gt.x0),kr=Math.abs(Gt.y1-Gt.y0),br=q($,nt.node()),Mr=br.width/ne._invScaleX,Yr=br.height/ne._invScaleY;Gt.ty0=(Ue-br.top)/ne._invScaleY,Gt.bx=Mr+2*u,Gt.by=Math.max(Yr+2*u,kt),Gt.anchor="start",Gt.txwidth=Mr,Gt.tx2width=ct,Gt.offset=0;var nr=(Mr+b+u+ct)*ne._invScaleX,gr,Rr;if(Q)Gt.pos=St,gr=Yt+kr/2+nr<=ke,Rr=Yt-kr/2-nr>=0,(Gt.idealAlign==="top"||!gr)&&Rr?(Yt-=kr/2,Gt.anchor="end"):gr?(Yt+=kr/2,Gt.anchor="start"):Gt.anchor="middle";else if(Gt.pos=Yt,gr=St+ar/2+nr<=we,Rr=St-ar/2-nr>=0,(Gt.idealAlign==="left"||!gr)&&Rr)St-=ar/2,Gt.anchor="end";else if(gr)St+=ar/2,Gt.anchor="start";else{Gt.anchor="middle";var Br=nr/2,Sr=St+Br-we,et=St-Br;Sr>0&&(St-=Sr),et<0&&(St+=-et)}nt.attr("text-anchor",Gt.anchor),ct&&it.attr("text-anchor",Gt.anchor),_r.attr("transform",e(St,Yt)+(Q?a(m):""))}),Jt}function D(H,U,$,ne,X,Q){var ie="",se="";H.nameOverride!==void 0&&(H.name=H.nameOverride),H.name&&(H.trace._meta&&(H.name=M.templateString(H.name,H.trace._meta)),ie=W(H.name,H.nameLength));var ae=$.charAt(0),oe=ae==="x"?"y":"x";H.zLabel!==void 0?(H.xLabel!==void 0&&(se+="x: "+H.xLabel+"<br>"),H.yLabel!==void 0&&(se+="y: "+H.yLabel+"<br>"),H.trace.type!=="choropleth"&&H.trace.type!=="choroplethmapbox"&&(se+=(se?"z: ":"")+H.zLabel)):U&&H[ae+"Label"]===X?se=H[oe+"Label"]||"":H.xLabel===void 0?H.yLabel!==void 0&&H.trace.type!=="scattercarpet"&&(se=H.yLabel):H.yLabel===void 0?se=H.xLabel:se="("+H.xLabel+", "+H.yLabel+")",(H.text||H.text===0)&&!Array.isArray(H.text)&&(se+=(se?"<br>":"")+H.text),H.extraText!==void 0&&(se+=(se?"<br>":"")+H.extraText),Q&&se===""&&!H.hovertemplate&&(ie===""&&Q.remove(),se=ie);var be=H.hovertemplate||!1;if(be){var ce=H.hovertemplateLabels||H;H[ae+"Label"]!==X&&(ce[ae+"other"]=ce[ae+"Val"],ce[ae+"otherLabel"]=ce[ae+"Label"]),se=M.hovertemplateString(be,ce,ne._d3locale,H.eventData[0]||{},H.trace._meta),se=se.replace(z,function(de,ye){return ie=W(ye,H.nameLength),""})}return[se,ie]}function R(H,U,$){var ne=0,X=1,Q=H.size(),ie=new Array(Q),se=0;H.each(function(Ie){var De=Ie[U],Ye=De._id.charAt(0)==="x",vt=De.range;se===0&&vt&&vt[0]>vt[1]!==Ye&&(X=-1),ie[se++]=[{datum:Ie,traceIndex:Ie.trace.index,dp:0,pos:Ie.pos,posref:Ie.posref,size:Ie.by*(Ye?w:1)/2,pmin:0,pmax:Ye?$.width:$.height}]}),ie.sort(function(Ie,De){return Ie[0].posref-De[0].posref||X*(De[0].traceIndex-Ie[0].traceIndex)});var ae,oe,be,ce,de,ye,ge;function me(Ie){var De=Ie[0],Ye=Ie[Ie.length-1];if(oe=De.pmin-De.pos-De.dp+De.size,be=Ye.pos+Ye.dp+Ye.size-De.pmax,oe>.01){for(de=Ie.length-1;de>=0;de--)Ie[de].dp+=oe;ae=!1}if(!(be<.01)){if(oe<-.01){for(de=Ie.length-1;de>=0;de--)Ie[de].dp-=be;ae=!1}if(ae){var vt=0;for(ce=0;ce<Ie.length;ce++)ye=Ie[ce],ye.pos+ye.dp+ye.size>De.pmax&&vt++;for(ce=Ie.length-1;ce>=0&&!(vt<=0);ce--)ye=Ie[ce],ye.pos>De.pmax-1&&(ye.del=!0,vt--);for(ce=0;ce<Ie.length&&!(vt<=0);ce++)if(ye=Ie[ce],ye.pos<De.pmin+1)for(ye.del=!0,vt--,be=ye.size*2,de=Ie.length-1;de>=0;de--)Ie[de].dp-=be;for(ce=Ie.length-1;ce>=0&&!(vt<=0);ce--)ye=Ie[ce],ye.pos+ye.dp+ye.size>De.pmax&&(ye.del=!0,vt--)}}}for(;!ae&&ne<=Q;){for(ne++,ae=!0,ce=0;ce<ie.length-1;){var Ee=ie[ce],Pe=ie[ce+1],Ue=Ee[Ee.length-1],we=Pe[0];if(oe=Ue.pos+Ue.dp+Ue.size-we.pos-we.dp+we.size,oe>.01&&Ue.pmin===we.pmin&&Ue.pmax===we.pmax){for(de=Pe.length-1;de>=0;de--)Pe[de].dp+=oe;for(Ee.push.apply(Ee,Pe),ie.splice(ce+1,1),ge=0,de=Ee.length-1;de>=0;de--)ge+=Ee[de].dp;for(be=ge/Ee.length,de=Ee.length-1;de>=0;de--)Ee[de].dp-=be;ae=!1}else ce++}ie.forEach(me)}for(ce=ie.length-1;ce>=0;ce--){var ke=ie[ce];for(de=ke.length-1;de>=0;de--){var Xe=ke[de],Ve=Xe.datum;Ve.offset=Xe.dp,Ve.del=Xe.del}}}function O(H,U,$,ne){var X=function(ie){return ie*$},Q=function(ie){return ie*ne};H.each(function(ie){var se=A.select(this);if(ie.del)return se.remove();var ae=se.select("text.nums"),oe=ie.anchor,be=oe==="end"?-1:1,ce={start:1,end:-1,middle:0}[oe],de=ce*(b+u),ye=de+ce*(ie.txwidth+u),ge=0,me=ie.offset,Ee=oe==="middle";Ee&&(de-=ie.tx2width/2,ye+=ie.txwidth/2+u),U&&(me*=-c,ge=ie.offset*_),se.select("path").attr("d",Ee?"M-"+X(ie.bx/2+ie.tx2width/2)+","+Q(me-ie.by/2)+"h"+X(ie.bx)+"v"+Q(ie.by)+"h-"+X(ie.bx)+"Z":"M0,0L"+X(be*b+ge)+","+Q(b+me)+"v"+Q(ie.by/2-b)+"h"+X(be*ie.bx)+"v-"+Q(ie.by)+"H"+X(be*b+ge)+"V"+Q(me-b)+"Z");var Pe=ge+de,Ue=me+ie.ty0-ie.by/2+u,we=ie.textAlign||"auto";we!=="auto"&&(we==="left"&&oe!=="start"?(ae.attr("text-anchor","start"),Pe=Ee?-ie.bx/2-ie.tx2width/2+u:-ie.bx-u):we==="right"&&oe!=="end"&&(ae.attr("text-anchor","end"),Pe=Ee?ie.bx/2-ie.tx2width/2-u:ie.bx+u)),ae.call(r.positionText,X(Pe),Q(Ue)),ie.tx2width&&(se.select("text.name").call(r.positionText,X(ye+ce*u+ge),Q(me+ie.ty0-ie.by/2+u)),se.select("rect").call(h.setRect,X(ye+(ce-1)*ie.tx2width/2+ge),Q(me-ie.by/2-1),X(ie.tx2width),Q(ie.by+2)))})}function F(H,U){var $=H.index,ne=H.trace||{},X=H.cd[0],Q=H.cd[$]||{};function ie(de){return de||g(de)&&de===0}var se=Array.isArray($)?function(de,ye){var ge=M.castOption(X,$,de);return ie(ge)?ge:M.extractOption({},ne,"",ye)}:function(de,ye){return M.extractOption(Q,ne,de,ye)};function ae(de,ye,ge){var me=se(ye,ge);ie(me)&&(H[de]=me)}if(ae("hoverinfo","hi","hoverinfo"),ae("bgcolor","hbg","hoverlabel.bgcolor"),ae("borderColor","hbc","hoverlabel.bordercolor"),ae("fontFamily","htf","hoverlabel.font.family"),ae("fontSize","hts","hoverlabel.font.size"),ae("fontColor","htc","hoverlabel.font.color"),ae("nameLength","hnl","hoverlabel.namelength"),ae("textAlign","hta","hoverlabel.align"),H.posref=U==="y"||U==="closest"&&ne.orientation==="h"?H.xa._offset+(H.x0+H.x1)/2:H.ya._offset+(H.y0+H.y1)/2,H.x0=M.constrain(H.x0,0,H.xa._length),H.x1=M.constrain(H.x1,0,H.xa._length),H.y0=M.constrain(H.y0,0,H.ya._length),H.y1=M.constrain(H.y1,0,H.ya._length),H.xLabelVal!==void 0&&(H.xLabel="xLabel"in H?H.xLabel:x.hoverLabelText(H.xa,H.xLabelVal,ne.xhoverformat),H.xVal=H.xa.c2d(H.xLabelVal)),H.yLabelVal!==void 0&&(H.yLabel="yLabel"in H?H.yLabel:x.hoverLabelText(H.ya,H.yLabelVal,ne.yhoverformat),H.yVal=H.ya.c2d(H.yLabelVal)),H.zLabelVal!==void 0&&H.zLabel===void 0&&(H.zLabel=String(H.zLabelVal)),!isNaN(H.xerr)&&!(H.xa.type==="log"&&H.xerr<=0)){var oe=x.tickText(H.xa,H.xa.c2l(H.xerr),"hover").text;H.xerrneg!==void 0?H.xLabel+=" +"+oe+" / -"+x.tickText(H.xa,H.xa.c2l(H.xerrneg),"hover").text:H.xLabel+="  "+oe,U==="x"&&(H.distance+=1)}if(!isNaN(H.yerr)&&!(H.ya.type==="log"&&H.yerr<=0)){var be=x.tickText(H.ya,H.ya.c2l(H.yerr),"hover").text;H.yerrneg!==void 0?H.yLabel+=" +"+be+" / -"+x.tickText(H.ya,H.ya.c2l(H.yerrneg),"hover").text:H.yLabel+="  "+be,U==="y"&&(H.distance+=1)}var ce=H.hoverinfo||H.trace.hoverinfo;return ce&&ce!=="all"&&(ce=Array.isArray(ce)?ce:ce.split("+"),ce.indexOf("x")===-1&&(H.xLabel=void 0),ce.indexOf("y")===-1&&(H.yLabel=void 0),ce.indexOf("z")===-1&&(H.zLabel=void 0),ce.indexOf("text")===-1&&(H.text=void 0),ce.indexOf("name")===-1&&(H.name=void 0)),H}function N(H,U,$){var ne=$.container,X=$.fullLayout,Q=X._size,ie=$.event,se=!!U.hLinePoint,ae=!!U.vLinePoint,oe,be;if(ne.selectAll(".spikeline").remove(),!!(ae||se)){var ce=s.combine(X.plot_bgcolor,X.paper_bgcolor);if(se){var de=U.hLinePoint,ye,ge;oe=de&&de.xa,be=de&&de.ya;var me=be.spikesnap;me==="cursor"?(ye=ie.pointerX,ge=ie.pointerY):(ye=oe._offset+de.x,ge=be._offset+de.y);var Ee=S.readability(de.color,ce)<1.5?s.contrast(ce):de.color,Pe=be.spikemode,Ue=be.spikethickness,we=be.spikecolor||Ee,ke=x.getPxPosition(H,be),Xe,Ve;if(Pe.indexOf("toaxis")!==-1||Pe.indexOf("across")!==-1){if(Pe.indexOf("toaxis")!==-1&&(Xe=ke,Ve=ye),Pe.indexOf("across")!==-1){var Ie=be._counterDomainMin,De=be._counterDomainMax;be.anchor==="free"&&(Ie=Math.min(Ie,be.position),De=Math.max(De,be.position)),Xe=Q.l+Ie*Q.w,Ve=Q.l+De*Q.w}ne.insert("line",":first-child").attr({x1:Xe,x2:Ve,y1:ge,y2:ge,"stroke-width":Ue,stroke:we,"stroke-dasharray":h.dashStyle(be.spikedash,Ue)}).classed("spikeline",!0).classed("crisp",!0),ne.insert("line",":first-child").attr({x1:Xe,x2:Ve,y1:ge,y2:ge,"stroke-width":Ue+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}Pe.indexOf("marker")!==-1&&ne.insert("circle",":first-child").attr({cx:ke+(be.side!=="right"?Ue:-Ue),cy:ge,r:Ue,fill:we}).classed("spikeline",!0)}if(ae){var Ye=U.vLinePoint,vt,Dt;oe=Ye&&Ye.xa,be=Ye&&Ye.ya;var Kt=oe.spikesnap;Kt==="cursor"?(vt=ie.pointerX,Dt=ie.pointerY):(vt=oe._offset+Ye.x,Dt=be._offset+Ye.y);var Ft=S.readability(Ye.color,ce)<1.5?s.contrast(ce):Ye.color,Mt=oe.spikemode,Xt=oe.spikethickness,It=oe.spikecolor||Ft,At=x.getPxPosition(H,oe),Ge,tt;if(Mt.indexOf("toaxis")!==-1||Mt.indexOf("across")!==-1){if(Mt.indexOf("toaxis")!==-1&&(Ge=At,tt=Dt),Mt.indexOf("across")!==-1){var He=oe._counterDomainMin,Ae=oe._counterDomainMax;oe.anchor==="free"&&(He=Math.min(He,oe.position),Ae=Math.max(Ae,oe.position)),Ge=Q.t+(1-Ae)*Q.h,tt=Q.t+(1-He)*Q.h}ne.insert("line",":first-child").attr({x1:vt,x2:vt,y1:Ge,y2:tt,"stroke-width":Xt,stroke:It,"stroke-dasharray":h.dashStyle(oe.spikedash,Xt)}).classed("spikeline",!0).classed("crisp",!0),ne.insert("line",":first-child").attr({x1:vt,x2:vt,y1:Ge,y2:tt,"stroke-width":Xt+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}Mt.indexOf("marker")!==-1&&ne.insert("circle",":first-child").attr({cx:vt,cy:At-(oe.side!=="top"?Xt:-Xt),r:Xt,fill:It}).classed("spikeline",!0)}}}function G(H,U,$){if(!$||$.length!==H._hoverdata.length)return!0;for(var ne=$.length-1;ne>=0;ne--){var X=$[ne],Q=H._hoverdata[ne];if(X.curveNumber!==Q.curveNumber||String(X.pointNumber)!==String(Q.pointNumber)||String(X.pointNumbers)!==String(Q.pointNumbers))return!0}return!1}function K(H,U){return!U||U.vLinePoint!==H._spikepoints.vLinePoint||U.hLinePoint!==H._spikepoints.hLinePoint}function W(H,U){return r.plainText(H||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function Y(H,U){for(var $=U.charAt(0),ne=[],X=[],Q=[],ie=0;ie<H.length;ie++){var se=H[ie];p.traceIs(se.trace,"bar-like")||p.traceIs(se.trace,"box-violin")?Q.push(se):se.trace[$+"period"]?X.push(se):ne.push(se)}return ne.concat(X).concat(Q)}function re(H,U,$){var ne=U[H+"a"],X=U[H+"Val"],Q=U.cd[0];if(ne.type==="category")X=ne._categoriesMap[X];else if(ne.type==="date"){var ie=U.trace[H+"periodalignment"];if(ie){var se=U.cd[U.index],ae=se[H+"Start"];ae===void 0&&(ae=se[H]);var oe=se[H+"End"];oe===void 0&&(oe=se[H]);var be=oe-ae;ie==="end"?X+=be:ie==="middle"&&(X+=be/2)}X=ne.d2c(X)}return Q&&Q.t&&Q.t.posLetter===ne._id&&($.boxmode==="group"||$.violinmode==="group")&&(X+=Q.t.dPos),X}function ue(H){return H.offsetTop+H.clientTop}function j(H){return H.offsetLeft+H.clientLeft}function q(H,U){var $=H._fullLayout,ne=U.getBoundingClientRect(),X=ne.x,Q=ne.y,ie=X+ne.width,se=Q+ne.height,ae=M.apply3DTransform($._invTransform)(X,Q),oe=M.apply3DTransform($._invTransform)(ie,se),be=ae[0],ce=ae[1],de=oe[0],ye=oe[1];return{x:be,y:ce,width:de-be,height:ye-ce,top:Math.min(ce,ye),left:Math.min(be,de),right:Math.max(be,de),bottom:Math.max(ce,ye)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(y,ee,te){var A=y("../../lib"),g=y("../color"),S=y("./helpers").isUnifiedHover;ee.exports=function(e,a,n,r){r=r||{};var t=a.legend;function h(s){r.font[s]||(r.font[s]=t?a.legend.font[s]:a.font[s])}a&&S(a.hovermode)&&(r.font||(r.font={}),h("size"),h("family"),h("color"),t?(r.bgcolor||(r.bgcolor=g.combine(a.legend.bgcolor,a.paper_bgcolor)),r.bordercolor||(r.bordercolor=a.legend.bordercolor)):r.bgcolor||(r.bgcolor=a.paper_bgcolor)),n("hoverlabel.bgcolor",r.bgcolor),n("hoverlabel.bordercolor",r.bordercolor),n("hoverlabel.namelength",r.namelength),A.coerceFont(n,"hoverlabel.font",r.font),n("hoverlabel.align",r.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(M,e){function a(n,r){return e[n]!==void 0?e[n]:A.coerce(M,e,g,n,r)}return a("clickmode"),a("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../dragelement"),M=y("./helpers"),e=y("./layout_attributes"),a=y("./hover");ee.exports={moduleType:"component",name:"fx",constants:y("./constants"),schema:{layout:e},attributes:y("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:y("./layout_global_defaults"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),getDistanceFunction:M.getDistanceFunction,getClosest:M.getClosest,inbox:M.inbox,quadrature:M.quadrature,appendArrayPointValue:M.appendArrayPointValue,castHoverOption:r,castHoverinfo:t,hover:a.hover,unhover:S.unhover,loneHover:a.loneHover,loneUnhover:n,click:y("./click")};function n(h){var s=g.isD3Selection(h)?h:A.select(h);s.selectAll("g.hovertext").remove(),s.selectAll(".spikeline").remove()}function r(h,s,i){return g.castOption(h,s,"hoverlabel."+i)}function t(h,s,i){function x(p){return g.coerceHoverinfo({hoverinfo:p},{_module:h._module},s)}return g.castOption(h,i,"hoverinfo",x)}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(y,ee,te){var A=y("./constants"),g=y("../../plots/font_attributes"),S=g({editType:"none"});S.family.dflt=A.HOVERFONT,S.size.dflt=A.HOVERFONTSIZE,ee.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:S,grouptitlefont:g({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes"),S=y("./hovermode_defaults"),M=y("./hoverlabel_defaults");ee.exports=function(a,n){function r(p,v){return A.coerce(a,n,g,p,v)}var t=S(a,n);t&&(r("hoverdistance"),r("spikedistance"));var h=r("dragmode");h==="select"&&r("selectdirection");var s=n._has("mapbox"),i=n._has("geo"),x=n._basePlotModules.length;n.dragmode==="zoom"&&((s||i)&&x===1||s&&i&&x===2)&&(n.dragmode="pan"),M(a,n,r),A.coerceFont(r,"hoverlabel.grouptitlefont",n.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(y,ee,te){var A=y("../../lib"),g=y("./hoverlabel_defaults"),S=y("./layout_attributes");ee.exports=function(e,a){function n(r,t){return A.coerce(e,a,S,r,t)}g(e,a,n)}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(y,ee,te){var A=y("../../lib"),g=y("../../lib/regex").counter,S=y("../../plots/domain").attributes,M=y("../../plots/cartesian/constants").idRegex,e=y("../../plot_api/plot_template"),a={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[g("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[M.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[M.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:S({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function n(i,x,p){var v=x[p+"axes"],f=Object.keys((i._splomAxes||{})[p]||{});if(Array.isArray(v))return v;if(f.length)return f}function r(i,x){var p=i.grid||{},v=n(x,p,"x"),f=n(x,p,"y");if(!i.grid&&!v&&!f)return;var d=Array.isArray(p.subplots)&&Array.isArray(p.subplots[0]),o=Array.isArray(v),m=Array.isArray(f),l=o&&v!==p.xaxes&&m&&f!==p.yaxes,w,_;d?(w=p.subplots.length,_=p.subplots[0].length):(m&&(w=f.length),o&&(_=v.length));var c=e.newContainer(x,"grid");function b(O,F){return A.coerce(p,c,a,O,F)}var u=b("rows",w),L=b("columns",_);if(!(u*L>1)){delete x.grid;return}if(!d&&!o&&!m){var T=b("pattern")==="independent";T&&(d=!0)}c._hasSubplotGrid=d;var k=b("roworder"),P=k==="top to bottom",z=d?.2:.1,I=d?.3:.1,D,R;l&&x._splomGridDflt&&(D=x._splomGridDflt.xside,R=x._splomGridDflt.yside),c._domains={x:t("x",b,z,D,L),y:t("y",b,I,R,u,P)}}function t(i,x,p,v,f,d){var o=x(i+"gap",p),m=x("domain."+i);x(i+"side",v);for(var l=new Array(f),w=m[0],_=(m[1]-w)/(f-o),c=_*(1-o),b=0;b<f;b++){var u=w+_*b;l[d?f-1-b:b]=[u,u+c]}return l}function h(i,x){var p=x.grid;if(!(!p||!p._domains)){var v=i.grid||{},f=x._subplots,d=p._hasSubplotGrid,o=p.rows,m=p.columns,l=p.pattern==="independent",w,_,c,b,u,L,T,k=p._axisMap={};if(d){var P=v.subplots||[];L=p.subplots=new Array(o);var z=1;for(w=0;w<o;w++){var I=L[w]=new Array(m),D=P[w]||[];for(_=0;_<m;_++)if(l?(u=z===1?"xy":"x"+z+"y"+z,z++):u=D[_],I[_]="",f.cartesian.indexOf(u)!==-1){if(T=u.indexOf("y"),c=u.slice(0,T),b=u.slice(T),k[c]!==void 0&&k[c]!==_||k[b]!==void 0&&k[b]!==w)continue;I[_]=u,k[c]=_,k[b]=w}}}else{var R=n(x,v,"x"),O=n(x,v,"y");p.xaxes=s(R,f.xaxis,m,k,"x"),p.yaxes=s(O,f.yaxis,o,k,"y")}var F=p._anchors={},N=p.roworder==="top to bottom";for(var G in k){var K=G.charAt(0),W=p[K+"side"],Y,re,ue;if(W.length<8)F[G]="free";else if(K==="x"){if(W.charAt(0)==="t"===N?(Y=0,re=1,ue=o):(Y=o-1,re=-1,ue=-1),d){var j=k[G];for(w=Y;w!==ue;w+=re)if(u=L[w][j],!!u&&(T=u.indexOf("y"),u.slice(0,T)===G)){F[G]=u.slice(T);break}}else for(w=Y;w!==ue;w+=re)if(b=p.yaxes[w],f.cartesian.indexOf(G+b)!==-1){F[G]=b;break}}else if(W.charAt(0)==="l"?(Y=0,re=1,ue=m):(Y=m-1,re=-1,ue=-1),d){var q=k[G];for(w=Y;w!==ue;w+=re)if(u=L[q][w],!!u&&(T=u.indexOf("y"),u.slice(T)===G)){F[G]=u.slice(0,T);break}}else for(w=Y;w!==ue;w+=re)if(c=p.xaxes[w],f.cartesian.indexOf(c+G)!==-1){F[G]=c;break}}}}function s(i,x,p,v,f){var d=new Array(p),o;function m(l,w){x.indexOf(w)!==-1&&v[w]===void 0?(d[l]=w,v[w]=l):d[l]=""}if(Array.isArray(i))for(o=0;o<p;o++)m(o,i[o]);else for(m(0,f),o=1;o<p;o++)m(o,f+(o+1));return d}ee.exports={moduleType:"component",name:"grid",schema:{layout:{grid:a}},layoutAttributes:a,sizeDefaults:r,contentDefaults:h}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(y,ee,te){var A=y("../../plots/cartesian/constants"),g=y("../../plot_api/plot_template").templatedArray;y("../../constants/axis_placeable_objects"),ee.exports=g("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",A.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",A.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib/to_log_range");ee.exports=function(M,e,a,n){e=e||{};var r=a==="log"&&e.type==="linear",t=a==="linear"&&e.type==="log";if(r||t){for(var h=M._fullLayout.images,s=e._id.charAt(0),i,x,p=0;p<h.length;p++)if(i=h[p],x="images["+p+"].",i[s+"ref"]===e._id){var v=i[s],f=i["size"+s],d=null,o=null;if(r){d=g(v,e.range);var m=f/Math.pow(10,d)/2;o=2*Math.log(m+Math.sqrt(1+m*m))/Math.LN10}else d=Math.pow(10,v),o=d*(Math.pow(10,f/2)-Math.pow(10,-f/2));A(d)?A(o)||(o=null):(d=null,o=null),n(x+s,d),n(x+"size"+s,o)}}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("../../plots/array_container_defaults"),M=y("./attributes"),e="images";ee.exports=function(r,t){var h={name:e,handleItemDefaults:a};S(r,t,h)};function a(n,r,t){function h(m,l){return A.coerce(n,r,M,m,l)}var s=h("source"),i=h("visible",!!s);if(!i)return r;h("layer"),h("xanchor"),h("yanchor"),h("sizex"),h("sizey"),h("sizing"),h("opacity");for(var x={_fullLayout:t},p=["x","y"],v=0;v<2;v++){var f=p[v],d=g.coerceRef(n,r,x,f,"paper",void 0);if(d!=="paper"){var o=g.getFromId(x,d);o._imgIndices.push(r._index)}g.coercePosition(r,x,h,d,f,0)}return r}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../drawing"),S=y("../../plots/cartesian/axes"),M=y("../../plots/cartesian/axis_ids"),e=y("../../constants/xmlns_namespaces");ee.exports=function(n){var r=n._fullLayout,t=[],h={},s=[],i,x;for(x=0;x<r.images.length;x++){var p=r.images[x];if(p.visible)if(p.layer==="below"&&p.xref!=="paper"&&p.yref!=="paper"){i=M.ref2id(p.xref)+M.ref2id(p.yref);var v=r._plots[i];if(!v){s.push(p);continue}v.mainplot&&(i=v.mainplot.id),h[i]||(h[i]=[]),h[i].push(p)}else p.layer==="above"?t.push(p):s.push(p)}var f={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function d(b){var u=A.select(this);if(this._imgSrc!==b.source)if(u.attr("xmlns",e.svg),b.source&&b.source.slice(0,5)==="data:")u.attr("xlink:href",b.source),this._imgSrc=b.source;else{var L=new Promise(function(T){var k=new Image;this.img=k,k.setAttribute("crossOrigin","anonymous"),k.onerror=P,k.onload=function(){var z=document.createElement("canvas");z.width=this.width,z.height=this.height;var I=z.getContext("2d",{willReadFrequently:!0});I.drawImage(this,0,0);var D=z.toDataURL("image/png");u.attr("xlink:href",D),T()},u.on("error",P),k.src=b.source,this._imgSrc=b.source;function P(){u.remove(),T()}}.bind(this));n._promises.push(L)}}function o(b){var u=A.select(this),L=S.getFromId(n,b.xref),T=S.getFromId(n,b.yref),k=S.getRefType(b.xref)==="domain",P=S.getRefType(b.yref)==="domain",z=r._size,I,D;L!==void 0?I=typeof b.xref=="string"&&k?L._length*b.sizex:Math.abs(L.l2p(b.sizex)-L.l2p(0)):I=b.sizex*z.w,T!==void 0?D=typeof b.yref=="string"&&P?T._length*b.sizey:Math.abs(T.l2p(b.sizey)-T.l2p(0)):D=b.sizey*z.h;var R=I*f.x[b.xanchor].offset,O=D*f.y[b.yanchor].offset,F=f.x[b.xanchor].sizing+f.y[b.yanchor].sizing,N,G;switch(L!==void 0?N=typeof b.xref=="string"&&k?L._length*b.x+L._offset:L.r2p(b.x)+L._offset:N=b.x*z.w+z.l,N+=R,T!==void 0?G=typeof b.yref=="string"&&P?T._length*(1-b.y)+T._offset:T.r2p(b.y)+T._offset:G=z.h-b.y*z.h+z.t,G+=O,b.sizing){case"fill":F+=" slice";break;case"stretch":F="none";break}u.attr({x:N,y:G,width:I,height:D,preserveAspectRatio:F,opacity:b.opacity});var K=L&&S.getRefType(b.xref)!=="domain"?L._id:"",W=T&&S.getRefType(b.yref)!=="domain"?T._id:"",Y=K+W;g.setClipUrl(u,Y?"clip"+r._uid+Y:null,n)}var m=r._imageLowerLayer.selectAll("image").data(s),l=r._imageUpperLayer.selectAll("image").data(t);m.enter().append("image"),l.enter().append("image"),m.exit().remove(),l.exit().remove(),m.each(function(b){d.bind(this)(b),o.bind(this)(b)}),l.each(function(b){d.bind(this)(b),o.bind(this)(b)});var w=Object.keys(r._plots);for(x=0;x<w.length;x++){i=w[x];var _=r._plots[i];if(_.imagelayer){var c=_.imagelayer.selectAll("image").data(h[i]||[]);c.enter().append("image"),c.exit().remove(),c.each(function(b){d.bind(this)(b),o.bind(this)(b)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(y,ee,te){ee.exports={moduleType:"component",name:"images",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),includeBasePlot:y("../../plots/cartesian/include_components")("images"),draw:y("./draw"),convertCoords:y("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(y,ee,te){var A=y("../../plots/font_attributes"),g=y("../color/attributes");ee.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:A({editType:"legend"}),grouptitlefont:A({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:A({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(y,ee,te){ee.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("../../plot_api/plot_template"),M=y("../../plots/attributes"),e=y("./attributes"),a=y("../../plots/layout_attributes"),n=y("./helpers");ee.exports=function(t,h,s){var i=t.legend||{},x=S.newContainer(h,"legend");function p(D,R){return g.coerce(i,x,e,D,R)}for(var v,f=function(D,R){var O=v._input,F=v;return g.coerce(O,F,M,D,R)},d=h.font||{},o=g.coerceFont(p,"grouptitlefont",g.extendFlat({},d,{size:Math.round(d.size*1.1)})),m=0,l=!1,w="normal",_=0;_<s.length;_++)v=s[_],v.visible&&((v.showlegend||v._dfltShowLegend&&!(v._module&&v._module.attributes&&v._module.attributes.showlegend&&v._module.attributes.showlegend.dflt===!1))&&(m++,v.showlegend&&(l=!0,(A.traceIs(v,"pie-like")||v._input.showlegend===!0)&&m++),g.coerceFont(f,"legendgrouptitle.font",o)),(A.traceIs(v,"bar")&&h.barmode==="stack"||["tonextx","tonexty"].indexOf(v.fill)!==-1)&&(w=n.isGrouped({traceorder:w})?"grouped+reversed":"reversed"),v.legendgroup!==void 0&&v.legendgroup!==""&&(w=n.isReversed({traceorder:w})?"reversed+grouped":"grouped"));var c=g.coerce(t,h,a,"showlegend",l&&m>1);if(c===!1&&(h.legend=void 0),!(c===!1&&!i.uirevision)&&(p("uirevision",h.uirevision),c!==!1)){p("bgcolor",h.paper_bgcolor),p("bordercolor"),p("borderwidth");var b=g.coerceFont(p,"font",h.font),u=p("orientation"),L=u==="h",T,k,P;L?(T=0,A.getComponentMethod("rangeslider","isVisible")(t.xaxis)?(k=1.1,P="bottom"):(k=-.1,P="top")):(T=1.02,k=1,P="auto"),p("traceorder",w),n.isGrouped(h.legend)&&p("tracegroupgap"),p("entrywidth"),p("entrywidthmode"),p("itemsizing"),p("itemwidth"),p("itemclick"),p("itemdoubleclick"),p("groupclick"),p("x",T),p("xanchor"),p("y",k),p("yanchor",P),p("valign"),g.noneOrAll(i,x,["x","y"]);var z=p("title.text");if(z){p("title.side",L?"left":"top");var I=g.extendFlat({},b,{size:g.bigFont(b.size)});g.coerceFont(p,"title.font",I)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../plots/plots"),M=y("../../registry"),e=y("../../lib/events"),a=y("../dragelement"),n=y("../drawing"),r=y("../color"),t=y("../../lib/svg_text_utils"),h=y("./handle_click"),s=y("./constants"),i=y("../../constants/alignment"),x=i.LINE_SPACING,p=i.FROM_TL,v=i.FROM_BR,f=y("./get_legend_data"),d=y("./style"),o=y("./helpers"),m=1;ee.exports=function(O,F){return F||(F=O._fullLayout.legend||{}),l(O,F)};function l(R,O){var F=R._fullLayout,N="legend"+F._uid,G,K=O._inHover;if(K?(G=O.layer,N+="-hover"):G=F._infolayer,!!G){R._legendMouseDownTime||(R._legendMouseDownTime=0);var W;if(K){if(!O.entries)return;W=f(O.entries,O)}else{if(!R.calcdata)return;W=F.showlegend&&f(R.calcdata,O)}var Y=F.hiddenlabels||[];if(!K&&(!F.showlegend||!W.length))return G.selectAll(".legend").remove(),F._topdefs.select("#"+N).remove(),S.autoMargin(R,"legend");var re=g.ensureSingle(G,"g","legend",function(Q){K||Q.attr("pointer-events","all")}),ue=g.ensureSingleById(F._topdefs,"clipPath",N,function(Q){Q.append("rect")}),j=g.ensureSingle(re,"rect","bg",function(Q){Q.attr("shape-rendering","crispEdges")});j.call(r.stroke,O.bordercolor).call(r.fill,O.bgcolor).style("stroke-width",O.borderwidth+"px");var q=g.ensureSingle(re,"g","scrollbox"),H=O.title;if(O._titleWidth=0,O._titleHeight=0,H.text){var U=g.ensureSingle(q,"text","legendtitletext");U.attr("text-anchor","start").call(n.font,H.font).text(H.text),L(U,q,R,O,m)}else q.selectAll(".legendtitletext").remove();var $=g.ensureSingle(re,"rect","scrollbar",function(Q){Q.attr(s.scrollBarEnterAttrs).call(r.fill,s.scrollBarColor)}),ne=q.selectAll("g.groups").data(W);ne.enter().append("g").attr("class","groups"),ne.exit().remove();var X=ne.selectAll("g.traces").data(g.identity);X.enter().append("g").attr("class","traces"),X.exit().remove(),X.style("opacity",function(Q){var ie=Q[0].trace;return M.traceIs(ie,"pie-like")?Y.indexOf(Q[0].label)!==-1?.5:1:ie.visible==="legendonly"?.5:1}).each(function(){A.select(this).call(c,R,O)}).call(d,R,O).each(function(){K||A.select(this).call(u,R)}),g.syncOrAsync([S.previousPromises,function(){return P(R,ne,X,O)},function(){var Q=F._size,ie=O.borderwidth;if(!K){var se=z(R);if(se)return;var ae=Q.l+Q.w*O.x-p[I(O)]*O._width,oe=Q.t+Q.h*(1-O.y)-p[D(O)]*O._effHeight;if(F.margin.autoexpand){var be=ae,ce=oe;ae=g.constrain(ae,0,F.width-O._width),oe=g.constrain(oe,0,F.height-O._effHeight),ae!==be&&g.log("Constrain legend.x to make legend fit inside graph"),oe!==ce&&g.log("Constrain legend.y to make legend fit inside graph")}n.setTranslate(re,ae,oe)}if($.on(".drag",null),re.on("wheel",null),K||O._height<=O._maxHeight||R._context.staticPlot){var de=O._effHeight;K&&(de=O._height),j.attr({width:O._width-ie,height:de-ie,x:ie/2,y:ie/2}),n.setTranslate(q,0,0),ue.select("rect").attr({width:O._width-2*ie,height:de-2*ie,x:ie,y:ie}),n.setClipUrl(q,N,R),n.setRect($,0,0,0,0),delete O._scrollY}else{var ye=Math.max(s.scrollBarMinHeight,O._effHeight*O._effHeight/O._height),ge=O._effHeight-ye-2*s.scrollBarMargin,me=O._height-O._effHeight,Ee=ge/me,Pe=Math.min(O._scrollY||0,me);j.attr({width:O._width-2*ie+s.scrollBarWidth+s.scrollBarMargin,height:O._effHeight-ie,x:ie/2,y:ie/2}),ue.select("rect").attr({width:O._width-2*ie+s.scrollBarWidth+s.scrollBarMargin,height:O._effHeight-2*ie,x:ie,y:ie+Pe}),n.setClipUrl(q,N,R),Ye(Pe,ye,Ee),re.on("wheel",function(){Pe=g.constrain(O._scrollY+A.event.deltaY/ge*me,0,me),Ye(Pe,ye,Ee),Pe!==0&&Pe!==me&&A.event.preventDefault()});var Ue,we,ke,Xe=function(Mt,Xt,It){var At=(It-Xt)/Ee+Mt;return g.constrain(At,0,me)},Ve=function(Mt,Xt,It){var At=(Xt-It)/Ee+Mt;return g.constrain(At,0,me)},Ie=A.behavior.drag().on("dragstart",function(){var Mt=A.event.sourceEvent;Mt.type==="touchstart"?Ue=Mt.changedTouches[0].clientY:Ue=Mt.clientY,ke=Pe}).on("drag",function(){var Mt=A.event.sourceEvent;Mt.buttons===2||Mt.ctrlKey||(Mt.type==="touchmove"?we=Mt.changedTouches[0].clientY:we=Mt.clientY,Pe=Xe(ke,Ue,we),Ye(Pe,ye,Ee))});$.call(Ie);var De=A.behavior.drag().on("dragstart",function(){var Mt=A.event.sourceEvent;Mt.type==="touchstart"&&(Ue=Mt.changedTouches[0].clientY,ke=Pe)}).on("drag",function(){var Mt=A.event.sourceEvent;Mt.type==="touchmove"&&(we=Mt.changedTouches[0].clientY,Pe=Ve(ke,Ue,we),Ye(Pe,ye,Ee))});q.call(De)}function Ye(Mt,Xt,It){O._scrollY=R._fullLayout.legend._scrollY=Mt,n.setTranslate(q,0,-Mt),n.setRect($,O._width,s.scrollBarMargin+Mt*It,s.scrollBarWidth,Xt),ue.select("rect").attr("y",ie+Mt)}if(R._context.edits.legendPosition){var vt,Dt,Kt,Ft;re.classed("cursor-move",!0),a.init({element:re.node(),gd:R,prepFn:function(){var Mt=n.getTranslate(re);Kt=Mt.x,Ft=Mt.y},moveFn:function(Mt,Xt){var It=Kt+Mt,At=Ft+Xt;n.setTranslate(re,It,At),vt=a.align(It,0,Q.l,Q.l+Q.w,O.xanchor),Dt=a.align(At,0,Q.t+Q.h,Q.t,O.yanchor)},doneFn:function(){vt!==void 0&&Dt!==void 0&&M.call("_guiRelayout",R,{"legend.x":vt,"legend.y":Dt})},clickFn:function(Mt,Xt){var It=G.selectAll("g.traces").filter(function(){var At=this.getBoundingClientRect();return Xt.clientX>=At.left&&Xt.clientX<=At.right&&Xt.clientY>=At.top&&Xt.clientY<=At.bottom});It.size()>0&&_(R,re,It,Mt,Xt)}})}}],R)}}function w(R,O,F){var N=R[0],G=N.width,K=O.entrywidthmode,W=N.trace.legendwidth||O.entrywidth;return K==="fraction"?O._maxWidth*W:F+(W||G)}function _(R,O,F,N,G){var K=F.data()[0][0].trace,W={event:G,node:F.node(),curveNumber:K.index,expandedIndex:K._expandedIndex,data:R.data,layout:R.layout,frames:R._transitionData._frames,config:R._context,fullData:R._fullData,fullLayout:R._fullLayout};K._group&&(W.group=K._group),M.traceIs(K,"pie-like")&&(W.label=F.datum()[0].label);var Y=e.triggerHandler(R,"plotly_legendclick",W);if(Y!==!1){if(N===1)O._clickTimeout=setTimeout(function(){R._fullLayout&&h(F,R,N)},R._context.doubleClickDelay);else if(N===2){O._clickTimeout&&clearTimeout(O._clickTimeout),R._legendMouseDownTime=0;var re=e.triggerHandler(R,"plotly_legenddoubleclick",W);re!==!1&&h(F,R,N)}}}function c(R,O,F){var N=R.data()[0][0],G=N.trace,K=M.traceIs(G,"pie-like"),W=!F._inHover&&O._context.edits.legendText&&!K,Y=F._maxNameLength,re,ue;N.groupTitle?(re=N.groupTitle.text,ue=N.groupTitle.font):(ue=F.font,F.entries?re=N.text:(re=K?N.label:G.name,G._meta&&(re=g.templateString(re,G._meta))));var j=g.ensureSingle(R,"text","legendtext");j.attr("text-anchor","start").call(n.font,ue).text(W?b(re,Y):re);var q=F.itemwidth+s.itemGap*2;t.positionText(j,q,0),W?j.call(t.makeEditable,{gd:O,text:re}).call(L,R,O,F).on("edit",function(H){this.text(b(H,Y)).call(L,R,O,F);var U=N.trace._fullInput||{},$={};if(M.hasTransform(U,"groupby")){var ne=M.getTransformIndices(U,"groupby"),X=ne[ne.length-1],Q=g.keyedContainer(U,"transforms["+X+"].styles","target","value.name");Q.set(N.trace._group,H),$=Q.constructUpdate()}else $.name=H;return M.call("_guiRestyle",O,$,G.index)}):L(j,R,O,F)}function b(R,O){var F=Math.max(4,O);if(R&&R.trim().length>=F/2)return R;R=R||"";for(var N=F-R.length;N>0;N--)R+=" ";return R}function u(R,O){var F=O._context.doubleClickDelay,N,G=1,K=g.ensureSingle(R,"rect","legendtoggle",function(W){O._context.staticPlot||W.style("cursor","pointer").attr("pointer-events","all"),W.call(r.fill,"rgba(0,0,0,0)")});O._context.staticPlot||(K.on("mousedown",function(){N=new Date().getTime(),N-O._legendMouseDownTime<F?G+=1:(G=1,O._legendMouseDownTime=N)}),K.on("mouseup",function(){if(!(O._dragged||O._editing)){var W=O._fullLayout.legend;new Date().getTime()-O._legendMouseDownTime>F&&(G=Math.max(G-1,1)),_(O,W,R,G,A.event)}}))}function L(R,O,F,N,G){N._inHover&&R.attr("data-notex",!0),t.convertToTspans(R,F,function(){T(O,F,N,G)})}function T(R,O,F,N){var G=R.data()[0][0];if(!F._inHover&&G&&!G.trace.showlegend){R.remove();return}var K=R.select("g[class*=math-group]"),W=K.node();F||(F=O._fullLayout.legend);var Y=F.borderwidth,re;N===m?re=F.title.font:G.groupTitle?re=G.groupTitle.font:re=F.font;var ue=re.size*x,j,q;if(W){var H=n.bBox(W);j=H.height,q=H.width,N===m?n.setTranslate(K,Y,Y+j*.75):n.setTranslate(K,0,j*.25)}else{var U=R.select(N===m?".legendtitletext":".legendtext"),$=t.lineCount(U),ne=U.node();if(j=ue*$,q=ne?n.bBox(ne).width:0,N===m)F.title.side==="left"&&(q+=s.itemGap*2),t.positionText(U,Y+s.titlePad,Y+ue);else{var X=s.itemGap*2+F.itemwidth;G.groupTitle&&(X=s.itemGap,q-=F.itemwidth),t.positionText(U,X,-ue*(($-1)/2-.3))}}N===m?(F._titleWidth=q,F._titleHeight=j):(G.lineHeight=ue,G.height=Math.max(j,16)+3,G.width=q)}function k(R){var O=0,F=0,N=R.title.side;return N&&(N.indexOf("left")!==-1&&(O=R._titleWidth),N.indexOf("top")!==-1&&(F=R._titleHeight)),[O,F]}function P(R,O,F,N){var G=R._fullLayout;N||(N=G.legend);var K=G._size,W=o.isVertical(N),Y=o.isGrouped(N),re=N.entrywidthmode==="fraction",ue=N.borderwidth,j=2*ue,q=s.itemGap,H=N.itemwidth+q*2,U=2*(ue+q),$=D(N),ne=N.y<0||N.y===0&&$==="top",X=N.y>1||N.y===1&&$==="bottom",Q=N.tracegroupgap,ie={};N._maxHeight=Math.max(ne||X?G.height/2:K.h,30);var se=0;N._width=0,N._height=0;var ae=k(N);if(W)F.each(function(Kt){var Ft=Kt[0].height;n.setTranslate(this,ue+ae[0],ue+ae[1]+N._height+Ft/2+q),N._height+=Ft,N._width=Math.max(N._width,Kt[0].width)}),se=H+N._width,N._width+=q+H+j,N._height+=U,Y&&(O.each(function(Kt,Ft){n.setTranslate(this,0,Ft*N.tracegroupgap)}),N._height+=(N._lgroupsLength-1)*N.tracegroupgap);else{var oe=I(N),be=N.x<0||N.x===0&&oe==="right",ce=N.x>1||N.x===1&&oe==="left",de=X||ne,ye=G.width/2;N._maxWidth=Math.max(be?de&&oe==="left"?K.l+K.w:ye:ce?de&&oe==="right"?K.r+K.w:ye:K.w,2*H);var ge=0,me=0;F.each(function(Kt){var Ft=w(Kt,N,H);ge=Math.max(ge,Ft),me+=Ft}),se=null;var Ee=0;if(Y){var Pe=0,Ue=0,we=0;O.each(function(){var Kt=0,Ft=0;A.select(this).selectAll("g.traces").each(function(Xt){var It=w(Xt,N,H),At=Xt[0].height;n.setTranslate(this,ae[0],ae[1]+ue+q+At/2+Ft),Ft+=At,Kt=Math.max(Kt,It),ie[Xt[0].trace.legendgroup]=Kt});var Mt=Kt+q;Ue>0&&Mt+ue+Ue>N._maxWidth?(Ee=Math.max(Ee,Ue),Ue=0,we+=Pe+Q,Pe=Ft):Pe=Math.max(Pe,Ft),n.setTranslate(this,Ue,we),Ue+=Mt}),N._width=Math.max(Ee,Ue)+ue,N._height=we+Pe+U}else{var ke=F.size(),Xe=me+j+(ke-1)*q<N._maxWidth,Ve=0,Ie=0,De=0,Ye=0;F.each(function(Kt){var Ft=Kt[0].height,Mt=w(Kt,N,H),Xt=Xe?Mt:ge;re||(Xt+=q),Xt+ue+Ie-q>=N._maxWidth&&(Ee=Math.max(Ee,Ye),Ie=0,De+=Ve,N._height+=Ve,Ve=0),n.setTranslate(this,ae[0]+ue+Ie,ae[1]+ue+De+Ft/2+q),Ye=Ie+Mt+q,Ie+=Xt,Ve=Math.max(Ve,Ft)}),Xe?(N._width=Ie+j,N._height=Ve+U):(N._width=Math.max(Ee,Ye)+j,N._height+=Ve+U)}}N._width=Math.ceil(Math.max(N._width+ae[0],N._titleWidth+2*(ue+s.titlePad))),N._height=Math.ceil(Math.max(N._height+ae[1],N._titleHeight+2*(ue+s.itemGap))),N._effHeight=Math.min(N._height,N._maxHeight);var vt=R._context.edits,Dt=vt.legendText||vt.legendPosition;F.each(function(Kt){var Ft=A.select(this).select(".legendtoggle"),Mt=Kt[0].height,Xt=Kt[0].trace.legendgroup,It=w(Kt,N,H);Y&&Xt!==""&&(It=ie[Xt]);var At=Dt?H:se||It;!W&&!re&&(At+=q/2),n.setRect(Ft,0,-Mt/2,At,Mt)})}function z(R){var O=R._fullLayout,F=O.legend,N=I(F),G=D(F);return S.autoMargin(R,"legend",{x:F.x,y:F.y,l:F._width*p[N],r:F._width*v[N],b:F._effHeight*v[G],t:F._effHeight*p[G]})}function I(R){return g.isRightAnchor(R)?"right":g.isCenterAnchor(R)?"center":"left"}function D(R){return g.isBottomAnchor(R)?"bottom":g.isMiddleAnchor(R)?"middle":"top"}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(y,ee,te){var A=y("../../registry"),g=y("./helpers");ee.exports=function(M,e){var a=e._inHover,n=g.isGrouped(e),r=g.isReversed(e),t={},h=[],s=!1,i={},x=0,p=0,v,f;function d(O,F){if(O===""||!g.isGrouped(e)){var N="~~i"+x;h.push(N),t[N]=[F],x++}else h.indexOf(O)===-1?(h.push(O),s=!0,t[O]=[F]):t[O].push(F)}for(v=0;v<M.length;v++){var o=M[v],m=o[0],l=m.trace,w=l.legendgroup;if(!(!a&&(!l.visible||!l.showlegend)))if(A.traceIs(l,"pie-like"))for(i[w]||(i[w]={}),f=0;f<o.length;f++){var _=o[f].label;i[w][_]||(d(w,{label:_,color:o[f].color,i:o[f].i,trace:l,pts:o[f].pts}),i[w][_]=!0,p=Math.max(p,(_||"").length))}else d(w,m),p=Math.max(p,(l.name||"").length)}if(!h.length)return[];var c=!s||!n,b=[];for(v=0;v<h.length;v++){var u=t[h[v]];c?b.push(u[0]):b.push(u)}for(c&&(b=[b]),v=0;v<b.length;v++){var L=1/0;for(f=0;f<b[v].length;f++){var T=b[v][f].trace.legendrank;L>T&&(L=T)}b[v][0]._groupMinRank=L,b[v][0]._preGroupSort=v}var k=function(O,F){return O[0]._groupMinRank-F[0]._groupMinRank||O[0]._preGroupSort-F[0]._preGroupSort},P=function(O,F){return O.trace.legendrank-F.trace.legendrank||O._preSort-F._preSort};for(b.forEach(function(O,F){O[0]._preGroupSort=F}),b.sort(k),v=0;v<b.length;v++){b[v].forEach(function(O,F){O._preSort=F}),b[v].sort(P);var z=b[v][0].trace,I=null;for(f=0;f<b[v].length;f++){var D=b[v][f].trace.legendgrouptitle;if(D&&D.text){I=D,a&&(D.font=e._groupTitleFont);break}}if(r&&b[v].reverse(),I){var R=!1;for(f=0;f<b[v].length;f++)if(A.traceIs(b[v][f].trace,"pie-like")){R=!0;break}b[v].unshift({i:-1,groupTitle:I,noClick:R,trace:{showlegend:z.showlegend,legendgroup:z.legendgroup,visible:e.groupclick==="toggleitem"?!0:z.visible}})}for(f=0;f<b[v].length;f++)b[v][f]=[b[v][f]]}return e._lgroupsLength=b.length,e._maxNameLength=p,b}},{"../../registry":647,"./helpers":423}],422:[function(y,ee,te){var A=y("../../lib"),g=y("../../registry"),S=!0;ee.exports=function(e,a,n){var r=a._fullLayout;if(a._dragged||a._editing)return;var t=r.legend.itemclick,h=r.legend.itemdoubleclick,s=r.legend.groupclick;n===1&&t==="toggle"&&h==="toggleothers"&&S&&a.data&&a._context.showTips&&A.notifier(A._(a,"Double-click on legend to isolate one trace"),"long"),S=!1;var i;if(n===1?i=t:n===2&&(i=h),!i)return;var x=s==="togglegroup",p=r.hiddenlabels?r.hiddenlabels.slice():[],v=e.data()[0][0];if(v.groupTitle&&v.noClick)return;var f=a._fullData,d=v.trace,o=d.legendgroup,m,l,w,_,c,b,u={},L=[],T=[],k=[];function P(q,H,U){var $=L.indexOf(q),ne=u[H];return ne||(ne=u[H]=[]),L.indexOf(q)===-1&&(L.push(q),$=L.length-1),ne[$]=U,$}function z(q,H){if(!(v.groupTitle&&!x)){var U=q._fullInput;if(g.hasTransform(U,"groupby")){var $=T[U.index];if(!$){var ne=g.getTransformIndices(U,"groupby"),X=ne[ne.length-1];$=A.keyedContainer(U,"transforms["+X+"].styles","target","value.visible"),T[U.index]=$}var Q=$.get(q._group);Q===void 0&&(Q=!0),Q!==!1&&$.set(q._group,H),k[U.index]=P(U.index,"visible",U.visible!==!1)}else{var ie=U.visible===!1?!1:H;P(U.index,"visible",ie)}}}if(g.traceIs(d,"pie-like")){var I=v.label,D=p.indexOf(I);i==="toggle"?D===-1?p.push(I):p.splice(D,1):i==="toggleothers"&&(p=[],a.calcdata[0].forEach(function(q){I!==q.label&&p.push(q.label)}),a._fullLayout.hiddenlabels&&a._fullLayout.hiddenlabels.length===p.length&&D===-1&&(p=[])),g.call("_guiRelayout",a,"hiddenlabels",p)}else{var R=o&&o.length,O=[],F;if(R)for(m=0;m<f.length;m++)F=f[m],F.visible&&F.legendgroup===o&&O.push(m);if(i==="toggle"){var N;switch(d.visible){case!0:N="legendonly";break;case!1:N=!1;break;case"legendonly":N=!0;break}if(R)if(x)for(m=0;m<f.length;m++)f[m].visible!==!1&&f[m].legendgroup===o&&z(f[m],N);else z(d,N);else z(d,N)}else if(i==="toggleothers"){var G,K,W,Y,re=!0;for(m=0;m<f.length;m++)if(G=f[m]===d,W=f[m].showlegend!==!0,!(G||W)&&(K=R&&f[m].legendgroup===o,!K&&f[m].visible===!0&&!g.traceIs(f[m],"notLegendIsolatable"))){re=!1;break}for(m=0;m<f.length;m++)if(f[m].visible!==!1&&!g.traceIs(f[m],"notLegendIsolatable"))switch(d.visible){case"legendonly":z(f[m],!0);break;case!0:Y=re?!0:"legendonly",G=f[m]===d,W=f[m].showlegend!==!0&&!f[m].legendgroup,K=G||R&&f[m].legendgroup===o,z(f[m],K||W?!0:Y);break}}for(m=0;m<T.length;m++)if(w=T[m],!!w){var ue=w.constructUpdate(),j=Object.keys(ue);for(l=0;l<j.length;l++)_=j[l],b=u[_]=u[_]||[],b[k[m]]=ue[_]}for(c=Object.keys(u),m=0;m<c.length;m++)for(_=c[m],l=0;l<L.length;l++)u[_].hasOwnProperty(l)||(u[_][l]=void 0);g.call("_guiRestyle",a,u,L)}}},{"../../lib":515,"../../registry":647}],423:[function(y,ee,te){te.isGrouped=function(g){return(g.traceorder||"").indexOf("grouped")!==-1},te.isVertical=function(g){return g.orientation!=="h"},te.isReversed=function(g){return(g.traceorder||"").indexOf("reversed")!==-1}},{}],424:[function(y,ee,te){ee.exports={moduleType:"component",name:"legend",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),draw:y("./draw"),style:y("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../registry"),S=y("../../lib"),M=S.strTranslate,e=y("../drawing"),a=y("../color"),n=y("../colorscale/helpers").extractOpts,r=y("../../traces/scatter/subtypes"),t=y("../../traces/pie/style_one"),h=y("../../traces/pie/helpers").castOption,s=y("./constants"),i=12,x=5,p=2,v=10,f=5;ee.exports=function(w,_,c){var b=_._fullLayout;c||(c=b.legend);var u=c.itemsizing==="constant",L=c.itemwidth,T=(L+s.itemGap*2)/2,k=M(T,0),P=function(j,q,H,U){var $;if(j+1)$=j;else if(q&&q.width>0)$=q.width;else return 0;return u?U:Math.min($,H)};w.each(function(j){var q=A.select(this),H=S.ensureSingle(q,"g","layers");H.style("opacity",j[0].trace.opacity);var U=c.valign,$=j[0].lineHeight,ne=j[0].height;if(U==="middle"||!$||!ne)H.attr("transform",null);else{var X={top:1,bottom:-1}[U],Q=X*(.5*($-ne+3));H.attr("transform",M(0,Q))}var ie=H.selectAll("g.legendfill").data([j]);ie.enter().append("g").classed("legendfill",!0);var se=H.selectAll("g.legendlines").data([j]);se.enter().append("g").classed("legendlines",!0);var ae=H.selectAll("g.legendsymbols").data([j]);ae.enter().append("g").classed("legendsymbols",!0),ae.selectAll("g.legendpoints").data([j]).enter().append("g").classed("legendpoints",!0)}).each(ue).each(D).each(O).each(R).each(N).each(Y).each(W).each(z).each(I).each(G).each(K);function z(j){var q=o(j),H=q.showFill,U=q.showLine,$=q.showGradientLine,ne=q.showGradientFill,X=q.anyFill,Q=q.anyLine,ie=j[0],se=ie.trace,ae,oe,be=n(se),ce=be.colorscale,de=be.reversescale,ye=function(ke){if(ke.size())if(H)e.fillGroupStyle(ke,_);else{var Xe="legendfill-"+se.uid;e.gradient(ke,_,Xe,d(de),ce,"fill")}},ge=function(ke){if(ke.size()){var Xe="legendline-"+se.uid;e.lineGroupStyle(ke),e.gradient(ke,_,Xe,d(de),ce,"stroke")}},me=r.hasMarkers(se)||!X?"M5,0":Q?"M5,-2":"M5,-3",Ee=A.select(this),Pe=Ee.select(".legendfill").selectAll("path").data(H||ne?[j]:[]);if(Pe.enter().append("path").classed("js-fill",!0),Pe.exit().remove(),Pe.attr("d",me+"h"+L+"v6h-"+L+"z").call(ye),U||$){var Ue=P(void 0,se.line,v,x);oe=S.minExtend(se,{line:{width:Ue}}),ae=[S.minExtend(ie,{trace:oe})]}var we=Ee.select(".legendlines").selectAll("path").data(U||$?[ae]:[]);we.enter().append("path").classed("js-line",!0),we.exit().remove(),we.attr("d",me+($?"l"+L+",0.0001":"h"+L)).call(U?e.lineGroupStyle:ge)}function I(j){var q=o(j),H=q.anyFill,U=q.anyLine,$=q.showLine,ne=q.showMarker,X=j[0],Q=X.trace,ie=!ne&&!U&&!H&&r.hasText(Q),se,ae;function oe(Pe,Ue,we,ke){var Xe=S.nestedProperty(Q,Pe).get(),Ve=S.isArrayOrTypedArray(Xe)&&Ue?Ue(Xe):Xe;if(u&&Ve&&ke!==void 0&&(Ve=ke),we){if(Ve<we[0])return we[0];if(Ve>we[1])return we[1]}return Ve}function be(Pe){return X._distinct&&X.index&&Pe[X.index]?Pe[X.index]:Pe[0]}if(ne||ie||$){var ce={},de={};if(ne){ce.mc=oe("marker.color",be),ce.mx=oe("marker.symbol",be),ce.mo=oe("marker.opacity",S.mean,[.2,1]),ce.mlc=oe("marker.line.color",be),ce.mlw=oe("marker.line.width",S.mean,[0,5],p),de.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var ye=oe("marker.size",S.mean,[2,16],i);ce.ms=ye,de.marker.size=ye}$&&(de.line={width:oe("line.width",be,[0,10],x)}),ie&&(ce.tx="Aa",ce.tp=oe("textposition",be),ce.ts=10,ce.tc=oe("textfont.color",be),ce.tf=oe("textfont.family",be)),se=[S.minExtend(X,ce)],ae=S.minExtend(Q,de),ae.selectedpoints=null,ae.texttemplate=null}var ge=A.select(this).select("g.legendpoints"),me=ge.selectAll("path.scatterpts").data(ne?se:[]);me.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",k),me.exit().remove(),me.call(e.pointStyle,ae,_),ne&&(se[0].mrc=3);var Ee=ge.selectAll("g.pointtext").data(ie?se:[]);Ee.enter().append("g").classed("pointtext",!0).append("text").attr("transform",k),Ee.exit().remove(),Ee.selectAll("text").call(e.textPointStyle,ae,_)}function D(j){var q=j[0].trace,H=q.type==="waterfall";if(j[0]._distinct&&H){var U=j[0].trace[j[0].dir].marker;return j[0].mc=U.color,j[0].mlw=U.line.width,j[0].mlc=U.line.color,F(j,this,"waterfall")}var $=[];q.visible&&H&&($=j[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var ne=A.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data($);ne.enter().append("path").classed("legendwaterfall",!0).attr("transform",k).style("stroke-miterlimit",1),ne.exit().remove(),ne.each(function(X){var Q=A.select(this),ie=q[X[0]].marker,se=P(void 0,ie.line,f,p);Q.attr("d",X[1]).style("stroke-width",se+"px").call(a.fill,ie.color),se&&Q.call(a.stroke,ie.line.color)})}function R(j){F(j,this)}function O(j){F(j,this,"funnel")}function F(j,q,H){var U=j[0].trace,$=U.marker||{},ne=$.line||{},X=H?U.visible&&U.type===H:g.traceIs(U,"bar"),Q=A.select(q).select("g.legendpoints").selectAll("path.legend"+H).data(X?[j]:[]);Q.enter().append("path").classed("legend"+H,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),Q.exit().remove(),Q.each(function(ie){var se=A.select(this),ae=ie[0],oe=P(ae.mlw,$.line,f,p);se.style("stroke-width",oe+"px");var be=ae.mcc;if(!c._inHover&&"mc"in ae){var ce=n($),de=ce.mid;de===void 0&&(de=(ce.max+ce.min)/2),be=e.tryColorscale($,"")(de)}var ye=be||ae.mc||$.color,ge=$.pattern,me=ge&&e.getPatternAttr(ge.shape,0,"");if(me){var Ee=e.getPatternAttr(ge.bgcolor,0,null),Pe=e.getPatternAttr(ge.fgcolor,0,null),Ue=ge.fgopacity,we=m(ge.size,8,10),ke=m(ge.solidity,.5,1),Xe="legend-"+U.uid;se.call(e.pattern,"legend",_,Xe,me,we,ke,be,ge.fillmode,Ee,Pe,Ue)}else se.call(a.fill,ye);oe&&a.stroke(se,ae.mlc||ne.color)})}function N(j){var q=j[0].trace,H=A.select(this).select("g.legendpoints").selectAll("path.legendbox").data(q.visible&&g.traceIs(q,"box-violin")?[j]:[]);H.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),H.exit().remove(),H.each(function(){var U=A.select(this);if((q.boxpoints==="all"||q.points==="all")&&a.opacity(q.fillcolor)===0&&a.opacity((q.line||{}).color)===0){var $=S.minExtend(q,{marker:{size:u?i:S.constrain(q.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});H.call(e.pointStyle,$,_)}else{var ne=P(void 0,q.line,f,p);U.style("stroke-width",ne+"px").call(a.fill,q.fillcolor),ne&&a.stroke(U,q.line.color)}})}function G(j){var q=j[0].trace,H=A.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(q.visible&&q.type==="candlestick"?[j,j]:[]);H.enter().append("path").classed("legendcandle",!0).attr("d",function(U,$){return $?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",k).style("stroke-miterlimit",1),H.exit().remove(),H.each(function(U,$){var ne=A.select(this),X=q[$?"increasing":"decreasing"],Q=P(void 0,X.line,f,p);ne.style("stroke-width",Q+"px").call(a.fill,X.fillcolor),Q&&a.stroke(ne,X.line.color)})}function K(j){var q=j[0].trace,H=A.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(q.visible&&q.type==="ohlc"?[j,j]:[]);H.enter().append("path").classed("legendohlc",!0).attr("d",function(U,$){return $?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",k).style("stroke-miterlimit",1),H.exit().remove(),H.each(function(U,$){var ne=A.select(this),X=q[$?"increasing":"decreasing"],Q=P(void 0,X.line,f,p);ne.style("fill","none").call(e.dashLine,X.line.dash,Q),Q&&a.stroke(ne,X.line.color)})}function W(j){re(j,this,"pie")}function Y(j){re(j,this,"funnelarea")}function re(j,q,H){var U=j[0],$=U.trace,ne=H?$.visible&&$.type===H:g.traceIs($,H),X=A.select(q).select("g.legendpoints").selectAll("path.legend"+H).data(ne?[j]:[]);if(X.enter().append("path").classed("legend"+H,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),X.exit().remove(),X.size()){var Q=($.marker||{}).line,ie=P(h(Q.width,U.pts),Q,f,p),se=S.minExtend($,{marker:{line:{width:ie}}});se.marker.line.color=Q.color;var ae=S.minExtend(U,{trace:se});t(X,ae,se)}}function ue(j){var q=j[0].trace,H,U=[];if(q.visible)switch(q.type){case"histogram2d":case"heatmap":U=[["M-15,-2V4H15V-2Z"]],H=!0;break;case"choropleth":case"choroplethmapbox":U=[["M-6,-6V6H6V-6Z"]],H=!0;break;case"densitymapbox":U=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],H="radial";break;case"cone":U=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],H=!1;break;case"streamtube":U=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],H=!1;break;case"surface":U=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],H=!0;break;case"mesh3d":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],H=!1;break;case"volume":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],H=!0;break;case"isosurface":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],H=!1;break}var $=A.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(U);$.enter().append("path").classed("legend3dandfriends",!0).attr("transform",k).style("stroke-miterlimit",1),$.exit().remove(),$.each(function(ne,X){var Q=A.select(this),ie=n(q),se=ie.colorscale,ae=ie.reversescale,oe=function(ye){if(ye.size()){var ge="legendfill-"+q.uid;e.gradient(ye,_,ge,d(ae,H==="radial"),se,"fill")}},be;if(se){if(!H){var de=se.length;be=X===0?se[ae?de-1:0][1]:X===1?se[ae?0:de-1][1]:se[Math.floor((de-1)/2)][1]}}else{var ce=q.vertexcolor||q.facecolor||q.color;be=S.isArrayOrTypedArray(ce)?ce[X]||ce[0]:ce}Q.attr("d",ne[0]),be?Q.call(a.fill,be):Q.call(oe)})}};function d(l,w){var _=w?"radial":"horizontal";return _+(l?"":"reversed")}function o(l){var w=l[0].trace,_=w.contours,c=r.hasLines(w),b=r.hasMarkers(w),u=w.visible&&w.fill&&w.fill!=="none",L=!1,T=!1;if(_){var k=_.coloring;k==="lines"?L=!0:c=k==="none"||k==="heatmap"||_.showlines,_.type==="constraint"?u=_._operation!=="=":(k==="fill"||k==="heatmap")&&(T=!0)}return{showMarker:b,showLine:c,showFill:u,showGradientLine:L,showGradientFill:T,anyLine:c||L,anyFill:u||T}}function m(l,w,_){return l&&S.isArrayOrTypedArray(l)?w:l>_?_:l}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(y,ee,te){y("./constants"),ee.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(y,ee,te){var A=y("../../registry"),g=y("../../plots/plots"),S=y("../../plots/cartesian/axis_ids"),M=y("../../fonts/ploticon"),e=y("../shapes/draw").eraseActiveShape,a=y("../../lib"),n=a._,r=ee.exports={};r.toImage={name:"toImage",title:function(l){var w=l._context.toImageButtonOptions||{},_=w.format||"png";return _==="png"?n(l,"Download plot as a png"):n(l,"Download plot")},icon:M.camera,click:function(l){var w=l._context.toImageButtonOptions,_={format:w.format||"png"};a.notifier(n(l,"Taking snapshot - this may take a few seconds"),"long"),_.format!=="svg"&&a.isIE()&&(a.notifier(n(l,"IE only supports svg.  Changing format to svg."),"long"),_.format="svg"),["filename","width","height","scale"].forEach(function(c){c in w&&(_[c]=w[c])}),A.call("downloadImage",l,_).then(function(c){a.notifier(n(l,"Snapshot succeeded")+" - "+c,"long")}).catch(function(){a.notifier(n(l,"Sorry, there was a problem downloading your snapshot!"),"long")})}},r.sendDataToCloud={name:"sendDataToCloud",title:function(l){return n(l,"Edit in Chart Studio")},icon:M.disk,click:function(l){g.sendDataToCloud(l)}},r.editInChartStudio={name:"editInChartStudio",title:function(l){return n(l,"Edit in Chart Studio")},icon:M.pencil,click:function(l){g.sendDataToCloud(l)}},r.zoom2d={name:"zoom2d",_cat:"zoom",title:function(l){return n(l,"Zoom")},attr:"dragmode",val:"zoom",icon:M.zoombox,click:t},r.pan2d={name:"pan2d",_cat:"pan",title:function(l){return n(l,"Pan")},attr:"dragmode",val:"pan",icon:M.pan,click:t},r.select2d={name:"select2d",_cat:"select",title:function(l){return n(l,"Box Select")},attr:"dragmode",val:"select",icon:M.selectbox,click:t},r.lasso2d={name:"lasso2d",_cat:"lasso",title:function(l){return n(l,"Lasso Select")},attr:"dragmode",val:"lasso",icon:M.lasso,click:t},r.drawclosedpath={name:"drawclosedpath",title:function(l){return n(l,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:M.drawclosedpath,click:t},r.drawopenpath={name:"drawopenpath",title:function(l){return n(l,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:M.drawopenpath,click:t},r.drawline={name:"drawline",title:function(l){return n(l,"Draw line")},attr:"dragmode",val:"drawline",icon:M.drawline,click:t},r.drawrect={name:"drawrect",title:function(l){return n(l,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:M.drawrect,click:t},r.drawcircle={name:"drawcircle",title:function(l){return n(l,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:M.drawcircle,click:t},r.eraseshape={name:"eraseshape",title:function(l){return n(l,"Erase active shape")},icon:M.eraseshape,click:e},r.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(l){return n(l,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:t},r.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(l){return n(l,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:t},r.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(l){return n(l,"Autoscale")},attr:"zoom",val:"auto",icon:M.autoscale,click:t},r.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(l){return n(l,"Reset axes")},attr:"zoom",val:"reset",icon:M.home,click:t},r.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(l){return n(l,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:M.tooltip_basic,gravity:"ne",click:t},r.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(l){return n(l,"Compare data on hover")},attr:"hovermode",val:function(l){return l._fullLayout._isHoriz?"y":"x"},icon:M.tooltip_compare,gravity:"ne",click:t};function t(l,w){var _=w.currentTarget,c=_.getAttribute("data-attr"),b=_.getAttribute("data-val")||!0,u=l._fullLayout,L={},T=S.list(l,null,!0),k=u._cartesianSpikesEnabled,P,z;if(c==="zoom"){var I=b==="in"?.5:2,D=(1+I)/2,R=(1-I)/2,O;for(z=0;z<T.length;z++)if(P=T[z],!P.fixedrange)if(O=P._name,b==="auto")L[O+".autorange"]=!0;else if(b==="reset"){if(P._rangeInitial===void 0)L[O+".autorange"]=!0;else{var F=P._rangeInitial.slice();L[O+".range[0]"]=F[0],L[O+".range[1]"]=F[1]}P._showSpikeInitial!==void 0&&(L[O+".showspikes"]=P._showSpikeInitial,k==="on"&&!P._showSpikeInitial&&(k="off"))}else{var N=[P.r2l(P.range[0]),P.r2l(P.range[1])],G=[D*N[0]+R*N[1],D*N[1]+R*N[0]];L[O+".range[0]"]=P.l2r(G[0]),L[O+".range[1]"]=P.l2r(G[1])}}else c==="hovermode"&&(b==="x"||b==="y")&&(b=u._isHoriz?"y":"x",_.setAttribute("data-val",b)),L[c]=b;u._cartesianSpikesEnabled=k,A.call("_guiRelayout",l,L)}r.zoom3d={name:"zoom3d",_cat:"zoom",title:function(l){return n(l,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:M.zoombox,click:h},r.pan3d={name:"pan3d",_cat:"pan",title:function(l){return n(l,"Pan")},attr:"scene.dragmode",val:"pan",icon:M.pan,click:h},r.orbitRotation={name:"orbitRotation",title:function(l){return n(l,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:M["3d_rotate"],click:h},r.tableRotation={name:"tableRotation",title:function(l){return n(l,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:M["z-axis"],click:h};function h(l,w){for(var _=w.currentTarget,c=_.getAttribute("data-attr"),b=_.getAttribute("data-val")||!0,u=l._fullLayout._subplots.gl3d||[],L={},T=c.split("."),k=0;k<u.length;k++)L[u[k]+"."+T[1]]=b;var P=b==="pan"?b:"zoom";L.dragmode=P,A.call("_guiRelayout",l,L)}r.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(l){return n(l,"Reset camera to default")},attr:"resetDefault",icon:M.home,click:s},r.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(l){return n(l,"Reset camera to last save")},attr:"resetLastSave",icon:M.movie,click:s};function s(l,w){for(var _=w.currentTarget,c=_.getAttribute("data-attr"),b=c==="resetLastSave",u=c==="resetDefault",L=l._fullLayout,T=L._subplots.gl3d||[],k={},P=0;P<T.length;P++){var z=T[P],I=z+".camera",D=z+".aspectratio",R=z+".aspectmode",O=L[z]._scene,F;b?(k[I+".up"]=O.viewInitial.up,k[I+".eye"]=O.viewInitial.eye,k[I+".center"]=O.viewInitial.center,F=!0):u&&(k[I+".up"]=null,k[I+".eye"]=null,k[I+".center"]=null,F=!0),F&&(k[D+".x"]=O.viewInitial.aspectratio.x,k[D+".y"]=O.viewInitial.aspectratio.y,k[D+".z"]=O.viewInitial.aspectratio.z,k[R]=O.viewInitial.aspectmode)}A.call("_guiRelayout",l,k)}r.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:x};function i(l,w){var _=w.currentTarget,c=_._previousVal,b=l._fullLayout,u=b._subplots.gl3d||[],L=["xaxis","yaxis","zaxis"],T={},k={};if(c)k=c,_._previousVal=null;else{for(var P=0;P<u.length;P++){var z=u[P],I=b[z],D=z+".hovermode";T[D]=I.hovermode,k[D]=!1;for(var R=0;R<3;R++){var O=L[R],F=z+"."+O+".showspikes";k[F]=!1,T[F]=I[O].showspikes}}_._previousVal=T}return k}function x(l,w){var _=i(l,w);A.call("_guiRelayout",l,_)}r.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(l){return n(l,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:p},r.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(l){return n(l,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:p},r.resetGeo={name:"resetGeo",_cat:"reset",title:function(l){return n(l,"Reset")},attr:"reset",val:null,icon:M.autoscale,click:p},r.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:f};function p(l,w){for(var _=w.currentTarget,c=_.getAttribute("data-attr"),b=_.getAttribute("data-val")||!0,u=l._fullLayout,L=u._subplots.geo||[],T=0;T<L.length;T++){var k=L[T],P=u[k];if(c==="zoom"){var z=P.projection.scale,I=b==="in"?2*z:.5*z;A.call("_guiRelayout",l,k+".projection.scale",I)}}c==="reset"&&m(l,"geo")}r.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:f},r.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:M.tooltip_basic,gravity:"ne",click:f};function v(l){var w=l._fullLayout;return w.hovermode?!1:w._has("cartesian")?w._isHoriz?"y":"x":"closest"}function f(l){var w=v(l);A.call("_guiRelayout",l,"hovermode",w)}r.resetViewSankey={name:"resetSankeyGroup",title:function(l){return n(l,"Reset view")},icon:M.home,click:function(l){for(var w={"node.groups":[],"node.x":[],"node.y":[]},_=0;_<l._fullData.length;_++){var c=l._fullData[_]._viewInitial;w["node.groups"].push(c.node.groups.slice()),w["node.x"].push(c.node.x.slice()),w["node.y"].push(c.node.y.slice())}A.call("restyle",l,w)}},r.toggleHover={name:"toggleHover",title:function(l){return n(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:M.tooltip_basic,gravity:"ne",click:function(l,w){var _=i(l,w);_.hovermode=v(l),A.call("_guiRelayout",l,_)}},r.resetViews={name:"resetViews",title:function(l){return n(l,"Reset views")},icon:M.home,click:function(l,w){var _=w.currentTarget;_.setAttribute("data-attr","zoom"),_.setAttribute("data-val","reset"),t(l,w),_.setAttribute("data-attr","resetLastSave"),s(l,w),m(l,"geo"),m(l,"mapbox")}},r.toggleSpikelines={name:"toggleSpikelines",title:function(l){return n(l,"Toggle Spike Lines")},icon:M.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(l){var w=l._fullLayout,_=w._cartesianSpikesEnabled;w._cartesianSpikesEnabled=_==="on"?"off":"on",A.call("_guiRelayout",l,d(l))}};function d(l){for(var w=l._fullLayout,_=w._cartesianSpikesEnabled==="on",c=S.list(l,null,!0),b={},u=0;u<c.length;u++){var L=c[u];b[L._name+".showspikes"]=_?!0:L._showSpikeInitial}return b}r.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(l){return n(l,"Reset view")},attr:"reset",icon:M.home,click:function(l){m(l,"mapbox")}},r.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(l){return n(l,"Zoom in")},attr:"zoom",val:"in",icon:M.zoom_plus,click:o},r.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(l){return n(l,"Zoom out")},attr:"zoom",val:"out",icon:M.zoom_minus,click:o};function o(l,w){for(var _=w.currentTarget,c=_.getAttribute("data-val"),b=l._fullLayout,u=b._subplots.mapbox||[],L=1.05,T={},k=0;k<u.length;k++){var P=u[k],z=b[P].zoom,I=c==="in"?L*z:z/L;T[P+".zoom"]=I}A.call("_guiRelayout",l,T)}function m(l,w){for(var _=l._fullLayout,c=_._subplots[w]||[],b={},u=0;u<c.length;u++)for(var L=c[u],T=_[L]._subplot,k=T.viewInitial,P=Object.keys(k),z=0;z<P.length;z++){var I=P[z];b[L+"."+I]=k[I]}A.call("_guiRelayout",l,b)}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(y,ee,te){var A=y("./buttons"),g=Object.keys(A),S=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],M=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(S),e=[],a=function(n){if(M.indexOf(n._cat||n.name)===-1){var r=n.name,t=(n._cat||n.name).toLowerCase();e.indexOf(r)===-1&&e.push(r),e.indexOf(t)===-1&&e.push(t)}};g.forEach(function(n){a(A[n])}),e.sort(),ee.exports={DRAW_MODES:S,backButtons:M,foreButtons:e}},{"./buttons":427}],429:[function(y,ee,te){var A=y("../../lib"),g=y("../color"),S=y("../../plot_api/plot_template"),M=y("./attributes");ee.exports=function(a,n){var r=a.modebar||{},t=S.newContainer(n,"modebar");function h(i,x){return A.coerce(r,t,M,i,x)}h("orientation"),h("bgcolor",g.addOpacity(n.paper_bgcolor,.5));var s=g.contrast(g.rgb(n.modebar.bgcolor));h("color",g.addOpacity(s,.3)),h("activecolor",g.addOpacity(s,.7)),h("uirevision",n.uirevision),h("add"),h("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(y,ee,te){ee.exports={moduleType:"component",name:"modebar",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),manage:y("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(y,ee,te){var A=y("../../plots/cartesian/axis_ids"),g=y("../../traces/scatter/subtypes"),S=y("../../registry"),M=y("../fx/helpers").isUnifiedHover,e=y("./modebar"),a=y("./buttons"),n=y("./constants").DRAW_MODES,r=y("../../lib").extendDeep;ee.exports=function(f){var d=f._fullLayout,o=f._context,m=d._modeBar;if(!o.displayModeBar&&!o.watermark){m&&(m.destroy(),delete d._modeBar);return}if(!Array.isArray(o.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(o.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var l=o.modeBarButtons,w;Array.isArray(l)&&l.length?w=p(l):!o.displayModeBar&&o.watermark?w=[]:w=t(f),m?m.update(f,w):d._modeBar=e(f,w)};function t(v){var f=v._fullLayout,d=v._fullData,o=v._context;function m(X,Q){if(typeof Q=="string"){if(Q.toLowerCase()===X.toLowerCase())return!0}else{var ie=Q.name,se=Q._cat||Q.name;if(ie===X||se===X.toLowerCase())return!0}return!1}var l=f.modebar.add;typeof l=="string"&&(l=[l]);var w=f.modebar.remove;typeof w=="string"&&(w=[w]);var _=o.modeBarButtonsToAdd.concat(l.filter(function(X){for(var Q=0;Q<o.modeBarButtonsToRemove.length;Q++)if(m(X,o.modeBarButtonsToRemove[Q]))return!1;return!0})),c=o.modeBarButtonsToRemove.concat(w.filter(function(X){for(var Q=0;Q<o.modeBarButtonsToAdd.length;Q++)if(m(X,o.modeBarButtonsToAdd[Q]))return!1;return!0})),b=f._has("cartesian"),u=f._has("gl3d"),L=f._has("geo"),T=f._has("pie"),k=f._has("funnelarea"),P=f._has("gl2d"),z=f._has("ternary"),I=f._has("mapbox"),D=f._has("polar"),R=f._has("smith"),O=f._has("sankey"),F=h(f),N=M(f.hovermode),G=[];function K(X){if(X.length){for(var Q=[],ie=0;ie<X.length;ie++){for(var se=X[ie],ae=a[se],oe=ae.name.toLowerCase(),be=(ae._cat||ae.name).toLowerCase(),ce=!1,de=0;de<c.length;de++){var ye=c[de].toLowerCase();if(ye===oe||ye===be){ce=!0;break}}ce||Q.push(a[se])}G.push(Q)}}var W=["toImage"];o.showEditInChartStudio?W.push("editInChartStudio"):o.showSendToCloud&&W.push("sendDataToCloud"),K(W);var Y=[],re=[],ue=[],j=[];(b||P||T||k||z)+L+u+I+D+R>1?(re=["toggleHover"],ue=["resetViews"]):L?(Y=["zoomInGeo","zoomOutGeo"],re=["hoverClosestGeo"],ue=["resetGeo"]):u?(re=["hoverClosest3d"],ue=["resetCameraDefault3d","resetCameraLastSave3d"]):I?(Y=["zoomInMapbox","zoomOutMapbox"],re=["toggleHover"],ue=["resetViewMapbox"]):P?re=["hoverClosestGl2d"]:T?re=["hoverClosestPie"]:O?(re=["hoverClosestCartesian","hoverCompareCartesian"],ue=["resetViewSankey"]):re=["toggleHover"],b&&(re=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(i(d)||N)&&(re=[]),(b||P)&&!F&&(Y=["zoomIn2d","zoomOut2d","autoScale2d"],ue[0]!=="resetViews"&&(ue=["resetScale2d"])),u?j=["zoom3d","pan3d","orbitRotation","tableRotation"]:(b||P)&&!F||z?j=["zoom2d","pan2d"]:I||L?j=["pan2d"]:D&&(j=["zoom2d"]),s(d)&&j.push("select2d","lasso2d");var q=[],H=function(X){q.indexOf(X)===-1&&re.indexOf(X)!==-1&&q.push(X)};if(Array.isArray(_)){for(var U=[],$=0;$<_.length;$++){var ne=_[$];typeof ne=="string"?(ne=ne.toLowerCase(),n.indexOf(ne)!==-1?(f._has("mapbox")||f._has("cartesian"))&&j.push(ne):ne==="togglespikelines"?H("toggleSpikelines"):ne==="togglehover"?H("toggleHover"):ne==="hovercompare"?H("hoverCompareCartesian"):ne==="hoverclosest"?(H("hoverClosestCartesian"),H("hoverClosestGeo"),H("hoverClosest3d"),H("hoverClosestGl2d"),H("hoverClosestPie")):ne==="v1hovermode"&&(H("toggleHover"),H("hoverClosestCartesian"),H("hoverCompareCartesian"),H("hoverClosestGeo"),H("hoverClosest3d"),H("hoverClosestGl2d"),H("hoverClosestPie"))):U.push(ne)}_=U}return K(j),K(Y.concat(ue)),K(q),x(G,_)}function h(v){for(var f=A.list({_fullLayout:v},null,!0),d=0;d<f.length;d++)if(!f[d].fixedrange)return!1;return!0}function s(v){for(var f=!1,d=0;d<v.length&&!f;d++){var o=v[d];!o._module||!o._module.selectPoints||(S.traceIs(o,"scatter-like")?(g.hasMarkers(o)||g.hasText(o))&&(f=!0):S.traceIs(o,"box-violin")?(o.boxpoints==="all"||o.points==="all")&&(f=!0):f=!0)}return f}function i(v){for(var f=0;f<v.length;f++)if(!S.traceIs(v[f],"noHover"))return!1;return!0}function x(v,f){if(f.length)if(Array.isArray(f[0]))for(var d=0;d<f.length;d++)v.push(f[d]);else v.push(f);return v}function p(v){for(var f=r([],v),d=0;d<f.length;d++)for(var o=f[d],m=0;m<o.length;m++){var l=o[m];if(typeof l=="string")if(a[l]!==void 0)f[d][m]=a[l];else throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}return f}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("../../lib"),M=y("../../fonts/ploticon"),e=y("../../version").version,a=new DOMParser;function n(s){this.container=s.container,this.element=document.createElement("div"),this.update(s.graphInfo,s.buttons),this.container.appendChild(this.element)}var r=n.prototype;r.update=function(s,i){this.graphInfo=s;var x=this.graphInfo._context,p=this.graphInfo._fullLayout,v="modebar-"+p._uid;this.element.setAttribute("id",v),this._uid=v,this.element.className="modebar",x.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),p.modebar.orientation==="v"&&(this.element.className+=" vertical",i=i.reverse());var f=p.modebar,d=x.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";S.deleteRelatedStyleRule(v),S.addRelatedStyleRule(v,d+"#"+v+" .modebar-group","background-color: "+f.bgcolor),S.addRelatedStyleRule(v,"#"+v+" .modebar-btn .icon path","fill: "+f.color),S.addRelatedStyleRule(v,"#"+v+" .modebar-btn:hover .icon path","fill: "+f.activecolor),S.addRelatedStyleRule(v,"#"+v+" .modebar-btn.active .icon path","fill: "+f.activecolor);var o=!this.hasButtons(i),m=this.hasLogo!==x.displaylogo,l=this.locale!==x.locale;if(this.locale=x.locale,(o||m||l)&&(this.removeAllButtons(),this.updateButtons(i),x.watermark||x.displaylogo)){var w=this.getLogo();x.watermark&&(w.className=w.className+" watermark"),p.modebar.orientation==="v"?this.element.insertBefore(w,this.element.childNodes[0]):this.element.appendChild(w),this.hasLogo=!0}this.updateActiveButton()},r.updateButtons=function(s){var i=this;this.buttons=s,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(x){var p=i.createGroup();x.forEach(function(v){var f=v.name;if(!f)throw new Error("must provide button 'name' in button config");if(i.buttonsNames.indexOf(f)!==-1)throw new Error("button name '"+f+"' is taken");i.buttonsNames.push(f);var d=i.createButton(v);i.buttonElements.push(d),p.appendChild(d)}),i.element.appendChild(p)})},r.createGroup=function(){var s=document.createElement("div");return s.className="modebar-group",s},r.createButton=function(s){var i=this,x=document.createElement("a");x.setAttribute("rel","tooltip"),x.className="modebar-btn";var p=s.title;p===void 0?p=s.name:typeof p=="function"&&(p=p(this.graphInfo)),(p||p===0)&&x.setAttribute("data-title",p),s.attr!==void 0&&x.setAttribute("data-attr",s.attr);var v=s.val;v!==void 0&&(typeof v=="function"&&(v=v(this.graphInfo)),x.setAttribute("data-val",v));var f=s.click;if(typeof f!="function")throw new Error("must provide button 'click' function in button config");x.addEventListener("click",function(o){s.click(i.graphInfo,o),i.updateActiveButton(o.currentTarget)}),x.setAttribute("data-toggle",s.toggle||!1),s.toggle&&A.select(x).classed("active",!0);var d=s.icon;return typeof d=="function"?x.appendChild(d()):x.appendChild(this.createIcon(d||M.question)),x.setAttribute("data-gravity",s.gravity||"n"),x},r.createIcon=function(s){var i=g(s.height)?Number(s.height):s.ascent-s.descent,x="http://www.w3.org/2000/svg",p;if(s.path){p=document.createElementNS(x,"svg"),p.setAttribute("viewBox",[0,0,s.width,i].join(" ")),p.setAttribute("class","icon");var v=document.createElementNS(x,"path");v.setAttribute("d",s.path),s.transform?v.setAttribute("transform",s.transform):s.ascent!==void 0&&v.setAttribute("transform","matrix(1 0 0 -1 0 "+s.ascent+")"),p.appendChild(v)}if(s.svg){var f=a.parseFromString(s.svg,"application/xml");p=f.childNodes[0]}return p.setAttribute("height","1em"),p.setAttribute("width","1em"),p},r.updateActiveButton=function(s){var i=this.graphInfo._fullLayout,x=s!==void 0?s.getAttribute("data-attr"):null;this.buttonElements.forEach(function(p){var v=p.getAttribute("data-val")||!0,f=p.getAttribute("data-attr"),d=p.getAttribute("data-toggle")==="true",o=A.select(p);if(d)f===x&&o.classed("active",!o.classed("active"));else{var m=f===null?f:S.nestedProperty(i,f).get();o.classed("active",m===v)}})},r.hasButtons=function(s){var i=this.buttons;if(!i||s.length!==i.length)return!1;for(var x=0;x<s.length;++x){if(s[x].length!==i[x].length)return!1;for(var p=0;p<s[x].length;p++)if(s[x][p].name!==i[x][p].name)return!1}return!0};function t(s){return s+" (v"+e+")"}r.getLogo=function(){var s=this.createGroup(),i=document.createElement("a");return i.href="https://plotly.com/",i.target="_blank",i.setAttribute("data-title",t(S._(this.graphInfo,"Produced with Plotly.js"))),i.className="modebar-btn plotlyjsicon modebar-btn--logo",i.appendChild(this.createIcon(M.newplotlylogo)),s.appendChild(i),s},r.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},r.destroy=function(){S.removeElement(this.container.querySelector(".modebar")),S.deleteRelatedStyleRule(this._uid)};function h(s,i){var x=s._fullLayout,p=new n({graphInfo:s,container:x._modebardiv.node(),buttons:i});return x._privateplot&&A.select(p.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),p}ee.exports=h},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(y,ee,te){var A=y("../../plots/font_attributes"),g=y("../color/attributes"),S=y("../../plot_api/plot_template").templatedArray,M=S("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});ee.exports={visible:{valType:"boolean",editType:"plot"},buttons:M,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:A({editType:"plot"}),bgcolor:{valType:"color",dflt:g.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(y,ee,te){ee.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(y,ee,te){var A=y("../../lib"),g=y("../color"),S=y("../../plot_api/plot_template"),M=y("../../plots/array_container_defaults"),e=y("./attributes"),a=y("./constants");ee.exports=function(h,s,i,x,p){var v=h.rangeselector||{},f=S.newContainer(s,"rangeselector");function d(_,c){return A.coerce(v,f,e,_,c)}var o=M(v,f,{name:"buttons",handleItemDefaults:n,calendar:p}),m=d("visible",o.length>0);if(m){var l=r(s,i,x);d("x",l[0]),d("y",l[1]),A.noneOrAll(h,s,["x","y"]),d("xanchor"),d("yanchor"),A.coerceFont(d,"font",i.font);var w=d("bgcolor");d("activecolor",g.contrast(w,a.lightAmount,a.darkAmount)),d("bordercolor"),d("borderwidth")}};function n(t,h,s,i){var x=i.calendar;function p(d,o){return A.coerce(t,h,e.buttons,d,o)}var v=p("visible");if(v){var f=p("step");f!=="all"&&(x&&x!=="gregorian"&&(f==="month"||f==="year")?h.stepmode="backward":p("stepmode"),p("count")),p("label")}}function r(t,h,s){for(var i=s.filter(function(f){return h[f].anchor===t._id}),x=0,p=0;p<i.length;p++){var v=h[i[p]].domain;v&&(x=Math.max(v[1],x))}return[t.domain[0],x+a.yPad]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../registry"),S=y("../../plots/plots"),M=y("../color"),e=y("../drawing"),a=y("../../lib"),n=a.strTranslate,r=y("../../lib/svg_text_utils"),t=y("../../plots/cartesian/axis_ids"),h=y("../../constants/alignment"),s=h.LINE_SPACING,i=h.FROM_TL,x=h.FROM_BR,p=y("./constants"),v=y("./get_update_object");ee.exports=function(u){var L=u._fullLayout,T=L._infolayer.selectAll(".rangeselector").data(f(u),d);T.enter().append("g").classed("rangeselector",!0),T.exit().remove(),T.style({cursor:"pointer","pointer-events":"all"}),T.each(function(k){var P=A.select(this),z=k,I=z.rangeselector,D=P.selectAll("g.button").data(a.filterVisible(I.buttons));D.enter().append("g").classed("button",!0),D.exit().remove(),D.each(function(R){var O=A.select(this),F=v(z,R);R._isActive=o(z,R,F),O.call(m,I,R),O.call(w,I,R,u),O.on("click",function(){u._dragged||g.call("_guiRelayout",u,F)}),O.on("mouseover",function(){R._isHovered=!0,O.call(m,I,R)}),O.on("mouseout",function(){R._isHovered=!1,O.call(m,I,R)})}),c(u,D,I,z._name,P)})};function f(b){for(var u=t.list(b,"x",!0),L=[],T=0;T<u.length;T++){var k=u[T];k.rangeselector&&k.rangeselector.visible&&L.push(k)}return L}function d(b){return b._id}function o(b,u,L){if(u.step==="all")return b.autorange===!0;var T=Object.keys(L);return b.range[0]===L[T[0]]&&b.range[1]===L[T[1]]}function m(b,u,L){var T=a.ensureSingle(b,"rect","selector-rect",function(k){k.attr("shape-rendering","crispEdges")});T.attr({rx:p.rx,ry:p.ry}),T.call(M.stroke,u.bordercolor).call(M.fill,l(u,L)).style("stroke-width",u.borderwidth+"px")}function l(b,u){return u._isActive||u._isHovered?b.activecolor:b.bgcolor}function w(b,u,L,T){function k(z){r.convertToTspans(z,T)}var P=a.ensureSingle(b,"text","selector-text",function(z){z.attr("text-anchor","middle")});P.call(e.font,u.font).text(_(L,T._fullLayout._meta)).call(k)}function _(b,u){return b.label?u?a.templateString(b.label,u):b.label:b.step==="all"?"all":b.count+b.step.charAt(0)}function c(b,u,L,T,k){var P=0,z=0,I=L.borderwidth;u.each(function(){var G=A.select(this),K=G.select(".selector-text"),W=L.font.size*s,Y=Math.max(W*r.lineCount(K),16)+3;z=Math.max(z,Y)}),u.each(function(){var G=A.select(this),K=G.select(".selector-rect"),W=G.select(".selector-text"),Y=W.node()&&e.bBox(W.node()).width,re=L.font.size*s,ue=r.lineCount(W),j=Math.max(Y+10,p.minButtonWidth);G.attr("transform",n(I+P,I)),K.attr({x:0,y:0,width:j,height:z}),r.positionText(W,j/2,z/2-(ue-1)*re/2+3),P+=j+5});var D=b._fullLayout._size,R=D.l+D.w*L.x,O=D.t+D.h*(1-L.y),F="left";a.isRightAnchor(L)&&(R-=P,F="right"),a.isCenterAnchor(L)&&(R-=P/2,F="center");var N="top";a.isBottomAnchor(L)&&(O-=z,N="bottom"),a.isMiddleAnchor(L)&&(O-=z/2,N="middle"),P=Math.ceil(P),z=Math.ceil(z),R=Math.round(R),O=Math.round(O),S.autoMargin(b,T+"-range-selector",{x:L.x,y:L.y,l:P*i[F],r:P*x[F],b:z*x[N],t:z*i[N]}),k.attr("transform",n(R,O))}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(y,ee,te){var A=y("d3-time"),g=y("../../lib").titleCase;ee.exports=function(e,a){var n=e._name,r={};if(a.step==="all")r[n+".autorange"]=!0;else{var t=S(e,a);r[n+".range[0]"]=t[0],r[n+".range[1]"]=t[1]}return r};function S(M,e){var a=M.range,n=new Date(M.r2l(a[1])),r=e.step,t=A["utc"+g(r)],h=e.count,s;switch(e.stepmode){case"backward":s=M.l2r(+t.offset(n,-h));break;case"todate":var i=t.offset(n,-h);s=M.l2r(+t.ceil(i));break}var x=a[1];return[s,x]}},{"../../lib":515,"d3-time":122}],438:[function(y,ee,te){ee.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:y("./attributes")}}},layoutAttributes:y("./attributes"),handleDefaults:y("./defaults"),draw:y("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(y,ee,te){var A=y("../color/attributes");ee.exports={bgcolor:{valType:"color",dflt:A.background,editType:"plot"},bordercolor:{valType:"color",dflt:A.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(y,ee,te){var A=y("../../plots/cartesian/axis_ids").list,g=y("../../plots/cartesian/autorange").getAutoRange,S=y("./constants");ee.exports=function(e){for(var a=A(e,"x",!0),n=0;n<a.length;n++){var r=a[n],t=r[S.name];t&&t.visible&&t.autorange&&(t._input.autorange=!0,t._input.range=t.range=g(e,r))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(y,ee,te){ee.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(y,ee,te){var A=y("../../lib"),g=y("../../plot_api/plot_template"),S=y("../../plots/cartesian/axis_ids"),M=y("./attributes"),e=y("./oppaxis_attributes");ee.exports=function(n,r,t){var h=n[t],s=r[t];if(!(h.rangeslider||r._requestRangeslider[s._id]))return;A.isPlainObject(h.rangeslider)||(h.rangeslider={});var i=h.rangeslider,x=g.newContainer(s,"rangeslider");function p(T,k){return A.coerce(i,x,M,T,k)}var v,f;function d(T,k){return A.coerce(v,f,e,T,k)}var o=p("visible");if(o){p("bgcolor",r.plot_bgcolor),p("bordercolor"),p("borderwidth"),p("thickness"),p("autorange",!s.isValidRange(i.range)),p("range");var m=r._subplots;if(m)for(var l=m.cartesian.filter(function(T){return T.substr(0,T.indexOf("y"))===S.name2id(t)}).map(function(T){return T.substr(T.indexOf("y"),T.length)}),w=A.simpleMap(l,S.id2name),_=0;_<w.length;_++){var c=w[_];v=i[c]||{},f=g.newContainer(x,c,"yaxis");var b=r[c],u;v.range&&b.isValidRange(v.range)&&(u="fixed");var L=d("rangemode",u);L!=="match"&&d("range",b.range.slice())}x._input=i}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../registry"),S=y("../../plots/plots"),M=y("../../lib"),e=M.strTranslate,a=y("../drawing"),n=y("../color"),r=y("../titles"),t=y("../../plots/cartesian"),h=y("../../plots/cartesian/axis_ids"),s=y("../dragelement"),i=y("../../lib/setcursor"),x=y("./constants");ee.exports=function(b){for(var u=b._fullLayout,L=u._rangeSliderData,T=0;T<L.length;T++){var k=L[T][x.name];k._clipId=k._id+"-"+u._uid}function P(I){return I._name}var z=u._infolayer.selectAll("g."+x.containerClassName).data(L,P);z.exit().each(function(I){var D=I[x.name];u._topdefs.select("#"+D._clipId).remove()}).remove(),L.length!==0&&(z.enter().append("g").classed(x.containerClassName,!0).attr("pointer-events","all"),z.each(function(I){var D=A.select(this),R=I[x.name],O=u[h.id2name(I.anchor)],F=R[h.id2name(I.anchor)];if(R.range){var N=M.simpleMap(R.range,I.r2l),G=M.simpleMap(I.range,I.r2l),K;G[0]<G[1]?K=[Math.min(N[0],G[0]),Math.max(N[1],G[1])]:K=[Math.max(N[0],G[0]),Math.min(N[1],G[1])],R.range=R._input.range=M.simpleMap(K,I.l2r)}I.cleanRange("rangeslider.range");var W=u._size,Y=I.domain;R._width=W.w*(Y[1]-Y[0]);var re=Math.round(W.l+W.w*Y[0]),ue=Math.round(W.t+W.h*(1-I._counterDomainMin)+(I.side==="bottom"?I._depth:0)+R._offsetShift+x.extraPad);D.attr("transform",e(re,ue)),R._rl=M.simpleMap(R.range,I.r2l);var j=R._rl[0],q=R._rl[1],H=q-j;if(R.p2d=function(be){return be/R._width*H+j},R.d2p=function(be){return(be-j)/H*R._width},I.rangebreaks){var U=I.locateBreaks(j,q);if(U.length){var $,ne,X=0;for($=0;$<U.length;$++)ne=U[$],X+=ne.max-ne.min;var Q=R._width/(q-j-X),ie=[-Q*j];for($=0;$<U.length;$++)ne=U[$],ie.push(ie[ie.length-1]-Q*(ne.max-ne.min));for(R.d2p=function(be){for(var ce=ie[0],de=0;de<U.length;de++){var ye=U[de];if(be>=ye.max)ce=ie[de+1];else if(be<ye.min)break}return ce+Q*be},$=0;$<U.length;$++)ne=U[$],ne.pmin=R.d2p(ne.min),ne.pmax=R.d2p(ne.max);R.p2d=function(be){for(var ce=ie[0],de=0;de<U.length;de++){var ye=U[de];if(be>=ye.pmax)ce=ie[de+1];else if(be<ye.pmin)break}return(be-ce)/Q}}}if(F.rangemode!=="match"){var se=O.r2l(F.range[0]),ae=O.r2l(F.range[1]),oe=ae-se;R.d2pOppAxis=function(be){return(be-se)/oe*R._height}}D.call(d,b,I,R).call(o,b,I,R).call(m,b,I,R).call(w,b,I,R,F).call(_,b,I,R).call(c,b,I,R),p(D,b,I,R),f(D,b,I,R,O,F),I.side==="bottom"&&r.draw(b,I._id+"title",{propContainer:I,propName:I._name+".title",placeholder:u._dfltTitle.x,attributes:{x:I._offset+I._length/2,y:ue+R._height+R._offsetShift+10+1.5*I.title.font.size,"text-anchor":"middle"}})}))};function p(b,u,L,T){if(u._context.staticPlot)return;var k=b.select("rect."+x.slideBoxClassName).node(),P=b.select("rect."+x.grabAreaMinClassName).node(),z=b.select("rect."+x.grabAreaMaxClassName).node();function I(){var D=A.event,R=D.target,O=D.clientX||D.touches[0].clientX,F=O-b.node().getBoundingClientRect().left,N=T.d2p(L._rl[0]),G=T.d2p(L._rl[1]),K=s.coverSlip();this.addEventListener("touchmove",W),this.addEventListener("touchend",Y),K.addEventListener("mousemove",W),K.addEventListener("mouseup",Y);function W(re){var ue=re.clientX||re.touches[0].clientX,j=+ue-O,q,H,U;switch(R){case k:U="ew-resize",q=N+j,H=G+j;break;case P:U="col-resize",q=N+j,H=G;break;case z:U="col-resize",q=N,H=G+j;break;default:U="ew-resize",q=F,H=F+j;break}if(H<q){var $=H;H=q,q=$}T._pixelMin=q,T._pixelMax=H,i(A.select(K),U),v(b,u,L,T)}function Y(){K.removeEventListener("mousemove",W),K.removeEventListener("mouseup",Y),this.removeEventListener("touchmove",W),this.removeEventListener("touchend",Y),M.removeElement(K)}}b.on("mousedown",I),b.on("touchstart",I)}function v(b,u,L,T){function k(I){return L.l2r(M.constrain(I,T._rl[0],T._rl[1]))}var P=k(T.p2d(T._pixelMin)),z=k(T.p2d(T._pixelMax));window.requestAnimationFrame(function(){g.call("_guiRelayout",u,L._name+".range",[P,z])})}function f(b,u,L,T,k,P){var z=x.handleWidth/2;function I(re){return M.constrain(re,0,T._width)}function D(re){return M.constrain(re,0,T._height)}function R(re){return M.constrain(re,-z,T._width+z)}var O=I(T.d2p(L._rl[0])),F=I(T.d2p(L._rl[1]));if(b.select("rect."+x.slideBoxClassName).attr("x",O).attr("width",F-O),b.select("rect."+x.maskMinClassName).attr("width",O),b.select("rect."+x.maskMaxClassName).attr("x",F).attr("width",T._width-F),P.rangemode!=="match"){var N=T._height-D(T.d2pOppAxis(k._rl[1])),G=T._height-D(T.d2pOppAxis(k._rl[0]));b.select("rect."+x.maskMinOppAxisClassName).attr("x",O).attr("height",N).attr("width",F-O),b.select("rect."+x.maskMaxOppAxisClassName).attr("x",O).attr("y",G).attr("height",T._height-G).attr("width",F-O),b.select("rect."+x.slideBoxClassName).attr("y",N).attr("height",G-N)}var K=.5,W=Math.round(R(O-z))-K,Y=Math.round(R(F-z))+K;b.select("g."+x.grabberMinClassName).attr("transform",e(W,K)),b.select("g."+x.grabberMaxClassName).attr("transform",e(Y,K))}function d(b,u,L,T){var k=M.ensureSingle(b,"rect",x.bgClassName,function(D){D.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),P=T.borderwidth%2===0?T.borderwidth:T.borderwidth-1,z=-T._offsetShift,I=a.crispRound(u,T.borderwidth);k.attr({width:T._width+P,height:T._height+P,transform:e(z,z),"stroke-width":I}).call(n.stroke,T.bordercolor).call(n.fill,T.bgcolor)}function o(b,u,L,T){var k=u._fullLayout,P=M.ensureSingleById(k._topdefs,"clipPath",T._clipId,function(z){z.append("rect").attr({x:0,y:0})});P.select("rect").attr({width:T._width,height:T._height})}function m(b,u,L,T){var k=u.calcdata,P=b.selectAll("g."+x.rangePlotClassName).data(L._subplotsWith,M.identity);P.enter().append("g").attr("class",function(I){return x.rangePlotClassName+" "+I}).call(a.setClipUrl,T._clipId,u),P.order(),P.exit().remove();var z;P.each(function(I,D){var R=A.select(this),O=D===0,F=h.getFromId(u,I,"y"),N=F._name,G=T[N],K={data:[],layout:{xaxis:{type:L.type,domain:[0,1],range:T.range.slice(),calendar:L.calendar},width:T._width,height:T._height,margin:{t:0,b:0,l:0,r:0}},_context:u._context};L.rangebreaks&&(K.layout.xaxis.rangebreaks=L.rangebreaks),K.layout[N]={type:F.type,domain:[0,1],range:G.rangemode!=="match"?G.range.slice():F.range.slice(),calendar:F.calendar},F.rangebreaks&&(K.layout[N].rangebreaks=F.rangebreaks),S.supplyDefaults(K);var W=K._fullLayout.xaxis,Y=K._fullLayout[N];W.clearCalc(),W.setScale(),Y.clearCalc(),Y.setScale();var re={id:I,plotgroup:R,xaxis:W,yaxis:Y,isRangePlot:!0};O?z=re:(re.mainplot="xy",re.mainplotinfo=z),t.rangePlot(u,re,l(k,I))})}function l(b,u){for(var L=[],T=0;T<b.length;T++){var k=b[T],P=k[0].trace;P.xaxis+P.yaxis===u&&L.push(k)}return L}function w(b,u,L,T,k){var P=M.ensureSingle(b,"rect",x.maskMinClassName,function(R){R.attr({x:0,y:0,"shape-rendering":"crispEdges"})});P.attr("height",T._height).call(n.fill,x.maskColor);var z=M.ensureSingle(b,"rect",x.maskMaxClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});if(z.attr("height",T._height).call(n.fill,x.maskColor),k.rangemode!=="match"){var I=M.ensureSingle(b,"rect",x.maskMinOppAxisClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});I.attr("width",T._width).call(n.fill,x.maskOppAxisColor);var D=M.ensureSingle(b,"rect",x.maskMaxOppAxisClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});D.attr("width",T._width).style("border-top",x.maskOppBorder).call(n.fill,x.maskOppAxisColor)}}function _(b,u,L,T){if(!u._context.staticPlot){var k=M.ensureSingle(b,"rect",x.slideBoxClassName,function(P){P.attr({y:0,cursor:x.slideBoxCursor,"shape-rendering":"crispEdges"})});k.attr({height:T._height,fill:x.slideBoxFill})}}function c(b,u,L,T){var k=M.ensureSingle(b,"g",x.grabberMinClassName),P=M.ensureSingle(b,"g",x.grabberMaxClassName),z={x:0,width:x.handleWidth,rx:x.handleRadius,fill:n.background,stroke:n.defaultLine,"stroke-width":x.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(T._height/4),height:Math.round(T._height/2)},D=M.ensureSingle(k,"rect",x.handleMinClassName,function(G){G.attr(z)});D.attr(I);var R=M.ensureSingle(P,"rect",x.handleMaxClassName,function(G){G.attr(z)});R.attr(I);var O={width:x.grabAreaWidth,x:0,y:0,fill:x.grabAreaFill,cursor:u._context.staticPlot?void 0:x.grabAreaCursor},F=M.ensureSingle(k,"rect",x.grabAreaMinClassName,function(G){G.attr(O)});F.attr("height",T._height);var N=M.ensureSingle(P,"rect",x.grabAreaMaxClassName,function(G){G.attr(O)});N.attr("height",T._height)}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(y,ee,te){var A=y("../../plots/cartesian/axis_ids"),g=y("../../lib/svg_text_utils"),S=y("./constants"),M=y("../../constants/alignment").LINE_SPACING,e=S.name;function a(n){var r=n&&n[e];return r&&r.visible}te.isVisible=a,te.makeData=function(n){var r=A.list({_fullLayout:n},"x",!0),t=n.margin,h=[];if(!n._has("gl2d"))for(var s=0;s<r.length;s++){var i=r[s];if(a(i)){h.push(i);var x=i[e];x._id=e+i._id,x._height=(n.height-t.b-t.t)*x.thickness,x._offsetShift=Math.floor(x.borderwidth/2)}}n._rangeSliderData=h},te.autoMarginOpts=function(n,r){var t=n._fullLayout,h=r[e],s=r._id.charAt(0),i=0,x=0;if(r.side==="bottom"&&(i=r._depth,r.title.text!==t._dfltTitle[s])){x=1.5*r.title.font.size+10+h._offsetShift;var p=(r.title.text.match(g.BR_TAG_ALL)||[]).length;x+=p*r.title.font.size*M}return{x:0,y:r._counterDomainMin,l:0,r:0,t:0,b:h._height+i+Math.max(t.margin.b,x),pad:S.extraPad+h._offsetShift*2}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("./oppaxis_attributes"),M=y("./helpers");ee.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:A.extendFlat({},g,{yaxis:S})}}},layoutAttributes:y("./attributes"),handleDefaults:y("./defaults"),calcAutorange:y("./calc_autorange"),draw:y("./draw"),isVisible:M.isVisible,makeData:M.makeData,autoMarginOpts:M.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(y,ee,te){ee.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(y,ee,te){var A=y("../annotations/attributes"),g=y("../../traces/scatter/attributes").line,S=y("../drawing/attributes").dash,M=y("../../lib/extend").extendFlat,e=y("../../plot_api/edit_types").overrideAll,a=y("../../plot_api/plot_template").templatedArray;y("../../constants/axis_placeable_objects"),ee.exports=e(a("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:M({},A.xref,{}),yref:M({},A.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:g.color,width:M({},g.width,{min:1,dflt:1}),dash:M({},S,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(y,ee,te){ee.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("../../plots/array_container_defaults"),M=y("./attributes"),e=y("../shapes/helpers");ee.exports=function(r,t){S(r,t,{name:"selections",handleItemDefaults:a});for(var h=t.selections,s=0;s<h.length;s++){var i=h[s];i&&i.path===void 0&&(i.x0===void 0||i.x1===void 0||i.y0===void 0||i.y1===void 0)&&(t.selections[s]=null)}};function a(n,r,t){function h(P,z){return A.coerce(n,r,M,P,z)}var s=h("path"),i=s?"path":"rect",x=h("type",i),p=x!=="path";p&&delete r.path,h("opacity"),h("line.color"),h("line.width"),h("line.dash");for(var v=["x","y"],f=0;f<2;f++){var d=v[f],o={_fullLayout:t},m,l,w,_=g.coerceRef(n,r,o,d);if(m=g.getFromId(o,_),m._selectionIndices.push(r._index),w=e.rangeToShapePosition(m),l=e.shapePositionToRange(m),p){var c=d+"0",b=d+"1",u=n[c],L=n[b];n[c]=l(n[c],!0),n[b]=l(n[b],!0),g.coercePosition(r,o,h,_,c),g.coercePosition(r,o,h,_,b);var T=r[c],k=r[b];T!==void 0&&k!==void 0&&(r[c]=w(T),r[b]=w(k),n[c]=u,n[b]=L)}}p&&A.noneOrAll(n,r,["x0","x1","y0","y1"])}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(y,ee,te){var A=y("../shapes/draw_newshape/helpers").readPaths,g=y("../shapes/display_outlines"),S=y("../shapes/handle_outline").clearOutlineControllers,M=y("../color"),e=y("../drawing"),a=y("../../plot_api/plot_template").arrayEditor,n=y("../shapes/helpers"),r=n.getPathString;ee.exports={draw:t,drawOne:s,activateLastSelection:p};function t(f){var d=f._fullLayout;S(f),d._selectionLayer.selectAll("path").remove();for(var o in d._plots){var m=d._plots[o].selectionLayer;m&&m.selectAll("path").remove()}for(var l=0;l<d.selections.length;l++)s(f,l)}function h(f){return f._context.editSelection}function s(f,d){f._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+d+'"]').remove();var o=n.makeSelectionsOptionsAndPlotinfo(f,d),m=o.options,l=o.plotinfo;if(!m._input)return;w(f._fullLayout._selectionLayer);function w(_){var c=r(f,m),b={"data-index":d,"fill-rule":"evenodd",d:c},u=m.opacity,L="rgba(0,0,0,0)",T=m.line.color||M.contrast(f._fullLayout.plot_bgcolor),k=m.line.width,P=m.line.dash;k||(k=5,P="solid");var z=h(f)&&f._fullLayout._activeSelectionIndex===d;z&&(L=f._fullLayout.activeselection.fillcolor,u=f._fullLayout.activeselection.opacity);for(var I=[],D=1;D>=0;D--){var R=_.append("path").attr(b).style("opacity",D?.1:u).call(M.stroke,T).call(M.fill,L).call(e.dashLine,D?"solid":P,D?4+k:k);if(i(R,f,m),z){var O=a(f.layout,"selections",m);R.style({cursor:"move"});var F={element:R.node(),plotinfo:l,gd:f,editHelpers:O,isActiveSelection:!0},N=A(c,f);g(N,R,F)}else R.style("pointer-events",D?"all":"none");I[D]=R}var G=I[0],K=I[1];K.node().addEventListener("click",function(){return x(f,G)})}}function i(f,d,o){var m=o.xref+o.yref;e.setClipUrl(f,"clip"+d._fullLayout._uid+m,d)}function x(f,d){if(h(f)){var o=d.node(),m=+o.getAttribute("data-index");if(m>=0){if(m===f._fullLayout._activeSelectionIndex){v(f);return}f._fullLayout._activeSelectionIndex=m,f._fullLayout._deactivateSelection=v,t(f)}}}function p(f){if(h(f)){var d=f._fullLayout.selections.length-1;f._fullLayout._activeSelectionIndex=d,f._fullLayout._deactivateSelection=v,t(f)}}function v(f){if(h(f)){var d=f._fullLayout._activeSelectionIndex;d>=0&&(S(f),delete f._fullLayout._activeSelectionIndex,t(f))}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(y,ee,te){var A=y("../../drawing/attributes").dash,g=y("../../../lib/extend").extendFlat;ee.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:g({},A,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(y,ee,te){ee.exports=function(g,S,M){M("newselection.mode");var e=M("newselection.line.width");e&&(M("newselection.line.color"),M("newselection.line.dash")),M("activeselection.fillcolor"),M("activeselection.opacity")}},{}],453:[function(y,ee,te){var A=y("../../dragelement/helpers"),g=A.selectMode,S=y("../../shapes/handle_outline"),M=S.clearOutline,e=y("../../shapes/draw_newshape/helpers"),a=e.readPaths,n=e.writePaths,r=e.fixDatesForPaths;ee.exports=function(h,s){if(h.length){var i=h[0][0];if(i){var x=i.getAttribute("d"),p=s.gd,v=p._fullLayout.newselection,f=s.plotinfo,d=f.xaxis,o=f.yaxis,m=s.isActiveSelection,l=s.dragmode,w=(p.layout||{}).selections||[];if(!g(l)&&m!==void 0){var _=p._fullLayout._activeSelectionIndex;if(_<w.length)switch(p._fullLayout.selections[_].type){case"rect":l="select";break;case"path":l="lasso";break}}var c=a(x,p,f,m),b={xref:d._id,yref:o._id,opacity:v.opacity,line:{color:v.line.color,width:v.line.width,dash:v.line.dash}},u;c.length===1&&(u=c[0]),u&&u.length===5&&l==="select"?(b.type="rect",b.x0=u[0][1],b.y0=u[0][2],b.x1=u[2][1],b.y1=u[2][2]):(b.type="path",d&&o&&r(c,d,o),b.path=n(c),u=null),M(p);for(var L=s.editHelpers,T=(L||{}).modifyItem,k=[],P=0;P<w.length;P++){var z=p._fullLayout.selections[P];if(!z){k[P]=z;continue}if(k[P]=z._input,m!==void 0&&P===p._fullLayout._activeSelectionIndex){var I=b;switch(z.type){case"rect":T("x0",I.x0),T("x1",I.x1),T("y0",I.y0),T("y1",I.y1);break;case"path":T("path",I.path);break}}}return m===void 0?(k.push(b),k):L?L.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(y,ee,te){var A=y("../../lib").strTranslate;function g(a,n){switch(a.type){case"log":return a.p2d(n);case"date":return a.p2r(n,0,a.calendar);default:return a.p2r(n)}}function S(a,n){switch(a.type){case"log":return a.d2p(n);case"date":return a.r2p(n,0,a.calendar);default:return a.r2p(n)}}function M(a){var n=a._id.charAt(0)==="y"?1:0;return function(r){return g(a,r[n])}}function e(a){return A(a.xaxis._offset,a.yaxis._offset)}ee.exports={p2r:g,r2p:S,axValue:M,getTransform:e}},{"../../lib":515}],455:[function(y,ee,te){var A=y("./draw"),g=y("./select");ee.exports={moduleType:"component",name:"selections",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),supplyDrawNewSelectionDefaults:y("./draw_newselection/defaults"),includeBasePlot:y("../../plots/cartesian/include_components")("selections"),draw:A.draw,drawOne:A.drawOne,reselect:g.reselect,prepSelect:g.prepSelect,clearOutline:g.clearOutline,clearSelectionsCache:g.clearSelectionsCache,selectOnClick:g.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(y,ee,te){var A=y("polybooljs"),g=y("point-in-polygon/nested"),S=y("../../registry"),M=y("../drawing").dashStyle,e=y("../color"),a=y("../fx"),n=y("../fx/helpers").makeEventData,r=y("../dragelement/helpers"),t=r.freeMode,h=r.rectMode,s=r.drawMode,i=r.openMode,x=r.selectMode,p=y("../shapes/helpers"),v=y("../shapes/constants"),f=y("../shapes/display_outlines"),d=y("../shapes/handle_outline").clearOutline,o=y("../shapes/draw_newshape/helpers"),m=o.handleEllipse,l=o.readPaths,w=y("../shapes/draw_newshape/newshapes"),_=y("./draw_newselection/newselections"),c=y("./draw").activateLastSelection,b=y("../../lib"),u=b.sorterAsc,L=y("../../lib/polygon"),T=y("../../lib/throttle"),k=y("../../plots/cartesian/axis_ids").getFromId,P=y("../../lib/clear_gl_canvases"),z=y("../../plot_api/subroutines").redrawReglTraces,I=y("./constants"),D=I.MINSELECT,R=L.filter,O=L.tester,F=y("./helpers"),N=F.p2r,G=F.axValue,K=F.getTransform;function W(Ge){return Ge.subplot!==void 0}function Y(Ge,tt,He,Ae,Ne){var Ze=!W(Ae),Qe=t(Ne),bt=h(Ne),dt=i(Ne),wt=s(Ne),Ut=x(Ne),Rt=Ne==="drawline",Nt=Ne==="drawcircle",Wt=Rt||Nt,Vt=Ae.gd,ir=Vt._fullLayout,Hr=Ut&&ir.newselection.mode==="immediate"&&Ze,sn=ir._zoomlayer,jr=Ae.element.getBoundingClientRect(),at=Ae.plotinfo,$t=K(at),Jt=tt-jr.left,Gt=He-jr.top;ir._calcInverseTransform(Vt);var _r=b.apply3DTransform(ir._invTransform)(Jt,Gt);Jt=_r[0],Gt=_r[1];var rt=ir._invScaleX,Je=ir._invScaleY,st=Jt,lt=Gt,Tt="M"+Jt+","+Gt,zt=Ae.xaxes[0],Ce=Ae.yaxes[0],Se=zt._length,nt=Ce._length,it=Ge.altKey&&!(s(Ne)&&dt),ct,kt,gt,St,Yt,ar,kr;U(Ge,Vt,Ae),Qe&&(ct=R([[Jt,Gt]],I.BENDPX));var br=sn.selectAll("path.select-outline-"+at.id).data([1]),Mr=wt?ir.newshape:ir.newselection,Yr=wt&&!dt?Mr.fillcolor:"rgba(0,0,0,0)",nr=Mr.line.color||(Ze?e.contrast(Vt._fullLayout.plot_bgcolor):"#7f7f7f");br.enter().append("path").attr("class","select-outline select-outline-"+at.id).style({opacity:wt?Mr.opacity/2:1,"stroke-dasharray":M(Mr.line.dash,Mr.line.width),"stroke-width":Mr.line.width+"px","shape-rendering":"crispEdges"}).call(e.stroke,nr).call(e.fill,Yr).attr("fill-rule","evenodd").classed("cursor-move",!!wt).attr("transform",$t).attr("d",Tt+"Z");var gr=sn.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",$t).attr("d","M0,0Z"),Rr=ir._uid+I.SELECTID,Br=[],Sr=ie(Vt,Ae.xaxes,Ae.yaxes,Ae.subplot);Hr&&!Ge.shiftKey&&(Ae._clearSubplotSelections=function(){if(Ze){var Lt=zt._id,Zt=Ce._id;Ve(Vt,Lt,Zt,Sr);for(var or=(Vt.layout||{}).selections||[],Ir=[],Or=!1,Er=0;Er<or.length;Er++){var wr=ir.selections[Er];wr.xref!==Lt||wr.yref!==Zt?Ir.push(or[Er]):Or=!0}Or&&(Vt._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Vt,{selections:Ir}))}});var et=Mt(Ae);Ae.moveFn=function(Lt,Zt){Ae._clearSubplotSelections&&(Ae._clearSubplotSelections(),Ae._clearSubplotSelections=void 0),st=Math.max(0,Math.min(Se,rt*Lt+Jt)),lt=Math.max(0,Math.min(nt,Je*Zt+Gt));var or=Math.abs(st-Jt),Ir=Math.abs(lt-Gt);if(bt){var Or,Er,wr;if(Ut){var Gr=ir.selectdirection;switch(Gr==="any"?Ir<Math.min(or*.6,D)?Or="h":or<Math.min(Ir*.6,D)?Or="v":Or="d":Or=Gr,Or){case"h":Er=Nt?nt/2:0,wr=nt;break;case"v":Er=Nt?Se/2:0,wr=Se;break}}if(wt)switch(ir.newshape.drawdirection){case"vertical":Or="h",Er=Nt?nt/2:0,wr=nt;break;case"horizontal":Or="v",Er=Nt?Se/2:0,wr=Se;break;case"ortho":or<Ir?(Or="h",Er=Gt,wr=lt):(Or="v",Er=Jt,wr=st);break;default:Or="d"}Or==="h"?(St=Wt?m(Nt,[st,Er],[st,wr]):[[Jt,Er],[Jt,wr],[st,wr],[st,Er]],St.xmin=Wt?st:Math.min(Jt,st),St.xmax=Wt?st:Math.max(Jt,st),St.ymin=Math.min(Er,wr),St.ymax=Math.max(Er,wr),gr.attr("d","M"+St.xmin+","+(Gt-D)+"h-4v"+2*D+"h4ZM"+(St.xmax-1)+","+(Gt-D)+"h4v"+2*D+"h-4Z")):Or==="v"?(St=Wt?m(Nt,[Er,lt],[wr,lt]):[[Er,Gt],[Er,lt],[wr,lt],[wr,Gt]],St.xmin=Math.min(Er,wr),St.xmax=Math.max(Er,wr),St.ymin=Wt?lt:Math.min(Gt,lt),St.ymax=Wt?lt:Math.max(Gt,lt),gr.attr("d","M"+(Jt-D)+","+St.ymin+"v-4h"+2*D+"v4ZM"+(Jt-D)+","+(St.ymax-1)+"v4h"+2*D+"v-4Z")):Or==="d"&&(St=Wt?m(Nt,[Jt,Gt],[st,lt]):[[Jt,Gt],[Jt,lt],[st,lt],[st,Gt]],St.xmin=Math.min(Jt,st),St.xmax=Math.max(Jt,st),St.ymin=Math.min(Gt,lt),St.ymax=Math.max(Gt,lt),gr.attr("d","M0,0Z"))}else Qe&&(ct.addPt([st,lt]),St=ct.filtered);if(Ae.selectionDefs&&Ae.selectionDefs.length?(gt=me(Ae.mergedPolygons,St,it),St.subtract=it,kt=H(Ae.selectionDefs.concat([St]))):(gt=[St],kt=O(St)),f(Pe(gt,dt),br,Ae),Ut){var wn=we(Vt,!1),cn=wn.eventData?wn.eventData.points.slice():[];wn=we(Vt,!1,kt,Sr,Ae),kt=wn.selectionTesters,kr=wn.eventData;var Bn;ct?Bn=ct.filtered:Bn=Dt(gt),T.throttle(Rr,I.SELECTDELAY,function(){Br=Ue(kt,Sr);for(var En=Br.slice(),Yn=0;Yn<cn.length;Yn++){for(var Vn=cn[Yn],pa=!1,Ma=0;Ma<En.length;Ma++)if(En[Ma].curveNumber===Vn.curveNumber&&En[Ma].pointNumber===Vn.pointNumber){pa=!0;break}pa||En.push(Vn)}En.length&&(kr||(kr={}),kr.points=En),et(kr,Bn),Xt(Vt,kr)})}},Ae.clickFn=function(Lt,Zt){if(gr.remove(),Vt._fullLayout._activeShapeIndex>=0){Vt._fullLayout._deactivateShape(Vt);return}if(!wt){var or=ir.clickmode;T.done(Rr).then(function(){if(T.clear(Rr),Lt===2){for(br.remove(),Yt=0;Yt<Sr.length;Yt++)ar=Sr[Yt],ar._module.selectPoints(ar,!1);if(ye(Vt,Sr),X(Ae),At(Vt),Sr.length){var Ir=Sr[0].xaxis,Or=Sr[0].yaxis;if(Ir&&Or){for(var Er=[],wr=Vt._fullLayout.selections,Gr=0;Gr<wr.length;Gr++){var wn=wr[Gr];wn&&(wn.xref!==Ir._id||wn.yref!==Or._id)&&Er.push(wn)}Er.length<wr.length&&(Vt._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Vt,{selections:Er}))}}}else or.indexOf("select")>-1&&re(Zt,Vt,Ae.xaxes,Ae.yaxes,Ae.subplot,Ae,br),or==="event"&&It(Vt,void 0);a.click(Vt,Zt)}).catch(b.error)}},Ae.doneFn=function(){gr.remove(),T.done(Rr).then(function(){T.clear(Rr),!Hr&&St&&Ae.selectionDefs&&(St.subtract=it,Ae.selectionDefs.push(St),Ae.mergedPolygons.length=0,[].push.apply(Ae.mergedPolygons,gt)),(Hr||wt)&&X(Ae,Hr),Ae.doneFnCompleted&&Ae.doneFnCompleted(Br),Ut&&It(Vt,kr)}).catch(b.error)}}function re(Ge,tt,He,Ae,Ne,Ze,Qe){var bt=tt._hoverdata,dt=tt._fullLayout,wt=dt.clickmode,Ut=wt.indexOf("event")>-1,Rt=[],Nt,Wt,Vt,ir,Hr,sn,jr,at,$t,Jt;if(ae(bt)){U(Ge,tt,Ze),Nt=ie(tt,He,Ae,Ne);var Gt=oe(bt,Nt),_r=Gt.pointNumbers.length>0;if(_r?ce(Nt,Gt):de(Nt)&&(jr=be(Gt))){for(Qe&&Qe.remove(),Jt=0;Jt<Nt.length;Jt++)Wt=Nt[Jt],Wt._module.selectPoints(Wt,!1);ye(tt,Nt),X(Ze),Ut&&At(tt)}else{at=Ge.shiftKey&&(jr!==void 0?jr:be(Gt)),Vt=ue(Gt.pointNumber,Gt.searchInfo,at);var rt=Ze.selectionDefs.concat([Vt]);for(ir=H(rt),Jt=0;Jt<Nt.length;Jt++)if(Hr=Nt[Jt]._module.selectPoints(Nt[Jt],ir),sn=Ee(Hr,Nt[Jt]),Rt.length)for(var Je=0;Je<sn.length;Je++)Rt.push(sn[Je]);else Rt=sn;if($t={points:Rt},ye(tt,Nt,$t),Vt&&Ze&&Ze.selectionDefs.push(Vt),Qe){var st=Ze.mergedPolygons,lt=i(Ze.dragmode);f(Pe(st,lt),Qe,Ze)}Ut&&It(tt,$t)}}}function ue(Ge,tt,He){return{pointNumber:Ge,searchInfo:tt,subtract:!!He}}function j(Ge){return"pointNumber"in Ge&&"searchInfo"in Ge}function q(Ge){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(tt,He,Ae,Ne){var Ze=Ge.searchInfo.cd[0].trace._expandedIndex,Qe=Ne.cd[0].trace._expandedIndex;return Qe===Ze&&Ae===Ge.pointNumber},isRect:!1,degenerate:!1,subtract:!!Ge.subtract}}function H(Ge){if(!Ge.length)return;for(var tt=[],He=j(Ge[0])?0:Ge[0][0][0],Ae=He,Ne=j(Ge[0])?0:Ge[0][0][1],Ze=Ne,Qe=0;Qe<Ge.length;Qe++)if(j(Ge[Qe]))tt.push(q(Ge[Qe]));else{var bt=O(Ge[Qe]);bt.subtract=!!Ge[Qe].subtract,tt.push(bt),He=Math.min(He,bt.xmin),Ae=Math.max(Ae,bt.xmax),Ne=Math.min(Ne,bt.ymin),Ze=Math.max(Ze,bt.ymax)}function dt(wt,Ut,Rt,Nt){for(var Wt=!1,Vt=0;Vt<tt.length;Vt++)tt[Vt].contains(wt,Ut,Rt,Nt)&&(Wt=!tt[Vt].subtract);return Wt}return{xmin:He,xmax:Ae,ymin:Ne,ymax:Ze,pts:[],contains:dt,isRect:!1,degenerate:!1}}function U(Ge,tt,He){var Ae=tt._fullLayout,Ne=He.plotinfo,Ze=He.dragmode,Qe=Ae._lastSelectedSubplot&&Ae._lastSelectedSubplot===Ne.id,bt=(Ge.shiftKey||Ge.altKey)&&!(s(Ze)&&i(Ze));Qe&&bt&&Ne.selection&&Ne.selection.selectionDefs&&!He.selectionDefs?(He.selectionDefs=Ne.selection.selectionDefs,He.mergedPolygons=Ne.selection.mergedPolygons):(!bt||!Ne.selection)&&X(He),Qe||(d(tt),Ae._lastSelectedSubplot=Ne.id)}function $(Ge){return Ge._fullLayout._activeShapeIndex>=0}function ne(Ge){return Ge._fullLayout._activeSelectionIndex>=0}function X(Ge,tt){var He=Ge.dragmode,Ae=Ge.plotinfo,Ne=Ge.gd;$(Ne)&&Ne._fullLayout._deactivateShape(Ne),ne(Ne)&&Ne._fullLayout._deactivateSelection(Ne);var Ze=Ne._fullLayout,Qe=Ze._zoomlayer,bt=s(He),dt=x(He);if(bt||dt){var wt=Qe.selectAll(".select-outline-"+Ae.id);if(wt&&Ne._fullLayout._outlining){var Ut;bt&&(Ut=w(wt,Ge)),Ut&&S.call("_guiRelayout",Ne,{shapes:Ut});var Rt;dt&&!W(Ge)&&(Rt=_(wt,Ge)),Rt&&(Ne._fullLayout._noEmitSelectedAtStart=!0,S.call("_guiRelayout",Ne,{selections:Rt}).then(function(){tt&&c(Ne)})),Ne._fullLayout._outlining=!1}}Ae.selection={},Ae.selection.selectionDefs=Ge.selectionDefs=[],Ae.selection.mergedPolygons=Ge.mergedPolygons=[]}function Q(Ge){return Ge._id}function ie(Ge,tt,He,Ae){if(!Ge.calcdata)return[];var Ne=[],Ze=tt.map(Q),Qe=He.map(Q),bt,dt,wt;for(wt=0;wt<Ge.calcdata.length;wt++)if(bt=Ge.calcdata[wt],dt=bt[0].trace,!(dt.visible!==!0||!dt._module||!dt._module.selectPoints))if(W({subplot:Ae})&&(dt.subplot===Ae||dt.geo===Ae))Ne.push(se(dt._module,bt,tt[0],He[0]));else if(dt.type==="splom"){if(dt._xaxes[Ze[0]]&&dt._yaxes[Qe[0]]){var Ut=se(dt._module,bt,tt[0],He[0]);Ut.scene=Ge._fullLayout._splomScenes[dt.uid],Ne.push(Ut)}}else if(dt.type==="sankey"){var Rt=se(dt._module,bt,tt[0],He[0]);Ne.push(Rt)}else{if(Ze.indexOf(dt.xaxis)===-1||Qe.indexOf(dt.yaxis)===-1)continue;Ne.push(se(dt._module,bt,k(Ge,dt.xaxis),k(Ge,dt.yaxis)))}return Ne}function se(Ge,tt,He,Ae){return{_module:Ge,cd:tt,xaxis:He,yaxis:Ae}}function ae(Ge){return Ge&&Array.isArray(Ge)&&Ge[0].hoverOnBox!==!0}function oe(Ge,tt){var He=Ge[0],Ae=-1,Ne=[],Ze,Qe;for(Qe=0;Qe<tt.length;Qe++)if(Ze=tt[Qe],He.fullData._expandedIndex===Ze.cd[0].trace._expandedIndex){if(He.hoverOnBox===!0)break;He.pointNumber!==void 0?Ae=He.pointNumber:He.binNumber!==void 0&&(Ae=He.binNumber,Ne=He.pointNumbers);break}return{pointNumber:Ae,pointNumbers:Ne,searchInfo:Ze}}function be(Ge){var tt=Ge.searchInfo.cd[0].trace,He=Ge.pointNumber,Ae=Ge.pointNumbers,Ne=Ae.length>0,Ze=Ne?Ae[0]:He;return tt.selectedpoints?tt.selectedpoints.indexOf(Ze)>-1:!1}function ce(Ge,tt){var He=[],Ae,Ne,Ze,Qe;for(Qe=0;Qe<Ge.length;Qe++)Ae=Ge[Qe],Ae.cd[0].trace.selectedpoints&&Ae.cd[0].trace.selectedpoints.length>0&&He.push(Ae);if(He.length===1&&(Ze=He[0]===tt.searchInfo,Ze&&(Ne=tt.searchInfo.cd[0].trace,Ne.selectedpoints.length===tt.pointNumbers.length))){for(Qe=0;Qe<tt.pointNumbers.length;Qe++)if(Ne.selectedpoints.indexOf(tt.pointNumbers[Qe])<0)return!1;return!0}return!1}function de(Ge){var tt=0,He,Ae,Ne;for(Ne=0;Ne<Ge.length;Ne++)if(He=Ge[Ne],Ae=He.cd[0].trace,Ae.selectedpoints&&(Ae.selectedpoints.length>1||(tt+=Ae.selectedpoints.length,tt>1)))return!1;return tt===1}function ye(Ge,tt,He){var Ae;for(Ae=0;Ae<tt.length;Ae++){var Ne=tt[Ae].cd[0].trace._fullInput,Ze=Ge._fullLayout._tracePreGUI[Ne.uid]||{};Ze.selectedpoints===void 0&&(Ze.selectedpoints=Ne._input.selectedpoints||null)}var Qe;if(He){var bt=He.points||[];for(Ae=0;Ae<tt.length;Ae++)Qe=tt[Ae].cd[0].trace,Qe._input.selectedpoints=Qe._fullInput.selectedpoints=[],Qe._fullInput!==Qe&&(Qe.selectedpoints=[]);for(var dt=0;dt<bt.length;dt++){var wt=bt[dt],Ut=wt.data,Rt=wt.fullData,Nt=wt.pointIndex,Wt=wt.pointIndices;Wt?([].push.apply(Ut.selectedpoints,Wt),Qe._fullInput!==Qe&&[].push.apply(Rt.selectedpoints,Wt)):(Ut.selectedpoints.push(Nt),Qe._fullInput!==Qe&&Rt.selectedpoints.push(Nt))}}else for(Ae=0;Ae<tt.length;Ae++)Qe=tt[Ae].cd[0].trace,delete Qe.selectedpoints,delete Qe._input.selectedpoints,Qe._fullInput!==Qe&&delete Qe._fullInput.selectedpoints;ge(Ge,tt)}function ge(Ge,tt){for(var He=!1,Ae=0;Ae<tt.length;Ae++){var Ne=tt[Ae],Ze=Ne.cd;S.traceIs(Ze[0].trace,"regl")&&(He=!0);var Qe=Ne._module,bt=Qe.styleOnSelect||Qe.style;bt&&(bt(Ge,Ze,Ze[0].node3),Ze[0].nodeRangePlot3&&bt(Ge,Ze,Ze[0].nodeRangePlot3))}He&&(P(Ge),z(Ge))}function me(Ge,tt,He){for(var Ae=He?A.difference:A.union,Ne=Ae({regions:Ge},{regions:[tt]}),Ze=Ne.regions.reverse(),Qe=0;Qe<Ze.length;Qe++){var bt=Ze[Qe];bt.subtract=Ye(bt,Ze.slice(0,Qe))}return Ze}function Ee(Ge,tt){if(Array.isArray(Ge))for(var He=tt.cd,Ae=tt.cd[0].trace,Ne=0;Ne<Ge.length;Ne++)Ge[Ne]=n(Ge[Ne],Ae,He);return Ge}function Pe(Ge,tt){for(var He=[],Ae=0;Ae<Ge.length;Ae++){He[Ae]=[];for(var Ne=0;Ne<Ge[Ae].length;Ne++){He[Ae][Ne]=[],He[Ae][Ne][0]=Ne?"L":"M";for(var Ze=0;Ze<Ge[Ae][Ne].length;Ze++)He[Ae][Ne].push(Ge[Ae][Ne][Ze])}tt||He[Ae].push(["Z",He[Ae][0][1],He[Ae][0][2]])}return He}function Ue(Ge,tt){for(var He=[],Ae,Ne,Ze=0;Ze<tt.length;Ze++){var Qe=tt[Ze];Ne=Qe._module.selectPoints(Qe,Ge),Ae=Ee(Ne,Qe),He=He.concat(Ae)}return He}function we(Ge,tt,He,Ae,Ne){var Ze=!!Ae,Qe,bt,dt;Ne&&(Qe=Ne.plotinfo,bt=Ne.xaxes[0]._id,dt=Ne.yaxes[0]._id);var wt=[],Ut=[],Rt=De(Ge),Nt=Ge._fullLayout;if(Qe){var Wt=Nt._zoomlayer,Vt=Nt.dragmode,ir=s(Vt),Hr=x(Vt);if(ir||Hr){var sn=k(Ge,bt,"x"),jr=k(Ge,dt,"y");if(sn&&jr){var at=Wt.selectAll(".select-outline-"+Qe.id);if(at&&Ge._fullLayout._outlining&&at.length){for(var $t=at[0][0],Jt=$t.getAttribute("d"),Gt=l(Jt,Ge,Qe),_r=[],rt=0;rt<Gt.length;rt++){for(var Je=Gt[rt],st=[],lt=0;lt<Je.length;lt++)st.push([vt(sn,Je[lt][1]),vt(jr,Je[lt][2])]);st.xref=bt,st.yref=dt,st.subtract=Ye(st,_r),_r.push(st)}Rt=Rt.concat(_r)}}}}var Tt=bt&&dt?[bt+dt]:Nt._subplots.cartesian;ke(Ge);for(var zt={},Ce=0;Ce<Tt.length;Ce++){var Se=Tt[Ce],nt=Se.indexOf("y"),it=Se.slice(0,nt),ct=Se.slice(nt),kt=bt&&dt?He:void 0;if(kt=Ie(Rt,it,ct,kt),kt){var gt=Ae;if(!Ze){var St=k(Ge,it,"x"),Yt=k(Ge,ct,"y");gt=ie(Ge,[St],[Yt],Se);for(var ar=0;ar<gt.length;ar++){var kr=gt[ar],br=kr.cd[0],Mr=br.trace;if(kr._module.name==="scattergl"&&!br.t.xpx){var Yr=Mr.x,nr=Mr.y,gr=Mr._length;br.t.xpx=[],br.t.ypx=[];for(var Rr=0;Rr<gr;Rr++)br.t.xpx[Rr]=St.c2p(Yr[Rr]),br.t.ypx[Rr]=Yt.c2p(nr[Rr])}kr._module.name==="splom"&&(zt[Mr.uid]||(zt[Mr.uid]=!0))}}var Br=Ue(kt,gt);wt=wt.concat(Br),Ut=Ut.concat(gt)}}var Sr={points:wt};ye(Ge,Ut,Sr);var et=Nt.clickmode,Lt=et.indexOf("event")>-1&&tt;if(!Qe&&tt){var Zt=De(Ge,!0);if(Zt.length){var or=Zt[0].xref,Ir=Zt[0].yref;if(or&&Ir){var Or=Dt(Zt),Er=Ft([k(Ge,or,"x"),k(Ge,Ir,"y")]);Er(Sr,Or)}}Ge._fullLayout._noEmitSelectedAtStart?Ge._fullLayout._noEmitSelectedAtStart=!1:Lt&&It(Ge,Sr),Nt._reselect=!1}if(!Qe&&Nt._deselect){var wr=Nt._deselect;bt=wr.xref,dt=wr.yref,Xe(bt,dt,Ut)||Ve(Ge,bt,dt,Ae),Lt&&(Sr.points.length?It(Ge,Sr):At(Ge)),Nt._deselect=!1}return{eventData:Sr,selectionTesters:He}}function ke(Ge){var tt=Ge.calcdata;if(tt)for(var He=0;He<tt.length;He++){var Ae=tt[He][0],Ne=Ae.trace,Ze=Ge._fullLayout._splomScenes;if(Ze){var Qe=Ze[Ne.uid];Qe&&(Qe.selectBatch=[])}}}function Xe(Ge,tt,He){for(var Ae=0;Ae<He.length;Ae++){var Ne=He[Ae];if(Ne.xaxis&&Ne.xaxis._id===Ge&&Ne.yaxis&&Ne.yaxis._id===tt)return!0}return!1}function Ve(Ge,tt,He,Ae){Ae=ie(Ge,[k(Ge,tt,"x")],[k(Ge,He,"y")],tt+He);for(var Ne=0;Ne<Ae.length;Ne++){var Ze=Ae[Ne];Ze._module.selectPoints(Ze,!1)}ye(Ge,Ae)}function Ie(Ge,tt,He,Ae){for(var Ne,Ze=0;Ze<Ge.length;Ze++){var Qe=Ge[Ze];if(!(tt!==Qe.xref||He!==Qe.yref))if(Ne){var bt=!!Qe.subtract;Ne=me(Ne,Qe,bt),Ae=H(Ne)}else Ne=[Qe],Ae=O(Qe)}return Ae}function De(Ge,tt){for(var He=[],Ae=Ge._fullLayout,Ne=Ae.selections,Ze=Ne.length,Qe=0;Qe<Ze;Qe++)if(!(tt&&Qe!==Ae._activeSelectionIndex)){var bt=Ne[Qe];if(bt){var dt=bt.xref,wt=bt.yref,Ut=k(Ge,dt,"x"),Rt=k(Ge,wt,"y"),Nt,Wt,Vt,ir,Hr;if(bt.type==="rect"){Hr=[];var sn=vt(Ut,bt.x0),jr=vt(Ut,bt.x1),at=vt(Rt,bt.y0),$t=vt(Rt,bt.y1);Hr=[[sn,at],[sn,$t],[jr,$t],[jr,at]],Nt=Math.min(sn,jr),Wt=Math.max(sn,jr),Vt=Math.min(at,$t),ir=Math.max(at,$t),Hr.xmin=Nt,Hr.xmax=Wt,Hr.ymin=Vt,Hr.ymax=ir,Hr.xref=dt,Hr.yref=wt,Hr.subtract=!1,Hr.isRect=!0,He.push(Hr)}else if(bt.type==="path")for(var Jt=bt.path.split("Z"),Gt=[],_r=0;_r<Jt.length;_r++){var rt=Jt[_r];if(rt){rt+="Z";var Je=p.extractPathCoords(rt,v.paramIsX,"raw"),st=p.extractPathCoords(rt,v.paramIsY,"raw");Nt=1/0,Wt=-1/0,Vt=1/0,ir=-1/0,Hr=[];for(var lt=0;lt<Je.length;lt++){var Tt=vt(Ut,Je[lt]),zt=vt(Rt,st[lt]);Hr.push([Tt,zt]),Nt=Math.min(Tt,Nt),Wt=Math.max(Tt,Wt),Vt=Math.min(zt,Vt),ir=Math.max(zt,ir)}Hr.xmin=Nt,Hr.xmax=Wt,Hr.ymin=Vt,Hr.ymax=ir,Hr.xref=dt,Hr.yref=wt,Hr.subtract=Ye(Hr,Gt),Gt.push(Hr),He.push(Hr)}}}}return He}function Ye(Ge,tt){for(var He=!1,Ae=0;Ae<tt.length;Ae++)for(var Ne=tt[Ae],Ze=0;Ze<Ge.length;Ze++)if(g(Ge[Ze],Ne)){He=!He;break}return He}function vt(Ge,tt){return Ge.type==="date"&&(tt=tt.replace("_"," ")),Ge.type==="log"?Ge.c2p(tt):Ge.r2p(tt,null,Ge.calendar)}function Dt(Ge){for(var tt=Ge.length,He=[],Ae=0;Ae<tt;Ae++){var Ne=Ge[Ae];He=He.concat(Ne),He=He.concat([Ne[0]])}return Kt(He)}function Kt(Ge){return Ge.isRect=Ge.length===5&&Ge[0][0]===Ge[4][0]&&Ge[0][1]===Ge[4][1]&&Ge[0][0]===Ge[1][0]&&Ge[2][0]===Ge[3][0]&&Ge[0][1]===Ge[3][1]&&Ge[1][1]===Ge[2][1]||Ge[0][1]===Ge[1][1]&&Ge[2][1]===Ge[3][1]&&Ge[0][0]===Ge[3][0]&&Ge[1][0]===Ge[2][0],Ge.isRect&&(Ge.xmin=Math.min(Ge[0][0],Ge[2][0]),Ge.xmax=Math.max(Ge[0][0],Ge[2][0]),Ge.ymin=Math.min(Ge[0][1],Ge[2][1]),Ge.ymax=Math.max(Ge[0][1],Ge[2][1])),Ge}function Ft(Ge){return function(tt,He){for(var Ae,Ne,Ze=0;Ze<Ge.length;Ze++){var Qe=Ge[Ze],bt=Qe._id,dt=bt.charAt(0);if(He.isRect){Ae||(Ae={});var wt=He[dt+"min"],Ut=He[dt+"max"];wt!==void 0&&Ut!==void 0&&(Ae[bt]=[N(Qe,wt),N(Qe,Ut)].sort(u))}else Ne||(Ne={}),Ne[bt]=He.map(G(Qe))}Ae&&(tt.range=Ae),Ne&&(tt.lassoPoints=Ne)}}function Mt(Ge){var tt=Ge.plotinfo;return tt.fillRangeItems||Ft(Ge.xaxes.concat(Ge.yaxes))}function Xt(Ge,tt){Ge.emit("plotly_selecting",tt)}function It(Ge,tt){tt&&(tt.selections=(Ge.layout||{}).selections||[]),Ge.emit("plotly_selected",tt)}function At(Ge){Ge.emit("plotly_deselect",null)}ee.exports={reselect:we,prepSelect:Y,clearOutline:d,clearSelectionsCache:X,selectOnClick:re}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(y,ee,te){var A=y("../annotations/attributes"),g=y("../../traces/scatter/attributes").line,S=y("../drawing/attributes").dash,M=y("../../lib/extend").extendFlat,e=y("../../plot_api/plot_template").templatedArray;y("../../constants/axis_placeable_objects"),ee.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:M({},A.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:M({},A.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:M({},g.color,{editType:"arraydraw"}),width:M({},g.width,{editType:"calc+arraydraw"}),dash:M({},S,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("./constants"),M=y("./helpers");ee.exports=function(h){var s=h._fullLayout,i=A.filterVisible(s.shapes);if(!(!i.length||!h._fullData.length))for(var x=0;x<i.length;x++){var p=i[x];p._extremes={};var v,f,d=g.getRefType(p.xref),o=g.getRefType(p.yref);if(p.xref!=="paper"&&d!=="domain"){var m=p.xsizemode==="pixel"?p.xanchor:p.x0,l=p.xsizemode==="pixel"?p.xanchor:p.x1;v=g.getFromId(h,p.xref),f=r(v,m,l,p.path,S.paramIsX),f&&(p._extremes[v._id]=g.findExtremes(v,f,e(p)))}if(p.yref!=="paper"&&o!=="domain"){var w=p.ysizemode==="pixel"?p.yanchor:p.y0,_=p.ysizemode==="pixel"?p.yanchor:p.y1;v=g.getFromId(h,p.yref),f=r(v,w,_,p.path,S.paramIsY),f&&(p._extremes[v._id]=g.findExtremes(v,f,a(p)))}}};function e(t){return n(t.line.width,t.xsizemode,t.x0,t.x1,t.path,!1)}function a(t){return n(t.line.width,t.ysizemode,t.y0,t.y1,t.path,!0)}function n(t,h,s,i,x,p){var v=t/2,f=p;if(h==="pixel"){var d=x?M.extractPathCoords(x,p?S.paramIsY:S.paramIsX):[s,i],o=A.aggNums(Math.max,null,d),m=A.aggNums(Math.min,null,d),l=m<0?Math.abs(m)+v:v,w=o>0?o+v:v;return{ppad:v,ppadplus:f?l:w,ppadminus:f?w:l}}else return{ppad:v}}function r(t,h,s,i,x){var p=t.type==="category"||t.type==="multicategory"?t.r2c:t.d2c;if(h!==void 0)return[p(h),p(s)];if(i){var v=1/0,f=-1/0,d=i.match(S.segmentRE),o,m,l,w,_;for(t.type==="date"&&(p=M.decodeDate(p)),o=0;o<d.length;o++)m=d[o],l=x[m.charAt(0)].drawn,l!==void 0&&(w=d[o].substr(1).match(S.paramRE),!(!w||w.length<l)&&(_=p(w[l]),_<v&&(v=_),_>f&&(f=_)));if(f>=v)return[v,f]}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(y,ee,te){ee.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("../../plots/array_container_defaults"),M=y("./attributes"),e=y("./helpers");ee.exports=function(r,t){S(r,t,{name:"shapes",handleItemDefaults:a})};function a(n,r,t){function h(G,K){return A.coerce(n,r,M,G,K)}var s=h("visible");if(s){var i=h("path"),x=i?"path":"rect",p=h("type",x),v=p!=="path";v&&delete r.path,h("editable"),h("layer"),h("opacity"),h("fillcolor"),h("fillrule");var f=h("line.width");f&&(h("line.color"),h("line.dash"));for(var d=h("xsizemode"),o=h("ysizemode"),m=["x","y"],l=0;l<2;l++){var w=m[l],_=w+"anchor",c=w==="x"?d:o,b={_fullLayout:t},u,L,T,k=g.coerceRef(n,r,b,w,void 0,"paper"),P=g.getRefType(k);if(P==="range"?(u=g.getFromId(b,k),u._shapeIndices.push(r._index),T=e.rangeToShapePosition(u),L=e.shapePositionToRange(u)):L=T=A.identity,v){var z=.25,I=.75,D=w+"0",R=w+"1",O=n[D],F=n[R];n[D]=L(n[D],!0),n[R]=L(n[R],!0),c==="pixel"?(h(D,0),h(R,10)):(g.coercePosition(r,b,h,k,D,z),g.coercePosition(r,b,h,k,R,I)),r[D]=T(r[D]),r[R]=T(r[R]),n[D]=O,n[R]=F}if(c==="pixel"){var N=n[_];n[_]=L(n[_],!0),g.coercePosition(r,b,h,k,_,.25),r[_]=T(r[_]),n[_]=N}}v&&A.noneOrAll(n,r,["x0","x1","y0","y1"])}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(y,ee,te){var A=y("../../lib"),g=A.strTranslate,S=y("../dragelement"),M=y("../dragelement/helpers"),e=M.drawMode,a=M.selectMode,n=y("../../registry"),r=y("../color"),t=y("./draw_newshape/constants"),h=t.i000,s=t.i090,i=t.i180,x=t.i270,p=y("./handle_outline"),v=p.clearOutlineControllers,f=y("./draw_newshape/helpers"),d=f.pointsOnRectangle,o=f.pointsOnEllipse,m=f.writePaths,l=y("./draw_newshape/newshapes"),w=y("../selections/draw_newselection/newselections");ee.exports=function u(L,T,k,P){P||(P=0);var z=k.gd;function I(){u(L,T,k,P++),o(L[0])&&D({redrawing:!0})}function D(ce){var de={};k.isActiveShape!==void 0&&(k.isActiveShape=!1,de=l(T,k)),k.isActiveSelection!==void 0&&(k.isActiveSelection=!1,de=w(T,k),z._fullLayout._reselect=!0),Object.keys(de).length&&n.call((ce||{}).redrawing?"relayout":"_guiRelayout",z,de)}var R=z._fullLayout,O=R._zoomlayer,F=k.dragmode,N=e(F),G=a(F);(N||G)&&(z._fullLayout._outlining=!0),v(z),T.attr("d",m(L));var K,W,Y,re,ue;if(!P&&(k.isActiveShape||k.isActiveSelection)){ue=_([],L);var j=O.append("g").attr("class","outline-controllers");X(j),be()}function q(ce){Y=+ce.srcElement.getAttribute("data-i"),re=+ce.srcElement.getAttribute("data-j"),K[Y][re].moveFn=H}function H(ce,de){if(L.length){var ye=ue[Y][re][1],ge=ue[Y][re][2],me=L[Y],Ee=me.length;if(d(me)){var Pe=ce,Ue=de;if(k.isActiveSelection){var we=c(me,re);we[1]===me[re][1]?Ue=0:Pe=0}for(var ke=0;ke<Ee;ke++)if(ke!==re){var Xe=me[ke];Xe[1]===me[re][1]&&(Xe[1]=ye+Pe),Xe[2]===me[re][2]&&(Xe[2]=ge+Ue)}if(me[re][1]=ye+Pe,me[re][2]=ge+Ue,!d(me))for(var Ve=0;Ve<Ee;Ve++)for(var Ie=0;Ie<me[Ve].length;Ie++)me[Ve][Ie]=ue[Y][Ve][Ie]}else me[re][1]=ye+ce,me[re][2]=ge+de;I()}}function U(){D()}function $(){if(L.length&&L[Y]&&L[Y].length){for(var ce=[],de=0;de<L[Y].length;de++)de!==re&&ce.push(L[Y][de]);ce.length>1&&!(ce.length===2&&ce[1][0]==="Z")&&(re===0&&(ce[0][0]="M"),L[Y]=ce,I(),D())}}function ne(ce,de){if(ce===2){Y=+de.srcElement.getAttribute("data-i"),re=+de.srcElement.getAttribute("data-j");var ye=L[Y];!d(ye)&&!o(ye)&&$()}}function X(ce){K=[];for(var de=0;de<L.length;de++){var ye=L[de],ge=d(ye),me=!ge&&o(ye);K[de]=[];for(var Ee=ye.length,Pe=0;Pe<Ee;Pe++)if(ye[Pe][0]!=="Z"&&!(me&&Pe!==h&&Pe!==s&&Pe!==i&&Pe!==x)){var Ue=ge&&k.isActiveSelection,we;Ue&&(we=c(ye,Pe));var ke=ye[Pe][1],Xe=ye[Pe][2],Ve=ce.append(Ue?"rect":"circle").attr("data-i",de).attr("data-j",Pe).style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Ue){var Ie=we[1]-ke,De=we[2]-Xe,Ye=De?5:Math.max(Math.min(25,Math.abs(Ie)-5),5),vt=Ie?5:Math.max(Math.min(25,Math.abs(De)-5),5);Ve.classed(De?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",Ye).attr("height",vt).attr("x",ke-Ye/2).attr("y",Xe-vt/2).attr("transform",g(Ie/2,De/2))}else Ve.classed("cursor-grab",!0).attr("r",5).attr("cx",ke).attr("cy",Xe);K[de][Pe]={element:Ve.node(),gd:z,prepFn:q,doneFn:U,clickFn:ne},S.init(K[de][Pe])}}}function Q(ce,de){if(L.length)for(var ye=0;ye<L.length;ye++)for(var ge=0;ge<L[ye].length;ge++)for(var me=0;me+2<L[ye][ge].length;me+=2)L[ye][ge][me+1]=ue[ye][ge][me+1]+ce,L[ye][ge][me+2]=ue[ye][ge][me+2]+de}function ie(ce,de){Q(ce,de),I()}function se(ce){Y=+ce.srcElement.getAttribute("data-i"),Y||(Y=0),W[Y].moveFn=ie}function ae(){D()}function oe(ce){ce===2&&b(z)}function be(){if(W=[],!!L.length){var ce=0;W[ce]={element:T[0][0],gd:z,prepFn:se,doneFn:ae,clickFn:oe},S.init(W[ce])}}};function _(u,L){for(var T=0;T<L.length;T++){var k=L[T];u[T]=[];for(var P=0;P<k.length;P++){u[T][P]=[];for(var z=0;z<k[P].length;z++)u[T][P][z]=k[P][z]}}return u}function c(u,L){var T=u[L][1],k=u[L][2],P=u.length,z,I,D;return z=(L+1)%P,I=u[z][1],D=u[z][2],I===T&&D===k&&(z=(L+2)%P,I=u[z][1],D=u[z][2]),[z,I,D]}function b(u){if(a(u._fullLayout.dragmode)){v(u);var L=u._fullLayout._activeSelectionIndex,T=(u.layout||{}).selections||[];if(L<T.length){for(var k=[],P=0;P<T.length;P++)P!==L&&k.push(T[P]);delete u._fullLayout._activeSelectionIndex;var z=u._fullLayout.selections[L];u._fullLayout._deselect={xref:z.xref,yref:z.yref},n.call("_guiRelayout",u,{selections:k})}}}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("../../plots/cartesian/axes"),M=y("./draw_newshape/helpers").readPaths,e=y("./display_outlines"),a=y("./handle_outline").clearOutlineControllers,n=y("../color"),r=y("../drawing"),t=y("../../plot_api/plot_template").arrayEditor,h=y("../dragelement"),s=y("../../lib/setcursor"),i=y("./constants"),x=y("./helpers"),p=x.getPathString;ee.exports={draw:v,drawOne:o,eraseActiveShape:b};function v(u){var L=u._fullLayout;L._shapeUpperLayer.selectAll("path").remove(),L._shapeLowerLayer.selectAll("path").remove();for(var T in L._plots){var k=L._plots[T].shapelayer;k&&k.selectAll("path").remove()}for(var P=0;P<L.shapes.length;P++)L.shapes[P].visible&&o(u,P)}function f(u){return!!u._fullLayout._outlining}function d(u){return!u._context.edits.shapePosition}function o(u,L){u._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+L+'"]').remove();var T=x.makeShapesOptionsAndPlotinfo(u,L),k=T.options,P=T.plotinfo;if(!k._input||k.visible===!1)return;if(k.layer!=="below")I(u._fullLayout._shapeUpperLayer);else if(k.xref==="paper"||k.yref==="paper")I(u._fullLayout._shapeLowerLayer);else if(P._hadPlotinfo){var z=P.mainplotinfo||P;I(z.shapelayer)}else I(u._fullLayout._shapeLowerLayer);function I(D){var R=p(u,k),O={"data-index":L,"fill-rule":k.fillrule,d:R},F=k.opacity,N=k.fillcolor,G=k.line.width?k.line.color:"rgba(0,0,0,0)",K=k.line.width,W=k.line.dash;!K&&k.editable===!0&&(K=5,W="solid");var Y=R[R.length-1]!=="Z",re=d(u)&&k.editable&&u._fullLayout._activeShapeIndex===L;re&&(N=Y?"rgba(0,0,0,0)":u._fullLayout.activeshape.fillcolor,F=u._fullLayout.activeshape.opacity);var ue=D.append("path").attr(O).style("opacity",F).call(n.stroke,G).call(n.fill,N).call(r.dashLine,W,K);m(ue,u,k);var j;if((re||u._context.edits.shapePosition)&&(j=t(u.layout,"shapes",k)),re){ue.style({cursor:"move"});var q={element:ue.node(),plotinfo:P,gd:u,editHelpers:j,isActiveShape:!0},H=M(R,u);e(H,ue,q)}else u._context.edits.shapePosition?l(u,ue,k,L,D,j):k.editable===!0&&ue.style("pointer-events",Y||n.opacity(N)*F<=.5?"stroke":"all");ue.node().addEventListener("click",function(){return _(u,ue)})}}function m(u,L,T){var k=(T.xref+T.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");r.setClipUrl(u,k?"clip"+L._fullLayout._uid+k:null,L)}function l(u,L,T,k,P,z){var I=10,D=10,R=T.xsizemode==="pixel",O=T.ysizemode==="pixel",F=T.type==="line",N=T.type==="path",G=z.modifyItem,K,W,Y,re,ue,j,q,H,U,$,ne,X,Q,ie,se,ae=S.getFromId(u,T.xref),oe=S.getRefType(T.xref),be=S.getFromId(u,T.yref),ce=S.getRefType(T.yref),de=x.getDataToPixel(u,ae,!1,oe),ye=x.getDataToPixel(u,be,!0,ce),ge=x.getPixelToData(u,ae,!1,oe),me=x.getPixelToData(u,be,!0,ce),Ee=we(),Pe={element:Ee.node(),gd:u,prepFn:Ve,doneFn:Ie,clickFn:De},Ue;h.init(Pe),Ee.node().onmousemove=Xe;function we(){return F?ke():L}function ke(){var Mt=10,Xt=Math.max(T.line.width,Mt),It=P.append("g").attr("data-index",k);It.append("path").attr("d",L.attr("d")).style({cursor:"move","stroke-width":Xt,"stroke-opacity":"0"});var At={"fill-opacity":"0"},Ge=Math.max(Xt/2,Mt);return It.append("circle").attr({"data-line-point":"start-point",cx:R?de(T.xanchor)+T.x0:de(T.x0),cy:O?ye(T.yanchor)-T.y0:ye(T.y0),r:Ge}).style(At).classed("cursor-grab",!0),It.append("circle").attr({"data-line-point":"end-point",cx:R?de(T.xanchor)+T.x1:de(T.x1),cy:O?ye(T.yanchor)-T.y1:ye(T.y1),r:Ge}).style(At).classed("cursor-grab",!0),It}function Xe(Mt){if(f(u)){Ue=null;return}if(F)Mt.target.tagName==="path"?Ue="move":Ue=Mt.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Xt=Pe.element.getBoundingClientRect(),It=Xt.right-Xt.left,At=Xt.bottom-Xt.top,Ge=Mt.clientX-Xt.left,tt=Mt.clientY-Xt.top,He=!N&&It>I&&At>D&&!Mt.shiftKey?h.getCursor(Ge/It,1-tt/At):"move";s(L,He),Ue=He.split("-")[0]}}function Ve(Mt){f(u)||(R&&(ue=de(T.xanchor)),O&&(j=ye(T.yanchor)),T.type==="path"?se=T.path:(K=R?T.x0:de(T.x0),W=O?T.y0:ye(T.y0),Y=R?T.x1:de(T.x1),re=O?T.y1:ye(T.y1)),K<Y?(U=K,Q="x0",$=Y,ie="x1"):(U=Y,Q="x1",$=K,ie="x0"),!O&&W<re||O&&W>re?(q=W,ne="y0",H=re,X="y1"):(q=re,ne="y1",H=W,X="y0"),Xe(Mt),Dt(P,T),Ft(L,T,u),Pe.moveFn=Ue==="move"?Ye:vt,Pe.altKey=Mt.altKey)}function Ie(){f(u)||(s(L),Kt(P),m(L,u,T),A.call("_guiRelayout",u,z.getUpdateObj()))}function De(){f(u)||Kt(P)}function Ye(Mt,Xt){if(T.type==="path"){var It=function(tt){return tt},At=It,Ge=It;R?G("xanchor",T.xanchor=ge(ue+Mt)):(At=function(He){return ge(de(He)+Mt)},ae&&ae.type==="date"&&(At=x.encodeDate(At))),O?G("yanchor",T.yanchor=me(j+Xt)):(Ge=function(He){return me(ye(He)+Xt)},be&&be.type==="date"&&(Ge=x.encodeDate(Ge))),G("path",T.path=w(se,At,Ge))}else R?G("xanchor",T.xanchor=ge(ue+Mt)):(G("x0",T.x0=ge(K+Mt)),G("x1",T.x1=ge(Y+Mt))),O?G("yanchor",T.yanchor=me(j+Xt)):(G("y0",T.y0=me(W+Xt)),G("y1",T.y1=me(re+Xt)));L.attr("d",p(u,T)),Dt(P,T)}function vt(Mt,Xt){if(N){var It=function(Vt){return Vt},At=It,Ge=It;R?G("xanchor",T.xanchor=ge(ue+Mt)):(At=function(ir){return ge(de(ir)+Mt)},ae&&ae.type==="date"&&(At=x.encodeDate(At))),O?G("yanchor",T.yanchor=me(j+Xt)):(Ge=function(ir){return me(ye(ir)+Xt)},be&&be.type==="date"&&(Ge=x.encodeDate(Ge))),G("path",T.path=w(se,At,Ge))}else if(F){if(Ue==="resize-over-start-point"){var tt=K+Mt,He=O?W-Xt:W+Xt;G("x0",T.x0=R?tt:ge(tt)),G("y0",T.y0=O?He:me(He))}else if(Ue==="resize-over-end-point"){var Ae=Y+Mt,Ne=O?re-Xt:re+Xt;G("x1",T.x1=R?Ae:ge(Ae)),G("y1",T.y1=O?Ne:me(Ne))}}else{var Ze=function(Vt){return Ue.indexOf(Vt)!==-1},Qe=Ze("n"),bt=Ze("s"),dt=Ze("w"),wt=Ze("e"),Ut=Qe?q+Xt:q,Rt=bt?H+Xt:H,Nt=dt?U+Mt:U,Wt=wt?$+Mt:$;O&&(Qe&&(Ut=q-Xt),bt&&(Rt=H-Xt)),(!O&&Rt-Ut>D||O&&Ut-Rt>D)&&(G(ne,T[ne]=O?Ut:me(Ut)),G(X,T[X]=O?Rt:me(Rt))),Wt-Nt>I&&(G(Q,T[Q]=R?Nt:ge(Nt)),G(ie,T[ie]=R?Wt:ge(Wt)))}L.attr("d",p(u,T)),Dt(P,T)}function Dt(Mt,Xt){(R||O)&&It();function It(){var At=Xt.type!=="path",Ge=Mt.selectAll(".visual-cue").data([0]),tt=1;Ge.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":tt}).classed("visual-cue",!0);var He=de(R?Xt.xanchor:g.midRange(At?[Xt.x0,Xt.x1]:x.extractPathCoords(Xt.path,i.paramIsX))),Ae=ye(O?Xt.yanchor:g.midRange(At?[Xt.y0,Xt.y1]:x.extractPathCoords(Xt.path,i.paramIsY)));if(He=x.roundPositionForSharpStrokeRendering(He,tt),Ae=x.roundPositionForSharpStrokeRendering(Ae,tt),R&&O){var Ne="M"+(He-1-tt)+","+(Ae-1-tt)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";Ge.attr("d",Ne)}else if(R){var Ze="M"+(He-1-tt)+","+(Ae-9-tt)+"v18 h2 v-18 Z";Ge.attr("d",Ze)}else{var Qe="M"+(He-9-tt)+","+(Ae-1-tt)+"h18 v2 h-18 Z";Ge.attr("d",Qe)}}}function Kt(Mt){Mt.selectAll(".visual-cue").remove()}function Ft(Mt,Xt,It){var At=Xt.xref,Ge=Xt.yref,tt=S.getFromId(It,At),He=S.getFromId(It,Ge),Ae="";At!=="paper"&&!tt.autorange&&(Ae+=At),Ge!=="paper"&&!He.autorange&&(Ae+=Ge),r.setClipUrl(Mt,Ae?"clip"+It._fullLayout._uid+Ae:null,It)}}function w(u,L,T){return u.replace(i.segmentRE,function(k){var P=0,z=k.charAt(0),I=i.paramIsX[z],D=i.paramIsY[z],R=i.numParams[z],O=k.substr(1).replace(i.paramRE,function(F){return P>=R||(I[P]?F=L(F):D[P]&&(F=T(F)),P++),F});return z+O})}function _(u,L){if(d(u)){var T=L.node(),k=+T.getAttribute("data-index");if(k>=0){if(k===u._fullLayout._activeShapeIndex){c(u);return}u._fullLayout._activeShapeIndex=k,u._fullLayout._deactivateShape=c,v(u)}}}function c(u){if(d(u)){var L=u._fullLayout._activeShapeIndex;L>=0&&(a(u),delete u._fullLayout._activeShapeIndex,v(u))}}function b(u){if(d(u)){a(u);var L=u._fullLayout._activeShapeIndex,T=(u.layout||{}).shapes||[];if(L<T.length){for(var k=[],P=0;P<T.length;P++)P!==L&&k.push(T[P]);delete u._fullLayout._activeShapeIndex,A.call("_guiRelayout",u,{shapes:k})}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(y,ee,te){var A=y("../../drawing/attributes").dash,g=y("../../../lib/extend").extendFlat;ee.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:g({},A,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(y,ee,te){var A=32;ee.exports={CIRCLE_SIDES:A,i000:0,i090:A/4,i180:A/2,i270:A/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(y,ee,te){var A=y("../../color");ee.exports=function(S,M,e){e("newshape.drawdirection"),e("newshape.layer"),e("newshape.fillcolor"),e("newshape.fillrule"),e("newshape.opacity");var a=e("newshape.line.width");if(a){var n=(S||{}).plot_bgcolor||"#FFF";e("newshape.line.color",A.contrast(n)),e("newshape.line.dash")}e("activeshape.fillcolor"),e("activeshape.opacity")}},{"../../color":367}],466:[function(y,ee,te){var A=y("parse-svg-path"),g=y("./constants"),S=g.CIRCLE_SIDES,M=g.SQRT2,e=y("../../selections/helpers"),a=e.p2r,n=e.r2p,r=[0,3,4,5,6,1,2],t=[0,3,4,1,2];te.writePaths=function(i){var x=i.length;if(!x)return"M0,0Z";for(var p="",v=0;v<x;v++)for(var f=i[v].length,d=0;d<f;d++){var o=i[v][d][0];if(o==="Z")p+="Z";else for(var m=i[v][d].length,l=0;l<m;l++){var w=l;o==="Q"||o==="S"?w=t[l]:o==="C"&&(w=r[l]),p+=i[v][d][w],l>0&&l<m-1&&(p+=",")}}return p},te.readPaths=function(i,x,p,v){var f=A(i),d=[],o=-1,m=function(){o++,d[o]=[]},l,w=0,_=0,c,b,u=function(){c=w,b=_};u();for(var L=0;L<f.length;L++){var T=[],k,P,z,I,D=f[L][0],R=D;switch(D){case"M":m(),w=+f[L][1],_=+f[L][2],T.push([R,w,_]),u();break;case"Q":case"S":k=+f[L][1],z=+f[L][2],w=+f[L][3],_=+f[L][4],T.push([R,w,_,k,z]);break;case"C":k=+f[L][1],z=+f[L][2],P=+f[L][3],I=+f[L][4],w=+f[L][5],_=+f[L][6],T.push([R,w,_,k,z,P,I]);break;case"T":case"L":w=+f[L][1],_=+f[L][2],T.push([R,w,_]);break;case"H":R="L",w=+f[L][1],T.push([R,w,_]);break;case"V":R="L",_=+f[L][1],T.push([R,w,_]);break;case"A":R="L";var O=+f[L][1],F=+f[L][2];+f[L][4]||(O=-O,F=-F);var N=w-O,G=_;for(l=1;l<=S/2;l++){var K=2*Math.PI*l/S;T.push([R,N+O*Math.cos(K),G+F*Math.sin(K)])}break;case"Z":(w!==c||_!==b)&&(w=c,_=b,T.push([R,w,_]));break}for(var W=(p||{}).domain,Y=x._fullLayout._size,re=p&&p.xsizemode==="pixel",ue=p&&p.ysizemode==="pixel",j=v===!1,q=0;q<T.length;q++){for(l=0;l+2<7;l+=2){var H=T[q][l+1],U=T[q][l+2];H===void 0||U===void 0||(w=H,_=U,p&&(p.xaxis&&p.xaxis.p2r?(j&&(H-=p.xaxis._offset),re?H=n(p.xaxis,p.xanchor)+H:H=a(p.xaxis,H)):(j&&(H-=Y.l),W?H=W.x[0]+H/Y.w:H=H/Y.w),p.yaxis&&p.yaxis.p2r?(j&&(U-=p.yaxis._offset),ue?U=n(p.yaxis,p.yanchor)-U:U=a(p.yaxis,U)):(j&&(U-=Y.t),W?U=W.y[1]-U/Y.h:U=1-U/Y.h)),T[q][l+1]=H,T[q][l+2]=U)}d[o].push(T[q].slice())}}return d};function h(i,x){return Math.abs(i-x)<=1e-6}function s(i,x){var p=x[1]-i[1],v=x[2]-i[2];return Math.sqrt(p*p+v*v)}te.pointsOnRectangle=function(i){var x=i.length;if(x!==5)return!1;for(var p=1;p<3;p++){var v=i[0][p]-i[1][p],f=i[3][p]-i[2][p];if(!h(v,f))return!1;var d=i[0][p]-i[3][p],o=i[1][p]-i[2][p];if(!h(d,o))return!1}return!h(i[0][1],i[1][1])&&!h(i[0][1],i[3][1])?!1:!!(s(i[0],i[1])*s(i[0],i[3]))},te.pointsOnEllipse=function(i){var x=i.length;if(x!==S+1)return!1;x=S;for(var p=0;p<x;p++){var v=(x*2-p)%x,f=(x/2+v)%x,d=(x/2+p)%x;if(!h(s(i[p],i[d]),s(i[v],i[f])))return!1}return!0},te.handleEllipse=function(i,x,p){if(!i)return[x,p];var v=te.ellipseOver({x0:x[0],y0:x[1],x1:p[0],y1:p[1]}),f=(v.x1+v.x0)/2,d=(v.y1+v.y0)/2,o=(v.x1-v.x0)/2,m=(v.y1-v.y0)/2;o||(o=m=m/M),m||(m=o=o/M);for(var l=[],w=0;w<S;w++){var _=w*2*Math.PI/S;l.push([f+o*Math.cos(_),d+m*Math.sin(_)])}return l},te.ellipseOver=function(i){var x=i.x0,p=i.y0,v=i.x1,f=i.y1,d=v-x,o=f-p;x-=d,p-=o;var m=(x+v)/2,l=(p+f)/2,w=M;return d*=w,o*=w,{x0:m-d,y0:l-o,x1:m+d,y1:l+o}},te.fixDatesForPaths=function(i,x,p){var v=x.type==="date",f=p.type==="date";if(!v&&!f)return i;for(var d=0;d<i.length;d++)for(var o=0;o<i[d].length;o++)for(var m=0;m+2<i[d][o].length;m+=2)v&&(i[d][o][m+1]=i[d][o][m+1].replace(" ","_")),f&&(i[d][o][m+2]=i[d][o][m+2].replace(" ","_"));return i}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(y,ee,te){var A=y("../../dragelement/helpers"),g=A.drawMode,S=A.openMode,M=y("./constants"),e=M.i000,a=M.i090,n=M.i180,r=M.i270,t=M.cos45,h=M.sin45,s=y("../../selections/helpers"),i=s.p2r,x=s.r2p,p=y(".././handle_outline"),v=p.clearOutline,f=y("./helpers"),d=f.readPaths,o=f.writePaths,m=f.ellipseOver,l=f.fixDatesForPaths;ee.exports=function(_,c){if(_.length){var b=_[0][0];if(b){var u=b.getAttribute("d"),L=c.gd,T=L._fullLayout.newshape,k=c.plotinfo,P=k.xaxis,z=k.yaxis,I=!!k.domain||!k.xaxis,D=!!k.domain||!k.yaxis,R=c.isActiveShape,O=c.dragmode,F=(L.layout||{}).shapes||[];if(!g(O)&&R!==void 0){var N=L._fullLayout._activeShapeIndex;if(N<F.length)switch(L._fullLayout.shapes[N].type){case"rect":O="drawrect";break;case"circle":O="drawcircle";break;case"line":O="drawline";break;case"path":var G=F[N].path||"";G[G.length-1]==="Z"?O="drawclosedpath":O="drawopenpath";break}}var K=S(O),W=d(u,L,k,R),Y={editable:!0,xref:I?"paper":P._id,yref:D?"paper":z._id,layer:T.layer,opacity:T.opacity,line:{color:T.line.color,width:T.line.width,dash:T.line.dash}};K||(Y.fillcolor=T.fillcolor,Y.fillrule=T.fillrule);var re;if(W.length===1&&(re=W[0]),re&&re.length===5&&O==="drawrect")Y.type="rect",Y.x0=re[0][1],Y.y0=re[0][2],Y.x1=re[2][1],Y.y1=re[2][2];else if(re&&O==="drawline")Y.type="line",Y.x0=re[0][1],Y.y0=re[0][2],Y.x1=re[1][1],Y.y1=re[1][2];else if(re&&O==="drawcircle"){Y.type="circle";var ue=re[e][1],j=re[a][1],q=re[n][1],H=re[r][1],U=re[e][2],$=re[a][2],ne=re[n][2],X=re[r][2],Q=k.xaxis&&(k.xaxis.type==="date"||k.xaxis.type==="log"),ie=k.yaxis&&(k.yaxis.type==="date"||k.yaxis.type==="log");Q&&(ue=x(k.xaxis,ue),j=x(k.xaxis,j),q=x(k.xaxis,q),H=x(k.xaxis,H)),ie&&(U=x(k.yaxis,U),$=x(k.yaxis,$),ne=x(k.yaxis,ne),X=x(k.yaxis,X));var se=(j+H)/2,ae=(U+ne)/2,oe=(H-j+q-ue)/2,be=(X-$+ne-U)/2,ce=m({x0:se,y0:ae,x1:se+oe*t,y1:ae+be*h});Q&&(ce.x0=i(k.xaxis,ce.x0),ce.x1=i(k.xaxis,ce.x1)),ie&&(ce.y0=i(k.yaxis,ce.y0),ce.y1=i(k.yaxis,ce.y1)),Y.x0=ce.x0,Y.y0=ce.y0,Y.x1=ce.x1,Y.y1=ce.y1}else Y.type="path",P&&z&&l(W,P,z),Y.path=o(W),re=null;v(L);for(var de=c.editHelpers,ye=(de||{}).modifyItem,ge=[],me=0;me<F.length;me++){var Ee=L._fullLayout.shapes[me];if(ge[me]=Ee._input,R!==void 0&&me===L._fullLayout._activeShapeIndex){var Pe=Y;switch(Ee.type){case"line":case"rect":case"circle":ye("x0",Pe.x0),ye("x1",Pe.x1),ye("y0",Pe.y0),ye("y1",Pe.y1);break;case"path":ye("path",Pe.path);break}}}return R===void 0?(ge.push(Y),ge):de?de.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(y,ee,te){function A(S){var M=S._fullLayout._zoomlayer;M&&M.selectAll(".outline-controllers").remove()}function g(S){var M=S._fullLayout._zoomlayer;M&&M.selectAll(".select-outline").remove(),S._fullLayout._outlining=!1}ee.exports={clearOutlineControllers:A,clearOutline:g}},{}],469:[function(y,ee,te){var A=y("./constants"),g=y("../../lib"),S=y("../../plots/cartesian/axes");te.rangeToShapePosition=function(e){return e.type==="log"?e.r2d:function(a){return a}},te.shapePositionToRange=function(e){return e.type==="log"?e.d2r:function(a){return a}},te.decodeDate=function(e){return function(a){return a.replace&&(a=a.replace("_"," ")),e(a)}},te.encodeDate=function(e){return function(a){return e(a).replace(" ","_")}},te.extractPathCoords=function(e,a,n){var r=[],t=e.match(A.segmentRE);return t.forEach(function(h){var s=a[h.charAt(0)].drawn;if(s!==void 0){var i=h.substr(1).match(A.paramRE);if(!(!i||i.length<s)){var x=i[s],p=n?x:g.cleanNumber(x);r.push(p)}}}),r},te.getDataToPixel=function(e,a,n,r){var t=e._fullLayout._size,h;if(a)if(r==="domain")h=function(i){return a._length*(n?1-i:i)+a._offset};else{var s=te.shapePositionToRange(a);h=function(i){return a._offset+a.r2p(s(i,!0))},a.type==="date"&&(h=te.decodeDate(h))}else n?h=function(i){return t.t+t.h*(1-i)}:h=function(i){return t.l+t.w*i};return h},te.getPixelToData=function(e,a,n,r){var t=e._fullLayout._size,h;if(a)if(r==="domain")h=function(i){var x=(i-a._offset)/a._length;return n?1-x:x};else{var s=te.rangeToShapePosition(a);h=function(i){return s(a.p2r(i-a._offset))}}else n?h=function(i){return 1-(i-t.t)/t.h}:h=function(i){return(i-t.l)/t.w};return h},te.roundPositionForSharpStrokeRendering=function(e,a){var n=Math.round(a%2)===1,r=Math.round(e);return n?r+.5:r},te.makeShapesOptionsAndPlotinfo=function(e,a){var n=e._fullLayout.shapes[a]||{},r=e._fullLayout._plots[n.xref+n.yref],t=!!r;return t?r._hadPlotinfo=!0:(r={},n.xref&&n.xref!=="paper"&&(r.xaxis=e._fullLayout[n.xref+"axis"]),n.yref&&n.yref!=="paper"&&(r.yaxis=e._fullLayout[n.yref+"axis"])),r.xsizemode=n.xsizemode,r.ysizemode=n.ysizemode,r.xanchor=n.xanchor,r.yanchor=n.yanchor,{options:n,plotinfo:r}},te.makeSelectionsOptionsAndPlotinfo=function(e,a){var n=e._fullLayout.selections[a]||{},r=e._fullLayout._plots[n.xref+n.yref],t=!!r;return t?r._hadPlotinfo=!0:(r={},n.xref&&(r.xaxis=e._fullLayout[n.xref+"axis"]),n.yref&&(r.yaxis=e._fullLayout[n.yref+"axis"])),{options:n,plotinfo:r}},te.getPathString=function(e,a){var n=a.type,r=S.getRefType(a.xref),t=S.getRefType(a.yref),h=S.getFromId(e,a.xref),s=S.getFromId(e,a.yref),i=e._fullLayout._size,x,p,v,f,d,o,m,l;if(h?r==="domain"?p=function(z){return h._offset+h._length*z}:(x=te.shapePositionToRange(h),p=function(z){return h._offset+h.r2p(x(z,!0))}):p=function(z){return i.l+i.w*z},s?t==="domain"?f=function(z){return s._offset+s._length*(1-z)}:(v=te.shapePositionToRange(s),f=function(z){return s._offset+s.r2p(v(z,!0))}):f=function(z){return i.t+i.h*(1-z)},n==="path")return h&&h.type==="date"&&(p=te.decodeDate(p)),s&&s.type==="date"&&(f=te.decodeDate(f)),M(a,p,f);if(a.xsizemode==="pixel"){var w=p(a.xanchor);d=w+a.x0,o=w+a.x1}else d=p(a.x0),o=p(a.x1);if(a.ysizemode==="pixel"){var _=f(a.yanchor);m=_-a.y0,l=_-a.y1}else m=f(a.y0),l=f(a.y1);if(n==="line")return"M"+d+","+m+"L"+o+","+l;if(n==="rect")return"M"+d+","+m+"H"+o+"V"+l+"H"+d+"Z";var c=(d+o)/2,b=(m+l)/2,u=Math.abs(c-d),L=Math.abs(b-m),T="A"+u+","+L,k=c+u+","+b,P=c+","+(b-L);return"M"+k+T+" 0 1,1 "+P+T+" 0 0,1 "+k+"Z"};function M(e,a,n){var r=e.path,t=e.xsizemode,h=e.ysizemode,s=e.xanchor,i=e.yanchor;return r.replace(A.segmentRE,function(x){var p=0,v=x.charAt(0),f=A.paramIsX[v],d=A.paramIsY[v],o=A.numParams[v],m=x.substr(1).replace(A.paramRE,function(l){return f[p]?t==="pixel"?l=a(s)+Number(l):l=a(l):d[p]&&(h==="pixel"?l=n(i)-Number(l):l=n(l)),p++,p>o&&(l="X"),l});return p>o&&(m=m.replace(/[\s,]*X.*/,""),g.log("Ignoring extra params in segment "+x)),v+m})}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(y,ee,te){var A=y("./draw");ee.exports={moduleType:"component",name:"shapes",layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),supplyDrawNewShapeDefaults:y("./draw_newshape/defaults"),includeBasePlot:y("../../plots/cartesian/include_components")("shapes"),calcAutorange:y("./calc_autorange"),draw:A.draw,drawOne:A.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(y,ee,te){var A=y("../../plots/font_attributes"),g=y("../../plots/pad_attributes"),S=y("../../lib/extend").extendDeepAll,M=y("../../plot_api/edit_types").overrideAll,e=y("../../plots/animation_attributes"),a=y("../../plot_api/plot_template").templatedArray,n=y("./constants"),r=a("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});ee.exports=M(a("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:r,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:S(g({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:A({})},font:A({}),activebgcolor:{valType:"color",dflt:n.gripBgActiveColor},bgcolor:{valType:"color",dflt:n.railBgColor},bordercolor:{valType:"color",dflt:n.railBorderColor},borderwidth:{valType:"number",min:0,dflt:n.railBorderWidth},ticklen:{valType:"number",min:0,dflt:n.tickLength},tickcolor:{valType:"color",dflt:n.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:n.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(y,ee,te){ee.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/array_container_defaults"),S=y("./attributes"),M=y("./constants"),e=M.name,a=S.steps;ee.exports=function(h,s){g(h,s,{name:e,handleItemDefaults:n})};function n(t,h,s){function i(l,w){return A.coerce(t,h,S,l,w)}for(var x=g(t,h,{name:"steps",handleItemDefaults:r}),p=0,v=0;v<x.length;v++)x[v].visible&&p++;var f;if(p<2?f=h.visible=!1:f=i("visible"),!!f){h._stepCount=p;var d=h._visibleSteps=A.filterVisible(x),o=i("active");(x[o]||{}).visible||(h.active=d[0]._index),i("x"),i("y"),A.noneOrAll(t,h,["x","y"]),i("xanchor"),i("yanchor"),i("len"),i("lenmode"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),A.coerceFont(i,"font",s.font);var m=i("currentvalue.visible");m&&(i("currentvalue.xanchor"),i("currentvalue.prefix"),i("currentvalue.suffix"),i("currentvalue.offset"),A.coerceFont(i,"currentvalue.font",h.font)),i("transition.duration"),i("transition.easing"),i("bgcolor"),i("activebgcolor"),i("bordercolor"),i("borderwidth"),i("ticklen"),i("tickwidth"),i("tickcolor"),i("minorticklen")}}function r(t,h){function s(p,v){return A.coerce(t,h,a,p,v)}var i;if(t.method!=="skip"&&!Array.isArray(t.args)?i=h.visible=!1:i=s("visible"),i){s("method"),s("args");var x=s("label","step-"+h._index);s("value",x),s("execute")}}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../plots/plots"),S=y("../color"),M=y("../drawing"),e=y("../../lib"),a=e.strTranslate,n=y("../../lib/svg_text_utils"),r=y("../../plot_api/plot_template").arrayEditor,t=y("./constants"),h=y("../../constants/alignment"),s=h.LINE_SPACING,i=h.FROM_TL,x=h.FROM_BR;ee.exports=function(O){var F=O._fullLayout,N=v(F,O),G=F._infolayer.selectAll("g."+t.containerClassName).data(N.length>0?[0]:[]);G.enter().append("g").classed(t.containerClassName,!0).style("cursor","ew-resize");function K(ue){ue._commandObserver&&(ue._commandObserver.remove(),delete ue._commandObserver),g.autoMargin(O,p(ue))}if(G.exit().each(function(){A.select(this).selectAll("g."+t.groupClassName).each(K)}).remove(),N.length!==0){var W=G.selectAll("g."+t.groupClassName).data(N,f);W.enter().append("g").classed(t.groupClassName,!0),W.exit().each(K).remove();for(var Y=0;Y<N.length;Y++){var re=N[Y];d(O,re)}W.each(function(ue){var j=A.select(this);T(ue),g.manageCommandObserver(O,ue,ue._visibleSteps,function(q){var H=j.data()[0];H.active!==q.index&&(H._dragging||b(O,j,H,q.index,!1,!0))}),o(O,A.select(this),ue)})}};function p(R){return t.autoMarginIdRoot+R._index}function v(R,O){for(var F=R[t.name],N=[],G=0;G<F.length;G++){var K=F[G];K.visible&&(K._gd=O,N.push(K))}return N}function f(R){return R._index}function d(R,O){var F=M.tester.selectAll("g."+t.labelGroupClass).data(O._visibleSteps);F.enter().append("g").classed(t.labelGroupClass,!0);var N=0,G=0;F.each(function($){var ne=A.select(this),X=w(ne,{step:$},O),Q=X.node();if(Q){var ie=M.bBox(Q);G=Math.max(G,ie.height),N=Math.max(N,ie.width)}}),F.remove();var K=O._dims={};K.inputAreaWidth=Math.max(t.railWidth,t.gripHeight);var W=R._fullLayout._size;K.lx=W.l+W.w*O.x,K.ly=W.t+W.h*(1-O.y),O.lenmode==="fraction"?K.outerLength=Math.round(W.w*O.len):K.outerLength=O.len,K.inputAreaStart=0,K.inputAreaLength=Math.round(K.outerLength-O.pad.l-O.pad.r);var Y=K.inputAreaLength-2*t.stepInset,re=Y/(O._stepCount-1),ue=N+t.labelPadding;if(K.labelStride=Math.max(1,Math.ceil(ue/re)),K.labelHeight=G,K.currentValueMaxWidth=0,K.currentValueHeight=0,K.currentValueTotalHeight=0,K.currentValueMaxLines=1,O.currentvalue.visible){var j=M.tester.append("g");F.each(function($){var ne=m(j,O,$.label),X=ne.node()&&M.bBox(ne.node())||{width:0,height:0},Q=n.lineCount(ne);K.currentValueMaxWidth=Math.max(K.currentValueMaxWidth,Math.ceil(X.width)),K.currentValueHeight=Math.max(K.currentValueHeight,Math.ceil(X.height)),K.currentValueMaxLines=Math.max(K.currentValueMaxLines,Q)}),K.currentValueTotalHeight=K.currentValueHeight+O.currentvalue.offset,j.remove()}K.height=K.currentValueTotalHeight+t.tickOffset+O.ticklen+t.labelOffset+K.labelHeight+O.pad.t+O.pad.b;var q="left";e.isRightAnchor(O)&&(K.lx-=K.outerLength,q="right"),e.isCenterAnchor(O)&&(K.lx-=K.outerLength/2,q="center");var H="top";e.isBottomAnchor(O)&&(K.ly-=K.height,H="bottom"),e.isMiddleAnchor(O)&&(K.ly-=K.height/2,H="middle"),K.outerLength=Math.ceil(K.outerLength),K.height=Math.ceil(K.height),K.lx=Math.round(K.lx),K.ly=Math.round(K.ly);var U={y:O.y,b:K.height*x[H],t:K.height*i[H]};O.lenmode==="fraction"?(U.l=0,U.xl=O.x-O.len*i[q],U.r=0,U.xr=O.x+O.len*x[q]):(U.x=O.x,U.l=K.outerLength*i[q],U.r=K.outerLength*x[q]),g.autoMargin(R,p(O),U)}function o(R,O,F){(F.steps[F.active]||{}).visible||(F.active=F._visibleSteps[0]._index),O.call(m,F).call(D,F).call(_,F).call(L,F).call(I,R,F).call(l,R,F);var N=F._dims;M.setTranslate(O,N.lx+F.pad.l,N.ly+F.pad.t),O.call(k,F,!1),O.call(m,F)}function m(R,O,F){if(O.currentvalue.visible){var N=O._dims,G,K;switch(O.currentvalue.xanchor){case"right":G=N.inputAreaLength-t.currentValueInset-N.currentValueMaxWidth,K="left";break;case"center":G=N.inputAreaLength*.5,K="middle";break;default:G=t.currentValueInset,K="left"}var W=e.ensureSingle(R,"text",t.labelClass,function(H){H.attr({"text-anchor":K,"data-notex":1})}),Y=O.currentvalue.prefix?O.currentvalue.prefix:"";if(typeof F=="string")Y+=F;else{var re=O.steps[O.active].label,ue=O._gd._fullLayout._meta;ue&&(re=e.templateString(re,ue)),Y+=re}O.currentvalue.suffix&&(Y+=O.currentvalue.suffix),W.call(M.font,O.currentvalue.font).text(Y).call(n.convertToTspans,O._gd);var j=n.lineCount(W),q=(N.currentValueMaxLines+1-j)*O.currentvalue.font.size*s;return n.positionText(W,G,q),W}}function l(R,O,F){var N=e.ensureSingle(R,"rect",t.gripRectClass,function(G){G.call(u,O,R,F).style("pointer-events","all")});N.attr({width:t.gripWidth,height:t.gripHeight,rx:t.gripRadius,ry:t.gripRadius}).call(S.stroke,F.bordercolor).call(S.fill,F.bgcolor).style("stroke-width",F.borderwidth+"px")}function w(R,O,F){var N=e.ensureSingle(R,"text",t.labelClass,function(W){W.attr({"text-anchor":"middle","data-notex":1})}),G=O.step.label,K=F._gd._fullLayout._meta;return K&&(G=e.templateString(G,K)),N.call(M.font,F.font).text(G).call(n.convertToTspans,F._gd),N}function _(R,O){var F=e.ensureSingle(R,"g",t.labelsClass),N=O._dims,G=F.selectAll("g."+t.labelGroupClass).data(N.labelSteps);G.enter().append("g").classed(t.labelGroupClass,!0),G.exit().remove(),G.each(function(K){var W=A.select(this);W.call(w,K,O),M.setTranslate(W,P(O,K.fraction),t.tickOffset+O.ticklen+O.font.size*s+t.labelOffset+N.currentValueTotalHeight)})}function c(R,O,F,N,G){var K=Math.round(N*(F._stepCount-1)),W=F._visibleSteps[K]._index;W!==F.active&&b(R,O,F,W,!0,G)}function b(R,O,F,N,G,K){var W=F.active;F.active=N,r(R.layout,t.name,F).applyUpdate("active",N);var Y=F.steps[F.active];O.call(k,F,K),O.call(m,F),R.emit("plotly_sliderchange",{slider:F,step:F.steps[F.active],interaction:G,previousActive:W}),Y&&Y.method&&G&&(O._nextMethod?(O._nextMethod.step=Y,O._nextMethod.doCallback=G,O._nextMethod.doTransition=K):(O._nextMethod={step:Y,doCallback:G,doTransition:K},O._nextMethodRaf=window.requestAnimationFrame(function(){var re=O._nextMethod.step;re.method&&(re.execute&&g.executeAPICommand(R,re.method,re.args),O._nextMethod=null,O._nextMethodRaf=null)})))}function u(R,O,F){var N=F.node(),G=A.select(O);function K(){return F.data()[0]}function W(){var Y=K();O.emit("plotly_sliderstart",{slider:Y});var re=F.select("."+t.gripRectClass);A.event.stopPropagation(),A.event.preventDefault(),re.call(S.fill,Y.activebgcolor);var ue=z(Y,A.mouse(N)[0]);c(O,F,Y,ue,!0),Y._dragging=!0;function j(){var H=K(),U=z(H,A.mouse(N)[0]);c(O,F,H,U,!1)}G.on("mousemove",j),G.on("touchmove",j);function q(){var H=K();H._dragging=!1,re.call(S.fill,H.bgcolor),G.on("mouseup",null),G.on("mousemove",null),G.on("touchend",null),G.on("touchmove",null),O.emit("plotly_sliderend",{slider:H,step:H.steps[H.active]})}G.on("mouseup",q),G.on("touchend",q)}R.on("mousedown",W),R.on("touchstart",W)}function L(R,O){var F=R.selectAll("rect."+t.tickRectClass).data(O._visibleSteps),N=O._dims;F.enter().append("rect").classed(t.tickRectClass,!0),F.exit().remove(),F.attr({width:O.tickwidth+"px","shape-rendering":"crispEdges"}),F.each(function(G,K){var W=K%N.labelStride===0,Y=A.select(this);Y.attr({height:W?O.ticklen:O.minorticklen}).call(S.fill,O.tickcolor),M.setTranslate(Y,P(O,K/(O._stepCount-1))-.5*O.tickwidth,(W?t.tickOffset:t.minorTickOffset)+N.currentValueTotalHeight)})}function T(R){var O=R._dims;O.labelSteps=[];for(var F=R._stepCount,N=0;N<F;N+=O.labelStride)O.labelSteps.push({fraction:N/(F-1),step:R._visibleSteps[N]})}function k(R,O,F){for(var N=R.select("rect."+t.gripRectClass),G=0,K=0;K<O._stepCount;K++)if(O._visibleSteps[K]._index===O.active){G=K;break}var W=P(O,G/(O._stepCount-1));if(!O._invokingCommand){var Y=N;F&&O.transition.duration>0&&(Y=Y.transition().duration(O.transition.duration).ease(O.transition.easing)),Y.attr("transform",a(W-t.gripWidth*.5,O._dims.currentValueTotalHeight))}}function P(R,O){var F=R._dims;return F.inputAreaStart+t.stepInset+(F.inputAreaLength-2*t.stepInset)*Math.min(1,Math.max(0,O))}function z(R,O){var F=R._dims;return Math.min(1,Math.max(0,(O-t.stepInset-F.inputAreaStart)/(F.inputAreaLength-2*t.stepInset-2*F.inputAreaStart)))}function I(R,O,F){var N=F._dims,G=e.ensureSingle(R,"rect",t.railTouchRectClass,function(K){K.call(u,O,R,F).style("pointer-events","all")});G.attr({width:N.inputAreaLength,height:Math.max(N.inputAreaWidth,t.tickOffset+F.ticklen+N.labelHeight)}).call(S.fill,F.bgcolor).attr("opacity",0),M.setTranslate(G,0,N.currentValueTotalHeight)}function D(R,O){var F=O._dims,N=F.inputAreaLength-t.railInset*2,G=e.ensureSingle(R,"rect",t.railRectClass);G.attr({width:N,height:t.railWidth,rx:t.railRadius,ry:t.railRadius,"shape-rendering":"crispEdges"}).call(S.stroke,O.bordercolor).call(S.fill,O.bgcolor).style("stroke-width",O.borderwidth+"px"),M.setTranslate(G,t.railInset,(F.inputAreaWidth-t.railWidth)*.5+F.currentValueTotalHeight)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(y,ee,te){var A=y("./constants");ee.exports={moduleType:"component",name:A.name,layoutAttributes:y("./attributes"),supplyLayoutDefaults:y("./defaults"),draw:y("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("../../plots/plots"),M=y("../../registry"),e=y("../../lib"),a=e.strTranslate,n=y("../drawing"),r=y("../color"),t=y("../../lib/svg_text_utils"),h=y("../../constants/interactions"),s=y("../../constants/alignment").OPPOSITE_SIDE,i=/ [XY][0-9]* /;function x(p,v,f){var d=f.propContainer,o=f.propName,m=f.placeholder,l=f.traceIndex,w=f.avoid||{},_=f.attributes,c=f.transform,b=f.containerGroup,u=p._fullLayout,L=1,T=!1,k=d.title,P=(k&&k.text?k.text:"").trim(),z=k&&k.font?k.font:{},I=z.family,D=z.size,R=z.color,O;o==="title.text"?O="titleText":o.indexOf("axis")!==-1?O="axisTitleText":o.indexOf("colorbar"!==-1)&&(O="colorbarTitleText");var F=p._context.edits[O];P===""?L=0:P.replace(i," % ")===m.replace(i," % ")&&(L=.2,T=!0,F||(P="")),f._meta?P=e.templateString(P,f._meta):u._meta&&(P=e.templateString(P,u._meta));var N=P||F,G;b||(b=e.ensureSingle(u._infolayer,"g","g-"+v),G=u._hColorbarMoveTitle);var K=b.selectAll("text").data(N?[0]:[]);if(K.enter().append("text"),K.text(P).attr("class",v),K.exit().remove(),!N)return b;function W(j){e.syncOrAsync([Y,re],j)}function Y(j){var q;return!c&&G&&(c={}),c?(q="",c.rotate&&(q+="rotate("+[c.rotate,_.x,_.y]+")"),(c.offset||G)&&(q+=a(0,(c.offset||0)-(G||0)))):q=null,j.attr("transform",q),j.style({"font-family":I,"font-size":A.round(D,2)+"px",fill:r.rgb(R),opacity:L*r.opacity(R),"font-weight":S.fontWeight}).attr(_).call(t.convertToTspans,p),S.previousPromises(p)}function re(j){var q=A.select(j.node().parentNode);if(w&&w.selection&&w.side&&P){q.attr("transform",null);var H=s[w.side],U=w.side==="left"||w.side==="top"?-1:1,$=g(w.pad)?w.pad:2,ne=n.bBox(q.node()),X={left:0,top:0,right:u.width,bottom:u.height},Q=w.maxShift||U*(X[w.side]-ne[w.side]),ie=0;if(Q<0)ie=Q;else{var se=w.offsetLeft||0,ae=w.offsetTop||0;ne.left-=se,ne.right-=se,ne.top-=ae,ne.bottom-=ae,w.selection.each(function(){var be=n.bBox(this);e.bBoxIntersect(ne,be,$)&&(ie=Math.max(ie,U*(be[w.side]-ne[H])+$))}),ie=Math.min(Q,ie)}if(ie>0||Q<0){var oe={left:[-ie,0],right:[ie,0],top:[0,-ie],bottom:[0,ie]}[w.side];q.attr("transform",a(oe[0],oe[1]))}}}K.call(W);function ue(){L=0,T=!0,K.text(m).on("mouseover.opacity",function(){A.select(this).transition().duration(h.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){A.select(this).transition().duration(h.HIDE_PLACEHOLDER).style("opacity",0)})}return F&&(P?K.on(".opacity",null):ue(),K.call(t.makeEditable,{gd:p}).on("edit",function(j){l!==void 0?M.call("_guiRestyle",p,o,j,l):M.call("_guiRelayout",p,o,j)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(W)}).on("input",function(j){this.text(j||" ").call(t.positionText,_.x,_.y)})),K.classed("js-placeholder",T),b}ee.exports={draw:x}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(y,ee,te){var A=y("../../plots/font_attributes"),g=y("../color/attributes"),S=y("../../lib/extend").extendFlat,M=y("../../plot_api/edit_types").overrideAll,e=y("../../plots/pad_attributes"),a=y("../../plot_api/plot_template").templatedArray,n=a("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});ee.exports=M(a("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:n,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:S(e({editType:"arraydraw"}),{}),font:A({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:g.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(y,ee,te){ee.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"",right:"",up:"",down:""}}},{}],479:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/array_container_defaults"),S=y("./attributes"),M=y("./constants"),e=M.name,a=S.buttons;ee.exports=function(h,s){var i={name:e,handleItemDefaults:n};g(h,s,i)};function n(t,h,s){function i(v,f){return A.coerce(t,h,S,v,f)}var x=g(t,h,{name:"buttons",handleItemDefaults:r}),p=i("visible",x.length>0);p&&(i("active"),i("direction"),i("type"),i("showactive"),i("x"),i("y"),A.noneOrAll(t,h,["x","y"]),i("xanchor"),i("yanchor"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),A.coerceFont(i,"font",s.font),i("bgcolor",s.paper_bgcolor),i("bordercolor"),i("borderwidth"))}function r(t,h){function s(x,p){return A.coerce(t,h,a,x,p)}var i=s("visible",t.method==="skip"||Array.isArray(t.args));i&&(s("method"),s("args"),s("args2"),s("label"),s("execute"))}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../plots/plots"),S=y("../color"),M=y("../drawing"),e=y("../../lib"),a=y("../../lib/svg_text_utils"),n=y("../../plot_api/plot_template").arrayEditor,r=y("../../constants/alignment").LINE_SPACING,t=y("./constants"),h=y("./scrollbox");ee.exports=function(z){var I=z._fullLayout,D=e.filterVisible(I[t.name]);function R(re){g.autoMargin(z,L(re))}var O=I._menulayer.selectAll("g."+t.containerClassName).data(D.length>0?[0]:[]);if(O.enter().append("g").classed(t.containerClassName,!0).style("cursor","pointer"),O.exit().each(function(){A.select(this).selectAll("g."+t.headerGroupClassName).each(R)}).remove(),D.length!==0){var F=O.selectAll("g."+t.headerGroupClassName).data(D,s);F.enter().append("g").classed(t.headerGroupClassName,!0);for(var N=e.ensureSingle(O,"g",t.dropdownButtonGroupClassName,function(re){re.style("pointer-events","all")}),G=0;G<D.length;G++){var K=D[G];u(z,K)}var W="updatemenus"+I._uid,Y=new h(z,N,W);F.enter().size()&&(N.node().parentNode.appendChild(N.node()),N.call(k)),F.exit().each(function(re){N.call(k),R(re)}).remove(),F.each(function(re){var ue=A.select(this),j=re.type==="dropdown"?N:null;g.manageCommandObserver(z,re,re.buttons,function(q){p(z,re,re.buttons[q.index],ue,j,Y,q.index,!0)}),re.type==="dropdown"?(v(z,ue,N,Y,re),x(N,re)&&f(z,ue,N,Y,re)):f(z,ue,null,null,re)})}};function s(P){return P._index}function i(P){return+P.attr(t.menuIndexAttrName)==-1}function x(P,z){return+P.attr(t.menuIndexAttrName)===z._index}function p(P,z,I,D,R,O,F,N){z.active=F,n(P.layout,t.name,z).applyUpdate("active",F),z.type==="buttons"?f(P,D,null,null,z):z.type==="dropdown"&&(R.attr(t.menuIndexAttrName,"-1"),v(P,D,R,O,z),N||f(P,D,R,O,z))}function v(P,z,I,D,R){var O=e.ensureSingle(z,"g",t.headerClassName,function(re){re.style("pointer-events","all")}),F=R._dims,N=R.active,G=R.buttons[N]||t.blankHeaderOpts,K={y:R.pad.t,yPad:0,x:R.pad.l,xPad:0,index:0},W={width:F.headerWidth,height:F.headerHeight};O.call(m,R,G,P).call(T,R,K,W);var Y=e.ensureSingle(z,"text",t.headerArrowClassName,function(re){re.attr("text-anchor","end").call(M.font,R.font).text(t.arrowSymbol[R.direction])});Y.attr({x:F.headerWidth-t.arrowOffsetX+R.pad.l,y:F.headerHeight/2+t.textOffsetY+R.pad.t}),O.on("click",function(){I.call(k,String(x(I,R)?-1:R._index)),f(P,z,I,D,R)}),O.on("mouseover",function(){O.call(c)}),O.on("mouseout",function(){O.call(b,R)}),M.setTranslate(z,F.lx,F.ly)}function f(P,z,I,D,R){I||(I=z,I.attr("pointer-events","all"));var O=!i(I)||R.type==="buttons"?R.buttons:[],F=R.type==="dropdown"?t.dropdownButtonClassName:t.buttonClassName,N=I.selectAll("g."+F).data(e.filterVisible(O)),G=N.enter().append("g").classed(F,!0),K=N.exit();R.type==="dropdown"?(G.attr("opacity","0").transition().attr("opacity","1"),K.transition().attr("opacity","0").remove()):K.remove();var W=0,Y=0,re=R._dims,ue=["up","down"].indexOf(R.direction)!==-1;R.type==="dropdown"&&(ue?Y=re.headerHeight+t.gapButtonHeader:W=re.headerWidth+t.gapButtonHeader),R.type==="dropdown"&&R.direction==="up"&&(Y=-t.gapButtonHeader+t.gapButton-re.openHeight),R.type==="dropdown"&&R.direction==="left"&&(W=-t.gapButtonHeader+t.gapButton-re.openWidth);var j={x:re.lx+W+R.pad.l,y:re.ly+Y+R.pad.t,yPad:t.gapButton,xPad:t.gapButton,index:0},q={l:j.x+R.borderwidth,t:j.y+R.borderwidth};N.each(function(H,U){var $=A.select(this);$.call(m,R,H,P).call(T,R,j),$.on("click",function(){A.event.defaultPrevented||(H.execute&&(H.args2&&R.active===U?(p(P,R,H,z,I,D,-1),g.executeAPICommand(P,H.method,H.args2)):(p(P,R,H,z,I,D,U),g.executeAPICommand(P,H.method,H.args))),P.emit("plotly_buttonclicked",{menu:R,button:H,active:R.active}))}),$.on("mouseover",function(){$.call(c)}),$.on("mouseout",function(){$.call(b,R),N.call(_,R)})}),N.call(_,R),ue?(q.w=Math.max(re.openWidth,re.headerWidth),q.h=j.y-q.t):(q.w=j.x-q.l,q.h=Math.max(re.openHeight,re.headerHeight)),q.direction=R.direction,D&&(N.size()?d(P,z,I,D,R,q):o(D))}function d(P,z,I,D,R,O){var F=R.direction,N=F==="up"||F==="down",G=R._dims,K=R.active,W,Y,re;if(N)for(Y=0,re=0;re<K;re++)Y+=G.heights[re]+t.gapButton;else for(W=0,re=0;re<K;re++)W+=G.widths[re]+t.gapButton;D.enable(O,W,Y),D.hbar&&D.hbar.attr("opacity","0").transition().attr("opacity","1"),D.vbar&&D.vbar.attr("opacity","0").transition().attr("opacity","1")}function o(P){var z=!!P.hbar,I=!!P.vbar;z&&P.hbar.transition().attr("opacity","0").each("end",function(){z=!1,I||P.disable()}),I&&P.vbar.transition().attr("opacity","0").each("end",function(){I=!1,z||P.disable()})}function m(P,z,I,D){P.call(l,z).call(w,z,I,D)}function l(P,z){var I=e.ensureSingle(P,"rect",t.itemRectClassName,function(D){D.attr({rx:t.rx,ry:t.ry,"shape-rendering":"crispEdges"})});I.call(S.stroke,z.bordercolor).call(S.fill,z.bgcolor).style("stroke-width",z.borderwidth+"px")}function w(P,z,I,D){var R=e.ensureSingle(P,"text",t.itemTextClassName,function(N){N.attr({"text-anchor":"start","data-notex":1})}),O=I.label,F=D._fullLayout._meta;F&&(O=e.templateString(O,F)),R.call(M.font,z.font).text(O).call(a.convertToTspans,D)}function _(P,z){var I=z.active;P.each(function(D,R){var O=A.select(this);R===I&&z.showactive&&O.select("rect."+t.itemRectClassName).call(S.fill,t.activeColor)})}function c(P){P.select("rect."+t.itemRectClassName).call(S.fill,t.hoverColor)}function b(P,z){P.select("rect."+t.itemRectClassName).call(S.fill,z.bgcolor)}function u(P,z){var I=z._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},D=M.tester.selectAll("g."+t.dropdownButtonClassName).data(e.filterVisible(z.buttons));D.enter().append("g").classed(t.dropdownButtonClassName,!0);var R=["up","down"].indexOf(z.direction)!==-1;D.each(function(W,Y){var re=A.select(this);re.call(m,z,W,P);var ue=re.select("."+t.itemTextClassName),j=ue.node()&&M.bBox(ue.node()).width,q=Math.max(j+t.textPadX,t.minWidth),H=z.font.size*r,U=a.lineCount(ue),$=Math.max(H*U,t.minHeight)+t.textOffsetY;$=Math.ceil($),q=Math.ceil(q),I.widths[Y]=q,I.heights[Y]=$,I.height1=Math.max(I.height1,$),I.width1=Math.max(I.width1,q),R?(I.totalWidth=Math.max(I.totalWidth,q),I.openWidth=I.totalWidth,I.totalHeight+=$+t.gapButton,I.openHeight+=$+t.gapButton):(I.totalWidth+=q+t.gapButton,I.openWidth+=q+t.gapButton,I.totalHeight=Math.max(I.totalHeight,$),I.openHeight=I.totalHeight)}),R?I.totalHeight-=t.gapButton:I.totalWidth-=t.gapButton,I.headerWidth=I.width1+t.arrowPadX,I.headerHeight=I.height1,z.type==="dropdown"&&(R?(I.width1+=t.arrowPadX,I.totalHeight=I.height1):I.totalWidth=I.width1,I.totalWidth+=t.arrowPadX),D.remove();var O=I.totalWidth+z.pad.l+z.pad.r,F=I.totalHeight+z.pad.t+z.pad.b,N=P._fullLayout._size;I.lx=N.l+N.w*z.x,I.ly=N.t+N.h*(1-z.y);var G="left";e.isRightAnchor(z)&&(I.lx-=O,G="right"),e.isCenterAnchor(z)&&(I.lx-=O/2,G="center");var K="top";e.isBottomAnchor(z)&&(I.ly-=F,K="bottom"),e.isMiddleAnchor(z)&&(I.ly-=F/2,K="middle"),I.totalWidth=Math.ceil(I.totalWidth),I.totalHeight=Math.ceil(I.totalHeight),I.lx=Math.round(I.lx),I.ly=Math.round(I.ly),g.autoMargin(P,L(z),{x:z.x,y:z.y,l:O*({right:1,center:.5}[G]||0),r:O*({left:1,center:.5}[G]||0),b:F*({top:1,middle:.5}[K]||0),t:F*({bottom:1,middle:.5}[K]||0)})}function L(P){return t.autoMarginIdRoot+P._index}function T(P,z,I,D){D=D||{};var R=P.select("."+t.itemRectClassName),O=P.select("."+t.itemTextClassName),F=z.borderwidth,N=I.index,G=z._dims;M.setTranslate(P,F+I.x,F+I.y);var K=["up","down"].indexOf(z.direction)!==-1,W=D.height||(K?G.heights[N]:G.height1);R.attr({x:0,y:0,width:D.width||(K?G.width1:G.widths[N]),height:W});var Y=z.font.size*r,re=a.lineCount(O),ue=(re-1)*Y/2;a.positionText(O,t.textOffsetX,W/2-ue+t.textOffsetY),K?I.y+=G.heights[N]+I.yPad:I.x+=G.widths[N]+I.xPad,I.index++}function k(P,z){P.attr(t.menuIndexAttrName,z||"-1").selectAll("g."+t.dropdownButtonClassName).remove()}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(y,ee,te){arguments[4][475][0].apply(te,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(y,ee,te){ee.exports=e;var A=y("@plotly/d3"),g=y("../color"),S=y("../drawing"),M=y("../../lib");function e(a,n,r){this.gd=a,this.container=n,this.id=r,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(n,r,t){var h=this.gd._fullLayout,s=h.width,i=h.height;this.position=n;var x=this.position.l,p=this.position.w,v=this.position.t,f=this.position.h,d=this.position.direction,o=d==="down",m=d==="left",l=d==="right",w=d==="up",_=p,c=f,b,u,L,T;!o&&!m&&!l&&!w&&(this.position.direction="down",o=!0);var k=o||w;k?(b=x,u=b+_,o?(L=v,T=Math.min(L+c,i),c=T-L):(T=v+c,L=Math.max(T-c,0),c=T-L)):(L=v,T=L+c,m?(u=x+_,b=Math.max(u-_,0),_=u-b):(b=x,u=Math.min(b+_,s),_=u-b)),this._box={l:b,t:L,w:_,h:c};var P=p>_,z=e.barLength+2*e.barPad,I=e.barWidth+2*e.barPad,D=x,R=v+f;R+I>i&&(R=i-I);var O=this.container.selectAll("rect.scrollbar-horizontal").data(P?[0]:[]);O.exit().on(".drag",null).remove(),O.enter().append("rect").classed("scrollbar-horizontal",!0).call(g.fill,e.barColor),P?(this.hbar=O.attr({rx:e.barRadius,ry:e.barRadius,x:D,y:R,width:z,height:I}),this._hbarXMin=D+z/2,this._hbarTranslateMax=_-z):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var F=f>c,N=e.barWidth+2*e.barPad,G=e.barLength+2*e.barPad,K=x+p,W=v;K+N>s&&(K=s-N);var Y=this.container.selectAll("rect.scrollbar-vertical").data(F?[0]:[]);Y.exit().on(".drag",null).remove(),Y.enter().append("rect").classed("scrollbar-vertical",!0).call(g.fill,e.barColor),F?(this.vbar=Y.attr({rx:e.barRadius,ry:e.barRadius,x:K,y:W,width:N,height:G}),this._vbarYMin=W+G/2,this._vbarTranslateMax=c-G):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var re=this.id,ue=b-.5,j=F?u+N+.5:u+.5,q=L-.5,H=P?T+I+.5:T+.5,U=h._topdefs.selectAll("#"+re).data(P||F?[0]:[]);if(U.exit().remove(),U.enter().append("clipPath").attr("id",re).append("rect"),P||F?(this._clipRect=U.select("rect").attr({x:Math.floor(ue),y:Math.floor(q),width:Math.ceil(j)-Math.floor(ue),height:Math.ceil(H)-Math.floor(q)}),this.container.call(S.setClipUrl,re,this.gd),this.bg.attr({x,y:v,width:p,height:f})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(S.setClipUrl,null),delete this._clipRect),P||F){var $=A.behavior.drag().on("dragstart",function(){A.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call($);var ne=A.behavior.drag().on("dragstart",function(){A.event.sourceEvent.preventDefault(),A.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));P&&this.hbar.on(".drag",null).call(ne),F&&this.vbar.on(".drag",null).call(ne)}this.setTranslate(r,t)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(S.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var n=this.translateX,r=this.translateY;this.hbar&&(n-=A.event.dx),this.vbar&&(r-=A.event.dy),this.setTranslate(n,r)},e.prototype._onBoxWheel=function(){var n=this.translateX,r=this.translateY;this.hbar&&(n+=A.event.deltaY),this.vbar&&(r+=A.event.deltaY),this.setTranslate(n,r)},e.prototype._onBarDrag=function(){var n=this.translateX,r=this.translateY;if(this.hbar){var t=n+this._hbarXMin,h=t+this._hbarTranslateMax,s=M.constrain(A.event.x,t,h),i=(s-t)/(h-t),x=this.position.w-this._box.w;n=i*x}if(this.vbar){var p=r+this._vbarYMin,v=p+this._vbarTranslateMax,f=M.constrain(A.event.y,p,v),d=(f-p)/(v-p),o=this.position.h-this._box.h;r=d*o}this.setTranslate(n,r)},e.prototype.setTranslate=function(n,r){var t=this.position.w-this._box.w,h=this.position.h-this._box.h;if(n=M.constrain(n||0,0,t),r=M.constrain(r||0,0,h),this.translateX=n,this.translateY=r,this.container.call(S.setTranslate,this._box.l-this.position.l-n,this._box.t-this.position.t-r),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+n-.5),y:Math.floor(this.position.t+r-.5)}),this.hbar){var s=n/t;this.hbar.call(S.setTranslate,n+s*this._hbarTranslateMax,r)}if(this.vbar){var i=r/h;this.vbar.call(S.setTranslate,n,r+i*this._vbarTranslateMax)}}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(y,ee,te){ee.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(y,ee,te){ee.exports={axisRefDescription:function(A,g,S){return["If set to a",A,"axis id (e.g. *"+A+"* or","*"+A+"2*), the `"+A+"` position refers to a",A,"coordinate. If set to *paper*, the `"+A+"`","position refers to the distance from the",g,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",g,"("+S+"). If set to a",A,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",g,"of the domain of that axis: e.g.,","*"+A+"2 domain* refers to the domain of the second",A," axis and a",A,"position of 0.5 refers to the","point between the",g,"and the",S,"of the domain of the","second",A,"axis."].join(" ")}}},{}],485:[function(y,ee,te){ee.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:""},DECREASING:{COLOR:"#FF4136",SYMBOL:""}}},{}],486:[function(y,ee,te){ee.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(y,ee,te){ee.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(y,ee,te){ee.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(y,ee,te){ee.exports={circle:"","circle-open":"",square:"","square-open":"",diamond:"","diamond-open":"",cross:"+",x:""}},{}],490:[function(y,ee,te){ee.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(y,ee,te){ee.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE*1e-4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:""}},{}],492:[function(y,ee,te){te.xmlns="http://www.w3.org/2000/xmlns/",te.svg="http://www.w3.org/2000/svg",te.xlink="http://www.w3.org/1999/xlink",te.svgAttrs={xmlns:te.svg,"xmlns:xlink":te.xlink}},{}],493:[function(y,ee,te){te.version=y("./version").version,y("native-promise-only"),y("../build/plotcss");for(var A=y("./registry"),g=te.register=A.register,S=y("./plot_api"),M=Object.keys(S),e=0;e<M.length;e++){var a=M[e];a.charAt(0)!=="_"&&(te[a]=S[a]),g({moduleType:"apiMethod",name:a,fn:S[a]})}g(y("./traces/scatter")),g([y("./components/legend"),y("./components/fx"),y("./components/annotations"),y("./components/annotations3d"),y("./components/selections"),y("./components/shapes"),y("./components/images"),y("./components/updatemenus"),y("./components/sliders"),y("./components/rangeslider"),y("./components/rangeselector"),y("./components/grid"),y("./components/errorbars"),y("./components/colorscale"),y("./components/colorbar"),y("./components/modebar")]),g([y("./locale-en"),y("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(g(window.PlotlyLocales),delete window.PlotlyLocales),te.Icons=y("./fonts/ploticon");var n=y("./components/fx"),r=y("./plots/plots");te.Plots={resize:r.resize,graphJson:r.graphJson,sendDataToCloud:r.sendDataToCloud},te.Fx={hover:n.hover,unhover:n.unhover,loneHover:n.loneHover,loneUnhover:n.loneUnhover},te.Snapshot=y("./snapshot"),te.PlotSchema=y("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(y,ee,te){ee.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(y,ee,te){te.isLeftAnchor=function(g){return g.xanchor==="left"||g.xanchor==="auto"&&g.x<=1/3},te.isCenterAnchor=function(g){return g.xanchor==="center"||g.xanchor==="auto"&&g.x>1/3&&g.x<2/3},te.isRightAnchor=function(g){return g.xanchor==="right"||g.xanchor==="auto"&&g.x>=2/3},te.isTopAnchor=function(g){return g.yanchor==="top"||g.yanchor==="auto"&&g.y>=2/3},te.isMiddleAnchor=function(g){return g.yanchor==="middle"||g.yanchor==="auto"&&g.y>1/3&&g.y<2/3},te.isBottomAnchor=function(g){return g.yanchor==="bottom"||g.yanchor==="auto"&&g.y<=1/3}},{}],496:[function(y,ee,te){var A=y("./mod"),g=A.mod,S=A.modHalf,M=Math.PI,e=2*M;function a(d){return d/180*M}function n(d){return d/M*180}function r(d){return Math.abs(d[1]-d[0])>e-1e-14}function t(d,o){return S(o-d,e)}function h(d,o){return Math.abs(t(d,o))}function s(d,o){if(r(o))return!0;var m,l;o[0]<o[1]?(m=o[0],l=o[1]):(m=o[1],l=o[0]),m=g(m,e),l=g(l,e),m>l&&(l+=e);var w=g(d,e),_=w+e;return w>=m&&w<=l||_>=m&&_<=l}function i(d,o,m,l){if(!s(o,l))return!1;var w,_;return m[0]<m[1]?(w=m[0],_=m[1]):(w=m[1],_=m[0]),d>=w&&d<=_}function x(d,o,m,l,w,_,c){w=w||0,_=_||0;var b=r([m,l]),u,L,T,k,P;b?(u=0,L=M,T=e):m<l?(u=m,T=l):(u=l,T=m),d<o?(k=d,P=o):(k=o,P=d);function z(O,F){return[O*Math.cos(F)+w,_-O*Math.sin(F)]}var I=Math.abs(T-u)<=M?0:1;function D(O,F,N){return"A"+[O,O]+" "+[0,I,N]+" "+z(O,F)}var R;return b?k===null?R="M"+z(P,u)+D(P,L,0)+D(P,T,0)+"Z":R="M"+z(k,u)+D(k,L,0)+D(k,T,0)+"ZM"+z(P,u)+D(P,L,1)+D(P,T,1)+"Z":k===null?(R="M"+z(P,u)+D(P,T,0),c&&(R+="L0,0Z")):R="M"+z(k,u)+"L"+z(P,u)+D(P,T,0)+"L"+z(k,T)+D(k,u,1)+"Z",R}function p(d,o,m,l,w){return x(null,d,o,m,l,w,0)}function v(d,o,m,l,w){return x(null,d,o,m,l,w,1)}function f(d,o,m,l,w,_){return x(d,o,m,l,w,_,1)}ee.exports={deg2rad:a,rad2deg:n,angleDelta:t,angleDist:h,isFullCircle:r,isAngleInsideSector:s,isPtInsideSector:i,pathArc:p,pathSector:v,pathAnnulus:f}},{"./mod":522}],497:[function(y,ee,te){var A=Array.isArray,g=ArrayBuffer,S=DataView;function M(r){return g.isView(r)&&!(r instanceof S)}te.isTypedArray=M;function e(r){return A(r)||M(r)}te.isArrayOrTypedArray=e;function a(r){return!e(r[0])}te.isArray1D=a,te.ensureArray=function(r,t){return A(r)||(r=[]),r.length=t,r},te.concat=function(){var r=[],t=!0,h=0,s,i,x,p,v,f,d,o;for(x=0;x<arguments.length;x++)p=arguments[x],f=p.length,f&&(i?r.push(p):(i=p,v=f),A(p)?s=!1:(t=!1,h?s!==p.constructor&&(s=!1):s=p.constructor),h+=f);if(!h)return[];if(!r.length)return i;if(t)return i.concat.apply(i,r);if(s){for(d=new s(h),d.set(i),x=0;x<r.length;x++)p=r[x],d.set(p,v),v+=p.length;return d}for(d=new Array(h),o=0;o<i.length;o++)d[o]=i[o];for(x=0;x<r.length;x++){for(p=r[x],o=0;o<p.length;o++)d[v+o]=p[o];v+=o}return d},te.maxRowLength=function(r){return n(r,Math.max,0)},te.minRowLength=function(r){return n(r,Math.min,1/0)};function n(r,t,h){if(e(r))if(e(r[0])){for(var s=h,i=0;i<r.length;i++)s=t(s,r[i].length);return s}else return r.length;return 0}},{}],498:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../constants/numerical").BADNUM,S=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;ee.exports=function(e){return typeof e=="string"&&(e=e.replace(S,"")),A(e)?Number(e):g}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(y,ee,te){ee.exports=function(g){var S=g._fullLayout;S._glcanvas&&S._glcanvas.size()&&S._glcanvas.each(function(M){M.regl&&M.regl.clear({color:!0,depth:!0})})}},{}],500:[function(y,ee,te){ee.exports=function(g){g._responsiveChartHandler&&(window.removeEventListener("resize",g._responsiveChartHandler),delete g._responsiveChartHandler)}},{}],501:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("tinycolor2"),S=y("../plots/attributes"),M=y("../components/colorscale/scales"),e=y("../components/color"),a=y("../constants/interactions").DESELECTDIM,n=y("./nested_property"),r=y("./regex").counter,t=y("./mod").modHalf,h=y("./array").isArrayOrTypedArray;te.valObjectMeta={data_array:{coerceFunction:function(i,x,p){h(i)?x.set(i):p!==void 0&&x.set(p)}},enumerated:{coerceFunction:function(i,x,p,v){v.coerceNumber&&(i=+i),v.values.indexOf(i)===-1?x.set(p):x.set(i)},validateFunction:function(i,x){x.coerceNumber&&(i=+i);for(var p=x.values,v=0;v<p.length;v++){var f=String(p[v]);if(f.charAt(0)==="/"&&f.charAt(f.length-1)==="/"){var d=new RegExp(f.substr(1,f.length-2));if(d.test(i))return!0}else if(i===p[v])return!0}return!1}},boolean:{coerceFunction:function(i,x,p){i===!0||i===!1?x.set(i):x.set(p)}},number:{coerceFunction:function(i,x,p,v){!A(i)||v.min!==void 0&&i<v.min||v.max!==void 0&&i>v.max?x.set(p):x.set(+i)}},integer:{coerceFunction:function(i,x,p,v){i%1||!A(i)||v.min!==void 0&&i<v.min||v.max!==void 0&&i>v.max?x.set(p):x.set(+i)}},string:{coerceFunction:function(i,x,p,v){if(typeof i!="string"){var f=typeof i=="number";v.strict===!0||!f?x.set(p):x.set(String(i))}else v.noBlank&&!i?x.set(p):x.set(i)}},color:{coerceFunction:function(i,x,p){g(i).isValid()?x.set(i):x.set(p)}},colorlist:{coerceFunction:function(i,x,p){function v(f){return g(f).isValid()}!Array.isArray(i)||!i.length?x.set(p):i.every(v)?x.set(i):x.set(p)}},colorscale:{coerceFunction:function(i,x,p){x.set(M.get(i,p))}},angle:{coerceFunction:function(i,x,p){i==="auto"?x.set("auto"):A(i)?x.set(t(+i,360)):x.set(p)}},subplotid:{coerceFunction:function(i,x,p,v){var f=v.regex||r(p);if(typeof i=="string"&&f.test(i)){x.set(i);return}x.set(p)},validateFunction:function(i,x){var p=x.dflt;return i===p?!0:typeof i!="string"?!1:!!r(p).test(i)}},flaglist:{coerceFunction:function(i,x,p,v){if((v.extras||[]).indexOf(i)!==-1){x.set(i);return}if(typeof i!="string"){x.set(p);return}for(var f=i.split("+"),d=0;d<f.length;){var o=f[d];v.flags.indexOf(o)===-1||f.indexOf(o)<d?f.splice(d,1):d++}f.length?x.set(f.join("+")):x.set(p)}},any:{coerceFunction:function(i,x,p){i===void 0?x.set(p):x.set(i)}},info_array:{coerceFunction:function(i,x,p,v){function f(z,I,D){var R,O={set:function(F){R=F}};return D===void 0&&(D=I.dflt),te.valObjectMeta[I.valType].coerceFunction(z,O,D,I),R}var d=v.dimensions===2||v.dimensions==="1-2"&&Array.isArray(i)&&Array.isArray(i[0]);if(!Array.isArray(i)){x.set(p);return}var o=v.items,m=[],l=Array.isArray(o),w=l&&d&&Array.isArray(o[0]),_=d&&l&&!w,c=l&&!_?o.length:i.length,b,u,L,T,k,P;if(p=Array.isArray(p)?p:[],d)for(b=0;b<c;b++)for(m[b]=[],L=Array.isArray(i[b])?i[b]:[],_?k=o.length:l?k=o[b].length:k=L.length,u=0;u<k;u++)_?T=o[u]:l?T=o[b][u]:T=o,P=f(L[u],T,(p[b]||[])[u]),P!==void 0&&(m[b][u]=P);else for(b=0;b<c;b++)P=f(i[b],l?o[b]:o,p[b]),P!==void 0&&(m[b]=P);x.set(m)},validateFunction:function(i,x){if(!Array.isArray(i))return!1;var p=x.items,v=Array.isArray(p),f=x.dimensions===2;if(!x.freeLength&&i.length!==p.length)return!1;for(var d=0;d<i.length;d++)if(f){if(!Array.isArray(i[d])||!x.freeLength&&i[d].length!==p[d].length)return!1;for(var o=0;o<i[d].length;o++)if(!s(i[d][o],v?p[d][o]:p))return!1}else if(!s(i[d],v?p[d]:p))return!1;return!0}}},te.coerce=function(i,x,p,v,f){var d=n(p,v).get(),o=n(i,v),m=n(x,v),l=o.get(),w=x._template;if(l===void 0&&w&&(l=n(w,v).get(),w=0),f===void 0&&(f=d.dflt),d.arrayOk&&h(l))return m.set(l),l;var _=te.valObjectMeta[d.valType].coerceFunction;_(l,m,f,d);var c=m.get();return w&&c===f&&!s(l,d)&&(l=n(w,v).get(),_(l,m,f,d),c=m.get()),c},te.coerce2=function(i,x,p,v,f){var d=n(i,v),o=te.coerce(i,x,p,v,f),m=d.get();return m!=null?o:!1},te.coerceFont=function(i,x,p){var v={};return p=p||{},v.family=i(x+".family",p.family),v.size=i(x+".size",p.size),v.color=i(x+".color",p.color),v},te.coercePattern=function(i,x,p,v){var f=i(x+".shape");if(f){i(x+".solidity"),i(x+".size");var d=i(x+".fillmode"),o=d==="overlay";if(!v){var m=i(x+".bgcolor",o?p:void 0);i(x+".fgcolor",o?e.contrast(m):p)}i(x+".fgopacity",o?.5:1)}},te.coerceHoverinfo=function(i,x,p){var v=x._module.attributes,f=v.hoverinfo?v:S,d=f.hoverinfo,o;if(p._dataLength===1){var m=d.dflt==="all"?d.flags.slice():d.dflt.split("+");m.splice(m.indexOf("name"),1),o=m.join("+")}return te.coerce(i,x,f,"hoverinfo",o)},te.coerceSelectionMarkerOpacity=function(i,x){if(i.marker){var p=i.marker.opacity;if(p!==void 0){var v,f;!h(p)&&!i.selected&&!i.unselected&&(v=p,f=a*p),x("selected.marker.opacity",v),x("unselected.marker.opacity",f)}}};function s(i,x){var p=te.valObjectMeta[x.valType];if(x.arrayOk&&h(i))return!0;if(p.validateFunction)return p.validateFunction(i,x);var v={},f=v,d={set:function(o){f=o}};return p.coerceFunction(i,d,v,x),f!==v}te.validate=s},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(y,ee,te){var A=y("d3-time-format").timeFormat,g=y("fast-isnumeric"),S=y("./loggers"),M=y("./mod").mod,e=y("../constants/numerical"),a=e.BADNUM,n=e.ONEDAY,r=e.ONEHOUR,t=e.ONEMIN,h=e.ONESEC,s=e.EPOCHJD,i=y("../registry"),x=y("d3-time-format").utcFormat,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,v=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,f=new Date().getFullYear()-70;function d(R){return R&&i.componentsRegistry.calendars&&typeof R=="string"&&R!=="gregorian"}te.dateTick0=function(R,O){var F=o(R,!!O);if(O<2)return F;var N=te.dateTime2ms(F,R);return N+=n*(O-1),te.ms2DateTime(N,0,R)};function o(R,O){return d(R)?O?i.getComponentMethod("calendars","CANONICAL_SUNDAY")[R]:i.getComponentMethod("calendars","CANONICAL_TICK")[R]:O?"2000-01-02":"2000-01-01"}te.dfltRange=function(R){return d(R)?i.getComponentMethod("calendars","DFLTRANGE")[R]:["2000-01-01","2001-01-01"]},te.isJSDate=function(R){return typeof R=="object"&&R!==null&&typeof R.getTime=="function"};var m,l;te.dateTime2ms=function(R,O){if(te.isJSDate(R)){var F=R.getTimezoneOffset()*t,N=(R.getUTCMinutes()-R.getMinutes())*t+(R.getUTCSeconds()-R.getSeconds())*h+(R.getUTCMilliseconds()-R.getMilliseconds());if(N){var G=3*t;F=F-G/2+M(N-F+G/2,G)}return R=Number(R)-F,R>=m&&R<=l?R:a}if(typeof R!="string"&&typeof R!="number")return a;R=String(R);var K=d(O),W=R.charAt(0);K&&(W==="G"||W==="g")&&(R=R.substr(1),O="");var Y=K&&O.substr(0,7)==="chinese",re=R.match(Y?v:p);if(!re)return a;var ue=re[1],j=re[3]||"1",q=Number(re[5]||1),H=Number(re[7]||0),U=Number(re[9]||0),$=Number(re[11]||0);if(K){if(ue.length===2)return a;ue=Number(ue);var ne;try{var X=i.getComponentMethod("calendars","getCal")(O);if(Y){var Q=j.charAt(j.length-1)==="i";j=parseInt(j,10),ne=X.newDate(ue,X.toMonthIndex(ue,j,Q),q)}else ne=X.newDate(ue,Number(j),q)}catch{return a}return ne?(ne.toJD()-s)*n+H*r+U*t+$*h:a}ue.length===2?ue=(Number(ue)+2e3-f)%100+f:ue=Number(ue),j-=1;var ie=new Date(Date.UTC(2e3,j,q,H,U));return ie.setUTCFullYear(ue),ie.getUTCMonth()!==j||ie.getUTCDate()!==q?a:ie.getTime()+$*h},m=te.MIN_MS=te.dateTime2ms("-9999"),l=te.MAX_MS=te.dateTime2ms("9999-12-31 23:59:59.9999"),te.isDateTime=function(R,O){return te.dateTime2ms(R,O)!==a};function w(R,O){return String(R+Math.pow(10,O)).substr(1)}var _=90*n,c=3*r,b=5*t;te.ms2DateTime=function(R,O,F){if(typeof R!="number"||!(R>=m&&R<=l))return a;O||(O=0);var N=Math.floor(M(R+.05,1)*10),G=Math.round(R-N/10),K,W,Y,re,ue,j;if(d(F)){var q=Math.floor(G/n)+s,H=Math.floor(M(R,n));try{K=i.getComponentMethod("calendars","getCal")(F).fromJD(q).formatDate("yyyy-mm-dd")}catch{K=x("G%Y-%m-%d")(new Date(G))}if(K.charAt(0)==="-")for(;K.length<11;)K="-0"+K.substr(1);else for(;K.length<10;)K="0"+K;W=O<_?Math.floor(H/r):0,Y=O<_?Math.floor(H%r/t):0,re=O<c?Math.floor(H%t/h):0,ue=O<b?H%h*10+N:0}else j=new Date(G),K=x("%Y-%m-%d")(j),W=O<_?j.getUTCHours():0,Y=O<_?j.getUTCMinutes():0,re=O<c?j.getUTCSeconds():0,ue=O<b?j.getUTCMilliseconds()*10+N:0;return u(K,W,Y,re,ue)},te.ms2DateTimeLocal=function(R){if(!(R>=m+n&&R<=l-n))return a;var O=Math.floor(M(R+.05,1)*10),F=new Date(Math.round(R-O/10)),N=A("%Y-%m-%d")(F),G=F.getHours(),K=F.getMinutes(),W=F.getSeconds(),Y=F.getUTCMilliseconds()*10+O;return u(N,G,K,W,Y)};function u(R,O,F,N,G){if((O||F||N||G)&&(R+=" "+w(O,2)+":"+w(F,2),(N||G)&&(R+=":"+w(N,2),G))){for(var K=4;G%10===0;)K-=1,G/=10;R+="."+w(G,K)}return R}te.cleanDate=function(R,O,F){if(R===a)return O;if(te.isJSDate(R)||typeof R=="number"&&isFinite(R)){if(d(F))return S.error("JS Dates and milliseconds are incompatible with world calendars",R),O;if(R=te.ms2DateTimeLocal(+R),!R&&O!==void 0)return O}else if(!te.isDateTime(R,F))return S.error("unrecognized date",R),O;return R};var L=/%\d?f/g,T=/%h/g,k={1:"1",2:"1",3:"2",4:"2"};function P(R,O,F,N){R=R.replace(L,function(K){var W=Math.min(+K.charAt(1)||6,6),Y=(O/1e3%1+2).toFixed(W).substr(2).replace(/0+$/,"")||"0";return Y});var G=new Date(Math.floor(O+.05));if(R=R.replace(T,function(){return k[F("%q")(G)]}),d(N))try{R=i.getComponentMethod("calendars","worldCalFmt")(R,O,N)}catch{return"Invalid"}return F(R)(G)}var z=[59,59.9,59.99,59.999,59.9999];function I(R,O){var F=M(R+.05,n),N=w(Math.floor(F/r),2)+":"+w(M(Math.floor(F/t),60),2);if(O!=="M"){g(O)||(O=0);var G=Math.min(M(R/h,60),z[O]),K=(100+G).toFixed(O).substr(1);O>0&&(K=K.replace(/0+$/,"").replace(/[\.]$/,"")),N+=":"+K}return N}te.formatDate=function(R,O,F,N,G,K){if(G=d(G)&&G,!O)if(F==="y")O=K.year;else if(F==="m")O=K.month;else if(F==="d")O=K.dayMonth+`
`+K.year;else return I(R,F)+`
`+P(K.dayMonthYear,R,N,G);return P(O,R,N,G)};var D=3*n;te.incrementMonth=function(R,O,F){F=d(F)&&F;var N=M(R,n);if(R=Math.round(R-N),F)try{var G=Math.round(R/n)+s,K=i.getComponentMethod("calendars","getCal")(F),W=K.fromJD(G);return O%12?K.add(W,O,"m"):K.add(W,O/12,"y"),(W.toJD()-s)*n+N}catch{S.error("invalid ms "+R+" in calendar "+F)}var Y=new Date(R+D);return Y.setUTCMonth(Y.getUTCMonth()+O)+N-D},te.findExactDates=function(R,O){for(var F=0,N=0,G=0,K=0,W,Y,re=d(O)&&i.getComponentMethod("calendars","getCal")(O),ue=0;ue<R.length;ue++){if(Y=R[ue],!g(Y)){K++;continue}if(!(Y%n))if(re)try{W=re.fromJD(Y/n+s),W.day()===1?W.month()===1?F++:N++:G++}catch{}else W=new Date(Y),W.getUTCDate()===1?W.getUTCMonth()===0?F++:N++:G++}N+=F,G+=N;var j=R.length-K;return{exactYears:F/j,exactMonths:N/j,exactDays:G/j}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(y,ee,te){var A=y("@plotly/d3"),g=y("./loggers"),S=y("./matrix"),M=y("gl-mat4");function e(f){var d;if(typeof f=="string"){if(d=document.getElementById(f),d===null)throw new Error("No DOM element with id '"+f+"' exists on the page.");return d}else if(f==null)throw new Error("DOM element provided is null or undefined");return f}function a(f){var d=A.select(f);return d.node()instanceof HTMLElement&&d.size()&&d.classed("js-plotly-plot")}function n(f){var d=f&&f.parentNode;d&&d.removeChild(f)}function r(f,d){t("global",f,d)}function t(f,d,o){var m="plotly.js-style-"+f,l=document.getElementById(m);l||(l=document.createElement("style"),l.setAttribute("id",m),l.appendChild(document.createTextNode("")),document.head.appendChild(l));var w=l.sheet;w.insertRule?w.insertRule(d+"{"+o+"}",0):w.addRule?w.addRule(d,o,0):g.warn("addStyleRule failed")}function h(f){var d="plotly.js-style-"+f,o=document.getElementById(d);o&&n(o)}function s(f){var d=x(f),o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return d.forEach(function(m){var l=i(m);if(l){var w=S.convertCssMatrix(l);o=M.multiply(o,o,w)}}),o}function i(f){var d=window.getComputedStyle(f,null),o=d.getPropertyValue("-webkit-transform")||d.getPropertyValue("-moz-transform")||d.getPropertyValue("-ms-transform")||d.getPropertyValue("-o-transform")||d.getPropertyValue("transform");return o==="none"?null:o.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(m){return+m})}function x(f){for(var d=[];p(f);)d.push(f),f=f.parentNode;return d}function p(f){return f&&(f instanceof Element||f instanceof HTMLElement)}function v(f,d){return f&&d&&f.x===d.x&&f.y===d.y&&f.top===d.top&&f.left===d.left&&f.right===d.right&&f.bottom===d.bottom}ee.exports={getGraphDiv:e,isPlotDiv:a,removeElement:n,addStyleRule:r,addRelatedStyleRule:t,deleteRelatedStyleRule:h,getFullTransformMatrix:s,getElementTransformMatrix:i,getElementAndAncestors:x,equalDomRects:v}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(y,ee,te){var A=y("events").EventEmitter,g={init:function(S){if(S._ev instanceof A)return S;var M=new A,e=new A;return S._ev=M,S._internalEv=e,S.on=M.on.bind(M),S.once=M.once.bind(M),S.removeListener=M.removeListener.bind(M),S.removeAllListeners=M.removeAllListeners.bind(M),S._internalOn=e.on.bind(e),S._internalOnce=e.once.bind(e),S._removeInternalListener=e.removeListener.bind(e),S._removeAllInternalListeners=e.removeAllListeners.bind(e),S.emit=function(a,n){typeof jQuery<"u"&&jQuery(S).trigger(a,n),M.emit(a,n),e.emit(a,n)},S},triggerHandler:function(S,M,e){var a,n;typeof jQuery<"u"&&(a=jQuery(S).triggerHandler(M,e));var r=S._ev;if(!r)return a;var t=r._events[M];if(!t)return a;function h(i){if(i.listener){if(r.removeListener(M,i.listener),!i.fired)return i.fired=!0,i.listener.apply(r,[e])}else return i.apply(r,[e])}t=Array.isArray(t)?t:[t];var s;for(s=0;s<t.length-1;s++)h(t[s]);return n=h(t[s]),a!==void 0?a:n},purge:function(S){return delete S._ev,delete S.on,delete S.once,delete S.removeListener,delete S.removeAllListeners,delete S.emit,delete S._ev,delete S._internalEv,delete S._internalOn,delete S._internalOnce,delete S._removeInternalListener,delete S._removeAllInternalListeners,S}};ee.exports=g},{events:84}],505:[function(y,ee,te){var A=y("./is_plain_object.js"),g=Array.isArray;function S(e,a){var n,r;for(n=0;n<e.length;n++){if(r=e[n],r!==null&&typeof r=="object")return!1;r!==void 0&&(a[n]=r)}return!0}te.extendFlat=function(){return M(arguments,!1,!1,!1)},te.extendDeep=function(){return M(arguments,!0,!1,!1)},te.extendDeepAll=function(){return M(arguments,!0,!0,!1)},te.extendDeepNoArrays=function(){return M(arguments,!0,!1,!0)};function M(e,a,n,r){var t=e[0],h=e.length,s,i,x,p,v,f,d;if(h===2&&g(t)&&g(e[1])&&t.length===0){if(d=S(e[1],t),d)return t;t.splice(0,t.length)}for(var o=1;o<h;o++){s=e[o];for(i in s)x=t[i],p=s[i],r&&g(p)?t[i]=p:a&&p&&(A(p)||(v=g(p)))?(v?(v=!1,f=x&&g(x)?x:[]):f=x&&A(x)?x:{},t[i]=M([f,p],a,n,r)):(typeof p<"u"||n)&&(t[i]=p)}return t}},{"./is_plain_object.js":516}],506:[function(y,ee,te){ee.exports=function(g){for(var S={},M=[],e=0,a=0;a<g.length;a++){var n=g[a];S[n]!==1&&(S[n]=1,M[e++]=n)}return M}},{}],507:[function(y,ee,te){ee.exports=function(e){for(var a=S(e)?g:A,n=[],r=0;r<e.length;r++){var t=e[r];a(t)&&n.push(t)}return n};function A(M){return M.visible===!0}function g(M){var e=M[0].trace;return e.visible===!0&&e._length!==0}function S(M){return Array.isArray(M)&&Array.isArray(M[0])&&M[0][0]&&M[0][0].trace}},{}],508:[function(y,ee,te){var A=y("@plotly/d3"),g=y("country-regex"),S=y("@turf/area"),M=y("@turf/centroid"),e=y("@turf/bbox"),a=y("./identity"),n=y("./loggers"),r=y("./is_plain_object"),t=y("./nested_property"),h=y("./polygon"),s=Object.keys(g),i={"ISO-3":a,"USA-states":a,"country names":x};function x(w){for(var _=0;_<s.length;_++){var c=s[_],b=new RegExp(g[c]);if(b.test(w.trim().toLowerCase()))return c}return n.log("Unrecognized country name: "+w+"."),!1}function p(w,_,c){if(!_||typeof _!="string")return!1;var b=i[w](_),u,L,T;if(b){if(w==="USA-states")for(u=[],T=0;T<c.length;T++)L=c[T],L.properties&&L.properties.gu&&L.properties.gu==="USA"&&u.push(L);else u=c;for(T=0;T<u.length;T++)if(L=u[T],L.id===b)return L;n.log(["Location with id",b,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}function v(w){var _=w.geometry,c=_.coordinates,b=w.id,u=[],L,T,k,P;function z(I){for(var D=0;D<I.length-1;D++)if(I[D][0]>0&&I[D+1][0]<0)return D;return null}switch(b==="RUS"||b==="FJI"?L=function(I){var D;if(z(I)===null)D=I;else for(D=new Array(I.length),P=0;P<I.length;P++)D[P]=[I[P][0]<0?I[P][0]+360:I[P][0],I[P][1]];u.push(h.tester(D))}:b==="ATA"?L=function(I){var D=z(I);if(D===null)return u.push(h.tester(I));var R=new Array(I.length+1),O=0;for(P=0;P<I.length;P++)P>D?R[O++]=[I[P][0]+360,I[P][1]]:P===D?(R[O++]=I[P],R[O++]=[I[P][0],-90]):R[O++]=I[P];var F=h.tester(R);F.pts.pop(),u.push(F)}:L=function(I){u.push(h.tester(I))},_.type){case"MultiPolygon":for(T=0;T<c.length;T++)for(k=0;k<c[T].length;k++)L(c[T][k]);break;case"Polygon":for(T=0;T<c.length;T++)L(c[T]);break}return u}function f(w){var _=w.geojson,c=window.PlotlyGeoAssets||{},b=typeof _=="string"?c[_]:_;return r(b)?b:(n.error("Oops ... something went wrong when fetching "+_),!1)}function d(w){var _=w[0].trace,c=f(_);if(!c)return!1;var b={},u=[],L;for(L=0;L<_._length;L++){var T=w[L];(T.loc||T.loc===0)&&(b[T.loc]=T)}function k(I){var D=t(I,_.featureidkey||"id").get(),R=b[D];if(R){var O=I.geometry;if(O.type==="Polygon"||O.type==="MultiPolygon"){var F={type:"Feature",id:D,geometry:O,properties:{}};F.properties.ct=o(F),R.fIn=I,R.fOut=F,u.push(F)}else n.log(["Location",R.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete b[D]}switch(c.type){case"FeatureCollection":var P=c.features;for(L=0;L<P.length;L++)k(P[L]);break;case"Feature":k(c);break;default:return n.warn(["Invalid GeoJSON type",(c.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var z in b)n.log(["Location *"+z+"*","does not have a matching feature with id-key","*"+_.featureidkey+"*."].join(" "));return u}function o(w){var _=w.geometry,c;if(_.type==="MultiPolygon")for(var b=_.coordinates,u=0,L=0;L<b.length;L++){var T={type:"Polygon",coordinates:b[L]},k=S.default(T);k>u&&(u=k,c=T)}else c=_;return M.default(c).geometry.coordinates}function m(w){var _=window.PlotlyGeoAssets||{},c=[];function b(P){return new Promise(function(z,I){A.json(P,function(D,R){if(D){delete _[P];var O=D.status===404?'GeoJSON at URL "'+P+'" does not exist.':"Unexpected error while fetching from "+P;return I(new Error(O))}return _[P]=R,z(R)})})}function u(P){return new Promise(function(z,I){var D=0,R=setInterval(function(){if(_[P]&&_[P]!=="pending")return clearInterval(R),z(_[P]);if(D>100)return clearInterval(R),I("Unexpected error while fetching from "+P);D++},50)})}for(var L=0;L<w.length;L++){var T=w[L][0].trace,k=T.geojson;typeof k=="string"&&(_[k]?_[k]==="pending"&&c.push(u(k)):(_[k]="pending",c.push(b(k))))}return c}function l(w){return e.default(w)}ee.exports={locationToFeature:p,feature2polygons:v,getTraceGeojson:f,extractTraceFeature:d,fetchTraceGeoData:m,computeBbox:l}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(y,ee,te){var A=y("../constants/numerical").BADNUM;te.calcTraceToLineCoords=function(g){for(var S=g[0].trace,M=S.connectgaps,e=[],a=[],n=0;n<g.length;n++){var r=g[n],t=r.lonlat;t[0]!==A?a.push(t):!M&&a.length>0&&(e.push(a),a=[])}return a.length>0&&e.push(a),e},te.makeLine=function(g){return g.length===1?{type:"LineString",coordinates:g[0]}:{type:"MultiLineString",coordinates:g}},te.makePolygon=function(g){if(g.length===1)return{type:"Polygon",coordinates:g};for(var S=new Array(g.length),M=0;M<g.length;M++)S[M]=[g[M]];return{type:"MultiPolygon",coordinates:S}},te.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(y,ee,te){var A=y("./mod").mod;te.segmentsIntersect=g;function g(n,r,t,h,s,i,x,p){var v=t-n,f=s-n,d=x-s,o=h-r,m=i-r,l=p-i,w=v*l-d*o;if(w===0)return null;var _=(f*l-d*m)/w,c=(f*o-v*m)/w;return c<0||c>1||_<0||_>1?null:{x:n+v*_,y:r+o*_}}te.segmentDistance=function(r,t,h,s,i,x,p,v){if(g(r,t,h,s,i,x,p,v))return 0;var f=h-r,d=s-t,o=p-i,m=v-x,l=f*f+d*d,w=o*o+m*m,_=Math.min(S(f,d,l,i-r,x-t),S(f,d,l,p-r,v-t),S(o,m,w,r-i,t-x),S(o,m,w,h-i,s-x));return Math.sqrt(_)};function S(n,r,t,h,s){var i=h*n+s*r;if(i<0)return h*h+s*s;if(i>t){var x=h-n,p=s-r;return x*x+p*p}else{var v=h*r-s*n;return v*v/t}}var M,e,a;te.getTextLocation=function(r,t,h,s){if((r!==e||s!==a)&&(M={},e=r,a=s),M[h])return M[h];var i=r.getPointAtLength(A(h-s/2,t)),x=r.getPointAtLength(A(h+s/2,t)),p=Math.atan((x.y-i.y)/(x.x-i.x)),v=r.getPointAtLength(A(h,t)),f=(v.x*4+i.x+x.x)/6,d=(v.y*4+i.y+x.y)/6,o={x:f,y:d,theta:p};return M[h]=o,o},te.clearLocationCache=function(){e=null},te.getVisibleSegment=function(r,t,h){var s=t.left,i=t.right,x=t.top,p=t.bottom,v=0,f=r.getTotalLength(),d=f,o,m;function l(_){var c=r.getPointAtLength(_);_===0?o=c:_===f&&(m=c);var b=c.x<s?s-c.x:c.x>i?c.x-i:0,u=c.y<x?x-c.y:c.y>p?c.y-p:0;return Math.sqrt(b*b+u*u)}for(var w=l(v);w;){if(v+=w+h,v>d)return;w=l(v)}for(w=l(d);w;){if(d-=w+h,v>d)return;w=l(d)}return{min:v,max:d,len:d-v,total:f,isClosed:v===0&&d===f&&Math.abs(o.x-m.x)<.1&&Math.abs(o.y-m.y)<.1}},te.findPointOnPath=function(r,t,h,s){s=s||{};for(var i=s.pathLength||r.getTotalLength(),x=s.tolerance||.001,p=s.iterationLimit||30,v=r.getPointAtLength(0)[h]>r.getPointAtLength(i)[h]?-1:1,f=0,d=0,o=i,m,l,w;f<p;){if(m=(d+o)/2,l=r.getPointAtLength(m),w=l[h]-t,Math.abs(w)<x)return l;v*w>0?o=m:d=m,f++}return l}},{"./mod":522}],511:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("tinycolor2"),S=y("color-normalize"),M=y("../components/colorscale"),e=y("../components/color/attributes").defaultLine,a=y("./array").isArrayOrTypedArray,n=S(e),r=1;function t(p,v){var f=p;return f[3]*=v,f}function h(p){if(A(p))return n;var v=S(p);return v.length?v:n}function s(p){return A(p)?p:r}function i(p,v,f){var d=p.color,o=a(d),m=a(v),l=M.extractOpts(p),w=[],_,c,b,u,L;if(l.colorscale!==void 0?_=M.makeColorScaleFuncFromTrace(p):_=h,o?c=function(k,P){return k[P]===void 0?n:S(_(k[P]))}:c=h,m?b=function(k,P){return k[P]===void 0?r:s(k[P])}:b=s,o||m)for(var T=0;T<f;T++)u=c(d,T),L=b(v,T),w[T]=t(u,L);else w=t(S(d),v);return w}function x(p){var v=M.extractOpts(p),f=v.colorscale;return v.reversescale&&(f=M.flipScale(v.colorscale)),f.map(function(d){var o=d[0],m=g(d[1]),l=m.toRgb();return{index:o,rgb:[l.r,l.g,l.b,l.a]}})}ee.exports={formatColor:i,parseColorScale:x}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(y,ee,te){var A=y("./identity");function g(S){return[S]}ee.exports={keyFun:function(S){return S.key},repeat:g,descend:A,wrap:g,unwrap:function(S){return S[0]}}},{"./identity":513}],513:[function(y,ee,te){ee.exports=function(g){return g}},{}],514:[function(y,ee,te){ee.exports=function(g,S){if(!S)return g;var M=1/Math.abs(S),e=M>1?(M*g+M*S)/M:g+S,a=String(e).length;if(a>16){var n=String(S).length,r=String(g).length;if(a>=r+n){var t=parseFloat(e).toPrecision(12);t.indexOf("e+")===-1&&(e=+t)}}return e}},{}],515:[function(y,ee,te){var A=y("@plotly/d3"),g=y("d3-time-format").utcFormat,S=y("d3-format").format,M=y("fast-isnumeric"),e=y("../constants/numerical"),a=e.FP_SAFE,n=-a,r=e.BADNUM,t=ee.exports={};t.adjustFormat=function(j){return!j||/^\d[.]\df/.test(j)||/[.]\d%/.test(j)?j:j==="0.f"?"~f":/^\d%/.test(j)?"~%":/^\ds/.test(j)?"~s":!/^[~,.0$]/.test(j)&&/[&fps]/.test(j)?"~"+j:j};var h={};t.warnBadFormat=function(ue){var j=String(ue);h[j]||(h[j]=1,t.warn('encountered bad format: "'+j+'"'))},t.noFormat=function(ue){return String(ue)},t.numberFormat=function(ue){var j;try{j=S(t.adjustFormat(ue))}catch{return t.warnBadFormat(ue),t.noFormat}return j},t.nestedProperty=y("./nested_property"),t.keyedContainer=y("./keyed_container"),t.relativeAttr=y("./relative_attr"),t.isPlainObject=y("./is_plain_object"),t.toLogRange=y("./to_log_range"),t.relinkPrivateKeys=y("./relink_private");var s=y("./array");t.isTypedArray=s.isTypedArray,t.isArrayOrTypedArray=s.isArrayOrTypedArray,t.isArray1D=s.isArray1D,t.ensureArray=s.ensureArray,t.concat=s.concat,t.maxRowLength=s.maxRowLength,t.minRowLength=s.minRowLength;var i=y("./mod");t.mod=i.mod,t.modHalf=i.modHalf;var x=y("./coerce");t.valObjectMeta=x.valObjectMeta,t.coerce=x.coerce,t.coerce2=x.coerce2,t.coerceFont=x.coerceFont,t.coercePattern=x.coercePattern,t.coerceHoverinfo=x.coerceHoverinfo,t.coerceSelectionMarkerOpacity=x.coerceSelectionMarkerOpacity,t.validate=x.validate;var p=y("./dates");t.dateTime2ms=p.dateTime2ms,t.isDateTime=p.isDateTime,t.ms2DateTime=p.ms2DateTime,t.ms2DateTimeLocal=p.ms2DateTimeLocal,t.cleanDate=p.cleanDate,t.isJSDate=p.isJSDate,t.formatDate=p.formatDate,t.incrementMonth=p.incrementMonth,t.dateTick0=p.dateTick0,t.dfltRange=p.dfltRange,t.findExactDates=p.findExactDates,t.MIN_MS=p.MIN_MS,t.MAX_MS=p.MAX_MS;var v=y("./search");t.findBin=v.findBin,t.sorterAsc=v.sorterAsc,t.sorterDes=v.sorterDes,t.distinctVals=v.distinctVals,t.roundUp=v.roundUp,t.sort=v.sort,t.findIndexOfMin=v.findIndexOfMin,t.sortObjectKeys=y("./sort_object_keys");var f=y("./stats");t.aggNums=f.aggNums,t.len=f.len,t.mean=f.mean,t.median=f.median,t.midRange=f.midRange,t.variance=f.variance,t.stdev=f.stdev,t.interp=f.interp;var d=y("./matrix");t.init2dArray=d.init2dArray,t.transposeRagged=d.transposeRagged,t.dot=d.dot,t.translationMatrix=d.translationMatrix,t.rotationMatrix=d.rotationMatrix,t.rotationXYMatrix=d.rotationXYMatrix,t.apply3DTransform=d.apply3DTransform,t.apply2DTransform=d.apply2DTransform,t.apply2DTransform2=d.apply2DTransform2,t.convertCssMatrix=d.convertCssMatrix,t.inverseTransformMatrix=d.inverseTransformMatrix;var o=y("./angles");t.deg2rad=o.deg2rad,t.rad2deg=o.rad2deg,t.angleDelta=o.angleDelta,t.angleDist=o.angleDist,t.isFullCircle=o.isFullCircle,t.isAngleInsideSector=o.isAngleInsideSector,t.isPtInsideSector=o.isPtInsideSector,t.pathArc=o.pathArc,t.pathSector=o.pathSector,t.pathAnnulus=o.pathAnnulus;var m=y("./anchor_utils");t.isLeftAnchor=m.isLeftAnchor,t.isCenterAnchor=m.isCenterAnchor,t.isRightAnchor=m.isRightAnchor,t.isTopAnchor=m.isTopAnchor,t.isMiddleAnchor=m.isMiddleAnchor,t.isBottomAnchor=m.isBottomAnchor;var l=y("./geometry2d");t.segmentsIntersect=l.segmentsIntersect,t.segmentDistance=l.segmentDistance,t.getTextLocation=l.getTextLocation,t.clearLocationCache=l.clearLocationCache,t.getVisibleSegment=l.getVisibleSegment,t.findPointOnPath=l.findPointOnPath;var w=y("./extend");t.extendFlat=w.extendFlat,t.extendDeep=w.extendDeep,t.extendDeepAll=w.extendDeepAll,t.extendDeepNoArrays=w.extendDeepNoArrays;var _=y("./loggers");t.log=_.log,t.warn=_.warn,t.error=_.error;var c=y("./regex");t.counterRegex=c.counter;var b=y("./throttle");t.throttle=b.throttle,t.throttleDone=b.done,t.clearThrottle=b.clear;var u=y("./dom");t.getGraphDiv=u.getGraphDiv,t.isPlotDiv=u.isPlotDiv,t.removeElement=u.removeElement,t.addStyleRule=u.addStyleRule,t.addRelatedStyleRule=u.addRelatedStyleRule,t.deleteRelatedStyleRule=u.deleteRelatedStyleRule,t.getFullTransformMatrix=u.getFullTransformMatrix,t.getElementTransformMatrix=u.getElementTransformMatrix,t.getElementAndAncestors=u.getElementAndAncestors,t.equalDomRects=u.equalDomRects,t.clearResponsive=y("./clear_responsive"),t.preserveDrawingBuffer=y("./preserve_drawing_buffer"),t.makeTraceGroups=y("./make_trace_groups"),t._=y("./localize"),t.notifier=y("./notifier"),t.filterUnique=y("./filter_unique"),t.filterVisible=y("./filter_visible"),t.pushUnique=y("./push_unique"),t.increment=y("./increment"),t.cleanNumber=y("./clean_number"),t.ensureNumber=function(j){return M(j)?(j=Number(j),j>a||j<n?r:j):r},t.isIndex=function(ue,j){return j!==void 0&&ue>=j?!1:M(ue)&&ue>=0&&ue%1===0},t.noop=y("./noop"),t.identity=y("./identity"),t.repeat=function(ue,j){for(var q=new Array(j),H=0;H<j;H++)q[H]=ue;return q},t.swapAttrs=function(ue,j,q,H){q||(q="x"),H||(H="y");for(var U=0;U<j.length;U++){var $=j[U],ne=t.nestedProperty(ue,$.replace("?",q)),X=t.nestedProperty(ue,$.replace("?",H)),Q=ne.get();ne.set(X.get()),X.set(Q)}},t.raiseToTop=function(j){j.parentNode.appendChild(j)},t.cancelTransition=function(ue){return ue.transition().duration(0)},t.constrain=function(ue,j,q){return j>q?Math.max(q,Math.min(j,ue)):Math.max(j,Math.min(q,ue))},t.bBoxIntersect=function(ue,j,q){return q=q||0,ue.left<=j.right+q&&j.left<=ue.right+q&&ue.top<=j.bottom+q&&j.top<=ue.bottom+q},t.simpleMap=function(ue,j,q,H,U){for(var $=ue.length,ne=new Array($),X=0;X<$;X++)ne[X]=j(ue[X],q,H,U);return ne},t.randstr=function ue(j,q,H,U){if(H||(H=16),q===void 0&&(q=24),q<=0)return"0";var $=Math.log(Math.pow(2,q))/Math.log(H),ne="",X,Q,ie;for(X=2;$===1/0;X*=2)$=Math.log(Math.pow(2,q/X))/Math.log(H)*X;var se=$-Math.floor($);for(X=0;X<Math.floor($);X++)ie=Math.floor(Math.random()*H).toString(H),ne=ie+ne;se&&(Q=Math.pow(H,se),ie=Math.floor(Math.random()*Q).toString(H),ne=ie+ne);var ae=parseInt(ne,H);return j&&j[ne]||ae!==1/0&&ae>=Math.pow(2,q)?U>10?(t.warn("randstr failed uniqueness"),ne):ue(j,q,H,(U||0)+1):ne},t.OptionControl=function(ue,j){ue||(ue={}),j||(j="opt");var q={};return q.optionList=[],q._newoption=function(H){H[j]=ue,q[H.name]=H,q.optionList.push(H)},q["_"+j]=ue,q},t.smooth=function(ue,j){if(j=Math.round(j)||0,j<2)return ue;var q=ue.length,H=2*q,U=2*j-1,$=new Array(U),ne=new Array(q),X,Q,ie,se;for(X=0;X<U;X++)$[X]=(1-Math.cos(Math.PI*(X+1)/j))/(2*j);for(X=0;X<q;X++){for(se=0,Q=0;Q<U;Q++)ie=X+Q+1-j,ie<-q?ie-=H*Math.round(ie/H):ie>=H&&(ie-=H*Math.floor(ie/H)),ie<0?ie=-1-ie:ie>=q&&(ie=H-1-ie),se+=ue[ie]*$[Q];ne[X]=se}return ne},t.syncOrAsync=function(ue,j,q){var H,U;function $(){return t.syncOrAsync(ue,j,q)}for(;ue.length;)if(U=ue.splice(0,1)[0],H=U(j),H&&H.then)return H.then($);return q&&q(j)},t.stripTrailingSlash=function(ue){return ue.substr(-1)==="/"?ue.substr(0,ue.length-1):ue},t.noneOrAll=function(ue,j,q){if(ue){var H=!1,U=!0,$,ne;for($=0;$<q.length;$++)ne=ue[q[$]],ne!=null?H=!0:U=!1;if(H&&!U)for($=0;$<q.length;$++)ue[q[$]]=j[q[$]]}},t.mergeArray=function(ue,j,q,H){var U=typeof H=="function";if(t.isArrayOrTypedArray(ue))for(var $=Math.min(ue.length,j.length),ne=0;ne<$;ne++){var X=ue[ne];j[ne][q]=U?H(X):X}},t.mergeArrayCastPositive=function(ue,j,q){return t.mergeArray(ue,j,q,function(H){var U=+H;return isFinite(U)&&U>0?U:0})},t.fillArray=function(ue,j,q,H){if(H=H||t.identity,t.isArrayOrTypedArray(ue))for(var U=0;U<j.length;U++)j[U][q]=H(ue[U])},t.castOption=function(ue,j,q,H){H=H||t.identity;var U=t.nestedProperty(ue,q).get();return t.isArrayOrTypedArray(U)?Array.isArray(j)&&t.isArrayOrTypedArray(U[j[0]])?H(U[j[0]][j[1]]):H(U[j]):U},t.extractOption=function(ue,j,q,H){if(q in ue)return ue[q];var U=t.nestedProperty(j,H).get();if(!Array.isArray(U))return U};function L(ue){var j={};for(var q in ue)for(var H=ue[q],U=0;U<H.length;U++)j[H[U]]=+q;return j}t.tagSelected=function(ue,j,q){var H=j.selectedpoints,U=j._indexToPoints,$;U&&($=L(U));function ne(ae){return ae!==void 0&&ae<ue.length}for(var X=0;X<H.length;X++){var Q=H[X];if(t.isIndex(Q)||t.isArrayOrTypedArray(Q)&&t.isIndex(Q[0])&&t.isIndex(Q[1])){var ie=$?$[Q]:Q,se=q?q[ie]:ie;ne(se)&&(ue[se].selected=1)}}},t.selIndices2selPoints=function(ue){var j=ue.selectedpoints,q=ue._indexToPoints;if(q){for(var H=L(q),U=[],$=0;$<j.length;$++){var ne=j[$];if(t.isIndex(ne)){var X=H[ne];t.isIndex(X)&&U.push(X)}}return U}else return j},t.getTargetArray=function(ue,j){var q=j.target;if(typeof q=="string"&&q){var H=t.nestedProperty(ue,q).get();return Array.isArray(H)?H:!1}else if(Array.isArray(q))return q;return!1},t.minExtend=function(ue,j){var q={};typeof j!="object"&&(j={});var H=3,U=Object.keys(ue),$,ne,X;for($=0;$<U.length;$++)ne=U[$],X=ue[ne],!(ne.charAt(0)==="_"||typeof X=="function")&&(ne==="module"?q[ne]=X:Array.isArray(X)?ne==="colorscale"?q[ne]=X.slice():q[ne]=X.slice(0,H):t.isTypedArray(X)?q[ne]=X.subarray(0,H):X&&typeof X=="object"?q[ne]=t.minExtend(ue[ne],j[ne]):q[ne]=X);for(U=Object.keys(j),$=0;$<U.length;$++)ne=U[$],X=j[ne],(typeof X!="object"||!(ne in q)||typeof q[ne]!="object")&&(q[ne]=X);return q},t.titleCase=function(ue){return ue.charAt(0).toUpperCase()+ue.substr(1)},t.containsAny=function(ue,j){for(var q=0;q<j.length;q++)if(ue.indexOf(j[q])!==-1)return!0;return!1},t.isIE=function(){return typeof window.navigator.msSaveBlob<"u"};var T=/Version\/[\d\.]+.*Safari/;t.isSafari=function(){return T.test(window.navigator.userAgent)};var k=/iPad|iPhone|iPod/;t.isIOS=function(){return k.test(window.navigator.userAgent)};var P=/Firefox\/(\d+)\.\d+/;t.getFirefoxVersion=function(){var ue=P.exec(window.navigator.userAgent);if(ue&&ue.length===2){var j=parseInt(ue[1]);if(!isNaN(j))return j}return null},t.isD3Selection=function(ue){return ue instanceof A.selection},t.ensureSingle=function(ue,j,q,H){var U=ue.select(j+(q?"."+q:""));if(U.size())return U;var $=ue.append(j);return q&&$.classed(q,!0),H&&$.call(H),$},t.ensureSingleById=function(ue,j,q,H){var U=ue.select(j+"#"+q);if(U.size())return U;var $=ue.append(j).attr("id",q);return H&&$.call(H),$},t.objectFromPath=function(ue,j){for(var q=ue.split("."),H,U=H={},$=0;$<q.length;$++){var ne=q[$],X=null,Q=q[$].match(/(.*)\[([0-9]+)\]/);Q?(ne=Q[1],X=Q[2],H=H[ne]=[],$===q.length-1?H[X]=j:H[X]={},H=H[X]):($===q.length-1?H[ne]=j:H[ne]={},H=H[ne])}return U};var z=/^([^\[\.]+)\.(.+)?/,I=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;t.expandObjectPaths=function(ue){var j,q,H,U,$,ne,X;if(typeof ue=="object"&&!Array.isArray(ue))for(q in ue)ue.hasOwnProperty(q)&&((j=q.match(z))?(U=ue[q],H=j[1],delete ue[q],ue[H]=t.extendDeepNoArrays(ue[H]||{},t.objectFromPath(q,t.expandObjectPaths(U))[H])):(j=q.match(I))?(U=ue[q],H=j[1],$=parseInt(j[2]),delete ue[q],ue[H]=ue[H]||[],j[3]==="."?(X=j[4],ne=ue[H][$]=ue[H][$]||{},t.extendDeepNoArrays(ne,t.objectFromPath(X,t.expandObjectPaths(U)))):ue[H][$]=t.expandObjectPaths(U)):ue[q]=t.expandObjectPaths(ue[q]));return ue},t.numSeparate=function(ue,j,q){if(q||(q=!1),typeof j!="string"||j.length===0)throw new Error("Separator string required for formatting!");typeof ue=="number"&&(ue=String(ue));var H=/(\d+)(\d{3})/,U=j.charAt(0),$=j.charAt(1),ne=ue.split("."),X=ne[0],Q=ne.length>1?U+ne[1]:"";if($&&(ne.length>1||X.length>4||q))for(;H.test(X);)X=X.replace(H,"$1"+$+"$2");return X+Q},t.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var D=/^\w*$/;t.templateString=function(ue,j){var q={};return ue.replace(t.TEMPLATE_STRING_REGEX,function(H,U){var $;return D.test(U)?$=j[U]:(q[U]=q[U]||t.nestedProperty(j,U).get,$=q[U]()),t.isValidTextValue($)?$:""})};var R={max:10,count:0,name:"hovertemplate"};t.hovertemplateString=function(){return N.apply(R,arguments)};var O={max:10,count:0,name:"texttemplate"};t.texttemplateString=function(){return N.apply(O,arguments)};var F=/^[:|\|]/;function N(ue,j,q){var H=this,U=arguments;j||(j={});var $={};return ue.replace(t.TEMPLATE_STRING_REGEX,function(ne,X,Q){var ie=X==="xother"||X==="yother",se=X==="_xother"||X==="_yother",ae=X==="_xother_"||X==="_yother_",oe=X==="xother_"||X==="yother_",be=ie||se||oe||ae,ce=X;(se||ae)&&(ce=ce.substring(1)),(oe||ae)&&(ce=ce.substring(0,ce.length-1));var de;if(be){if(de=j[ce],de===void 0)return""}else{var ye,ge;for(ge=3;ge<U.length;ge++)if(ye=U[ge],!!ye){if(ye.hasOwnProperty(ce)){de=ye[ce];break}if(D.test(ce)||(de=t.nestedProperty(ye,ce).get(),de=$[ce]||t.nestedProperty(ye,ce).get(),de&&($[ce]=de)),de!==void 0)break}}if(de===void 0&&H)return H.count<H.max&&(t.warn("Variable '"+ce+"' in "+H.name+" could not be found!"),de=ne),H.count===H.max&&t.warn("Too many "+H.name+" warnings - additional warnings will be suppressed"),H.count++,ne;if(Q){var me;if(Q[0]===":"&&(me=q?q.numberFormat:t.numberFormat,de=me(Q.replace(F,""))(de)),Q[0]==="|"){me=q?q.timeFormat:g;var Ee=t.dateTime2ms(de);de=t.formatDate(Ee,Q.replace(F,""),!1,me)}}else{var Pe=ce+"Label";j.hasOwnProperty(Pe)&&(de=j[Pe])}return be&&(de="("+de+")",(se||ae)&&(de=" "+de),(oe||ae)&&(de=de+" ")),de})}var G=48,K=57;t.subplotSort=function(ue,j){for(var q=Math.min(ue.length,j.length)+1,H=0,U=0,$=0;$<q;$++){var ne=ue.charCodeAt($)||0,X=j.charCodeAt($)||0,Q=ne>=G&&ne<=K,ie=X>=G&&X<=K;if(Q&&(H=10*H+ne-G),ie&&(U=10*U+X-G),!Q||!ie){if(H!==U)return H-U;if(ne!==X)return ne-X}}return U-H};var W=2e9;t.seedPseudoRandom=function(){W=2e9},t.pseudoRandom=function(){var ue=W;return W=(69069*W+1)%4294967296,Math.abs(W-ue)<429496729?t.pseudoRandom():W/4294967296},t.fillText=function(ue,j,q){var H=Array.isArray(q)?function(ne){q.push(ne)}:function(ne){q.text=ne},U=t.extractOption(ue,j,"htx","hovertext");if(t.isValidTextValue(U))return H(U);var $=t.extractOption(ue,j,"tx","text");if(t.isValidTextValue($))return H($)},t.isValidTextValue=function(ue){return ue||ue===0},t.formatPercent=function(ue,j){j=j||0;for(var q=(Math.round(100*ue*Math.pow(10,j))*Math.pow(.1,j)).toFixed(j)+"%",H=0;H<j;H++)q.indexOf(".")!==-1&&(q=q.replace("0%","%"),q=q.replace(".%","%"));return q},t.isHidden=function(ue){var j=window.getComputedStyle(ue).display;return!j||j==="none"},t.strTranslate=function(ue,j){return ue||j?"translate("+ue+","+j+")":""},t.strRotate=function(ue){return ue?"rotate("+ue+")":""},t.strScale=function(ue){return ue!==1?"scale("+ue+")":""},t.getTextTransform=function(ue){var j=ue.noCenter,q=ue.textX,H=ue.textY,U=ue.targetX,$=ue.targetY,ne=ue.anchorX||0,X=ue.anchorY||0,Q=ue.rotate,ie=ue.scale;return ie?ie>1&&(ie=1):ie=0,t.strTranslate(U-ie*(q+ne),$-ie*(H+X))+t.strScale(ie)+(Q?"rotate("+Q+(j?"":" "+q+" "+H)+")":"")},t.setTransormAndDisplay=function(ue,j){ue.attr("transform",t.getTextTransform(j)),ue.style("display",j.scale?null:"none")},t.ensureUniformFontSize=function(ue,j){var q=t.extendFlat({},j);return q.size=Math.max(j.size,ue._fullLayout.uniformtext.minsize||0),q},t.join2=function(ue,j,q){var H=ue.length;return H>1?ue.slice(0,-1).join(j)+q+ue[H-1]:ue.join(j)},t.bigFont=function(ue){return Math.round(1.2*ue)};var Y=t.getFirefoxVersion(),re=Y!==null&&Y<86;t.getPositionFromD3Event=function(){return re?[A.event.layerX,A.event.layerY]:[A.event.offsetX,A.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(y,ee,te){ee.exports=function(g){return window&&window.process&&window.process.versions?Object.prototype.toString.call(g)==="[object Object]":Object.prototype.toString.call(g)==="[object Object]"&&Object.getPrototypeOf(g).hasOwnProperty("hasOwnProperty")}},{}],517:[function(y,ee,te){var A=y("./nested_property"),g=/^\w*$/,S=0,M=1,e=2,a=3,n=4;ee.exports=function(t,h,s,i){s=s||"name",i=i||"value";var x,p,v,f={};h&&h.length?(v=A(t,h),p=v.get()):p=t,h=h||"";var d={};if(p)for(x=0;x<p.length;x++)d[p[x][s]]=x;var o=g.test(i),m={set:function(l,w){var _=w===null?n:S;if(!p){if(!v||_===n)return;p=[],v.set(p)}var c=d[l];if(c===void 0){if(_===n)return;_=_|a,c=p.length,d[l]=c}else w!==(o?p[c][i]:A(p[c],i).get())&&(_=_|e);var b=p[c]=p[c]||{};return b[s]=l,o?b[i]=w:A(b,i).set(w),w!==null&&(_=_&~n),f[c]=f[c]|_,m},get:function(l){if(p){var w=d[l];if(w!==void 0)return o?p[w][i]:A(p[w],i).get()}},rename:function(l,w){var _=d[l];return _===void 0||(f[_]=f[_]|M,d[w]=_,delete d[l],p[_][s]=w),m},remove:function(l){var w=d[l];if(w===void 0)return m;var _=p[w];if(Object.keys(_).length>2)return f[w]=f[w]|e,m.set(l,null);if(o){for(x=w;x<p.length;x++)f[x]=f[x]|a;for(x=w;x<p.length;x++)d[p[x][s]]--;p.splice(w,1),delete d[l]}else A(_,i).set(null),f[w]=f[w]|e|n;return m},constructUpdate:function(){for(var l,w,_={},c=Object.keys(f),b=0;b<c.length;b++)w=c[b],l=h+"["+w+"]",p[w]?(f[w]&M&&(_[l+"."+s]=p[w][s]),f[w]&e&&(o?_[l+"."+i]=f[w]&n?null:p[w][i]:_[l+"."+i]=f[w]&n?null:A(p[w],i).get())):_[l]=null;return _}};return m}},{"./nested_property":523}],518:[function(y,ee,te){var A=y("../registry");ee.exports=function(S,M){for(var e=S._context.locale,a=0;a<2;a++){for(var n=S._context.locales,r=0;r<2;r++){var t=(n[e]||{}).dictionary;if(t){var h=t[M];if(h)return h}n=A.localeRegistry}var s=e.split("-")[0];if(s===e)break;e=s}return M}},{"../registry":647}],519:[function(y,ee,te){var A=y("../plot_api/plot_config").dfltConfig,g=y("./notifier"),S=ee.exports={};S.log=function(){var M;if(A.logging>1){var e=["LOG:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.trace.apply(console,e)}if(A.notifyOnLogging>1){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);g(a.join("<br>"),"long")}},S.warn=function(){var M;if(A.logging>0){var e=["WARN:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.trace.apply(console,e)}if(A.notifyOnLogging>0){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);g(a.join("<br>"),"stick")}},S.error=function(){var M;if(A.logging>0){var e=["ERROR:"];for(M=0;M<arguments.length;M++)e.push(arguments[M]);console.error.apply(console,e)}if(A.notifyOnLogging>0){var a=[];for(M=0;M<arguments.length;M++)a.push(arguments[M]);g(a.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(y,ee,te){var A=y("@plotly/d3");ee.exports=function(S,M,e){var a=S.selectAll("g."+e.replace(/\s/g,".")).data(M,function(r){return r[0].trace.uid});a.exit().remove(),a.enter().append("g").attr("class",e),a.order();var n=S.classed("rangeplot")?"nodeRangePlot3":"node3";return a.each(function(r){r[0][n]=A.select(this)}),a}},{"@plotly/d3":58}],521:[function(y,ee,te){var A=y("gl-mat4");te.init2dArray=function(g,S){for(var M=new Array(g),e=0;e<g;e++)M[e]=new Array(S);return M},te.transposeRagged=function(g){var S=0,M=g.length,e,a;for(e=0;e<M;e++)S=Math.max(S,g[e].length);var n=new Array(S);for(e=0;e<S;e++)for(n[e]=new Array(M),a=0;a<M;a++)n[e][a]=g[a][e];return n},te.dot=function(g,S){if(!(g.length&&S.length)||g.length!==S.length)return null;var M=g.length,e,a;if(g[0].length)for(e=new Array(M),a=0;a<M;a++)e[a]=te.dot(g[a],S);else if(S[0].length){var n=te.transposeRagged(S);for(e=new Array(n.length),a=0;a<n.length;a++)e[a]=te.dot(g,n[a])}else for(e=0,a=0;a<M;a++)e+=g[a]*S[a];return e},te.translationMatrix=function(g,S){return[[1,0,g],[0,1,S],[0,0,1]]},te.rotationMatrix=function(g){var S=g*Math.PI/180;return[[Math.cos(S),-Math.sin(S),0],[Math.sin(S),Math.cos(S),0],[0,0,1]]},te.rotationXYMatrix=function(g,S,M){return te.dot(te.dot(te.translationMatrix(S,M),te.rotationMatrix(g)),te.translationMatrix(-S,-M))},te.apply3DTransform=function(g){return function(){var S=arguments,M=arguments.length===1?S[0]:[S[0],S[1],S[2]||0];return te.dot(g,[M[0],M[1],M[2],1]).slice(0,3)}},te.apply2DTransform=function(g){return function(){var S=arguments;S.length===3&&(S=S[0]);var M=arguments.length===1?S[0]:[S[0],S[1]];return te.dot(g,[M[0],M[1],1]).slice(0,2)}},te.apply2DTransform2=function(g){var S=te.apply2DTransform(g);return function(M){return S(M.slice(0,2)).concat(S(M.slice(2,4)))}},te.convertCssMatrix=function(g){if(g){var S=g.length;if(S===16)return g;if(S===6)return[g[0],g[1],0,0,g[2],g[3],0,0,0,0,1,0,g[4],g[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},te.inverseTransformMatrix=function(g){var S=[];return A.invert(S,g),[[S[0],S[1],S[2],S[3]],[S[4],S[5],S[6],S[7]],[S[8],S[9],S[10],S[11]],[S[12],S[13],S[14],S[15]]]}},{"gl-mat4":210}],522:[function(y,ee,te){function A(S,M){var e=S%M;return e<0?e+M:e}function g(S,M){return Math.abs(S)>M/2?S-Math.round(S/M)*M:S}ee.exports={mod:A,modHalf:g}},{}],523:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("./array").isArrayOrTypedArray;ee.exports=function(i,x){if(A(x))x=String(x);else if(typeof x!="string"||x.substr(x.length-4)==="[-1]")throw"bad property string";for(var p=0,v=x.split("."),f,d,o;p<v.length;){if(f=String(v[p]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),f){if(f[1])v[p]=f[1];else if(p===0)v.splice(0,1);else throw"bad property string";for(d=f[2].substr(1,f[2].length-2).split("]["),o=0;o<d.length;o++)p++,v.splice(p,0,Number(d[o]))}p++}return typeof i!="object"?h(i,x,v):{set:a(i,v,x),get:S(i,v),astr:x,parts:v,obj:i}};function S(s,i){return function(){var x=s,p,v,f,d,o;for(d=0;d<i.length-1;d++){if(p=i[d],p===-1){for(v=!0,f=[],o=0;o<x.length;o++)f[o]=S(x[o],i.slice(d+1))(),f[o]!==f[0]&&(v=!1);return v?f[0]:f}if(typeof p=="number"&&!g(x)||(x=x[p],typeof x!="object"||x===null))return}if(!(typeof x!="object"||x===null)&&(f=x[i[d]],f!==null))return f}}var M=/(^|\.)args\[/;function e(s,i){return s===void 0||s===null&&!i.match(M)}function a(s,i,x){return function(p){var v=s,f="",d=e(p,x),o,m;for(m=0;m<i.length-1;m++){if(o=i[m],typeof o=="number"&&!g(v))throw"array index but container is not an array";if(o===-1){if(d=!r(v,i.slice(m+1),p,x),d)break;return}if(!t(v,o,i[m+1],d))break;if(v=v[o],typeof v!="object"||v===null)throw"container is not an object";f=n(f,o)}if(d){if(m===i.length-1&&(delete v[i[m]],Array.isArray(v)&&+i[m]===v.length-1))for(;v.length&&v[v.length-1]===void 0;)v.pop()}else v[i[m]]=p}}function n(s,i){var x=i;return A(i)?x="["+i+"]":s&&(x="."+i),s+x}function r(s,i,x,p){var v=g(x),f=!0,d=x,o=p.replace("-1",0),m=v?!1:e(x,o),l=i[0],w;for(w=0;w<s.length;w++)o=p.replace("-1",w),v&&(d=x[w%x.length],m=e(d,o)),m&&(f=!1),t(s,w,l,m)&&a(s[w],i,p.replace("-1",w))(d);return f}function t(s,i,x,p){if(s[i]===void 0){if(p)return!1;typeof x=="number"?s[i]=[]:s[i]={}}return!0}function h(s,i,x){return{set:function(){throw"bad container"},get:function(){},astr:i,parts:x,obj:s}}},{"./array":497,"fast-isnumeric":190}],524:[function(y,ee,te){ee.exports=function(){}},{}],525:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=[];ee.exports=function(M,e){if(S.indexOf(M)!==-1)return;S.push(M);var a=1e3;g(e)?a=e:e==="long"&&(a=3e3);var n=A.select("body").selectAll(".plotly-notifier").data([0]);n.enter().append("div").classed("plotly-notifier",!0);var r=n.selectAll(".notifier-note").data(S);function t(h){h.duration(700).style("opacity",0).each("end",function(s){var i=S.indexOf(s);i!==-1&&S.splice(i,1),A.select(this).remove()})}r.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(h){var s=A.select(this);s.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){s.transition().call(t)});for(var i=s.append("p"),x=h.split(/<br\s*\/?>/g),p=0;p<x.length;p++)p&&i.append("br"),i.append("span").text(x[p]);e==="stick"?s.transition().duration(350).style("opacity",1):s.transition().duration(700).style("opacity",1).transition().delay(a).call(t)})}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(y,ee,te){var A=y("./setcursor"),g="data-savedcursor",S="!!";ee.exports=function(e,a){var n=e.attr(g);if(a){if(!n){for(var r=(e.attr("class")||"").split(" "),t=0;t<r.length;t++){var h=r[t];h.indexOf("cursor-")===0&&e.attr(g,h.substr(7)).classed(h,!1)}e.attr(g)||e.attr(g,S)}A(e,a)}else n&&(e.attr(g,null),n===S?A(e):A(e,n))}},{"./setcursor":536}],527:[function(y,ee,te){var A=y("./matrix").dot,g=y("../constants/numerical").BADNUM,S=ee.exports={};S.tester=function(e){var a=e.slice(),n=a[0][0],r=n,t=a[0][1],h=t,s;for((a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),s=1;s<a.length;s++)n=Math.min(n,a[s][0]),r=Math.max(r,a[s][0]),t=Math.min(t,a[s][1]),h=Math.max(h,a[s][1]);var i=!1,x;a.length===5&&(a[0][0]===a[1][0]?a[2][0]===a[3][0]&&a[0][1]===a[3][1]&&a[1][1]===a[2][1]&&(i=!0,x=function(o){return o[0]===a[0][0]}):a[0][1]===a[1][1]&&a[2][1]===a[3][1]&&a[0][0]===a[3][0]&&a[1][0]===a[2][0]&&(i=!0,x=function(o){return o[1]===a[0][1]}));function p(o,m){var l=o[0],w=o[1];return!(l===g||l<n||l>r||w===g||w<t||w>h||m&&x(o))}function v(o,m){var l=o[0],w=o[1];if(l===g||l<n||l>r||w===g||w<t||w>h)return!1;var _=a.length,c=a[0][0],b=a[0][1],u=0,L,T,k,P,z;for(L=1;L<_;L++)if(T=c,k=b,c=a[L][0],b=a[L][1],P=Math.min(T,c),!(l<P||l>Math.max(T,c)||w>Math.max(k,b)))if(w<Math.min(k,b))l!==P&&u++;else{if(c===T?z=w:z=k+(l-T)*(b-k)/(c-T),w===z)return!(L===1&&m);w<=z&&l!==P&&u++}return u%2===1}var f=!0,d=a[0];for(s=1;s<a.length;s++)if(d[0]!==a[s][0]||d[1]!==a[s][1]){f=!1;break}return{xmin:n,xmax:r,ymin:t,ymax:h,pts:a,contains:i?p:v,isRect:i,degenerate:f}},S.isSegmentBent=function(e,a,n,r){var t=e[a],h=[e[n][0]-t[0],e[n][1]-t[1]],s=A(h,h),i=Math.sqrt(s),x=[-h[1]/i,h[0]/i],p,v,f;for(p=a+1;p<n;p++)if(v=[e[p][0]-t[0],e[p][1]-t[1]],f=A(v,h),f<0||f>s||Math.abs(A(v,x))>r)return!0;return!1},S.filter=function(e,a){var n=[e[0]],r=0,t=0;function h(i){e.push(i);var x=n.length,p=r;n.splice(t+1);for(var v=p+1;v<e.length;v++)(v===e.length-1||S.isSegmentBent(e,p,v+1,a))&&(n.push(e[v]),n.length<x-2&&(r=v,t=n.length-1),p=v)}if(e.length>1){var s=e.pop();h(s)}return{addPt:h,raw:e,filtered:n}}},{"../constants/numerical":491,"./matrix":521}],528:[function(y,ee,te){(function(A){(function(){var g=y("./show_no_webgl_msg"),S=y("regl");ee.exports=function(e,a,n){var r=e._fullLayout,t=!0;return r._glcanvas.each(function(h){if(h.regl){h.regl.preloadCachedCode(n);return}if(!(h.pick&&!r._has("parcoords"))){try{h.regl=S({canvas:this,attributes:{antialias:!h.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||A.devicePixelRatio,extensions:a||[],cachedCode:n||{}})}catch{t=!1}h.regl||(t=!1),t&&this.addEventListener("webglcontextlost",function(s){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:s,layer:h.key})},!1)}}),t||g({container:r._glcontainer.node()}),t}}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("is-mobile");ee.exports=function(e){var a;if(e&&e.hasOwnProperty("userAgent")?a=e.userAgent:a=S(),typeof a!="string")return!0;var n=g({ua:{headers:{"user-agent":a}},tablet:!0,featureDetect:!1});if(!n)for(var r=a.split(" "),t=1;t<r.length;t++){var h=r[t];if(h.indexOf("Safari")!==-1)for(var s=t-1;s>-1;s--){var i=r[s];if(i.substr(0,8)==="Version/"){var x=i.substr(8).split(".")[0];if(A(x)&&(x=+x),x>=13)return!0}}}return n};function S(){var M;return typeof navigator<"u"&&(M=navigator.userAgent),M&&M.headers&&typeof M.headers["user-agent"]=="string"&&(M=M.headers["user-agent"]),M}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(y,ee,te){ee.exports=function(g,S){if(S instanceof RegExp){for(var M=S.toString(),e=0;e<g.length;e++)if(g[e]instanceof RegExp&&g[e].toString()===M)return g;g.push(S)}else(S||S===0)&&g.indexOf(S)===-1&&g.push(S);return g}},{}],531:[function(y,ee,te){var A=y("../lib"),g=y("../plot_api/plot_config").dfltConfig;function S(e,a){for(var n=[],r,t=0;t<a.length;t++)r=a[t],r===e?n[t]=r:typeof r=="object"?n[t]=Array.isArray(r)?A.extendDeep([],r):A.extendDeepAll({},r):n[t]=r;return n}var M={};M.add=function(e,a,n,r,t){var h,s;if(e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},s=e.undoQueue.index,e.autoplay){e.undoQueue.inSequence||(e.autoplay=!1);return}!e.undoQueue.sequence||e.undoQueue.beginSequence?(h={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(s,e.undoQueue.queue.length-s,h),e.undoQueue.index+=1):h=e.undoQueue.queue[s-1],e.undoQueue.beginSequence=!1,h&&(h.undo.calls.unshift(a),h.undo.args.unshift(n),h.redo.calls.push(r),h.redo.args.push(t)),e.undoQueue.queue.length>g.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--)},M.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},M.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},M.undo=function(a){var n,r;if(!(a.undoQueue===void 0||isNaN(a.undoQueue.index)||a.undoQueue.index<=0)){for(a.undoQueue.index--,n=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,r=0;r<n.undo.calls.length;r++)M.plotDo(a,n.undo.calls[r],n.undo.args[r]);a.undoQueue.inSequence=!1,a.autoplay=!1}},M.redo=function(a){var n,r;if(!(a.undoQueue===void 0||isNaN(a.undoQueue.index)||a.undoQueue.index>=a.undoQueue.queue.length)){for(n=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,r=0;r<n.redo.calls.length;r++)M.plotDo(a,n.redo.calls[r],n.redo.args[r]);a.undoQueue.inSequence=!1,a.autoplay=!1,a.undoQueue.index++}},M.plotDo=function(e,a,n){e.autoplay=!0,n=S(e,n),a.apply(null,n)},ee.exports=M},{"../lib":515,"../plot_api/plot_config":553}],532:[function(y,ee,te){te.counter=function(A,g,S,M){var e=(g||"")+(S?"":"$"),a=M===!1?"":"^";return A==="xy"?new RegExp(a+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(a+A+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(y,ee,te){var A=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,g=/^[^\.\[\]]+$/;ee.exports=function(S,M){for(;M;){var e=S.match(A);if(e)S=e[1];else if(S.match(g))S="";else throw new Error("bad relativeAttr call:"+[S,M]);if(M.charAt(0)==="^")M=M.slice(1);else break}return S&&M.charAt(0)!=="["?S+"."+M:S+M}},{}],534:[function(y,ee,te){var A=y("./array").isArrayOrTypedArray,g=y("./is_plain_object");ee.exports=function S(M,e){for(var a in e){var n=e[a],r=M[a];if(r!==n)if(a.charAt(0)==="_"||typeof n=="function"){if(a in M)continue;M[a]=n}else if(A(n)&&A(r)&&g(n[0])){if(a==="customdata"||a==="ids")continue;for(var t=Math.min(n.length,r.length),h=0;h<t;h++)r[h]!==n[h]&&g(n[h])&&g(r[h])&&S(r[h],n[h])}else g(n)&&g(r)&&(S(r,n),Object.keys(r).length||delete M[a])}}},{"./array":497,"./is_plain_object":516}],535:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("./loggers"),S=y("./identity"),M=y("../constants/numerical").BADNUM,e=1e-9;te.findBin=function(h,s,i){if(A(s.start))return i?Math.ceil((h-s.start)/s.size-e)-1:Math.floor((h-s.start)/s.size+e);var x=0,p=s.length,v=0,f=p>1?(s[p-1]-s[0])/(p-1):1,d,o;for(f>=0?o=i?a:n:o=i?t:r,h+=f*e*(i?-1:1)*(f>=0?1:-1);x<p&&v++<100;)d=Math.floor((x+p)/2),o(s[d],h)?x=d+1:p=d;return v>90&&g.log("Long binary search..."),x-1};function a(h,s){return h<s}function n(h,s){return h<=s}function r(h,s){return h>s}function t(h,s){return h>=s}te.sorterAsc=function(h,s){return h-s},te.sorterDes=function(h,s){return s-h},te.distinctVals=function(h){var s=h.slice();s.sort(te.sorterAsc);var i;for(i=s.length-1;i>-1&&s[i]===M;i--);for(var x=s[i]-s[0]||1,p=x/(i||1)/1e4,v=[],f,d=0;d<=i;d++){var o=s[d],m=o-f;f===void 0?(v.push(o),f=o):m>p&&(x=Math.min(x,m),v.push(o),f=o)}return{vals:v,minDiff:x}},te.roundUp=function(h,s,i){for(var x=0,p=s.length-1,v,f=0,d=i?0:1,o=i?1:0,m=i?Math.ceil:Math.floor;x<p&&f++<100;)v=m((x+p)/2),s[v]<=h?x=v+d:p=v-o;return s[x]},te.sort=function(h,s){for(var i=0,x=0,p=1;p<h.length;p++){var v=s(h[p],h[p-1]);if(v<0?i=1:v>0&&(x=1),i&&x)return h.sort(s)}return x?h:h.reverse()},te.findIndexOfMin=function(h,s){s=s||S;for(var i=1/0,x,p=0;p<h.length;p++){var v=s(h[p]);v<i&&(i=v,x=p)}return x}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(y,ee,te){ee.exports=function(g,S){(g.attr("class")||"").split(" ").forEach(function(M){M.indexOf("cursor-")===0&&g.classed(M,!1)}),S&&g.classed("cursor-"+S,!0)}},{}],537:[function(y,ee,te){var A=y("../components/color"),g=function(){};ee.exports=function(M){for(var e in M)typeof M[e]=="function"&&(M[e]=g);M.destroy=function(){M.container.parentNode.removeChild(M.container)};var a=document.createElement("div");a.className="no-webgl",a.style.cursor="pointer",a.style.fontSize="24px",a.style.color=A.defaults[0],a.style.position="absolute",a.style.left=a.style.top="0px",a.style.width=a.style.height="100%",a.style["background-color"]=A.lightLine,a.style["z-index"]=30;var n=document.createElement("p");return n.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",n.style.position="relative",n.style.top="50%",n.style.left="50%",n.style.height="30%",n.style.width="50%",n.style.margin="-15% 0 0 -25%",a.appendChild(n),M.container.appendChild(a),M.container.style.background="#FFFFFF",M.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(y,ee,te){ee.exports=function(g){return Object.keys(g).sort()}},{}],539:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("./array").isArrayOrTypedArray;te.aggNums=function(S,M,e,a){var n,r;if((!a||a>e.length)&&(a=e.length),A(M)||(M=!1),g(e[0])){for(r=new Array(a),n=0;n<a;n++)r[n]=te.aggNums(S,M,e[n]);e=r}for(n=0;n<a;n++)A(M)?A(e[n])&&(M=S(+M,+e[n])):M=e[n];return M},te.len=function(S){return te.aggNums(function(M){return M+1},0,S)},te.mean=function(S,M){return M||(M=te.len(S)),te.aggNums(function(e,a){return e+a},0,S)/M},te.midRange=function(S){if(!(S===void 0||S.length===0))return(te.aggNums(Math.max,null,S)+te.aggNums(Math.min,null,S))/2},te.variance=function(S,M,e){return M||(M=te.len(S)),A(e)||(e=te.mean(S,M)),te.aggNums(function(a,n){return a+Math.pow(n-e,2)},0,S)/M},te.stdev=function(S,M,e){return Math.sqrt(te.variance(S,M,e))},te.median=function(S){var M=S.slice().sort();return te.interp(M,.5)},te.interp=function(S,M){if(!A(M))throw"n should be a finite number";if(M=M*S.length-.5,M<0)return S[0];if(M>S.length-1)return S[S.length-1];var e=M%1;return e*S[Math.ceil(M)]+(1-e)*S[Math.floor(M)]}},{"./array":497,"fast-isnumeric":190}],540:[function(y,ee,te){var A=y("color-normalize");function g(S){return S?A(S):[0,0,0,1]}ee.exports=g},{"color-normalize":89}],541:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../lib"),S=g.strTranslate,M=y("../constants/xmlns_namespaces"),e=y("../constants/alignment").LINE_SPACING,a=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;te.convertToTspans=function(F,N,G){var K=F.text(),W=!F.attr("data-notex")&&N&&N._context.typesetMath&&typeof MathJax<"u"&&K.match(a),Y=A.select(F.node().parentNode);if(Y.empty())return;var re=F.attr("class")?F.attr("class").split(" ")[0]:"text";re+="-math",Y.selectAll("svg."+re).remove(),Y.selectAll("g."+re+"-group").remove(),F.style("display",null).attr({"data-unformatted":K,"data-math":"N"});function ue(){Y.empty()||(re=F.attr("class")+"-math",Y.select("svg."+re).remove()),F.text("").style("white-space","pre");var j=I(F.node(),K);j&&F.style("pointer-events","all"),te.positionText(F),G&&G.call(F)}return W?(N&&N._promises||[]).push(new Promise(function(j){F.style("display","none");var q=parseInt(F.node().style.fontSize,10),H={fontSize:q};s(W[2],H,function(U,$,ne){Y.selectAll("svg."+re).remove(),Y.selectAll("g."+re+"-group").remove();var X=U&&U.select("svg");if(!X||!X.node()){ue(),j();return}var Q=Y.append("g").classed(re+"-group",!0).attr({"pointer-events":"none","data-unformatted":K,"data-math":"Y"});Q.node().appendChild(X.node()),$&&$.node()&&X.node().insertBefore($.node().cloneNode(!0),X.node().firstChild);var ie=ne.width,se=ne.height;X.attr({class:re,height:se,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ae=F.node().style.fill||"black",oe=X.select("g");oe.attr({fill:ae,stroke:ae});var be=oe.node().getBoundingClientRect(),ce=be.width,de=be.height;(ce>ie||de>se)&&(X.style("overflow","hidden"),be=X.node().getBoundingClientRect(),ce=be.width,de=be.height);var ye=+F.attr("x"),ge=+F.attr("y"),me=q||F.node().getBoundingClientRect().height,Ee=-me/4;if(re[0]==="y")Q.attr({transform:"rotate("+[-90,ye,ge]+")"+S(-ce/2,Ee-de/2)});else if(re[0]==="l")ge=Ee-de/2;else if(re[0]==="a"&&re.indexOf("atitle")!==0)ye=0,ge=Ee;else{var Pe=F.attr("text-anchor");ye=ye-ce*(Pe==="middle"?.5:Pe==="end"?1:0),ge=ge+Ee-de/2}X.attr({x:ye,y:ge}),G&&G.call(F,Q),j(Q)})})):ue(),F};var n=/(<|&lt;|&#60;)/g,r=/(>|&gt;|&#62;)/g;function t(F){return F.replace(n,"\\lt ").replace(r,"\\gt ")}var h=[["$","$"],["\\(","\\)"]];function s(F,N,G){var K=parseInt((MathJax.version||"").split(".")[0]);if(K!==2&&K!==3){g.warn("No MathJax version:",MathJax.version);return}var W,Y,re,ue,j=function(){return Y=g.extendDeepAll({},MathJax.Hub.config),re=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:h},displayAlign:"left"})},q=function(){Y=g.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=h},H=function(){if(W=MathJax.Hub.config.menuSettings.renderer,W!=="SVG")return MathJax.Hub.setRenderer("SVG")},U=function(){W=MathJax.config.startup.output,W!=="svg"&&(MathJax.config.startup.output="svg")},$=function(){var ae="math-output-"+g.randstr({},64);ue=A.select("body").append("div").attr({id:ae}).style({visibility:"hidden",position:"absolute","font-size":N.fontSize+"px"}).text(t(F));var oe=ue.node();return K===2?MathJax.Hub.Typeset(oe):MathJax.typeset([oe])},ne=function(){var ae=ue.select(K===2?".MathJax_SVG":".MathJax"),oe=!ae.empty()&&ue.select("svg").node();if(!oe)g.log("There was an error in the tex syntax.",F),G();else{var be=oe.getBoundingClientRect(),ce;K===2?ce=A.select("body").select("#MathJax_SVG_glyphs"):ce=ae.select("defs"),G(ae,ce,be)}ue.remove()},X=function(){if(W!=="SVG")return MathJax.Hub.setRenderer(W)},Q=function(){W!=="svg"&&(MathJax.config.startup.output=W)},ie=function(){return re!==void 0&&(MathJax.Hub.processSectionDelay=re),MathJax.Hub.Config(Y)},se=function(){MathJax.config=Y};K===2?MathJax.Hub.Queue(j,H,$,ne,X,ie):K===3&&(q(),U(),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){$(),ne(),Q(),se()}))}var i={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},x={sub:"0.3em",sup:"-0.6em"},p={sub:"-0.21em",sup:"0.42em"},v="",f=["http:","https:","mailto:","",void 0,":"],d=te.NEWLINES=/(\r\n?|\n)/g,o=/(<[^<>]*>)/,m=/<(\/?)([^ >]*)(\s+(.*))?>/i,l=/<br(\s+.*)?>/i;te.BR_TAG_ALL=/<br(\s+.*)?>/gi;var w=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,_=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,c=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,b=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function u(F,N){if(!F)return null;var G=F.match(N),K=G&&(G[3]||G[4]);return K&&P(K)}var L=/(^|;)\s*color:/;te.plainText=function(F,N){N=N||{};for(var G=N.len!==void 0&&N.len!==-1?N.len:1/0,K=N.allowedTags!==void 0?N.allowedTags:["br"],W="...",Y=W.length,re=F.split(o),ue=[],j="",q=0,H=0;H<re.length;H++){var U=re[H],$=U.match(m),ne=$&&$[2].toLowerCase();if(ne)K.indexOf(ne)!==-1&&(ue.push(U),j=ne);else{var X=U.length;if(q+X<G)ue.push(U),q+=X;else if(q<G){var Q=G-q;j&&(j!=="br"||Q<=Y||X<=Y)&&ue.pop(),G>Y?ue.push(U.substr(0,Q-Y)+W):ue.push(U.substr(0,Q));break}j=""}}return ue.join("")};var T={mu:"",amp:"&",lt:"<",gt:">",nbsp:"",times:"",plusmn:"",deg:""},k=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function P(F){return F.replace(k,function(N,G){var K;return G.charAt(0)==="#"?K=z(G.charAt(1)==="x"?parseInt(G.substr(2),16):parseInt(G.substr(1),10)):K=T[G],K||N})}te.convertEntities=P;function z(F){if(!(F>1114111)){var N=String.fromCodePoint;if(N)return N(F);var G=String.fromCharCode;return F<=65535?G(F):G((F>>10)+55232,F%1024+56320)}}function I(F,N){N=N.replace(d," ");var G=!1,K=[],W,Y=-1;function re(){Y++;var de=document.createElementNS(M.svg,"tspan");A.select(de).attr({class:"line",dy:Y*e+"em"}),F.appendChild(de),W=de;var ye=K;if(K=[{node:de}],ye.length>1)for(var ge=1;ge<ye.length;ge++)ue(ye[ge])}function ue(de){var ye=de.type,ge={},me;if(ye==="a"){me="a";var Ee=de.target,Pe=de.href,Ue=de.popup;Pe&&(ge={"xlink:xlink:show":Ee==="_blank"||Ee.charAt(0)!=="_"?"new":"replace",target:Ee,"xlink:xlink:href":Pe},Ue&&(ge.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Ue+'");return false;'))}else me="tspan";de.style&&(ge.style=de.style);var we=document.createElementNS(M.svg,me);if(ye==="sup"||ye==="sub"){j(W,v),W.appendChild(we);var ke=document.createElementNS(M.svg,"tspan");j(ke,v),A.select(ke).attr("dy",p[ye]),ge.dy=x[ye],W.appendChild(we),W.appendChild(ke)}else W.appendChild(we);A.select(we).attr(ge),W=de.node=we,K.push(de)}function j(de,ye){de.appendChild(document.createTextNode(ye))}function q(de){if(K.length===1){g.log("Ignoring unexpected end tag </"+de+">.",N);return}var ye=K.pop();de!==ye.type&&g.log("Start tag <"+ye.type+"> doesnt match end tag <"+de+">. Pretending it did match.",N),W=K[K.length-1].node}var H=l.test(N);H?re():(W=F,K=[{node:F}]);for(var U=N.split(o),$=0;$<U.length;$++){var ne=U[$],X=ne.match(m),Q=X&&X[2].toLowerCase(),ie=i[Q];if(Q==="br")re();else if(ie===void 0)j(W,P(ne));else if(X[1])q(Q);else{var se=X[4],ae={type:Q},oe=u(se,w);if(oe?(oe=oe.replace(L,"$1 fill:"),ie&&(oe+=";"+ie)):ie&&(oe=ie),oe&&(ae.style=oe),Q==="a"){G=!0;var be=u(se,_);if(be){var ce=D(be);ce&&(ae.href=ce,ae.target=u(se,c)||"_blank",ae.popup=u(se,b))}}ue(ae)}}return G}function D(F){var N=encodeURI(decodeURI(F)),G=document.createElement("a"),K=document.createElement("a");G.href=F,K.href=N;var W=G.protocol,Y=K.protocol;return f.indexOf(W)!==-1&&f.indexOf(Y)!==-1?N:""}te.sanitizeHTML=function(N){N=N.replace(d," ");for(var G=document.createElement("p"),K=G,W=[],Y=N.split(o),re=0;re<Y.length;re++){var ue=Y[re],j=ue.match(m),q=j&&j[2].toLowerCase();if(q in i)if(j[1])W.length&&(K=W.pop());else{var H=j[4],U=u(H,w),$=U?{style:U}:{};if(q==="a"){var ne=u(H,_);if(ne){var X=D(ne);if(X){$.href=X;var Q=u(H,c);Q&&($.target=Q)}}}var ie=document.createElement(q);K.appendChild(ie),A.select(ie).attr($),K=ie,W.push(ie)}else K.appendChild(document.createTextNode(P(ue)))}var se="innerHTML";return G[se]},te.lineCount=function(N){return N.selectAll("tspan.line").size()||1},te.positionText=function(N,G,K){return N.each(function(){var W=A.select(this);function Y(j,q){return q===void 0?(q=W.attr(j),q===null&&(W.attr(j,0),q=0)):W.attr(j,q),q}var re=Y("x",G),ue=Y("y",K);this.nodeName==="text"&&W.selectAll("tspan.line").attr({x:re,y:ue})})};function R(F,N,G){var K=G.horizontalAlign,W=G.verticalAlign||"top",Y=F.node().getBoundingClientRect(),re=N.node().getBoundingClientRect(),ue,j,q;return W==="bottom"?j=function(){return Y.bottom-ue.height}:W==="middle"?j=function(){return Y.top+(Y.height-ue.height)/2}:j=function(){return Y.top},K==="right"?q=function(){return Y.right-ue.width}:K==="center"?q=function(){return Y.left+(Y.width-ue.width)/2}:q=function(){return Y.left},function(){ue=this.node().getBoundingClientRect();var H=q()-re.left,U=j()-re.top,$=G.gd||{};if(G.gd){$._fullLayout._calcInverseTransform($);var ne=g.apply3DTransform($._fullLayout._invTransform)(H,U);H=ne[0],U=ne[1]}return this.style({top:U+"px",left:H+"px","z-index":1e3}),this}}var O="1px ";te.makeTextShadow=function(F){var N=O,G=O,K=O;return N+G+K+F+", -"+N+"-"+G+K+F+", "+N+"-"+G+K+F+", -"+N+G+K+F},te.makeEditable=function(F,N){var G=N.gd,K=N.delegate,W=A.dispatch("edit","input","cancel"),Y=K||F;if(F.style({"pointer-events":K?"none":"all"}),F.size()!==1)throw new Error("boo");function re(){j(),F.style({opacity:0});var q=Y.attr("class"),H;q?H="."+q.split(" ")[0]+"-math-group":H="[class*=-math-group]",H&&A.select(F.node().parentNode).select(H).style({opacity:0})}function ue(q){var H=q.node(),U=document.createRange();U.selectNodeContents(H);var $=window.getSelection();$.removeAllRanges(),$.addRange(U),H.focus()}function j(){var q=A.select(G),H=q.select(".svg-container"),U=H.append("div"),$=F.node().style,ne=parseFloat($.fontSize||12),X=N.text;X===void 0&&(X=F.attr("data-unformatted")),U.classed("plugin-editable editable",!0).style({position:"absolute","font-family":$.fontFamily||"Arial","font-size":ne,color:N.fill||$.fill||"black",opacity:1,"background-color":N.background||"transparent",outline:"#ffffff33 1px solid",margin:[-ne/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(X).call(R(F,H,N)).on("blur",function(){G._editing=!1,F.text(this.textContent).style({opacity:1});var Q=A.select(this).attr("class"),ie;Q?ie="."+Q.split(" ")[0]+"-math-group":ie="[class*=-math-group]",ie&&A.select(F.node().parentNode).select(ie).style({opacity:0});var se=this.textContent;A.select(this).transition().duration(0).remove(),A.select(document).on("mouseup",null),W.edit.call(F,se)}).on("focus",function(){var Q=this;G._editing=!0,A.select(document).on("mouseup",function(){if(A.event.target===Q)return!1;document.activeElement===U.node()&&U.node().blur()})}).on("keyup",function(){A.event.which===27?(G._editing=!1,F.style({opacity:1}),A.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),W.cancel.call(F,this.textContent)):(W.input.call(F,this.textContent),A.select(this).call(R(F,H,N)))}).on("keydown",function(){A.event.which===13&&this.blur()}).call(ue)}return N.immediate?re():Y.on("click",re),A.rebind(F,W,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(y,ee,te){var A={};te.throttle=function(M,e,a){var n=A[M],r=Date.now();if(!n){for(var t in A)A[t].ts<r-6e4&&delete A[t];n=A[M]={ts:0,timer:null}}g(n);function h(){a(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}if(r>n.ts+e){h();return}n.timer=setTimeout(function(){h(),n.timer=null},e)},te.done=function(S){var M=A[S];return!M||!M.timer?Promise.resolve():new Promise(function(e){var a=M.onDone;M.onDone=function(){a&&a(),e(),M.onDone=null}})},te.clear=function(S){if(S)g(A[S]),delete A[S];else for(var M in A)te.clear(M)};function g(S){S&&S.timer!==null&&(clearTimeout(S.timer),S.timer=null)}},{}],543:[function(y,ee,te){var A=y("fast-isnumeric");ee.exports=function(S,M){if(S>0)return Math.log(S)/Math.LN10;var e=Math.log(Math.min(M[0],M[1]))/Math.LN10;return A(e)||(e=Math.log(Math.max(M[0],M[1]))/Math.LN10-6),e}},{"fast-isnumeric":190}],544:[function(y,ee,te){var A=ee.exports={},g=y("../plots/geo/constants").locationmodeToLayer,S=y("topojson-client").feature;A.getTopojsonName=function(M){return[M.scope.replace(/ /g,"-"),"_",M.resolution.toString(),"m"].join("")},A.getTopojsonPath=function(M,e){return M+e+".json"},A.getTopojsonFeatures=function(M,e){var a=g[M.locationmode],n=e.objects[a];return S(e,n).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(y,ee,te){ee.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(y,ee,te){ee.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(y,ee,te){var A=y("../registry");ee.exports=function(S){for(var M=A.layoutArrayContainers,e=A.layoutArrayRegexes,a=S.split("[")[0],n,r,t=0;t<e.length;t++)if(r=S.match(e[t]),r&&r.index===0){n=r[0];break}if(n||(n=M[M.indexOf(a)]),!n)return!1;var h=S.substr(n.length);return h?(r=h.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),r?{array:n,index:Number(r[1]),property:r[3]||""}:!1):{array:n,index:"",property:""}}},{"../registry":647}],548:[function(y,ee,te){var A=y("../lib"),g=A.extendFlat,S=A.isPlainObject,M={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},a=M.flags.slice().concat(["fullReplot"]),n=e.flags.slice().concat("layoutReplot");ee.exports={traces:M,layout:e,traceFlags:function(){return r(a)},layoutFlags:function(){return r(n)},update:function(s,i){var x=i.editType;if(x&&x!=="none")for(var p=x.split("+"),v=0;v<p.length;v++)s[p[v]]=!0},overrideAll:t};function r(s){for(var i={},x=0;x<s.length;x++)i[s[x]]=!1;return i}function t(s,i,x){var p=g({},s);for(var v in p){var f=p[v];S(f)&&(p[v]=h(f,i,x,v))}return x==="from-root"&&(p.editType=i),p}function h(s,i,x,p){if(s.valType){var v=g({},s);if(v.editType=i,Array.isArray(s.items)){v.items=new Array(s.items.length);for(var f=0;f<s.items.length;f++)v.items[f]=h(s.items[f],i)}return v}else return t(s,i,p.charAt(0)==="_"?"nested":"from-root")}},{"../lib":515}],549:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("gl-mat4/fromQuat"),S=y("../registry"),M=y("../lib"),e=y("../plots/plots"),a=y("../plots/cartesian/axis_ids"),n=y("../components/color"),r=a.cleanId,t=a.getFromTrace,h=S.traceIs;te.clearPromiseQueue=function(l){Array.isArray(l._promises)&&l._promises.length>0&&M.log("Clearing previous rejected promises from queue."),l._promises=[]},te.cleanLayout=function(l){var w,_;l||(l={}),l.xaxis1&&(l.xaxis||(l.xaxis=l.xaxis1),delete l.xaxis1),l.yaxis1&&(l.yaxis||(l.yaxis=l.yaxis1),delete l.yaxis1),l.scene1&&(l.scene||(l.scene=l.scene1),delete l.scene1);var c=(e.subplotsRegistry.cartesian||{}).attrRegex,b=(e.subplotsRegistry.polar||{}).attrRegex,u=(e.subplotsRegistry.ternary||{}).attrRegex,L=(e.subplotsRegistry.gl3d||{}).attrRegex,T=Object.keys(l);for(w=0;w<T.length;w++){var k=T[w];if(c&&c.test(k)){var P=l[k];P.anchor&&P.anchor!=="free"&&(P.anchor=r(P.anchor)),P.overlaying&&(P.overlaying=r(P.overlaying)),P.type||(P.isdate?P.type="date":P.islog?P.type="log":P.isdate===!1&&P.islog===!1&&(P.type="linear")),(P.autorange==="withzero"||P.autorange==="tozero")&&(P.autorange=!0,P.rangemode="tozero"),delete P.islog,delete P.isdate,delete P.categories,f(P,"domain")&&delete P.domain,P.autotick!==void 0&&(P.tickmode===void 0&&(P.tickmode=P.autotick?"auto":"linear"),delete P.autotick),i(P)}else if(b&&b.test(k)){var z=l[k];i(z.radialaxis)}else if(u&&u.test(k)){var I=l[k];i(I.aaxis),i(I.baxis),i(I.caxis)}else if(L&&L.test(k)){var D=l[k],R=D.cameraposition;if(Array.isArray(R)&&R[0].length===4){var O=R[0],F=R[1],N=R[2],G=g([],O),K=[];for(_=0;_<3;++_)K[_]=F[_]+N*G[2+4*_];D.camera={eye:{x:K[0],y:K[1],z:K[2]},center:{x:F[0],y:F[1],z:F[2]},up:{x:0,y:0,z:1}},delete D.cameraposition}i(D.xaxis),i(D.yaxis),i(D.zaxis)}}var W=Array.isArray(l.annotations)?l.annotations.length:0;for(w=0;w<W;w++){var Y=l.annotations[w];M.isPlainObject(Y)&&(Y.ref&&(Y.ref==="paper"?(Y.xref="paper",Y.yref="paper"):Y.ref==="data"&&(Y.xref="x",Y.yref="y"),delete Y.ref),s(Y,"xref"),s(Y,"yref"))}var re=Array.isArray(l.shapes)?l.shapes.length:0;for(w=0;w<re;w++){var ue=l.shapes[w];M.isPlainObject(ue)&&(s(ue,"xref"),s(ue,"yref"))}var j=Array.isArray(l.images)?l.images.length:0;for(w=0;w<j;w++){var q=l.images[w];M.isPlainObject(q)&&(s(q,"xref"),s(q,"yref"))}var H=l.legend;return H&&(H.x>3?(H.x=1.02,H.xanchor="left"):H.x<-2&&(H.x=-.02,H.xanchor="right"),H.y>3?(H.y=1.02,H.yanchor="bottom"):H.y<-2&&(H.y=-.02,H.yanchor="top")),i(l),l.dragmode==="rotate"&&(l.dragmode="orbit"),n.clean(l),l.template&&l.template.layout&&te.cleanLayout(l.template.layout),l};function s(l,w){var _=l[w],c=w.charAt(0);_&&_!=="paper"&&(l[w]=r(_,c,!0))}function i(l){l&&((typeof l.title=="string"||typeof l.title=="number")&&(l.title={text:l.title}),w("titlefont","font"),w("titleposition","position"),w("titleside","side"),w("titleoffset","offset"));function w(_,c){var b=l[_],u=l.title&&l.title[c];b&&!u&&(l.title||(l.title={}),l.title[c]=l[_],delete l[_])}}te.cleanData=function(l){for(var w=0;w<l.length;w++){var _=l[w],c;if(_.type==="histogramy"&&"xbins"in _&&!("ybins"in _)&&(_.ybins=_.xbins,delete _.xbins),_.error_y&&"opacity"in _.error_y){var b=n.defaults,u=_.error_y.color||(h(_,"bar")?n.defaultLine:b[w%b.length]);_.error_y.color=n.addOpacity(n.rgb(u),n.opacity(u)*_.error_y.opacity),delete _.error_y.opacity}if("bardir"in _&&(_.bardir==="h"&&(h(_,"bar")||_.type.substr(0,9)==="histogram")&&(_.orientation="h",te.swapXYData(_)),delete _.bardir),_.type==="histogramy"&&te.swapXYData(_),(_.type==="histogramx"||_.type==="histogramy")&&(_.type="histogram"),"scl"in _&&!("colorscale"in _)&&(_.colorscale=_.scl,delete _.scl),"reversescl"in _&&!("reversescale"in _)&&(_.reversescale=_.reversescl,delete _.reversescl),_.xaxis&&(_.xaxis=r(_.xaxis,"x")),_.yaxis&&(_.yaxis=r(_.yaxis,"y")),h(_,"gl3d")&&_.scene&&(_.scene=e.subplotsRegistry.gl3d.cleanId(_.scene)),!h(_,"pie-like")&&!h(_,"bar-like"))if(Array.isArray(_.textposition))for(c=0;c<_.textposition.length;c++)_.textposition[c]=v(_.textposition[c]);else _.textposition&&(_.textposition=v(_.textposition));var L=S.getModule(_);if(L&&L.colorbar){var T=L.colorbar.container,k=T?_[T]:_;k&&k.colorscale&&(k.colorscale==="YIGnBu"&&(k.colorscale="YlGnBu"),k.colorscale==="YIOrRd"&&(k.colorscale="YlOrRd"))}if(_.type==="surface"&&M.isPlainObject(_.contours)){var P=["x","y","z"];for(c=0;c<P.length;c++){var z=_.contours[P[c]];M.isPlainObject(z)&&(z.highlightColor&&(z.highlightcolor=z.highlightColor,delete z.highlightColor),z.highlightWidth&&(z.highlightwidth=z.highlightWidth,delete z.highlightWidth))}}if(_.type==="candlestick"||_.type==="ohlc"){var I=(_.increasing||{}).showlegend!==!1,D=(_.decreasing||{}).showlegend!==!1,R=x(_.increasing),O=x(_.decreasing);if(R!==!1&&O!==!1){var F=p(R,O,I,D);F&&(_.name=F)}else(R||O)&&!_.name&&(_.name=R||O)}if(Array.isArray(_.transforms)){var N=_.transforms;for(c=0;c<N.length;c++){var G=N[c];if(M.isPlainObject(G))switch(G.type){case"filter":G.filtersrc&&(G.target=G.filtersrc,delete G.filtersrc),G.calendar&&(G.valuecalendar||(G.valuecalendar=G.calendar),delete G.calendar);break;case"groupby":if(G.styles=G.styles||G.style,G.styles&&!Array.isArray(G.styles)){var K=G.styles,W=Object.keys(K);G.styles=[];for(var Y=0;Y<W.length;Y++)G.styles.push({target:W[Y],value:K[W[Y]]})}break}}}f(_,"line")&&delete _.line,"marker"in _&&(f(_.marker,"line")&&delete _.marker.line,f(_,"marker")&&delete _.marker),n.clean(_),_.autobinx&&(delete _.autobinx,delete _.xbins),_.autobiny&&(delete _.autobiny,delete _.ybins),i(_),_.colorbar&&i(_.colorbar),_.marker&&_.marker.colorbar&&i(_.marker.colorbar),_.line&&_.line.colorbar&&i(_.line.colorbar),_.aaxis&&i(_.aaxis),_.baxis&&i(_.baxis)}};function x(l){if(!M.isPlainObject(l))return!1;var w=l.name;return delete l.name,delete l.showlegend,(typeof w=="string"||typeof w=="number")&&String(w)}function p(l,w,_,c){if(_&&!c)return l;if(c&&!_||!l.trim())return w;if(!w.trim())return l;var b=Math.min(l.length,w.length),u;for(u=0;u<b&&l.charAt(u)===w.charAt(u);u++);var L=l.substr(0,u);return L.trim()}function v(l){var w="middle",_="center";return typeof l=="string"&&(l.indexOf("top")!==-1?w="top":l.indexOf("bottom")!==-1&&(w="bottom"),l.indexOf("left")!==-1?_="left":l.indexOf("right")!==-1&&(_="right")),w+" "+_}function f(l,w){return w in l&&typeof l[w]=="object"&&Object.keys(l[w]).length===0}te.swapXYData=function(l){var w;if(M.swapAttrs(l,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(l.z)&&Array.isArray(l.z[0])&&(l.transpose?delete l.transpose:l.transpose=!0),l.error_x&&l.error_y){var _=l.error_y,c="copy_ystyle"in _?_.copy_ystyle:!(_.color||_.thickness||_.width);M.swapAttrs(l,["error_?.copy_ystyle"]),c&&M.swapAttrs(l,["error_?.color","error_?.thickness","error_?.width"])}if(typeof l.hoverinfo=="string"){var b=l.hoverinfo.split("+");for(w=0;w<b.length;w++)b[w]==="x"?b[w]="y":b[w]==="y"&&(b[w]="x");l.hoverinfo=b.join("+")}},te.coerceTraceIndices=function(l,w){if(A(w))return[w];if(!Array.isArray(w)||!w.length)return l.data.map(function(b,u){return u});if(Array.isArray(w)){for(var _=[],c=0;c<w.length;c++)M.isIndex(w[c],l.data.length)?_.push(w[c]):M.warn("trace index (",w[c],") is not a number or is out of bounds");return _}return w},te.manageArrayContainers=function(l,w,_){var c=l.obj,b=l.parts,u=b.length,L=b[u-1],T=A(L);if(T&&w===null){var k=b.slice(0,u-1).join("."),P=M.nestedProperty(c,k).get();P.splice(L,1)}else T&&l.get()===void 0&&l.get()===void 0&&(_[l.astr]=null),l.set(w)};var d=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function o(l){var w=l.search(d);if(w>0)return l.substr(0,w)}te.hasParent=function(l,w){for(var _=o(w);_;){if(_ in l)return!0;_=o(_)}return!1};var m=["x","y","z"];te.clearAxisTypes=function(l,w,_){for(var c=0;c<w.length;c++)for(var b=l._fullData[c],u=0;u<3;u++){var L=t(l,b,m[u]);if(L&&L.type!=="log"){var T=L._name,k=L._id.substr(1);if(k.substr(0,5)==="scene"){if(_[k]!==void 0)continue;T=k+"."+T}var P=T+".type";_[T]===void 0&&_[P]===void 0&&M.nestedProperty(l.layout,P).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(y,ee,te){var A=y("./plot_api");te._doPlot=A._doPlot,te.newPlot=A.newPlot,te.restyle=A.restyle,te.relayout=A.relayout,te.redraw=A.redraw,te.update=A.update,te._guiRestyle=A._guiRestyle,te._guiRelayout=A._guiRelayout,te._guiUpdate=A._guiUpdate,te._storeDirectGUIEdit=A._storeDirectGUIEdit,te.react=A.react,te.extendTraces=A.extendTraces,te.prependTraces=A.prependTraces,te.addTraces=A.addTraces,te.deleteTraces=A.deleteTraces,te.moveTraces=A.moveTraces,te.purge=A.purge,te.addFrames=A.addFrames,te.deleteFrames=A.deleteFrames,te.animate=A.animate,te.setPlotConfig=A.setPlotConfig,te.toImage=y("./to_image"),te.validate=y("./validate"),te.downloadImage=y("../snapshot/download");var g=y("./template_api");te.makeTemplate=g.makeTemplate,te.validateTemplate=g.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(y,ee,te){var A=y("../lib/is_plain_object"),g=y("../lib/noop"),S=y("../lib/loggers"),M=y("../lib/search").sorterAsc,e=y("../registry");te.containerArrayMatch=y("./container_array_match");var a=te.isAddVal=function(t){return t==="add"||A(t)},n=te.isRemoveVal=function(t){return t===null||t==="remove"};te.applyContainerArrayChanges=function(t,h,s,i,x){var p=h.astr,v=e.getComponentMethod(p,"supplyLayoutDefaults"),f=e.getComponentMethod(p,"draw"),d=e.getComponentMethod(p,"drawOne"),o=i.replot||i.recalc||v===g||f===g,m=t.layout,l=t._fullLayout;if(s[""]){Object.keys(s).length>1&&S.warn("Full array edits are incompatible with other edits",p);var w=s[""][""];if(n(w))h.set(null);else if(Array.isArray(w))h.set(w);else return S.warn("Unrecognized full array edit value",p,w),!0;return o?!1:(v(m,l),f(t),!0)}var _=Object.keys(s).map(Number).sort(M),c=h.get(),b=c||[],u=x(l,p).get(),L=[],T=-1,k=b.length,P,z,I,D,R,O,F,N;for(P=0;P<_.length;P++){if(I=_[P],D=s[I],R=Object.keys(D),O=D[""],F=a(O),I<0||I>b.length-(F?0:1)){S.warn("index out of range",p,I);continue}if(O!==void 0)R.length>1&&S.warn("Insertion & removal are incompatible with edits to the same index.",p,I),n(O)?L.push(I):F?(O==="add"&&(O={}),b.splice(I,0,O),u&&u.splice(I,0,{})):S.warn("Unrecognized full object edit value",p,I,O),T===-1&&(T=I);else for(z=0;z<R.length;z++)N=p+"["+I+"].",x(b[I],R[z],N).set(D[R[z]])}for(P=L.length-1;P>=0;P--)b.splice(L[P],1),u&&u.splice(L[P],1);if(b.length?c||h.set(b):h.set(null),o)return!1;if(v(m,l),d!==g){var G;if(T===-1)G=_;else{for(k=Math.max(b.length,k),G=[],P=0;P<_.length&&(I=_[P],!(I>=T));P++)G.push(I);for(P=T;P<k;P++)G.push(P)}for(P=0;P<G.length;P++)d(t,G[P])}else f(t);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("has-hover"),M=y("../lib"),e=M.nestedProperty,a=y("../lib/events"),n=y("../lib/queue"),r=y("../registry"),t=y("./plot_schema"),h=y("../plots/plots"),s=y("../plots/cartesian/axes"),i=y("../components/drawing"),x=y("../components/color"),p=y("../plots/cartesian/graph_interact").initInteractions,v=y("../constants/xmlns_namespaces"),f=y("../components/selections").clearOutline,d=y("./plot_config").dfltConfig,o=y("./manage_arrays"),m=y("./helpers"),l=y("./subroutines"),w=y("./edit_types"),_=y("../plots/cartesian/constants").AX_NAME_PATTERN,c=0,b=5;function u(Ae,Ne,Ze,Qe){var bt;if(Ae=M.getGraphDiv(Ae),a.init(Ae),M.isPlainObject(Ne)){var dt=Ne;Ne=dt.data,Ze=dt.layout,Qe=dt.config,bt=dt.frames}var wt=a.triggerHandler(Ae,"plotly_beforeplot",[Ne,Ze,Qe]);if(wt===!1)return Promise.reject();!Ne&&!Ze&&!M.isPlotDiv(Ae)&&M.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",Ae);function Ut(){if(bt)return te.addFrames(Ae,bt)}z(Ae,Qe),Ze||(Ze={}),A.select(Ae).classed("js-plotly-plot",!0),i.makeTester(),Array.isArray(Ae._promises)||(Ae._promises=[]);var Rt=(Ae.data||[]).length===0&&Array.isArray(Ne);Array.isArray(Ne)&&(m.cleanData(Ne),Rt?Ae.data=Ne:Ae.data.push.apply(Ae.data,Ne),Ae.empty=!1),(!Ae.layout||Rt)&&(Ae.layout=m.cleanLayout(Ze)),h.supplyDefaults(Ae);var Nt=Ae._fullLayout,Wt=Nt._has("cartesian");Nt._replotting=!0,(Rt||Nt._shouldCreateBgLayer)&&(He(Ae),Nt._shouldCreateBgLayer&&delete Nt._shouldCreateBgLayer),i.initGradients(Ae),i.initPatterns(Ae),Rt&&s.saveShowSpikeInitial(Ae);var Vt=!Ae.calcdata||Ae.calcdata.length!==(Ae._fullData||[]).length;Vt&&h.doCalcdata(Ae);for(var ir=0;ir<Ae.calcdata.length;ir++)Ae.calcdata[ir][0].trace=Ae._fullData[ir];Ae._context.responsive?Ae._responsiveChartHandler||(Ae._responsiveChartHandler=function(){M.isHidden(Ae)||h.resize(Ae)},window.addEventListener("resize",Ae._responsiveChartHandler)):M.clearResponsive(Ae);var Hr=M.extendFlat({},Nt._size),sn=0;function jr(){for(var lt=Nt._basePlotModules,Tt=0;Tt<lt.length;Tt++)lt[Tt].drawFramework&&lt[Tt].drawFramework(Ae);!Nt._glcanvas&&Nt._has("gl")&&(Nt._glcanvas=Nt._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(nt){return nt.key}),Nt._glcanvas.enter().append("canvas").attr("class",function(nt){return"gl-canvas gl-canvas-"+nt.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var zt=Ae._context.plotGlPixelRatio;if(Nt._glcanvas){Nt._glcanvas.attr("width",Nt.width*zt).attr("height",Nt.height*zt).style("width",Nt.width+"px").style("height",Nt.height+"px");var Ce=Nt._glcanvas.data()[0].regl;if(Ce&&(Math.floor(Nt.width*zt)!==Ce._gl.drawingBufferWidth||Math.floor(Nt.height*zt)!==Ce._gl.drawingBufferHeight)){var Se="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(sn)M.error(Se);else return M.log(Se+" Clearing graph and plotting again."),h.cleanPlot([],{},Ae._fullData,Nt),h.supplyDefaults(Ae),Nt=Ae._fullLayout,h.doCalcdata(Ae),sn++,jr()}}return Nt.modebar.orientation==="h"?Nt._modebardiv.style("height",null).style("width","100%"):Nt._modebardiv.style("width",null).style("height",Nt.height+"px"),h.previousPromises(Ae)}function at(){if(h.clearAutoMarginIds(Ae),l.drawMarginPushers(Ae),s.allowAutoMargin(Ae),Nt._has("pie"))for(var lt=Ae._fullData,Tt=0;Tt<lt.length;Tt++){var zt=lt[Tt];zt.type==="pie"&&zt.automargin&&h.allowAutoMargin(Ae,"pie."+zt.uid+".automargin")}return h.doAutoMargin(Ae),h.previousPromises(Ae)}function $t(){if(h.didMarginChange(Hr,Nt._size))return M.syncOrAsync([at,l.layoutStyles],Ae)}function Jt(){if(!Vt){Gt();return}return M.syncOrAsync([r.getComponentMethod("shapes","calcAutorange"),r.getComponentMethod("annotations","calcAutorange"),Gt],Ae)}function Gt(){Ae._transitioning||(l.doAutoRangeAndConstraints(Ae),Rt&&s.saveRangeInitial(Ae),r.getComponentMethod("rangeslider","calcAutorange")(Ae))}function _r(){return s.draw(Ae,Rt?"":"redraw")}var rt=[h.previousPromises,Ut,jr,at,$t];Wt&&rt.push(Jt),rt.push(l.layoutStyles),Wt&&rt.push(_r,function(Tt){Tt._fullLayout._insideTickLabelsAutorange&&ae(Tt,Tt._fullLayout._insideTickLabelsAutorange).then(function(){Tt._fullLayout._insideTickLabelsAutorange=void 0})}),rt.push(l.drawData,l.finalDraw,p,h.addLinks,h.rehover,h.redrag,h.reselect,h.doAutoMargin,Je,h.previousPromises);function Je(lt){lt._fullLayout._insideTickLabelsAutorange&&Rt&&s.saveRangeInitial(lt,!0)}var st=M.syncOrAsync(rt,Ae);return(!st||!st.then)&&(st=Promise.resolve()),st.then(function(){return L(Ae),Ae})}function L(Ae){var Ne=Ae._fullLayout;Ne._redrawFromAutoMarginCount?Ne._redrawFromAutoMarginCount--:Ae.emit("plotly_afterplot")}function T(Ae){return M.extendFlat(d,Ae)}function k(Ae,Ne){try{Ae._fullLayout._paper.style("background",Ne)}catch(Ze){M.error(Ze)}}function P(Ae,Ne){var Ze=x.combine(Ne,"white");k(Ae,Ze)}function z(Ae,Ne){if(!Ae._context){Ae._context=M.extendDeep({},d);var Ze=A.select("base");Ae._context._baseUrl=Ze.size()&&Ze.attr("href")?window.location.href.split("#")[0]:""}var Qe=Ae._context,bt,dt,wt;if(Ne){for(dt=Object.keys(Ne),bt=0;bt<dt.length;bt++)wt=dt[bt],!(wt==="editable"||wt==="edits")&&wt in Qe&&(wt==="setBackground"&&Ne[wt]==="opaque"?Qe[wt]=P:Qe[wt]=Ne[wt]);Ne.plot3dPixelRatio&&!Qe.plotGlPixelRatio&&(Qe.plotGlPixelRatio=Qe.plot3dPixelRatio);var Ut=Ne.editable;if(Ut!==void 0)for(Qe.editable=Ut,dt=Object.keys(Qe.edits),bt=0;bt<dt.length;bt++)Qe.edits[dt[bt]]=Ut;if(Ne.edits)for(dt=Object.keys(Ne.edits),bt=0;bt<dt.length;bt++)wt=dt[bt],wt in Qe.edits&&(Qe.edits[wt]=Ne.edits[wt]);Qe._exportedPlot=Ne._exportedPlot}Qe.staticPlot&&(Qe.editable=!1,Qe.edits={},Qe.autosizable=!1,Qe.scrollZoom=!1,Qe.doubleClick=!1,Qe.showTips=!1,Qe.showLink=!1,Qe.displayModeBar=!1),Qe.displayModeBar==="hover"&&!S&&(Qe.displayModeBar=!0),(Qe.setBackground==="transparent"||typeof Qe.setBackground!="function")&&(Qe.setBackground=k),Qe._hasZeroHeight=Qe._hasZeroHeight||Ae.clientHeight===0,Qe._hasZeroWidth=Qe._hasZeroWidth||Ae.clientWidth===0;var Rt=Qe.scrollZoom,Nt=Qe._scrollZoom={};if(Rt===!0)Nt.cartesian=1,Nt.gl3d=1,Nt.geo=1,Nt.mapbox=1;else if(typeof Rt=="string"){var Wt=Rt.split("+");for(bt=0;bt<Wt.length;bt++)Nt[Wt[bt]]=1}else Rt!==!1&&(Nt.gl3d=1,Nt.geo=1,Nt.mapbox=1)}function I(Ae){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae);return m.cleanData(Ae.data),m.cleanLayout(Ae.layout),Ae.calcdata=void 0,te._doPlot(Ae).then(function(){return Ae.emit("plotly_redraw"),Ae})}function D(Ae,Ne,Ze,Qe){return Ae=M.getGraphDiv(Ae),h.cleanPlot([],{},Ae._fullData||[],Ae._fullLayout||{}),h.purge(Ae),te._doPlot(Ae,Ne,Ze,Qe)}function R(Ae,Ne){var Ze=Ne+1,Qe=[],bt,dt;for(bt=0;bt<Ae.length;bt++)dt=Ae[bt],dt<0?Qe.push(Ze+dt):Qe.push(dt);return Qe}function O(Ae,Ne,Ze){var Qe,bt;for(Qe=0;Qe<Ne.length;Qe++){if(bt=Ne[Qe],bt!==parseInt(bt,10))throw new Error("all values in "+Ze+" must be integers");if(bt>=Ae.data.length||bt<-Ae.data.length)throw new Error(Ze+" must be valid indices for gd.data.");if(Ne.indexOf(bt,Qe+1)>-1||bt>=0&&Ne.indexOf(-Ae.data.length+bt)>-1||bt<0&&Ne.indexOf(Ae.data.length+bt)>-1)throw new Error("each index in "+Ze+" must be unique.")}}function F(Ae,Ne,Ze){if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array.");if(typeof Ne>"u")throw new Error("currentIndices is a required argument.");if(Array.isArray(Ne)||(Ne=[Ne]),O(Ae,Ne,"currentIndices"),typeof Ze<"u"&&!Array.isArray(Ze)&&(Ze=[Ze]),typeof Ze<"u"&&O(Ae,Ze,"newIndices"),typeof Ze<"u"&&Ne.length!==Ze.length)throw new Error("current and new indices must be of equal length.")}function N(Ae,Ne,Ze){var Qe,bt;if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array.");if(typeof Ne>"u")throw new Error("traces must be defined.");for(Array.isArray(Ne)||(Ne=[Ne]),Qe=0;Qe<Ne.length;Qe++)if(bt=Ne[Qe],typeof bt!="object"||Array.isArray(bt)||bt===null)throw new Error("all values in traces array must be non-array objects");if(typeof Ze<"u"&&!Array.isArray(Ze)&&(Ze=[Ze]),typeof Ze<"u"&&Ze.length!==Ne.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function G(Ae,Ne,Ze,Qe){var bt=M.isPlainObject(Qe);if(!Array.isArray(Ae.data))throw new Error("gd.data must be an array");if(!M.isPlainObject(Ne))throw new Error("update must be a key:value object");if(typeof Ze>"u")throw new Error("indices must be an integer or array of integers");O(Ae,Ze,"indices");for(var dt in Ne){if(!Array.isArray(Ne[dt])||Ne[dt].length!==Ze.length)throw new Error("attribute "+dt+" must be an array of length equal to indices array length");if(bt&&(!(dt in Qe)||!Array.isArray(Qe[dt])||Qe[dt].length!==Ne[dt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function K(Ae,Ne,Ze,Qe){var bt=M.isPlainObject(Qe),dt=[],wt,Ut,Rt,Nt,Wt;Array.isArray(Ze)||(Ze=[Ze]),Ze=R(Ze,Ae.data.length-1);for(var Vt in Ne)for(var ir=0;ir<Ze.length;ir++){if(wt=Ae.data[Ze[ir]],Rt=e(wt,Vt),Ut=Rt.get(),Nt=Ne[Vt][ir],!M.isArrayOrTypedArray(Nt))throw new Error("attribute: "+Vt+" index: "+ir+" must be an array");if(!M.isArrayOrTypedArray(Ut))throw new Error("cannot extend missing or non-array attribute: "+Vt);if(Ut.constructor!==Nt.constructor)throw new Error("cannot extend array with an array of a different type: "+Vt);Wt=bt?Qe[Vt][ir]:Qe,g(Wt)||(Wt=-1),dt.push({prop:Rt,target:Ut,insert:Nt,maxp:Math.floor(Wt)})}return dt}function W(Ae,Ne,Ze,Qe,bt){G(Ae,Ne,Ze,Qe);for(var dt=K(Ae,Ne,Ze,Qe),wt={},Ut={},Rt=0;Rt<dt.length;Rt++){var Nt=dt[Rt].prop,Wt=dt[Rt].maxp,Vt=bt(dt[Rt].target,dt[Rt].insert,Wt);Nt.set(Vt[0]),Array.isArray(wt[Nt.astr])||(wt[Nt.astr]=[]),wt[Nt.astr].push(Vt[1]),Array.isArray(Ut[Nt.astr])||(Ut[Nt.astr]=[]),Ut[Nt.astr].push(dt[Rt].target.length)}return{update:wt,maxPoints:Ut}}function Y(Ae,Ne){var Ze=new Ae.constructor(Ae.length+Ne.length);return Ze.set(Ae),Ze.set(Ne,Ae.length),Ze}function re(Ae,Ne,Ze,Qe){Ae=M.getGraphDiv(Ae);function bt(Rt,Nt,Wt){var Vt,ir;if(M.isTypedArray(Rt))if(Wt<0){var Hr=new Rt.constructor(0),sn=Y(Rt,Nt);Wt<0?(Vt=sn,ir=Hr):(Vt=Hr,ir=sn)}else if(Vt=new Rt.constructor(Wt),ir=new Rt.constructor(Rt.length+Nt.length-Wt),Wt===Nt.length)Vt.set(Nt),ir.set(Rt);else if(Wt<Nt.length){var jr=Nt.length-Wt;Vt.set(Nt.subarray(jr)),ir.set(Rt),ir.set(Nt.subarray(0,jr),Rt.length)}else{var at=Wt-Nt.length,$t=Rt.length-at;Vt.set(Rt.subarray($t)),Vt.set(Nt,at),ir.set(Rt.subarray(0,$t))}else Vt=Rt.concat(Nt),ir=Wt>=0&&Wt<Vt.length?Vt.splice(0,Vt.length-Wt):[];return[Vt,ir]}var dt=W(Ae,Ne,Ze,Qe,bt),wt=te.redraw(Ae),Ut=[Ae,dt.update,Ze,dt.maxPoints];return n.add(Ae,te.prependTraces,Ut,re,arguments),wt}function ue(Ae,Ne,Ze,Qe){Ae=M.getGraphDiv(Ae);function bt(Rt,Nt,Wt){var Vt,ir;if(M.isTypedArray(Rt))if(Wt<=0){var Hr=new Rt.constructor(0),sn=Y(Nt,Rt);Wt<0?(Vt=sn,ir=Hr):(Vt=Hr,ir=sn)}else if(Vt=new Rt.constructor(Wt),ir=new Rt.constructor(Rt.length+Nt.length-Wt),Wt===Nt.length)Vt.set(Nt),ir.set(Rt);else if(Wt<Nt.length){var jr=Nt.length-Wt;Vt.set(Nt.subarray(0,jr)),ir.set(Nt.subarray(jr)),ir.set(Rt,jr)}else{var at=Wt-Nt.length;Vt.set(Nt),Vt.set(Rt.subarray(0,at),Nt.length),ir.set(Rt.subarray(at))}else Vt=Nt.concat(Rt),ir=Wt>=0&&Wt<Vt.length?Vt.splice(Wt,Vt.length):[];return[Vt,ir]}var dt=W(Ae,Ne,Ze,Qe,bt),wt=te.redraw(Ae),Ut=[Ae,dt.update,Ze,dt.maxPoints];return n.add(Ae,te.extendTraces,Ut,ue,arguments),wt}function j(Ae,Ne,Ze){Ae=M.getGraphDiv(Ae);var Qe=[],bt=te.deleteTraces,dt=j,wt=[Ae,Qe],Ut=[Ae,Ne],Rt,Nt;for(N(Ae,Ne,Ze),Array.isArray(Ne)||(Ne=[Ne]),Ne=Ne.map(function(Wt){return M.extendFlat({},Wt)}),m.cleanData(Ne),Rt=0;Rt<Ne.length;Rt++)Ae.data.push(Ne[Rt]);for(Rt=0;Rt<Ne.length;Rt++)Qe.push(-Ne.length+Rt);if(typeof Ze>"u")return Nt=te.redraw(Ae),n.add(Ae,bt,wt,dt,Ut),Nt;Array.isArray(Ze)||(Ze=[Ze]);try{F(Ae,Qe,Ze)}catch(Wt){throw Ae.data.splice(Ae.data.length-Ne.length,Ne.length),Wt}return n.startSequence(Ae),n.add(Ae,bt,wt,dt,Ut),Nt=te.moveTraces(Ae,Qe,Ze),n.stopSequence(Ae),Nt}function q(Ae,Ne){Ae=M.getGraphDiv(Ae);var Ze=[],Qe=te.addTraces,bt=q,dt=[Ae,Ze,Ne],wt=[Ae,Ne],Ut,Rt;if(typeof Ne>"u")throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Ne)||(Ne=[Ne]),O(Ae,Ne,"indices"),Ne=R(Ne,Ae.data.length-1),Ne.sort(M.sorterDes),Ut=0;Ut<Ne.length;Ut+=1)Rt=Ae.data.splice(Ne[Ut],1)[0],Ze.push(Rt);var Nt=te.redraw(Ae);return n.add(Ae,Qe,dt,bt,wt),Nt}function H(Ae,Ne,Ze){Ae=M.getGraphDiv(Ae);var Qe=[],bt=[],dt=H,wt=H,Ut=[Ae,Ze,Ne],Rt=[Ae,Ne,Ze],Nt;if(F(Ae,Ne,Ze),Ne=Array.isArray(Ne)?Ne:[Ne],typeof Ze>"u")for(Ze=[],Nt=0;Nt<Ne.length;Nt++)Ze.push(-Ne.length+Nt);for(Ze=Array.isArray(Ze)?Ze:[Ze],Ne=R(Ne,Ae.data.length-1),Ze=R(Ze,Ae.data.length-1),Nt=0;Nt<Ae.data.length;Nt++)Ne.indexOf(Nt)===-1&&Qe.push(Ae.data[Nt]);for(Nt=0;Nt<Ne.length;Nt++)bt.push({newIndex:Ze[Nt],trace:Ae.data[Ne[Nt]]});for(bt.sort(function(Vt,ir){return Vt.newIndex-ir.newIndex}),Nt=0;Nt<bt.length;Nt+=1)Qe.splice(bt[Nt].newIndex,0,bt[Nt].trace);Ae.data=Qe;var Wt=te.redraw(Ae);return n.add(Ae,dt,Ut,wt,Rt),Wt}function U(Ae,Ne,Ze,Qe){Ae=M.getGraphDiv(Ae),m.clearPromiseQueue(Ae);var bt={};if(typeof Ne=="string")bt[Ne]=Ze;else if(M.isPlainObject(Ne))bt=M.extendFlat({},Ne),Qe===void 0&&(Qe=Ze);else return M.warn("Restyle fail.",Ne,Ze,Qe),Promise.reject();Object.keys(bt).length&&(Ae.changed=!0);var dt=m.coerceTraceIndices(Ae,Qe),wt=ie(Ae,bt,dt),Ut=wt.flags;Ut.calc&&(Ae.calcdata=void 0),Ut.clearAxisTypes&&m.clearAxisTypes(Ae,dt,{});var Rt=[];Ut.fullReplot?Rt.push(te._doPlot):(Rt.push(h.previousPromises),h.supplyDefaults(Ae),Ut.markerSize&&(h.doCalcdata(Ae),be(Rt)),Ut.style&&Rt.push(l.doTraceStyle),Ut.colorbars&&Rt.push(l.doColorBars),Rt.push(L)),Rt.push(h.rehover,h.redrag,h.reselect),n.add(Ae,U,[Ae,wt.undoit,wt.traces],U,[Ae,wt.redoit,wt.traces]);var Nt=M.syncOrAsync(Rt,Ae);return(!Nt||!Nt.then)&&(Nt=Promise.resolve()),Nt.then(function(){return Ae.emit("plotly_restyle",wt.eventData),Ae})}function $(Ae){return Ae===void 0?null:Ae}function ne(Ae,Ne){return Ne?function(Ze,Qe,bt){var dt=e(Ze,Qe),wt=dt.set;return dt.set=function(Ut){var Rt=(bt||"")+Qe;X(Rt,dt.get(),Ut,Ae),wt(Ut)},dt}:e}function X(Ae,Ne,Ze,Qe){if(Array.isArray(Ne)||Array.isArray(Ze))for(var bt=Array.isArray(Ne)?Ne:[],dt=Array.isArray(Ze)?Ze:[],wt=Math.max(bt.length,dt.length),Ut=0;Ut<wt;Ut++)X(Ae+"["+Ut+"]",bt[Ut],dt[Ut],Qe);else if(M.isPlainObject(Ne)||M.isPlainObject(Ze)){var Rt=M.isPlainObject(Ne)?Ne:{},Nt=M.isPlainObject(Ze)?Ze:{},Wt=M.extendFlat({},Rt,Nt);for(var Vt in Wt)X(Ae+"."+Vt,Rt[Vt],Nt[Vt],Qe)}else Qe[Ae]===void 0&&(Qe[Ae]=$(Ne))}function Q(Ae,Ne,Ze){for(var Qe in Ze){var bt=e(Ae,Qe);X(Qe,bt.get(),Ze[Qe],Ne)}}function ie(Ae,Ne,Ze){var Qe=Ae._fullLayout,bt=Ae._fullData,dt=Ae.data,wt=Qe._guiEditing,Ut=ne(Qe._preGUI,wt),Rt=M.extendDeepAll({},Ne),Nt;se(Ne);var Wt=w.traceFlags(),Vt={},ir={},Hr;function sn(){return Ze.map(function(){})}function jr(Zt){var or=s.id2name(Zt);Hr.indexOf(or)===-1&&Hr.push(or)}function at(Zt){return"LAYOUT"+Zt+".autorange"}function $t(Zt){return"LAYOUT"+Zt+".range"}function Jt(Zt){for(var or=Zt;or<bt.length;or++)if(bt[or]._input===dt[Zt])return bt[or]}function Gt(Zt,or,Ir){if(Array.isArray(Zt)){Zt.forEach(function(Gr){Gt(Gr,or,Ir)});return}if(!(Zt in Ne||m.hasParent(Ne,Zt))){var Or;if(Zt.substr(0,6)==="LAYOUT")Or=Ut(Ae.layout,Zt.replace("LAYOUT",""));else{var Er=Ze[Ir],wr=Qe._tracePreGUI[Jt(Er)._fullInput.uid];Or=ne(wr,wt)(dt[Er],Zt)}Zt in ir||(ir[Zt]=sn()),ir[Zt][Ir]===void 0&&(ir[Zt][Ir]=$(Or.get())),or!==void 0&&Or.set(or)}}function _r(Zt){return function(or){return bt[or][Zt]}}function rt(Zt){return function(or,Ir){return or===!1?bt[Ze[Ir]][Zt]:null}}for(var Je in Ne){if(m.hasParent(Ne,Je))throw new Error("cannot set "+Je+" and a parent attribute simultaneously");var st=Ne[Je],lt,Tt,zt,Ce,Se,nt;if((Je==="autobinx"||Je==="autobiny")&&(Je=Je.charAt(Je.length-1)+"bins",Array.isArray(st)?st=st.map(rt(Je)):st===!1?st=Ze.map(_r(Je)):st=null),Vt[Je]=st,Je.substr(0,6)==="LAYOUT"){zt=Ut(Ae.layout,Je.replace("LAYOUT","")),ir[Je]=[$(zt.get())],zt.set(Array.isArray(st)?st[0]:st),Wt.calc=!0;continue}for(ir[Je]=sn(),Nt=0;Nt<Ze.length;Nt++){lt=dt[Ze[Nt]],Tt=Jt(Ze[Nt]);var it=Qe._tracePreGUI[Tt._fullInput.uid];if(zt=ne(it,wt)(lt,Je),Ce=zt.get(),Se=Array.isArray(st)?st[Nt%st.length]:st,Se!==void 0){var ct=zt.parts[zt.parts.length-1],kt=Je.substr(0,Je.length-ct.length-1),gt=kt?kt+".":"",St=kt?e(Tt,kt).get():Tt;if(nt=t.getTraceValObject(Tt,zt.parts),nt&&nt.impliedEdits&&Se!==null)for(var Yt in nt.impliedEdits)Gt(M.relativeAttr(Je,Yt),nt.impliedEdits[Yt],Nt);else if((ct==="thicknessmode"||ct==="lenmode")&&Ce!==Se&&(Se==="fraction"||Se==="pixels")&&St){var ar=Qe._size,kr=St.orient,br=kr==="top"||kr==="bottom";if(ct==="thicknessmode"){var Mr=br?ar.h:ar.w;Gt(gt+"thickness",St.thickness*(Se==="fraction"?1/Mr:Mr),Nt)}else{var Yr=br?ar.w:ar.h;Gt(gt+"len",St.len*(Se==="fraction"?1/Yr:Yr),Nt)}}else if(Je==="type"&&(Se==="pie"!=(Ce==="pie")||Se==="funnelarea"!=(Ce==="funnelarea"))){var nr="x",gr="y";(Se==="bar"||Ce==="bar")&&lt.orientation==="h"&&(nr="y",gr="x"),M.swapAttrs(lt,["?","?src"],"labels",nr),M.swapAttrs(lt,["d?","?0"],"label",nr),M.swapAttrs(lt,["?","?src"],"values",gr),Ce==="pie"||Ce==="funnelarea"?(e(lt,"marker.color").set(e(lt,"marker.colors").get()),Qe._pielayer.selectAll("g.trace").remove()):r.traceIs(lt,"cartesian")&&e(lt,"marker.colors").set(e(lt,"marker.color").get())}ir[Je][Nt]=$(Ce);var Rr=["swapxy","swapxyaxes","orientation","orientationaxes"];if(Rr.indexOf(Je)!==-1){if(Je==="orientation"){zt.set(Se);var Br=lt.x&&!lt.y?"h":"v";if((zt.get()||Br)===Tt.orientation)continue}else Je==="orientationaxes"&&(lt.orientation={v:"h",h:"v"}[Tt.orientation]);m.swapXYData(lt),Wt.calc=Wt.clearAxisTypes=!0}else h.dataArrayContainers.indexOf(zt.parts[0])!==-1?(m.manageArrayContainers(zt,Se,ir),Wt.calc=!0):(nt?nt.arrayOk&&!r.traceIs(Tt,"regl")&&(M.isArrayOrTypedArray(Se)||M.isArrayOrTypedArray(Ce))?Wt.calc=!0:w.update(Wt,nt):Wt.calc=!0,zt.set(Se))}}if(["swapxyaxes","orientationaxes"].indexOf(Je)!==-1&&s.swap(Ae,Ze),Je==="orientationaxes"){var Sr=e(Ae.layout,"hovermode"),et=Sr.get();et==="x"?Sr.set("y"):et==="y"?Sr.set("x"):et==="x unified"?Sr.set("y unified"):et==="y unified"&&Sr.set("x unified")}if(["orientation","type"].indexOf(Je)!==-1){for(Hr=[],Nt=0;Nt<Ze.length;Nt++){var Lt=dt[Ze[Nt]];r.traceIs(Lt,"cartesian")&&(jr(Lt.xaxis||"x"),jr(Lt.yaxis||"y"))}Gt(Hr.map(at),!0,0),Gt(Hr.map($t),[0,1],0)}}return(Wt.calc||Wt.plot)&&(Wt.fullReplot=!0),{flags:Wt,undoit:ir,redoit:Vt,traces:Ze,eventData:M.extendDeepNoArrays([],[Rt,Ze])}}function se(Ae){var Ne=M.counterRegex("axis",".title",!1,!1),Ze=/colorbar\.title$/,Qe=Object.keys(Ae),bt,dt,wt;for(bt=0;bt<Qe.length;bt++)dt=Qe[bt],wt=Ae[dt],(dt==="title"||Ne.test(dt)||Ze.test(dt))&&(typeof wt=="string"||typeof wt=="number")?Ut(dt,dt.replace("title","title.text")):dt.indexOf("titlefont")>-1&&dt.indexOf("grouptitlefont")===-1?Ut(dt,dt.replace("titlefont","title.font")):dt.indexOf("titleposition")>-1?Ut(dt,dt.replace("titleposition","title.position")):dt.indexOf("titleside")>-1?Ut(dt,dt.replace("titleside","title.side")):dt.indexOf("titleoffset")>-1&&Ut(dt,dt.replace("titleoffset","title.offset"));function Ut(Rt,Nt){Ae[Nt]=Ae[Rt],delete Ae[Rt]}}function ae(Ae,Ne,Ze){Ae=M.getGraphDiv(Ae),m.clearPromiseQueue(Ae);var Qe={};if(typeof Ne=="string")Qe[Ne]=Ze;else if(M.isPlainObject(Ne))Qe=M.extendFlat({},Ne);else return M.warn("Relayout fail.",Ne,Ze),Promise.reject();Object.keys(Qe).length&&(Ae.changed=!0);var bt=ge(Ae,Qe),dt=bt.flags;dt.calc&&(Ae.calcdata=void 0);var wt=[h.previousPromises];dt.layoutReplot?wt.push(l.layoutReplot):Object.keys(Qe).length&&(oe(Ae,dt,bt)||h.supplyDefaults(Ae),dt.legend&&wt.push(l.doLegend),dt.layoutstyle&&wt.push(l.layoutStyles),dt.axrange&&be(wt,bt.rangesAltered),dt.ticks&&wt.push(l.doTicksRelayout),dt.modebar&&wt.push(l.doModeBar),dt.camera&&wt.push(l.doCamera),dt.colorbars&&wt.push(l.doColorBars),wt.push(L)),wt.push(h.rehover,h.redrag,h.reselect),n.add(Ae,ae,[Ae,bt.undoit],ae,[Ae,bt.redoit]);var Ut=M.syncOrAsync(wt,Ae);return(!Ut||!Ut.then)&&(Ut=Promise.resolve(Ae)),Ut.then(function(){return Ae.emit("plotly_relayout",bt.eventData),Ae})}function oe(Ae,Ne,Ze){var Qe=Ae._fullLayout;if(!Ne.axrange)return!1;for(var bt in Ne)if(bt!=="axrange"&&Ne[bt])return!1;for(var dt in Ze.rangesAltered){var wt=s.id2name(dt),Ut=Ae.layout[wt],Rt=Qe[wt];if(Rt.autorange=Ut.autorange,Ut.range&&(Rt.range=Ut.range.slice()),Rt.cleanRange(),Rt._matchGroup){for(var Nt in Rt._matchGroup)if(Nt!==dt){var Wt=Qe[s.id2name(Nt)];Wt.autorange=Rt.autorange,Wt.range=Rt.range.slice(),Wt._input.range=Rt.range.slice()}}}return!0}function be(Ae,Ne){var Ze=Ne?function(Qe){var bt=[],dt=!0;for(var wt in Ne){var Ut=s.getFromId(Qe,wt);if(bt.push(wt),(Ut.ticklabelposition||"").indexOf("inside")!==-1&&Ut._anchorAxis&&bt.push(Ut._anchorAxis._id),Ut._matchGroup)for(var Rt in Ut._matchGroup)Ne[Rt]||bt.push(Rt)}return s.draw(Qe,bt,{skipTitle:dt})}:function(Qe){return s.draw(Qe,"redraw")};Ae.push(f,l.doAutoRangeAndConstraints,Ze,l.drawData,l.finalDraw)}var ce=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,de=/^[xyz]axis[0-9]*\.autorange$/,ye=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function ge(Ae,Ne){var Ze=Ae.layout,Qe=Ae._fullLayout,bt=Qe._guiEditing,dt=ne(Qe._preGUI,bt),wt=Object.keys(Ne),Ut=s.list(Ae),Rt=M.extendDeepAll({},Ne),Nt={},Wt,Vt,ir;for(se(Ne),wt=Object.keys(Ne),Vt=0;Vt<wt.length;Vt++)if(wt[Vt].indexOf("allaxes")===0){for(ir=0;ir<Ut.length;ir++){var Hr=Ut[ir]._id.substr(1),sn=Hr.indexOf("scene")!==-1?Hr+".":"",jr=wt[Vt].replace("allaxes",sn+Ut[ir]._name);Ne[jr]||(Ne[jr]=Ne[wt[Vt]])}delete Ne[wt[Vt]]}var at=w.layoutFlags(),$t={},Jt={};function Gt(Er,wr){if(Array.isArray(Er)){Er.forEach(function(wn){Gt(wn,wr)});return}if(!(Er in Ne||m.hasParent(Ne,Er))){var Gr=dt(Ze,Er);Er in Jt||(Jt[Er]=$(Gr.get())),wr!==void 0&&Gr.set(wr)}}var _r={},rt;function Je(Er){var wr=s.name2id(Er.split(".")[0]);return _r[wr]=1,wr}for(var st in Ne){if(m.hasParent(Ne,st))throw new Error("cannot set "+st+" and a parent attribute simultaneously");for(var lt=dt(Ze,st),Tt=Ne[st],zt=lt.parts.length,Ce=zt-1;Ce>0&&typeof lt.parts[Ce]!="string";)Ce--;var Se=lt.parts[Ce],nt=lt.parts[Ce-1]+"."+Se,it=lt.parts.slice(0,Ce).join("."),ct=e(Ae.layout,it).get(),kt=e(Qe,it).get(),gt=lt.get();if(Tt!==void 0){$t[st]=Tt,Jt[st]=Se==="reverse"?Tt:$(gt);var St=t.getLayoutValObject(Qe,lt.parts);if(St&&St.impliedEdits&&Tt!==null)for(var Yt in St.impliedEdits)Gt(M.relativeAttr(st,Yt),St.impliedEdits[Yt]);if(["width","height"].indexOf(st)!==-1)if(Tt){Gt("autosize",null);var ar=st==="height"?"width":"height";Gt(ar,Qe[ar])}else Qe[st]=Ae._initialAutoSize[st];else if(st==="autosize")Gt("width",Tt?null:Qe.width),Gt("height",Tt?null:Qe.height);else if(nt.match(ce))Je(nt),e(Qe,it+"._inputRange").set(null);else if(nt.match(de)){Je(nt),e(Qe,it+"._inputRange").set(null);var kr=e(Qe,it).get();kr._inputDomain&&(kr._input.domain=kr._inputDomain.slice())}else nt.match(ye)&&e(Qe,it+"._inputDomain").set(null);if(Se==="type"){rt=ct;var br=kt.type==="linear"&&Tt==="log",Mr=kt.type==="log"&&Tt==="linear";if(br||Mr){if(!rt||!rt.range)Gt(it+".autorange",!0);else if(kt.autorange)br&&(rt.range=rt.range[1]>rt.range[0]?[1,2]:[2,1]);else{var Yr=rt.range[0],nr=rt.range[1];br?(Yr<=0&&nr<=0&&Gt(it+".autorange",!0),Yr<=0?Yr=nr/1e6:nr<=0&&(nr=Yr/1e6),Gt(it+".range[0]",Math.log(Yr)/Math.LN10),Gt(it+".range[1]",Math.log(nr)/Math.LN10)):(Gt(it+".range[0]",Math.pow(10,Yr)),Gt(it+".range[1]",Math.pow(10,nr)))}Array.isArray(Qe._subplots.polar)&&Qe._subplots.polar.length&&Qe[lt.parts[0]]&&lt.parts[1]==="radialaxis"&&delete Qe[lt.parts[0]]._subplot.viewInitial["radialaxis.range"],r.getComponentMethod("annotations","convertCoords")(Ae,kt,Tt,Gt),r.getComponentMethod("images","convertCoords")(Ae,kt,Tt,Gt)}else Gt(it+".autorange",!0),Gt(it+".range",null);e(Qe,it+"._inputRange").set(null)}else if(Se.match(_)){var gr=e(Qe,st).get(),Rr=(Tt||{}).type;(!Rr||Rr==="-")&&(Rr="linear"),r.getComponentMethod("annotations","convertCoords")(Ae,gr,Rr,Gt),r.getComponentMethod("images","convertCoords")(Ae,gr,Rr,Gt)}var Br=o.containerArrayMatch(st);if(Br){Wt=Br.array,Vt=Br.index;var Sr=Br.property,et=St||{editType:"calc"};Vt!==""&&Sr===""&&(o.isAddVal(Tt)?Jt[st]=null:o.isRemoveVal(Tt)?Jt[st]=(e(Ze,Wt).get()||[])[Vt]:M.warn("unrecognized full object value",Ne)),w.update(at,et),Nt[Wt]||(Nt[Wt]={});var Lt=Nt[Wt][Vt];Lt||(Lt=Nt[Wt][Vt]={}),Lt[Sr]=Tt,delete Ne[st]}else Se==="reverse"?(ct.range?ct.range.reverse():(Gt(it+".autorange",!0),ct.range=[1,0]),kt.autorange?at.calc=!0:at.plot=!0):(st==="dragmode"&&(Tt===!1&&gt!==!1||Tt!==!1&&gt===!1)||Qe._has("scatter-like")&&Qe._has("regl")&&st==="dragmode"&&(Tt==="lasso"||Tt==="select")&&!(gt==="lasso"||gt==="select")||Qe._has("gl2d")?at.plot=!0:St?w.update(at,St):at.calc=!0,lt.set(Tt))}}for(Wt in Nt){var Zt=o.applyContainerArrayChanges(Ae,dt(Ze,Wt),Nt[Wt],at,dt);Zt||(at.plot=!0)}for(var or in _r){rt=s.getFromId(Ae,or);var Ir=rt&&rt._constraintGroup;if(Ir){at.calc=!0;for(var Or in Ir)_r[Or]||(s.getFromId(Ae,Or)._constraintShrinkable=!0)}}return(me(Ae)||Ne.height||Ne.width)&&(at.plot=!0),(at.plot||at.calc)&&(at.layoutReplot=!0),{flags:at,rangesAltered:_r,undoit:Jt,redoit:$t,eventData:Rt}}function me(Ae){var Ne=Ae._fullLayout,Ze=Ne.width,Qe=Ne.height;return Ae.layout.autosize&&h.plotAutoSize(Ae,Ae.layout,Ne),Ne.width!==Ze||Ne.height!==Qe}function Ee(Ae,Ne,Ze,Qe){Ae=M.getGraphDiv(Ae),m.clearPromiseQueue(Ae),M.isPlainObject(Ne)||(Ne={}),M.isPlainObject(Ze)||(Ze={}),Object.keys(Ne).length&&(Ae.changed=!0),Object.keys(Ze).length&&(Ae.changed=!0);var bt=m.coerceTraceIndices(Ae,Qe),dt=ie(Ae,M.extendFlat({},Ne),bt),wt=dt.flags,Ut=ge(Ae,M.extendFlat({},Ze)),Rt=Ut.flags;(wt.calc||Rt.calc)&&(Ae.calcdata=void 0),wt.clearAxisTypes&&m.clearAxisTypes(Ae,bt,Ze);var Nt=[];Rt.layoutReplot?Nt.push(l.layoutReplot):wt.fullReplot?Nt.push(te._doPlot):(Nt.push(h.previousPromises),oe(Ae,Rt,Ut)||h.supplyDefaults(Ae),wt.style&&Nt.push(l.doTraceStyle),(wt.colorbars||Rt.colorbars)&&Nt.push(l.doColorBars),Rt.legend&&Nt.push(l.doLegend),Rt.layoutstyle&&Nt.push(l.layoutStyles),Rt.axrange&&be(Nt,Ut.rangesAltered),Rt.ticks&&Nt.push(l.doTicksRelayout),Rt.modebar&&Nt.push(l.doModeBar),Rt.camera&&Nt.push(l.doCamera),Nt.push(L)),Nt.push(h.rehover,h.redrag,h.reselect),n.add(Ae,Ee,[Ae,dt.undoit,Ut.undoit,dt.traces],Ee,[Ae,dt.redoit,Ut.redoit,dt.traces]);var Wt=M.syncOrAsync(Nt,Ae);return(!Wt||!Wt.then)&&(Wt=Promise.resolve(Ae)),Wt.then(function(){return Ae.emit("plotly_update",{data:dt.eventData,layout:Ut.eventData}),Ae})}function Pe(Ae){return function(Ze){Ze._fullLayout._guiEditing=!0;var Qe=Ae.apply(null,arguments);return Ze._fullLayout._guiEditing=!1,Qe}}var Ue=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],we=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function ke(Ae,Ne){for(var Ze=0;Ze<Ne.length;Ze++){var Qe=Ne[Ze],bt=Ae.match(Qe.pattern);if(bt){var dt=bt[1]||"";return{head:dt,tail:Ae.substr(dt.length+1),attr:Qe.attr}}}}function Xe(Ae,Ne){var Ze=e(Ne,Ae).get();if(Ze!==void 0)return Ze;var Qe=Ae.split(".");for(Qe.pop();Qe.length>1;)if(Qe.pop(),Ze=e(Ne,Qe.join(".")+".uirevision").get(),Ze!==void 0)return Ze;return Ne.uirevision}function Ve(Ae,Ne){for(var Ze=0;Ze<Ne.length;Ze++)if(Ne[Ze]._fullInput.uid===Ae)return Ze;return-1}function Ie(Ae,Ne,Ze){for(var Qe=0;Qe<Ne.length;Qe++)if(Ne[Qe].uid===Ae)return Qe;return!Ne[Ze]||Ne[Ze].uid?-1:Ze}function De(Ae,Ne){var Ze=M.isPlainObject(Ae),Qe=Array.isArray(Ae);return Ze||Qe?(Ze&&M.isPlainObject(Ne)||Qe&&Array.isArray(Ne))&&JSON.stringify(Ae)===JSON.stringify(Ne):Ae===Ne}function Ye(Ae,Ne,Ze,Qe){var bt=Qe._preGUI,dt,wt,Ut,Rt,Nt,Wt,Vt,ir,Hr,sn,jr=[],at={},$t={};for(dt in bt){if(Nt=ke(dt,Ue),Nt){if(Hr=Nt.head,sn=Nt.tail,wt=Nt.attr||Hr+".uirevision",Ut=e(Qe,wt).get(),Rt=Ut&&Xe(wt,Ne),Rt&&Rt===Ut){if(Wt=bt[dt],Wt===null&&(Wt=void 0),Vt=e(Ne,dt),ir=Vt.get(),De(ir,Wt)){ir===void 0&&sn==="autorange"&&jr.push(Hr),Vt.set($(e(Qe,dt).get()));continue}else if(sn==="autorange"||sn.substr(0,6)==="range["){var Jt=bt[Hr+".range[0]"],Gt=bt[Hr+".range[1]"],_r=bt[Hr+".autorange"];if(_r||_r===null&&Jt===null&&Gt===null){if(!(Hr in at)){var rt=e(Ne,Hr).get();at[Hr]=rt&&(rt.autorange||rt.autorange!==!1&&(!rt.range||rt.range.length!==2))}if(at[Hr]){Vt.set($(e(Qe,dt).get()));continue}}}}}else M.warn("unrecognized GUI edit: "+dt);delete bt[dt],Nt&&Nt.tail.substr(0,6)==="range["&&($t[Nt.head]=1)}for(var Je=0;Je<jr.length;Je++){var st=jr[Je];if($t[st]){var lt=e(Ne,st).get();lt&&delete lt.autorange}}var Tt=Qe._tracePreGUI;for(var zt in Tt){var Ce=Tt[zt],Se=null,nt;for(dt in Ce){if(!Se){var it=Ve(zt,Ze);if(it<0){delete Tt[zt];break}var ct=Ze[it];nt=ct._fullInput;var kt=Ie(zt,Ae,nt.index);if(kt<0){delete Tt[zt];break}Se=Ae[kt]}if(Nt=ke(dt,we),Nt){if(Nt.attr?(Ut=e(Qe,Nt.attr).get(),Rt=Ut&&Xe(Nt.attr,Ne)):(Ut=nt.uirevision,Rt=Se.uirevision,Rt===void 0&&(Rt=Ne.uirevision)),Rt&&Rt===Ut&&(Wt=Ce[dt],Wt===null&&(Wt=void 0),Vt=e(Se,dt),ir=Vt.get(),De(ir,Wt))){Vt.set($(e(nt,dt).get()));continue}}else M.warn("unrecognized GUI edit: "+dt+" in trace uid "+zt);delete Ce[dt]}}}function vt(Ae,Ne,Ze,Qe){var bt,dt;function wt(){return te.addFrames(Ae,bt)}Ae=M.getGraphDiv(Ae),m.clearPromiseQueue(Ae);var Ut=Ae._fullData,Rt=Ae._fullLayout;if(!M.isPlotDiv(Ae)||!Ut||!Rt)dt=te.newPlot(Ae,Ne,Ze,Qe);else{if(M.isPlainObject(Ne)){var Nt=Ne;Ne=Nt.data,Ze=Nt.layout,Qe=Nt.config,bt=Nt.frames}var Wt=!1;if(Qe){var Vt=M.extendDeep({},Ae._context);Ae._context=void 0,z(Ae,Qe),Wt=Mt(Vt,Ae._context)}Ae.data=Ne||[],m.cleanData(Ae.data),Ae.layout=Ze||{},m.cleanLayout(Ae.layout),Ye(Ae.data,Ae.layout,Ut,Rt),h.supplyDefaults(Ae,{skipUpdateCalc:!0});var ir=Ae._fullData,Hr=Ae._fullLayout,sn=Hr.datarevision===void 0,jr=Hr.transition,at=Kt(Ae,Rt,Hr,sn,jr),$t=at.newDataRevision,Jt=Dt(Ae,Ut,ir,sn,jr,$t);if(me(Ae)&&(at.layoutReplot=!0),Jt.calc||at.calc){Ae.calcdata=void 0;for(var Gt=Object.getOwnPropertyNames(Hr),_r=0;_r<Gt.length;_r++){var rt=Gt[_r],Je=rt.substring(0,5);if(Je==="xaxis"||Je==="yaxis"){var st=Hr[rt]._emptyCategories;st&&st()}}}else h.supplyDefaultsUpdateCalc(Ae.calcdata,ir);var lt=[];if(bt&&(Ae._transitionData={},h.createTransitionData(Ae),lt.push(wt)),Hr.transition&&!Wt&&(Jt.anim||at.anim))at.ticks&&lt.push(l.doTicksRelayout),h.doCalcdata(Ae),l.doAutoRangeAndConstraints(Ae),lt.push(function(){return h.transitionFromReact(Ae,Jt,at,Rt)});else if(Jt.fullReplot||at.layoutReplot||Wt)Ae._fullLayout._skipDefaults=!0,lt.push(te._doPlot);else{for(var Tt in at.arrays){var zt=at.arrays[Tt];if(zt.length){var Ce=r.getComponentMethod(Tt,"drawOne");if(Ce!==M.noop)for(var Se=0;Se<zt.length;Se++)Ce(Ae,zt[Se]);else{var nt=r.getComponentMethod(Tt,"draw");if(nt===M.noop)throw new Error("cannot draw components: "+Tt);nt(Ae)}}}lt.push(h.previousPromises),Jt.style&&lt.push(l.doTraceStyle),(Jt.colorbars||at.colorbars)&&lt.push(l.doColorBars),at.legend&&lt.push(l.doLegend),at.layoutstyle&&lt.push(l.layoutStyles),at.axrange&&be(lt),at.ticks&&lt.push(l.doTicksRelayout),at.modebar&&lt.push(l.doModeBar),at.camera&&lt.push(l.doCamera),lt.push(L)}lt.push(h.rehover,h.redrag,h.reselect),dt=M.syncOrAsync(lt,Ae),(!dt||!dt.then)&&(dt=Promise.resolve(Ae))}return dt.then(function(){return Ae.emit("plotly_react",{data:Ne,layout:Ze}),Ae})}function Dt(Ae,Ne,Ze,Qe,bt,dt){var wt=Ne.length===Ze.length;if(!bt&&!wt)return{fullReplot:!0,calc:!0};var Ut=w.traceFlags();Ut.arrays={},Ut.nChanges=0,Ut.nChangesAnim=0;var Rt,Nt;function Wt(Hr){var sn=t.getTraceValObject(Nt,Hr);return!Nt._module.animatable&&sn.anim&&(sn.anim=!1),sn}var Vt={getValObject:Wt,flags:Ut,immutable:Qe,transition:bt,newDataRevision:dt,gd:Ae},ir={};for(Rt=0;Rt<Ne.length;Rt++)if(Ze[Rt]){if(Nt=Ze[Rt]._fullInput,h.hasMakesDataTransform(Nt)&&(Nt=Ze[Rt]),ir[Nt.uid])continue;ir[Nt.uid]=1,Ft(Ne[Rt]._fullInput,Nt,[],Vt)}return(Ut.calc||Ut.plot)&&(Ut.fullReplot=!0),bt&&Ut.nChanges&&Ut.nChangesAnim&&(Ut.anim=Ut.nChanges===Ut.nChangesAnim&&wt?"all":"some"),Ut}function Kt(Ae,Ne,Ze,Qe,bt){var dt=w.layoutFlags();dt.arrays={},dt.rangesAltered={},dt.nChanges=0,dt.nChangesAnim=0;function wt(Rt){return t.getLayoutValObject(Ze,Rt)}var Ut={getValObject:wt,flags:dt,immutable:Qe,transition:bt,gd:Ae};return Ft(Ne,Ze,[],Ut),(dt.plot||dt.calc)&&(dt.layoutReplot=!0),bt&&dt.nChanges&&dt.nChangesAnim&&(dt.anim=dt.nChanges===dt.nChangesAnim?"all":"some"),dt}function Ft(Ae,Ne,Ze,Qe){var bt,dt,wt,Ut=Qe.getValObject,Rt=Qe.flags,Nt=Qe.immutable,Wt=Qe.inArray,Vt=Qe.arrayIndex;function ir(){var it=bt.editType;if(Wt&&it.indexOf("arraydraw")!==-1){M.pushUnique(Rt.arrays[Wt],Vt);return}w.update(Rt,bt),it!=="none"&&Rt.nChanges++,Qe.transition&&bt.anim&&Rt.nChangesAnim++,(ce.test(wt)||de.test(wt))&&(Rt.rangesAltered[Ze[0]]=1),ye.test(wt)&&e(Ne,"_inputDomain").set(null),dt==="datarevision"&&(Rt.newDataRevision=1)}function Hr(it){return it.valType==="data_array"||it.arrayOk}for(dt in Ae){if(Rt.calc&&!Qe.transition)return;var sn=Ae[dt],jr=Ne[dt],at=Ze.concat(dt);if(wt=at.join("."),!(dt.charAt(0)==="_"||typeof sn=="function"||sn===jr)){if((dt==="tick0"||dt==="dtick")&&Ze[0]!=="geo"){var $t=Ne.tickmode;if($t==="auto"||$t==="array"||!$t)continue}if(!(dt==="range"&&Ne.autorange)&&!((dt==="zmin"||dt==="zmax")&&Ne.type==="contourcarpet")&&(bt=Ut(at),!!bt&&!(bt._compareAsJSON&&JSON.stringify(sn)===JSON.stringify(jr)))){var Jt=bt.valType,Gt,_r=Hr(bt),rt=Array.isArray(sn),Je=Array.isArray(jr);if(rt&&Je){var st="_input_"+dt,lt=Ae[st],Tt=Ne[st];if(Array.isArray(lt)&&lt===Tt)continue}if(jr===void 0)_r&&rt?Rt.calc=!0:ir();else if(bt._isLinkedToArray){var zt=[],Ce=!1;Wt||(Rt.arrays[dt]=zt);var Se=Math.min(sn.length,jr.length),nt=Math.max(sn.length,jr.length);if(Se!==nt)if(bt.editType==="arraydraw")Ce=!0;else{ir();continue}for(Gt=0;Gt<Se;Gt++)Ft(sn[Gt],jr[Gt],at.concat(Gt),M.extendFlat({inArray:dt,arrayIndex:Gt},Qe));if(Ce)for(Gt=Se;Gt<nt;Gt++)zt.push(Gt)}else!Jt&&M.isPlainObject(sn)?Ft(sn,jr,at,Qe):_r?rt&&Je?(Nt&&(Rt.calc=!0),(Nt||Qe.newDataRevision)&&ir()):rt!==Je?Rt.calc=!0:ir():rt&&Je?(sn.length!==jr.length||String(sn)!==String(jr))&&ir():ir()}}}for(dt in Ne)if(!(dt in Ae||dt.charAt(0)==="_"||typeof Ne[dt]=="function"))if(bt=Ut(Ze.concat(dt)),Hr(bt)&&Array.isArray(Ne[dt])){Rt.calc=!0;return}else ir()}function Mt(Ae,Ne){var Ze;for(Ze in Ae)if(Ze.charAt(0)!=="_"){var Qe=Ae[Ze],bt=Ne[Ze];if(Qe!==bt)if(M.isPlainObject(Qe)&&M.isPlainObject(bt)){if(Mt(Qe,bt))return!0}else if(Array.isArray(Qe)&&Array.isArray(bt)){if(Qe.length!==bt.length)return!0;for(var dt=0;dt<Qe.length;dt++)if(Qe[dt]!==bt[dt])if(M.isPlainObject(Qe[dt])&&M.isPlainObject(bt[dt])){if(Mt(Qe[dt],bt[dt]))return!0}else return!0}else return!0}}function Xt(Ae,Ne,Ze){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Qe=Ae._transitionData;Qe._frameQueue||(Qe._frameQueue=[]),Ze=h.supplyAnimationDefaults(Ze);var bt=Ze.transition,dt=Ze.frame;Qe._frameWaitingCnt===void 0&&(Qe._frameWaitingCnt=0);function wt(Nt){return Array.isArray(bt)?Nt>=bt.length?bt[0]:bt[Nt]:bt}function Ut(Nt){return Array.isArray(dt)?Nt>=dt.length?dt[0]:dt[Nt]:dt}function Rt(Nt,Wt){var Vt=0;return function(){if(Nt&&++Vt===Wt)return Nt()}}return new Promise(function(Nt,Wt){function Vt(){if(Qe._frameQueue.length!==0){for(;Qe._frameQueue.length;){var Se=Qe._frameQueue.pop();Se.onInterrupt&&Se.onInterrupt()}Ae.emit("plotly_animationinterrupted",[])}}function ir(Se){if(Se.length!==0){for(var nt=0;nt<Se.length;nt++){var it;Se[nt].type==="byname"?it=h.computeFrame(Ae,Se[nt].name):it=Se[nt].data;var ct=Ut(nt),kt=wt(nt);kt.duration=Math.min(kt.duration,ct.duration);var gt={frame:it,name:Se[nt].name,frameOpts:ct,transitionOpts:kt};nt===Se.length-1&&(gt.onComplete=Rt(Nt,2),gt.onInterrupt=Wt),Qe._frameQueue.push(gt)}Ze.mode==="immediate"&&(Qe._lastFrameAt=-1/0),Qe._animationRaf||jr()}}function Hr(){Ae.emit("plotly_animated"),window.cancelAnimationFrame(Qe._animationRaf),Qe._animationRaf=null}function sn(){Qe._currentFrame&&Qe._currentFrame.onComplete&&Qe._currentFrame.onComplete();var Se=Qe._currentFrame=Qe._frameQueue.shift();if(Se){var nt=Se.name?Se.name.toString():null;Ae._fullLayout._currentFrame=nt,Qe._lastFrameAt=Date.now(),Qe._timeToNext=Se.frameOpts.duration,h.transition(Ae,Se.frame.data,Se.frame.layout,m.coerceTraceIndices(Ae,Se.frame.traces),Se.frameOpts,Se.transitionOpts).then(function(){Se.onComplete&&Se.onComplete()}),Ae.emit("plotly_animatingframe",{name:nt,frame:Se.frame,animation:{frame:Se.frameOpts,transition:Se.transitionOpts}})}else Hr()}function jr(){Ae.emit("plotly_animating"),Qe._lastFrameAt=-1/0,Qe._timeToNext=0,Qe._runningTransitions=0,Qe._currentFrame=null;var Se=function(){Qe._animationRaf=window.requestAnimationFrame(Se),Date.now()-Qe._lastFrameAt>Qe._timeToNext&&sn()};Se()}var at=0;function $t(Se){return Array.isArray(bt)?at>=bt.length?Se.transitionOpts=bt[at]:Se.transitionOpts=bt[0]:Se.transitionOpts=bt,at++,Se}var Jt,Gt,_r=[],rt=Ne==null,Je=Array.isArray(Ne),st=!rt&&!Je&&M.isPlainObject(Ne);if(st)_r.push({type:"object",data:$t(M.extendFlat({},Ne))});else if(rt||["string","number"].indexOf(typeof Ne)!==-1)for(Jt=0;Jt<Qe._frames.length;Jt++)Gt=Qe._frames[Jt],Gt&&(rt||String(Gt.group)===String(Ne))&&_r.push({type:"byname",name:String(Gt.name),data:$t({name:Gt.name})});else if(Je)for(Jt=0;Jt<Ne.length;Jt++){var lt=Ne[Jt];["number","string"].indexOf(typeof lt)!==-1?(lt=String(lt),_r.push({type:"byname",name:lt,data:$t({name:lt})})):M.isPlainObject(lt)&&_r.push({type:"object",data:$t(M.extendFlat({},lt))})}for(Jt=0;Jt<_r.length;Jt++)if(Gt=_r[Jt],Gt.type==="byname"&&!Qe._frameHash[Gt.data.name]){M.warn('animate failure: frame not found: "'+Gt.data.name+'"'),Wt();return}["next","immediate"].indexOf(Ze.mode)!==-1&&Vt(),Ze.direction==="reverse"&&_r.reverse();var Tt=Ae._fullLayout._currentFrame;if(Tt&&Ze.fromcurrent){var zt=-1;for(Jt=0;Jt<_r.length;Jt++)if(Gt=_r[Jt],Gt.type==="byname"&&Gt.name===Tt){zt=Jt;break}if(zt>0&&zt<_r.length-1){var Ce=[];for(Jt=0;Jt<_r.length;Jt++)Gt=_r[Jt],(_r[Jt].type!=="byname"||Jt>zt)&&Ce.push(Gt);_r=Ce}}_r.length>0?ir(_r):(Ae.emit("plotly_animated"),Nt())})}function It(Ae,Ne,Ze){if(Ae=M.getGraphDiv(Ae),Ne==null)return Promise.resolve();if(!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Qe,bt,dt,wt,Ut=Ae._transitionData._frames,Rt=Ae._transitionData._frameHash;if(!Array.isArray(Ne))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+Ne);var Nt=Ut.length+Ne.length*2,Wt=[],Vt={};for(Qe=Ne.length-1;Qe>=0;Qe--)if(M.isPlainObject(Ne[Qe])){var ir=Ne[Qe].name,Hr=(Rt[ir]||Vt[ir]||{}).name,sn=Ne[Qe].name,jr=Rt[Hr]||Vt[Hr];Hr&&sn&&typeof sn=="number"&&jr&&c<b&&(c++,M.warn('addFrames: overwriting frame "'+(Rt[Hr]||Vt[Hr]).name+'" with a frame whose name of type "number" also equates to "'+Hr+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),c===b&&M.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Vt[ir]={name:ir},Wt.push({frame:h.supplyFrameDefaults(Ne[Qe]),index:Ze&&Ze[Qe]!==void 0&&Ze[Qe]!==null?Ze[Qe]:Nt+Qe})}Wt.sort(function(st,lt){return st.index>lt.index?-1:st.index<lt.index?1:0});var at=[],$t=[],Jt=Ut.length;for(Qe=Wt.length-1;Qe>=0;Qe--){if(bt=Wt[Qe].frame,typeof bt.name=="number"&&M.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!bt.name)for(;Rt[bt.name="frame "+Ae._transitionData._counter++];);if(Rt[bt.name]){for(dt=0;dt<Ut.length&&(Ut[dt]||{}).name!==bt.name;dt++);at.push({type:"replace",index:dt,value:bt}),$t.unshift({type:"replace",index:dt,value:Ut[dt]})}else wt=Math.max(0,Math.min(Wt[Qe].index,Jt)),at.push({type:"insert",index:wt,value:bt}),$t.unshift({type:"delete",index:wt}),Jt++}var Gt=h.modifyFrames,_r=h.modifyFrames,rt=[Ae,$t],Je=[Ae,at];return n&&n.add(Ae,Gt,rt,_r,Je),h.modifyFrames(Ae,at)}function At(Ae,Ne){if(Ae=M.getGraphDiv(Ae),!M.isPlotDiv(Ae))throw new Error("This element is not a Plotly plot: "+Ae);var Ze,Qe,bt=Ae._transitionData._frames,dt=[],wt=[];if(!Ne)for(Ne=[],Ze=0;Ze<bt.length;Ze++)Ne.push(Ze);for(Ne=Ne.slice(),Ne.sort(),Ze=Ne.length-1;Ze>=0;Ze--)Qe=Ne[Ze],dt.push({type:"delete",index:Qe}),wt.unshift({type:"insert",index:Qe,value:bt[Qe]});var Ut=h.modifyFrames,Rt=h.modifyFrames,Nt=[Ae,wt],Wt=[Ae,dt];return n&&n.add(Ae,Ut,Nt,Rt,Wt),h.modifyFrames(Ae,dt)}function Ge(Ae){Ae=M.getGraphDiv(Ae);var Ne=Ae._fullLayout||{},Ze=Ae._fullData||[];return h.cleanPlot([],{},Ze,Ne),h.purge(Ae),a.purge(Ae),Ne._container&&Ne._container.remove(),delete Ae._context,Ae}function tt(Ae){var Ne=Ae._fullLayout,Ze=Ae.getBoundingClientRect();if(!M.equalDomRects(Ze,Ne._lastBBox)){var Qe=Ne._invTransform=M.inverseTransformMatrix(M.getFullTransformMatrix(Ae));Ne._invScaleX=Math.sqrt(Qe[0][0]*Qe[0][0]+Qe[0][1]*Qe[0][1]+Qe[0][2]*Qe[0][2]),Ne._invScaleY=Math.sqrt(Qe[1][0]*Qe[1][0]+Qe[1][1]*Qe[1][1]+Qe[1][2]*Qe[1][2]),Ne._lastBBox=Ze}}function He(Ae){var Ne=A.select(Ae),Ze=Ae._fullLayout;if(Ze._calcInverseTransform=tt,Ze._calcInverseTransform(Ae),Ze._container=Ne.selectAll(".plot-container").data([0]),Ze._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Ze._paperdiv=Ze._container.selectAll(".svg-container").data([0]),Ze._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Ze._glcontainer=Ze._paperdiv.selectAll(".gl-container").data([{}]),Ze._glcontainer.enter().append("div").classed("gl-container",!0),Ze._paperdiv.selectAll(".main-svg").remove(),Ze._paperdiv.select(".modebar-container").remove(),Ze._paper=Ze._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Ze._toppaper=Ze._paperdiv.append("svg").classed("main-svg",!0),Ze._modebardiv=Ze._paperdiv.append("div"),delete Ze._modeBar,Ze._hoverpaper=Ze._paperdiv.append("svg").classed("main-svg",!0),!Ze._uid){var Qe={};A.selectAll("defs").each(function(){this.id&&(Qe[this.id.split("-")[1]]=1)}),Ze._uid=M.randstr(Qe)}Ze._paperdiv.selectAll(".main-svg").attr(v.svgAttrs),Ze._defs=Ze._paper.append("defs").attr("id","defs-"+Ze._uid),Ze._clips=Ze._defs.append("g").classed("clips",!0),Ze._topdefs=Ze._toppaper.append("defs").attr("id","topdefs-"+Ze._uid),Ze._topclips=Ze._topdefs.append("g").classed("clips",!0),Ze._bgLayer=Ze._paper.append("g").classed("bglayer",!0),Ze._draggers=Ze._paper.append("g").classed("draglayer",!0);var bt=Ze._paper.append("g").classed("layer-below",!0);Ze._imageLowerLayer=bt.append("g").classed("imagelayer",!0),Ze._shapeLowerLayer=bt.append("g").classed("shapelayer",!0),Ze._cartesianlayer=Ze._paper.append("g").classed("cartesianlayer",!0),Ze._polarlayer=Ze._paper.append("g").classed("polarlayer",!0),Ze._smithlayer=Ze._paper.append("g").classed("smithlayer",!0),Ze._ternarylayer=Ze._paper.append("g").classed("ternarylayer",!0),Ze._geolayer=Ze._paper.append("g").classed("geolayer",!0),Ze._funnelarealayer=Ze._paper.append("g").classed("funnelarealayer",!0),Ze._pielayer=Ze._paper.append("g").classed("pielayer",!0),Ze._iciclelayer=Ze._paper.append("g").classed("iciclelayer",!0),Ze._treemaplayer=Ze._paper.append("g").classed("treemaplayer",!0),Ze._sunburstlayer=Ze._paper.append("g").classed("sunburstlayer",!0),Ze._indicatorlayer=Ze._toppaper.append("g").classed("indicatorlayer",!0),Ze._glimages=Ze._paper.append("g").classed("glimages",!0);var dt=Ze._toppaper.append("g").classed("layer-above",!0);Ze._imageUpperLayer=dt.append("g").classed("imagelayer",!0),Ze._shapeUpperLayer=dt.append("g").classed("shapelayer",!0),Ze._selectionLayer=Ze._toppaper.append("g").classed("selectionlayer",!0),Ze._infolayer=Ze._toppaper.append("g").classed("infolayer",!0),Ze._menulayer=Ze._toppaper.append("g").classed("menulayer",!0),Ze._zoomlayer=Ze._toppaper.append("g").classed("zoomlayer",!0),Ze._hoverlayer=Ze._hoverpaper.append("g").classed("hoverlayer",!0),Ze._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),Ae.emit("plotly_framework")}te.animate=Xt,te.addFrames=It,te.deleteFrames=At,te.addTraces=j,te.deleteTraces=q,te.extendTraces=re,te.moveTraces=H,te.prependTraces=ue,te.newPlot=D,te._doPlot=u,te.purge=Ge,te.react=vt,te.redraw=I,te.relayout=ae,te.restyle=U,te.setPlotConfig=T,te.update=Ee,te._guiRelayout=Pe(ae),te._guiRestyle=Pe(U),te._guiUpdate=Pe(Ee),te._storeDirectGUIEdit=Q},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(y,ee,te){var A={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},g={};function S(M,e){for(var a in M){var n=M[a];n.valType?e[a]=n.dflt:(e[a]||(e[a]={}),S(n,e[a]))}}S(A,g),ee.exports={configAttributes:A,dfltConfig:g}},{}],554:[function(y,ee,te){var A=y("../registry"),g=y("../lib"),S=y("../plots/attributes"),M=y("../plots/layout_attributes"),e=y("../plots/frame_attributes"),a=y("../plots/animation_attributes"),n=y("./plot_config").configAttributes,r=y("./edit_types"),t=g.extendDeepAll,h=g.isPlainObject,s=g.isArrayOrTypedArray,i=g.nestedProperty,x=g.valObjectMeta,p="_isSubplotObj",v="_isLinkedToArray",f="_arrayAttrRegexps",d="_deprecated",o=[p,v,f,d];te.IS_SUBPLOT_OBJ=p,te.IS_LINKED_TO_ARRAY=v,te.DEPRECATED=d,te.UNDERSCORE_ATTRS=o,te.get=function(){var D={};A.allTypes.forEach(function(O){D[O]=_(O)});var R={};return Object.keys(A.transformsRegistry).forEach(function(O){R[O]=b(O)}),{defs:{valObjects:x,metaKeys:o.concat(["description","role","editType","impliedEdits"]),editType:{traces:r.traces,layout:r.layout},impliedEdits:{}},traces:D,layout:c(),transforms:R,frames:u(),animation:L(a),config:L(n)}},te.crawl=function(D,R,O,F){var N=O||0;F=F||"",Object.keys(D).forEach(function(G){var K=D[G];if(o.indexOf(G)===-1){var W=(F?F+".":"")+G;R(K,G,D,N,W),!te.isValObject(K)&&h(K)&&G!=="impliedEdits"&&te.crawl(K,R,N+1,W)}})},te.isValObject=function(D){return D&&D.valType!==void 0},te.findArrayAttributes=function(D){var R=[],O=[],F=[],N,G;function K(q,H,U,$){O=O.slice(0,$).concat([H]),F=F.slice(0,$).concat([q&&q._isLinkedToArray]);var ne=q&&(q.valType==="data_array"||q.arrayOk===!0)&&!(O[$-1]==="colorbar"&&(H==="ticktext"||H==="tickvals"));ne&&W(N,0,"")}function W(q,H,U){var $=q[O[H]],ne=U+O[H];if(H===O.length-1)s($)&&R.push(G+ne);else if(F[H]){if(Array.isArray($))for(var X=0;X<$.length;X++)h($[X])&&W($[X],H+1,ne+"["+X+"].")}else h($)&&W($,H+1,ne+".")}N=D,G="",te.crawl(S,K),D._module&&D._module.attributes&&te.crawl(D._module.attributes,K);var Y=D.transforms;if(Y)for(var re=0;re<Y.length;re++){var ue=Y[re],j=ue._module;j&&(G="transforms["+re+"].",N=ue,te.crawl(j.attributes,K))}return R},te.getTraceValObject=function(D,R){var O=R[0],F=1,N,G;if(O==="transforms"){if(R.length===1)return S.transforms;var K=D.transforms;if(!Array.isArray(K)||!K.length)return!1;var W=R[1];if(!w(W)||W>=K.length)return!1;N=(A.transformsRegistry[K[W].type]||{}).attributes,G=N&&N[R[2]],F=3}else{var Y=D._module;if(Y||(Y=(A.modules[D.type||S.type.dflt]||{})._module),!Y)return!1;if(N=Y.attributes,G=N&&N[O],!G){var re=Y.basePlotModule;re&&re.attributes&&(G=re.attributes[O])}G||(G=S[O])}return l(G,R,F)},te.getLayoutValObject=function(D,R){var O=m(D,R[0]);return l(O,R,1)};function m(D,R){var O,F,N,G,K=D._basePlotModules;if(K){var W;for(O=0;O<K.length;O++){if(N=K[O],N.attrRegex&&N.attrRegex.test(R)){if(N.layoutAttrOverrides)return N.layoutAttrOverrides;!W&&N.layoutAttributes&&(W=N.layoutAttributes)}var Y=N.baseLayoutAttrOverrides;if(Y&&R in Y)return Y[R]}if(W)return W}var re=D._modules;if(re){for(O=0;O<re.length;O++)if(G=re[O].layoutAttributes,G&&R in G)return G[R]}for(F in A.componentsRegistry){if(N=A.componentsRegistry[F],N.name==="colorscale"&&R.indexOf("coloraxis")===0)return N.layoutAttributes[R];if(!N.schema&&R===N.name)return N.layoutAttributes}return R in M?M[R]:!1}function l(D,R,O){if(!D)return!1;if(D._isLinkedToArray){if(w(R[O]))O++;else if(O<R.length)return!1}for(;O<R.length;O++){var F=D[R[O]];if(h(F))D=F;else break;if(O===R.length-1)break;if(D._isLinkedToArray){if(O++,!w(R[O]))return!1}else if(D.valType==="info_array"){O++;var N=R[O];if(!w(N))return!1;var G=D.items;if(Array.isArray(G)){if(N>=G.length)return!1;if(D.dimensions===2){if(O++,R.length===O)return D;var K=R[O];if(!w(K))return!1;D=G[N][K]}else D=G[N]}else D=G}}return D}function w(D){return D===Math.round(D)&&D>=0}function _(D){var R,O;R=A.modules[D]._module,O=R.basePlotModule;var F={};F.type=null;var N=t({},S),G=t({},R.attributes);te.crawl(G,function(Y,re,ue,j,q){i(N,q).set(void 0),Y===void 0&&i(G,q).set(void 0)}),t(F,N),A.traceIs(D,"noOpacity")&&delete F.opacity,A.traceIs(D,"showLegend")||(delete F.showlegend,delete F.legendgroup),A.traceIs(D,"noHover")&&(delete F.hoverinfo,delete F.hoverlabel),R.selectPoints||delete F.selectedpoints,t(F,G),O.attributes&&t(F,O.attributes),F.type=D;var K={meta:R.meta||{},categories:R.categories||{},animatable:!!R.animatable,type:D,attributes:L(F)};if(R.layoutAttributes){var W={};t(W,R.layoutAttributes),K.layoutAttributes=L(W)}return R.animatable||te.crawl(K,function(Y){te.isValObject(Y)&&"anim"in Y&&delete Y.anim}),K}function c(){var D={},R,O;t(D,M);for(R in A.subplotsRegistry)if(O=A.subplotsRegistry[R],!!O.layoutAttributes)if(Array.isArray(O.attr))for(var F=0;F<O.attr.length;F++)z(D,O,O.attr[F]);else{var N=O.attr==="subplot"?O.name:O.attr;z(D,O,N)}for(R in A.componentsRegistry){O=A.componentsRegistry[R];var G=O.schema;if(G&&(G.subplots||G.layout)){var K=G.subplots;if(K&&K.xaxis&&!K.yaxis)for(var W in K.xaxis)delete D.yaxis[W]}else O.name==="colorscale"?t(D,O.layoutAttributes):O.layoutAttributes&&I(D,O.layoutAttributes,O.name)}return{layoutAttributes:L(D)}}function b(D){var R=A.transformsRegistry[D],O=t({},R.attributes);return Object.keys(A.componentsRegistry).forEach(function(F){var N=A.componentsRegistry[F];N.schema&&N.schema.transforms&&N.schema.transforms[D]&&Object.keys(N.schema.transforms[D]).forEach(function(G){I(O,N.schema.transforms[D][G],G)})}),{attributes:L(O)}}function u(){var D={frames:t({},e)};return L(D),D.frames}function L(D){return T(D),k(D),P(D),D}function T(D){function R(F){return{valType:"string",editType:"none"}}function O(F,N,G){te.isValObject(F)?(F.arrayOk===!0||F.valType==="data_array")&&(G[N+"src"]=R()):h(F)&&(F.role="object")}te.crawl(D,O)}function k(D){function R(O,F,N){if(O){var G=O[v];G&&(delete O[v],N[F]={items:{}},N[F].items[G]=O,N[F].role="object")}}te.crawl(D,R)}function P(D){function R(O){for(var F in O)if(h(O[F]))R(O[F]);else if(Array.isArray(O[F]))for(var N=0;N<O[F].length;N++)R(O[F][N]);else O[F]instanceof RegExp&&(O[F]=O[F].toString())}R(D)}function z(D,R,O){var F=i(D,O),N=t({},R.layoutAttributes);N[p]=!0,F.set(N)}function I(D,R,O){var F=i(D,O);F.set(t(F.get()||{},R))}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(y,ee,te){var A=y("../lib"),g=y("../plots/attributes"),S="templateitemname",M={name:{valType:"string",editType:"none"}};M[S]={valType:"string",editType:"calc"},te.templatedArray=function(n,r){return r._isLinkedToArray=n,r.name=M.name,r[S]=M[S],r},te.traceTemplater=function(n){var r={},t,h;for(t in n)h=n[t],Array.isArray(h)&&h.length&&(r[t]=0);function s(i){t=A.coerce(i,{},g,"type");var x={type:t,_template:null};if(t in r){h=n[t];var p=r[t]%h.length;r[t]++,x._template=h[p]}return x}return{newTrace:s}},te.newContainer=function(n,r,t){var h=n._template,s=h&&(h[r]||t&&h[t]);A.isPlainObject(s)||(s=null);var i=n[r]={_template:s};return i},te.arrayTemplater=function(n,r,t){var h=n._template,s=h&&h[a(r)],i=h&&h[r];(!Array.isArray(i)||!i.length)&&(i=[]);var x={};function p(f){var d={name:f.name,_input:f},o=d[S]=f[S];if(!e(o))return d._template=s,d;for(var m=0;m<i.length;m++){var l=i[m];if(l.name===o)return x[o]=1,d._template=l,d}return d[t]=f[t]||!1,d._template=!1,d}function v(){for(var f=[],d=0;d<i.length;d++){var o=i[d],m=o.name;if(e(m)&&!x[m]){var l={_template:o,name:m,_input:{_templateitemname:m}};l[S]=o[S],f.push(l),x[m]=1}}return f}return{newItem:p,defaultItems:v}};function e(n){return n&&typeof n=="string"}function a(n){var r=n.length-1;return n.charAt(r)!=="s"&&A.warn("bad argument to arrayDefaultKey: "+n),n.substr(0,n.length-1)+"defaults"}te.arrayDefaultKey=a,te.arrayEditor=function(n,r,t){var h=(A.nestedProperty(n,r).get()||[]).length,s=t._index,i=s>=h&&(t._input||{})._templateitemname;i&&(s=h);var x=r+"["+s+"]",p;function v(){p={},i&&(p[x]={},p[x][S]=i)}v();function f(l,w){p[l]=w}function d(l,w){i?A.nestedProperty(p[x],l).set(w):p[x+"."+l]=w}function o(){var l=p;return v(),l}function m(l,w){l&&d(l,w);var _=o();for(var c in _)A.nestedProperty(n,c).set(_[c])}return{modifyBase:f,modifyItem:d,getUpdateObj:o,applyUpdate:m}}},{"../lib":515,"../plots/attributes":562}],556:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../registry"),S=y("../plots/plots"),M=y("../lib"),e=y("../lib/clear_gl_canvases"),a=y("../components/color"),n=y("../components/drawing"),r=y("../components/titles"),t=y("../components/modebar"),h=y("../plots/cartesian/axes"),s=y("../constants/alignment"),i=y("../plots/cartesian/constraints"),x=i.enforce,p=i.clean,v=y("../plots/cartesian/autorange").doAutoRange,f="start",d="middle",o="end";te.layoutStyles=function(k){return M.syncOrAsync([S.doAutoMargin,l],k)};function m(k,P,z){for(var I=0;I<z.length;I++){var D=z[I][0],R=z[I][1];if(!(D[0]>=k[1]||D[1]<=k[0])&&R[0]<P[1]&&R[1]>P[0])return!0}return!1}function l(k){var P=k._fullLayout,z=P._size,I=z.p,D=h.list(k,"",!0),R,O,F,N,G,K;if(P._paperdiv.style({width:k._context.responsive&&P.autosize&&!k._context._hasZeroWidth&&!k.layout.width?"100%":P.width+"px",height:k._context.responsive&&P.autosize&&!k._context._hasZeroHeight&&!k.layout.height?"100%":P.height+"px"}).selectAll(".main-svg").call(n.setSize,P.width,P.height),k._context.setBackground(k,P.paper_bgcolor),te.drawMainTitle(k),t.manage(k),!P._has("cartesian"))return S.previousPromises(k);function W(Mt,Xt,It){var At=Mt._lw/2;if(Mt._id.charAt(0)==="x"){if(Xt){if(It==="top")return Xt._offset-I-At}else return z.t+z.h*(1-(Mt.position||0))+At%1;return Xt._offset+Xt._length+I+At}if(Xt){if(It==="right")return Xt._offset+Xt._length+I+At}else return z.l+z.w*(Mt.position||0)+At%1;return Xt._offset-I-At}for(R=0;R<D.length;R++){N=D[R];var Y=N._anchorAxis;N._linepositions={},N._lw=n.crispRound(k,N.linewidth,1),N._mainLinePosition=W(N,Y,N.side),N._mainMirrorPosition=N.mirror&&Y?W(N,Y,s.OPPOSITE_SIDE[N.side]):null}var re=[],ue=[],j=[],q=a.opacity(P.paper_bgcolor)===1&&a.opacity(P.plot_bgcolor)===1&&P.paper_bgcolor===P.plot_bgcolor;for(O in P._plots)if(F=P._plots[O],F.mainplot)F.bg&&F.bg.remove(),F.bg=void 0;else{var H=F.xaxis.domain,U=F.yaxis.domain,$=F.plotgroup;if(m(H,U,j)){var ne=$.node(),X=F.bg=M.ensureSingle($,"rect","bg");ne.insertBefore(X.node(),ne.childNodes[0]),ue.push(O)}else $.select("rect.bg").remove(),j.push([H,U]),q||(re.push(O),ue.push(O))}var Q=P._bgLayer.selectAll(".bg").data(re);for(Q.enter().append("rect").classed("bg",!0),Q.exit().remove(),Q.each(function(Mt){P._plots[Mt].bg=A.select(this)}),R=0;R<ue.length;R++)F=P._plots[ue[R]],G=F.xaxis,K=F.yaxis,F.bg&&G._offset!==void 0&&K._offset!==void 0&&F.bg.call(n.setRect,G._offset-I,K._offset-I,G._length+2*I,K._length+2*I).call(a.fill,P.plot_bgcolor).style("stroke-width",0);if(!P._hasOnlyLargeSploms)for(O in P._plots){F=P._plots[O],G=F.xaxis,K=F.yaxis;var ie=F.clipId="clip"+P._uid+O+"plot",se=M.ensureSingleById(P._clips,"clipPath",ie,function(Mt){Mt.classed("plotclip",!0).append("rect")});F.clipRect=se.select("rect").attr({width:G._length,height:K._length}),n.setTranslate(F.plot,G._offset,K._offset);var ae,oe;F._hasClipOnAxisFalse?(ae=null,oe=ie):(ae=ie,oe=null),n.setClipUrl(F.plot,ae,k),F.layerClipId=oe}var be,ce,de,ye,ge,me,Ee,Pe,Ue,we,ke,Xe,Ve;function Ie(Mt){return"M"+be+","+Mt+"H"+ce}function De(Mt){return"M"+G._offset+","+Mt+"h"+G._length}function Ye(Mt){return"M"+Mt+","+Pe+"V"+Ee}function vt(Mt){return"M"+Mt+","+K._offset+"v"+K._length}function Dt(Mt,Xt,It){if(!Mt.showline||O!==Mt._mainSubplot)return"";if(!Mt._anchorAxis)return It(Mt._mainLinePosition);var At=Xt(Mt._mainLinePosition);return Mt.mirror&&(At+=Xt(Mt._mainMirrorPosition)),At}for(O in P._plots){F=P._plots[O],G=F.xaxis,K=F.yaxis;var Kt="M0,0";w(G,O)&&(ge=c(G,"left",K,D),be=G._offset-(ge?I+ge:0),me=c(G,"right",K,D),ce=G._offset+G._length+(me?I+me:0),de=W(G,K,"bottom"),ye=W(G,K,"top"),Ve=!G._anchorAxis||O!==G._mainSubplot,Ve&&(G.mirror==="allticks"||G.mirror==="all")&&(G._linepositions[O]=[de,ye]),Kt=Dt(G,Ie,De),Ve&&G.showline&&(G.mirror==="all"||G.mirror==="allticks")&&(Kt+=Ie(de)+Ie(ye)),F.xlines.style("stroke-width",G._lw+"px").call(a.stroke,G.showline?G.linecolor:"rgba(0,0,0,0)")),F.xlines.attr("d",Kt);var Ft="M0,0";w(K,O)&&(ke=c(K,"bottom",G,D),Ee=K._offset+K._length+(ke?I:0),Xe=c(K,"top",G,D),Pe=K._offset-(Xe?I:0),Ue=W(K,G,"left"),we=W(K,G,"right"),Ve=!K._anchorAxis||O!==K._mainSubplot,Ve&&(K.mirror==="allticks"||K.mirror==="all")&&(K._linepositions[O]=[Ue,we]),Ft=Dt(K,Ye,vt),Ve&&K.showline&&(K.mirror==="all"||K.mirror==="allticks")&&(Ft+=Ye(Ue)+Ye(we)),F.ylines.style("stroke-width",K._lw+"px").call(a.stroke,K.showline?K.linecolor:"rgba(0,0,0,0)")),F.ylines.attr("d",Ft)}return h.makeClipPaths(k),S.previousPromises(k)}function w(k,P){return(k.ticks||k.showline)&&(P===k._mainSubplot||k.mirror==="all"||k.mirror==="allticks")}function _(k,P,z){if(!z.showline||!z._lw)return!1;if(z.mirror==="all"||z.mirror==="allticks")return!0;var I=z._anchorAxis;if(!I)return!1;var D=s.FROM_BL[P];return z.side===P?I.domain[D]===k.domain[D]:z.mirror&&I.domain[1-D]===k.domain[1-D]}function c(k,P,z,I){if(_(k,P,z))return z._lw;for(var D=0;D<I.length;D++){var R=I[D];if(R._mainAxis===z._mainAxis&&_(k,P,R))return R._lw}return 0}te.drawMainTitle=function(k){var P=k._fullLayout,z=L(P),I=T(P);r.draw(k,"gtitle",{propContainer:P,propName:"title.text",placeholder:P._dfltTitle.plot,attributes:{x:b(P,z),y:u(P,I),"text-anchor":z,dy:I}})};function b(k,P){var z=k.title,I=k._size,D=0;switch(P===f?D=z.pad.l:P===o&&(D=-z.pad.r),z.xref){case"paper":return I.l+I.w*z.x+D;case"container":default:return k.width*z.x+D}}function u(k,P){var z=k.title,I=k._size,D=0;if(P==="0em"||!P?D=-z.pad.b:P===s.CAP_SHIFT+"em"&&(D=z.pad.t),z.y==="auto")return I.t/2;switch(z.yref){case"paper":return I.t+I.h-I.h*z.y+D;case"container":default:return k.height-k.height*z.y+D}}function L(k){var P=k.title,z=d;return M.isRightAnchor(P)?z=o:M.isLeftAnchor(P)&&(z=f),z}function T(k){var P=k.title,z="0em";return M.isTopAnchor(P)?z=s.CAP_SHIFT+"em":M.isMiddleAnchor(P)&&(z=s.MID_SHIFT+"em"),z}te.doTraceStyle=function(k){var P=k.calcdata,z=[],I;for(I=0;I<P.length;I++){var D=P[I],R=D[0]||{},O=R.trace||{},F=O._module||{},N=F.arraysToCalcdata;N&&N(D,O);var G=F.editStyle;G&&z.push({fn:G,cd0:R})}if(z.length){for(I=0;I<z.length;I++){var K=z[I];K.fn(k,K.cd0)}e(k),te.redrawReglTraces(k)}return S.style(k),g.getComponentMethod("legend","draw")(k),S.previousPromises(k)},te.doColorBars=function(k){return g.getComponentMethod("colorbar","draw")(k),S.previousPromises(k)},te.layoutReplot=function(k){var P=k.layout;return k.layout=void 0,g.call("_doPlot",k,"",P)},te.doLegend=function(k){return g.getComponentMethod("legend","draw")(k),S.previousPromises(k)},te.doTicksRelayout=function(k){return h.draw(k,"redraw"),k._fullLayout._hasOnlyLargeSploms&&(g.subplotsRegistry.splom.updateGrid(k),e(k),te.redrawReglTraces(k)),te.drawMainTitle(k),S.previousPromises(k)},te.doModeBar=function(k){var P=k._fullLayout;t.manage(k);for(var z=0;z<P._basePlotModules.length;z++){var I=P._basePlotModules[z].updateFx;I&&I(k)}return S.previousPromises(k)},te.doCamera=function(k){for(var P=k._fullLayout,z=P._subplots.gl3d,I=0;I<z.length;I++){var D=P[z[I]],R=D._scene;R.setViewport(D)}},te.drawData=function(k){var P=k._fullLayout;e(k);for(var z=P._basePlotModules,I=0;I<z.length;I++)z[I].plot(k);return te.redrawReglTraces(k),S.style(k),g.getComponentMethod("selections","draw")(k),g.getComponentMethod("shapes","draw")(k),g.getComponentMethod("annotations","draw")(k),g.getComponentMethod("images","draw")(k),P._replotting=!1,S.previousPromises(k)},te.redrawReglTraces=function(k){var P=k._fullLayout;if(P._has("regl")){var z=k._fullData,I=[],D=[],R,O;for(P._hasOnlyLargeSploms&&P._splomGrid.draw(),R=0;R<z.length;R++){var F=z[R];F.visible===!0&&F._length!==0&&(F.type==="splom"?P._splomScenes[F.uid].draw():F.type==="scattergl"?M.pushUnique(I,F.xaxis+F.yaxis):F.type==="scatterpolargl"&&M.pushUnique(D,F.subplot))}for(R=0;R<I.length;R++)O=P._plots[I[R]],O._scene&&O._scene.draw();for(R=0;R<D.length;R++)O=P[D[R]]._subplot,O._scene&&O._scene.draw()}},te.doAutoRangeAndConstraints=function(k){for(var P=h.list(k,"",!0),z,I={},D=0;D<P.length;D++)if(z=P[D],!I[z._id]){I[z._id]=1,p(k,z),v(k,z);var R=z._matchGroup;if(R)for(var O in R){var F=h.getFromId(k,O);v(k,F,z.range),I[O]=1}}x(k)},te.finalDraw=function(k){g.getComponentMethod("rangeslider","draw")(k),g.getComponentMethod("rangeselector","draw")(k)},te.drawMarginPushers=function(k){g.getComponentMethod("legend","draw")(k),g.getComponentMethod("rangeselector","draw")(k),g.getComponentMethod("sliders","draw")(k),g.getComponentMethod("updatemenus","draw")(k),g.getComponentMethod("colorbar","draw")(k)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(y,ee,te){var A=y("../lib"),g=A.isPlainObject,S=y("./plot_schema"),M=y("../plots/plots"),e=y("../plots/attributes"),a=y("./plot_template"),n=y("./plot_config").dfltConfig;te.makeTemplate=function(f){f=A.isPlainObject(f)?f:A.getGraphDiv(f),f=A.extendDeep({_context:n},{data:f.data,layout:f.layout}),M.supplyDefaults(f);var d=f.data||[],o=f.layout||{};o._basePlotModules=f._fullLayout._basePlotModules,o._modules=f._fullLayout._modules;var m={data:{},layout:{}};d.forEach(function(P){var z={};h(P,z,i.bind(null,P));var I=A.coerce(P,{},e,"type"),D=m.data[I];D||(D=m.data[I]=[]),D.push(z)}),h(o,m.layout,s.bind(null,o)),delete m.layout.template;var l=o.template;if(g(l)){var w=l.layout,_,c,b,u,L,T;g(w)&&r(w,m.layout);var k=l.data;if(g(k)){for(c in m.data)if(b=k[c],Array.isArray(b)){for(L=m.data[c],T=L.length,u=b.length,_=0;_<T;_++)r(b[_%u],L[_]);for(_=T;_<u;_++)L.push(A.extendDeep({},b[_]))}for(c in k)c in m.data||(m.data[c]=A.extendDeep([],k[c]))}}return m};function r(f,d){f=A.extendDeep({},f);var o=Object.keys(f).sort(),m,l;function w(L,T,k){if(g(T)&&g(L))r(L,T);else if(Array.isArray(T)&&Array.isArray(L)){var P=a.arrayTemplater({_template:f},k);for(l=0;l<T.length;l++){var z=T[l],I=P.newItem(z)._template;I&&r(I,z)}var D=P.defaultItems();for(l=0;l<D.length;l++)T.push(D[l]._template);for(l=0;l<T.length;l++)delete T[l].templateitemname}}for(m=0;m<o.length;m++){var _=o[m],c=f[_];if(_ in d?w(c,d[_],_):d[_]=c,t(_)===_)for(var b in d){var u=t(b);b!==u&&u===_&&!(b in f)&&w(c,d[b],_)}}}function t(f){return f.replace(/[0-9]+$/,"")}function h(f,d,o,m,l){var w=l&&o(l);for(var _ in f){var c=f[_],b=x(f,_,m),u=x(f,_,l),L=o(u);if(!L){var T=t(_);T!==_&&(u=x(f,T,l),L=o(u))}if(!(w&&w===L)&&!(!L||L._noTemplating||L.valType==="data_array"||L.arrayOk&&Array.isArray(c)))if(!L.valType&&g(c))h(c,d,o,b,u);else if(L._isLinkedToArray&&Array.isArray(c))for(var k=!1,P=0,z={},I=0;I<c.length;I++){var D=c[I];if(g(D)){var R=D.name;if(R)z[R]||(h(D,d,o,x(c,P,b),x(c,P,u)),P++,z[R]=1);else if(!k){var O=a.arrayDefaultKey(_),F=x(f,O,m),N=x(c,P,b);h(D,d,o,N,x(c,P,u));var G=A.nestedProperty(d,N),K=A.nestedProperty(d,F);K.set(G.get()),G.set(null),k=!0}}}else{var W=A.nestedProperty(d,b);W.set(c)}}}function s(f,d){return S.getLayoutValObject(f,A.nestedProperty({},d).parts)}function i(f,d){return S.getTraceValObject(f,A.nestedProperty({},d).parts)}function x(f,d,o){var m;return o?Array.isArray(f)?m=o+"["+d+"]":m=o+"."+d:m=d,m}te.validateTemplate=function(f,d){var o=A.extendDeep({},{_context:n,data:f.data,layout:f.layout}),m=o.layout||{};g(d)||(d=m.template||{});var l=d.layout,w=d.data,_=[];o.layout=m,o.layout.template=d,M.supplyDefaults(o);var c=o._fullLayout,b=o._fullData,u={};function L(F,N){for(var G in F)if(G.charAt(0)!=="_"&&g(F[G])){var K=t(G),W=[],Y;for(Y=0;Y<N.length;Y++)W.push(x(F,G,N[Y])),K!==G&&W.push(x(F,K,N[Y]));for(Y=0;Y<W.length;Y++)u[W[Y]]=1;L(F[G],W)}}function T(F,N){for(var G in F)if(G.indexOf("defaults")===-1&&g(F[G])){var K=x(F,G,N);u[K]?T(F[G],K):_.push({code:"unused",path:K})}}if(g(l)?(L(c,["layout"]),T(l,"layout")):_.push({code:"layout"}),!g(w))_.push({code:"data"});else{for(var k={},P,z=0;z<b.length;z++){var I=b[z];P=I.type,k[P]=(k[P]||0)+1,I._fullInput._template||_.push({code:"missing",index:I._fullInput.index,traceType:P})}for(P in w){var D=w[P].length,R=k[P]||0;D>R?_.push({code:"unused",traceType:P,templateCount:D,dataCount:R}):R>D&&_.push({code:"reused",traceType:P,templateCount:D,dataCount:R})}}function O(F,N){for(var G in F)if(G.charAt(0)!=="_"){var K=F[G],W=x(F,G,N);g(K)?(Array.isArray(F)&&K._template===!1&&K.templateitemname&&_.push({code:"missing",path:W,templateitemname:K.templateitemname}),O(K,W)):Array.isArray(K)&&p(K)&&O(K,W)}}if(O({data:b,layout:c},""),_.length)return _.map(v)};function p(f){for(var d=0;d<f.length;d++)if(g(f[d]))return!0}function v(f){var d;switch(f.code){case"data":d="The template has no key data.";break;case"layout":d="The template has no key layout.";break;case"missing":f.path?d="There are no templates for item "+f.path+" with name "+f.templateitemname:d="There are no templates for trace "+f.index+", of type "+f.traceType+".";break;case"unused":f.path?d="The template item at "+f.path+" was not used in constructing the plot.":f.dataCount?d="Some of the templates of type "+f.traceType+" were not used. The template has "+f.templateCount+" traces, the data only has "+f.dataCount+" of this type.":d="The template has "+f.templateCount+" traces of type "+f.traceType+" but there are none in the data.";break;case"reused":d="Some of the templates of type "+f.traceType+" were used more than once. The template has "+f.templateCount+" traces, the data has "+f.dataCount+" of this type.";break}return f.msg=d,f}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("./plot_api"),S=y("../plots/plots"),M=y("../lib"),e=y("../snapshot/helpers"),a=y("../snapshot/tosvg"),n=y("../snapshot/svgtoimg"),r=y("../version").version,t={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};function h(s,i){i=i||{};var x,p,v,f;M.isPlainObject(s)?(x=s.data||[],p=s.layout||{},v=s.config||{},f={}):(s=M.getGraphDiv(s),x=M.extendDeep([],s.data),p=M.extendDeep({},s.layout),v=s._context,f=s._fullLayout||{});function d(R){return!(R in i)||M.validate(i[R],t[R])}if(!d("width")&&i.width!==null||!d("height")&&i.height!==null)throw new Error("Height and width should be pixel values.");if(!d("format"))throw new Error("Export format is not "+M.join2(t.format.values,", "," or ")+".");var o={};function m(R,O){return M.coerce(i,o,t,R,O)}var l=m("format"),w=m("width"),_=m("height"),c=m("scale"),b=m("setBackground"),u=m("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var T=M.extendFlat({},p);w?T.width=w:i.width===null&&A(f.width)&&(T.width=f.width),_?T.height=_:i.height===null&&A(f.height)&&(T.height=f.height);var k=M.extendFlat({},v,{_exportedPlot:!0,staticPlot:!0,setBackground:b}),P=e.getRedrawFunc(L);function z(){return new Promise(function(R){setTimeout(R,e.getDelay(L._fullLayout))})}function I(){return new Promise(function(R,O){var F=a(L,l,c),N=L._fullLayout.width,G=L._fullLayout.height;function K(){g.purge(L),document.body.removeChild(L)}if(l==="full-json"){var W=S.graphJson(L,!1,"keepdata","object",!0,!0);return W.version=r,W=JSON.stringify(W),K(),R(u?W:e.encodeJSON(W))}if(K(),l==="svg")return R(u?F:e.encodeSVG(F));var Y=document.createElement("canvas");Y.id=M.randstr(),n({format:l,width:N,height:G,scale:c,canvas:Y,svg:F,promise:!0}).then(R).catch(O)})}function D(R){return u?R.replace(e.IMAGE_URL_PREFIX,""):R}return new Promise(function(R,O){g.newPlot(L,x,T,k).then(P).then(z).then(I).then(function(F){R(D(F))}).catch(function(F){O(F)})})}ee.exports=h},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(y,ee,te){var A=y("../lib"),g=y("../plots/plots"),S=y("./plot_schema"),M=y("./plot_config").dfltConfig,e=A.isPlainObject,a=Array.isArray,n=A.isArrayOrTypedArray;ee.exports=function(m,l){m===void 0&&(m=[]),l===void 0&&(l={});var w=S.get(),_=[],c={_context:A.extendFlat({},M)},b,u;a(m)?(c.data=A.extendDeep([],m),b=m):(c.data=[],b=[],_.push(i("array","data"))),e(l)?(c.layout=A.extendDeep({},l),u=l):(c.layout={},u={},arguments.length>1&&_.push(i("object","layout"))),g.supplyDefaults(c);for(var L=c._fullData,T=b.length,k=0;k<T;k++){var P=b[k],z=["data",k];if(!e(P)){_.push(i("object",z));continue}var I=L[k],D=I.type,R=w.traces[D].attributes;R.type={valType:"enumerated",values:[D]},I.visible===!1&&P.visible!==!1&&_.push(i("invisible",z)),r(P,I,R,_,z);var O=P.transforms,F=I.transforms;if(O){a(O)||_.push(i("array",z,["transforms"])),z.push("transforms");for(var N=0;N<O.length;N++){var G=["transforms",N],K=O[N].type;if(!e(O[N])){_.push(i("object",z,G));continue}var W=w.transforms[K]?w.transforms[K].attributes:{};W.type={valType:"enumerated",values:Object.keys(w.transforms)},r(O[N],F[N],W,_,z,G)}}}var Y=c._fullLayout,re=t(w,L);return r(u,Y,re,_,"layout"),_.length===0?void 0:_};function r(o,m,l,w,_,c){c=c||[];for(var b=Object.keys(o),u=0;u<b.length;u++){var L=b[u];if(L!=="transforms"){var T=c.slice();T.push(L);var k=o[L],P=m[L],z=p(l,L),I=(z||{}).valType,D=I==="info_array",R=I==="colorscale",O=(z||{}).items;if(!x(l,L))w.push(i("schema",_,T));else if(e(k)&&e(P)&&I!=="any")r(k,P,z,w,_,T);else if(D&&a(k)){k.length>P.length&&w.push(i("unused",_,T.concat(P.length)));var F=P.length,N=Array.isArray(O);N&&(F=Math.min(F,O.length));var G,K,W,Y,re;if(z.dimensions===2)for(K=0;K<F;K++)if(a(k[K])){k[K].length>P[K].length&&w.push(i("unused",_,T.concat(K,P[K].length)));var ue=P[K].length;for(G=0;G<(N?Math.min(ue,O[K].length):ue);G++)W=N?O[K][G]:O,Y=k[K][G],re=P[K][G],A.validate(Y,W)?re!==Y&&re!==+Y&&w.push(i("dynamic",_,T.concat(K,G),Y,re)):w.push(i("value",_,T.concat(K,G),Y))}else w.push(i("array",_,T.concat(K),k[K]));else for(K=0;K<F;K++)W=N?O[K]:O,Y=k[K],re=P[K],A.validate(Y,W)?re!==Y&&re!==+Y&&w.push(i("dynamic",_,T.concat(K),Y,re)):w.push(i("value",_,T.concat(K),Y))}else if(z.items&&!D&&a(k)){var j=O[Object.keys(O)[0]],q=[],H,U;for(H=0;H<P.length;H++){var $=P[H]._index||H;if(U=T.slice(),U.push($),e(k[$])&&e(P[H])){q.push($);var ne=k[$],X=P[H];e(ne)&&ne.visible!==!1&&X.visible===!1?w.push(i("invisible",_,U)):r(ne,X,j,w,_,U)}}for(H=0;H<k.length;H++)U=T.slice(),U.push(H),e(k[H])?q.indexOf(H)===-1&&w.push(i("unused",_,U)):w.push(i("object",_,U,k[H]))}else!e(k)&&e(P)?w.push(i("object",_,T,k)):!n(k)&&n(P)&&!D&&!R?w.push(i("array",_,T,k)):L in m?A.validate(k,z)?z.valType==="enumerated"&&(z.coerceNumber&&k!==+P||k!==P)&&w.push(i("dynamic",_,T,k,P)):w.push(i("value",_,T,k)):w.push(i("unused",_,T,k))}}return w}function t(o,m){for(var l=o.layout.layoutAttributes,w=0;w<m.length;w++){var _=m[w],c=o.traces[_.type],b=c.layoutAttributes;b&&(_.subplot?A.extendFlat(l[c.attributes.subplot.dflt],b):A.extendFlat(l,b))}return l}var h={object:function(o,m){var l;return o==="layout"&&m===""?l="The layout argument":o[0]==="data"&&m===""?l="Trace "+o[1]+" in the data argument":l=s(o)+"key "+m,l+" must be linked to an object container"},array:function(o,m){var l;return o==="data"?l="The data argument":l=s(o)+"key "+m,l+" must be linked to an array container"},schema:function(o,m){return s(o)+"key "+m+" is not part of the schema"},unused:function(o,m,l){var w=e(l)?"container":"key";return s(o)+w+" "+m+" did not get coerced"},dynamic:function(o,m,l,w){return[s(o)+"key",m,"(set to '"+l+"')","got reset to","'"+w+"'","during defaults."].join(" ")},invisible:function(o,m){return(m?s(o)+"item "+m:"Trace "+o[1])+" got defaulted to be not visible"},value:function(o,m,l){return[s(o)+"key "+m,"is set to an invalid value ("+l+")"].join(" ")}};function s(o){return a(o)?"In data trace "+o[1]+", ":"In "+o+", "}function i(o,m,l,w,_){l=l||"";var c,b;a(m)?(c=m[0],b=m[1]):(c=m,b=null);var u=d(l),L=h[o](m,u,w,_);return A.log(L),{code:o,container:c,trace:b,path:l,astr:u,msg:L}}function x(o,m){var l=f(m),w=l.keyMinusId,_=l.id;return w in o&&o[w]._isSubplotObj&&_?!0:m in o}function p(o,m){if(m in o)return o[m];var l=f(m);return o[l.keyMinusId]}var v=A.counterRegex("([a-z]+)");function f(o){var m=o.match(v);return{keyMinusId:m&&m[1],id:m&&m[2]}}function d(o){if(!a(o))return String(o);for(var m="",l=0;l<o.length;l++){var w=o[l];typeof w=="number"?m=m.substr(0,m.length-1)+"["+w+"]":m+=w,l<o.length-1&&(m+=".")}return m}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(y,ee,te){ee.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(y,ee,te){var A=y("../lib"),g=y("../plot_api/plot_template");ee.exports=function(M,e,a){var n=a.name,r=a.inclusionAttr||"visible",t=e[n],h=A.isArrayOrTypedArray(M[n])?M[n]:[],s=e[n]=[],i=g.arrayTemplater(e,n,r),x,p;for(x=0;x<h.length;x++){var v=h[x];A.isPlainObject(v)?p=i.newItem(v):(p=i.newItem({}),p[r]=!1),p._index=x,p[r]!==!1&&a.handleItemDefaults(v,p,e,a),s.push(p)}var f=i.defaultItems();for(x=0;x<f.length;x++)p=f[x],p._index=s.length,a.handleItemDefaults({},p,e,a,{}),s.push(p);if(A.isArrayOrTypedArray(t)){var d=Math.min(t.length,s.length);for(x=0;x<d;x++)A.relinkPrivateKeys(s[x],t[x])}return s}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(y,ee,te){var A=y("./font_attributes"),g=y("../components/fx/attributes");ee.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:A({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:g.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=g.dateTime2ms,M=g.incrementMonth,e=y("../../constants/numerical"),a=e.ONEAVGMONTH;ee.exports=function(r,t,h,s){if(t.type!=="date")return{vals:s};var i=r[h+"periodalignment"];if(!i)return{vals:s};var x=r[h+"period"],p;if(A(x)){if(x=+x,x<=0)return{vals:s}}else if(typeof x=="string"&&x.charAt(0)==="M"){var v=+x.substring(1);if(v>0&&Math.round(v)===v)p=v;else return{vals:s}}for(var f=t.calendar,d=i==="start",o=i==="end",m=r[h+"period0"],l=S(m,f)||0,w=[],_=[],c=[],b=s.length,u=0;u<b;u++){var L=s[u],T,k,P;if(p){for(T=Math.round((L-l)/(p*a)),P=M(l,p*T,f);P>L;)P=M(P,-p,f);for(;P<=L;)P=M(P,p,f);k=M(P,-p,f)}else{for(T=Math.round((L-l)/x),P=l+T*x;P>L;)P-=x;for(;P<=L;)P+=x;k=P-x}w[u]=d?k:o?P:(k+P)/2,_[u]=k,c[u]=P}return{vals:w,starts:_,ends:c}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(y,ee,te){ee.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("../../lib"),M=y("../../constants/numerical").FP_SAFE,e=y("../../registry"),a=y("../../components/drawing"),n=y("./axis_ids"),r=n.getFromId,t=n.isLinked;ee.exports={getAutoRange:h,makePadFn:i,doAutoRange:f,findExtremes:d,concatExtremes:v};function h(b,u){var L,T,k=[],P=b._fullLayout,z=i(P,u,0),I=i(P,u,1),D=v(b,u),R=D.min,O=D.max;if(R.length===0||O.length===0)return S.simpleMap(u.range,u.r2l);var F=R[0].val,N=O[0].val;for(L=1;L<R.length&&F===N;L++)F=Math.min(F,R[L].val);for(L=1;L<O.length&&F===N;L++)N=Math.max(N,O[L].val);var G=!1;if(u.range){var K=S.simpleMap(u.range,u.r2l);G=K[1]<K[0]}u.autorange==="reversed"&&(G=!0,u.autorange=!0);var W=u.rangemode,Y=W==="tozero",re=W==="nonnegative",ue=u._length,j=ue/10,q=0,H,U,$,ne,X,Q;for(L=0;L<R.length;L++)for(H=R[L],T=0;T<O.length;T++)U=O[T],Q=U.val-H.val-s(u,H.val,U.val),Q>0&&(X=ue-z(H)-I(U),X>j?Q/X>q&&($=H,ne=U,q=Q/X):Q/ue>q&&($={val:H.val,nopad:1},ne={val:U.val,nopad:1},q=Q/ue));function ie(ce,de){return Math.max(ce,I(de))}if(F===N){var se=F-1,ae=F+1;if(Y)if(F===0)k=[0,1];else{var oe=(F>0?O:R).reduce(ie,0),be=F/(1-Math.min(.5,oe/ue));k=F>0?[0,be]:[be,0]}else re?k=[Math.max(0,se),Math.max(1,ae)]:k=[se,ae]}else Y?($.val>=0&&($={val:0,nopad:1}),ne.val<=0&&(ne={val:0,nopad:1})):re&&($.val-q*z($)<0&&($={val:0,nopad:1}),ne.val<=0&&(ne={val:1,nopad:1})),q=(ne.val-$.val-s(u,H.val,U.val))/(ue-z($)-I(ne)),k=[$.val-q*z($),ne.val+q*I(ne)];return G&&k.reverse(),S.simpleMap(k,u.l2r||Number)}function s(b,u,L){var T=0;if(b.rangebreaks)for(var k=b.locateBreaks(u,L),P=0;P<k.length;P++){var z=k[P];T+=z.max-z.min}return T}function i(b,u,L){var T=.05*u._length,k=u._anchorAxis||{};if((u.ticklabelposition||"").indexOf("inside")!==-1||(k.ticklabelposition||"").indexOf("inside")!==-1){var P=u.autorange==="reversed";if(!P){var z=S.simpleMap(u.range,u.r2l);P=z[1]<z[0]}P&&(L=!L)}var I=0;return t(b,u._id)||(I=p(b,u,L)),T=Math.max(I,T),u.constrain==="domain"&&u._inputDomain&&(T*=(u._inputDomain[1]-u._inputDomain[0])/(u.domain[1]-u.domain[0])),function(R){return R.nopad?0:R.pad+(R.extrapad?T:I)}}var x=3;function p(b,u,L){var T=0,k=u._id.charAt(0)==="x";for(var P in b._plots){var z=b._plots[P];if(!(u._id!==z.xaxis._id&&u._id!==z.yaxis._id)){var I=(k?z.yaxis:z.xaxis)||{};if((I.ticklabelposition||"").indexOf("inside")!==-1&&(!L&&(I.side==="left"||I.side==="bottom")||L&&(I.side==="top"||I.side==="right"))){if(I._vals){var D=S.deg2rad(I._tickAngles[I._id+"tick"]||0),R=Math.abs(Math.cos(D)),O=Math.abs(Math.sin(D));if(!I._vals[0].bb){var F=I._id+"tick",N=I._selections[F];N.each(function(ue){var j=A.select(this),q=j.select(".text-math-group");q.empty()&&(ue.bb=a.bBox(j.node()))})}for(var G=0;G<I._vals.length;G++){var K=I._vals[G],W=K.bb;if(W){var Y=2*x+W.width,re=2*x+W.height;T=Math.max(T,k?Math.max(Y*R,re*O):Math.max(re*R,Y*O))}}}I.ticks==="inside"&&I.ticklabelposition==="inside"&&(T+=I.ticklen||0)}}}return T}function v(b,u,L){var T=u._id,k=b._fullData,P=b._fullLayout,z=[],I=[],D,R,O;function F(Y,re){for(D=0;D<re.length;D++){var ue=Y[re[D]],j=(ue._extremes||{})[T];if(ue.visible===!0&&j){for(R=0;R<j.min.length;R++)O=j.min[R],o(z,O.val,O.pad,{extrapad:O.extrapad});for(R=0;R<j.max.length;R++)O=j.max[R],m(I,O.val,O.pad,{extrapad:O.extrapad})}}}if(F(k,u._traceIndices),F(P.annotations||[],u._annIndices||[]),F(P.shapes||[],u._shapeIndices||[]),u._matchGroup&&!L){for(var N in u._matchGroup)if(N!==u._id){var G=r(b,N),K=v(b,G,!0),W=u._length/G._length;for(R=0;R<K.min.length;R++)O=K.min[R],o(z,O.val,O.pad*W,{extrapad:O.extrapad});for(R=0;R<K.max.length;R++)O=K.max[R],m(I,O.val,O.pad*W,{extrapad:O.extrapad})}}return{min:z,max:I}}function f(b,u,L){if(u.setScale(),u.autorange){u.range=L?L.slice():h(b,u),u._r=u.range.slice(),u._rl=S.simpleMap(u._r,u.r2l);var T=u._input,k={};k[u._attr+".range"]=u.range,k[u._attr+".autorange"]=u.autorange,e.call("_storeDirectGUIEdit",b.layout,b._fullLayout._preGUI,k),T.range=u.range.slice(),T.autorange=u.autorange}var P=u._anchorAxis;if(P&&P.rangeslider){var z=P.rangeslider[u._name];z&&z.rangemode==="auto"&&(z.range=h(b,u)),P._input.rangeslider[u._name]=S.extendFlat({},z)}}function d(b,u,L){L||(L={}),b._m||b.setScale();var T=[],k=[],P=u.length,z=L.padded||!1,I=L.tozero&&(b.type==="linear"||b.type==="-"),D=b.type==="log",R=!1,O=L.vpadLinearized||!1,F,N,G,K,W,Y,re,ue,j;function q(se){if(Array.isArray(se))return R=!0,function(oe){return Math.max(Number(se[oe]||0),0)};var ae=Math.max(Number(se||0),0);return function(){return ae}}var H=q((b._m>0?L.ppadplus:L.ppadminus)||L.ppad||0),U=q((b._m>0?L.ppadminus:L.ppadplus)||L.ppad||0),$=q(L.vpadplus||L.vpad),ne=q(L.vpadminus||L.vpad);if(!R){if(ue=1/0,j=-1/0,D)for(F=0;F<P;F++)N=u[F],N<ue&&N>0&&(ue=N),N>j&&N<M&&(j=N);else for(F=0;F<P;F++)N=u[F],N<ue&&N>-M&&(ue=N),N>j&&N<M&&(j=N);u=[ue,j],P=2}var X={tozero:I,extrapad:z};function Q(se){G=u[se],g(G)&&(Y=H(se),re=U(se),O?(K=b.c2l(G)-ne(se),W=b.c2l(G)+$(se)):(ue=G-ne(se),j=G+$(se),D&&ue<j/10&&(ue=j/10),K=b.c2l(ue),W=b.c2l(j)),I&&(K=Math.min(0,K),W=Math.max(0,W)),w(K)&&o(T,K,re,X),w(W)&&m(k,W,Y,X))}var ie=Math.min(6,P);for(F=0;F<ie;F++)Q(F);for(F=P-1;F>=ie;F--)Q(F);return{min:T,max:k,opts:L}}function o(b,u,L,T){l(b,u,L,T,_)}function m(b,u,L,T){l(b,u,L,T,c)}function l(b,u,L,T,k){for(var P=T.tozero,z=T.extrapad,I=!0,D=0;D<b.length&&I;D++){var R=b[D];if(k(R.val,u)&&R.pad>=L&&(R.extrapad||!z)){I=!1;break}else k(u,R.val)&&R.pad<=L&&(z||!R.extrapad)&&(b.splice(D,1),D--)}if(I){var O=P&&u===0;b.push({val:u,pad:O?0:L,extrapad:O?!1:z})}}function w(b){return g(b)&&Math.abs(b)<M}function _(b,u){return b<=u}function c(b,u){return b>=u}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("../../plots/plots"),M=y("../../registry"),e=y("../../lib"),a=e.strTranslate,n=y("../../lib/svg_text_utils"),r=y("../../components/titles"),t=y("../../components/color"),h=y("../../components/drawing"),s=y("./layout_attributes"),i=y("./clean_ticks"),x=y("../../constants/numerical"),p=x.ONEMAXYEAR,v=x.ONEAVGYEAR,f=x.ONEMINYEAR,d=x.ONEMAXQUARTER,o=x.ONEAVGQUARTER,m=x.ONEMINQUARTER,l=x.ONEMAXMONTH,w=x.ONEAVGMONTH,_=x.ONEMINMONTH,c=x.ONEWEEK,b=x.ONEDAY,u=b/2,L=x.ONEHOUR,T=x.ONEMIN,k=x.ONESEC,P=x.MINUS_SIGN,z=x.BADNUM,I={K:"zeroline"},D={K:"gridline",L:"path"},R={K:"minor-gridline",L:"path"},O={K:"tick",L:"path"},F={K:"tick",L:"text"},N={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},G=y("../../constants/alignment"),K=G.MID_SHIFT,W=G.CAP_SHIFT,Y=G.LINE_SPACING,re=G.OPPOSITE_SIDE,ue=3,j=ee.exports={};j.setConvert=y("./set_convert");var q=y("./axis_autotype"),H=y("./axis_ids"),U=H.idSort,$=H.isLinked;j.id2name=H.id2name,j.name2id=H.name2id,j.cleanId=H.cleanId,j.list=H.list,j.listIds=H.listIds,j.getFromId=H.getFromId,j.getFromTrace=H.getFromTrace;var ne=y("./autorange");j.getAutoRange=ne.getAutoRange,j.findExtremes=ne.findExtremes;var X=1e-4;function Q(Ce){var Se=(Ce[1]-Ce[0])*X;return[Ce[0]-Se,Ce[1]+Se]}j.coerceRef=function(Ce,Se,nt,it,ct,kt){var gt=it.charAt(it.length-1),St=nt._fullLayout._subplots[gt+"axis"],Yt=it+"ref",ar={};return ct||(ct=St[0]||(typeof kt=="string"?kt:kt[0])),kt||(kt=ct),St=St.concat(St.map(function(kr){return kr+" domain"})),ar[Yt]={valType:"enumerated",values:St.concat(kt?typeof kt=="string"?[kt]:kt:[]),dflt:ct},e.coerce(Ce,Se,ar,Yt)},j.getRefType=function(Ce){return Ce===void 0?Ce:Ce==="paper"?"paper":Ce==="pixel"?"pixel":/( domain)$/.test(Ce)?"domain":"range"},j.coercePosition=function(Ce,Se,nt,it,ct,kt){var gt,St,Yt=j.getRefType(it);if(Yt!=="range")gt=e.ensureNumber,St=nt(ct,kt);else{var ar=j.getFromId(Se,it);kt=ar.fraction2r(kt),St=nt(ct,kt),gt=ar.cleanPos}Ce[ct]=gt(St)},j.cleanPosition=function(Ce,Se,nt){var it=nt==="paper"||nt==="pixel"?e.ensureNumber:j.getFromId(Se,nt).cleanPos;return it(Ce)},j.redrawComponents=function(Ce,Se){Se=Se||j.listIds(Ce);var nt=Ce._fullLayout;function it(ct,kt,gt,St){for(var Yt=M.getComponentMethod(ct,kt),ar={},kr=0;kr<Se.length;kr++)for(var br=nt[j.id2name(Se[kr])],Mr=br[gt],Yr=0;Yr<Mr.length;Yr++){var nr=Mr[Yr];if(!ar[nr]&&(Yt(Ce,nr),ar[nr]=1,St))return}}it("annotations","drawOne","_annIndices"),it("shapes","drawOne","_shapeIndices"),it("images","draw","_imgIndices",!0),it("selections","drawOne","_selectionIndices")};var ie=j.getDataConversions=function(Ce,Se,nt,it){var ct,kt=nt==="x"||nt==="y"||nt==="z"?nt:it;if(Array.isArray(kt)){if(ct={type:q(it,void 0,{autotypenumbers:Ce._fullLayout.autotypenumbers}),_categories:[]},j.setConvert(ct),ct.type==="category")for(var gt=0;gt<it.length;gt++)ct.d2c(it[gt])}else ct=j.getFromTrace(Ce,Se,kt);return ct?{d2c:ct.d2c,c2d:ct.c2d}:kt==="ids"?{d2c:ae,c2d:ae}:{d2c:se,c2d:se}};function se(Ce){return+Ce}function ae(Ce){return String(Ce)}j.getDataToCoordFunc=function(Ce,Se,nt,it){return ie(Ce,Se,nt,it).d2c},j.counterLetter=function(Ce){var Se=Ce.charAt(0);if(Se==="x")return"y";if(Se==="y")return"x"},j.minDtick=function(Ce,Se,nt,it){["log","category","multicategory"].indexOf(Ce.type)!==-1||!it?Ce._minDtick=0:Ce._minDtick===void 0?(Ce._minDtick=Se,Ce._forceTick0=nt):Ce._minDtick&&((Ce._minDtick/Se+1e-6)%1<2e-6&&((nt-Ce._forceTick0)/Se%1+1.000001)%1<2e-6?(Ce._minDtick=Se,Ce._forceTick0=nt):((Se/Ce._minDtick+1e-6)%1>2e-6||((nt-Ce._forceTick0)/Ce._minDtick%1+1.000001)%1>2e-6)&&(Ce._minDtick=0))},j.saveRangeInitial=function(Ce,Se){for(var nt=j.list(Ce,"",!0),it=!1,ct=0;ct<nt.length;ct++){var kt=nt[ct],gt=kt._rangeInitial===void 0,St=gt||!(kt.range[0]===kt._rangeInitial[0]&&kt.range[1]===kt._rangeInitial[1]);(gt&&kt.autorange===!1||Se&&St)&&(kt._rangeInitial=kt.range.slice(),it=!0)}return it},j.saveShowSpikeInitial=function(Ce,Se){for(var nt=j.list(Ce,"",!0),it=!1,ct="on",kt=0;kt<nt.length;kt++){var gt=nt[kt],St=gt._showSpikeInitial===void 0,Yt=St||gt.showspikes!==gt._showspikes;(St||Se&&Yt)&&(gt._showSpikeInitial=gt.showspikes,it=!0),ct==="on"&&!gt.showspikes&&(ct="off")}return Ce._fullLayout._cartesianSpikesEnabled=ct,it},j.autoBin=function(Ce,Se,nt,it,ct,kt){var gt=e.aggNums(Math.min,null,Ce),St=e.aggNums(Math.max,null,Ce);if(Se.type==="category"||Se.type==="multicategory")return{start:gt-.5,end:St+.5,size:Math.max(1,Math.round(kt)||1),_dataSpan:St-gt};ct||(ct=Se.calendar);var Yt;if(Se.type==="log"?Yt={type:"linear",range:[gt,St]}:Yt={type:Se.type,range:e.simpleMap([gt,St],Se.c2r,0,ct),calendar:ct},j.setConvert(Yt),kt=kt&&i.dtick(kt,Yt.type),kt)Yt.dtick=kt,Yt.tick0=i.tick0(void 0,Yt.type,ct);else{var ar;if(nt)ar=(St-gt)/nt;else{var kr=e.distinctVals(Ce),br=Math.pow(10,Math.floor(Math.log(kr.minDiff)/Math.LN10)),Mr=br*e.roundUp(kr.minDiff/br,[.9,1.9,4.9,9.9],!0);ar=Math.max(Mr,2*e.stdev(Ce)/Math.pow(Ce.length,it?.25:.4)),g(ar)||(ar=1)}j.autoTicks(Yt,ar)}var Yr=Yt.dtick,nr=j.tickIncrement(j.tickFirst(Yt),Yr,"reverse",ct),gr,Rr;if(typeof Yr=="number")nr=oe(nr,Ce,Yt,gt,St),Rr=1+Math.floor((St-nr)/Yr),gr=nr+Rr*Yr;else for(Yt.dtick.charAt(0)==="M"&&(nr=be(nr,Ce,Yr,gt,ct)),gr=nr,Rr=0;gr<=St;)gr=j.tickIncrement(gr,Yr,!1,ct),Rr++;return{start:Se.c2r(nr,0,ct),end:Se.c2r(gr,0,ct),size:Yr,_dataSpan:St-gt}};function oe(Ce,Se,nt,it,ct){var kt=0,gt=0,St=0,Yt=0;function ar(Yr){return(1+(Yr-Ce)*100/nt.dtick)%100<2}for(var kr=0;kr<Se.length;kr++)Se[kr]%1===0?St++:g(Se[kr])||Yt++,ar(Se[kr])&&kt++,ar(Se[kr]+nt.dtick/2)&&gt++;var br=Se.length-Yt;if(St===br&&nt.type!=="date")nt.dtick<1?Ce=it-.5*nt.dtick:(Ce-=.5,Ce+nt.dtick<it&&(Ce+=nt.dtick));else if(gt<br*.1&&(kt>br*.3||ar(it)||ar(ct))){var Mr=nt.dtick/2;Ce+=Ce+Mr<it?Mr:-Mr}return Ce}function be(Ce,Se,nt,it,ct){var kt=e.findExactDates(Se,ct),gt=.8;if(kt.exactDays>gt){var St=Number(nt.substr(1));kt.exactYears>gt&&St%12===0?Ce=j.tickIncrement(Ce,"M6","reverse")+b*1.5:kt.exactMonths>gt?Ce=j.tickIncrement(Ce,"M1","reverse")+b*15.5:Ce-=u;var Yt=j.tickIncrement(Ce,nt);if(Yt<=it)return Yt}return Ce}j.prepMinorTicks=function(Ce,Se,nt){if(!Se.minor.dtick){delete Ce.dtick;var it=Se.dtick&&g(Se._tmin),ct;if(it){var kt=j.tickIncrement(Se._tmin,Se.dtick,!0);ct=[Se._tmin,kt*.99+Se._tmin*.01]}else{var gt=e.simpleMap(Se.range,Se.r2l);ct=[gt[0],.8*gt[0]+.2*gt[1]]}if(Ce.range=e.simpleMap(ct,Se.l2r),Ce._isMinor=!0,j.prepTicks(Ce,nt),it){var St=g(Se.dtick),Yt=g(Ce.dtick),ar=St?Se.dtick:+Se.dtick.substring(1),kr=Yt?Ce.dtick:+Ce.dtick.substring(1);St&&Yt?ce(ar,kr)?ar===2*c&&kr===2*b&&(Ce.dtick=c):ar===2*c&&kr===3*b?Ce.dtick=c:ar===c&&!(Se._input.minor||{}).nticks?Ce.dtick=b:de(ar/kr,2.5)?Ce.dtick=ar/2:Ce.dtick=ar:String(Se.dtick).charAt(0)==="M"?Yt?Ce.dtick="M1":ce(ar,kr)?ar>=12&&kr===2&&(Ce.dtick="M3"):Ce.dtick=Se.dtick:String(Ce.dtick).charAt(0)==="L"?String(Se.dtick).charAt(0)==="L"?ce(ar,kr)||(Ce.dtick=de(ar/kr,2.5)?Se.dtick/2:Se.dtick):Ce.dtick="D1":Ce.dtick==="D2"&&+Se.dtick>1&&(Ce.dtick=1)}Ce.range=Se.range}Se.minor._tick0Init===void 0&&(Ce.tick0=Se.tick0)};function ce(Ce,Se){return Math.abs((Ce/Se+.5)%1-.5)<.001}function de(Ce,Se){return Math.abs(Ce/Se-1)<.001}j.prepTicks=function(Ce,Se){var nt=e.simpleMap(Ce.range,Ce.r2l,void 0,void 0,Se);if(Ce.tickmode==="auto"||!Ce.dtick){var it=Ce.nticks,ct;it||(Ce.type==="category"||Ce.type==="multicategory"?(ct=Ce.tickfont?e.bigFont(Ce.tickfont.size||12):15,it=Ce._length/ct):(ct=Ce._id.charAt(0)==="y"?40:80,it=e.constrain(Ce._length/ct,4,9)+1),Ce._name==="radialaxis"&&(it*=2)),Ce.minor&&Ce.minor.tickmode!=="array"||Ce.tickmode==="array"&&(it*=100),Ce._roughDTick=Math.abs(nt[1]-nt[0])/it,j.autoTicks(Ce,Ce._roughDTick),Ce._minDtick>0&&Ce.dtick<Ce._minDtick*2&&(Ce.dtick=Ce._minDtick,Ce.tick0=Ce.l2r(Ce._forceTick0))}Ce.ticklabelmode==="period"&&ge(Ce),Ce.tick0||(Ce.tick0=Ce.type==="date"?"2000-01-01":0),Ce.type==="date"&&Ce.dtick<.1&&(Ce.dtick=.1),Ye(Ce)};function ye(Ce){return+Ce.substring(1)}function ge(Ce){var Se;function nt(){return!(g(Ce.dtick)||Ce.dtick.charAt(0)!=="M")}var it=nt(),ct=j.getTickFormat(Ce);if(ct){var kt=Ce._dtickInit!==Ce.dtick;/%[fLQsSMX]/.test(ct)||(/%[HI]/.test(ct)?(Se=L,kt&&!it&&Ce.dtick<L&&(Ce.dtick=L)):/%p/.test(ct)?(Se=u,kt&&!it&&Ce.dtick<u&&(Ce.dtick=u)):/%[Aadejuwx]/.test(ct)?(Se=b,kt&&!it&&Ce.dtick<b&&(Ce.dtick=b)):/%[UVW]/.test(ct)?(Se=c,kt&&!it&&Ce.dtick<c&&(Ce.dtick=c)):/%[Bbm]/.test(ct)?(Se=w,kt&&(it?ye(Ce.dtick)<1:Ce.dtick<_)&&(Ce.dtick="M1")):/%[q]/.test(ct)?(Se=o,kt&&(it?ye(Ce.dtick)<3:Ce.dtick<m)&&(Ce.dtick="M3")):/%[Yy]/.test(ct)&&(Se=v,kt&&(it?ye(Ce.dtick)<12:Ce.dtick<f)&&(Ce.dtick="M12")))}it=nt(),it&&Ce.tick0===Ce._dowTick0&&(Ce.tick0=Ce._rawTick0),Ce._definedDelta=Se}function me(Ce,Se,nt){for(var it=0;it<Ce.length;it++){var ct=Ce[it].value,kt=it,gt=it+1;it<Ce.length-1?(kt=it,gt=it+1):it>0?(kt=it-1,gt=it):(kt=it,gt=it);var St=Ce[kt].value,Yt=Ce[gt].value,ar=Math.abs(Yt-St),kr=nt||ar,br=0;kr>=f?ar>=f&&ar<=p?br=ar:br=v:nt===o&&kr>=m?ar>=m&&ar<=d?br=ar:br=o:kr>=_?ar>=_&&ar<=l?br=ar:br=w:nt===c&&kr>=c?br=c:kr>=b?br=b:nt===u&&kr>=u?br=u:nt===L&&kr>=L&&(br=L);var Mr;br>=ar&&(br=ar,Mr=!0);var Yr=ct+br;if(Se.rangebreaks&&br>0){for(var nr=84,gr=0,Rr=0;Rr<nr;Rr++){var Br=(Rr+.5)/nr;Se.maskBreaks(ct*(1-Br)+Br*Yr)!==z&&gr++}br*=gr/nr,br||(Ce[it].drop=!0),Mr&&ar>c&&(br=ar)}(br>0||it===0)&&(Ce[it].periodX=ct+br/2)}}j.calcTicks=function(Se,nt){for(var it=Se.type,ct=Se.calendar,kt=Se.ticklabelstep,gt=Se.ticklabelmode==="period",St=e.simpleMap(Se.range,Se.r2l,void 0,void 0,nt),Yt=St[1]<St[0],ar=Math.min(St[0],St[1]),kr=Math.max(St[0],St[1]),br=Math.max(1e3,Se._length||0),Mr=[],Yr=[],nr=[],gr=[],Rr=Se.minor&&(Se.minor.ticks||Se.minor.showgrid),Br=1;Br>=(Rr?0:1);Br--){var Sr=!Br;Br?(Se._dtickInit=Se.dtick,Se._tick0Init=Se.tick0):(Se.minor._dtickInit=Se.minor.dtick,Se.minor._tick0Init=Se.minor.tick0);var et=Br?Se:e.extendFlat({},Se,Se.minor);if(Sr?j.prepMinorTicks(et,Se,nt):j.prepTicks(et,nt),et.tickmode==="array"){Br?(nr=[],Mr=Ee(Se)):(gr=[],Yr=Ee(Se));continue}var Lt=Q(St),Zt=Lt[0],or=Lt[1],Ir=g(et.dtick),Or=it==="log"&&!(Ir||et.dtick.charAt(0)==="L"),Er=j.tickFirst(et,nt);if(Br){if(Se._tmin=Er,Er<Zt!==Yt)break;(it==="category"||it==="multicategory")&&(or=Yt?Math.max(-.5,or):Math.min(Se._categories.length-.5,or))}var wr=null,Gr=Er,wn;if(Br){var cn;Ir?cn=Se.dtick:it==="date"?typeof Se.dtick=="string"&&Se.dtick.charAt(0)==="M"&&(cn=w*Se.dtick.substring(1)):cn=Se._roughDTick,wn=Math.round((Se.r2l(Gr)-Se.r2l(Se.tick0))/cn)-1}var Bn=et.dtick;for(et.rangebreaks&&et._tick0Init!==et.tick0&&(Gr=lt(Gr,Se),Yt||(Gr=j.tickIncrement(Gr,Bn,!Yt,ct))),Br&&gt&&(Gr=j.tickIncrement(Gr,Bn,!Yt,ct),wn--);Yt?Gr>=or:Gr<=or;Gr=j.tickIncrement(Gr,Bn,Yt,ct)){if(Br&&wn++,et.rangebreaks&&!Yt){if(Gr<Zt)continue;if(et.maskBreaks(Gr)===z&&lt(Gr,et)>=kr)break}if(nr.length>br||Gr===wr)break;wr=Gr;var En={value:Gr};Br?(Or&&Gr!==(Gr|0)&&(En.simpleLabel=!0),kt>1&&wn%kt&&(En.skipLabel=!0),nr.push(En)):(En.minor=!0,gr.push(En))}}if(Rr){var Yn=Se.minor.ticks==="inside"&&Se.ticks==="outside"||Se.minor.ticks==="outside"&&Se.ticks==="inside";if(!Yn){for(var Vn=nr.map(function(Ht){return Ht.value}),pa=[],Ma=0;Ma<gr.length;Ma++){var ci=gr[Ma],Va=ci.value;if(Vn.indexOf(Va)===-1){for(var ja=!1,Wa=0;!ja&&Wa<nr.length;Wa++)1e7+nr[Wa].value===1e7+Va&&(ja=!0);ja||pa.push(ci)}}gr=pa}}gt&&me(nr,Se,Se._definedDelta);var Tr;if(Se.rangebreaks){var pn=Se._id.charAt(0)==="y",fn=1;Se.tickmode==="auto"&&(fn=Se.tickfont?Se.tickfont.size:12);var An=NaN;for(Tr=nr.length-1;Tr>-1;Tr--){if(nr[Tr].drop){nr.splice(Tr,1);continue}nr[Tr].value=lt(nr[Tr].value,Se);var Zn=Se.c2p(nr[Tr].value);(pn?An>Zn-fn:An<Zn+fn)?nr.splice(Yt?Tr+1:Tr,1):An=Zn}}st(Se)&&Math.abs(St[1]-St[0])===360&&nr.pop(),Se._tmax=(nr[nr.length-1]||{}).value,Se._prevDateHead="",Se._inCalcTicks=!0;var ua,ea=function(Ht){Ht.text="",Se._prevDateHead=ua};nr=nr.concat(gr);var Rn,Xn;for(Tr=0;Tr<nr.length;Tr++){var Ua=nr[Tr].minor,li=nr[Tr].value;Ua?Yr.push({x:li,minor:!0}):(ua=Se._prevDateHead,Rn=j.tickText(Se,li,!1,nr[Tr].simpleLabel),Xn=nr[Tr].periodX,Xn!==void 0&&(Rn.periodX=Xn,(Xn>kr||Xn<ar)&&(Xn>kr&&(Rn.periodX=kr),Xn<ar&&(Rn.periodX=ar),ea(Rn))),nr[Tr].skipLabel&&ea(Rn),Mr.push(Rn))}return Mr=Mr.concat(Yr),Se._inCalcTicks=!1,gt&&Mr.length&&(Mr[0].noTick=!0),Mr};function Ee(Ce){var Se=e.simpleMap(Ce.range,Ce.r2l),nt=Q(Se),it=Math.min(nt[0],nt[1]),ct=Math.max(nt[0],nt[1]),kt=Ce.type==="category"?Ce.d2l_noadd:Ce.d2l;Ce.type==="log"&&String(Ce.dtick).charAt(0)!=="L"&&(Ce.dtick="L"+Math.pow(10,Math.floor(Math.min(Ce.range[0],Ce.range[1]))-1));for(var gt=[],St=0;St<=1;St++)if(!(St&&!Ce.minor)){var Yt=St?Ce.minor.tickvals:Ce.tickvals,ar=St?[]:Ce.ticktext;if(Yt){Array.isArray(ar)||(ar=[]);for(var kr=0;kr<Yt.length;kr++){var br=kt(Yt[kr]);if(br>it&&br<ct){var Mr=ar[kr]===void 0?j.tickText(Ce,br):vt(Ce,br,String(ar[kr]));St&&(Mr.minor=!0,Mr.text=""),gt.push(Mr)}}}}return Ce.rangebreaks&&(gt=gt.filter(function(Yr){return Ce.maskBreaks(Yr.x)!==z})),gt}var Pe=[2,5,10],Ue=[1,2,3,6,12],we=[1,2,5,10,15,30],ke=[1,2,3,7,14],Xe=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Ve=[-.301,0,.301,.699,1],Ie=[15,30,45,90,180];function De(Ce,Se,nt){return Se*e.roundUp(Ce/Se,nt)}j.autoTicks=function(Ce,Se,nt){var it;function ct(br){return Math.pow(br,Math.floor(Math.log(Se)/Math.LN10))}if(Ce.type==="date"){Ce.tick0=e.dateTick0(Ce.calendar,0);var kt=2*Se;if(kt>v)Se/=v,it=ct(10),Ce.dtick="M"+12*De(Se,it,Pe);else if(kt>w)Se/=w,Ce.dtick="M"+De(Se,1,Ue);else if(kt>b){if(Ce.dtick=De(Se,b,Ce._hasDayOfWeekBreaks?[1,2,7,14]:ke),!nt){var gt=j.getTickFormat(Ce),St=Ce.ticklabelmode==="period";St&&(Ce._rawTick0=Ce.tick0),/%[uVW]/.test(gt)?Ce.tick0=e.dateTick0(Ce.calendar,2):Ce.tick0=e.dateTick0(Ce.calendar,1),St&&(Ce._dowTick0=Ce.tick0)}}else kt>L?Ce.dtick=De(Se,L,Ue):kt>T?Ce.dtick=De(Se,T,we):kt>k?Ce.dtick=De(Se,k,we):(it=ct(10),Ce.dtick=De(Se,it,Pe))}else if(Ce.type==="log"){Ce.tick0=0;var Yt=e.simpleMap(Ce.range,Ce.r2l);if(Ce._isMinor&&(Se*=1.5),Se>.7)Ce.dtick=Math.ceil(Se);else if(Math.abs(Yt[1]-Yt[0])<1){var ar=1.5*Math.abs((Yt[1]-Yt[0])/Se);Se=Math.abs(Math.pow(10,Yt[1])-Math.pow(10,Yt[0]))/ar,it=ct(10),Ce.dtick="L"+De(Se,it,Pe)}else Ce.dtick=Se>.3?"D2":"D1"}else Ce.type==="category"||Ce.type==="multicategory"?(Ce.tick0=0,Ce.dtick=Math.ceil(Math.max(Se,1))):st(Ce)?(Ce.tick0=0,it=1,Ce.dtick=De(Se,it,Ie)):(Ce.tick0=0,it=ct(10),Ce.dtick=De(Se,it,Pe));if(Ce.dtick===0&&(Ce.dtick=1),!g(Ce.dtick)&&typeof Ce.dtick!="string"){var kr=Ce.dtick;throw Ce.dtick=1,"ax.dtick error: "+String(kr)}};function Ye(Ce){var Se=Ce.dtick;if(Ce._tickexponent=0,!g(Se)&&typeof Se!="string"&&(Se=1),(Ce.type==="category"||Ce.type==="multicategory")&&(Ce._tickround=null),Ce.type==="date"){var nt=Ce.r2l(Ce.tick0),it=Ce.l2r(nt).replace(/(^-|i)/g,""),ct=it.length;if(String(Se).charAt(0)==="M")ct>10||it.substr(5)!=="01-01"?Ce._tickround="d":Ce._tickround=+Se.substr(1)%12===0?"y":"m";else if(Se>=b&&ct<=10||Se>=b*15)Ce._tickround="d";else if(Se>=T&&ct<=16||Se>=L)Ce._tickround="M";else if(Se>=k&&ct<=19||Se>=T)Ce._tickround="S";else{var kt=Ce.l2r(nt+Se).replace(/^-/,"").length;Ce._tickround=Math.max(ct,kt)-20,Ce._tickround<0&&(Ce._tickround=4)}}else if(g(Se)||Se.charAt(0)==="L"){var gt=Ce.range.map(Ce.r2d||Number);g(Se)||(Se=Number(Se.substr(1))),Ce._tickround=2-Math.floor(Math.log(Se)/Math.LN10+.01);var St=Math.max(Math.abs(gt[0]),Math.abs(gt[1])),Yt=Math.floor(Math.log(St)/Math.LN10+.01),ar=Ce.minexponent===void 0?3:Ce.minexponent;Math.abs(Yt)>ar&&(tt(Ce.exponentformat)&&!He(Yt)?Ce._tickexponent=3*Math.round((Yt-1)/3):Ce._tickexponent=Yt)}else Ce._tickround=null}j.tickIncrement=function(Ce,Se,nt,it){var ct=nt?-1:1;if(g(Se))return e.increment(Ce,ct*Se);var kt=Se.charAt(0),gt=ct*Number(Se.substr(1));if(kt==="M")return e.incrementMonth(Ce,gt,it);if(kt==="L")return Math.log(Math.pow(10,Ce)+gt)/Math.LN10;if(kt==="D"){var St=Se==="D2"?Ve:Xe,Yt=Ce+ct*.01,ar=e.roundUp(e.mod(Yt,1),St,nt);return Math.floor(Yt)+Math.log(A.round(Math.pow(10,ar),1))/Math.LN10}throw"unrecognized dtick "+String(Se)},j.tickFirst=function(Ce,Se){var nt=Ce.r2l||Number,it=e.simpleMap(Ce.range,nt,void 0,void 0,Se),ct=it[1]<it[0],kt=ct?Math.floor:Math.ceil,gt=Q(it)[0],St=Ce.dtick,Yt=nt(Ce.tick0);if(g(St)){var ar=kt((gt-Yt)/St)*St+Yt;return(Ce.type==="category"||Ce.type==="multicategory")&&(ar=e.constrain(ar,0,Ce._categories.length-1)),ar}var kr=St.charAt(0),br=Number(St.substr(1));if(kr==="M"){for(var Mr=0,Yr=Yt,nr,gr,Rr;Mr<10;){if(nr=j.tickIncrement(Yr,St,ct,Ce.calendar),(nr-gt)*(Yr-gt)<=0)return ct?Math.min(Yr,nr):Math.max(Yr,nr);gr=(gt-(Yr+nr)/2)/(nr-Yr),Rr=kr+(Math.abs(Math.round(gr))||1)*br,Yr=j.tickIncrement(Yr,Rr,gr<0?!ct:ct,Ce.calendar),Mr++}return e.error("tickFirst did not converge",Ce),Yr}else{if(kr==="L")return Math.log(kt((Math.pow(10,gt)-Yt)/br)*br+Yt)/Math.LN10;if(kr==="D"){var Br=St==="D2"?Ve:Xe,Sr=e.roundUp(e.mod(gt,1),Br,ct);return Math.floor(gt)+Math.log(A.round(Math.pow(10,Sr),1))/Math.LN10}else throw"unrecognized dtick "+String(St)}},j.tickText=function(Ce,Se,nt,it){var ct=vt(Ce,Se),kt=Ce.tickmode==="array",gt=nt||kt,St=Ce.type,Yt=St==="category"?Ce.d2l_noadd:Ce.d2l,ar;if(kt&&Array.isArray(Ce.ticktext)){var kr=e.simpleMap(Ce.range,Ce.r2l),br=(Math.abs(kr[1]-kr[0])-(Ce._lBreaks||0))/1e4;for(ar=0;ar<Ce.ticktext.length&&!(Math.abs(Se-Yt(Ce.tickvals[ar]))<br);ar++);if(ar<Ce.ticktext.length)return ct.text=String(Ce.ticktext[ar]),ct}function Mr(gr){if(gr===void 0)return!0;if(nt)return gr==="none";var Rr={first:Ce._tmin,last:Ce._tmax}[gr];return gr!=="all"&&Se!==Rr}var Yr=nt?"never":Ce.exponentformat!=="none"&&Mr(Ce.showexponent)?"hide":"";if(St==="date"?Dt(Ce,ct,nt,gt):St==="log"?Kt(Ce,ct,nt,gt,Yr):St==="category"?Ft(Ce,ct):St==="multicategory"?Mt(Ce,ct,nt):st(Ce)?It(Ce,ct,nt,gt,Yr):Xt(Ce,ct,nt,gt,Yr),it||(Ce.tickprefix&&!Mr(Ce.showtickprefix)&&(ct.text=Ce.tickprefix+ct.text),Ce.ticksuffix&&!Mr(Ce.showticksuffix)&&(ct.text+=Ce.ticksuffix)),Ce.tickson==="boundaries"||Ce.showdividers){var nr=function(gr){var Rr=Ce.l2p(gr);return Rr>=0&&Rr<=Ce._length?gr:null};ct.xbnd=[nr(ct.x-.5),nr(ct.x+Ce.dtick-.5)]}return ct},j.hoverLabelText=function(Ce,Se,nt){nt&&(Ce=e.extendFlat({},Ce,{hoverformat:nt}));var it=Array.isArray(Se)?Se[0]:Se,ct=Array.isArray(Se)?Se[1]:void 0;if(ct!==void 0&&ct!==it)return j.hoverLabelText(Ce,it,nt)+" - "+j.hoverLabelText(Ce,ct,nt);var kt=Ce.type==="log"&&it<=0,gt=j.tickText(Ce,Ce.c2l(kt?-it:it),"hover").text;return kt?it===0?"0":P+gt:gt};function vt(Ce,Se,nt){var it=Ce.tickfont||{};return{x:Se,dx:0,dy:0,text:nt||"",fontSize:it.size,font:it.family,fontColor:it.color}}function Dt(Ce,Se,nt,it){var ct=Ce._tickround,kt=nt&&Ce.hoverformat||j.getTickFormat(Ce);it&&(g(ct)?ct=4:ct={y:"m",m:"d",d:"M",M:"S",S:4}[ct]);var gt=e.formatDate(Se.x,kt,ct,Ce._dateFormat,Ce.calendar,Ce._extraFormat),St,Yt=gt.indexOf(`
`);if(Yt!==-1&&(St=gt.substr(Yt+1),gt=gt.substr(0,Yt)),it&&(gt==="00:00:00"||gt==="00:00"?(gt=St,St=""):gt.length===8&&(gt=gt.replace(/:00$/,""))),St)if(nt)ct==="d"?gt+=", "+St:gt=St+(gt?", "+gt:"");else if(!Ce._inCalcTicks||Ce._prevDateHead!==St)Ce._prevDateHead=St,gt+="<br>"+St;else{var ar=Tt(Ce),kr=Ce._trueSide||Ce.side;(!ar&&kr==="top"||ar&&kr==="bottom")&&(gt+="<br> ")}Se.text=gt}function Kt(Ce,Se,nt,it,ct){var kt=Ce.dtick,gt=Se.x,St=Ce.tickformat,Yt=typeof kt=="string"&&kt.charAt(0);if(ct==="never"&&(ct=""),it&&Yt!=="L"&&(kt="L3",Yt="L"),St||Yt==="L")Se.text=Ae(Math.pow(10,gt),Ce,ct,it);else if(g(kt)||Yt==="D"&&e.mod(gt+.01,1)<.1){var ar=Math.round(gt),kr=Math.abs(ar),br=Ce.exponentformat;br==="power"||tt(br)&&He(ar)?(ar===0?Se.text=1:ar===1?Se.text="10":Se.text="10<sup>"+(ar>1?"":P)+kr+"</sup>",Se.fontSize*=1.25):(br==="e"||br==="E")&&kr>2?Se.text="1"+br+(ar>0?"+":P)+kr:(Se.text=Ae(Math.pow(10,gt),Ce,"","fakehover"),kt==="D1"&&Ce._id.charAt(0)==="y"&&(Se.dy-=Se.fontSize/6))}else if(Yt==="D")Se.text=String(Math.round(Math.pow(10,e.mod(gt,1)))),Se.fontSize*=.75;else throw"unrecognized dtick "+String(kt);if(Ce.dtick==="D1"){var Mr=String(Se.text).charAt(0);(Mr==="0"||Mr==="1")&&(Ce._id.charAt(0)==="y"?Se.dx-=Se.fontSize/4:(Se.dy+=Se.fontSize/2,Se.dx+=(Ce.range[1]>Ce.range[0]?1:-1)*Se.fontSize*(gt<0?.5:.25)))}}function Ft(Ce,Se){var nt=Ce._categories[Math.round(Se.x)];nt===void 0&&(nt=""),Se.text=String(nt)}function Mt(Ce,Se,nt){var it=Math.round(Se.x),ct=Ce._categories[it]||[],kt=ct[1]===void 0?"":String(ct[1]),gt=ct[0]===void 0?"":String(ct[0]);nt?Se.text=gt+" - "+kt:(Se.text=kt,Se.text2=gt)}function Xt(Ce,Se,nt,it,ct){ct==="never"?ct="":Ce.showexponent==="all"&&Math.abs(Se.x/Ce.dtick)<1e-6&&(ct="hide"),Se.text=Ae(Se.x,Ce,ct,it)}function It(Ce,Se,nt,it,ct){if(Ce.thetaunit==="radians"&&!nt){var kt=Se.x/180;if(kt===0)Se.text="0";else{var gt=At(kt);if(gt[1]>=100)Se.text=Ae(e.deg2rad(Se.x),Ce,ct,it);else{var St=Se.x<0;gt[1]===1?gt[0]===1?Se.text="":Se.text=gt[0]+"":Se.text=["<sup>",gt[0],"</sup>","","<sub>",gt[1],"</sub>",""].join(""),St&&(Se.text=P+Se.text)}}}else Se.text=Ae(Se.x,Ce,ct,it)}function At(Ce){function Se(St,Yt){return Math.abs(St-Yt)<=1e-6}function nt(St,Yt){return Se(Yt,0)?St:nt(Yt,St%Yt)}function it(St){for(var Yt=1;!Se(Math.round(St*Yt)/Yt,St);)Yt*=10;return Yt}var ct=it(Ce),kt=Ce*ct,gt=Math.abs(nt(kt,ct));return[Math.round(kt/gt),Math.round(ct/gt)]}var Ge=["f","p","n","","m","","k","M","G","T"];function tt(Ce){return Ce==="SI"||Ce==="B"}function He(Ce){return Ce>14||Ce<-15}function Ae(Ce,Se,nt,it){var ct=Ce<0,kt=Se._tickround,gt=nt||Se.exponentformat||"B",St=Se._tickexponent,Yt=j.getTickFormat(Se),ar=Se.separatethousands;if(it){var kr={exponentformat:gt,minexponent:Se.minexponent,dtick:Se.showexponent==="none"?Se.dtick:g(Ce)&&Math.abs(Ce)||1,range:Se.showexponent==="none"?Se.range.map(Se.r2d):[0,Ce||1]};Ye(kr),kt=(Number(kr._tickround)||0)+4,St=kr._tickexponent,Se.hoverformat&&(Yt=Se.hoverformat)}if(Yt)return Se._numFormat(Yt)(Ce).replace(/-/g,P);var br=Math.pow(10,-kt)/2;if(gt==="none"&&(St=0),Ce=Math.abs(Ce),Ce<br)Ce="0",ct=!1;else{if(Ce+=br,St&&(Ce*=Math.pow(10,-St),kt+=St),kt===0)Ce=String(Math.floor(Ce));else if(kt<0){Ce=String(Math.round(Ce)),Ce=Ce.substr(0,Ce.length+kt);for(var Mr=kt;Mr<0;Mr++)Ce+="0"}else{Ce=String(Ce);var Yr=Ce.indexOf(".")+1;Yr&&(Ce=Ce.substr(0,Yr+kt).replace(/\.?0+$/,""))}Ce=e.numSeparate(Ce,Se._separators,ar)}if(St&&gt!=="hide"){tt(gt)&&He(St)&&(gt="power");var nr;St<0?nr=P+-St:gt!=="power"?nr="+"+St:nr=String(St),gt==="e"||gt==="E"?Ce+=gt+nr:gt==="power"?Ce+="10<sup>"+nr+"</sup>":gt==="B"&&St===9?Ce+="B":tt(gt)&&(Ce+=Ge[St/3+5])}return ct?P+Ce:Ce}j.getTickFormat=function(Ce){var Se;function nt(Yt){return typeof Yt!="string"?Yt:Number(Yt.replace("M",""))*w}function it(Yt,ar){var kr=["L","D"];if(typeof Yt==typeof ar){if(typeof Yt=="number")return Yt-ar;var br=kr.indexOf(Yt.charAt(0)),Mr=kr.indexOf(ar.charAt(0));return br===Mr?Number(Yt.replace(/(L|D)/g,""))-Number(ar.replace(/(L|D)/g,"")):br-Mr}else return typeof Yt=="number"?1:-1}function ct(Yt,ar,kr){var br=kr||function(nr){return nr},Mr=ar[0],Yr=ar[1];return(!Mr&&typeof Mr!="number"||br(Mr)<=br(Yt))&&(!Yr&&typeof Yr!="number"||br(Yr)>=br(Yt))}function kt(Yt,ar){var kr=ar[0]===null,br=ar[1]===null,Mr=it(Yt,ar[0])>=0,Yr=it(Yt,ar[1])<=0;return(kr||Mr)&&(br||Yr)}var gt,St;if(Ce.tickformatstops&&Ce.tickformatstops.length>0)switch(Ce.type){case"date":case"linear":{for(Se=0;Se<Ce.tickformatstops.length;Se++)if(St=Ce.tickformatstops[Se],St.enabled&&ct(Ce.dtick,St.dtickrange,nt)){gt=St;break}break}case"log":{for(Se=0;Se<Ce.tickformatstops.length;Se++)if(St=Ce.tickformatstops[Se],St.enabled&&kt(Ce.dtick,St.dtickrange)){gt=St;break}break}}return gt?gt.value:Ce.tickformat},j.getSubplots=function(Ce,Se){var nt=Ce._fullLayout._subplots,it=nt.cartesian.concat(nt.gl2d||[]),ct=Se?j.findSubplotsWithAxis(it,Se):it;return ct.sort(function(kt,gt){var St=kt.substr(1).split("y"),Yt=gt.substr(1).split("y");return St[0]===Yt[0]?+St[1]-+Yt[1]:+St[0]-+Yt[0]}),ct},j.findSubplotsWithAxis=function(Ce,Se){for(var nt=new RegExp(Se._id.charAt(0)==="x"?"^"+Se._id+"y":Se._id+"$"),it=[],ct=0;ct<Ce.length;ct++){var kt=Ce[ct];nt.test(kt)&&it.push(kt)}return it},j.makeClipPaths=function(Ce){var Se=Ce._fullLayout;if(!Se._hasOnlyLargeSploms){var nt={_offset:0,_length:Se.width,_id:""},it={_offset:0,_length:Se.height,_id:""},ct=j.list(Ce,"x",!0),kt=j.list(Ce,"y",!0),gt=[],St,Yt;for(St=0;St<ct.length;St++)for(gt.push({x:ct[St],y:it}),Yt=0;Yt<kt.length;Yt++)St===0&&gt.push({x:nt,y:kt[Yt]}),gt.push({x:ct[St],y:kt[Yt]});var ar=Se._clips.selectAll(".axesclip").data(gt,function(kr){return kr.x._id+kr.y._id});ar.enter().append("clipPath").classed("axesclip",!0).attr("id",function(kr){return"clip"+Se._uid+kr.x._id+kr.y._id}).append("rect"),ar.exit().remove(),ar.each(function(kr){A.select(this).select("rect").attr({x:kr.x._offset||0,y:kr.y._offset||0,width:kr.x._length||1,height:kr.y._length||1})})}},j.draw=function(Ce,Se,nt){var it=Ce._fullLayout;Se==="redraw"&&it._paper.selectAll("g.subplot").each(function(kt){var gt=kt[0],St=it._plots[gt];if(St){var Yt=St.xaxis,ar=St.yaxis;St.xaxislayer.selectAll("."+Yt._id+"tick").remove(),St.yaxislayer.selectAll("."+ar._id+"tick").remove(),St.xaxislayer.selectAll("."+Yt._id+"tick2").remove(),St.yaxislayer.selectAll("."+ar._id+"tick2").remove(),St.xaxislayer.selectAll("."+Yt._id+"divider").remove(),St.yaxislayer.selectAll("."+ar._id+"divider").remove(),St.minorGridlayer&&St.minorGridlayer.selectAll("path").remove(),St.gridlayer&&St.gridlayer.selectAll("path").remove(),St.zerolinelayer&&St.zerolinelayer.selectAll("path").remove(),it._infolayer.select(".g-"+Yt._id+"title").remove(),it._infolayer.select(".g-"+ar._id+"title").remove()}});var ct=!Se||Se==="redraw"?j.listIds(Ce):Se;return e.syncOrAsync(ct.map(function(kt){return function(){if(kt){var gt=j.getFromId(Ce,kt),St=j.drawOne(Ce,gt,nt);return gt._r=gt.range.slice(),gt._rl=e.simpleMap(gt._r,gt.r2l),St}}}))},j.drawOne=function(Ce,Se,nt){nt=nt||{};var it,ct,kt;Se.setScale();var gt=Ce._fullLayout,St=Se._id,Yt=St.charAt(0),ar=j.counterLetter(St),kr=gt._plots[Se._mainSubplot];if(!kr)return;var br=kr[Yt+"axislayer"],Mr=Se._mainLinePosition,Yr=Se._mainMirrorPosition,nr=Se._vals=j.calcTicks(Se),gr=[Se.mirror,Mr,Yr].join("_");for(it=0;it<nr.length;it++)nr[it].axInfo=gr;Se._selections={},Se._tickAngles&&(Se._prevTickAngles=Se._tickAngles),Se._tickAngles={},Se._depth=null;var Rr={};function Br(Ht){var hr=St+(Ht||"tick");return Rr[hr]||(Rr[hr]=dt(Se,hr)),Rr[hr]}if(Se.visible){var Sr=j.makeTransTickFn(Se),et=j.makeTransTickLabelFn(Se),Lt,Zt,or=Se.ticks==="inside",Ir=Se.ticks==="outside";if(Se.tickson==="boundaries"){var Or=Ze(Se,nr);Zt=j.clipEnds(Se,Or),Lt=or?Zt:Or}else Zt=j.clipEnds(Se,nr),Lt=or&&Se.ticklabelmode!=="period"?Zt:nr;var Er=Se._gridVals=Zt,wr=bt(Se,nr);if(!gt._hasOnlyLargeSploms){var Gr=Se._subplotsWith,wn={};for(it=0;it<Gr.length;it++){ct=Gr[it],kt=gt._plots[ct];var cn=kt[ar+"axis"],Bn=cn._mainAxis._id;if(!wn[Bn]){wn[Bn]=1;var En=Yt==="x"?"M0,"+cn._offset+"v"+cn._length:"M"+cn._offset+",0h"+cn._length;j.drawGrid(Ce,Se,{vals:Er,counterAxis:cn,layer:kt.gridlayer.select("."+St),minorLayer:kt.minorGridlayer.select("."+St),path:En,transFn:Sr}),j.drawZeroLine(Ce,Se,{counterAxis:cn,layer:kt.zerolinelayer,path:En,transFn:Sr})}}}var Yn,Vn=j.getTickSigns(Se),pa=j.getTickSigns(Se,"minor");if(Se.ticks||Se.minor&&Se.minor.ticks){var Ma=j.makeTickPath(Se,Mr,Vn[2]),ci=j.makeTickPath(Se,Mr,pa[2],{minor:!0}),Va,ja,Wa,Tr;if(Se._anchorAxis&&Se.mirror&&Se.mirror!==!0?(Va=j.makeTickPath(Se,Yr,Vn[3]),ja=j.makeTickPath(Se,Yr,pa[3],{minor:!0}),Wa=Ma+Va,Tr=ci+ja):(Va="",ja="",Wa=Ma,Tr=ci),Se.showdividers&&Ir&&Se.tickson==="boundaries"){var pn={};for(it=0;it<wr.length;it++)pn[wr[it].x]=1;Yn=function(Ht){return pn[Ht.x]?Va:Wa}}else Yn=function(Ht){return Ht.minor?Tr:Wa}}if(j.drawTicks(Ce,Se,{vals:Lt,layer:br,path:Yn,transFn:Sr}),Se.mirror==="allticks"){var fn=Object.keys(Se._linepositions||{});for(it=0;it<fn.length;it++){ct=fn[it],kt=gt._plots[ct];var An=Se._linepositions[ct]||[],Zn=An[0],ua=An[1],ea=An[2],Rn=j.makeTickPath(Se,Zn,ea?Vn[0]:pa[0],{minor:ea})+j.makeTickPath(Se,ua,ea?Vn[1]:pa[1],{minor:ea});j.drawTicks(Ce,Se,{vals:Lt,layer:kt[Yt+"axislayer"],path:Rn,transFn:Sr})}}var Xn=[];if(Xn.push(function(){return j.drawLabels(Ce,Se,{vals:nr,layer:br,plotinfo:kt,transFn:et,labelFns:j.makeLabelFns(Se,Mr)})}),Se.type==="multicategory"){var Ua={x:2,y:10}[Yt];Xn.push(function(){var Ht={x:"height",y:"width"}[Yt],hr=Br()[Ht]+Ua+(Se._tickAngles[St+"tick"]?Se.tickfont.size*Y:0);return j.drawLabels(Ce,Se,{vals:Qe(Se,nr),layer:br,cls:St+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Sr,labelFns:j.makeLabelFns(Se,Mr+hr*Vn[4])})}),Xn.push(function(){return Se._depth=Vn[4]*(Br("tick2")[Se.side]-Mr),Nt(Ce,Se,{vals:wr,layer:br,path:j.makeTickPath(Se,Mr,Vn[4],{len:Se._depth}),transFn:Sr})})}else Se.title.hasOwnProperty("standoff")&&Xn.push(function(){Se._depth=Vn[4]*(Br()[Se.side]-Mr)});var li=M.getComponentMethod("rangeslider","isVisible")(Se);return Xn.push(function(){var Ht=Se.side.charAt(0),hr=re[Se.side].charAt(0),rn=j.getPxPosition(Ce,Se),vn=Ir?Se.ticklen:0,en,Tn,xn,un;if((Se.automargin||li)&&(Se.type==="multicategory"?en=Br("tick2"):(en=Br(),Yt==="x"&&Ht==="b"&&(Se._depth=Math.max(en.width>0?en.bottom-rn:0,vn)))),Se.automargin){Tn={x:0,y:0,r:0,l:0,t:0,b:0};var yr=[0,1];if(Yt==="x"){if(Ht==="b"?Tn[Ht]=Se._depth:(Tn[Ht]=Se._depth=Math.max(en.width>0?rn-en.top:0,vn),yr.reverse()),en.width>0){var mr=en.right-(Se._offset+Se._length);mr>0&&(Tn.xr=1,Tn.r=mr);var zr=Se._offset-en.left;zr>0&&(Tn.xl=0,Tn.l=zr)}}else if(Ht==="l"?Tn[Ht]=Se._depth=Math.max(en.height>0?rn-en.left:0,vn):(Tn[Ht]=Se._depth=Math.max(en.height>0?en.right-rn:0,vn),yr.reverse()),en.height>0){var gn=en.bottom-(Se._offset+Se._length);gn>0&&(Tn.yb=0,Tn.b=gn);var On=Se._offset-en.top;On>0&&(Tn.yt=1,Tn.t=On)}Tn[ar]=Se.anchor==="free"?Se.position:Se._anchorAxis.domain[yr[0]],Se.title.text!==gt._dfltTitle[Yt]&&(Tn[Ht]+=Wt(Se)+(Se.title.standoff||0)),Se.mirror&&Se.anchor!=="free"&&(xn={x:0,y:0,r:0,l:0,t:0,b:0},xn[hr]=Se.linewidth,Se.mirror&&Se.mirror!==!0&&(xn[hr]+=vn),Se.mirror===!0||Se.mirror==="ticks"?xn[ar]=Se._anchorAxis.domain[yr[1]]:(Se.mirror==="all"||Se.mirror==="allticks")&&(xn[ar]=[Se._counterDomainMin,Se._counterDomainMax][yr[1]]))}li&&(un=M.getComponentMethod("rangeslider","autoMarginOpts")(Ce,Se)),typeof Se.automargin=="string"&&(Ne(Tn,Se.automargin),Ne(xn,Se.automargin)),S.autoMargin(Ce,at(Se),Tn),S.autoMargin(Ce,$t(Se),xn),S.autoMargin(Ce,Jt(Se),un)}),!nt.skipTitle&&!(li&&Se.side==="bottom")&&Xn.push(function(){return Vt(Ce,Se)}),e.syncOrAsync(Xn)}};function Ne(Ce,Se){if(Ce){var nt=Object.keys(N).reduce(function(it,ct){return Se.indexOf(ct)!==-1&&N[ct].forEach(function(kt){it[kt]=1}),it},{});Object.keys(Ce).forEach(function(it){nt[it]||(it.length===1?Ce[it]=0:delete Ce[it])})}}function Ze(Ce,Se){var nt=[],it,ct=function(kt,gt){var St=kt.xbnd[gt];St!==null&&nt.push(e.extendFlat({},kt,{x:St}))};if(Se.length){for(it=0;it<Se.length;it++)ct(Se[it],0);ct(Se[it-1],1)}return nt}function Qe(Ce,Se){for(var nt=[],it={},ct=0;ct<Se.length;ct++){var kt=Se[ct];it[kt.text2]?it[kt.text2].push(kt.x):it[kt.text2]=[kt.x]}for(var gt in it)nt.push(vt(Ce,e.interp(it[gt],.5),gt));return nt}function bt(Ce,Se){var nt=[],it,ct,kt=Se.length&&Se[Se.length-1].x<Se[0].x,gt=function(Yt,ar){var kr=Yt.xbnd[ar];kr!==null&&nt.push(e.extendFlat({},Yt,{x:kr}))};if(Ce.showdividers&&Se.length){for(it=0;it<Se.length;it++){var St=Se[it];St.text2!==ct&&gt(St,kt?1:0),ct=St.text2}gt(Se[it-1],kt?0:1)}return nt}function dt(Ce,Se){var nt,it,ct,kt;return Ce._selections[Se].size()?(nt=1/0,it=-1/0,ct=1/0,kt=-1/0,Ce._selections[Se].each(function(){var gt=jr(this),St=h.bBox(gt.node().parentNode);nt=Math.min(nt,St.top),it=Math.max(it,St.bottom),ct=Math.min(ct,St.left),kt=Math.max(kt,St.right)})):(nt=0,it=0,ct=0,kt=0),{top:nt,bottom:it,left:ct,right:kt,height:it-nt,width:kt-ct}}j.getTickSigns=function(Ce,Se){var nt=Ce._id.charAt(0),it={x:"top",y:"right"}[nt],ct=Ce.side===it?1:-1,kt=[-1,1,ct,-ct],gt=Se?(Ce.minor||{}).ticks:Ce.ticks;return gt!=="inside"==(nt==="x")&&(kt=kt.map(function(St){return-St})),Ce.side&&kt.push({l:-1,t:-1,r:1,b:1}[Ce.side.charAt(0)]),kt},j.makeTransTickFn=function(Ce){return Ce._id.charAt(0)==="x"?function(Se){return a(Ce._offset+Ce.l2p(Se.x),0)}:function(Se){return a(0,Ce._offset+Ce.l2p(Se.x))}},j.makeTransTickLabelFn=function(Ce){var Se=Ut(Ce),nt=Se[0],it=Se[1];return Ce._id.charAt(0)==="x"?function(ct){return a(nt+Ce._offset+Ce.l2p(wt(ct)),it)}:function(ct){return a(it,nt+Ce._offset+Ce.l2p(wt(ct)))}};function wt(Ce){return Ce.periodX!==void 0?Ce.periodX:Ce.x}function Ut(Ce){var Se=Ce.ticklabelposition||"",nt=function(Yr){return Se.indexOf(Yr)!==-1},it=nt("top"),ct=nt("left"),kt=nt("right"),gt=nt("bottom"),St=nt("inside"),Yt=gt||ct||it||kt;if(!Yt&&!St)return[0,0];var ar=Ce.side,kr=Yt?(Ce.tickwidth||0)/2:0,br=ue,Mr=Ce.tickfont?Ce.tickfont.size:12;return(gt||it)&&(kr+=Mr*W,br+=(Ce.linewidth||0)/2),(ct||kt)&&(kr+=(Ce.linewidth||0)/2,br+=ue),St&&ar==="top"&&(br-=Mr*(1-W)),(ct||it)&&(kr=-kr),(ar==="bottom"||ar==="right")&&(br=-br),[Yt?kr:0,St?br:0]}j.makeTickPath=function(Ce,Se,nt,it){it||(it={});var ct=it.minor;if(ct&&!Ce.minor)return"";var kt=it.len!==void 0?it.len:ct?Ce.minor.ticklen:Ce.ticklen,gt=Ce._id.charAt(0),St=(Ce.linewidth||1)/2;return gt==="x"?"M0,"+(Se+St*nt)+"v"+kt*nt:"M"+(Se+St*nt)+",0h"+kt*nt},j.makeLabelFns=function(Ce,Se,nt){var it=Ce.ticklabelposition||"",ct=function(wn){return it.indexOf(wn)!==-1},kt=ct("top"),gt=ct("left"),St=ct("right"),Yt=ct("bottom"),ar=Yt||gt||kt||St,kr=ct("inside"),br=it==="inside"&&Ce.ticks==="inside"||!kr&&Ce.ticks==="outside"&&Ce.tickson!=="boundaries",Mr=0,Yr=0,nr=br?Ce.ticklen:0;if(kr?nr*=-1:ar&&(nr=0),br&&(Mr+=nr,nt)){var gr=e.deg2rad(nt);Mr=nr*Math.cos(gr)+1,Yr=nr*Math.sin(gr)}Ce.showticklabels&&(br||Ce.showline)&&(Mr+=.2*Ce.tickfont.size),Mr+=(Ce.linewidth||1)/2*(kr?-1:1);var Rr={labelStandoff:Mr,labelShift:Yr},Br,Sr,et,Lt,Zt=0,or=Ce.side,Ir=Ce._id.charAt(0),Or=Ce.tickangle,Er;if(Ir==="x")Er=!kr&&or==="bottom"||kr&&or==="top",Lt=Er?1:-1,kr&&(Lt*=-1),Br=Yr*Lt,Sr=Se+Mr*Lt,et=Er?1:-.2,Math.abs(Or)===90&&(kr?et+=K:Or===-90&&or==="bottom"?et=W:Or===90&&or==="top"?et=K:et=.5,Zt=K/2*(Or/90)),Rr.xFn=function(wn){return wn.dx+Br+Zt*wn.fontSize},Rr.yFn=function(wn){return wn.dy+Sr+wn.fontSize*et},Rr.anchorFn=function(wn,cn){if(ar){if(gt)return"end";if(St)return"start"}return!g(cn)||cn===0||cn===180?"middle":cn*Lt<0!==kr?"end":"start"},Rr.heightFn=function(wn,cn,Bn){return cn<-60||cn>60?-.5*Bn:Ce.side==="top"!==kr?-Bn:0};else if(Ir==="y"){if(Er=!kr&&or==="left"||kr&&or==="right",Lt=Er?1:-1,kr&&(Lt*=-1),Br=Mr,Sr=Yr*Lt,et=0,!kr&&Math.abs(Or)===90&&(Or===-90&&or==="left"||Or===90&&or==="right"?et=W:et=.5),kr){var wr=g(Or)?+Or:0;if(wr!==0){var Gr=e.deg2rad(wr);Zt=Math.abs(Math.sin(Gr))*W*Lt,et=0}}Rr.xFn=function(wn){return wn.dx+Se-(Br+wn.fontSize*et)*Lt+Zt*wn.fontSize},Rr.yFn=function(wn){return wn.dy+Sr+wn.fontSize*K},Rr.anchorFn=function(wn,cn){return g(cn)&&Math.abs(cn)===90?"middle":Er?"end":"start"},Rr.heightFn=function(wn,cn,Bn){return Ce.side==="right"&&(cn*=-1),cn<-30?-Bn:cn<30?-.5*Bn:0}}return Rr};function Rt(Ce){return[Ce.text,Ce.x,Ce.axInfo,Ce.font,Ce.fontSize,Ce.fontColor].join("_")}j.drawTicks=function(Ce,Se,nt){nt=nt||{};var it=Se._id+"tick",ct=[].concat(Se.minor&&Se.minor.ticks?nt.vals.filter(function(gt){return gt.minor&&!gt.noTick}):[]).concat(Se.ticks?nt.vals.filter(function(gt){return!gt.minor&&!gt.noTick}):[]),kt=nt.layer.selectAll("path."+it).data(ct,Rt);kt.exit().remove(),kt.enter().append("path").classed(it,1).classed("ticks",1).classed("crisp",nt.crisp!==!1).each(function(gt){return t.stroke(A.select(this),gt.minor?Se.minor.tickcolor:Se.tickcolor)}).style("stroke-width",function(gt){return h.crispRound(Ce,gt.minor?Se.minor.tickwidth:Se.tickwidth,1)+"px"}).attr("d",nt.path).style("display",null),zt(Se,[O]),kt.attr("transform",nt.transFn)},j.drawGrid=function(Ce,Se,nt){nt=nt||{};var it=Se._id+"grid",ct=Se.minor&&Se.minor.showgrid,kt=ct?nt.vals.filter(function(Br){return Br.minor}):[],gt=Se.showgrid?nt.vals.filter(function(Br){return!Br.minor}):[],St=nt.counterAxis;if(St&&j.shouldShowZeroLine(Ce,Se,St))for(var Yt=Se.tickmode==="array",ar=0;ar<gt.length;ar++){var kr=gt[ar].x;if(Yt?!kr:Math.abs(kr)<Se.dtick/100)if(gt=gt.slice(0,ar).concat(gt.slice(ar+1)),Yt)ar--;else break}Se._gw=h.crispRound(Ce,Se.gridwidth,1);for(var br=ct?h.crispRound(Ce,Se.minor.gridwidth,1):0,Mr=nt.layer,Yr=nt.minorLayer,nr=1;nr>=0;nr--){var gr=nr?Mr:Yr;if(gr){var Rr=gr.selectAll("path."+it).data(nr?gt:kt,Rt);Rr.exit().remove(),Rr.enter().append("path").classed(it,1).classed("crisp",nt.crisp!==!1),Rr.attr("transform",nt.transFn).attr("d",nt.path).each(function(Br){return t.stroke(A.select(this),Br.minor?Se.minor.gridcolor:Se.gridcolor||"#ddd")}).style("stroke-dasharray",function(Br){return h.dashStyle(Br.minor?Se.minor.griddash:Se.griddash,Br.minor?Se.minor.gridwidth:Se.gridwidth)}).style("stroke-width",function(Br){return(Br.minor?br:Se._gw)+"px"}).style("display",null),typeof nt.path=="function"&&Rr.attr("d",nt.path)}}zt(Se,[D,R])},j.drawZeroLine=function(Ce,Se,nt){nt=nt||nt;var it=Se._id+"zl",ct=j.shouldShowZeroLine(Ce,Se,nt.counterAxis),kt=nt.layer.selectAll("path."+it).data(ct?[{x:0,id:Se._id}]:[]);kt.exit().remove(),kt.enter().append("path").classed(it,1).classed("zl",1).classed("crisp",nt.crisp!==!1).each(function(){nt.layer.selectAll("path").sort(function(gt,St){return U(gt.id,St.id)})}),kt.attr("transform",nt.transFn).attr("d",nt.path).call(t.stroke,Se.zerolinecolor||t.defaultLine).style("stroke-width",h.crispRound(Ce,Se.zerolinewidth,Se._gw||1)+"px").style("display",null),zt(Se,[I])},j.drawLabels=function(Ce,Se,nt){nt=nt||{};var it=Ce._fullLayout,ct=Se._id,kt=ct.charAt(0),gt=nt.cls||ct+"tick",St=nt.vals.filter(function(Lt){return Lt.text}),Yt=nt.labelFns,ar=nt.secondary?0:Se.tickangle,kr=(Se._prevTickAngles||{})[gt],br=nt.layer.selectAll("g."+gt).data(Se.showticklabels?St:[],Rt),Mr=[];br.enter().append("g").classed(gt,1).append("text").attr("text-anchor","middle").each(function(Lt){var Zt=A.select(this),or=Ce._promises.length;Zt.call(n.positionText,Yt.xFn(Lt),Yt.yFn(Lt)).call(h.font,Lt.font,Lt.fontSize,Lt.fontColor).text(Lt.text).call(n.convertToTspans,Ce),Ce._promises[or]?Mr.push(Ce._promises.pop().then(function(){Yr(Zt,ar)})):Yr(Zt,ar)}),zt(Se,[F]),br.exit().remove(),nt.repositionOnUpdate&&br.each(function(Lt){A.select(this).select("text").call(n.positionText,Yt.xFn(Lt),Yt.yFn(Lt))});function Yr(Lt,Zt){Lt.each(function(or){var Ir=A.select(this),Or=Ir.select(".text-math-group"),Er=Yt.anchorFn(or,Zt),wr=nt.transFn.call(Ir.node(),or)+(g(Zt)&&+Zt!=0?" rotate("+Zt+","+Yt.xFn(or)+","+(Yt.yFn(or)-or.fontSize/2)+")":""),Gr=n.lineCount(Ir),wn=Y*or.fontSize,cn=Yt.heightFn(or,g(Zt)?+Zt:0,(Gr-1)*wn);if(cn&&(wr+=a(0,cn)),Or.empty()){var Bn=Ir.select("text");Bn.attr({transform:wr,"text-anchor":Er}),Bn.style("opacity",1),Se._adjustTickLabelsOverflow&&Se._adjustTickLabelsOverflow()}else{var En=h.bBox(Or.node()).width,Yn=En*{end:-.5,start:.5}[Er];Or.attr("transform",wr+a(Yn,0))}})}Se._adjustTickLabelsOverflow=function(){var Lt=Se.ticklabeloverflow;if(!(!Lt||Lt==="allow")){var Zt=Lt.indexOf("hide")!==-1,or=Se._id.charAt(0)==="x",Ir=0,Or=or?Ce._fullLayout.width:Ce._fullLayout.height;if(Lt.indexOf("domain")!==-1){var Er=e.simpleMap(Se.range,Se.r2l);Ir=Se.l2p(Er[0])+Se._offset,Or=Se.l2p(Er[1])+Se._offset}var wr=Math.min(Ir,Or),Gr=Math.max(Ir,Or),wn=Se.side,cn=1/0,Bn=-1/0;br.each(function(pa){var Ma=A.select(this),ci=Ma.select(".text-math-group");if(ci.empty()){var Va=h.bBox(Ma.node()),ja=0;or?(Va.right>Gr||Va.left<wr)&&(ja=1):(Va.bottom>Gr||Va.top+(Se.tickangle?0:pa.fontSize/4)<wr)&&(ja=1);var Wa=Ma.select("text");ja?Zt&&Wa.style("opacity",0):(Wa.style("opacity",1),wn==="bottom"||wn==="right"?cn=Math.min(cn,or?Va.top:Va.left):cn=-1/0,wn==="top"||wn==="left"?Bn=Math.max(Bn,or?Va.bottom:Va.right):Bn=1/0)}});for(var En in it._plots){var Yn=it._plots[En];if(!(Se._id!==Yn.xaxis._id&&Se._id!==Yn.yaxis._id)){var Vn=or?Yn.yaxis:Yn.xaxis;Vn&&(Vn["_visibleLabelMin_"+Se._id]=cn,Vn["_visibleLabelMax_"+Se._id]=Bn)}}}},Se._hideCounterAxisInsideTickLabels=function(Lt){var Zt=Se._id.charAt(0)==="x",or=[];for(var Ir in it._plots){var Or=it._plots[Ir];Se._id!==Or.xaxis._id&&Se._id!==Or.yaxis._id||or.push(Zt?Or.yaxis:Or.xaxis)}or.forEach(function(Er,wr){Er&&Tt(Er)&&(Lt||[I,R,D,O,F]).forEach(function(Gr){var wn=Gr.K==="tick"&&Gr.L==="text"&&Se.ticklabelmode==="period",cn=it._plots[Se._mainSubplot],Bn;Gr.K===I.K?Bn=cn.zerolinelayer.selectAll("."+Se._id+"zl"):Gr.K===R.K?Bn=cn.minorGridlayer.selectAll("."+Se._id):Gr.K===D.K?Bn=cn.gridlayer.selectAll("."+Se._id):Bn=cn[Se._id.charAt(0)+"axislayer"],Bn.each(function(){var En=A.select(this);Gr.L&&(En=En.selectAll(Gr.L)),En.each(function(Yn){var Vn=Se.l2p(wn?wt(Yn):Yn.x)+Se._offset,pa=A.select(this);Vn<Se["_visibleLabelMax_"+Er._id]&&Vn>Se["_visibleLabelMin_"+Er._id]?pa.style("display","none"):Gr.K==="tick"&&!wr&&pa.style("display",null)})})})})},Yr(br,kr+1?kr:ar);function nr(){return Mr.length&&Promise.all(Mr)}var gr=null;function Rr(){if(Yr(br,ar),St.length&&kt==="x"&&!g(ar)&&(Se.type!=="log"||String(Se.dtick).charAt(0)!=="D")){gr=0;var Lt=0,Zt=[],or;if(br.each(function(Va){Lt=Math.max(Lt,Va.fontSize);var ja=Se.l2p(Va.x),Wa=jr(this),Tr=h.bBox(Wa.node());Zt.push({top:0,bottom:10,height:10,left:ja-Tr.width/2,right:ja+Tr.width/2+2,width:Tr.width+2})}),(Se.tickson==="boundaries"||Se.showdividers)&&!nt.secondary){var Ir=2;for(Se.ticks&&(Ir+=Se.tickwidth/2),or=0;or<Zt.length;or++){var Or=St[or].xbnd,Er=Zt[or];if(Or[0]!==null&&Er.left-Se.l2p(Or[0])<Ir||Or[1]!==null&&Se.l2p(Or[1])-Er.right<Ir){gr=90;break}}}else{var wr=St.length,Gr=Math.abs((St[wr-1].x-St[0].x)*Se._m)/(wr-1),wn=Se.ticklabelposition||"",cn=function(Va){return wn.indexOf(Va)!==-1},Bn=cn("top"),En=cn("left"),Yn=cn("right"),Vn=cn("bottom"),pa=Vn||En||Bn||Yn,Ma=pa?(Se.tickwidth||0)+2*ue:0,ci=Gr<Lt*2.5||Se.type==="multicategory"||Se._name==="realaxis";for(or=0;or<Zt.length-1;or++)if(e.bBoxIntersect(Zt[or],Zt[or+1],Ma)){gr=ci?90:30;break}}gr&&Yr(br,gr)}}Se._selections&&(Se._selections[gt]=br);var Br=[nr];Se.automargin&&it._redrawFromAutoMarginCount&&kr===90?(gr=90,Br.push(function(){Yr(br,kr)})):Br.push(Rr),Se._tickAngles&&Br.push(function(){Se._tickAngles[gt]=gr===null?g(ar)?ar:0:gr});var Sr=Se._anchorAxis;Sr&&Sr.autorange&&Tt(Se)&&!$(it,Se._id)&&(it._insideTickLabelsAutorange||(it._insideTickLabelsAutorange={}),it._insideTickLabelsAutorange[Sr._name+".autorange"]=Sr.autorange,Br.push(function(){br.each(function(Zt,or){var Ir=jr(this),Or=Ir.select(".text-math-group");Or.empty()&&(Se._vals[or].bb=h.bBox(Ir.node()))})}));var et=e.syncOrAsync(Br);return et&&et.then&&Ce._promises.push(et),et};function Nt(Ce,Se,nt){var it=Se._id+"divider",ct=nt.vals,kt=nt.layer.selectAll("path."+it).data(ct,Rt);kt.exit().remove(),kt.enter().insert("path",":first-child").classed(it,1).classed("crisp",1).call(t.stroke,Se.dividercolor).style("stroke-width",h.crispRound(Ce,Se.dividerwidth,1)+"px"),kt.attr("transform",nt.transFn).attr("d",nt.path)}j.getPxPosition=function(Ce,Se){var nt=Ce._fullLayout._size,it=Se._id.charAt(0),ct=Se.side,kt;if(Se.anchor!=="free"?kt=Se._anchorAxis:it==="x"?kt={_offset:nt.t+(1-(Se.position||0))*nt.h,_length:0}:it==="y"&&(kt={_offset:nt.l+(Se.position||0)*nt.w,_length:0}),ct==="top"||ct==="left")return kt._offset;if(ct==="bottom"||ct==="right")return kt._offset+kt._length};function Wt(Ce){var Se=Ce.title.font.size,nt=(Ce.title.text.match(n.BR_TAG_ALL)||[]).length;return Ce.title.hasOwnProperty("standoff")?nt?Se*(W+nt*Y):Se*W:nt?Se*(nt+1)*Y:Se}function Vt(Ce,Se){var nt=Ce._fullLayout,it=Se._id,ct=it.charAt(0),kt=Se.title.font.size,gt;if(Se.title.hasOwnProperty("standoff"))gt=Se._depth+Se.title.standoff+Wt(Se);else{var St=Tt(Se);if(Se.type==="multicategory")gt=Se._depth;else{var Yt=1.5*kt;St&&(Yt=.5*kt,Se.ticks==="outside"&&(Yt+=Se.ticklen)),gt=10+Yt+(Se.linewidth?Se.linewidth-1:0)}St||(ct==="x"?gt+=Se.side==="top"?kt*(Se.showticklabels?1:0):kt*(Se.showticklabels?1.5:.5):gt+=Se.side==="right"?kt*(Se.showticklabels?1:.5):kt*(Se.showticklabels?.5:0))}var ar=j.getPxPosition(Ce,Se),kr,br,Mr;ct==="x"?(br=Se._offset+Se._length/2,Mr=Se.side==="top"?ar-gt:ar+gt):(Mr=Se._offset+Se._length/2,br=Se.side==="right"?ar+gt:ar-gt,kr={rotate:"-90",offset:0});var Yr;if(Se.type!=="multicategory"){var nr=Se._selections[Se._id+"tick"];if(Yr={selection:nr,side:Se.side},nr&&nr.node()&&nr.node().parentNode){var gr=h.getTranslate(nr.node().parentNode);Yr.offsetLeft=gr.x,Yr.offsetTop=gr.y}Se.title.hasOwnProperty("standoff")&&(Yr.pad=0)}return r.draw(Ce,it+"title",{propContainer:Se,propName:Se._name+".title.text",placeholder:nt._dfltTitle[ct],avoid:Yr,transform:kr,attributes:{x:br,y:Mr,"text-anchor":"middle"}})}j.shouldShowZeroLine=function(Ce,Se,nt){var it=e.simpleMap(Se.range,Se.r2l);return it[0]*it[1]<=0&&Se.zeroline&&(Se.type==="linear"||Se.type==="-")&&!(Se.rangebreaks&&Se.maskBreaks(0)===z)&&(ir(Se,0)||!Hr(Ce,Se,nt,it)||sn(Ce,Se))},j.clipEnds=function(Ce,Se){return Se.filter(function(nt){return ir(Ce,nt.x)})};function ir(Ce,Se){var nt=Ce.l2p(Se);return nt>1&&nt<Ce._length-1}function Hr(Ce,Se,nt,it){var ct=nt._mainAxis;if(!ct)return;var kt=Ce._fullLayout,gt=Se._id.charAt(0),St=j.counterLetter(Se._id),Yt=Se._offset+(Math.abs(it[0])<Math.abs(it[1])==(gt==="x")?0:Se._length);function ar(nr){if(!nr.showline||!nr.linewidth)return!1;var gr=Math.max((nr.linewidth+Se.zerolinewidth)/2,1);function Rr(et){return typeof et=="number"&&Math.abs(et-Yt)<gr}if(Rr(nr._mainLinePosition)||Rr(nr._mainMirrorPosition))return!0;var Br=nr._linepositions||{};for(var Sr in Br)if(Rr(Br[Sr][0])||Rr(Br[Sr][1]))return!0}var kr=kt._plots[nt._mainSubplot];if(!(kr.mainplotinfo||kr).overlays.length)return ar(nt);for(var br=j.list(Ce,St),Mr=0;Mr<br.length;Mr++){var Yr=br[Mr];if(Yr._mainAxis===ct&&ar(Yr))return!0}}function sn(Ce,Se){for(var nt=Ce._fullData,it=Se._mainSubplot,ct=Se._id.charAt(0),kt=0;kt<nt.length;kt++){var gt=nt[kt];if(gt.visible===!0&&gt.xaxis+gt.yaxis===it&&(M.traceIs(gt,"bar-like")&&gt.orientation==={x:"h",y:"v"}[ct]||gt.fill&&gt.fill.charAt(gt.fill.length-1)===ct))return!0}return!1}function jr(Ce){var Se=A.select(Ce),nt=Se.select(".text-math-group");return nt.empty()?Se.select("text"):nt}j.allowAutoMargin=function(Ce){for(var Se=j.list(Ce,"",!0),nt=0;nt<Se.length;nt++){var it=Se[nt];it.automargin&&(S.allowAutoMargin(Ce,at(it)),it.mirror&&S.allowAutoMargin(Ce,$t(it))),M.getComponentMethod("rangeslider","isVisible")(it)&&S.allowAutoMargin(Ce,Jt(it))}};function at(Ce){return Ce._id+".automargin"}function $t(Ce){return at(Ce)+".mirror"}function Jt(Ce){return Ce._id+".rangeslider"}j.swap=function(Ce,Se){for(var nt=Gt(Ce,Se),it=0;it<nt.length;it++)rt(Ce,nt[it].x,nt[it].y)};function Gt(Ce,Se){var nt=[],it,ct;for(it=0;it<Se.length;it++){var kt=[],gt=Ce._fullData[Se[it]].xaxis,St=Ce._fullData[Se[it]].yaxis;if(!(!gt||!St)){for(ct=0;ct<nt.length;ct++)(nt[ct].x.indexOf(gt)!==-1||nt[ct].y.indexOf(St)!==-1)&&kt.push(ct);if(!kt.length){nt.push({x:[gt],y:[St]});continue}var Yt=nt[kt[0]],ar;if(kt.length>1)for(ct=1;ct<kt.length;ct++)ar=nt[kt[ct]],_r(Yt.x,ar.x),_r(Yt.y,ar.y);_r(Yt.x,[gt]),_r(Yt.y,[St])}}return nt}function _r(Ce,Se){for(var nt=0;nt<Se.length;nt++)Ce.indexOf(Se[nt])===-1&&Ce.push(Se[nt])}function rt(Ce,Se,nt){var it=[],ct=[],kt=Ce.layout,gt,St;for(gt=0;gt<Se.length;gt++)it.push(j.getFromId(Ce,Se[gt]));for(gt=0;gt<nt.length;gt++)ct.push(j.getFromId(Ce,nt[gt]));var Yt=Object.keys(s),ar=["anchor","domain","overlaying","position","side","tickangle","editType"],kr=["linear","log"];for(gt=0;gt<Yt.length;gt++){var br=Yt[gt],Mr=it[0][br],Yr=ct[0][br],nr=!0,gr=!1,Rr=!1;if(!(br.charAt(0)==="_"||typeof Mr=="function"||ar.indexOf(br)!==-1)){for(St=1;St<it.length&&nr;St++){var Br=it[St][br];br==="type"&&kr.indexOf(Mr)!==-1&&kr.indexOf(Br)!==-1&&Mr!==Br?gr=!0:Br!==Mr&&(nr=!1)}for(St=1;St<ct.length&&nr;St++){var Sr=ct[St][br];br==="type"&&kr.indexOf(Yr)!==-1&&kr.indexOf(Sr)!==-1&&Yr!==Sr?Rr=!0:ct[St][br]!==Yr&&(nr=!1)}nr&&(gr&&(kt[it[0]._name].type="linear"),Rr&&(kt[ct[0]._name].type="linear"),Je(kt,br,it,ct,Ce._fullLayout._dfltTitle))}}for(gt=0;gt<Ce._fullLayout.annotations.length;gt++){var et=Ce._fullLayout.annotations[gt];Se.indexOf(et.xref)!==-1&&nt.indexOf(et.yref)!==-1&&e.swapAttrs(kt.annotations[gt],["?"])}}function Je(Ce,Se,nt,it,ct){var kt=e.nestedProperty,gt=kt(Ce[nt[0]._name],Se).get(),St=kt(Ce[it[0]._name],Se).get(),Yt;for(Se==="title"&&(gt&&gt.text===ct.x&&(gt.text=ct.y),St&&St.text===ct.y&&(St.text=ct.x)),Yt=0;Yt<nt.length;Yt++)kt(Ce,nt[Yt]._name+"."+Se).set(St);for(Yt=0;Yt<it.length;Yt++)kt(Ce,it[Yt]._name+"."+Se).set(gt)}function st(Ce){return Ce._id==="angularaxis"}function lt(Ce,Se){for(var nt=Se._rangebreaks.length,it=0;it<nt;it++){var ct=Se._rangebreaks[it];if(Ce>=ct.min&&Ce<ct.max)return ct.max}return Ce}function Tt(Ce){return(Ce.ticklabelposition||"").indexOf("inside")!==-1}function zt(Ce,Se){Tt(Ce._anchorAxis||{})&&Ce._hideCounterAxisInsideTickLabels&&Ce._hideCounterAxisInsideTickLabels(Se)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../constants/numerical").BADNUM,M=g.isArrayOrTypedArray,e=g.isDateTime,a=g.cleanNumber,n=Math.round;ee.exports=function(v,f,d){var o=v,m=d.noMultiCategory;if(M(o)&&!o.length)return"-";if(!m&&x(o))return"multicategory";if(m&&Array.isArray(o[0])){for(var l=[],w=0;w<o.length;w++)if(M(o[w]))for(var _=0;_<o[w].length;_++)l.push(o[w][_]);o=l}if(h(o,f))return"date";var c=d.autotypenumbers!=="strict";return i(o,c)?"category":t(o,c)?"linear":"-"};function r(p,v){return v?A(p):typeof p=="number"}function t(p,v){for(var f=p.length,d=0;d<f;d++)if(r(p[d],v))return!0;return!1}function h(p,v){for(var f=p.length,d=s(f),o=0,m=0,l={},w=0;w<f;w+=d){var _=n(w),c=p[_],b=String(c);l[b]||(l[b]=1,e(c,v)&&o++,A(c)&&m++)}return o>m*2}function s(p){return Math.max(1,(p-1)/1e3)}function i(p,v){for(var f=p.length,d=s(f),o=0,m=0,l={},w=0;w<f;w+=d){var _=n(w),c=p[_],b=String(c);if(!l[b]){l[b]=1;var u=typeof c;u==="boolean"?m++:(v?a(c)!==S:u==="number")?o++:u==="string"&&m++}}return m>o*2}function x(p){return M(p[0])&&M(p[1])}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../registry"),S=y("../../lib"),M=y("../../plot_api/plot_template"),e=y("../array_container_defaults"),a=y("./layout_attributes"),n=y("./tick_value_defaults"),r=y("./tick_mark_defaults"),t=y("./tick_label_defaults"),h=y("./prefix_suffix_defaults"),s=y("./category_order_defaults"),i=y("./line_grid_defaults"),x=y("./set_convert"),p=y("./constants").WEEKDAY_PATTERN,v=y("./constants").HOUR_PATTERN;ee.exports=function(l,w,_,c,b){var u=c.letter,L=c.font||{},T=c.splomStash||{},k=_("visible",!c.visibleDflt),P=w._template||{},z=w.type||P.type||"-",I;if(z==="date"){var D=g.getComponentMethod("calendars","handleDefaults");D(l,w,"calendar",c.calendar),c.noTicklabelmode||(I=_("ticklabelmode"))}var R="";(!c.noTicklabelposition||z==="multicategory")&&(R=S.coerce(l,w,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:I==="period"?["outside","inside"]:u==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),c.noTicklabeloverflow||_("ticklabeloverflow",R.indexOf("inside")!==-1?"hide past domain":z==="category"||z==="multicategory"?"allow":"hide past div"),x(w,b);var O=!w.isValidRange(l.range);O&&c.reverseDflt&&(O="reversed");var F=_("autorange",O);F&&(z==="linear"||z==="-")&&_("rangemode"),_("range"),w.cleanRange(),s(l,w,_,c),z!=="category"&&!c.noHover&&_("hoverformat");var N=_("color"),G=N!==a.color.dflt?N:L.color,K=T.label||b._dfltTitle[u];if(h(l,w,_,z,c),!k)return w;_("title.text",K),S.coerceFont(_,"title.font",{family:L.family,size:S.bigFont(L.size),color:G}),n(l,w,_,z);var W=c.hasMinor;if(W&&(M.newContainer(w,"minor"),n(l,w,_,z,{isMinor:!0})),t(l,w,_,z,c),r(l,w,_,c),W){var Y=c.isMinor;c.isMinor=!0,r(l,w,_,c),c.isMinor=Y}i(l,w,_,{dfltColor:N,bgColor:c.bgColor,showGrid:c.showGrid,hasMinor:W,attributes:a}),W&&!w.minor.ticks&&!w.minor.showgrid&&delete w.minor,(w.showline||w.ticks)&&_("mirror"),c.automargin&&_("automargin");var re=z==="multicategory";if(!c.noTickson&&(z==="category"||re)&&(w.ticks||w.showgrid)){var ue;re&&(ue="boundaries");var j=_("tickson",ue);j==="boundaries"&&delete w.ticklabelposition}if(re){var q=_("showdividers");q&&(_("dividercolor"),_("dividerwidth"))}if(z==="date")if(e(l,w,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:f}),!w.rangebreaks.length)delete w.rangebreaks;else{for(var H=0;H<w.rangebreaks.length;H++)if(w.rangebreaks[H].pattern===p){w._hasDayOfWeekBreaks=!0;break}if(x(w,b),b._has("scattergl")||b._has("splom"))for(var U=0;U<c.data.length;U++){var $=c.data[U];($.type==="scattergl"||$.type==="splom")&&($.visible=!1,S.warn($.type+" traces do not work on axes with rangebreaks. Setting trace "+$.index+" to `visible: false`."))}}return w};function f(m,l,w){function _(I,D){return S.coerce(m,l,a.rangebreaks,I,D)}var c=_("enabled");if(c){var b=_("bounds");if(b&&b.length>=2){var u="",L,T;if(b.length===2){for(L=0;L<2;L++)if(T=o(b[L]),T){u=p;break}}var k=_("pattern",u);if(k===p)for(L=0;L<2;L++)T=o(b[L]),T&&(l.bounds[L]=b[L]=T-1);if(k)for(L=0;L<2;L++)switch(T=b[L],k){case p:if(!A(T)){l.enabled=!1;return}if(T=+T,T!==Math.floor(T)||T<0||T>=7){l.enabled=!1;return}l.bounds[L]=b[L]=T;break;case v:if(!A(T)){l.enabled=!1;return}if(T=+T,T<0||T>24){l.enabled=!1;return}l.bounds[L]=b[L]=T;break}if(w.autorange===!1){var P=w.range;if(P[0]<P[1]){if(b[0]<P[0]&&b[1]>P[1]){l.enabled=!1;return}}else if(b[0]>P[0]&&b[1]<P[1]){l.enabled=!1;return}}}else{var z=_("values");if(z&&z.length)_("dvalue");else{l.enabled=!1;return}}}}var d={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function o(m){if(typeof m=="string")return d[m.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(y,ee,te){var A=y("../../constants/docs"),g=A.FORMAT_LINK,S=A.DATE_FORMAT_LINK;function M(n,r){return{valType:"string",dflt:"",editType:"none",description:(r?e:a)("hover text",n)+["By default the values are formatted using "+(r?"generic number format":"`"+n+"axis.hoverformat`")+"."].join(" ")}}function e(n,r){return["Sets the "+n+" formatting rule"+(r?"for `"+r+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+g+"."].join(" ")}function a(n,r){return e(n,r)+[" And for dates see: "+S+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}ee.exports={axisHoverFormat:M,descriptionOnlyNumbers:e,descriptionWithDates:a}},{"../../constants/docs":486}],570:[function(y,ee,te){var A=y("../../registry"),g=y("./constants");te.id2name=function(e){if(!(typeof e!="string"||!e.match(g.AX_ID_PATTERN))){var a=e.split(" ")[0].substr(1);return a==="1"&&(a=""),e.charAt(0)+"axis"+a}},te.name2id=function(e){if(e.match(g.AX_NAME_PATTERN)){var a=e.substr(5);return a==="1"&&(a=""),e.charAt(0)+a}},te.cleanId=function(e,a,n){var r=/( domain)$/.test(e);if(!(typeof e!="string"||!e.match(g.AX_ID_PATTERN))&&!(a&&e.charAt(0)!==a)&&!(r&&!n)){var t=e.split(" ")[0].substr(1).replace(/^0+/,"");return t==="1"&&(t=""),e.charAt(0)+t+(r&&n?" domain":"")}},te.list=function(M,e,a){var n=M._fullLayout;if(!n)return[];var r=te.listIds(M,e),t=new Array(r.length),h;for(h=0;h<r.length;h++){var s=r[h];t[h]=n[s.charAt(0)+"axis"+s.substr(1)]}if(!a){var i=n._subplots.gl3d||[];for(h=0;h<i.length;h++){var x=n[i[h]];e?t.push(x[e+"axis"]):t.push(x.xaxis,x.yaxis,x.zaxis)}}return t},te.listIds=function(M,e){var a=M._fullLayout;if(!a)return[];var n=a._subplots;return e?n[e+"axis"]:n.xaxis.concat(n.yaxis)},te.getFromId=function(M,e,a){var n=M._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),a==="x"?e=e.replace(/y[0-9]*/,""):a==="y"&&(e=e.replace(/x[0-9]*/,"")),n[te.id2name(e)]},te.getFromTrace=function(M,e,a){var n=M._fullLayout,r=null;if(A.traceIs(e,"gl3d")){var t=e.scene;t.substr(0,5)==="scene"&&(r=n[t][a+"axis"])}else r=te.getFromId(M,e[a+"axis"]||a);return r},te.idSort=function(M,e){var a=M.charAt(0),n=e.charAt(0);return a!==n?a>n?1:-1:+(M.substr(1)||1)-+(e.substr(1)||1)},te.ref2id=function(M){return/^[xyz]/.test(M)?M.split(" ")[0]:!1};function S(M,e){if(e&&e.length){for(var a=0;a<e.length;a++)if(e[a][M])return!0}return!1}te.isLinked=function(M,e){return S(e,M._axisMatchGroups)||S(e,M._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(y,ee,te){function A(g,S){var M=S.dataAttr||g._id.charAt(0),e={},a,n,r;if(S.axData)a=S.axData;else for(a=[],n=0;n<S.data.length;n++){var t=S.data[n];t[M+"axis"]===g._id&&a.push(t)}for(n=0;n<a.length;n++){var h=a[n][M];for(r=0;r<h.length;r++){var s=h[r];s!=null&&(e[s]=1)}}return Object.keys(e)}ee.exports=function(S,M,e,a){if(M.type==="category"){var n=S.categoryarray,r=Array.isArray(n)&&n.length>0,t;r&&(t="array");var h=e("categoryorder",t),s;h==="array"&&(s=e("categoryarray")),!r&&h==="array"&&(h=M.categoryorder="trace"),h==="trace"?M._initialCategories=[]:h==="array"?M._initialCategories=s.slice():(s=A(M,a).sort(),h==="category ascending"?M._initialCategories=s:h==="category descending"&&(M._initialCategories=s.reverse()))}}},{}],572:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../constants/numerical"),M=S.ONEDAY,e=S.ONEWEEK;te.dtick=function(a,n){var r=n==="log",t=n==="date",h=n==="category",s=t?M:1;if(!a)return s;if(A(a))return a=Number(a),a<=0?s:h?Math.max(1,Math.round(a)):t?Math.max(.1,a):a;if(typeof a!="string"||!(t||r))return s;var i=a.charAt(0),x=a.substr(1);return x=A(x)?Number(x):0,x<=0||!(t&&i==="M"&&x===Math.round(x)||r&&i==="L"||r&&i==="D"&&(x===1||x===2))?s:a},te.tick0=function(a,n,r,t){if(n==="date")return g.cleanDate(a,g.dateTick0(r,t%e===0?1:0));if(!(t==="D1"||t==="D2"))return A(a)?Number(a):0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(y,ee,te){var A=y("../../lib/regex").counter;ee.exports={idRegex:{x:A("x","( domain)?"),y:A("y","( domain)?")},attrRegex:A("[xy]axis"),xAxisMatch:A("xaxis"),yAxisMatch:A("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(y,ee,te){var A=y("../../lib"),g=y("./autorange"),S=y("./axis_ids").id2name,M=y("./layout_attributes"),e=y("./scale_zoom"),a=y("./set_convert"),n=y("../../constants/numerical").ALMOST_EQUAL,r=y("../../constants/alignment").FROM_BL;te.handleDefaults=function(f,d,o){var m=o.axIds,l=o.axHasImage,w=d._axisConstraintGroups=[],_=d._axisMatchGroups=[],c,b,u,L,T,k,P,z;for(c=0;c<m.length;c++)L=S(m[c]),T=f[L],k=d[L],t(T,k,{axIds:m,layoutOut:d,hasImage:l[L]});function I(Y,re){for(c=0;c<Y.length;c++){b=Y[c];for(u in b)d[S(u)][re]=b}}for(I(_,"_matchGroup"),c=0;c<w.length;c++){b=w[c];for(u in b)if(k=d[S(u)],k.fixedrange){for(var D in b){var R=S(D);(f[R]||{}).fixedrange===!1&&A.warn("fixedrange was specified as false for axis "+R+" but was overridden because another axis in its constraint group has fixedrange true"),d[R].fixedrange=!0}break}}for(c=0;c<w.length;){b=w[c];for(u in b){k=d[S(u)],k._matchGroup&&Object.keys(k._matchGroup).length===Object.keys(b).length&&(w.splice(c,1),c--);break}c++}I(w,"_constraintGroup");var O=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],F=!1,N=!1;function G(){z=k[P],P==="rangebreaks"&&(N=k._hasDayOfWeekBreaks)}for(c=0;c<_.length;c++){b=_[c];for(var K=0;K<O.length;K++){P=O[K],z=null;var W;for(u in b)if(L=S(u),T=f[L],k=d[L],P in k){if(!k.matches&&(W=k,P in T)){G();break}z===null&&P in T&&G()}if(P==="range"&&z&&(F=!0),P==="autorange"&&z===null&&F&&(z=!1),z===null&&P in W&&(z=W[P]),z!==null)for(u in b)k=d[S(u)],k[P]=P==="range"?z.slice():z,P==="rangebreaks"&&(k._hasDayOfWeekBreaks=N,a(k,d))}}};function t(f,d,o){var m=o.axIds,l=o.layoutOut,w=o.hasImage,_=l._axisConstraintGroups,c=l._axisMatchGroups,b=d._id,u=b.charAt(0),L=((l._splomAxes||{})[u]||{})[b]||{},T=d._id,k=T.charAt(0)==="x";d._matchGroup=null,d._constraintGroup=null;function P(q,H){return A.coerce(f,d,M,q,H)}P("constrain",w?"domain":"range"),A.coerce(f,d,{constraintoward:{valType:"enumerated",values:k?["left","center","right"]:["bottom","middle","top"],dflt:k?"center":"middle"}},"constraintoward");var z=d.type,I,D,R=[];for(I=0;I<m.length;I++)if(D=m[I],D!==T){var O=l[S(D)];O.type===z&&R.push(D)}var F=s(_,T);if(F){var N=[];for(I=0;I<R.length;I++)D=R[I],F[D]||N.push(D);R=N}var G=R.length,K,W;G&&(f.matches||L.matches)&&(K=A.coerce(f,d,{matches:{valType:"enumerated",values:R,dflt:R.indexOf(L.matches)!==-1?L.matches:void 0}},"matches"));var Y=w&&!k?d.anchor:void 0;if(G&&!K&&(f.scaleanchor||Y)&&(W=A.coerce(f,d,{scaleanchor:{valType:"enumerated",values:R}},"scaleanchor",Y)),K){d._matchGroup=i(c,T,K,1);var re=l[S(K)],ue=h(l,d)/h(l,re);k!==(K.charAt(0)==="x")&&(ue=(k?"x":"y")+ue),i(_,T,K,ue)}else f.matches&&m.indexOf(f.matches)!==-1&&A.warn("ignored "+d._name+'.matches: "'+f.matches+'" to avoid an infinite loop');if(W){var j=P("scaleratio");j||(j=d.scaleratio=1),i(_,T,W,j)}else f.scaleanchor&&m.indexOf(f.scaleanchor)!==-1&&A.warn("ignored "+d._name+'.scaleanchor: "'+f.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function h(f,d){var o=d.domain;return o||(o=f[S(d.overlaying)].domain),o[1]-o[0]}function s(f,d){for(var o=0;o<f.length;o++)if(f[o][d])return f[o];return null}function i(f,d,o,m){var l,w,_,c,b,u=s(f,d);u===null?(u={},u[d]=1,b=f.length,f.push(u)):b=f.indexOf(u);var L=Object.keys(u);for(l=0;l<f.length;l++)if(_=f[l],l!==b&&_[o]){var T=_[o];for(w=0;w<L.length;w++)c=L[w],_[c]=x(T,x(m,u[c]));f.splice(b,1);return}if(m!==1)for(w=0;w<L.length;w++){var k=L[w];u[k]=x(m,u[k])}u[o]=1}function x(f,d){var o="",m="",l,w;typeof f=="string"&&(o=f.match(/^[xy]*/)[0],l=o.length,f=+f.substr(l)),typeof d=="string"&&(m=d.match(/^[xy]*/)[0],w=m.length,d=+d.substr(w));var _=f*d;return!l&&!w?_:!l||!w||o.charAt(0)===m.charAt(0)?o+m+f*d:l===w?_:(l>w?o.substr(w):m.substr(l))+_}function p(f,d){for(var o=d._size,m=o.h/o.w,l={},w=Object.keys(f),_=0;_<w.length;_++){var c=w[_],b=f[c];if(typeof b=="string"){var u=b.match(/^[xy]*/)[0],L=u.length;b=+b.substr(L);for(var T=u.charAt(0)==="y"?m:1/m,k=0;k<L;k++)b*=T}l[c]=b}return l}te.enforce=function(d){var o=d._fullLayout,m=o._axisConstraintGroups||[],l,w,_,c,b,u,L,T;for(l=0;l<m.length;l++){_=p(m[l],o);var k=Object.keys(_),P=1/0,z=0,I=1/0,D={},R={},O=!1;for(w=0;w<k.length;w++)c=k[w],R[c]=b=o[S(c)],b._inputDomain?b.domain=b._inputDomain.slice():b._inputDomain=b.domain.slice(),b._inputRange||(b._inputRange=b.range.slice()),b.setScale(),D[c]=u=Math.abs(b._m)/_[c],P=Math.min(P,u),(b.constrain==="domain"||!b._constraintShrinkable)&&(I=Math.min(I,u)),delete b._constraintShrinkable,z=Math.max(z,u),b.constrain==="domain"&&(O=!0);if(!(P>n*z&&!O)){for(w=0;w<k.length;w++)if(c=k[w],u=D[c],b=R[c],L=b.constrain,u!==I||L==="domain")if(T=u/I,L==="range")e(b,T);else{var F=b._inputDomain,N=(b.domain[1]-b.domain[0])/(F[1]-F[0]),G=(b.r2l(b.range[1])-b.r2l(b.range[0]))/(b.r2l(b._inputRange[1])-b.r2l(b._inputRange[0]));if(T/=N,T*G<1){b.domain=b._input.domain=F.slice(),e(b,T);continue}if(G<1&&(b.range=b._input.range=b._inputRange.slice(),T*=G),b.autorange){var K=b.r2l(b.range[0]),W=b.r2l(b.range[1]),Y=(K+W)/2,re=Y,ue=Y,j=Math.abs(W-Y),q=Y-j*T*1.0001,H=Y+j*T*1.0001,U=g.makePadFn(o,b,0),$=g.makePadFn(o,b,1);v(b,T);var ne=Math.abs(b._m),X=g.concatExtremes(d,b),Q=X.min,ie=X.max,se,ae;for(ae=0;ae<Q.length;ae++)se=Q[ae].val-U(Q[ae])/ne,se>q&&se<re&&(re=se);for(ae=0;ae<ie.length;ae++)se=ie[ae].val+$(ie[ae])/ne,se<H&&se>ue&&(ue=se);var oe=(ue-re)/(2*j);T/=oe,re=b.l2r(re),ue=b.l2r(ue),b.range=b._input.range=K<W?[re,ue]:[ue,re]}v(b,T)}}}},te.getAxisGroup=function(d,o){for(var m=d._axisMatchGroups,l=0;l<m.length;l++){var w=m[l];if(w[o])return"g"+l}return o},te.clean=function(d,o){if(o._inputDomain){for(var m=!1,l=o._id,w=d._fullLayout._axisConstraintGroups,_=0;_<w.length;_++)if(w[_][l]){m=!0;break}(!m||o.constrain!=="domain")&&(o._input.domain=o.domain=o._inputDomain,delete o._inputDomain)}};function v(f,d){var o=f._inputDomain,m=r[f.constraintoward],l=o[0]+(o[1]-o[0])*m;f.domain=f._input.domain=[l+(o[0]-l)/d,l+(o[1]-l)/d],f.setScale()}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=g.numberFormat,M=y("tinycolor2"),e=y("has-passive-events"),a=y("../../registry"),n=g.strTranslate,r=y("../../lib/svg_text_utils"),t=y("../../components/color"),h=y("../../components/drawing"),s=y("../../components/fx"),i=y("./axes"),x=y("../../lib/setcursor"),p=y("../../components/dragelement"),v=y("../../components/dragelement/helpers"),f=v.selectingOrDrawing,d=v.freeMode,o=y("../../constants/alignment").FROM_TL,m=y("../../lib/clear_gl_canvases"),l=y("../../plot_api/subroutines").redrawReglTraces,w=y("../plots"),_=y("./axis_ids").getFromId,c=y("../../components/selections").prepSelect,b=y("../../components/selections").clearOutline,u=y("../../components/selections").selectOnClick,L=y("./scale_zoom"),T=y("./constants"),k=T.MINDRAG,P=T.MINZOOM,z=!0;function I(se,ae,oe,be,ce,de,ye,ge){var me=se._fullLayout._zoomlayer,Ee=ye+ge==="nsew",Pe=(ye+ge).length===1,Ue,we,ke,Xe,Ve,Ie,De,Ye,vt,Dt,Kt,Ft,Mt,Xt,It,At,Ge,tt,He,Ae,Ne,Ze,Qe;function bt(){if(Ue=ae.xaxis,we=ae.yaxis,vt=Ue._length,Dt=we._length,De=Ue._offset,Ye=we._offset,ke={},ke[Ue._id]=Ue,Xe={},Xe[we._id]=we,ye&&ge)for(var br=ae.overlays,Mr=0;Mr<br.length;Mr++){var Yr=br[Mr].xaxis;ke[Yr._id]=Yr;var nr=br[Mr].yaxis;Xe[nr._id]=nr}Ve=ie(ke),Ie=ie(Xe),Mt=O(Ve,ge),Xt=O(Ie,ye),It=!Xt&&!Mt,Ft=X(se,se._fullLayout._axisMatchGroups,ke,Xe),Kt=X(se,se._fullLayout._axisConstraintGroups,ke,Xe,Ft);var gr=Kt.isSubplotConstrained||Ft.isSubplotConstrained;At=ge||gr,Ge=ye||gr;var Rr=se._fullLayout;tt=Rr._has("scattergl"),He=Rr._has("splom"),Ae=Rr._has("svg")}bt();var dt=W(Xt+Mt,se._fullLayout.dragmode,Ee),wt=R(ae,ye+ge+"drag",dt,oe,be,ce,de);if(It&&!Ee)return wt.onmousedown=null,wt.style.pointerEvents="none",wt;var Ut={element:wt,gd:se,plotinfo:ae};Ut.prepFn=function(br,Mr,Yr){var nr=Ut.dragmode,gr=se._fullLayout.dragmode;gr!==nr&&(Ut.dragmode=gr),bt(),Ze=se._fullLayout._invScaleX,Qe=se._fullLayout._invScaleY,It||(Ee?br.shiftKey?gr==="pan"?gr="zoom":f(gr)||(gr="pan"):br.ctrlKey&&(gr="pan"):gr="pan"),d(gr)?Ut.minDrag=1:Ut.minDrag=void 0,f(gr)?(Ut.xaxes=Ve,Ut.yaxes=Ie,c(br,Mr,Yr,Ut,gr)):(Ut.clickFn=Nt,f(nr)&&Rt(),It||(gr==="zoom"?(Ut.moveFn=rt,Ut.doneFn=st,Ut.minDrag=1,_r(br,Mr,Yr)):gr==="pan"&&(Ut.moveFn=nt,Ut.doneFn=gt))),se._fullLayout._redrag=function(){var Rr=se._dragdata;if(Rr&&Rr.element===wt){var Br=se._fullLayout.dragmode;f(Br)||(bt(),St([0,0,vt,Dt]),Ut.moveFn(Rr.dx,Rr.dy))}}};function Rt(){Ut.plotinfo.selection=!1,b(se)}function Nt(br,Mr){var Yr=Ut.gd;if(Yr._fullLayout._activeShapeIndex>=0){Yr._fullLayout._deactivateShape(Yr);return}var nr=Yr._fullLayout.clickmode;if(q(Yr),br===2&&!Pe&&kt(),Ee)nr.indexOf("select")>-1&&u(Mr,Yr,Ve,Ie,ae.id,Ut),nr.indexOf("event")>-1&&s.click(Yr,Mr,ae.id);else if(br===1&&Pe){var gr=ye?we:Ue,Rr=ye==="s"||ge==="w"?0:1,Br=gr._name+".range["+Rr+"]",Sr=F(gr,Rr),et="left",Lt="middle";if(gr.fixedrange)return;ye?(Lt=ye==="n"?"top":"bottom",gr.side==="right"&&(et="right")):ge==="e"&&(et="right"),Yr._context.showAxisRangeEntryBoxes&&A.select(wt).call(r.makeEditable,{gd:Yr,immediate:!0,background:Yr._fullLayout.paper_bgcolor,text:String(Sr),fill:gr.tickfont?gr.tickfont.color:"#444",horizontalAlign:et,verticalAlign:Lt}).on("edit",function(Zt){var or=gr.d2r(Zt);or!==void 0&&a.call("_guiRelayout",Yr,Br,or)})}}p.init(Ut);var Wt,Vt,ir,Hr,sn,jr,at,$t,Jt,Gt;function _r(br,Mr,Yr){var nr=wt.getBoundingClientRect();Wt=Mr-nr.left,Vt=Yr-nr.top,se._fullLayout._calcInverseTransform(se);var gr=g.apply3DTransform(se._fullLayout._invTransform)(Wt,Vt);Wt=gr[0],Vt=gr[1],ir={l:Wt,r:Wt,w:0,t:Vt,b:Vt,h:0},Hr=se._hmpixcount?se._hmlumcount/se._hmpixcount:M(se._fullLayout.plot_bgcolor).getLuminance(),sn="M0,0H"+vt+"V"+Dt+"H0V0",jr=!1,at="xy",Gt=!1,$t=Y(me,Hr,De,Ye,sn),Jt=re(me,De,Ye)}function rt(br,Mr){if(se._transitioningWithDuration)return!1;var Yr=Math.max(0,Math.min(vt,Ze*br+Wt)),nr=Math.max(0,Math.min(Dt,Qe*Mr+Vt)),gr=Math.abs(Yr-Wt),Rr=Math.abs(nr-Vt);ir.l=Math.min(Wt,Yr),ir.r=Math.max(Wt,Yr),ir.t=Math.min(Vt,nr),ir.b=Math.max(Vt,nr);function Br(){at="",ir.r=ir.l,ir.t=ir.b,Jt.attr("d","M0,0Z")}if(Kt.isSubplotConstrained)gr>P||Rr>P?(at="xy",gr/vt>Rr/Dt?(Rr=gr*Dt/vt,Vt>nr?ir.t=Vt-Rr:ir.b=Vt+Rr):(gr=Rr*vt/Dt,Wt>Yr?ir.l=Wt-gr:ir.r=Wt+gr),Jt.attr("d",ne(ir))):Br();else if(Ft.isSubplotConstrained)if(gr>P||Rr>P){at="xy";var Sr=Math.min(ir.l/vt,(Dt-ir.b)/Dt),et=Math.max(ir.r/vt,(Dt-ir.t)/Dt);ir.l=Sr*vt,ir.r=et*vt,ir.b=(1-Sr)*Dt,ir.t=(1-et)*Dt,Jt.attr("d",ne(ir))}else Br();else!Xt||Rr<Math.min(Math.max(gr*.6,k),P)?gr<k||!Mt?Br():(ir.t=0,ir.b=Dt,at="x",Jt.attr("d",U(ir,Vt))):!Mt||gr<Math.min(Rr*.6,P)?(ir.l=0,ir.r=vt,at="y",Jt.attr("d",$(ir,Wt))):(at="xy",Jt.attr("d",ne(ir)));ir.w=ir.r-ir.l,ir.h=ir.b-ir.t,at&&(Gt=!0),se._dragged=Gt,ue($t,Jt,ir,sn,jr,Hr),Je(),se.emit("plotly_relayouting",Ne),jr=!0}function Je(){Ne={},(at==="xy"||at==="x")&&(N(Ve,ir.l/vt,ir.r/vt,Ne,Kt.xaxes),it("x",Ne)),(at==="xy"||at==="y")&&(N(Ie,(Dt-ir.b)/Dt,(Dt-ir.t)/Dt,Ne,Kt.yaxes),it("y",Ne))}function st(){Je(),q(se),gt(),H(se)}var lt=[0,0,vt,Dt],Tt=null,zt=T.REDRAWDELAY,Ce=ae.mainplot?se._fullLayout._plots[ae.mainplot]:ae;function Se(br){if(!se._context._scrollZoom.cartesian&&!se._fullLayout._enablescrollzoom)return;if(Rt(),se._transitioningWithDuration){br.preventDefault(),br.stopPropagation();return}bt(),clearTimeout(Tt);var Mr=-br.deltaY;if(isFinite(Mr)||(Mr=br.wheelDelta/10),!isFinite(Mr)){g.log("Did not find wheel motion attributes: ",br);return}var Yr=Math.exp(-Math.min(Math.max(Mr,-20),20)/200),nr=Ce.draglayer.select(".nsewdrag").node().getBoundingClientRect(),gr=(br.clientX-nr.left)/nr.width,Rr=(nr.bottom-br.clientY)/nr.height,Br;function Sr(et,Lt,Zt){if(et.fixedrange)return;var or=g.simpleMap(et.range,et.r2l),Ir=or[0]+(or[1]-or[0])*Lt;function Or(Er){return et.l2r(Ir+(Er-Ir)*Zt)}et.range=or.map(Or)}if(At){for(ge||(gr=.5),Br=0;Br<Ve.length;Br++)Sr(Ve[Br],gr,Yr);it("x"),lt[2]*=Yr,lt[0]+=lt[2]*gr*(1/Yr-1)}if(Ge){for(ye||(Rr=.5),Br=0;Br<Ie.length;Br++)Sr(Ie[Br],Rr,Yr);it("y"),lt[3]*=Yr,lt[1]+=lt[3]*(1-Rr)*(1/Yr-1)}St(lt),ct(),se.emit("plotly_relayouting",Ne),Tt=setTimeout(function(){se._fullLayout&&(lt=[0,0,vt,Dt],gt())},zt),br.preventDefault()}ye.length*ge.length!==1&&Q(wt,Se);function nt(br,Mr){if(br=br*Ze,Mr=Mr*Qe,se._transitioningWithDuration)return;if(se._fullLayout._replotting=!0,Mt==="ew"||Xt==="ns"){var Yr=Mt?-br:0,nr=Xt?-Mr:0;if(Ft.isSubplotConstrained){if(Mt&&Xt){var gr=(br/vt-Mr/Dt)/2;br=gr*vt,Mr=-gr*Dt,Yr=-br,nr=-Mr}Xt?Yr=-nr*vt/Dt:nr=-Yr*Dt/vt}Mt&&(G(Ve,br),it("x")),Xt&&(G(Ie,Mr),it("y")),St([Yr,nr,vt,Dt]),ct(),se.emit("plotly_relayouting",Ne);return}function Rr(Or,Er,wr){for(var Gr=1-Er,wn,cn,Bn=0;Bn<Or.length;Bn++){var En=Or[Bn];if(!En.fixedrange){wn=En,cn=En._rl[Gr]+(En._rl[Er]-En._rl[Gr])/K(wr/En._length);var Yn=En.l2r(cn);Yn!==!1&&Yn!==void 0&&(En.range[Er]=Yn)}}return wn._length*(wn._rl[Er]-cn)/(wn._rl[Er]-wn._rl[Gr])}var Br=Mt==="w"==(Xt==="n")?1:-1;if(Mt&&Xt&&(Kt.isSubplotConstrained||Ft.isSubplotConstrained)){var Sr=(br/vt+Br*Mr/Dt)/2;br=Sr*vt,Mr=Br*Sr*Dt}var et,Lt;if(Mt==="w"?br=Rr(Ve,0,br):Mt==="e"?br=Rr(Ve,1,-br):Mt||(br=0),Xt==="n"?Mr=Rr(Ie,1,Mr):Xt==="s"?Mr=Rr(Ie,0,-Mr):Xt||(Mr=0),et=Mt==="w"?br:0,Lt=Xt==="n"?Mr:0,Kt.isSubplotConstrained&&!Ft.isSubplotConstrained||Ft.isSubplotConstrained&&Mt&&Xt&&Br>0){var Zt;if(Ft.isSubplotConstrained||!Mt&&Xt.length===1){for(Zt=0;Zt<Ve.length;Zt++)Ve[Zt].range=Ve[Zt]._r.slice(),L(Ve[Zt],1-Mr/Dt);br=Mr*vt/Dt,et=br/2}if(Ft.isSubplotConstrained||!Xt&&Mt.length===1){for(Zt=0;Zt<Ie.length;Zt++)Ie[Zt].range=Ie[Zt]._r.slice(),L(Ie[Zt],1-br/vt);Mr=br*Dt/vt,Lt=Mr/2}}(!Ft.isSubplotConstrained||!Xt)&&it("x"),(!Ft.isSubplotConstrained||!Mt)&&it("y");var or=vt-br,Ir=Dt-Mr;Ft.isSubplotConstrained&&!(Mt&&Xt)&&(Mt?(Lt=et?0:br*Dt/vt,Ir=or*Dt/vt):(et=Lt?0:Mr*vt/Dt,or=Ir*vt/Dt)),St([et,Lt,or,Ir]),ct(),se.emit("plotly_relayouting",Ne)}function it(br,Mr){for(var Yr=Ft.isSubplotConstrained?{x:Ie,y:Ve}[br]:Ft[br+"axes"],nr=Ft.isSubplotConstrained?{x:Ve,y:Ie}[br]:[],gr=0;gr<Yr.length;gr++){var Rr=Yr[gr],Br=Rr._id,Sr=Ft.xLinks[Br]||Ft.yLinks[Br],et=nr[0]||ke[Sr]||Xe[Sr];et&&(Mr?(Mr[Rr._name+".range[0]"]=Mr[et._name+".range[0]"],Mr[Rr._name+".range[1]"]=Mr[et._name+".range[1]"]):Rr.range=et.range.slice())}}function ct(){var br=[],Mr;function Yr(Rr){for(Mr=0;Mr<Rr.length;Mr++)Rr[Mr].fixedrange||br.push(Rr[Mr]._id)}for(At&&(Yr(Ve),Yr(Kt.xaxes),Yr(Ft.xaxes)),Ge&&(Yr(Ie),Yr(Kt.yaxes),Yr(Ft.yaxes)),Ne={},Mr=0;Mr<br.length;Mr++){var nr=br[Mr],gr=_(se,nr);i.drawOne(se,gr,{skipTitle:!0}),Ne[gr._name+".range[0]"]=gr.range[0],Ne[gr._name+".range[1]"]=gr.range[1]}i.redrawComponents(se,br)}function kt(){if(!se._transitioningWithDuration){var br=se._context.doubleClick,Mr=[];Mt&&(Mr=Mr.concat(Ve)),Xt&&(Mr=Mr.concat(Ie)),Ft.xaxes&&(Mr=Mr.concat(Ft.xaxes)),Ft.yaxes&&(Mr=Mr.concat(Ft.yaxes));var Yr={},nr,gr,Rr;if(br==="reset+autosize"){for(br="autosize",gr=0;gr<Mr.length;gr++)if(nr=Mr[gr],nr._rangeInitial&&(nr.range[0]!==nr._rangeInitial[0]||nr.range[1]!==nr._rangeInitial[1])||!nr._rangeInitial&&!nr.autorange){br="reset";break}}if(br==="autosize")for(gr=0;gr<Mr.length;gr++)nr=Mr[gr],nr.fixedrange||(Yr[nr._name+".autorange"]=!0);else if(br==="reset")for((Mt||Kt.isSubplotConstrained)&&(Mr=Mr.concat(Kt.xaxes)),Xt&&!Kt.isSubplotConstrained&&(Mr=Mr.concat(Kt.yaxes)),Kt.isSubplotConstrained&&(Mt?Xt||(Mr=Mr.concat(Ie)):Mr=Mr.concat(Ve)),gr=0;gr<Mr.length;gr++)nr=Mr[gr],nr.fixedrange||(nr._rangeInitial?(Rr=nr._rangeInitial,Yr[nr._name+".range[0]"]=Rr[0],Yr[nr._name+".range[1]"]=Rr[1]):Yr[nr._name+".autorange"]=!0);se.emit("plotly_doubleclick",null),a.call("_guiRelayout",se,Yr)}}function gt(){St([0,0,vt,Dt]),g.syncOrAsync([w.previousPromises,function(){se._fullLayout._replotting=!1,a.call("_guiRelayout",se,Ne)}],se)}function St(br){var Mr=se._fullLayout,Yr=Mr._plots,nr=Mr._subplots.cartesian,gr,Rr,Br,Sr;if(He&&a.subplotsRegistry.splom.drag(se),tt){for(gr=0;gr<nr.length;gr++)if(Rr=Yr[nr[gr]],Br=Rr.xaxis,Sr=Rr.yaxis,Rr._scene){var et=g.simpleMap(Br.range,Br.r2l),Lt=g.simpleMap(Sr.range,Sr.r2l);Rr._scene.update({range:[et[0],Lt[0],et[1],Lt[1]]})}}if((He||tt)&&(m(se),l(se)),Ae){var Zt=br[2]/Ue._length,or=br[3]/we._length;for(gr=0;gr<nr.length;gr++){Rr=Yr[nr[gr]],Br=Rr.xaxis,Sr=Rr.yaxis;var Ir=(At||Ft.isSubplotConstrained)&&!Br.fixedrange&&ke[Br._id],Or=(Ge||Ft.isSubplotConstrained)&&!Sr.fixedrange&&Xe[Sr._id],Er,wr,Gr,wn;if(Ir?(Er=Zt,Gr=ge||Ft.isSubplotConstrained?br[0]:kr(Br,Er)):Ft.xaHash[Br._id]?(Er=Zt,Gr=br[0]*Br._length/Ue._length):Ft.yaHash[Br._id]?(Er=or,Gr=Xt==="ns"?-br[1]*Br._length/we._length:kr(Br,Er,{n:"top",s:"bottom"}[Xt])):(Er=Yt(Br,Zt,or),Gr=ar(Br,Er)),Or?(wr=or,wn=ye||Ft.isSubplotConstrained?br[1]:kr(Sr,wr)):Ft.yaHash[Sr._id]?(wr=or,wn=br[1]*Sr._length/we._length):Ft.xaHash[Sr._id]?(wr=Zt,wn=Mt==="ew"?-br[0]*Sr._length/Ue._length:kr(Sr,wr,{e:"right",w:"left"}[Mt])):(wr=Yt(Sr,Zt,or),wn=ar(Sr,wr)),!(!Er&&!wr)){Er||(Er=1),wr||(wr=1);var cn=Br._offset-Gr/Er,Bn=Sr._offset-wn/wr;Rr.clipRect.call(h.setTranslate,Gr,wn).call(h.setScale,Er,wr),Rr.plot.call(h.setTranslate,cn,Bn).call(h.setScale,1/Er,1/wr),(Er!==Rr.xScaleFactor||wr!==Rr.yScaleFactor)&&(h.setPointGroupScale(Rr.zoomScalePts,Er,wr),h.setTextPointsScale(Rr.zoomScaleTxt,Er,wr)),h.hideOutsideRangePoints(Rr.clipOnAxisFalseTraces,Rr),Rr.xScaleFactor=Er,Rr.yScaleFactor=wr}}}}function Yt(br,Mr,Yr){return br.fixedrange?0:At&&Kt.xaHash[br._id]?Mr:Ge&&(Kt.isSubplotConstrained?Kt.xaHash:Kt.yaHash)[br._id]?Yr:0}function ar(br,Mr){return Mr?(br.range=br._r.slice(),L(br,Mr),kr(br,Mr)):0}function kr(br,Mr,Yr){return br._length*(1-Mr)*o[Yr||br.constraintoward||"middle"]}return wt}function D(se,ae,oe,be){var ce=g.ensureSingle(se.draglayer,ae,oe,function(de){de.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",se.id)});return ce.call(x,be),ce.node()}function R(se,ae,oe,be,ce,de,ye){var ge=D(se,"rect",ae,oe);return A.select(ge).call(h.setRect,be,ce,de,ye),ge}function O(se,ae){for(var oe=0;oe<se.length;oe++)if(!se[oe].fixedrange)return ae;return""}function F(se,ae){var oe=se.range[ae],be=Math.abs(oe-se.range[1-ae]),ce;return se.type==="date"?oe:se.type==="log"?(ce=Math.ceil(Math.max(0,-Math.log(be)/Math.LN10))+3,S("."+ce+"g")(Math.pow(10,oe))):(ce=Math.floor(Math.log(Math.abs(oe))/Math.LN10)-Math.floor(Math.log(be)/Math.LN10)+4,S("."+String(ce)+"g")(oe))}function N(se,ae,oe,be,ce){for(var de=0;de<se.length;de++){var ye=se[de];if(!ye.fixedrange)if(ye.rangebreaks){var ge=ye._id.charAt(0)==="y",me=ge?1-ae:ae,Ee=ge?1-oe:oe;be[ye._name+".range[0]"]=ye.l2r(ye.p2l(me*ye._length)),be[ye._name+".range[1]"]=ye.l2r(ye.p2l(Ee*ye._length))}else{var Pe=ye._rl[0],Ue=ye._rl[1]-Pe;be[ye._name+".range[0]"]=ye.l2r(Pe+Ue*ae),be[ye._name+".range[1]"]=ye.l2r(Pe+Ue*oe)}}if(ce&&ce.length){var we=(ae+(1-oe))/2;N(ce,we,1-we,be,[])}}function G(se,ae){for(var oe=0;oe<se.length;oe++){var be=se[oe];if(!be.fixedrange)if(be.rangebreaks){var ce=0,de=be._length,ye=be.p2l(ce+ae)-be.p2l(ce),ge=be.p2l(de+ae)-be.p2l(de),me=(ye+ge)/2;be.range=[be.l2r(be._rl[0]-me),be.l2r(be._rl[1]-me)]}else be.range=[be.l2r(be._rl[0]-ae/be._m),be.l2r(be._rl[1]-ae/be._m)]}}function K(se){return 1-(se>=0?Math.min(se,.9):1/(1/Math.max(se,-.3)+3.222))}function W(se,ae,oe){return se?se==="nsew"?oe?"":ae==="pan"?"move":"crosshair":se.toLowerCase()+"-resize":"pointer"}function Y(se,ae,oe,be,ce){return se.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",n(oe,be)).attr("d",ce+"Z")}function re(se,ae,oe){return se.append("path").attr("class","zoombox-corners").style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,opacity:0}).attr("transform",n(ae,oe)).attr("d","M0,0Z")}function ue(se,ae,oe,be,ce,de){se.attr("d",be+"M"+oe.l+","+oe.t+"v"+oe.h+"h"+oe.w+"v-"+oe.h+"h-"+oe.w+"Z"),j(se,ae,ce,de)}function j(se,ae,oe,be){oe||(se.transition().style("fill",be>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function q(se){A.select(se).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function H(se){z&&se.data&&se._context.showTips&&(g.notifier(g._(se,"Double-click to zoom back out"),"long"),z=!1)}function U(se,ae){return"M"+(se.l-.5)+","+(ae-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(se.r+.5)+","+(ae-P-.5)+"h3v"+(2*P+1)+"h-3Z"}function $(se,ae){return"M"+(ae-P-.5)+","+(se.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(ae-P-.5)+","+(se.b+.5)+"v3h"+(2*P+1)+"v-3Z"}function ne(se){var ae=Math.floor(Math.min(se.b-se.t,se.r-se.l,P)/2);return"M"+(se.l-3.5)+","+(se.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(se.r+3.5)+","+(se.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(se.r+3.5)+","+(se.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(se.l-3.5)+","+(se.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function X(se,ae,oe,be,ce){for(var de=!1,ye={},ge={},me,Ee,Pe,Ue,we=(ce||{}).xaHash,ke=(ce||{}).yaHash,Xe=0;Xe<ae.length;Xe++){var Ve=ae[Xe];for(me in oe)if(Ve[me]){for(Pe in Ve)!(ce&&(we[Pe]||ke[Pe]))&&!(Pe.charAt(0)==="x"?oe:be)[Pe]&&(ye[Pe]=me);for(Ee in be)!(ce&&(we[Ee]||ke[Ee]))&&Ve[Ee]&&(de=!0)}for(Ee in be)if(Ve[Ee])for(Ue in Ve)!(ce&&(we[Ue]||ke[Ue]))&&!(Ue.charAt(0)==="x"?oe:be)[Ue]&&(ge[Ue]=Ee)}de&&(g.extendFlat(ye,ge),ge={});var Ie={},De=[];for(Pe in ye){var Ye=_(se,Pe);De.push(Ye),Ie[Ye._id]=Ye}var vt={},Dt=[];for(Ue in ge){var Kt=_(se,Ue);Dt.push(Kt),vt[Kt._id]=Kt}return{xaHash:Ie,yaHash:vt,xaxes:De,yaxes:Dt,xLinks:ye,yLinks:ge,isSubplotConstrained:de}}function Q(se,ae){if(!e)se.onwheel!==void 0?se.onwheel=ae:se.onmousewheel!==void 0?se.onmousewheel=ae:se.isAddedWheelEvent||(se.isAddedWheelEvent=!0,se.addEventListener("wheel",ae,{passive:!1}));else{var oe=se.onwheel!==void 0?"wheel":"mousewheel";se._onwheel&&se.removeEventListener(oe,se._onwheel),se._onwheel=ae,se.addEventListener(oe,ae,{passive:!1})}}function ie(se){var ae=[];for(var oe in se)ae.push(se[oe]);return ae}ee.exports={makeDragBox:I,makeDragger:D,makeRectDragger:R,makeZoombox:Y,makeCorners:re,updateZoombox:ue,xyCorners:ne,transitionZoombox:j,removeZoombox:q,showDoubleClickNotifier:H,attachWheelEventHandler:Q}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/fx"),S=y("../../components/dragelement"),M=y("../../lib/setcursor"),e=y("./dragbox").makeDragBox,a=y("./constants").DRAGGERSIZE;te.initInteractions=function(r){var t=r._fullLayout;if(r._context.staticPlot){A.select(r).selectAll(".drag").remove();return}if(!(!t._has("cartesian")&&!t._has("splom"))){var h=Object.keys(t._plots||{}).sort(function(i,x){if((t._plots[i].mainplot&&!0)===(t._plots[x].mainplot&&!0)){var p=i.split("y"),v=x.split("y");return p[0]===v[0]?Number(p[1]||1)-Number(v[1]||1):Number(p[0]||1)-Number(v[0]||1)}return t._plots[i].mainplot?1:-1});h.forEach(function(i){var x=t._plots[i],p=x.xaxis,v=x.yaxis;if(!x.mainplot){var f=e(r,x,p._offset,v._offset,p._length,v._length,"ns","ew");f.onmousemove=function(m){r._fullLayout._rehover=function(){r._fullLayout._hoversubplot===i&&r._fullLayout._plots[i]&&g.hover(r,m,i)},g.hover(r,m,i),r._fullLayout._lasthover=f,r._fullLayout._hoversubplot=i},f.onmouseout=function(m){r._dragging||(r._fullLayout._hoversubplot=null,S.unhover(r,m))},r._context.showAxisDragHandles&&(e(r,x,p._offset-a,v._offset-a,a,a,"n","w"),e(r,x,p._offset+p._length,v._offset-a,a,a,"n","e"),e(r,x,p._offset-a,v._offset+v._length,a,a,"s","w"),e(r,x,p._offset+p._length,v._offset+v._length,a,a,"s","e"))}if(r._context.showAxisDragHandles){if(i===p._mainSubplot){var d=p._mainLinePosition;p.side==="top"&&(d-=a),e(r,x,p._offset+p._length*.1,d,p._length*.8,a,"","ew"),e(r,x,p._offset,d,p._length*.1,a,"","w"),e(r,x,p._offset+p._length*.9,d,p._length*.1,a,"","e")}if(i===v._mainSubplot){var o=v._mainLinePosition;v.side!=="right"&&(o-=a),e(r,x,o,v._offset+v._length*.1,a,v._length*.8,"ns",""),e(r,x,o,v._offset+v._length*.9,a,v._length*.1,"s",""),e(r,x,o,v._offset,a,v._length*.1,"n","")}}});var s=t._hoverlayer.node();s.onmousemove=function(i){i.target=r._fullLayout._lasthover,g.hover(r,i,t._hoversubplot)},s.onclick=function(i){i.target=r._fullLayout._lasthover,g.click(r,i)},s.onmousedown=function(i){r._fullLayout._lasthover.onmousedown(i)},te.updateFx(r)}},te.updateFx=function(n){var r=n._fullLayout,t=r.dragmode==="pan"?"move":"crosshair";M(r._draggers,t)}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("./axis_ids");ee.exports=function(e){return function(n,r){var t=n[e];if(Array.isArray(t))for(var h=A.subplotsRegistry.cartesian,s=h.idRegex,i=r._subplots,x=i.xaxis,p=i.yaxis,v=i.cartesian,f=r._has("cartesian")||r._has("gl2d"),d=0;d<t.length;d++){var o=t[d];if(g.isPlainObject(o)){var m=S.cleanId(o.xref,"x",!1),l=S.cleanId(o.yref,"y",!1),w=s.x.test(m),_=s.y.test(l);if(w||_){f||g.pushUnique(r._basePlotModules,h);var c=!1;w&&x.indexOf(m)===-1&&(x.push(m),c=!0),_&&p.indexOf(l)===-1&&(p.push(l),c=!0),c&&w&&_&&v.push(m+l)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../registry"),S=y("../../lib"),M=y("../plots"),e=y("../../components/drawing"),a=y("../get_data").getModuleCalcData,n=y("./axis_ids"),r=y("./constants"),t=y("../../constants/xmlns_namespaces"),h=S.ensureSingle;function s(d,o,m){return S.ensureSingle(d,o,m,function(l){l.datum(m)})}te.name="cartesian",te.attr=["xaxis","yaxis"],te.idRoot=["x","y"],te.idRegex=r.idRegex,te.attrRegex=r.attrRegex,te.attributes=y("./attributes"),te.layoutAttributes=y("./layout_attributes"),te.supplyLayoutDefaults=y("./layout_defaults"),te.transitionAxes=y("./transition_axes"),te.finalizeSubplots=function(d,o){var m=o._subplots,l=m.xaxis,w=m.yaxis,_=m.cartesian,c=_.concat(m.gl2d||[]),b={},u={},L,T,k;for(L=0;L<c.length;L++){var P=c[L].split("y");b[P[0]]=1,u["y"+P[1]]=1}for(L=0;L<l.length;L++)T=l[L],b[T]||(k=(d[n.id2name(T)]||{}).anchor,r.idRegex.y.test(k)||(k="y"),_.push(T+k),c.push(T+k),u[k]||(u[k]=1,S.pushUnique(w,k)));for(L=0;L<w.length;L++)k=w[L],u[k]||(T=(d[n.id2name(k)]||{}).anchor,r.idRegex.x.test(T)||(T="x"),_.push(T+k),c.push(T+k),b[T]||(b[T]=1,S.pushUnique(l,T)));if(!c.length){T="",k="";for(var z in d)if(r.attrRegex.test(z)){var I=z.charAt(0);I==="x"?(!T||+z.substr(5)<+T.substr(5))&&(T=z):(!k||+z.substr(5)<+k.substr(5))&&(k=z)}T=T?n.name2id(T):"x",k=k?n.name2id(k):"y",l.push(T),w.push(k),_.push(T+k)}},te.plot=function(d,o,m,l){var w=d._fullLayout,_=w._subplots.cartesian,c=d.calcdata,b;if(!Array.isArray(o))for(o=[],b=0;b<c.length;b++)o.push(b);for(b=0;b<_.length;b++){for(var u=_[b],L=w._plots[u],T=[],k,P=0;P<c.length;P++){var z=c[P],I=z[0].trace;I.xaxis+I.yaxis===u&&((o.indexOf(I.index)!==-1||I.carpet)&&(k&&k[0].trace.xaxis+k[0].trace.yaxis===u&&["tonextx","tonexty","tonext"].indexOf(I.fill)!==-1&&T.indexOf(k)===-1&&T.push(k),T.push(z)),k=z)}i(d,L,T,m,l)}};function i(d,o,m,l,w){for(var _=r.traceLayerClasses,c=d._fullLayout,b=c._modules,u,L,T,k=[],P=[],z=0;z<b.length;z++){u=b[z];var I=u.name,D=g.modules[I].categories;if(D.svg){var R=u.layerName||I+"layer",O=u.plot;L=a(m,O),T=L[0],m=L[1],T.length&&k.push({i:_.indexOf(R),className:R,plotMethod:O,cdModule:T}),D.zoomScale&&P.push("."+R)}}k.sort(function(G,K){return G.i-K.i});var F=o.plot.selectAll("g.mlayer").data(k,function(G){return G.className});if(F.enter().append("g").attr("class",function(G){return G.className}).classed("mlayer",!0).classed("rangeplot",o.isRangePlot),F.exit().remove(),F.order(),F.each(function(G){var K=A.select(this),W=G.className;G.plotMethod(d,o,G.cdModule,K,l,w),r.clipOnAxisFalseQuery.indexOf("."+W)===-1&&e.setClipUrl(K,o.layerClipId,d)}),c._has("scattergl")&&(u=g.getModule("scattergl"),T=a(m,u)[0],u.plot(d,o,T)),!d._context.staticPlot&&(o._hasClipOnAxisFalse&&(o.clipOnAxisFalseTraces=o.plot.selectAll(r.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var N=o.plot.selectAll(P.join(",")).selectAll(".trace");o.zoomScalePts=N.selectAll("path.point"),o.zoomScaleTxt=N.selectAll(".textpoint")}}te.clean=function(d,o,m,l){var w=l._plots||{},_=o._plots||{},c=l._subplots||{},b,u,L;if(l._hasOnlyLargeSploms&&!o._hasOnlyLargeSploms)for(L in w)b=w[L],b.plotgroup&&b.plotgroup.remove();var T=l._has&&l._has("gl"),k=o._has&&o._has("gl");if(T&&!k)for(L in w)b=w[L],b._scene&&b._scene.destroy();if(c.xaxis&&c.yaxis){var P=n.listIds({_fullLayout:l});for(u=0;u<P.length;u++){var z=P[u];o[n.id2name(z)]||l._infolayer.selectAll(".g-"+z+"title").remove()}}var I=l._has&&l._has("cartesian"),D=o._has&&o._has("cartesian");if(I&&!D)v(l._cartesianlayer.selectAll(".subplot"),l),l._defs.selectAll(".axesclip").remove(),delete l._axisConstraintGroups,delete l._axisMatchGroups;else if(c.cartesian)for(u=0;u<c.cartesian.length;u++){var R=c.cartesian[u];if(!_[R]){var O="."+R+",."+R+"-x,."+R+"-y";l._cartesianlayer.selectAll(O).remove(),f(R,l)}}},te.drawFramework=function(d){var o=d._fullLayout,m=x(d),l=o._cartesianlayer.selectAll(".subplot").data(m,String);l.enter().append("g").attr("class",function(w){return"subplot "+w[0]}),l.order(),l.exit().call(v,o),l.each(function(w){var _=w[0],c=o._plots[_];c.plotgroup=A.select(this),p(d,c),c.draglayer=h(o._draggers,"g",_)})},te.rangePlot=function(d,o,m){p(d,o),i(d,o,m),M.style(d)};function x(d){var o=d._fullLayout,m=o._subplots.cartesian,l=m.length,w,_,c,b,u,L,T=[],k=[];for(w=0;w<l;w++){c=m[w],b=o._plots[c],u=b.xaxis,L=b.yaxis;var P=u._mainAxis,z=L._mainAxis,I=P._id+z._id,D=o._plots[I];b.overlays=[],I!==c&&D?(b.mainplot=I,b.mainplotinfo=D,k.push(c)):(b.mainplot=void 0,b.mainplotinfo=void 0,T.push(c))}for(w=0;w<k.length;w++)c=k[w],b=o._plots[c],b.mainplotinfo.overlays.push(b);var R=T.concat(k),O=new Array(l);for(w=0;w<l;w++){c=R[w],b=o._plots[c],u=b.xaxis,L=b.yaxis;var F=[c,u.layer,L.layer,u.overlaying||"",L.overlaying||""];for(_=0;_<b.overlays.length;_++)F.push(b.overlays[_].id);O[w]=F}return O}function p(d,o){var m=o.plotgroup,l=o.id,w=r.layerValue2layerClass[o.xaxis.layer],_=r.layerValue2layerClass[o.yaxis.layer],c=d._fullLayout._hasOnlyLargeSploms;if(o.mainplot){var u=o.mainplotinfo,L=u.plotgroup,T=l+"-x",k=l+"-y";o.minorGridlayer=u.minorGridlayer,o.gridlayer=u.gridlayer,o.zerolinelayer=u.zerolinelayer,h(u.overlinesBelow,"path",T),h(u.overlinesBelow,"path",k),h(u.overaxesBelow,"g",T),h(u.overaxesBelow,"g",k),o.plot=h(u.overplot,"g",l),h(u.overlinesAbove,"path",T),h(u.overlinesAbove,"path",k),h(u.overaxesAbove,"g",T),h(u.overaxesAbove,"g",k),o.xlines=L.select(".overlines-"+w).select("."+T),o.ylines=L.select(".overlines-"+_).select("."+k),o.xaxislayer=L.select(".overaxes-"+w).select("."+T),o.yaxislayer=L.select(".overaxes-"+_).select("."+k)}else if(c)o.xlines=h(m,"path","xlines-above"),o.ylines=h(m,"path","ylines-above"),o.xaxislayer=h(m,"g","xaxislayer-above"),o.yaxislayer=h(m,"g","yaxislayer-above");else{var b=h(m,"g","layer-subplot");o.shapelayer=h(b,"g","shapelayer"),o.imagelayer=h(b,"g","imagelayer"),o.minorGridlayer=h(m,"g","minor-gridlayer"),o.gridlayer=h(m,"g","gridlayer"),o.zerolinelayer=h(m,"g","zerolinelayer"),h(m,"path","xlines-below"),h(m,"path","ylines-below"),o.overlinesBelow=h(m,"g","overlines-below"),h(m,"g","xaxislayer-below"),h(m,"g","yaxislayer-below"),o.overaxesBelow=h(m,"g","overaxes-below"),o.plot=h(m,"g","plot"),o.overplot=h(m,"g","overplot"),o.xlines=h(m,"path","xlines-above"),o.ylines=h(m,"path","ylines-above"),o.overlinesAbove=h(m,"g","overlines-above"),h(m,"g","xaxislayer-above"),h(m,"g","yaxislayer-above"),o.overaxesAbove=h(m,"g","overaxes-above"),o.xlines=m.select(".xlines-"+w),o.ylines=m.select(".ylines-"+_),o.xaxislayer=m.select(".xaxislayer-"+w),o.yaxislayer=m.select(".yaxislayer-"+_)}c||(s(o.minorGridlayer,"g",o.xaxis._id),s(o.minorGridlayer,"g",o.yaxis._id),o.minorGridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort),s(o.gridlayer,"g",o.xaxis._id),s(o.gridlayer,"g",o.yaxis._id),o.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort)),o.xlines.style("fill","none").classed("crisp",!0),o.ylines.style("fill","none").classed("crisp",!0)}function v(d,o){if(d){var m={};d.each(function(u){var L=u[0],T=A.select(this);T.remove(),f(L,o),m[L]=!0});for(var l in o._plots)for(var w=o._plots[l],_=w.overlays||[],c=0;c<_.length;c++){var b=_[c];m[b.id]&&b.plot.selectAll(".trace").remove()}}}function f(d,o){o._draggers.selectAll("g."+d).remove(),o._defs.select("#clip"+o._uid+d+"plot").remove()}te.toSVG=function(d){var o=d._fullLayout._glimages,m=A.select(d).selectAll(".svg-container"),l=m.filter(function(_,c){return c===m.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function w(){var _=this,c=_.toDataURL("image/png"),b=o.append("svg:image");b.attr({xmlns:t.svg,"xlink:href":c,preserveAspectRatio:"none",x:0,y:0,width:_.style.width,height:_.style.height})}l.each(w)},te.updateFx=y("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(y,ee,te){var A=y("../font_attributes"),g=y("../../components/color/attributes"),S=y("../../components/drawing/attributes").dash,M=y("../../lib/extend").extendFlat,e=y("../../plot_api/plot_template").templatedArray,a=y("../../plots/cartesian/axis_format_attributes").descriptionWithDates,n=y("../../constants/numerical").ONEDAY,r=y("./constants"),t=r.HOUR_PATTERN,h=r.WEEKDAY_PATTERN,s={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function i(b){return{valType:"integer",min:0,dflt:b?5:0,editType:"ticks"}}var x={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},p={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},v={valType:"data_array",editType:"ticks"},f={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function d(b){var u={valType:"number",min:0,editType:"ticks"};return b||(u.dflt=5),u}function o(b){var u={valType:"number",min:0,editType:"ticks"};return b||(u.dflt=1),u}var m={valType:"color",dflt:g.defaultLine,editType:"ticks"},l={valType:"color",dflt:g.lightLine,editType:"ticks"};function w(b){var u={valType:"number",min:0,editType:"ticks"};return b||(u.dflt=1),u}var _=M({},S,{editType:"ticks"}),c={valType:"boolean",editType:"ticks"};ee.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:g.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:A({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[h,t,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:n},editType:"calc"}),tickmode:s,nticks:i(),tick0:x,dtick:p,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:v,ticktext:{valType:"data_array",editType:"ticks"},ticks:f,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:d(),tickwidth:o(),tickcolor:m,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:M({},S,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:A({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:a("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:a("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:g.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:c,gridcolor:l,gridwidth:w(),griddash:_,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:g.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:g.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},minor:{tickmode:s,nticks:i("minor"),tick0:x,dtick:p,tickvals:v,ticks:f,ticklen:d("minor"),tickwidth:o("minor"),tickcolor:m,gridcolor:l,gridwidth:w("minor"),griddash:_,showgrid:c,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:A({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color"),S=y("../../components/fx/helpers").isUnifiedHover,M=y("../../components/fx/hovermode_defaults"),e=y("../../plot_api/plot_template"),a=y("../layout_attributes"),n=y("./layout_attributes"),r=y("./type_defaults"),t=y("./axis_defaults"),h=y("./constraints"),s=y("./position_defaults"),i=y("./axis_ids"),x=i.id2name,p=i.name2id,v=y("./constants").AX_ID_PATTERN,f=y("../../registry"),d=f.traceIs,o=f.getComponentMethod;function m(l,w,_){Array.isArray(l[w])?l[w].push(_):l[w]=[_]}ee.exports=function(w,_,c){var b=_.autotypenumbers,u={},L={},T={},k={},P={},z={},I={},D={},R={},O={},F,N;for(F=0;F<c.length;F++){var G=c[F];if(!(!d(G,"cartesian")&&!d(G,"gl2d"))){var K;if(G.xaxis)K=x(G.xaxis),m(u,K,G);else if(G.xaxes)for(N=0;N<G.xaxes.length;N++)m(u,x(G.xaxes[N]),G);var W;if(G.yaxis)W=x(G.yaxis),m(u,W,G);else if(G.yaxes)for(N=0;N<G.yaxes.length;N++)m(u,x(G.yaxes[N]),G);if(G.type==="funnel"?G.orientation==="h"?(K&&(L[K]=!0),W&&(I[W]=!0)):W&&(T[W]=!0):G.type==="image"?(W&&(D[W]=!0),K&&(D[K]=!0)):(W&&(P[W]=!0,z[W]=!0),(!d(G,"carpet")||G.type==="carpet"&&!G._cheater)&&K&&(k[K]=!0)),G.type==="carpet"&&G._cheater&&K&&(L[K]=!0),d(G,"2dMap")&&(R[K]=!0,R[W]=!0),d(G,"oriented")){var Y=G.orientation==="h"?W:K;O[Y]=!0}}}var re=_._subplots,ue=re.xaxis,j=re.yaxis,q=A.simpleMap(ue,x),H=A.simpleMap(j,x),U=q.concat(H),$=g.background;ue.length&&j.length&&($=A.coerce(w,_,a,"plot_bgcolor"));var ne=g.combine($,_.paper_bgcolor),X,Q,ie,se,ae;function oe(){var He=u[X]||[];ae._traceIndices=He.map(function(Ae){return Ae._expandedIndex}),ae._annIndices=[],ae._shapeIndices=[],ae._selectionIndices=[],ae._imgIndices=[],ae._subplotsWith=[],ae._counterAxes=[],ae._name=ae._attr=X,ae._id=Q}function be(He,Ae){return A.coerce(se,ae,n,He,Ae)}function ce(He,Ae){return A.coerce2(se,ae,n,He,Ae)}function de(He){return He==="x"?j:ue}function ye(He,Ae){for(var Ne=He==="x"?q:H,Ze=[],Qe=0;Qe<Ne.length;Qe++){var bt=Ne[Qe];bt!==Ae&&!(w[bt]||{}).overlaying&&Ze.push(p(bt))}return Ze}var ge={x:de("x"),y:de("y")},me=ge.x.concat(ge.y),Ee={},Pe=[];function Ue(){var He=se.matches;v.test(He)&&me.indexOf(He)===-1&&(Ee[He]=se.type,Pe=Object.keys(Ee))}var we=M(w,_),ke=S(we);for(F=0;F<U.length;F++){X=U[F],Q=p(X),ie=X.charAt(0),A.isPlainObject(w[X])||(w[X]={}),se=w[X],ae=e.newContainer(_,X,ie+"axis"),oe();var Xe=ie==="x"&&!k[X]&&L[X]||ie==="y"&&!P[X]&&T[X],Ve=ie==="y"&&(!z[X]&&I[X]||D[X]),Ie={hasMinor:!0,letter:ie,font:_.font,outerTicks:R[X],showGrid:!O[X],data:u[X]||[],bgColor:ne,calendar:_.calendar,automargin:!0,visibleDflt:Xe,reverseDflt:Ve,autotypenumbersDflt:b,splomStash:((_._splomAxes||{})[ie]||{})[Q]};be("uirevision",_.uirevision),r(se,ae,be,Ie),t(se,ae,be,Ie,_);var De=ke&&ie===we.charAt(0),Ye=ce("spikecolor",ke?ae.color:void 0),vt=ce("spikethickness",ke?1.5:void 0),Dt=ce("spikedash",ke?"dot":void 0),Kt=ce("spikemode",ke?"across":void 0),Ft=ce("spikesnap"),Mt=be("showspikes",!!De||!!Ye||!!vt||!!Dt||!!Kt||!!Ft);Mt||(delete ae.spikecolor,delete ae.spikethickness,delete ae.spikedash,delete ae.spikemode,delete ae.spikesnap),s(se,ae,be,{letter:ie,counterAxes:ge[ie],overlayableAxes:ye(ie,X),grid:_.grid}),be("title.standoff"),Ue(),ae._input=se}for(F=0;F<Pe.length;){Q=Pe[F++],X=x(Q),ie=X.charAt(0),A.isPlainObject(w[X])||(w[X]={}),se=w[X],ae=e.newContainer(_,X,ie+"axis"),oe();var Xt={letter:ie,font:_.font,outerTicks:R[X],showGrid:!O[X],data:[],bgColor:ne,calendar:_.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:b,splomStash:((_._splomAxes||{})[ie]||{})[Q]};be("uirevision",_.uirevision),ae.type=Ee[Q]||"linear",t(se,ae,be,Xt,_),s(se,ae,be,{letter:ie,counterAxes:ge[ie],overlayableAxes:ye(ie,X),grid:_.grid}),be("fixedrange"),Ue(),ae._input=se}var It=o("rangeslider","handleDefaults"),At=o("rangeselector","handleDefaults");for(F=0;F<q.length;F++)X=q[F],se=w[X],ae=_[X],It(w,_,X),ae.type==="date"&&At(se,ae,_,H,ae.calendar),be("fixedrange");for(F=0;F<H.length;F++){X=H[F],se=w[X],ae=_[X];var Ge=_[x(ae.anchor)],tt=o("rangeslider","isVisible")(Ge);be("fixedrange",tt)}h.handleDefaults(w,_,{axIds:me.concat(Pe).sort(i.idSort),axHasImage:D})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(y,ee,te){var A=y("tinycolor2").mix,g=y("../../components/color/attributes"),S=y("../../lib");ee.exports=function(e,a,n,r){r=r||{};var t=r.dfltColor;function h(T,k){return S.coerce2(e,a,r.attributes,T,k)}var s=h("linecolor",t),i=h("linewidth"),x=n("showline",r.showLine||!!s||!!i);x||(delete a.linecolor,delete a.linewidth);var p=A(t,r.bgColor,r.blend||g.lightFraction).toRgbString(),v=h("gridcolor",p),f=h("gridwidth"),d=h("griddash"),o=n("showgrid",r.showGrid||!!v||!!f||!!d);if(o||(delete a.gridcolor,delete a.gridwidth,delete a.griddash),r.hasMinor){var m=A(a.gridcolor,r.bgColor,67).toRgbString(),l=h("minor.gridcolor",m),w=h("minor.gridwidth",a.gridwidth||1),_=h("minor.griddash",a.griddash||"solid"),c=n("minor.showgrid",!!l||!!w||!!_);c||(delete a.minor.gridcolor,delete a.minor.gridwidth,delete a.minor.griddash)}if(!r.noZeroLine){var b=h("zerolinecolor",t),u=h("zerolinewidth"),L=n("zeroline",r.showGrid||!!b||!!u);L||(delete a.zerolinecolor,delete a.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib");ee.exports=function(M,e,a,n){var r=n.counterAxes||[],t=n.overlayableAxes||[],h=n.letter,s=n.grid,i,x,p,v;s&&(x=s._domains[h][s._axisMap[e._id]],i=s._anchors[e._id],x&&(p=s[h+"side"].split(" ")[0],v=s.domain[h][p==="right"||p==="top"?1:0])),x=x||[0,1],i=i||(A(M.position)?"free":r[0]||"free"),p=p||(h==="x"?"bottom":"left"),v=v||0;var f=g.coerce(M,e,{anchor:{valType:"enumerated",values:["free"].concat(r),dflt:i}},"anchor");f==="free"&&a("position",v),g.coerce(M,e,{side:{valType:"enumerated",values:h==="x"?["bottom","top"]:["left","right"],dflt:p}},"side");var d=!1;if(t.length&&(d=g.coerce(M,e,{overlaying:{valType:"enumerated",values:[!1].concat(t),dflt:!1}},"overlaying")),!d){var o=a("domain",x);o[0]>o[1]-1/4096&&(e.domain=x),g.noneOrAll(M.domain,e.domain,x)}return a("layer"),e}},{"../../lib":515,"fast-isnumeric":190}],583:[function(y,ee,te){var A=y("./show_dflt");ee.exports=function(S,M,e,a,n){n||(n={});var r=n.tickSuffixDflt,t=A(S),h=e("tickprefix");h&&e("showtickprefix",t);var s=e("ticksuffix",r);s&&e("showticksuffix",t)}},{"./show_dflt":586}],584:[function(y,ee,te){var A=y("../../constants/alignment").FROM_BL;ee.exports=function(S,M,e){e===void 0&&(e=A[S.constraintoward||"center"]);var a=[S.r2l(S.range[0]),S.r2l(S.range[1])],n=a[0]+(a[1]-a[0])*e;S.range=S._input.range=[S.l2r(n+(a[0]-n)*M),S.l2r(n+(a[1]-n)*M)],S.setScale()}},{"../../constants/alignment":483}],585:[function(y,ee,te){var A=y("@plotly/d3"),g=y("d3-time-format").utcFormat,S=y("../../lib"),M=S.numberFormat,e=y("fast-isnumeric"),a=S.cleanNumber,n=S.ms2DateTime,r=S.dateTime2ms,t=S.ensureNumber,h=S.isArrayOrTypedArray,s=y("../../constants/numerical"),i=s.FP_SAFE,x=s.BADNUM,p=s.LOG_CLIP,v=s.ONEWEEK,f=s.ONEDAY,d=s.ONEHOUR,o=s.ONEMIN,m=s.ONESEC,l=y("./axis_ids"),w=y("./constants"),_=w.HOUR_PATTERN,c=w.WEEKDAY_PATTERN;function b(L){return Math.pow(10,L)}function u(L){return L!=null}ee.exports=function(T,k){k=k||{};var P=T._id||"x",z=P.charAt(0);function I(U,$){if(U>0)return Math.log(U)/Math.LN10;if(U<=0&&$&&T.range&&T.range.length===2){var ne=T.range[0],X=T.range[1];return .5*(ne+X-2*p*Math.abs(ne-X))}else return x}function D(U,$,ne,X){if((X||{}).msUTC&&e(U))return+U;var Q=r(U,ne||T.calendar);if(Q===x)if(e(U)){U=+U;var ie=Math.floor(S.mod(U+.05,1)*10),se=Math.round(U-ie/10);Q=r(new Date(se))+ie/10}else return x;return Q}function R(U,$,ne){return n(U,$,ne||T.calendar)}function O(U){return T._categories[Math.round(U)]}function F(U){if(u(U)){if(T._categoriesMap===void 0&&(T._categoriesMap={}),T._categoriesMap[U]!==void 0)return T._categoriesMap[U];T._categories.push(typeof U=="number"?String(U):U);var $=T._categories.length-1;return T._categoriesMap[U]=$,$}return x}function N(U,$){for(var ne=new Array($),X=0;X<$;X++){var Q=(U[0]||[])[X],ie=(U[1]||[])[X];ne[X]=G([Q,ie])}return ne}function G(U){if(T._categoriesMap)return T._categoriesMap[U]}function K(U){var $=G(U);if($!==void 0)return $;if(e(U))return+U}function W(U){return e(U)?+U:G(U)}function Y(U,$,ne){return A.round(ne+$*U,2)}function re(U,$,ne){return(U-ne)/$}var ue=function($){return e($)?Y($,T._m,T._b):x},j=function(U){return re(U,T._m,T._b)};if(T.rangebreaks){var q=z==="y";ue=function(U){if(!e(U))return x;var $=T._rangebreaks.length;if(!$)return Y(U,T._m,T._b);var ne=q;T.range[0]>T.range[1]&&(ne=!ne);for(var X=ne?-1:1,Q=X*U,ie=0,se=0;se<$;se++){var ae=X*T._rangebreaks[se].min,oe=X*T._rangebreaks[se].max;if(Q<ae)break;if(Q>oe)ie=se+1;else{ie=Q<(ae+oe)/2?se:se+1;break}}var be=T._B[ie]||0;return isFinite(be)?Y(U,T._m2,be):0},j=function(U){var $=T._rangebreaks.length;if(!$)return re(U,T._m,T._b);for(var ne=0,X=0;X<$&&!(U<T._rangebreaks[X].pmin);X++)U>T._rangebreaks[X].pmax&&(ne=X+1);return re(U,T._m2,T._B[ne])}}T.c2l=T.type==="log"?I:t,T.l2c=T.type==="log"?b:t,T.l2p=ue,T.p2l=j,T.c2p=T.type==="log"?function(U,$){return ue(I(U,$))}:ue,T.p2c=T.type==="log"?function(U){return b(j(U))}:j,["linear","-"].indexOf(T.type)!==-1?(T.d2r=T.r2d=T.d2c=T.r2c=T.d2l=T.r2l=a,T.c2d=T.c2r=T.l2d=T.l2r=t,T.d2p=T.r2p=function(U){return T.l2p(a(U))},T.p2d=T.p2r=j,T.cleanPos=t):T.type==="log"?(T.d2r=T.d2l=function(U,$){return I(a(U),$)},T.r2d=T.r2c=function(U){return b(a(U))},T.d2c=T.r2l=a,T.c2d=T.l2r=t,T.c2r=I,T.l2d=b,T.d2p=function(U,$){return T.l2p(T.d2r(U,$))},T.p2d=function(U){return b(j(U))},T.r2p=function(U){return T.l2p(a(U))},T.p2r=j,T.cleanPos=t):T.type==="date"?(T.d2r=T.r2d=S.identity,T.d2c=T.r2c=T.d2l=T.r2l=D,T.c2d=T.c2r=T.l2d=T.l2r=R,T.d2p=T.r2p=function(U,$,ne){return T.l2p(D(U,0,ne))},T.p2d=T.p2r=function(U,$,ne){return R(j(U),$,ne)},T.cleanPos=function(U){return S.cleanDate(U,x,T.calendar)}):T.type==="category"?(T.d2c=T.d2l=F,T.r2d=T.c2d=T.l2d=O,T.d2r=T.d2l_noadd=K,T.r2c=function(U){var $=W(U);return $!==void 0?$:T.fraction2r(.5)},T.l2r=T.c2r=t,T.r2l=W,T.d2p=function(U){return T.l2p(T.r2c(U))},T.p2d=function(U){return O(j(U))},T.r2p=T.d2p,T.p2r=j,T.cleanPos=function(U){return typeof U=="string"&&U!==""?U:t(U)}):T.type==="multicategory"&&(T.r2d=T.c2d=T.l2d=O,T.d2r=T.d2l_noadd=K,T.r2c=function(U){var $=K(U);return $!==void 0?$:T.fraction2r(.5)},T.r2c_just_indices=G,T.l2r=T.c2r=t,T.r2l=K,T.d2p=function(U){return T.l2p(T.r2c(U))},T.p2d=function(U){return O(j(U))},T.r2p=T.d2p,T.p2r=j,T.cleanPos=function(U){return Array.isArray(U)||typeof U=="string"&&U!==""?U:t(U)},T.setupMultiCategory=function(U){var $=T._traceIndices,ne,X,Q=T._matchGroup;if(Q&&T._categories.length===0){for(var ie in Q)if(ie!==P){var se=k[l.id2name(ie)];$=$.concat(se._traceIndices)}}var ae=[[0,{}],[0,{}]],oe=[];for(ne=0;ne<$.length;ne++){var be=U[$[ne]];if(z in be){var ce=be[z],de=be._length||S.minRowLength(ce);if(h(ce[0])&&h(ce[1]))for(X=0;X<de;X++){var ye=ce[0][X],ge=ce[1][X];u(ye)&&u(ge)&&(oe.push([ye,ge]),ye in ae[0][1]||(ae[0][1][ye]=ae[0][0]++),ge in ae[1][1]||(ae[1][1][ge]=ae[1][0]++))}}}for(oe.sort(function(me,Ee){var Pe=ae[0][1],Ue=Pe[me[0]]-Pe[Ee[0]];if(Ue)return Ue;var we=ae[1][1];return we[me[1]]-we[Ee[1]]}),ne=0;ne<oe.length;ne++)F(oe[ne])}),T.fraction2r=function(U){var $=T.r2l(T.range[0]),ne=T.r2l(T.range[1]);return T.l2r($+U*(ne-$))},T.r2fraction=function(U){var $=T.r2l(T.range[0]),ne=T.r2l(T.range[1]);return(T.r2l(U)-$)/(ne-$)},T.cleanRange=function(U,$){$||($={}),U||(U="range");var ne=S.nestedProperty(T,U).get(),X,Q;if(T.type==="date"?Q=S.dfltRange(T.calendar):z==="y"?Q=w.DFLTRANGEY:T._name==="realaxis"?Q=[0,1]:Q=$.dfltRange||w.DFLTRANGEX,Q=Q.slice(),(T.rangemode==="tozero"||T.rangemode==="nonnegative")&&(Q[0]=0),!ne||ne.length!==2){S.nestedProperty(T,U).set(Q);return}for(T.type==="date"&&!T.autorange&&(ne[0]=S.cleanDate(ne[0],x,T.calendar),ne[1]=S.cleanDate(ne[1],x,T.calendar)),X=0;X<2;X++)if(T.type==="date"){if(!S.isDateTime(ne[X],T.calendar)){T[U]=Q;break}if(T.r2l(ne[0])===T.r2l(ne[1])){var ie=S.constrain(T.r2l(ne[0]),S.MIN_MS+1e3,S.MAX_MS-1e3);ne[0]=T.l2r(ie-1e3),ne[1]=T.l2r(ie+1e3);break}}else{if(!e(ne[X]))if(e(ne[1-X]))ne[X]=ne[1-X]*(X?10:.1);else{T[U]=Q;break}if(ne[X]<-i?ne[X]=-i:ne[X]>i&&(ne[X]=i),ne[0]===ne[1]){var se=Math.max(1,Math.abs(ne[0]*1e-6));ne[0]-=se,ne[1]+=se}}},T.setScale=function(U){var $=k._size;if(T.overlaying){var ne=l.getFromId({_fullLayout:k},T.overlaying);T.domain=ne.domain}var X=U&&T._r?"_r":"range",Q=T.calendar;T.cleanRange(X);var ie=T.r2l(T[X][0],Q),se=T.r2l(T[X][1],Q),ae=z==="y";if(ae?(T._offset=$.t+(1-T.domain[1])*$.h,T._length=$.h*(T.domain[1]-T.domain[0]),T._m=T._length/(ie-se),T._b=-T._m*se):(T._offset=$.l+T.domain[0]*$.w,T._length=$.w*(T.domain[1]-T.domain[0]),T._m=T._length/(se-ie),T._b=-T._m*ie),T._rangebreaks=[],T._lBreaks=0,T._m2=0,T._B=[],T.rangebreaks){var oe,be;if(T._rangebreaks=T.locateBreaks(Math.min(ie,se),Math.max(ie,se)),T._rangebreaks.length){for(oe=0;oe<T._rangebreaks.length;oe++)be=T._rangebreaks[oe],T._lBreaks+=Math.abs(be.max-be.min);var ce=ae;ie>se&&(ce=!ce),ce&&T._rangebreaks.reverse();var de=ce?-1:1;for(T._m2=de*T._length/(Math.abs(se-ie)-T._lBreaks),T._B.push(-T._m2*(ae?se:ie)),oe=0;oe<T._rangebreaks.length;oe++)be=T._rangebreaks[oe],T._B.push(T._B[T._B.length-1]-de*T._m2*(be.max-be.min));for(oe=0;oe<T._rangebreaks.length;oe++)be=T._rangebreaks[oe],be.pmin=ue(be.min),be.pmax=ue(be.max)}}if(!isFinite(T._m)||!isFinite(T._b)||T._length<0)throw k._replotting=!1,new Error("Something went wrong with axis scaling")},T.maskBreaks=function(U){var $=T.rangebreaks||[],ne,X,Q,ie,se;$._cachedPatterns||($._cachedPatterns=$.map(function(Pe){return Pe.enabled&&Pe.bounds?S.simpleMap(Pe.bounds,Pe.pattern?a:T.d2c):null})),$._cachedValues||($._cachedValues=$.map(function(Pe){return Pe.enabled&&Pe.values?S.simpleMap(Pe.values,T.d2c).sort(S.sorterAsc):null}));for(var ae=0;ae<$.length;ae++){var oe=$[ae];if(oe.enabled){if(oe.bounds){var be=oe.pattern;switch(ne=$._cachedPatterns[ae],X=ne[0],Q=ne[1],be){case c:se=new Date(U),ie=se.getUTCDay(),X>Q&&(Q+=7,ie<X&&(ie+=7));break;case _:se=new Date(U);var ce=se.getUTCHours(),de=se.getUTCMinutes(),ye=se.getUTCSeconds(),ge=se.getUTCMilliseconds();ie=ce+(de/60+ye/3600+ge/36e5),X>Q&&(Q+=24,ie<X&&(ie+=24));break;case"":ie=U;break}if(ie>=X&&ie<Q)return x}else for(var me=$._cachedValues[ae],Ee=0;Ee<me.length;Ee++)if(X=me[Ee],Q=X+oe.dvalue,U>=X&&U<Q)return x}}return U},T.locateBreaks=function(U,$){var ne,X,Q,ie,se=[];if(!T.rangebreaks)return se;var ae=T.rangebreaks.slice().sort(function(we,ke){return we.pattern===c&&ke.pattern===_?-1:ke.pattern===c&&we.pattern===_?1:0}),oe=function(we,ke){if(we=S.constrain(we,U,$),ke=S.constrain(ke,U,$),we!==ke){for(var Xe=!0,Ve=0;Ve<se.length;Ve++){var Ie=se[Ve];we<Ie.max&&ke>=Ie.min&&(we<Ie.min&&(Ie.min=we),ke>Ie.max&&(Ie.max=ke),Xe=!1)}Xe&&se.push({min:we,max:ke})}};for(ne=0;ne<ae.length;ne++){var be=ae[ne];if(be.enabled)if(be.bounds){var ce=U,de=$;be.pattern&&(ce=Math.floor(ce)),X=S.simpleMap(be.bounds,be.pattern?a:T.r2l),Q=X[0],ie=X[1];var ye=new Date(ce),ge,me;switch(be.pattern){case c:me=v,ge=((ie<Q?7:0)+(ie-Q))*f,ce+=Q*f-(ye.getUTCDay()*f+ye.getUTCHours()*d+ye.getUTCMinutes()*o+ye.getUTCSeconds()*m+ye.getUTCMilliseconds());break;case _:me=f,ge=((ie<Q?24:0)+(ie-Q))*d,ce+=Q*d-(ye.getUTCHours()*d+ye.getUTCMinutes()*o+ye.getUTCSeconds()*m+ye.getUTCMilliseconds());break;default:ce=Math.min(X[0],X[1]),de=Math.max(X[0],X[1]),me=de-ce,ge=me}for(var Ee=ce;Ee<de;Ee+=me)oe(Ee,Ee+ge)}else for(var Pe=S.simpleMap(be.values,T.d2c),Ue=0;Ue<Pe.length;Ue++)Q=Pe[Ue],ie=Q+be.dvalue,oe(Q,ie)}return se.sort(function(we,ke){return we.min-ke.min}),se},T.makeCalcdata=function(U,$,ne){var X,Q,ie,se,ae=T.type,oe=ae==="date"&&U[$+"calendar"];if($ in U){if(X=U[$],se=U._length||S.minRowLength(X),S.isTypedArray(X)&&(ae==="linear"||ae==="log")){if(se===X.length)return X;if(X.subarray)return X.subarray(0,se)}if(ae==="multicategory")return N(X,se);for(Q=new Array(se),ie=0;ie<se;ie++)Q[ie]=T.d2c(X[ie],0,oe,ne)}else{var be=$+"0"in U?T.d2c(U[$+"0"],0,oe):0,ce=U["d"+$]?Number(U["d"+$]):1;for(X=U[{x:"y",y:"x"}[$]],se=U._length||X.length,Q=new Array(se),ie=0;ie<se;ie++)Q[ie]=be+ie*ce}if(T.rangebreaks)for(ie=0;ie<se;ie++)Q[ie]=T.maskBreaks(Q[ie]);return Q},T.isValidRange=function(U){return Array.isArray(U)&&U.length===2&&e(T.r2l(U[0]))&&e(T.r2l(U[1]))},T.isPtWithinRange=function(U,$){var ne=T.c2l(U[z],null,$),X=T.r2l(T.range[0]),Q=T.r2l(T.range[1]);return X<Q?X<=ne&&ne<=Q:Q<=ne&&ne<=X},T._emptyCategories=function(){T._categories=[],T._categoriesMap={}},T.clearCalc=function(){var U=T._matchGroup;if(U){var $=null,ne=null;for(var X in U){var Q=k[l.id2name(X)];if(Q._categories){$=Q._categories,ne=Q._categoriesMap;break}}$&&ne?(T._categories=$,T._categoriesMap=ne):T._emptyCategories()}else T._emptyCategories();if(T._initialCategories)for(var ie=0;ie<T._initialCategories.length;ie++)F(T._initialCategories[ie])},T.sortByInitialCategories=function(){var U=[];if(T._emptyCategories(),T._initialCategories)for(var $=0;$<T._initialCategories.length;$++)F(T._initialCategories[$]);U=U.concat(T._traceIndices);var ne=T._matchGroup;for(var X in ne)if(P!==X){var Q=k[l.id2name(X)];Q._categories=T._categories,Q._categoriesMap=T._categoriesMap,U=U.concat(Q._traceIndices)}return U};var H=k._d3locale;T.type==="date"&&(T._dateFormat=H?H.timeFormat:g,T._extraFormat=k._extraFormat),T._separators=k.separators,T._numFormat=H?H.numberFormat:M,delete T._minDtick,delete T._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(y,ee,te){ee.exports=function(g){var S=["showexponent","showtickprefix","showticksuffix"],M=S.filter(function(a){return g[a]!==void 0}),e=function(a){return g[a]===g[M[0]]};if(M.every(e)||M.length===1)return g[M[0]]}},{}],587:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color").contrast,S=y("./layout_attributes"),M=y("./show_dflt"),e=y("../array_container_defaults");ee.exports=function(r,t,h,s,i){i||(i={});var x=M(r),p=h("showticklabels");if(p){var v=i.font||{},f=t.color,d=t.ticklabelposition||"",o=d.indexOf("inside")!==-1?g(i.bgColor):f&&f!==S.color.dflt?f:v.color;if(A.coerceFont(h,"tickfont",{family:v.family,size:v.size,color:o}),!i.noTicklabelstep&&s!=="multicategory"&&s!=="log"&&h("ticklabelstep"),i.noAng||h("tickangle"),s!=="category"){var m=h("tickformat");e(r,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:a}),t.tickformatstops.length||delete t.tickformatstops,!i.noExp&&!m&&s!=="date"&&(h("showexponent",x),h("exponentformat"),h("minexponent"),h("separatethousands"))}}};function a(n,r){function t(s,i){return A.coerce(n,r,S.tickformatstops,s,i)}var h=t("enabled");h&&(t("dtickrange"),t("value"))}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(M,e,a,n){var r=n.isMinor,t=r?M.minor||{}:M,h=r?e.minor:e,s=r?g.minor:g,i=r?"minor.":"",x=A.coerce2(t,h,s,"ticklen",r?(e.ticklen||5)*.6:void 0),p=A.coerce2(t,h,s,"tickwidth",r?e.tickwidth||1:void 0),v=A.coerce2(t,h,s,"tickcolor",(r?e.tickcolor:void 0)||h.color),f=a(i+"ticks",!r&&n.outerTicks||x||p||v?"outside":"");f||(delete h.ticklen,delete h.tickwidth,delete h.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(y,ee,te){var A=y("./clean_ticks"),g=y("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n,r){r||(r={});var t=r.isMinor,h=t?M.minor||{}:M,s=t?e.minor:e,i=t?"minor.":"";function x(w){var _=h[w];return _!==void 0?_:(s._template||{})[w]}var p=x("tick0"),v=x("dtick"),f=x("tickvals"),d=g(f)?"array":v?"linear":"auto",o=a(i+"tickmode",d);if(o==="auto")a(i+"nticks");else if(o==="linear"){var m=s.dtick=A.dtick(v,n);s.tick0=A.tick0(p,n,e.calendar,m)}else if(n!=="multicategory"){var l=a(i+"tickvals");l===void 0?s.tickmode="auto":t||a("ticktext")}}},{"../../lib":515,"./clean_ticks":572}],590:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../registry"),S=y("../../lib"),M=y("../../components/drawing"),e=y("./axes");ee.exports=function(n,r,t,h){var s=n._fullLayout;if(r.length===0){e.redrawComponents(n);return}function i(_){var c=_.xaxis,b=_.yaxis;s._defs.select("#"+_.clipId+"> rect").call(M.setTranslate,0,0).call(M.setScale,1,1),_.plot.call(M.setTranslate,c._offset,b._offset).call(M.setScale,1,1);var u=_.plot.selectAll(".scatterlayer .trace");u.selectAll(".point").call(M.setPointGroupScale,1,1),u.selectAll(".textpoint").call(M.setTextPointsScale,1,1),u.call(M.hideOutsideRangePoints,_)}function x(_,c){var b=_.plotinfo,u=b.xaxis,L=b.yaxis,T=u._length,k=L._length,P=!!_.xr1,z=!!_.yr1,I=[];if(P){var D=S.simpleMap(_.xr0,u.r2l),R=S.simpleMap(_.xr1,u.r2l),O=D[1]-D[0],F=R[1]-R[0];I[0]=(D[0]*(1-c)+c*R[0]-D[0])/(D[1]-D[0])*T,I[2]=T*(1-c+c*F/O),u.range[0]=u.l2r(D[0]*(1-c)+c*R[0]),u.range[1]=u.l2r(D[1]*(1-c)+c*R[1])}else I[0]=0,I[2]=T;if(z){var N=S.simpleMap(_.yr0,L.r2l),G=S.simpleMap(_.yr1,L.r2l),K=N[1]-N[0],W=G[1]-G[0];I[1]=(N[1]*(1-c)+c*G[1]-N[1])/(N[0]-N[1])*k,I[3]=k*(1-c+c*W/K),L.range[0]=u.l2r(N[0]*(1-c)+c*G[0]),L.range[1]=L.l2r(N[1]*(1-c)+c*G[1])}else I[1]=0,I[3]=k;e.drawOne(n,u,{skipTitle:!0}),e.drawOne(n,L,{skipTitle:!0}),e.redrawComponents(n,[u._id,L._id]);var Y=P?T/I[2]:1,re=z?k/I[3]:1,ue=P?I[0]:0,j=z?I[1]:0,q=P?I[0]/I[2]*T:0,H=z?I[1]/I[3]*k:0,U=u._offset-q,$=L._offset-H;b.clipRect.call(M.setTranslate,ue,j).call(M.setScale,1/Y,1/re),b.plot.call(M.setTranslate,U,$).call(M.setScale,Y,re),M.setPointGroupScale(b.zoomScalePts,1/Y,1/re),M.setTextPointsScale(b.zoomScaleTxt,1/Y,1/re)}var p;h&&(p=h());function v(){for(var _={},c=0;c<r.length;c++){var b=r[c],u=b.plotinfo.xaxis,L=b.plotinfo.yaxis;b.xr1&&(_[u._name+".range"]=b.xr1.slice()),b.yr1&&(_[L._name+".range"]=b.yr1.slice())}return p&&p(),g.call("relayout",n,_).then(function(){for(var T=0;T<r.length;T++)i(r[T].plotinfo)})}function f(){for(var _={},c=0;c<r.length;c++){var b=r[c],u=b.plotinfo.xaxis,L=b.plotinfo.yaxis;b.xr0&&(_[u._name+".range"]=b.xr0.slice()),b.yr0&&(_[L._name+".range"]=b.yr0.slice())}return g.call("relayout",n,_).then(function(){for(var T=0;T<r.length;T++)i(r[T].plotinfo)})}var d,o,m,l=A.ease(t.easing);n._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(m),m=null,f()});function w(){o=Date.now();for(var _=Math.min(1,(o-d)/t.duration),c=l(_),b=0;b<r.length;b++)x(r[b],c);o-d>t.duration?(v(),m=window.cancelAnimationFrame(w)):m=window.requestAnimationFrame(w)}return d=Date.now(),m=window.requestAnimationFrame(w),Promise.resolve()}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(y,ee,te){var A=y("../../registry").traceIs,g=y("./axis_autotype");ee.exports=function(r,t,h,s){h("autotypenumbers",s.autotypenumbersDflt);var i=h("type",(s.splomStash||{}).type);i==="-"&&(S(t,s.data),t.type==="-"?t.type="linear":r.type=t.type)};function S(n,r){if(n.type==="-"){var t=n._id,h=t.charAt(0),s;t.indexOf("scene")!==-1&&(t=h);var i=M(r,t,h);if(i){if(i.type==="histogram"&&h==={v:"y",h:"x"}[i.orientation||"v"]){n.type="linear";return}var x=h+"calendar",p=i[x],v={noMultiCategory:!A(i,"cartesian")||A(i,"noMultiCategory")};if(i.type==="box"&&i._hasPreCompStats&&h==={h:"x",v:"y"}[i.orientation||"v"]&&(v.noMultiCategory=!0),v.autotypenumbers=n.autotypenumbers,a(i,h)){var f=e(i),d=[];for(s=0;s<r.length;s++){var o=r[s];!A(o,"box-violin")||(o[h+"axis"]||h)!==t||(o[f]!==void 0?d.push(o[f][0]):o.name!==void 0?d.push(o.name):d.push("text"),o[x]!==p&&(p=void 0))}n.type=g(d,p,v)}else if(i.type==="splom"){var m=i.dimensions,l=m[i._axesDim[t]];l.visible&&(n.type=g(l.values,p,v))}else n.type=g(i[h]||[i[h+"0"]],p,v)}}}function M(n,r,t){for(var h=0;h<n.length;h++){var s=n[h];if(s.type==="splom"&&s._length>0&&(s["_"+t+"axes"]||{})[r])return s;if((s[t+"axis"]||t)===r){if(a(s,t))return s;if((s[t]||[]).length||s[t+"0"])return s}}}function e(n){return{v:"x",h:"y"}[n.orientation||"v"]}function a(n,r){var t=e(n),h=A(n,"box-violin"),s=A(n._fullInput||{},"candlestick");return h&&!s&&r===t&&n[t]===void 0&&n[t+"0"]===void 0}},{"../../registry":647,"./axis_autotype":567}],592:[function(y,ee,te){var A=y("../registry"),g=y("../lib");te.manageCommandObserver=function(r,t,h,s){var i={},x=!0;t&&t._commandObserver&&(i=t._commandObserver),i.cache||(i.cache={}),i.lookupTable={};var p=te.hasSimpleAPICommandBindings(r,h,i.lookupTable);if(t&&t._commandObserver){if(p)return i;if(t._commandObserver.remove)return t._commandObserver.remove(),t._commandObserver=null,i}if(p){S(r,p,i.cache),i.check=function(){if(x){var o=S(r,p,i.cache);return o.changed&&s&&i.lookupTable[o.value]!==void 0&&(i.disable(),Promise.resolve(s({value:o.value,type:p.type,prop:p.prop,traces:p.traces,index:i.lookupTable[o.value]})).then(i.enable,i.enable)),o.changed}};for(var v=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],f=0;f<v.length;f++)r._internalOn(v[f],i.check);i.remove=function(){for(var d=0;d<v.length;d++)r._removeInternalListener(v[d],i.check)}}else g.log("Unable to automatically bind plot updates to API command"),i.lookupTable={},i.remove=function(){};return i.disable=function(){x=!1},i.enable=function(){x=!0},t&&(t._commandObserver=i),i},te.hasSimpleAPICommandBindings=function(r,t,h){var s,i=t.length,x;for(s=0;s<i;s++){var p,v=t[s],f=v.method,d=v.args;if(Array.isArray(d)||(d=[]),!f)return!1;var o=te.computeAPICommandBindings(r,f,d);if(o.length!==1)return!1;if(!x)x=o[0],Array.isArray(x.traces)&&x.traces.sort();else{if(p=o[0],p.type!==x.type||p.prop!==x.prop)return!1;if(Array.isArray(x.traces))if(Array.isArray(p.traces)){p.traces.sort();for(var m=0;m<x.traces.length;m++)if(x.traces[m]!==p.traces[m])return!1}else return!1;else if(p.prop!==x.prop)return!1}p=o[0];var l=p.value;if(Array.isArray(l))if(l.length===1)l=l[0];else return!1;h&&(h[l]=s)}return x};function S(r,t,h){var s,i,x,p=!1;if(t.type==="data")s=r._fullData[t.traces!==null?t.traces[0]:0];else if(t.type==="layout")s=r._fullLayout;else return!1;return i=g.nestedProperty(s,t.prop).get(),x=h[t.type]=h[t.type]||{},x.hasOwnProperty(t.prop)&&x[t.prop]!==i&&(p=!0),x[t.prop]=i,{changed:p,value:i}}te.executeAPICommand=function(r,t,h){if(t==="skip")return Promise.resolve();var s=A.apiMethodRegistry[t],i=[r];Array.isArray(h)||(h=[]);for(var x=0;x<h.length;x++)i.push(h[x]);return s.apply(null,i).catch(function(p){return g.warn("API call to Plotly."+t+" rejected.",p),Promise.reject(p)})},te.computeAPICommandBindings=function(r,t,h){var s;switch(Array.isArray(h)||(h=[]),t){case"restyle":s=a(r,h);break;case"relayout":s=e(r,h);break;case"update":s=a(r,[h[0],h[2]]).concat(e(r,[h[1]]));break;case"animate":s=M(r,h);break;default:s=[]}return s};function M(r,t){return Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]:[]}function e(r,t){var h=[],s=t[0],i={};if(typeof s=="string")i[s]=t[1];else if(g.isPlainObject(s))i=s;else return h;return n(i,function(x,p,v){h.push({type:"layout",prop:x,value:v})},"",0),h}function a(r,t){var h,s,i,x,p=[];if(s=t[0],i=t[1],h=t[2],x={},typeof s=="string")x[s]=i;else if(g.isPlainObject(s))x=s,h===void 0&&(h=i);else return p;return h===void 0&&(h=null),n(x,function(v,f,d){var o,m;if(Array.isArray(d)){m=d.slice();var l=Math.min(m.length,r.data.length);h&&(l=Math.min(l,h.length)),o=[];for(var w=0;w<l;w++)o[w]=h?h[w]:w}else m=d,o=h?h.slice():null;if(o===null)Array.isArray(m)&&(m=m[0]);else if(Array.isArray(o)){if(!Array.isArray(m)){var _=m;m=[];for(var c=0;c<o.length;c++)m[c]=_}m.length=Math.min(o.length,m.length)}p.push({type:"data",prop:v,traces:o,value:m})},"",0),p}function n(r,t,h,s){Object.keys(r).forEach(function(i){var x=r[i];if(i[0]!=="_"){var p=h+(s>0?".":"")+i;g.isPlainObject(x)?n(x,t,p,s+1):t(p,i,x)}})}},{"../lib":515,"../registry":647}],593:[function(y,ee,te){var A=y("../lib/extend").extendFlat;te.attributes=function(g,S){g=g||{},S=S||{};var M={valType:"info_array",editType:g.editType,items:[{valType:"number",min:0,max:1,editType:g.editType},{valType:"number",min:0,max:1,editType:g.editType}],dflt:[0,1]};g.name&&g.name+"",g.trace,S.description&&""+S.description;var e={x:A({},M,{}),y:A({},M,{}),editType:g.editType};return g.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:g.editType},e.column={valType:"integer",min:0,dflt:0,editType:g.editType}),e},te.defaults=function(g,S,M,e){var a=e&&e.x||[0,1],n=e&&e.y||[0,1],r=S.grid;if(r){var t=M("domain.column");t!==void 0&&(t<r.columns?a=r._domains.x[t]:delete g.domain.column);var h=M("domain.row");h!==void 0&&(h<r.rows?n=r._domains.y[h]:delete g.domain.row)}var s=M("domain.x",a),i=M("domain.y",n);s[0]<s[1]||(g.domain.x=a.slice()),i[0]<i[1]||(g.domain.y=n.slice())}},{"../lib/extend":505}],594:[function(y,ee,te){ee.exports=function(A){var g=A.editType,S=A.colorEditType;S===void 0&&(S=g);var M={family:{valType:"string",noBlank:!0,strict:!0,editType:g},size:{valType:"number",min:1,editType:g},color:{valType:"color",editType:S},editType:g};return A.autoSize&&(M.size.dflt="auto"),A.autoColor&&(M.color.dflt="auto"),A.arrayOk&&(M.family.arrayOk=!0,M.size.arrayOk=!0,M.color.arrayOk=!0),M}},{}],595:[function(y,ee,te){ee.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(y,ee,te){te.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},te.axesNames=["lonaxis","lataxis"],te.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},te.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},te.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},te.clipPad=.001,te.precision=.1,te.landColor="#F0DC82",te.waterColor="#3399FF",te.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},te.sphereSVG={type:"Sphere"},te.fillLayers={ocean:1,land:1,lakes:1},te.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},te.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],te.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],te.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(y,ee,te){var A=y("@plotly/d3"),g=y("d3-geo"),S=g.geoPath,M=g.geoDistance,e=y("d3-geo-projection"),a=y("../../registry"),n=y("../../lib"),r=n.strTranslate,t=y("../../components/color"),h=y("../../components/drawing"),s=y("../../components/fx"),i=y("../plots"),x=y("../cartesian/axes"),p=y("../cartesian/autorange").getAutoRange,v=y("../../components/dragelement"),f=y("../../components/selections").prepSelect,d=y("../../components/selections").clearOutline,o=y("../../components/selections").selectOnClick,m=y("./zoom"),l=y("./constants"),w=y("../../lib/geo_location_utils"),_=y("../../lib/topojson_utils"),c=y("topojson-client").feature;function b(P){this.id=P.id,this.graphDiv=P.graphDiv,this.container=P.container,this.topojsonURL=P.topojsonURL,this.isStatic=P.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var u=b.prototype;ee.exports=function(z){return new b(z)},u.plot=function(P,z,I,D){var R=this;if(D)return R.update(P,z,!0);R._geoCalcData=P,R._fullLayout=z;var O=z[this.id],F=[],N=!1;for(var G in l.layerNameToAdjective)if(G!=="frame"&&O["show"+G]){N=!0;break}for(var K=!1,W=0;W<P.length;W++){var Y=P[0][0].trace;Y._geo=R,Y.locationmode&&(N=!0);var re=Y.marker;if(re){var ue=re.angle,j=re.angleref;(ue||j==="north"||j==="previous")&&(K=!0)}}if(this._hasMarkerAngles=K,N){var q=_.getTopojsonName(O);(R.topojson===null||q!==R.topojsonName)&&(R.topojsonName=q,PlotlyGeoAssets.topojson[R.topojsonName]===void 0&&F.push(R.fetchTopojson()))}F=F.concat(w.fetchTraceGeoData(P)),I.push(new Promise(function(H,U){Promise.all(F).then(function(){R.topojson=PlotlyGeoAssets.topojson[R.topojsonName],R.update(P,z),H()}).catch(U)}))},u.fetchTopojson=function(){var P=this,z=_.getTopojsonPath(P.topojsonURL,P.topojsonName);return new Promise(function(I,D){A.json(z,function(R,O){if(R)return R.status===404?D(new Error(["plotly.js could not find topojson file at",z+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):D(new Error(["unexpected error while fetching topojson file at",z].join(" ")));PlotlyGeoAssets.topojson[P.topojsonName]=O,I()})})},u.update=function(P,z,I){var D=z[this.id];this.hasChoropleth=!1;for(var R=0;R<P.length;R++){var O=P[R],F=O[0].trace;F.type==="choropleth"&&(this.hasChoropleth=!0),F.visible===!0&&F._length>0&&F._module.calcGeoJSON(O,z)}if(!I){var N=this.updateProjection(P,z);if(N)return;(!this.viewInitial||this.scope!==D.scope)&&this.saveViewInitial(D)}this.scope=D.scope,this.updateBaseLayers(z,D),this.updateDims(z,D),this.updateFx(z,D),i.generalUpdatePerTraceModule(this.graphDiv,this,P,D);var G=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=G.selectAll(".point"),this.dataPoints.text=G.selectAll("text"),this.dataPaths.line=G.selectAll(".js-line");var K=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=K.selectAll("path"),this._render()},u.updateProjection=function(P,z){var I=this.graphDiv,D=z[this.id],R=z._size,O=D.domain,F=D.projection,N=D.lonaxis,G=D.lataxis,K=N._ax,W=G._ax,Y=this.projection=L(D),re=[[R.l+R.w*O.x[0],R.t+R.h*(1-O.y[1])],[R.l+R.w*O.x[1],R.t+R.h*(1-O.y[0])]],ue=D.center||{},j=F.rotation||{},q=N.range||[],H=G.range||[];if(D.fitbounds){K._length=re[1][0]-re[0][0],W._length=re[1][1]-re[0][1],K.range=p(I,K),W.range=p(I,W);var U=(K.range[0]+K.range[1])/2,$=(W.range[0]+W.range[1])/2;if(D._isScoped)ue={lon:U,lat:$};else if(D._isClipped){ue={lon:U,lat:$},j={lon:U,lat:$,roll:j.roll};var ne=F.type,X=l.lonaxisSpan[ne]/2||180,Q=l.lataxisSpan[ne]/2||90;q=[U-X,U+X],H=[$-Q,$+Q]}else ue={lon:U,lat:$},j={lon:U,lat:j.lat,roll:j.roll}}Y.center([ue.lon-j.lon,ue.lat-j.lat]).rotate([-j.lon,-j.lat,j.roll]).parallels(F.parallels);var ie=k(q,H);Y.fitExtent(re,ie);var se=this.bounds=Y.getBounds(ie),ae=this.fitScale=Y.scale(),oe=Y.translate();if(D.fitbounds){var be=Y.getBounds(k(K.range,W.range)),ce=Math.min((se[1][0]-se[0][0])/(be[1][0]-be[0][0]),(se[1][1]-se[0][1])/(be[1][1]-be[0][1]));isFinite(ce)?Y.scale(ce*ae):n.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Y.scale(F.scale*ae);var de=this.midPt=[(se[0][0]+se[1][0])/2,(se[0][1]+se[1][1])/2];if(Y.translate([oe[0]+(de[0]-oe[0]),oe[1]+(de[1]-oe[1])]).clipExtent(se),D._isAlbersUsa){var ye=Y([ue.lon,ue.lat]),ge=Y.translate();Y.translate([ge[0]-(ye[0]-ge[0]),ge[1]-(ye[1]-ge[1])])}},u.updateBaseLayers=function(P,z){var I=this,D=I.topojson,R=I.layers,O=I.basePaths;function F(re){return re==="lonaxis"||re==="lataxis"}function N(re){return!!l.lineLayers[re]}function G(re){return!!l.fillLayers[re]}var K=this.hasChoropleth?l.layersForChoropleth:l.layers,W=K.filter(function(re){return N(re)||G(re)?z["show"+re]:F(re)?z[re].showgrid:!0}),Y=I.framework.selectAll(".layer").data(W,String);Y.exit().each(function(re){delete R[re],delete O[re],A.select(this).remove()}),Y.enter().append("g").attr("class",function(re){return"layer "+re}).each(function(re){var ue=R[re]=A.select(this);re==="bg"?I.bgRect=ue.append("rect").style("pointer-events","all"):F(re)?O[re]=ue.append("path").style("fill","none"):re==="backplot"?ue.append("g").classed("choroplethlayer",!0):re==="frontplot"?ue.append("g").classed("scatterlayer",!0):N(re)?O[re]=ue.append("path").style("fill","none").style("stroke-miterlimit",2):G(re)&&(O[re]=ue.append("path").style("stroke","none"))}),Y.order(),Y.each(function(re){var ue=O[re],j=l.layerNameToAdjective[re];re==="frame"?ue.datum(l.sphereSVG):N(re)||G(re)?ue.datum(c(D,D.objects[re])):F(re)&&ue.datum(T(re,z,P)).call(t.stroke,z[re].gridcolor).call(h.dashLine,z[re].griddash,z[re].gridwidth),N(re)?ue.call(t.stroke,z[j+"color"]).call(h.dashLine,"",z[j+"width"]):G(re)&&ue.call(t.fill,z[j+"color"])})},u.updateDims=function(P,z){var I=this.bounds,D=(z.framewidth||0)/2,R=I[0][0]-D,O=I[0][1]-D,F=I[1][0]-R+D,N=I[1][1]-O+D;h.setRect(this.clipRect,R,O,F,N),this.bgRect.call(h.setRect,R,O,F,N).call(t.fill,z.bgcolor),this.xaxis._offset=R,this.xaxis._length=F,this.yaxis._offset=O,this.yaxis._length=N},u.updateFx=function(P,z){var I=this,D=I.graphDiv,R=I.bgRect,O=P.dragmode,F=P.clickmode;if(I.isStatic)return;function N(){var Y=I.viewInitial,re={};for(var ue in Y)re[I.id+"."+ue]=Y[ue];a.call("_guiRelayout",D,re),D.emit("plotly_doubleclick",null)}function G(Y){return I.projection.invert([Y[0]+I.xaxis._offset,Y[1]+I.yaxis._offset])}var K=function(Y,re){if(re.isRect){var ue=Y.range={};ue[I.id]=[G([re.xmin,re.ymin]),G([re.xmax,re.ymax])]}else{var j=Y.lassoPoints={};j[I.id]=re.map(G)}},W={element:I.bgRect.node(),gd:D,plotinfo:{id:I.id,xaxis:I.xaxis,yaxis:I.yaxis,fillRangeItems:K},xaxes:[I.xaxis],yaxes:[I.yaxis],subplot:I.id,clickFn:function(Y){Y===2&&d(D)}};O==="pan"?(R.node().onmousedown=null,R.call(m(I,z)),R.on("dblclick.zoom",N),D._context._scrollZoom.geo||R.on("wheel.zoom",null)):(O==="select"||O==="lasso")&&(R.on(".zoom",null),W.prepFn=function(Y,re,ue){f(Y,re,ue,W,O)},v.init(W)),R.on("mousemove",function(){var Y=I.projection.invert(n.getPositionFromD3Event());if(!Y)return v.unhover(D,A.event);I.xaxis.p2c=function(){return Y[0]},I.yaxis.p2c=function(){return Y[1]},s.hover(D,A.event,I.id)}),R.on("mouseout",function(){D._dragging||v.unhover(D,A.event)}),R.on("click",function(){O!=="select"&&O!=="lasso"&&(F.indexOf("select")>-1&&o(A.event,D,[I.xaxis],[I.yaxis],I.id,W),F.indexOf("event")>-1&&s.click(D,A.event))})},u.makeFramework=function(){var P=this,z=P.graphDiv,I=z._fullLayout,D="clip"+I._uid+P.id;P.clipDef=I._clips.append("clipPath").attr("id",D),P.clipRect=P.clipDef.append("rect"),P.framework=A.select(P.container).append("g").attr("class","geo "+P.id).call(h.setClipUrl,D,z),P.project=function(R){var O=P.projection(R);return O?[O[0]-P.xaxis._offset,O[1]-P.yaxis._offset]:[null,null]},P.xaxis={_id:"x",c2p:function(R){return P.project(R)[0]}},P.yaxis={_id:"y",c2p:function(R){return P.project(R)[1]}},P.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},x.setConvert(P.mockAxis,I)},u.saveViewInitial=function(P){var z=P.center||{},I=P.projection,D=I.rotation||{};this.viewInitial={fitbounds:P.fitbounds,"projection.scale":I.scale};var R;P._isScoped?R={"center.lon":z.lon,"center.lat":z.lat}:P._isClipped?R={"projection.rotation.lon":D.lon,"projection.rotation.lat":D.lat}:R={"center.lon":z.lon,"center.lat":z.lat,"projection.rotation.lon":D.lon},n.extendFlat(this.viewInitial,R)},u.render=function(P){this._hasMarkerAngles&&P?this.plot(this._geoCalcData,this._fullLayout,[],!0):this._render()},u._render=function(){var P=this.projection,z=P.getPath(),I;function D(O){var F=P(O.lonlat);return F?r(F[0],F[1]):null}function R(O){return P.isLonLatOverEdges(O.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",z);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(O){return z(O.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",R).attr("transform",D)};function L(P){var z=P.projection,I=z.type,D=l.projNames[I];D="geo"+n.titleCase(D);for(var R=g[D]||e[D],O=R(),F=P._isSatellite?Math.acos(1/z.distance)*180/Math.PI:P._isClipped?l.lonaxisSpan[I]/2:null,N=["center","rotate","parallels","clipExtent"],G=function(Y){return Y?O:[]},K=0;K<N.length;K++){var W=N[K];typeof O[W]!="function"&&(O[W]=G)}return O.isLonLatOverEdges=function(Y){if(O(Y)===null)return!0;if(F){var re=O.rotate(),ue=M(Y,[-re[0],-re[1]]),j=F*Math.PI/180;return ue>j}else return!1},O.getPath=function(){return S().projection(O)},O.getBounds=function(Y){return O.getPath().bounds(Y)},O.precision(l.precision),P._isSatellite&&O.tilt(z.tilt).distance(z.distance),F&&O.clipAngle(F-l.clipPad),O}function T(P,z,I){var D=1e-6,R=2.5,O=z[P],F=l.scopeDefaults[z.scope],N,G,K;P==="lonaxis"?(N=F.lonaxisRange,G=F.lataxisRange,K=function($,ne){return[$,ne]}):P==="lataxis"&&(N=F.lataxisRange,G=F.lonaxisRange,K=function($,ne){return[ne,$]});var W={type:"linear",range:[N[0],N[1]-D],tick0:O.tick0,dtick:O.dtick};x.setConvert(W,I);var Y=x.calcTicks(W);!z.isScoped&&P==="lonaxis"&&Y.pop();for(var re=Y.length,ue=new Array(re),j=0;j<re;j++)for(var q=Y[j].x,H=ue[j]=[],U=G[0];U<G[1]+R;U+=R)H.push(K(q,U));return{type:"MultiLineString",coordinates:ue}}function k(P,z){var I=l.clipPad,D=P[0]+I,R=P[1]-I,O=z[0]+I,F=z[1]-I;D>0&&R<0&&(R+=360);var N=(R-D)/4;return{type:"Polygon",coordinates:[[[D,O],[D,F],[D+N,F],[D+2*N,F],[D+3*N,F],[R,F],[R,O],[R-N,O],[R-2*N,O],[R-3*N,O],[D,O]]]}}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(y,ee,te){var A=y("../../plots/get_data").getSubplotCalcData,g=y("../../lib").counterRegex,S=y("./geo"),M="geo",e=g(M),a={};a[M]={valType:"subplotid",dflt:M,editType:"calc"};function n(h){for(var s=h._fullLayout,i=h.calcdata,x=s._subplots[M],p=0;p<x.length;p++){var v=x[p],f=A(i,M,v),d=s[v],o=d._subplot;o||(o=S({id:v,graphDiv:h,container:s._geolayer.node(),topojsonURL:h._context.topojsonURL,staticPlot:h._context.staticPlot}),s[v]._subplot=o),o.plot(f,s,h._promises)}}function r(h,s,i,x){for(var p=x._subplots[M]||[],v=0;v<p.length;v++){var f=p[v],d=x[f]._subplot;!s[f]&&d&&(d.framework.remove(),d.clipDef.remove())}}function t(h){for(var s=h._fullLayout,i=s._subplots[M],x=0;x<i.length;x++){var p=s[i[x]],v=p._subplot;v.updateFx(s,p)}}ee.exports={attr:M,name:M,idRoot:M,idRegex:e,attrRegex:e,attributes:a,layoutAttributes:y("./layout_attributes"),supplyLayoutDefaults:y("./layout_defaults"),plot:n,updateFx:t,clean:r}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(y,ee,te){var A=y("../../components/color/attributes"),g=y("../domain").attributes,S=y("../../components/drawing/attributes").dash,M=y("./constants"),e=y("../../plot_api/edit_types").overrideAll,a=y("../../lib/sort_object_keys"),n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:A.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:S},r=ee.exports=e({domain:g({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:a(M.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:a(M.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:A.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:M.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:M.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:M.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:M.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:A.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:A.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:A.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:A.background},lonaxis:n,lataxis:n},"plot","from-root");r.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(y,ee,te){var A=y("../../lib"),g=y("../subplot_defaults"),S=y("../get_data").getSubplotData,M=y("./constants"),e=y("./layout_attributes"),a=M.axesNames;ee.exports=function(t,h,s){g(t,h,s,{type:"geo",attributes:e,handleDefaults:n,fullData:s,partition:"y"})};function n(r,t,h,s){var i=S(s.fullData,"geo",s.id),x=i.map(function(H){return H._expandedIndex}),p=h("resolution"),v=h("scope"),f=M.scopeDefaults[v],d=h("projection.type",f.projType),o=t._isAlbersUsa=d==="albers usa";o&&(v=t.scope="usa");var m=t._isScoped=v!=="world",l=t._isSatellite=d==="satellite",w=t._isConic=d.indexOf("conic")!==-1||d==="albers",_=t._isClipped=!!M.lonaxisSpan[d];if(r.visible===!1){var c=A.extendDeep({},t._template);c.showcoastlines=!1,c.showcountries=!1,c.showframe=!1,c.showlakes=!1,c.showland=!1,c.showocean=!1,c.showrivers=!1,c.showsubunits=!1,c.lonaxis&&(c.lonaxis.showgrid=!1),c.lataxis&&(c.lataxis.showgrid=!1),t._template=c}for(var b=h("visible"),u,L=0;L<a.length;L++){var T=a[L],k=[30,10][L],P;if(m)P=f[T+"Range"];else{var z=M[T+"Span"],I=(z[d]||z["*"])/2,D=h("projection.rotation."+T.substr(0,3),f.projRotate[L]);P=[D-I,D+I]}var R=h(T+".range",P);h(T+".tick0"),h(T+".dtick",k),u=h(T+".showgrid",b?void 0:!1),u&&(h(T+".gridcolor"),h(T+".gridwidth"),h(T+".griddash")),t[T]._ax={type:"linear",_id:T.slice(0,3),_traceIndices:x,setScale:A.identity,c2l:A.identity,r2l:A.identity,autorange:!0,range:R.slice(),_m:1,_input:{}}}var O=t.lonaxis.range,F=t.lataxis.range,N=O[0],G=O[1];N>0&&G<0&&(G+=360);var K=(N+G)/2,W;if(!o){var Y=m?f.projRotate:[K,0,0];W=h("projection.rotation.lon",Y[0]),h("projection.rotation.lat",Y[1]),h("projection.rotation.roll",Y[2]),u=h("showcoastlines",!m&&b),u&&(h("coastlinecolor"),h("coastlinewidth")),u=h("showocean",b?void 0:!1),u&&h("oceancolor")}var re,ue;if(o?(re=-96.6,ue=38.7):(re=m?K:W,ue=(F[0]+F[1])/2),h("center.lon",re),h("center.lat",ue),l&&(h("projection.tilt"),h("projection.distance")),w){var j=f.projParallels||[0,60];h("projection.parallels",j)}h("projection.scale"),u=h("showland",b?void 0:!1),u&&h("landcolor"),u=h("showlakes",b?void 0:!1),u&&h("lakecolor"),u=h("showrivers",b?void 0:!1),u&&(h("rivercolor"),h("riverwidth")),u=h("showcountries",m&&v!=="usa"&&b),u&&(h("countrycolor"),h("countrywidth")),(v==="usa"||v==="north america"&&p===50)&&(h("showsubunits",b),h("subunitcolor"),h("subunitwidth")),m||(u=h("showframe",b),u&&(h("framecolor"),h("framewidth"))),h("bgcolor");var q=h("fitbounds");q&&(delete t.projection.scale,m?(delete t.center.lon,delete t.center.lat):_?(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon,delete t.projection.rotation.lat,delete t.lonaxis.range,delete t.lataxis.range):(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon))}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../registry"),M=Math.PI/180,e=180/Math.PI,a={cursor:"pointer"},n={cursor:"auto"};function r(T,k){var P=T.projection,z;return k._isScoped?z=s:k._isClipped?z=x:z=i,z(T,P)}ee.exports=r;function t(T,k){return A.behavior.zoom().translate(k.translate()).scale(k.scale())}function h(T,k,P){var z=T.id,I=T.graphDiv,D=I.layout,R=D[z],O=I._fullLayout,F=O[z],N={},G={};function K(W,Y){N[z+"."+W]=g.nestedProperty(R,W).get(),S.call("_storeDirectGUIEdit",D,O._preGUI,N);var re=g.nestedProperty(F,W);re.get()!==Y&&(re.set(Y),g.nestedProperty(R,W).set(Y),G[z+"."+W]=Y)}P(K),K("projection.scale",k.scale()/T.fitScale),K("fitbounds",!1),I.emit("plotly_relayout",G)}function s(T,k){var P=t(T,k);function z(){A.select(this).style(a)}function I(){k.scale(A.event.scale).translate(A.event.translate),T.render(!0);var O=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":O[0],"geo.center.lat":O[1]})}function D(O){var F=k.invert(T.midPt);O("center.lon",F[0]),O("center.lat",F[1])}function R(){A.select(this).style(n),h(T,k,D)}return P.on("zoomstart",z).on("zoom",I).on("zoomend",R),P}function i(T,k){var P=t(T,k),z=2,I,D,R,O,F,N,G,K,W;function Y(U){return k.invert(U)}function re(U){var $=Y(U);if(!$)return!0;var ne=k($);return Math.abs(ne[0]-U[0])>z||Math.abs(ne[1]-U[1])>z}function ue(){A.select(this).style(a),I=A.mouse(this),D=k.rotate(),R=k.translate(),O=D,F=Y(I)}function j(){if(N=A.mouse(this),re(I)){P.scale(k.scale()),P.translate(k.translate());return}k.scale(A.event.scale),k.translate([R[0],A.event.translate[1]]),F?Y(N)&&(K=Y(N),G=[O[0]+(K[0]-F[0]),D[1],D[2]],k.rotate(G),O=G):(I=N,F=Y(I)),W=!0,T.render(!0);var U=k.rotate(),$=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":$[0],"geo.center.lat":$[1],"geo.projection.rotation.lon":-U[0]})}function q(){A.select(this).style(n),W&&h(T,k,H)}function H(U){var $=k.rotate(),ne=k.invert(T.midPt);U("projection.rotation.lon",-$[0]),U("center.lon",ne[0]),U("center.lat",ne[1])}return P.on("zoomstart",ue).on("zoom",j).on("zoomend",q),P}function x(T,k){k.rotate(),k.scale();var P=t(T,k),z=L(P,"zoomstart","zoom","zoomend"),I=0,D=P.on,R;P.on("zoomstart",function(){A.select(this).style(a);var K=A.mouse(this),W=k.rotate(),Y=W,re=k.translate(),ue=v(W);R=p(k,K),D.call(P,"zoom",function(){var j=A.mouse(this);if(k.scale(A.event.scale),!R)K=j,R=p(k,K);else if(p(k,j)){k.rotate(W).translate(re);var q=p(k,j),H=d(R,q),U=_(f(ue,H)),$=o(U,R,Y);(!isFinite($[0])||!isFinite($[1])||!isFinite($[2]))&&($=Y),k.rotate($),Y=$}F(z.of(this,arguments))}),O(z.of(this,arguments))}).on("zoomend",function(){A.select(this).style(n),D.call(P,"zoom",null),N(z.of(this,arguments)),h(T,k,G)}).on("zoom.redraw",function(){T.render(!0);var K=k.rotate();T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.projection.rotation.lon":-K[0],"geo.projection.rotation.lat":-K[1]})});function O(K){I++||K({type:"zoomstart"})}function F(K){K({type:"zoom"})}function N(K){--I||K({type:"zoomend"})}function G(K){var W=k.rotate();K("projection.rotation.lon",-W[0]),K("projection.rotation.lat",-W[1])}return A.rebind(P,z,"on")}function p(T,k){var P=T.invert(k);return P&&isFinite(P[0])&&isFinite(P[1])&&c(P)}function v(T){var k=.5*T[0]*M,P=.5*T[1]*M,z=.5*T[2]*M,I=Math.sin(k),D=Math.cos(k),R=Math.sin(P),O=Math.cos(P),F=Math.sin(z),N=Math.cos(z);return[D*O*N+I*R*F,I*O*N-D*R*F,D*R*N+I*O*F,D*O*F-I*R*N]}function f(T,k){var P=T[0],z=T[1],I=T[2],D=T[3],R=k[0],O=k[1],F=k[2],N=k[3];return[P*R-z*O-I*F-D*N,P*O+z*R+I*N-D*F,P*F-z*N+I*R+D*O,P*N+z*F-I*O+D*R]}function d(T,k){if(!(!T||!k)){var P=u(T,k),z=Math.sqrt(b(P,P)),I=.5*Math.acos(Math.max(-1,Math.min(1,b(T,k)))),D=Math.sin(I)/z;return z&&[Math.cos(I),P[2]*D,-P[1]*D,P[0]*D]}}function o(T,k,P){var z=w(k,2,T[0]);z=w(z,1,T[1]),z=w(z,0,T[2]-P[2]);var I=k[0],D=k[1],R=k[2],O=z[0],F=z[1],N=z[2],G=Math.atan2(D,I)*e,K=Math.sqrt(I*I+D*D),W,Y;Math.abs(F)>K?(Y=(F>0?90:-90)-G,W=0):(Y=Math.asin(F/K)*e-G,W=Math.sqrt(K*K-F*F));var re=180-Y-2*G,ue=(Math.atan2(N,O)-Math.atan2(R,W))*e,j=(Math.atan2(N,O)-Math.atan2(R,-W))*e,q=m(P[0],P[1],Y,ue),H=m(P[0],P[1],re,j);return q<=H?[Y,ue,P[2]]:[re,j,P[2]]}function m(T,k,P,z){var I=l(P-T),D=l(z-k);return Math.sqrt(I*I+D*D)}function l(T){return(T%360+540)%360-180}function w(T,k,P){var z=P*M,I=T.slice(),D=k===0?1:0,R=k===2?1:2,O=Math.cos(z),F=Math.sin(z);return I[D]=T[D]*O-T[R]*F,I[R]=T[R]*O+T[D]*F,I}function _(T){return[Math.atan2(2*(T[0]*T[1]+T[2]*T[3]),1-2*(T[1]*T[1]+T[2]*T[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(T[0]*T[2]-T[3]*T[1]))))*e,Math.atan2(2*(T[0]*T[3]+T[1]*T[2]),1-2*(T[2]*T[2]+T[3]*T[3]))*e]}function c(T){var k=T[0]*M,P=T[1]*M,z=Math.cos(P);return[z*Math.cos(k),z*Math.sin(k),Math.sin(P)]}function b(T,k){for(var P=0,z=0,I=T.length;z<I;++z)P+=T[z]*k[z];return P}function u(T,k){return[T[1]*k[2]-T[2]*k[1],T[2]*k[0]-T[0]*k[2],T[0]*k[1]-T[1]*k[0]]}function L(T){for(var k=0,P=arguments.length,z=[];++k<P;)z.push(arguments[k]);var I=A.dispatch.apply(null,z);return I.of=function(D,R){return function(O){var F;try{F=O.sourceEvent=A.event,O.target=T,A.event=O,I[O.type].apply(D,R)}finally{A.event=F}}},I}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(y,ee,te){var A=y("../registry"),g=y("./cartesian/constants").SUBPLOT_PATTERN;te.getSubplotCalcData=function(S,M,e){var a=A.subplotsRegistry[M];if(!a)return[];for(var n=a.attr,r=[],t=0;t<S.length;t++){var h=S[t],s=h[0].trace;s[n]===e&&r.push(h)}return r},te.getModuleCalcData=function(S,M){var e=[],a=[],n;if(typeof M=="string"?n=A.getModule(M).plot:typeof M=="function"?n=M:n=M.plot,!n)return[e,S];for(var r=0;r<S.length;r++){var t=S[r],h=t[0].trace;h.visible!==!0||h._length===0||(h._module.plot===n?e.push(t):a.push(t))}return[e,a]},te.getSubplotData=function(M,e,a){if(!A.subplotsRegistry[e])return[];var n=A.subplotsRegistry[e].attr,r=[],t,h,s;if(e==="gl2d"){var i=a.match(g);h="x"+i[1],s="y"+i[2]}for(var x=0;x<M.length;x++)t=M[x],e==="gl2d"&&A.traceIs(t,"gl2d")?t[n[0]]===h&&t[n[1]]===s&&r.push(t):t[n]===a&&r.push(t);return r}},{"../registry":647,"./cartesian/constants":573}],603:[function(y,ee,te){var A=y("mouse-change"),g=y("mouse-wheel"),S=y("mouse-event-offset"),M=y("../cartesian/constants"),e=y("has-passive-events");ee.exports=n;function a(r,t){this.element=r,this.plot=t,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}function n(r){var t=r.mouseContainer,h=r.glplot,s=new a(t,h);function i(){r.xaxis.autorange=!1,r.yaxis.autorange=!1}function x(){for(var v=r.graphDiv._fullLayout._axisConstraintGroups,f=r.xaxis._id,d=r.yaxis._id,o=0;o<v.length;o++)if(v[o][f]!==-1){if(v[o][d]!==-1)return!0;break}return!1}s.mouseListener=A(t,p),t.addEventListener("touchstart",function(v){var f=S(v.changedTouches[0],t);p(0,f[0],f[1]),p(1,f[0],f[1]),v.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchmove",function(v){v.preventDefault();var f=S(v.changedTouches[0],t);p(1,f[0],f[1]),v.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchend",function(v){p(0,s.lastPos[0],s.lastPos[1]),v.preventDefault()},e?{passive:!1}:!1);function p(v,f,d){var o=r.calcDataBox(),m=h.viewBox,l=s.lastPos[0],w=s.lastPos[1],_=M.MINDRAG*h.pixelRatio,c=M.MINZOOM*h.pixelRatio,b,u;f*=h.pixelRatio,d*=h.pixelRatio,d=m[3]-m[1]-d;function L(D,R,O){var F=Math.min(R,O),N=Math.max(R,O);F!==N?(o[D]=F,o[D+2]=N,s.dataBox=o,r.setRanges(o)):(r.selectBox.selectBox=[0,0,1,1],r.glplot.setDirty())}switch(r.fullLayout.dragmode){case"zoom":if(v){var T=f/(m[2]-m[0])*(o[2]-o[0])+o[0],k=d/(m[3]-m[1])*(o[3]-o[1])+o[1];s.boxInited||(s.boxStart[0]=T,s.boxStart[1]=k,s.dragStart[0]=f,s.dragStart[1]=d),s.boxEnd[0]=T,s.boxEnd[1]=k,s.boxInited=!0,!s.boxEnabled&&(s.boxStart[0]!==s.boxEnd[0]||s.boxStart[1]!==s.boxEnd[1])&&(s.boxEnabled=!0);var P=Math.abs(s.dragStart[0]-f)<c,z=Math.abs(s.dragStart[1]-d)<c;if(x()&&!(P&&z)){b=s.boxEnd[0]-s.boxStart[0],u=s.boxEnd[1]-s.boxStart[1];var I=(o[3]-o[1])/(o[2]-o[0]);Math.abs(b*I)>Math.abs(u)?(s.boxEnd[1]=s.boxStart[1]+Math.abs(b)*I*(u>=0?1:-1),s.boxEnd[1]<o[1]?(s.boxEnd[1]=o[1],s.boxEnd[0]=s.boxStart[0]+(o[1]-s.boxStart[1])/Math.abs(I)):s.boxEnd[1]>o[3]&&(s.boxEnd[1]=o[3],s.boxEnd[0]=s.boxStart[0]+(o[3]-s.boxStart[1])/Math.abs(I))):(s.boxEnd[0]=s.boxStart[0]+Math.abs(u)/I*(b>=0?1:-1),s.boxEnd[0]<o[0]?(s.boxEnd[0]=o[0],s.boxEnd[1]=s.boxStart[1]+(o[0]-s.boxStart[0])*Math.abs(I)):s.boxEnd[0]>o[2]&&(s.boxEnd[0]=o[2],s.boxEnd[1]=s.boxStart[1]+(o[2]-s.boxStart[0])*Math.abs(I)))}else P&&(s.boxEnd[0]=s.boxStart[0]),z&&(s.boxEnd[1]=s.boxStart[1])}else s.boxEnabled?(b=s.boxStart[0]!==s.boxEnd[0],u=s.boxStart[1]!==s.boxEnd[1],b||u?(b&&(L(0,s.boxStart[0],s.boxEnd[0]),r.xaxis.autorange=!1),u&&(L(1,s.boxStart[1],s.boxEnd[1]),r.yaxis.autorange=!1),r.relayoutCallback()):r.glplot.setDirty(),s.boxEnabled=!1,s.boxInited=!1):s.boxInited&&(s.boxInited=!1);break;case"pan":s.boxEnabled=!1,s.boxInited=!1,v?(s.panning||(s.dragStart[0]=f,s.dragStart[1]=d),Math.abs(s.dragStart[0]-f)<_&&(f=s.dragStart[0]),Math.abs(s.dragStart[1]-d)<_&&(d=s.dragStart[1]),b=(l-f)*(o[2]-o[0])/(h.viewBox[2]-h.viewBox[0]),u=(w-d)*(o[3]-o[1])/(h.viewBox[3]-h.viewBox[1]),o[0]+=b,o[2]+=b,o[1]+=u,o[3]+=u,r.setRanges(o),s.panning=!0,s.lastInputTime=Date.now(),i(),r.cameraChanged(),r.handleAnnotations()):s.panning&&(s.panning=!1,r.relayoutCallback());break}s.lastPos[0]=f,s.lastPos[1]=d}return s.wheelListener=g(t,function(v,f){if(!r.scrollZoom)return!1;var d=r.calcDataBox(),o=h.viewBox,m=s.lastPos[0],l=s.lastPos[1],w=Math.exp(5*f/(o[3]-o[1])),_=m/(o[2]-o[0])*(d[2]-d[0])+d[0],c=l/(o[3]-o[1])*(d[3]-d[1])+d[1];return d[0]=(d[0]-_)*w+_,d[2]=(d[2]-_)*w+_,d[1]=(d[1]-c)*w+c,d[3]=(d[3]-c)*w+c,r.setRanges(d),s.lastInputTime=Date.now(),i(),r.cameraChanged(),r.handleAnnotations(),r.relayoutCallback(),!0},!0),s}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(y,ee,te){var A=y("../cartesian/axes"),g=y("../../lib/str2rgbarray");function S(n){this.scene=n,this.gl=n.gl,this.pixelRatio=n.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var M=S.prototype,e=["xaxis","yaxis"];M.merge=function(n){this.titleEnable=!1,this.backgroundColor=g(n.plot_bgcolor);var r,t,h,s,i,x,p,v,f,d,o;for(d=0;d<2;++d){r=e[d];var m=r.charAt(0);for(t=n[this.scene[r]._name],h=t.title.text===this.scene.fullLayout._dfltTitle[m]?"":t.title.text,o=0;o<=2;o+=2)this.labelEnable[d+o]=!1,this.labels[d+o]=h,this.labelColor[d+o]=g(t.title.font.color),this.labelFont[d+o]=t.title.font.family,this.labelSize[d+o]=t.title.font.size,this.labelPad[d+o]=this.getLabelPad(r,t),this.tickEnable[d+o]=!1,this.tickColor[d+o]=g((t.tickfont||{}).color),this.tickAngle[d+o]=t.tickangle==="auto"?0:Math.PI*-t.tickangle/180,this.tickPad[d+o]=this.getTickPad(t),this.tickMarkLength[d+o]=0,this.tickMarkWidth[d+o]=t.tickwidth||0,this.tickMarkColor[d+o]=g(t.tickcolor),this.borderLineEnable[d+o]=!1,this.borderLineColor[d+o]=g(t.linecolor),this.borderLineWidth[d+o]=t.linewidth||0;p=this.hasSharedAxis(t),i=this.hasAxisInDfltPos(r,t)&&!p,x=this.hasAxisInAltrPos(r,t)&&!p,s=t.mirror||!1,v=p?String(s).indexOf("all")!==-1:!!s,f=p?s==="allticks":String(s).indexOf("ticks")!==-1,i?this.labelEnable[d]=!0:x&&(this.labelEnable[d+2]=!0),i?this.tickEnable[d]=t.showticklabels:x&&(this.tickEnable[d+2]=t.showticklabels),(i||v)&&(this.borderLineEnable[d]=t.showline),(x||v)&&(this.borderLineEnable[d+2]=t.showline),(i||f)&&(this.tickMarkLength[d]=this.getTickMarkLength(t)),(x||f)&&(this.tickMarkLength[d+2]=this.getTickMarkLength(t)),this.gridLineEnable[d]=t.showgrid,this.gridLineColor[d]=g(t.gridcolor),this.gridLineWidth[d]=t.gridwidth,this.zeroLineEnable[d]=t.zeroline,this.zeroLineColor[d]=g(t.zerolinecolor),this.zeroLineWidth[d]=t.zerolinewidth}},M.hasSharedAxis=function(n){var r=this.scene,t=r.fullLayout._subplots.gl2d,h=A.findSubplotsWithAxis(t,n);return h.indexOf(r.id)!==0},M.hasAxisInDfltPos=function(n,r){var t=r.side;if(n==="xaxis")return t==="bottom";if(n==="yaxis")return t==="left"},M.hasAxisInAltrPos=function(n,r){var t=r.side;if(n==="xaxis")return t==="top";if(n==="yaxis")return t==="right"},M.getLabelPad=function(n,r){var t=1.5,h=r.title.font.size,s=r.showticklabels;if(n==="xaxis")return r.side==="top"?-10+h*(t+(s?1:0)):-10+h*(t+(s?.5:0));if(n==="yaxis")return r.side==="right"?10+h*(t+(s?1:.5)):10+h*(t+(s?.5:0))},M.getTickPad=function(n){return n.ticks==="outside"?10+n.ticklen:15},M.getTickMarkLength=function(n){if(!n.ticks)return 0;var r=n.ticklen;return n.ticks==="inside"?-r:r};function a(n){return new S(n)}ee.exports=a},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(y,ee,te){var A=y("../../plot_api/edit_types").overrideAll,g=y("./scene2d"),S=y("../layout_attributes"),M=y("../../constants/xmlns_namespaces"),e=y("../cartesian/constants"),a=y("../cartesian"),n=y("../../components/fx/layout_attributes"),r=y("../get_data").getSubplotData;te.name="gl2d",te.attr=["xaxis","yaxis"],te.idRoot=["x","y"],te.idRegex=e.idRegex,te.attrRegex=e.attrRegex,te.attributes=y("../cartesian/attributes"),te.supplyLayoutDefaults=function(t,h,s){h._has("cartesian")||a.supplyLayoutDefaults(t,h,s)},te.layoutAttrOverrides=A(a.layoutAttributes,"plot","from-root"),te.baseLayoutAttrOverrides=A({plot_bgcolor:S.plot_bgcolor,hoverlabel:n.hoverlabel},"plot","nested"),te.plot=function(h){for(var s=h._fullLayout,i=h._fullData,x=s._subplots.gl2d,p=0;p<x.length;p++){var v=x[p],f=s._plots[v],d=r(i,"gl2d",v),o=f._scene2d;o===void 0&&(o=new g({id:v,graphDiv:h,container:h.querySelector(".gl-container"),staticPlot:h._context.staticPlot,plotGlPixelRatio:h._context.plotGlPixelRatio},s),f._scene2d=o),o.plot(d,h.calcdata,s,h.layout)}},te.clean=function(t,h,s,i){for(var x=i._subplots.gl2d||[],p=0;p<x.length;p++){var v=x[p],f=i._plots[v];if(f._scene2d){var d=r(t,"gl2d",v);d.length===0&&(f._scene2d.destroy(),delete i._plots[v])}}a.clean.apply(this,arguments)},te.drawFramework=function(t){t._context.staticPlot||a.drawFramework(t)},te.toSVG=function(t){for(var h=t._fullLayout,s=h._subplots.gl2d,i=0;i<s.length;i++){var x=h._plots[s[i]],p=x._scene2d,v=p.toImage("png"),f=h._glimages.append("svg:image");f.attr({xmlns:M.svg,"xlink:href":v,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),p.destroy()}},te.updateFx=function(t){for(var h=t._fullLayout,s=h._subplots.gl2d,i=0;i<s.length;i++){var x=h._plots[s[i]]._scene2d;x.updateFx(h.dragmode)}}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(y,ee,te){var A=y("../../registry"),g=y("../../plots/cartesian/axes"),S=y("../../components/fx"),M=y("../../../stackgl_modules").gl_plot2d,e=y("../../../stackgl_modules").gl_spikes2d,a=y("../../../stackgl_modules").gl_select_box,n=y("webgl-context"),r=y("./convert"),t=y("./camera"),h=y("../../lib/show_no_webgl_msg"),s=y("../cartesian/constraints"),i=s.enforce,x=s.clean,p=y("../cartesian/autorange").doAutoRange,v=y("../../components/dragelement/helpers"),f=v.drawMode,d=v.selectMode,o=["xaxis","yaxis"],m,l,w=y("../cartesian/constants").SUBPLOT_PATTERN;function _(u,L){this.container=u.container,this.graphDiv=u.graphDiv,this.pixelRatio=u.plotGlPixelRatio||window.devicePixelRatio,this.id=u.id,this.staticPlot=!!u.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),!this.stopped&&(this.glplotOptions=r(this),this.glplotOptions.merge(L),this.glplot=M(this.glplotOptions),this.camera=t(this),this.traces={},this.spikes=e(this.glplot),this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}ee.exports=_;var c=_.prototype;c.makeFramework=function(){if(this.staticPlot){if(!l&&(m=document.createElement("canvas"),l=n({canvas:m,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!l))throw new Error("Error creating static canvas/context for image server");this.canvas=m,this.gl=l}else{var u=this.container.querySelector(".gl-canvas-focus"),L=n({canvas:u,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L){h(this),this.stopped=!0;return}this.canvas=u,this.gl=L}var T=this.canvas;T.style.width="100%",T.style.height="100%",T.style.position="absolute",T.style.top="0px",T.style.left="0px",T.style["pointer-events"]="none",this.updateSize(T);var k=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");k.style.position="absolute",k.style.top=k.style.left="0px",k.style.width=k.style.height="100%",k.style["z-index"]=20,k.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var z=this.container;z.appendChild(k),z.appendChild(P);var I=this;P.addEventListener("mouseout",function(){I.isMouseOver=!1,I.unhover()}),P.addEventListener("mouseover",function(){I.isMouseOver=!0})},c.toImage=function(u){u||(u="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(m),this.updateSize(this.canvas);var L=this.glplot.gl,T=L.drawingBufferWidth,k=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(T*k*4);L.readPixels(0,0,T,k,L.RGBA,L.UNSIGNED_BYTE,P);for(var z=0,I=k-1;z<I;++z,--I)for(var D=0;D<T;++D)for(var R=0;R<4;++R){var O=P[4*(T*z+D)+R];P[4*(T*z+D)+R]=P[4*(T*I+D)+R],P[4*(T*I+D)+R]=O}var F=document.createElement("canvas");F.width=T,F.height=k;var N=F.getContext("2d",{willReadFrequently:!0}),G=N.createImageData(T,k);G.data.set(P),N.putImageData(G,0,0);var K;switch(u){case"jpeg":K=F.toDataURL("image/jpeg");break;case"webp":K=F.toDataURL("image/webp");break;default:K=F.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(m),K},c.updateSize=function(u){u||(u=this.canvas);var L=this.pixelRatio,T=this.fullLayout,k=T.width,P=T.height,z=Math.ceil(L*k)|0,I=Math.ceil(L*P)|0;return(u.width!==z||u.height!==I)&&(u.width=z,u.height=I),u},c.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var u=[g.calcTicks(this.xaxis),g.calcTicks(this.yaxis)],L=0;L<2;++L)for(var T=0;T<u[L].length;++T)u[L][T].text=u[L][T].text+"";return u};function b(u,L){for(var T=0;T<2;++T){var k=u[T],P=L[T];if(k.length!==P.length)return!0;for(var z=0;z<k.length;++z)if(k[z].x!==P[z].x)return!0}return!1}c.updateRefs=function(u){this.fullLayout=u;var L=this.id.match(w),T="xaxis"+L[1],k="yaxis"+L[2];this.xaxis=this.fullLayout[T],this.yaxis=this.fullLayout[k]},c.relayoutCallback=function(){var u=this.graphDiv,L=this.xaxis,T=this.yaxis,k=u.layout,P={},z=P[L._name+".range"]=L.range.slice(),I=P[T._name+".range"]=T.range.slice();P[L._name+".autorange"]=L.autorange,P[T._name+".autorange"]=T.autorange,A.call("_storeDirectGUIEdit",u.layout,u._fullLayout._preGUI,P);var D=k[L._name];D.range=z,D.autorange=L.autorange;var R=k[T._name];R.range=I,R.autorange=T.autorange,P.lastInputTime=this.camera.lastInputTime,u.emit("plotly_relayout",P)},c.cameraChanged=function(){var u=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks(),T=this.glplotOptions.ticks;b(L,T)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=u.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},c.handleAnnotations=function(){for(var u=this.graphDiv,L=this.fullLayout.annotations,T=0;T<L.length;T++){var k=L[T];k.xref===this.xaxis._id&&k.yref===this.yaxis._id&&A.getComponentMethod("annotations","drawOne")(u,T)}},c.destroy=function(){if(this.glplot){var u=this.traces;u&&Object.keys(u).map(function(L){u[L].dispose(),delete u[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},c.plot=function(u,L,T){var k=this.glplot;this.updateRefs(T),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(u,L),this.updateFx(T.dragmode);var P=T.width,z=T.height;this.updateSize(this.canvas);var I=this.glplotOptions;I.merge(T),I.screenBox=[0,0,P,z];var D={_fullLayout:{_axisConstraintGroups:T._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:T._size}};x(D,this.xaxis),x(D,this.yaxis);var R=T._size,O=this.xaxis.domain,F=this.yaxis.domain;I.viewBox=[R.l+O[0]*R.w,R.b+F[0]*R.h,P-R.r-(1-O[1])*R.w,z-R.t-(1-F[1])*R.h],this.mouseContainer.style.width=R.w*(O[1]-O[0])+"px",this.mouseContainer.style.height=R.h*(F[1]-F[0])+"px",this.mouseContainer.height=R.h*(F[1]-F[0]),this.mouseContainer.style.left=R.l+O[0]*R.w+"px",this.mouseContainer.style.top=R.t+(1-F[1])*R.h+"px";var N,G;for(G=0;G<2;++G)N=this[o[G]],N._length=I.viewBox[G+2]-I.viewBox[G],p(this.graphDiv,N),N.setScale();i(D),I.ticks=this.computeTickMarks(),I.dataBox=this.calcDataBox(),I.merge(T),k.update(I),this.glplot.draw()},c.calcDataBox=function(){var u=this.xaxis,L=this.yaxis,T=u.range,k=L.range,P=u.r2l,z=L.r2l;return[P(T[0]),z(k[0]),P(T[1]),z(k[1])]},c.setRanges=function(u){var L=this.xaxis,T=this.yaxis,k=L.l2r,P=T.l2r;L.range=[k(u[0]),k(u[2])],T.range=[P(u[1]),P(u[3])]},c.updateTraces=function(u,L){var T=Object.keys(this.traces),k,P,z;this.fullData=u;e:for(k=0;k<T.length;k++){var I=T[k],D=this.traces[I];for(P=0;P<u.length;P++)if(z=u[P],z.uid===I&&z.type===D.type)continue e;D.dispose(),delete this.traces[I]}for(k=0;k<u.length;k++){z=u[k];var R=L[k],O=this.traces[z.uid];O?O.update(z,R):(O=z._module.plot(this,z,R),this.traces[z.uid]=O)}this.glplot.objects.sort(function(F,N){return F._trace.index-N._trace.index})},c.updateFx=function(u){d(u)||f(u)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),u==="pan"?this.mouseContainer.style.cursor="move":u==="zoom"?this.mouseContainer.style.cursor="crosshair":this.mouseContainer.style.cursor=null},c.emitPointAction=function(u,L){for(var T=u.trace.uid,k=u.pointIndex,P,z=0;z<this.fullData.length;z++)this.fullData[z].uid===T&&(P=this.fullData[z]);var I={x:u.traceCoord[0],y:u.traceCoord[1],curveNumber:P.index,pointNumber:k,data:P._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};S.appendArrayPointValue(I,P,k),this.graphDiv.emit(L,{points:[I]})},c.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var u=this.glplot,L=this.camera,T=L.mouseListener,k=this.lastButtonState===1&&T.buttons===0,P=this.fullLayout;this.lastButtonState=T.buttons,this.cameraChanged();var z=T.x*u.pixelRatio,I=this.canvas.height-u.pixelRatio*T.y,D;if(L.boxEnabled&&P.dragmode==="zoom"){this.selectBox.enabled=!0;for(var R=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],O=0;O<2;O++)L.boxStart[O]===L.boxEnd[O]&&(R[O]=u.dataBox[O],R[O+2]=u.dataBox[O+2]);u.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var F=P._size,N=this.xaxis.domain,G=this.yaxis.domain;D=u.pick(z/u.pixelRatio+F.l+N[0]*F.w,I/u.pixelRatio-(F.t+(1-G[1])*F.h));var K=D&&D.object._trace.handlePick(D);if(K&&k&&this.emitPointAction(K,"plotly_click"),D&&D.object._trace.hoverinfo!=="skip"&&P.hovermode&&K&&(!this.lastPickResult||this.lastPickResult.traceUid!==K.trace.uid||this.lastPickResult.dataCoord[0]!==K.dataCoord[0]||this.lastPickResult.dataCoord[1]!==K.dataCoord[1])){var W=K;this.lastPickResult={traceUid:K.trace?K.trace.uid:null,dataCoord:K.dataCoord.slice()},this.spikes.update({center:D.dataCoord}),W.screenCoord=[((u.viewBox[2]-u.viewBox[0])*(D.dataCoord[0]-u.dataBox[0])/(u.dataBox[2]-u.dataBox[0])+u.viewBox[0])/u.pixelRatio,(this.canvas.height-(u.viewBox[3]-u.viewBox[1])*(D.dataCoord[1]-u.dataBox[1])/(u.dataBox[3]-u.dataBox[1])-u.viewBox[1])/u.pixelRatio],this.emitPointAction(K,"plotly_hover");var Y=this.fullData[W.trace.index]||{},re=W.pointIndex,ue=S.castHoverinfo(Y,P,re);if(ue&&ue!=="all"){var j=ue.split("+");j.indexOf("x")===-1&&(W.traceCoord[0]=void 0),j.indexOf("y")===-1&&(W.traceCoord[1]=void 0),j.indexOf("z")===-1&&(W.traceCoord[2]=void 0),j.indexOf("text")===-1&&(W.textLabel=void 0),j.indexOf("name")===-1&&(W.name=void 0)}S.loneHover({x:W.screenCoord[0],y:W.screenCoord[1],xLabel:this.hoverFormatter("xaxis",W.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",W.traceCoord[1]),zLabel:W.traceCoord[2],text:W.textLabel,name:W.name,color:S.castHoverOption(Y,re,"bgcolor")||W.color,borderColor:S.castHoverOption(Y,re,"bordercolor"),fontFamily:S.castHoverOption(Y,re,"font.family"),fontSize:S.castHoverOption(Y,re,"font.size"),fontColor:S.castHoverOption(Y,re,"font.color"),nameLength:S.castHoverOption(Y,re,"namelength"),textAlign:S.castHoverOption(Y,re,"align")},{container:this.svgContainer,gd:this.graphDiv})}}D||this.unhover(),u.draw()}},c.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),S.loneUnhover(this.svgContainer))},c.hoverFormatter=function(u,L){if(L!==void 0){var T=this[u];return g.tickText(T,T.c2l(L),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(y,ee,te){var A=y("../../plot_api/edit_types").overrideAll,g=y("../../components/fx/layout_attributes"),S=y("./scene"),M=y("../get_data").getSubplotData,e=y("../../lib"),a=y("../../constants/xmlns_namespaces"),n="gl3d",r="scene";te.name=n,te.attr=r,te.idRoot=r,te.idRegex=te.attrRegex=e.counterRegex("scene"),te.attributes=y("./layout/attributes"),te.layoutAttributes=y("./layout/layout_attributes"),te.baseLayoutAttrOverrides=A({hoverlabel:g.hoverlabel},"plot","nested"),te.supplyLayoutDefaults=y("./layout/defaults"),te.plot=function(h){for(var s=h._fullLayout,i=h._fullData,x=s._subplots[n],p=0;p<x.length;p++){var v=x[p],f=M(i,n,v),d=s[v],o=d.camera,m=d._scene;m||(m=new S({id:v,graphDiv:h,container:h.querySelector(".gl-container"),staticPlot:h._context.staticPlot,plotGlPixelRatio:h._context.plotGlPixelRatio,camera:o},s),d._scene=m),m.viewInitial||(m.viewInitial={up:{x:o.up.x,y:o.up.y,z:o.up.z},eye:{x:o.eye.x,y:o.eye.y,z:o.eye.z},center:{x:o.center.x,y:o.center.y,z:o.center.z}}),m.plot(f,s,h.layout)}},te.clean=function(t,h,s,i){for(var x=i._subplots[n]||[],p=0;p<x.length;p++){var v=x[p];!h[v]&&i[v]._scene&&(i[v]._scene.destroy(),i._infolayer&&i._infolayer.selectAll(".annotation-"+v).remove())}},te.toSVG=function(t){for(var h=t._fullLayout,s=h._subplots[n],i=h._size,x=0;x<s.length;x++){var p=h[s[x]],v=p.domain,f=p._scene,d=f.toImage("png"),o=h._glimages.append("svg:image");o.attr({xmlns:a.svg,"xlink:href":d,x:i.l+i.w*v.x[0],y:i.t+i.h*(1-v.y[1]),width:i.w*(v.x[1]-v.x[0]),height:i.h*(v.y[1]-v.y[0]),preserveAspectRatio:"none"}),f.destroy()}},te.cleanId=function(h){if(h.match(/^scene[0-9]*$/)){var s=h.substr(5);return s==="1"&&(s=""),r+s}},te.updateFx=function(t){for(var h=t._fullLayout,s=h._subplots[n],i=0;i<s.length;i++){var x=h[s[i]]._scene;x.updateFx(h.dragmode,h.hovermode)}}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(y,ee,te){ee.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(y,ee,te){var A=y("../../../components/color"),g=y("../../cartesian/layout_attributes"),S=y("../../../lib/extend").extendFlat,M=y("../../../plot_api/edit_types").overrideAll;ee.exports=M({visible:g.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:A.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:g.color,categoryorder:g.categoryorder,categoryarray:g.categoryarray,title:{text:g.title.text,font:g.title.font},type:S({},g.type,{values:["-","linear","log","date","category"]}),autotypenumbers:g.autotypenumbers,autorange:g.autorange,rangemode:g.rangemode,range:S({},g.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,mirror:g.mirror,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,showticklabels:g.showticklabels,tickfont:g.tickfont,tickangle:g.tickangle,tickprefix:g.tickprefix,showtickprefix:g.showtickprefix,ticksuffix:g.ticksuffix,showticksuffix:g.showticksuffix,showexponent:g.showexponent,exponentformat:g.exponentformat,minexponent:g.minexponent,separatethousands:g.separatethousands,tickformat:g.tickformat,tickformatstops:g.tickformatstops,hoverformat:g.hoverformat,showline:g.showline,linecolor:g.linecolor,linewidth:g.linewidth,showgrid:g.showgrid,gridcolor:S({},g.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:g.gridwidth,zeroline:g.zeroline,zerolinecolor:g.zerolinecolor,zerolinewidth:g.zerolinewidth,_deprecated:{title:g._deprecated.title,titlefont:g._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(y,ee,te){var A=y("tinycolor2").mix,g=y("../../../lib"),S=y("../../../plot_api/plot_template"),M=y("./axis_attributes"),e=y("../../cartesian/type_defaults"),a=y("../../cartesian/axis_defaults"),n=["xaxis","yaxis","zaxis"],r=100*(204-68)/(255-68);ee.exports=function(h,s,i){var x,p;function v(o,m){return g.coerce(x,p,M,o,m)}for(var f=0;f<n.length;f++){var d=n[f];x=h[d]||{},p=S.newContainer(s,d),p._id=d[0]+i.scene,p._name=d,e(x,p,v,i),a(x,p,v,{font:i.font,letter:d[0],data:i.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:i.bgColor,calendar:i.calendar},i.fullLayout),v("gridcolor",A(p.color,i.bgColor,r).toRgbString()),v("title.text",d[0]),p.setScale=g.noop,v("showspikes")&&(v("spikesides"),v("spikethickness"),v("spikecolor",p.color)),v("showaxeslabels"),v("showbackground")&&v("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(y,ee,te){var A=y("../../../lib/str2rgbarray"),g=y("../../../lib"),S=["xaxis","yaxis","zaxis"];function M(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var e=M.prototype;e.merge=function(n,r){for(var t=this,h=0;h<3;++h){var s=r[S[h]];if(!s.visible){t.tickEnable[h]=!1,t.labelEnable[h]=!1,t.lineEnable[h]=!1,t.lineTickEnable[h]=!1,t.gridEnable[h]=!1,t.zeroEnable[h]=!1,t.backgroundEnable[h]=!1;continue}t.labels[h]=n._meta?g.templateString(s.title.text,n._meta):s.title.text,"font"in s.title&&(s.title.font.color&&(t.labelColor[h]=A(s.title.font.color)),s.title.font.family&&(t.labelFont[h]=s.title.font.family),s.title.font.size&&(t.labelSize[h]=s.title.font.size)),"showline"in s&&(t.lineEnable[h]=s.showline),"linecolor"in s&&(t.lineColor[h]=A(s.linecolor)),"linewidth"in s&&(t.lineWidth[h]=s.linewidth),"showgrid"in s&&(t.gridEnable[h]=s.showgrid),"gridcolor"in s&&(t.gridColor[h]=A(s.gridcolor)),"gridwidth"in s&&(t.gridWidth[h]=s.gridwidth),s.type==="log"?t.zeroEnable[h]=!1:"zeroline"in s&&(t.zeroEnable[h]=s.zeroline),"zerolinecolor"in s&&(t.zeroLineColor[h]=A(s.zerolinecolor)),"zerolinewidth"in s&&(t.zeroLineWidth[h]=s.zerolinewidth),"ticks"in s&&s.ticks?t.lineTickEnable[h]=!0:t.lineTickEnable[h]=!1,"ticklen"in s&&(t.lineTickLength[h]=t._defaultLineTickLength[h]=s.ticklen),"tickcolor"in s&&(t.lineTickColor[h]=A(s.tickcolor)),"tickwidth"in s&&(t.lineTickWidth[h]=s.tickwidth),"tickangle"in s&&(t.tickAngle[h]=s.tickangle==="auto"?-3600:Math.PI*-s.tickangle/180),"showticklabels"in s&&(t.tickEnable[h]=s.showticklabels),"tickfont"in s&&(s.tickfont.color&&(t.tickColor[h]=A(s.tickfont.color)),s.tickfont.family&&(t.tickFont[h]=s.tickfont.family),s.tickfont.size&&(t.tickSize[h]=s.tickfont.size)),"mirror"in s?["ticks","all","allticks"].indexOf(s.mirror)!==-1?(t.lineTickMirror[h]=!0,t.lineMirror[h]=!0):s.mirror===!0?(t.lineTickMirror[h]=!1,t.lineMirror[h]=!0):(t.lineTickMirror[h]=!1,t.lineMirror[h]=!1):t.lineMirror[h]=!1,"showbackground"in s&&s.showbackground!==!1?(t.backgroundEnable[h]=!0,t.backgroundColor[h]=A(s.backgroundcolor)):t.backgroundEnable[h]=!1}};function a(n,r){var t=new M;return t.merge(n,r),t}ee.exports=a},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(y,ee,te){var A=y("../../../lib"),g=y("../../../components/color"),S=y("../../../registry"),M=y("../../subplot_defaults"),e=y("./axis_defaults"),a=y("./layout_attributes"),n=y("../../get_data").getSubplotData,r="gl3d";ee.exports=function(s,i,x){var p=i._basePlotModules.length>1;function v(f){if(!p){var d=A.validate(s[f],a[f]);if(d)return s[f]}}M(s,i,x,{type:r,attributes:a,handleDefaults:t,fullLayout:i,font:i.font,fullData:x,getDfltFromLayout:v,autotypenumbersDflt:i.autotypenumbers,paper_bgcolor:i.paper_bgcolor,calendar:i.calendar})};function t(h,s,i,x){for(var p=i("bgcolor"),v=g.combine(p,x.paper_bgcolor),f=["up","center","eye"],d=0;d<f.length;d++)i("camera."+f[d]+".x"),i("camera."+f[d]+".y"),i("camera."+f[d]+".z");i("camera.projection.type");var o=!!i("aspectratio.x")&&!!i("aspectratio.y")&&!!i("aspectratio.z"),m=o?"manual":"auto",l=i("aspectmode",m);o||(h.aspectratio=s.aspectratio={x:1,y:1,z:1},l==="manual"&&(s.aspectmode="auto"),h.aspectmode=s.aspectmode);var w=n(x.fullData,r,x.id);e(h,s,{font:x.font,scene:x.id,data:w,bgColor:v,calendar:x.calendar,autotypenumbersDflt:x.autotypenumbersDflt,fullLayout:x.fullLayout}),S.getComponentMethod("annotations3d","handleDefaults")(h,s,x);var _=x.getDfltFromLayout("dragmode");if(_!==!1&&!_)if(_="orbit",h.camera&&h.camera.up){var c=h.camera.up.x,b=h.camera.up.y,u=h.camera.up.z;u!==0&&(!c||!b||!u||u/Math.sqrt(c*c+b*b+u*u)>.999)&&(_="turntable")}else _="turntable";i("dragmode",_),i("hovermode",x.getDfltFromLayout("hovermode"))}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(y,ee,te){var A=y("./axis_attributes"),g=y("../../domain").attributes,S=y("../../../lib/extend").extendFlat,M=y("../../../lib").counterRegex;function e(a,n,r){return{x:{valType:"number",dflt:a,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:r,editType:"camera"},editType:"camera"}}ee.exports={_arrayAttrRegexps:[M("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:S(e(0,0,1),{}),center:S(e(0,0,0),{}),eye:S(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:g({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:A,yaxis:A,zaxis:A,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(y,ee,te){var A=y("../../../lib/str2rgbarray"),g=["xaxis","yaxis","zaxis"];function S(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var M=S.prototype;M.merge=function(a){for(var n=0;n<3;++n){var r=a[g[n]];if(!r.visible){this.enabled[n]=!1,this.drawSides[n]=!1;continue}this.enabled[n]=r.showspikes,this.colors[n]=A(r.spikecolor),this.drawSides[n]=r.spikesides,this.lineWidth[n]=r.spikethickness}};function e(a){var n=new S;return n.merge(a),n}ee.exports=e},{"../../../lib/str2rgbarray":540}],615:[function(y,ee,te){ee.exports=e;var A=y("../../cartesian/axes"),g=y("../../../lib"),S=["xaxis","yaxis","zaxis"];function M(a){for(var n=new Array(3),r=0;r<3;++r){for(var t=a[r],h=new Array(t.length),s=0;s<t.length;++s)h[s]=t[s].x;n[r]=h}return n}function e(a){for(var n=a.axesOptions,r=a.glplot.axesPixels,t=a.fullSceneLayout,h=[[],[],[]],s=0;s<3;++s){var i=t[S[s]];if(i._length=(r[s].hi-r[s].lo)*r[s].pixelsPerDataUnit/a.dataScale[s],Math.abs(i._length)===1/0||isNaN(i._length))h[s]=[];else{i._input_range=i.range.slice(),i.range[0]=r[s].lo/a.dataScale[s],i.range[1]=r[s].hi/a.dataScale[s],i._m=1/(a.dataScale[s]*r[s].pixelsPerDataUnit),i.range[0]===i.range[1]&&(i.range[0]-=1,i.range[1]+=1);var x=i.tickmode;if(i.tickmode==="auto"){i.tickmode="linear";var p=i.nticks||g.constrain(i._length/40,4,9);A.autoTicks(i,Math.abs(i.range[1]-i.range[0])/p)}for(var v=A.calcTicks(i,{msUTC:!0}),f=0;f<v.length;++f)v[f].x=v[f].x*a.dataScale[s],i.type==="date"&&(v[f].text=v[f].text.replace(/\<br\>/g," "));h[s]=v,i.tickmode=x}}n.ticks=h;for(var s=0;s<3;++s){.5*(a.glplot.bounds[0][s]+a.glplot.bounds[1][s]);for(var f=0;f<2;++f)n.bounds[f][s]=a.glplot.bounds[f][s]}a.contourLevels=M(h)}},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(y,ee,te){function A(S,M){var e=[0,0,0,0],a,n;for(a=0;a<4;++a)for(n=0;n<4;++n)e[n]+=S[4*a+n]*M[a];return e}function g(S,M){var e=A(S.projection,A(S.view,A(S.model,[M[0],M[1],M[2],1])));return e}ee.exports=g},{}],617:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_plot3d,g=A.createCamera,S=A.createScene,M=y("webgl-context"),e=y("has-passive-events"),a=y("../../registry"),n=y("../../lib"),r=n.preserveDrawingBuffer(),t=y("../../plots/cartesian/axes"),h=y("../../components/fx"),s=y("../../lib/str2rgbarray"),i=y("../../lib/show_no_webgl_msg"),x=y("./project"),p=y("./layout/convert"),v=y("./layout/spikes"),f=y("./layout/tick_marks"),d,o;function m(P,z){var I=document.createElement("div"),D=P.container;this.graphDiv=P.graphDiv;var R=document.createElementNS("http://www.w3.org/2000/svg","svg");R.style.position="absolute",R.style.top=R.style.left="0px",R.style.width=R.style.height="100%",R.style["z-index"]=20,R.style["pointer-events"]="none",I.appendChild(R),this.svgContainer=R,I.id=P.id,I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",D.appendChild(I),this.fullLayout=z,this.id=P.id||"scene",this.fullSceneLayout=z[this.id],this.plotArgs=[[],{},{}],this.axesOptions=p(z,z[this.id]),this.spikeOptions=v(z[this.id]),this.container=I,this.staticMode=!!P.staticPlot,this.pixelRatio=this.pixelRatio||P.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=a.getComponentMethod("annotations3d","convert"),this.drawAnnotations=a.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var l=m.prototype;l.prepareOptions=function(){var P=this,z={canvas:P.canvas,gl:P.gl,glOptions:{preserveDrawingBuffer:r,premultipliedAlpha:!0,antialias:!0},container:P.container,axes:P.axesOptions,spikes:P.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:P.camera,pixelRatio:P.pixelRatio};if(P.staticMode){if(!o&&(d=document.createElement("canvas"),o=M({canvas:d,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!o))throw new Error("error creating static canvas/context for image server");z.gl=o,z.canvas=d}return z};var w=!0;l.tryCreatePlot=function(){var P=this,z=P.prepareOptions(),I=!0;try{P.glplot=S(z)}catch{if(P.staticMode||!w||r)I=!1;else{n.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{r=z.glOptions.preserveDrawingBuffer=!0,P.glplot=S(z)}catch{r=z.glOptions.preserveDrawingBuffer=!1,I=!1}}}return w=!1,I},l.initializeGLCamera=function(){var P=this,z=P.fullSceneLayout.camera,I=z.projection.type==="orthographic";P.camera=g(P.container,{center:[z.center.x,z.center.y,z.center.z],eye:[z.eye.x,z.eye.y,z.eye.z],up:[z.up.x,z.up.y,z.up.z],_ortho:I,zoomMin:.01,zoomMax:100,mode:"orbit"})},l.initializeGLPlot=function(){var P=this;P.initializeGLCamera();var z=P.tryCreatePlot();if(!z)return i(P);P.traces={},P.make4thDimension();var I=P.graphDiv,D=I.layout,R=function(){var F={};return P.isCameraChanged(D)&&(F[P.id+".camera"]=P.getCamera()),P.isAspectChanged(D)&&(F[P.id+".aspectratio"]=P.glplot.getAspectratio(),D[P.id].aspectmode!=="manual"&&(P.fullSceneLayout.aspectmode=D[P.id].aspectmode=F[P.id+".aspectmode"]="manual")),F},O=function(F){if(F.fullSceneLayout.dragmode!==!1){var N=R();F.saveLayout(D),F.graphDiv.emit("plotly_relayout",N)}};return P.glplot.canvas&&(P.glplot.canvas.addEventListener("mouseup",function(){O(P)}),P.glplot.canvas.addEventListener("wheel",function(F){if(I._context._scrollZoom.gl3d){if(P.camera._ortho){var N=F.deltaX>F.deltaY?1.1:.9090909090909091,G=P.glplot.getAspectratio();P.glplot.setAspectratio({x:N*G.x,y:N*G.y,z:N*G.z})}O(P)}},e?{passive:!1}:!1),P.glplot.canvas.addEventListener("mousemove",function(){if(P.fullSceneLayout.dragmode!==!1&&P.camera.mouseListener.buttons!==0){var F=R();P.graphDiv.emit("plotly_relayouting",F)}}),P.staticMode||P.glplot.canvas.addEventListener("webglcontextlost",function(F){I&&I.emit&&I.emit("plotly_webglcontextlost",{event:F,layer:P.id})},!1)),P.glplot.oncontextloss=function(){P.recoverContext()},P.glplot.onrender=function(){P.render()},!0},l.render=function(){var P=this,z=P.graphDiv,I,D=P.svgContainer,R=P.container.getBoundingClientRect();z._fullLayout._calcInverseTransform(z);var O=z._fullLayout._invScaleX,F=z._fullLayout._invScaleY,N=R.width*O,G=R.height*F;D.setAttributeNS(null,"viewBox","0 0 "+N+" "+G),D.setAttributeNS(null,"width",N),D.setAttributeNS(null,"height",G),f(P),P.glplot.axes.update(P.axesOptions);for(var K=Object.keys(P.traces),W=null,Y=P.glplot.selection,re=0;re<K.length;++re)I=P.traces[K[re]],I.data.hoverinfo!=="skip"&&I.handlePick(Y)&&(W=I),I.setContourLevels&&I.setContourLevels();function ue(be,ce,de){var ye=P.fullSceneLayout[be+"axis"];return ye.type!=="log"&&(ce=ye.d2l(ce)),t.hoverLabelText(ye,ce,de)}if(W!==null){var j=x(P.glplot.cameraParams,Y.dataCoordinate);I=W.data;var q=z._fullData[I.index],H=Y.index,U={xLabel:ue("x",Y.traceCoordinate[0],I.xhoverformat),yLabel:ue("y",Y.traceCoordinate[1],I.yhoverformat),zLabel:ue("z",Y.traceCoordinate[2],I.zhoverformat)},$=h.castHoverinfo(q,P.fullLayout,H),ne=($||"").split("+"),X=$&&$==="all";!q.hovertemplate&&!X&&(ne.indexOf("x")===-1&&(U.xLabel=void 0),ne.indexOf("y")===-1&&(U.yLabel=void 0),ne.indexOf("z")===-1&&(U.zLabel=void 0),ne.indexOf("text")===-1&&(Y.textLabel=void 0),ne.indexOf("name")===-1&&(W.name=void 0));var Q,ie=[];I.type==="cone"||I.type==="streamtube"?(U.uLabel=ue("x",Y.traceCoordinate[3],I.uhoverformat),(X||ne.indexOf("u")!==-1)&&ie.push("u: "+U.uLabel),U.vLabel=ue("y",Y.traceCoordinate[4],I.vhoverformat),(X||ne.indexOf("v")!==-1)&&ie.push("v: "+U.vLabel),U.wLabel=ue("z",Y.traceCoordinate[5],I.whoverformat),(X||ne.indexOf("w")!==-1)&&ie.push("w: "+U.wLabel),U.normLabel=Y.traceCoordinate[6].toPrecision(3),(X||ne.indexOf("norm")!==-1)&&ie.push("norm: "+U.normLabel),I.type==="streamtube"&&(U.divergenceLabel=Y.traceCoordinate[7].toPrecision(3),(X||ne.indexOf("divergence")!==-1)&&ie.push("divergence: "+U.divergenceLabel)),Y.textLabel&&ie.push(Y.textLabel),Q=ie.join("<br>")):I.type==="isosurface"||I.type==="volume"?(U.valueLabel=t.hoverLabelText(P._mockAxis,P._mockAxis.d2l(Y.traceCoordinate[3]),I.valuehoverformat),ie.push("value: "+U.valueLabel),Y.textLabel&&ie.push(Y.textLabel),Q=ie.join("<br>")):Q=Y.textLabel;var se={x:Y.traceCoordinate[0],y:Y.traceCoordinate[1],z:Y.traceCoordinate[2],data:q._input,fullData:q,curveNumber:q.index,pointNumber:H};h.appendArrayPointValue(se,q,H),I._module.eventData&&(se=q._module.eventData(se,Y,q,{},H));var ae={points:[se]};if(P.fullSceneLayout.hovermode){var oe=[];h.loneHover({trace:q,x:(.5+.5*j[0]/j[3])*N,y:(.5-.5*j[1]/j[3])*G,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:Q,name:W.name,color:h.castHoverOption(q,H,"bgcolor")||W.color,borderColor:h.castHoverOption(q,H,"bordercolor"),fontFamily:h.castHoverOption(q,H,"font.family"),fontSize:h.castHoverOption(q,H,"font.size"),fontColor:h.castHoverOption(q,H,"font.color"),nameLength:h.castHoverOption(q,H,"namelength"),textAlign:h.castHoverOption(q,H,"align"),hovertemplate:n.castOption(q,H,"hovertemplate"),hovertemplateLabels:n.extendFlat({},se,U),eventData:[se]},{container:D,gd:z,inOut_bbox:oe}),se.bbox=oe[0]}Y.buttons&&Y.distance<5?z.emit("plotly_click",ae):z.emit("plotly_hover",ae),this.oldEventData=ae}else h.loneUnhover(D),this.oldEventData&&z.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;P.drawAnnotations(P)},l.recoverContext=function(){var P=this;P.glplot.dispose();var z=function(){if(P.glplot.gl.isContextLost()){requestAnimationFrame(z);return}if(!P.initializeGLPlot()){n.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}P.plot.apply(P,P.plotArgs)};requestAnimationFrame(z)};var _=["xaxis","yaxis","zaxis"];function c(P,z,I){for(var D=P.fullSceneLayout,R=0;R<3;R++){var O=_[R],F=O.charAt(0),N=D[O],G=z[F],K=z[F+"calendar"],W=z["_"+F+"length"];if(!n.isArrayOrTypedArray(G))I[0][R]=Math.min(I[0][R],0),I[1][R]=Math.max(I[1][R],W-1);else for(var Y,re=0;re<(W||G.length);re++)if(n.isArrayOrTypedArray(G[re]))for(var ue=0;ue<G[re].length;++ue)Y=N.d2l(G[re][ue],0,K),!isNaN(Y)&&isFinite(Y)&&(I[0][R]=Math.min(I[0][R],Y),I[1][R]=Math.max(I[1][R],Y));else Y=N.d2l(G[re],0,K),!isNaN(Y)&&isFinite(Y)&&(I[0][R]=Math.min(I[0][R],Y),I[1][R]=Math.max(I[1][R],Y))}}function b(P,z){for(var I=P.fullSceneLayout,D=I.annotations||[],R=0;R<3;R++)for(var O=_[R],F=O.charAt(0),N=I[O],G=0;G<D.length;G++){var K=D[G];if(K.visible){var W=N.r2l(K[F]);!isNaN(W)&&isFinite(W)&&(z[0][R]=Math.min(z[0][R],W),z[1][R]=Math.max(z[1][R],W))}}}l.plot=function(P,z,I){var D=this;if(D.plotArgs=[P,z,I],!D.glplot.contextLost){var R,O,F,N,G,K,W=z[D.id],Y=I[D.id];D.fullLayout=z,D.fullSceneLayout=W,D.axesOptions.merge(z,W),D.spikeOptions.merge(W),D.setViewport(W),D.updateFx(W.dragmode,W.hovermode),D.camera.enableWheel=D.graphDiv._context._scrollZoom.gl3d,D.glplot.setClearColor(s(W.bgcolor)),D.setConvert(G),P?Array.isArray(P)||(P=[P]):P=[];var re=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(F=0;F<P.length;++F)R=P[F],!(R.visible!==!0||R._length===0)&&c(this,R,re);b(this,re);var ue=[1,1,1];for(N=0;N<3;++N)re[1][N]===re[0][N]?ue[N]=1:ue[N]=1/(re[1][N]-re[0][N]);for(D.dataScale=ue,D.convertAnnotations(this),F=0;F<P.length;++F)R=P[F],!(R.visible!==!0||R._length===0)&&(O=D.traces[R.uid],O?O.data.type===R.type?O.update(R):(O.dispose(),O=R._module.plot(this,R),D.traces[R.uid]=O):(O=R._module.plot(this,R),D.traces[R.uid]=O),O.name=R.name);var j=Object.keys(D.traces);e:for(F=0;F<j.length;++F){for(N=0;N<P.length;++N)if(P[N].uid===j[F]&&P[N].visible===!0&&P[N]._length!==0)continue e;O=D.traces[j[F]],O.dispose(),delete D.traces[j[F]]}D.glplot.objects.sort(function(ke,Xe){return ke._trace.data.index-Xe._trace.data.index});var q=[[0,0,0],[0,0,0]],H={};for(F=0;F<3;++F){if(G=W[_[F]],K=G.type,K in H?(H[K].acc*=ue[F],H[K].count+=1):H[K]={acc:ue[F],count:1},G.autorange){q[0][F]=1/0,q[1][F]=-1/0;var U=D.glplot.objects,$=D.fullSceneLayout.annotations||[],ne=G._name.charAt(0);for(N=0;N<U.length;N++){var X=U[N],Q=X.bounds,ie=X._trace.data._pad||0;X.constructor.name==="ErrorBars"&&G._lowerLogErrorBound?q[0][F]=Math.min(q[0][F],G._lowerLogErrorBound):q[0][F]=Math.min(q[0][F],Q[0][F]/ue[F]-ie),q[1][F]=Math.max(q[1][F],Q[1][F]/ue[F]+ie)}for(N=0;N<$.length;N++){var se=$[N];if(se.visible){var ae=G.r2l(se[ne]);q[0][F]=Math.min(q[0][F],ae),q[1][F]=Math.max(q[1][F],ae)}}if("rangemode"in G&&G.rangemode==="tozero"&&(q[0][F]=Math.min(q[0][F],0),q[1][F]=Math.max(q[1][F],0)),q[0][F]>q[1][F])q[0][F]=-1,q[1][F]=1;else{var oe=q[1][F]-q[0][F];q[0][F]-=oe/32,q[1][F]+=oe/32}if(G.autorange==="reversed"){var be=q[0][F];q[0][F]=q[1][F],q[1][F]=be}}else{var ce=G.range;q[0][F]=G.r2l(ce[0]),q[1][F]=G.r2l(ce[1])}q[0][F]===q[1][F]&&(q[0][F]-=1,q[1][F]+=1),D.glplot.setBounds(F,{min:q[0][F]*ue[F],max:q[1][F]*ue[F]})}var de,ye=W.aspectmode;if(ye==="cube")de=[1,1,1];else if(ye==="manual"){var ge=W.aspectratio;de=[ge.x,ge.y,ge.z]}else if(ye==="auto"||ye==="data"){var me=[1,1,1];for(F=0;F<3;++F){G=W[_[F]],K=G.type;var Ee=H[K];me[F]=Math.pow(Ee.acc,1/Ee.count)/ue[F]}ye==="data"||Math.max.apply(null,me)/Math.min.apply(null,me)<=4?de=me:de=[1,1,1]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");W.aspectratio.x=Y.aspectratio.x=de[0],W.aspectratio.y=Y.aspectratio.y=de[1],W.aspectratio.z=Y.aspectratio.z=de[2],D.glplot.setAspectratio(W.aspectratio),D.viewInitial.aspectratio||(D.viewInitial.aspectratio={x:W.aspectratio.x,y:W.aspectratio.y,z:W.aspectratio.z}),D.viewInitial.aspectmode||(D.viewInitial.aspectmode=W.aspectmode);var Pe=W.domain||null,Ue=z._size||null;if(Pe&&Ue){var we=D.container.style;we.position="absolute",we.left=Ue.l+Pe.x[0]*Ue.w+"px",we.top=Ue.t+(1-Pe.y[1])*Ue.h+"px",we.width=Ue.w*(Pe.x[1]-Pe.x[0])+"px",we.height=Ue.h*(Pe.y[1]-Pe.y[0])+"px"}D.glplot.redraw()}},l.destroy=function(){var P=this;P.glplot&&(P.camera.mouseListener.enabled=!1,P.container.removeEventListener("wheel",P.camera.wheelListener),P.camera=null,P.glplot.dispose(),P.container.parentNode.removeChild(P.container),P.glplot=null)};function u(P){return[[P.eye.x,P.eye.y,P.eye.z],[P.center.x,P.center.y,P.center.z],[P.up.x,P.up.y,P.up.z]]}function L(P){return{up:{x:P.up[0],y:P.up[1],z:P.up[2]},center:{x:P.center[0],y:P.center[1],z:P.center[2]},eye:{x:P.eye[0],y:P.eye[1],z:P.eye[2]},projection:{type:P._ortho===!0?"orthographic":"perspective"}}}l.getCamera=function(){var P=this;return P.camera.view.recalcMatrix(P.camera.view.lastT()),L(P.camera)},l.setViewport=function(P){var z=this,I=P.camera;z.camera.lookAt.apply(this,u(I)),z.glplot.setAspectratio(P.aspectratio);var D=I.projection.type==="orthographic",R=z.camera._ortho;D!==R&&(z.glplot.redraw(),z.glplot.clearRGBA(),z.glplot.dispose(),z.initializeGLPlot())},l.isCameraChanged=function(P){var z=this,I=z.getCamera(),D=n.nestedProperty(P,z.id+".camera"),R=D.get();function O(K,W,Y,re){var ue=["up","center","eye"],j=["x","y","z"];return W[ue[Y]]&&K[ue[Y]][j[re]]===W[ue[Y]][j[re]]}var F=!1;if(R===void 0)F=!0;else{for(var N=0;N<3;N++)for(var G=0;G<3;G++)if(!O(I,R,N,G)){F=!0;break}(!R.projection||I.projection&&I.projection.type!==R.projection.type)&&(F=!0)}return F},l.isAspectChanged=function(P){var z=this,I=z.glplot.getAspectratio(),D=n.nestedProperty(P,z.id+".aspectratio"),R=D.get();return R===void 0||R.x!==I.x||R.y!==I.y||R.z!==I.z},l.saveLayout=function(P){var z=this,I=z.fullLayout,D,R,O,F,N,G,K=z.isCameraChanged(P),W=z.isAspectChanged(P),Y=K||W;if(Y){var re={};if(K&&(D=z.getCamera(),R=n.nestedProperty(P,z.id+".camera"),O=R.get(),re[z.id+".camera"]=O),W&&(F=z.glplot.getAspectratio(),N=n.nestedProperty(P,z.id+".aspectratio"),G=N.get(),re[z.id+".aspectratio"]=G),a.call("_storeDirectGUIEdit",P,I._preGUI,re),K){R.set(D);var ue=n.nestedProperty(I,z.id+".camera");ue.set(D)}if(W){N.set(F);var j=n.nestedProperty(I,z.id+".aspectratio");j.set(F),z.glplot.redraw()}}return Y},l.updateFx=function(P,z){var I=this,D=I.camera;if(D)if(P==="orbit")D.mode="orbit",D.keyBindingMode="rotate";else if(P==="turntable"){D.up=[0,0,1],D.mode="turntable",D.keyBindingMode="rotate";var R=I.graphDiv,O=R._fullLayout,F=I.fullSceneLayout.camera,N=F.up.x,G=F.up.y,K=F.up.z;if(K/Math.sqrt(N*N+G*G+K*K)<.999){var W=I.id+".camera.up",Y={x:0,y:0,z:1},re={};re[W]=Y;var ue=R.layout;a.call("_storeDirectGUIEdit",ue,O._preGUI,re),F.up=Y,n.nestedProperty(ue,W).set(Y)}}else D.keyBindingMode=P;I.fullSceneLayout.hovermode=z};function T(P,z,I){for(var D=0,R=I-1;D<R;++D,--R)for(var O=0;O<z;++O)for(var F=0;F<4;++F){var N=4*(z*D+O)+F,G=4*(z*R+O)+F,K=P[N];P[N]=P[G],P[G]=K}}function k(P,z,I){for(var D=0;D<I;++D)for(var R=0;R<z;++R){var O=4*(z*D+R),F=P[O+3];if(F>0)for(var N=255/F,G=0;G<3;++G)P[O+G]=Math.min(N*P[O+G],255)}}l.toImage=function(P){var z=this;P||(P="png"),z.staticMode&&z.container.appendChild(d),z.glplot.redraw();var I=z.glplot.gl,D=I.drawingBufferWidth,R=I.drawingBufferHeight;I.bindFramebuffer(I.FRAMEBUFFER,null);var O=new Uint8Array(D*R*4);I.readPixels(0,0,D,R,I.RGBA,I.UNSIGNED_BYTE,O),T(O,D,R),k(O,D,R);var F=document.createElement("canvas");F.width=D,F.height=R;var N=F.getContext("2d",{willReadFrequently:!0}),G=N.createImageData(D,R);G.data.set(O),N.putImageData(G,0,0);var K;switch(P){case"jpeg":K=F.toDataURL("image/jpeg");break;case"webp":K=F.toDataURL("image/webp");break;default:K=F.toDataURL("image/png")}return z.staticMode&&z.container.removeChild(d),K},l.setConvert=function(){for(var P=this,z=0;z<3;z++){var I=P.fullSceneLayout[_[z]];t.setConvert(I,P.fullLayout),I.setScale=n.noop}},l.make4thDimension=function(){var P=this,z=P.graphDiv,I=z._fullLayout;P._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},t.setConvert(P._mockAxis,I)},ee.exports=m},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(y,ee,te){ee.exports=function(g,S,M,e){e=e||g.length;for(var a=new Array(e),n=0;n<e;n++)a[n]=[g[n],S[n],M[n]];return a}},{}],619:[function(y,ee,te){var A=y("./font_attributes"),g=y("./animation_attributes"),S=y("../components/color/attributes"),M=y("../components/shapes/draw_newshape/attributes"),e=y("../components/selections/draw_newselection/attributes"),a=y("./pad_attributes"),n=y("../lib/extend").extendFlat,r=A({editType:"calc"});r.family.dflt='"Open Sans", verdana, arial, sans-serif',r.size.dflt=12,r.color.dflt=S.defaultLine,ee.exports={font:r,title:{text:{valType:"string",editType:"layoutstyle"},font:A({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(a({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:S.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:S.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:S.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:M.newshape,activeshape:M.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:n({},g.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:A({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(y,ee,te){var A=y("../../lib/sort_object_keys"),g="1.10.1",S=' <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',M=[' <a target="_blank" href="https://carto.com/">Carto</a>',S].join(" "),e=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),a=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),n={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:S,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:M,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:M,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:a,tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},r=A(n);ee.exports={requiredVersion:g,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:n,styleValuesNonMapbox:r,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+g+"."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",r.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":538}],621:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){var e=S.split(" "),a=e[0],n=e[1],r=A.isArrayOrTypedArray(M)?A.mean(M):M,t=.5+r/100,h=1.5+r/100,s=["",""],i=[0,0];switch(a){case"top":s[0]="top",i[1]=-h;break;case"bottom":s[0]="bottom",i[1]=h;break}switch(n){case"left":s[1]="right",i[0]=-t;break;case"right":s[1]="left",i[0]=t;break}var x;return s[0]&&s[1]?x=s.join("-"):s[0]?x=s[0]:s[1]?x=s[1]:x="center",{anchor:x,offset:i}}},{"../../lib":515}],622:[function(y,ee,te){var A=y("mapbox-gl/dist/mapbox-gl-unminified"),g=y("../../lib"),S=g.strTranslate,M=g.strScale,e=y("../../plots/get_data").getSubplotCalcData,a=y("../../constants/xmlns_namespaces"),n=y("@plotly/d3"),r=y("../../components/drawing"),t=y("../../lib/svg_text_utils"),h=y("./mapbox"),s="mapbox",i=te.constants=y("./constants");te.name=s,te.attr="subplot",te.idRoot=s,te.idRegex=te.attrRegex=g.counterRegex(s),te.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},te.layoutAttributes=y("./layout_attributes"),te.supplyLayoutDefaults=y("./layout_defaults"),te.plot=function(f){var d=f._fullLayout,o=f.calcdata,m=d._subplots[s];if(A.version!==i.requiredVersion)throw new Error(i.wrongVersionErrorMsg);var l=x(f,m);A.accessToken=l;for(var w=0;w<m.length;w++){var _=m[w],c=e(o,s,_),b=d[_],u=b._subplot;u||(u=new h(f,_),d[_]._subplot=u),u.viewInitial||(u.viewInitial={center:g.extendFlat({},b.center),zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),u.plot(c,d,f._promises)}},te.clean=function(v,f,d,o){for(var m=o._subplots[s]||[],l=0;l<m.length;l++){var w=m[l];!f[w]&&o[w]._subplot&&o[w]._subplot.destroy()}},te.toSVG=function(v){for(var f=v._fullLayout,d=f._subplots[s],o=f._size,m=0;m<d.length;m++){var l=f[d[m]],w=l.domain,_=l._subplot,c=_.toImage("png"),b=f._glimages.append("svg:image");b.attr({xmlns:a.svg,"xlink:href":c,x:o.l+o.w*w.x[0],y:o.t+o.h*(1-w.y[1]),width:o.w*(w.x[1]-w.x[0]),height:o.h*(w.y[1]-w.y[0]),preserveAspectRatio:"none"});var u=n.select(l._subplot.div),L=u.select(".mapboxgl-ctrl-logo").node().offsetParent===null;if(!L){var T=f._glimages.append("g");T.attr("transform",S(o.l+o.w*w.x[0]+10,o.t+o.h*(1-w.y[0])-31)),T.append("path").attr("d",i.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),T.append("path").attr("d",i.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),T.append("path").attr("d",i.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),T.append("polygon").attr("points",i.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var k=u.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),P=f._glimages.append("g"),z=P.append("text");z.text(k).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":k});var I=r.bBox(z.node()),D=o.w*(w.x[1]-w.x[0]);if(I.width>D/2){var R=k.split("|").join("<br>");z.text(R).attr("data-unformatted",R).call(t.convertToTspans,v),I=r.bBox(z.node())}z.attr("transform",S(-3,-I.height+8)),P.insert("rect",".static-attribution").attr({x:-I.width-6,y:-I.height-3,width:I.width+6,height:I.height+3,fill:"rgba(255, 255, 255, 0.75)"});var O=1;I.width+6>D&&(O=D/(I.width+6));var F=[o.l+o.w*w.x[1],o.t+o.h*(1-w.y[0])];P.attr("transform",S(F[0],F[1])+M(O))}};function x(v,f){var d=v._fullLayout,o=v._context;if(o.mapboxAccessToken==="")return"";for(var m=[],l=[],w=!1,_=!1,c=0;c<f.length;c++){var b=d[f[c]],u=b.accesstoken;p(b.style)&&(u?g.pushUnique(m,u):(p(b._input.style)&&(g.error("Uses Mapbox map style, but did not set an access token."),w=!0),_=!0)),u&&g.pushUnique(l,u)}if(_){var L=w?i.noAccessTokenErrorMsg:i.missingStyleErrorMsg;throw g.error(L),new Error(L)}return m.length?(m.length>1&&g.warn(i.multipleTokensErrorMsg),m[0]):(l.length&&g.log(["Listed mapbox access token(s)",l.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function p(v){return typeof v=="string"&&(i.styleValuesMapbox.indexOf(v)!==-1||v.indexOf("mapbox://")===0)}te.updateFx=function(v){for(var f=v._fullLayout,d=f._subplots[s],o=0;o<d.length;o++){var m=f[d[o]]._subplot;m.updateFx(f)}}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(y,ee,te){var A=y("../../lib"),g=y("../../lib/svg_text_utils").sanitizeHTML,S=y("./convert_text_opts"),M=y("./constants");function e(h,s){this.subplot=h,this.uid=h.uid+"-"+s,this.index=s,this.idSource="source-"+this.uid,this.idLayer=M.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var a=e.prototype;a.update=function(s){this.visible?this.needsNewImage(s)?this.updateImage(s):this.needsNewSource(s)?(this.removeLayer(),this.updateSource(s),this.updateLayer(s)):this.needsNewLayer(s)?this.updateLayer(s):this.updateStyle(s):(this.updateSource(s),this.updateLayer(s)),this.visible=n(s)},a.needsNewImage=function(h){var s=this.subplot.map;return s.getSource(this.idSource)&&this.sourceType==="image"&&h.sourcetype==="image"&&(this.source!==h.source||JSON.stringify(this.coordinates)!==JSON.stringify(h.coordinates))},a.needsNewSource=function(h){return this.sourceType!==h.sourcetype||JSON.stringify(this.source)!==JSON.stringify(h.source)||this.layerType!==h.type},a.needsNewLayer=function(h){return this.layerType!==h.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},a.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},a.updateImage=function(h){var s=this.subplot.map;s.getSource(this.idSource).updateImage({url:h.source,coordinates:h.coordinates});var i=this.findFollowingMapboxLayerId(this.lookupBelow());i!==null&&this.subplot.map.moveLayer(this.idLayer,i)},a.updateSource=function(h){var s=this.subplot.map;if(s.getSource(this.idSource)&&s.removeSource(this.idSource),this.sourceType=h.sourcetype,this.source=h.source,!!n(h)){var i=t(h);s.addSource(this.idSource,i)}},a.findFollowingMapboxLayerId=function(h){if(h==="traces")for(var s=this.subplot.getMapLayers(),i=0;i<s.length;i++){var x=s[i].id;if(typeof x=="string"&&x.indexOf(M.traceLayerPrefix)===0){h=x;break}}return h},a.updateLayer=function(h){var s=this.subplot,i=r(h),x=this.lookupBelow(),p=this.findFollowingMapboxLayerId(x);this.removeLayer(),n(h)&&s.addLayer({id:this.idLayer,source:this.idSource,"source-layer":h.sourcelayer||"",type:h.type,minzoom:h.minzoom,maxzoom:h.maxzoom,layout:i.layout,paint:i.paint},p),this.layerType=h.type,this.below=x},a.updateStyle=function(h){if(n(h)){var s=r(h);this.subplot.setOptions(this.idLayer,"setLayoutProperty",s.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",s.paint)}},a.removeLayer=function(){var h=this.subplot.map;h.getLayer(this.idLayer)&&h.removeLayer(this.idLayer)},a.dispose=function(){var h=this.subplot.map;h.getLayer(this.idLayer)&&h.removeLayer(this.idLayer),h.getSource(this.idSource)&&h.removeSource(this.idSource)};function n(h){if(!h.visible)return!1;var s=h.source;if(Array.isArray(s)&&s.length>0){for(var i=0;i<s.length;i++)if(typeof s[i]!="string"||s[i].length===0)return!1;return!0}return A.isPlainObject(s)||typeof s=="string"&&s.length>0}function r(h){var s={},i={};switch(h.type){case"circle":A.extendFlat(i,{"circle-radius":h.circle.radius,"circle-color":h.color,"circle-opacity":h.opacity});break;case"line":A.extendFlat(i,{"line-width":h.line.width,"line-color":h.color,"line-opacity":h.opacity,"line-dasharray":h.line.dash});break;case"fill":A.extendFlat(i,{"fill-color":h.color,"fill-outline-color":h.fill.outlinecolor,"fill-opacity":h.opacity});break;case"symbol":var x=h.symbol,p=S(x.textposition,x.iconsize);A.extendFlat(s,{"icon-image":x.icon+"-15","icon-size":x.iconsize/10,"text-field":x.text,"text-size":x.textfont.size,"text-anchor":p.anchor,"text-offset":p.offset,"symbol-placement":x.placement}),A.extendFlat(i,{"icon-color":h.color,"text-color":x.textfont.color,"text-opacity":h.opacity});break;case"raster":A.extendFlat(i,{"raster-fade-duration":0,"raster-opacity":h.opacity});break}return{layout:s,paint:i}}function t(h){var s=h.sourcetype,i=h.source,x={type:s},p;return s==="geojson"?p="data":s==="vector"?p=typeof i=="string"?"url":"tiles":s==="raster"?(p="tiles",x.tileSize=256):s==="image"&&(p="url",x.coordinates=h.coordinates),x[p]=i,h.sourceattribution&&(x.attribution=g(h.sourceattribution)),x}ee.exports=function(s,i,x){var p=new e(s,i);return p.update(x),p}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color").defaultLine,S=y("../domain").attributes,M=y("../font_attributes"),e=y("../../traces/scatter/attributes").textposition,a=y("../../plot_api/edit_types").overrideAll,n=y("../../plot_api/plot_template").templatedArray,r=y("./constants"),t=M({});t.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var h=ee.exports=a({_arrayAttrRegexps:[A.counterRegex("mapbox",".layers",!0)],domain:S({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:r.styleValuesMapbox.concat(r.styleValuesNonMapbox),dflt:r.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},bounds:{west:{valType:"number"},east:{valType:"number"},south:{valType:"number"},north:{valType:"number"}},layers:n("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:g},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:g}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:t,textposition:A.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root");h.uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(y,ee,te){var A=y("../../lib"),g=y("../subplot_defaults"),S=y("../array_container_defaults"),M=y("./layout_attributes");ee.exports=function(r,t,h){g(r,t,h,{type:"mapbox",attributes:M,handleDefaults:e,partition:"y",accessToken:t._mapboxAccessToken})};function e(n,r,t,h){t("accesstoken",h.accessToken),t("style"),t("center.lon"),t("center.lat"),t("zoom"),t("bearing"),t("pitch");var s=t("bounds.west"),i=t("bounds.east"),x=t("bounds.south"),p=t("bounds.north");(s===void 0||i===void 0||x===void 0||p===void 0)&&delete r.bounds,S(n,r,{name:"layers",handleItemDefaults:a}),r._input=n}function a(n,r){function t(v,f){return A.coerce(n,r,M.layers,v,f)}var h=t("visible");if(h){var s=t("sourcetype"),i=s==="raster"||s==="image";t("source"),t("sourceattribution"),s==="vector"&&t("sourcelayer"),s==="image"&&t("coordinates");var x;i&&(x="raster");var p=t("type",x);i&&p!=="raster"&&(p=r.type="raster",A.log("Source types *raster* and *image* must drawn *raster* layer type.")),t("below"),t("color"),t("opacity"),t("minzoom"),t("maxzoom"),p==="circle"&&t("circle.radius"),p==="line"&&(t("line.width"),t("line.dash")),p==="fill"&&t("fill.outlinecolor"),p==="symbol"&&(t("symbol.icon"),t("symbol.iconsize"),t("symbol.text"),A.coerceFont(t,"symbol.textfont"),t("symbol.textposition"),t("symbol.placement"))}}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(y,ee,te){var A=y("mapbox-gl/dist/mapbox-gl-unminified"),g=y("../../lib"),S=y("../../lib/geo_location_utils"),M=y("../../registry"),e=y("../cartesian/axes"),a=y("../../components/dragelement"),n=y("../../components/fx"),r=y("../../components/dragelement/helpers"),t=r.drawMode,h=r.selectMode,s=y("../../components/selections").prepSelect,i=y("../../components/selections").clearOutline,x=y("../../components/selections").clearSelectionsCache,p=y("../../components/selections").selectOnClick,v=y("./constants"),f=y("./layers");function d(c,b){this.id=b,this.gd=c;var u=c._fullLayout,L=c._context;this.container=u._glcontainer.node(),this.isStatic=L.staticPlot,this.uid=u._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(u),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var o=d.prototype;o.plot=function(c,b,u){var L=this,T=b[L.id];L.map&&T.accesstoken!==L.accessToken&&(L.map.remove(),L.map=null,L.styleObj=null,L.traceHash={},L.layerList=[]);var k;L.map?k=new Promise(function(P,z){L.updateMap(c,b,P,z)}):k=new Promise(function(P,z){L.createMap(c,b,P,z)}),u.push(k)},o.createMap=function(c,b,u,L){var T=this,k=b[T.id],P=T.styleObj=l(k.style);T.accessToken=k.accesstoken;var z=k.bounds,I=z?[[z.west,z.south],[z.east,z.north]]:null,D=T.map=new A.Map({container:T.div,style:P.style,center:_(k.center),zoom:k.zoom,bearing:k.bearing,pitch:k.pitch,maxBounds:I,interactive:!T.isStatic,preserveDrawingBuffer:T.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new A.AttributionControl({compact:!0}));D._canvas.style.left="0px",D._canvas.style.top="0px",T.rejectOnError(L),T.isStatic||T.initFx(c,b);var R=[];R.push(new Promise(function(O){D.once("load",O)})),R=R.concat(S.fetchTraceGeoData(c)),Promise.all(R).then(function(){T.fillBelowLookup(c,b),T.updateData(c),T.updateLayout(b),T.resolveOnRender(u)}).catch(L)},o.updateMap=function(c,b,u,L){var T=this,k=T.map,P=b[this.id];T.rejectOnError(L);var z=[],I=l(P.style);JSON.stringify(T.styleObj)!==JSON.stringify(I)&&(T.styleObj=I,k.setStyle(I.style),T.traceHash={},z.push(new Promise(function(D){k.once("styledata",D)}))),z=z.concat(S.fetchTraceGeoData(c)),Promise.all(z).then(function(){T.fillBelowLookup(c,b),T.updateData(c),T.updateLayout(b),T.resolveOnRender(u)}).catch(L)},o.fillBelowLookup=function(c,b){var u=b[this.id],L=u.layers,T,k,P=this.belowLookup={},z=!1;for(T=0;T<c.length;T++){var I=c[T][0].trace,D=I._module;typeof I.below=="string"?k=I.below:D.getBelow&&(k=D.getBelow(I,this)),k===""&&(z=!0),P["trace-"+I.uid]=k||""}for(T=0;T<L.length;T++){var R=L[T];typeof R.below=="string"?k=R.below:z?k="traces":k="",P["layout-"+T]=k}var O={},F,N;for(F in P)k=P[F],O[k]?O[k].push(F):O[k]=[F];for(k in O){var G=O[k];if(G.length>1)for(T=0;T<G.length;T++)F=G[T],F.indexOf("trace-")===0?(N=F.split("trace-")[1],this.traceHash[N]&&(this.traceHash[N].below=null)):F.indexOf("layout-")===0&&(N=F.split("layout-")[1],this.layerList[N]&&(this.layerList[N].below=null))}};var m={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};o.updateData=function(c){var b=this.traceHash,u,L,T,k,P=c.slice().sort(function(O,F){return m[O[0].trace.type]-m[F[0].trace.type]});for(T=0;T<P.length;T++){var z=P[T];L=z[0].trace,u=b[L.uid];var I=!1;u&&(u.type===L.type?(u.update(z),I=!0):u.dispose()),!I&&L._module&&(b[L.uid]=L._module.plot(this,z))}var D=Object.keys(b);e:for(T=0;T<D.length;T++){var R=D[T];for(k=0;k<c.length;k++)if(L=c[k][0].trace,R===L.uid)continue e;u=b[R],u.dispose(),delete b[R]}},o.updateLayout=function(c){var b=this.map,u=c[this.id];!this.dragging&&!this.wheeling&&(b.setCenter(_(u.center)),b.setZoom(u.zoom),b.setBearing(u.bearing),b.setPitch(u.pitch)),this.updateLayers(c),this.updateFramework(c),this.updateFx(c),this.map.resize(),this.gd._context._scrollZoom.mapbox?b.scrollZoom.enable():b.scrollZoom.disable()},o.resolveOnRender=function(c){var b=this.map;b.on("render",function u(){b.loaded()&&(b.off("render",u),setTimeout(c,10))})},o.rejectOnError=function(c){var b=this.map;function u(){c(new Error(v.mapOnErrorMsg))}b.once("error",u),b.once("style.error",u),b.once("source.error",u),b.once("tile.error",u),b.once("layer.error",u)},o.createFramework=function(c){var b=this,u=b.div=document.createElement("div");u.id=b.uid,u.style.position="absolute",b.container.appendChild(u),b.xaxis={_id:"x",c2p:function(L){return b.project(L).x}},b.yaxis={_id:"y",c2p:function(L){return b.project(L).y}},b.updateFramework(c),b.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(b.mockAxis,c)},o.initFx=function(c,b){var u=this,L=u.gd,T=u.map;T.on("moveend",function(z){if(u.map){var I=L._fullLayout;if(z.originalEvent||u.wheeling){var D=I[u.id];M.call("_storeDirectGUIEdit",L.layout,I._preGUI,u.getViewEdits(D));var R=u.getView();D._input.center=D.center=R.center,D._input.zoom=D.zoom=R.zoom,D._input.bearing=D.bearing=R.bearing,D._input.pitch=D.pitch=R.pitch,L.emit("plotly_relayout",u.getViewEditsWithDerived(R))}z.originalEvent&&z.originalEvent.type==="mouseup"?u.dragging=!1:u.wheeling&&(u.wheeling=!1),I._rehover&&I._rehover()}}),T.on("wheel",function(){u.wheeling=!0}),T.on("mousemove",function(z){var I=u.div.getBoundingClientRect(),D=[z.originalEvent.offsetX,z.originalEvent.offsetY];z.target.getBoundingClientRect=function(){return I},u.xaxis.p2c=function(){return T.unproject(D).lng},u.yaxis.p2c=function(){return T.unproject(D).lat},L._fullLayout._rehover=function(){L._fullLayout._hoversubplot===u.id&&L._fullLayout[u.id]&&n.hover(L,z,u.id)},n.hover(L,z,u.id),L._fullLayout._hoversubplot=u.id});function k(){n.loneUnhover(b._hoverlayer)}T.on("dragstart",function(){u.dragging=!0,k()}),T.on("zoomstart",k),T.on("mouseout",function(){L._fullLayout._hoversubplot=null});function P(){var z=u.getView();L.emit("plotly_relayouting",u.getViewEditsWithDerived(z))}T.on("drag",P),T.on("zoom",P),T.on("dblclick",function(){var z=L._fullLayout[u.id];M.call("_storeDirectGUIEdit",L.layout,L._fullLayout._preGUI,u.getViewEdits(z));var I=u.viewInitial;T.setCenter(_(I.center)),T.setZoom(I.zoom),T.setBearing(I.bearing),T.setPitch(I.pitch);var D=u.getView();z._input.center=z.center=D.center,z._input.zoom=z.zoom=D.zoom,z._input.bearing=z.bearing=D.bearing,z._input.pitch=z.pitch=D.pitch,L.emit("plotly_doubleclick",null),L.emit("plotly_relayout",u.getViewEditsWithDerived(D))}),u.clearOutline=function(){x(u.dragOptions),i(u.dragOptions.gd)},u.onClickInPanFn=function(z){return function(I){var D=L._fullLayout.clickmode;D.indexOf("select")>-1&&p(I.originalEvent,L,[u.xaxis],[u.yaxis],u.id,z),D.indexOf("event")>-1&&n.click(L,I.originalEvent)}}},o.updateFx=function(c){var b=this,u=b.map,L=b.gd;if(b.isStatic)return;function T(I){var D=b.map.unproject(I);return[D.lng,D.lat]}var k=c.dragmode,P;P=function(I,D){if(D.isRect){var R=I.range={};R[b.id]=[T([D.xmin,D.ymin]),T([D.xmax,D.ymax])]}else{var O=I.lassoPoints={};O[b.id]=D.map(T)}};var z=b.dragOptions;b.dragOptions=g.extendDeep(z||{},{dragmode:c.dragmode,element:b.div,gd:L,plotinfo:{id:b.id,domain:c[b.id].domain,xaxis:b.xaxis,yaxis:b.yaxis,fillRangeItems:P},xaxes:[b.xaxis],yaxes:[b.yaxis],subplot:b.id}),u.off("click",b.onClickInPanHandler),h(k)||t(k)?(u.dragPan.disable(),u.on("zoomstart",b.clearSelect),b.dragOptions.prepFn=function(I,D,R){s(I,D,R,b.dragOptions,k)},a.init(b.dragOptions)):(u.dragPan.enable(),u.off("zoomstart",b.clearSelect),b.div.onmousedown=null,b.div.ontouchstart=null,b.div.removeEventListener("touchstart",b.div._ontouchstart),b.onClickInPanHandler=b.onClickInPanFn(b.dragOptions),u.on("click",b.onClickInPanHandler))},o.updateFramework=function(c){var b=c[this.id].domain,u=c._size,L=this.div.style;L.width=u.w*(b.x[1]-b.x[0])+"px",L.height=u.h*(b.y[1]-b.y[0])+"px",L.left=u.l+b.x[0]*u.w+"px",L.top=u.t+(1-b.y[1])*u.h+"px",this.xaxis._offset=u.l+b.x[0]*u.w,this.xaxis._length=u.w*(b.x[1]-b.x[0]),this.yaxis._offset=u.t+(1-b.y[1])*u.h,this.yaxis._length=u.h*(b.y[1]-b.y[0])},o.updateLayers=function(c){var b=c[this.id],u=b.layers,L=this.layerList,T;if(u.length!==L.length){for(T=0;T<L.length;T++)L[T].dispose();for(L=this.layerList=[],T=0;T<u.length;T++)L.push(f(this,T,u[T]))}else for(T=0;T<u.length;T++)L[T].update(u[T])},o.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},o.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},o.setOptions=function(c,b,u){for(var L in u)this.map[b](c,L,u[L])},o.getMapLayers=function(){return this.map.getStyle().layers},o.addLayer=function(c,b){var u=this.map;if(typeof b=="string"){if(b===""){u.addLayer(c,b);return}for(var L=this.getMapLayers(),T=0;T<L.length;T++)if(b===L[T].id){u.addLayer(c,b);return}g.warn(["Trying to add layer with *below* value",b,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}u.addLayer(c)},o.project=function(c){return this.map.project(new A.LngLat(c[0],c[1]))},o.getView=function(){var c=this.map,b=c.getCenter(),u=b.lng,L=b.lat,T={lon:u,lat:L},k=c.getCanvas(),P=parseInt(k.style.width),z=parseInt(k.style.height);return{center:T,zoom:c.getZoom(),bearing:c.getBearing(),pitch:c.getPitch(),_derived:{coordinates:[c.unproject([0,0]).toArray(),c.unproject([P,0]).toArray(),c.unproject([P,z]).toArray(),c.unproject([0,z]).toArray()]}}},o.getViewEdits=function(c){for(var b=this.id,u=["center","zoom","bearing","pitch"],L={},T=0;T<u.length;T++){var k=u[T];L[b+"."+k]=c[k]}return L},o.getViewEditsWithDerived=function(c){var b=this.id,u=this.getViewEdits(c);return u[b+"._derived"]=c._derived,u};function l(c){var b={};return g.isPlainObject(c)?(b.id=c.id,b.style=c):typeof c=="string"?(b.id=c,v.styleValuesMapbox.indexOf(c)!==-1?b.style=w(c):v.stylesNonMapbox[c]?b.style=v.stylesNonMapbox[c]:b.style=c):(b.id=v.styleValueDflt,b.style=w(v.styleValueDflt)),b.transition={duration:0,delay:0},b}function w(c){return v.styleUrlPrefix+c+"-"+v.styleUrlSuffix}function _(c){return[c.lon,c.lat]}ee.exports=d},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(y,ee,te){ee.exports=function(A){var g=A.editType;return{t:{valType:"number",dflt:0,editType:g},r:{valType:"number",dflt:0,editType:g},b:{valType:"number",dflt:0,editType:g},l:{valType:"number",dflt:0,editType:g},editType:g}}},{}],628:[function(y,ee,te){var A=y("@plotly/d3"),g=y("d3-time-format").timeFormatLocale,S=y("d3-format").formatLocale,M=y("fast-isnumeric"),e=y("../registry"),a=y("../plot_api/plot_schema"),n=y("../plot_api/plot_template"),r=y("../lib"),t=y("../components/color"),h=y("../constants/numerical").BADNUM,s=y("./cartesian/axis_ids"),i=y("../components/shapes/handle_outline").clearOutline,x=y("./animation_attributes"),p=y("./frame_attributes"),v=y("../plots/get_data").getModuleCalcData,f=r.relinkPrivateKeys,d=r._,o=ee.exports={};r.extendFlat(o,e),o.attributes=y("./attributes"),o.attributes.type.values=o.allTypes,o.fontAttrs=y("./font_attributes"),o.layoutAttributes=y("./layout_attributes"),o.fontWeight="normal";var m=o.transformsRegistry,l=y("./command");o.executeAPICommand=l.executeAPICommand,o.computeAPICommandBindings=l.computeAPICommandBindings,o.manageCommandObserver=l.manageCommandObserver,o.hasSimpleAPICommandBindings=l.hasSimpleAPICommandBindings,o.redrawText=function(j){return j=r.getGraphDiv(j),new Promise(function(q){setTimeout(function(){j._fullLayout&&(e.getComponentMethod("annotations","draw")(j),e.getComponentMethod("legend","draw")(j),e.getComponentMethod("colorbar","draw")(j),q(o.previousPromises(j)))},300)})},o.resize=function(j){j=r.getGraphDiv(j);var q,H=new Promise(function(U,$){(!j||r.isHidden(j))&&$(new Error("Resize must be passed a displayed plot div element.")),j._redrawTimer&&clearTimeout(j._redrawTimer),j._resolveResize&&(q=j._resolveResize),j._resolveResize=U,j._redrawTimer=setTimeout(function(){if(!j.layout||j.layout.width&&j.layout.height||r.isHidden(j)){U(j);return}delete j.layout.width,delete j.layout.height;var ne=j.changed;j.autoplay=!0,e.call("relayout",j,{autosize:!0}).then(function(){j.changed=ne,j._resolveResize===U&&(delete j._resolveResize,U(j))})},100)});return q&&q(H),H},o.previousPromises=function(j){if((j._promises||[]).length)return Promise.all(j._promises).then(function(){j._promises=[]})},o.addLinks=function(j){if(!(!j._context.showLink&&!j._context.showSources)){var q=j._fullLayout,H=r.ensureSingle(q._paper,"text","js-plot-link-container",function(ie){ie.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:t.defaultLine,"pointer-events":"all"}).each(function(){var se=A.select(this);se.append("tspan").classed("js-link-to-tool",!0),se.append("tspan").classed("js-link-spacer",!0),se.append("tspan").classed("js-sourcelinks",!0)})}),U=H.node(),$={y:q._paper.attr("height")-9};document.body.contains(U)&&U.getComputedTextLength()>=q.width-20?($["text-anchor"]="start",$.x=5):($["text-anchor"]="end",$.x=q._paper.attr("width")-7),H.attr($);var ne=H.select(".js-link-to-tool"),X=H.select(".js-link-spacer"),Q=H.select(".js-sourcelinks");j._context.showSources&&j._context.showSources(j),j._context.showLink&&w(j,ne),X.text(ne.text()&&Q.text()?" - ":"")}};function w(j,q){q.text("");var H=q.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(j._context.linkText+" "+String.fromCharCode(187));if(j._context.sendData)H.on("click",function(){o.sendDataToCloud(j)});else{var U=window.location.pathname.split("/"),$=window.location.search;H.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+U[2].split(".")[0]+"/"+U[1]+$})}}o.sendDataToCloud=function(j){var q=(window.PLOTLYENV||{}).BASE_URL||j._context.plotlyServerURL;if(q){j.emit("plotly_beforeexport");var H=A.select(j).append("div").attr("id","hiddenform").style("display","none"),U=H.append("form").attr({action:q+"/external",method:"post",target:"_blank"}),$=U.append("input").attr({type:"text",name:"data"});return $.node().value=o.graphJson(j,!1,"keepdata"),U.node().submit(),H.remove(),j.emit("plotly_afterexport"),!1}};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],c=["year","month","dayMonth","dayMonthYear"];o.supplyDefaults=function(j,q){var H=q&&q.skipUpdateCalc,U=j._fullLayout||{};if(U._skipDefaults){delete U._skipDefaults;return}var $=j._fullLayout={},ne=j.layout||{},X=j._fullData||[],Q=j._fullData=[],ie=j.data||[],se=j.calcdata||[],ae=j._context||{},oe;j._transitionData||o.createTransitionData(j),$._dfltTitle={plot:d(j,"Click to enter Plot title"),x:d(j,"Click to enter X axis title"),y:d(j,"Click to enter Y axis title"),colorbar:d(j,"Click to enter Colorscale title"),annotation:d(j,"new text")},$._traceWord=d(j,"trace");var be=L(j,_);if($._mapboxAccessToken=ae.mapboxAccessToken,U._initialAutoSizeIsDone){var ce=U.width,de=U.height;o.supplyLayoutGlobalDefaults(ne,$,be),ne.width||($.width=ce),ne.height||($.height=de),o.sanitizeMargins($)}else{o.supplyLayoutGlobalDefaults(ne,$,be);var ye=!ne.width||!ne.height,ge=$.autosize,me=ae.autosizable,Ee=ye&&(ge||me);Ee?o.plotAutoSize(j,ne,$):ye&&o.sanitizeMargins($),!ge&&ye&&(ne.width=$.width,ne.height=$.height)}$._d3locale=T(be,$.separators),$._extraFormat=L(j,c),$._initialAutoSizeIsDone=!0,$._dataLength=ie.length,$._modules=[],$._visibleModules=[],$._basePlotModules=[];var Pe=$._subplots=u(),Ue=$._splomAxes={x:{},y:{}},we=$._splomSubplots={};$._splomGridDflt={},$._scatterStackOpts={},$._firstScatter={},$._alignmentOpts={},$._colorAxes={},$._requestRangeslider={},$._traceUids=b(X,ie),$._globalTransforms=(j._context||{}).globalTransforms,o.supplyDataDefaults(ie,Q,ne,$);var ke=Object.keys(Ue.x),Xe=Object.keys(Ue.y);if(ke.length>1&&Xe.length>1){for(e.getComponentMethod("grid","sizeDefaults")(ne,$),oe=0;oe<ke.length;oe++)r.pushUnique(Pe.xaxis,ke[oe]);for(oe=0;oe<Xe.length;oe++)r.pushUnique(Pe.yaxis,Xe[oe]);for(var Ve in we)r.pushUnique(Pe.cartesian,Ve)}if($._has=o._hasPlotType.bind($),X.length===Q.length)for(oe=0;oe<Q.length;oe++)f(Q[oe],X[oe]);o.supplyLayoutModuleDefaults(ne,$,Q,j._transitionData);var Ie=$._visibleModules,De=[];for(oe=0;oe<Ie.length;oe++){var Ye=Ie[oe].crossTraceDefaults;Ye&&r.pushUnique(De,Ye)}for(oe=0;oe<De.length;oe++)De[oe](Q,$);$._hasOnlyLargeSploms=$._basePlotModules.length===1&&$._basePlotModules[0].name==="splom"&&ke.length>15&&Xe.length>15&&$.shapes.length===0&&$.images.length===0,o.linkSubplots(Q,$,X,U),o.cleanPlot(Q,$,X,U);var vt=!!(U._has&&U._has("gl2d")),Dt=!!($._has&&$._has("gl2d")),Kt=!!(U._has&&U._has("cartesian")),Ft=!!($._has&&$._has("cartesian")),Mt=Kt||vt,Xt=Ft||Dt;Mt&&!Xt?U._bgLayer.remove():Xt&&!Mt&&($._shouldCreateBgLayer=!0),U._zoomlayer&&!j._dragging&&i({_fullLayout:U}),k(Q,$),f($,U),e.getComponentMethod("colorscale","crossTraceDefaults")(Q,$),$._preGUI||($._preGUI={}),$._tracePreGUI||($._tracePreGUI={});var It=$._tracePreGUI,At={},Ge;for(Ge in It)At[Ge]="old";for(oe=0;oe<Q.length;oe++)Ge=Q[oe]._fullInput.uid,At[Ge]||(It[Ge]={}),At[Ge]="new";for(Ge in At)At[Ge]==="old"&&delete It[Ge];R($),e.getComponentMethod("rangeslider","makeData")($),!H&&se.length===Q.length&&o.supplyDefaultsUpdateCalc(se,Q)},o.supplyDefaultsUpdateCalc=function(j,q){for(var H=0;H<q.length;H++){var U=q[H],$=(j[H]||[])[0];if($&&$.trace){var ne=$.trace;if(ne._hasCalcTransform){var X=ne._arrayAttrs,Q,ie,se;for(Q=0;Q<X.length;Q++)ie=X[Q],se=r.nestedProperty(ne,ie).get().slice(),r.nestedProperty(U,ie).set(se)}$.trace=U}}};function b(j,q){var H=q.length,U=[],$,ne;for($=0;$<j.length;$++){var X=j[$]._fullInput;X!==ne&&U.push(X),ne=X}var Q=U.length,ie=new Array(H),se={};function ae(ce,de){ie[de]=ce,se[ce]=1}function oe(ce,de){if(ce&&typeof ce=="string"&&!se[ce])return ae(ce,de),!0}for($=0;$<H;$++){var be=q[$].uid;typeof be=="number"&&(be=String(be)),!oe(be,$)&&($<Q&&oe(U[$].uid,$)||ae(r.randstr(se),$))}return ie}function u(){var j=e.collectableSubplotTypes,q={},H,U;if(!j){j=[];var $=e.subplotsRegistry;for(var ne in $){var X=$[ne],Q=X.attr;if(Q&&(j.push(ne),Array.isArray(Q)))for(U=0;U<Q.length;U++)r.pushUnique(j,Q[U])}}for(H=0;H<j.length;H++)q[j[H]]=[];return q}function L(j,q){var H=j._context.locale;H||(H="en-US");var U=!1,$={};function ne(oe){for(var be=!0,ce=0;ce<q.length;ce++){var de=q[ce];$[de]||(oe[de]?$[de]=oe[de]:be=!1)}be&&(U=!0)}for(var X=0;X<2;X++){for(var Q=j._context.locales,ie=0;ie<2;ie++){var se=(Q[H]||{}).format;if(se&&(ne(se),U))break;Q=e.localeRegistry}var ae=H.split("-")[0];if(U||ae===H)break;H=ae}return U||ne(e.localeRegistry.en.format),$}function T(j,q){return j.decimal=q.charAt(0),j.thousands=q.charAt(1),{numberFormat:function(H){try{H=S(j).format(r.adjustFormat(H))}catch{return r.warnBadFormat(H),r.noFormat}return H},timeFormat:g(j).utcFormat}}function k(j,q){var H,U=[];q.meta&&(H=q._meta={meta:q.meta,layout:{meta:q.meta}});for(var $=0;$<j.length;$++){var ne=j[$];ne.meta?U[ne.index]=ne._meta={meta:ne.meta}:q.meta&&(ne._meta={meta:q.meta}),q.meta&&(ne._meta.layout={meta:q.meta})}U.length&&(H||(H=q._meta={}),H.data=U)}o.createTransitionData=function(j){j._transitionData||(j._transitionData={}),j._transitionData._frames||(j._transitionData._frames=[]),j._transitionData._frameHash||(j._transitionData._frameHash={}),j._transitionData._counter||(j._transitionData._counter=0),j._transitionData._interruptCallbacks||(j._transitionData._interruptCallbacks=[])},o._hasPlotType=function(j){var q,H=this._basePlotModules||[];for(q=0;q<H.length;q++)if(H[q].name===j)return!0;var U=this._modules||[];for(q=0;q<U.length;q++){var $=U[q].name;if($===j)return!0;var ne=e.modules[$];if(ne&&ne.categories[j])return!0}return!1},o.cleanPlot=function(j,q,H,U){var $,ne,X=U._basePlotModules||[];for($=0;$<X.length;$++){var Q=X[$];Q.clean&&Q.clean(j,q,H,U)}var ie=U._has&&U._has("gl"),se=q._has&&q._has("gl");ie&&!se&&U._glcontainer!==void 0&&(U._glcontainer.selectAll(".gl-canvas").remove(),U._glcontainer.selectAll(".no-webgl").remove(),U._glcanvas=null);var ae=!!U._infolayer;e:for($=0;$<H.length;$++){var oe=H[$],be=oe.uid;for(ne=0;ne<j.length;ne++){var ce=j[ne];if(be===ce.uid)continue e}ae&&U._infolayer.select(".cb"+be).remove()}},o.linkSubplots=function(j,q,H,U){var $,ne,X=U._plots||{},Q=q._plots={},ie=q._subplots,se={_fullData:j,_fullLayout:q},ae=ie.cartesian.concat(ie.gl2d||[]);for($=0;$<ae.length;$++){var oe=ae[$],be=X[oe],ce=s.getFromId(se,oe,"x"),de=s.getFromId(se,oe,"y"),ye;for(be?ye=Q[oe]=be:(ye=Q[oe]={},ye.id=oe),ce._counterAxes.push(de._id),de._counterAxes.push(ce._id),ce._subplotsWith.push(oe),de._subplotsWith.push(oe),ye.xaxis=ce,ye.yaxis=de,ye._hasClipOnAxisFalse=!1,ne=0;ne<j.length;ne++){var ge=j[ne];if(ge.xaxis===ye.xaxis._id&&ge.yaxis===ye.yaxis._id&&ge.cliponaxis===!1){ye._hasClipOnAxisFalse=!0;break}}}var me=s.list(se,null,!0),Ee;for($=0;$<me.length;$++){Ee=me[$];var Pe=null;Ee.overlaying&&(Pe=s.getFromId(se,Ee.overlaying),Pe&&Pe.overlaying&&(Ee.overlaying=!1,Pe=null)),Ee._mainAxis=Pe||Ee,Pe&&(Ee.domain=Pe.domain.slice()),Ee._anchorAxis=Ee.anchor==="free"?null:s.getFromId(se,Ee.anchor)}for($=0;$<me.length;$++)if(Ee=me[$],Ee._counterAxes.sort(s.idSort),Ee._subplotsWith.sort(r.subplotSort),Ee._mainSubplot=P(Ee,q),Ee._counterAxes.length&&(Ee.spikemode&&Ee.spikemode.indexOf("across")!==-1||Ee.automargin&&Ee.mirror&&Ee.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(Ee))){var Ue=1,we=0;for(ne=0;ne<Ee._counterAxes.length;ne++){var ke=s.getFromId(se,Ee._counterAxes[ne]);Ue=Math.min(Ue,ke.domain[0]),we=Math.max(we,ke.domain[1])}Ue<we&&(Ee._counterDomainMin=Ue,Ee._counterDomainMax=we)}};function P(j,q){var H={_fullLayout:q},U=j._id.charAt(0)==="x",$=j._mainAxis._anchorAxis,ne="",X="",Q="";if($&&(Q=$._mainAxis._id,ne=U?j._id+Q:Q+j._id),!ne||!q._plots[ne]){ne="";for(var ie=j._counterAxes,se=0;se<ie.length;se++){var ae=ie[se],oe=U?j._id+ae:ae+j._id;X||(X=oe);var be=s.getFromId(H,ae);if(Q&&be.overlaying===Q){ne=oe;break}}}return ne||X}o.clearExpandedTraceDefaultColors=function(j){var q,H,U;function $(X,Q,ie,se){H[se]=Q,H.length=se+1,X.valType==="color"&&X.dflt===void 0&&q.push(H.join("."))}for(H=[],q=j._module._colorAttrs,q||(j._module._colorAttrs=q=[],a.crawl(j._module.attributes,$)),U=0;U<q.length;U++){var ne=r.nestedProperty(j,"_input."+q[U]);ne.get()||r.nestedProperty(j,q[U]).set(null)}},o.supplyDataDefaults=function(j,q,H,U){var $=U._modules,ne=U._visibleModules,X=U._basePlotModules,Q=0,ie=0,se,ae,oe;U._transformModules=[];function be(Xe){q.push(Xe);var Ve=Xe._module;Ve&&(r.pushUnique($,Ve),Xe.visible===!0&&r.pushUnique(ne,Ve),r.pushUnique(X,Xe._module.basePlotModule),Q++,Xe._input.visible!==!1&&ie++)}var ce={},de=[],ye=(H.template||{}).data||{},ge=n.traceTemplater(ye);for(se=0;se<j.length;se++){if(oe=j[se],ae=ge.newTrace(oe),ae.uid=U._traceUids[se],o.supplyTraceDefaults(oe,ae,ie,U,se),ae.index=se,ae._input=oe,ae._expandedIndex=Q,ae.transforms&&ae.transforms.length)for(var me=oe.visible!==!1&&ae.visible===!1,Ee=I(ae,q,H,U),Pe=0;Pe<Ee.length;Pe++){var Ue=Ee[Pe],we={_template:ae._template,type:ae.type,uid:ae.uid+Pe};me&&Ue.visible===!1&&delete Ue.visible,o.supplyTraceDefaults(Ue,we,Q,U,se),f(we,Ue),we.index=se,we._input=oe,we._fullInput=ae,we._expandedIndex=Q,we._expandedInput=Ue,be(we)}else ae._fullInput=ae,ae._expandedInput=ae,be(ae);e.traceIs(ae,"carpetAxis")&&(ce[ae.carpet]=ae),e.traceIs(ae,"carpetDependent")&&de.push(se)}for(se=0;se<de.length;se++)if(ae=q[de[se]],!!ae.visible){var ke=ce[ae.carpet];if(ae._carpet=ke,!ke||!ke.visible){ae.visible=!1;continue}ae.xaxis=ke.xaxis,ae.yaxis=ke.yaxis}},o.supplyAnimationDefaults=function(j){j=j||{};var q,H={};function U($,ne){return r.coerce(j||{},H,x,$,ne)}if(U("mode"),U("direction"),U("fromcurrent"),Array.isArray(j.frame))for(H.frame=[],q=0;q<j.frame.length;q++)H.frame[q]=o.supplyAnimationFrameDefaults(j.frame[q]||{});else H.frame=o.supplyAnimationFrameDefaults(j.frame||{});if(Array.isArray(j.transition))for(H.transition=[],q=0;q<j.transition.length;q++)H.transition[q]=o.supplyAnimationTransitionDefaults(j.transition[q]||{});else H.transition=o.supplyAnimationTransitionDefaults(j.transition||{});return H},o.supplyAnimationFrameDefaults=function(j){var q={};function H(U,$){return r.coerce(j||{},q,x.frame,U,$)}return H("duration"),H("redraw"),q},o.supplyAnimationTransitionDefaults=function(j){var q={};function H(U,$){return r.coerce(j||{},q,x.transition,U,$)}return H("duration"),H("easing"),q},o.supplyFrameDefaults=function(j){var q={};function H(U,$){return r.coerce(j,q,p,U,$)}return H("group"),H("name"),H("traces"),H("baseframe"),H("data"),H("layout"),q},o.supplyTraceDefaults=function(j,q,H,U,$){var ne=U.colorway||t.defaults,X=ne[H%ne.length],Q;function ie(Ee,Pe){return r.coerce(j,q,o.attributes,Ee,Pe)}var se=ie("visible");ie("type"),ie("name",U._traceWord+" "+$),ie("uirevision",U.uirevision);var ae=o.getModule(q);if(q._module=ae,ae){var oe=ae.basePlotModule,be=oe.attr,ce=oe.attributes;if(be&&ce){var de=U._subplots,ye="";if(se||oe.name!=="gl2d"){if(Array.isArray(be))for(Q=0;Q<be.length;Q++){var ge=be[Q],me=r.coerce(j,q,ce,ge);de[ge]&&r.pushUnique(de[ge],me),ye+=me}else ye=r.coerce(j,q,ce,be);de[oe.name]&&r.pushUnique(de[oe.name],ye)}}}return se&&(ie("customdata"),ie("ids"),ie("meta"),e.traceIs(q,"showLegend")?(r.coerce(j,q,ae.attributes.showlegend?ae.attributes:o.attributes,"showlegend"),ie("legendwidth"),ie("legendgroup"),ie("legendgrouptitle.text"),ie("legendrank"),q._dfltShowLegend=!0):q._dfltShowLegend=!1,ae&&ae.supplyDefaults(j,q,X,U),e.traceIs(q,"noOpacity")||ie("opacity"),e.traceIs(q,"notLegendIsolatable")&&(q.visible=!!q.visible),e.traceIs(q,"noHover")||(q.hovertemplate||r.coerceHoverinfo(j,q,U),q.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(j,q,X,U)),ae&&ae.selectPoints&&ie("selectedpoints"),o.supplyTransformDefaults(j,q,U)),q};function z(j){var q=j.transforms;if(Array.isArray(q)&&q.length)for(var H=0;H<q.length;H++){var U=q[H],$=U._module||m[U.type];if($&&$.makesData)return!0}return!1}o.hasMakesDataTransform=z,o.supplyTransformDefaults=function(j,q,H){if(q._length||z(j)){var U=H._globalTransforms||[],$=H._transformModules||[];if(!(!Array.isArray(j.transforms)&&U.length===0))for(var ne=j.transforms||[],X=U.concat(ne),Q=q.transforms=[],ie=0;ie<X.length;ie++){var se=X[ie],ae=se.type,oe=m[ae],be,ce=!(se._module&&se._module===oe),de=oe&&typeof oe.transform=="function";oe||r.warn("Unrecognized transform type "+ae+"."),oe&&oe.supplyDefaults&&(ce||de)?(be=oe.supplyDefaults(se,q,H,j),be.type=ae,be._module=oe,r.pushUnique($,oe)):be=r.extendFlat({},se),Q.push(be)}}};function I(j,q,H,U){for(var $=j.transforms,ne=[j],X=0;X<$.length;X++){var Q=$[X],ie=m[Q.type];ie&&ie.transform&&(ne=ie.transform(ne,{transform:Q,fullTrace:j,fullData:q,layout:H,fullLayout:U,transformIndex:X}))}return ne}o.supplyLayoutGlobalDefaults=function(j,q,H){function U(se,ae){return r.coerce(j,q,o.layoutAttributes,se,ae)}var $=j.template;r.isPlainObject($)&&(q.template=$,q._template=$.layout,q._dataTemplate=$.data),U("autotypenumbers");var ne=r.coerceFont(U,"font"),X=ne.size;r.coerceFont(U,"title.font",r.extendFlat({},ne,{size:Math.round(X*1.4)})),U("title.text",q._dfltTitle.plot),U("title.xref"),U("title.yref"),U("title.x"),U("title.y"),U("title.xanchor"),U("title.yanchor"),U("title.pad.t"),U("title.pad.r"),U("title.pad.b"),U("title.pad.l");var Q=U("uniformtext.mode");Q&&U("uniformtext.minsize"),U("autosize",!(j.width&&j.height)),U("width"),U("height"),U("minreducedwidth"),U("minreducedheight"),U("margin.l"),U("margin.r"),U("margin.t"),U("margin.b"),U("margin.pad"),U("margin.autoexpand"),j.width&&j.height&&o.sanitizeMargins(q),e.getComponentMethod("grid","sizeDefaults")(j,q),U("paper_bgcolor"),U("separators",H.decimal+H.thousands),U("hidesources"),U("colorway"),U("datarevision");var ie=U("uirevision");U("editrevision",ie),U("selectionrevision",ie),e.getComponentMethod("modebar","supplyLayoutDefaults")(j,q),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(j,q,U),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(j,q,U),U("meta"),r.isPlainObject(j.transition)&&(U("transition.duration"),U("transition.easing"),U("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(j,q,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(j,q,U)};function D(j){return typeof j=="string"&&j.substr(j.length-2)==="px"&&parseFloat(j)}o.plotAutoSize=function(q,H,U){var $=q._context||{},ne=$.frameMargins,X,Q,ie=r.isPlotDiv(q);if(ie&&q.emit("plotly_autosize"),$.fillFrame)X=window.innerWidth,Q=window.innerHeight,document.body.style.overflow="hidden";else{var se=ie?window.getComputedStyle(q):{};if(X=D(se.width)||D(se.maxWidth)||U.width,Q=D(se.height)||D(se.maxHeight)||U.height,M(ne)&&ne>0){var ae=1-2*ne;X=Math.round(ae*X),Q=Math.round(ae*Q)}}var oe=o.layoutAttributes.width.min,be=o.layoutAttributes.height.min;X<oe&&(X=oe),Q<be&&(Q=be);var ce=!H.width&&Math.abs(U.width-X)>1,de=!H.height&&Math.abs(U.height-Q)>1;(de||ce)&&(ce&&(U.width=X),de&&(U.height=Q)),q._initialAutoSize||(q._initialAutoSize={width:X,height:Q}),o.sanitizeMargins(U)},o.supplyLayoutModuleDefaults=function(j,q,H,U){var $=e.componentsRegistry,ne=q._basePlotModules,X,Q,ie,se=e.subplotsRegistry.cartesian;for(X in $)ie=$[X],ie.includeBasePlot&&ie.includeBasePlot(j,q);ne.length||ne.push(se),q._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(j,q),se.finalizeSubplots(j,q));for(var ae in q._subplots)q._subplots[ae].sort(r.subplotSort);for(Q=0;Q<ne.length;Q++)ie=ne[Q],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(j,q,H);var oe=q._modules;for(Q=0;Q<oe.length;Q++)ie=oe[Q],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(j,q,H);var be=q._transformModules;for(Q=0;Q<be.length;Q++)ie=be[Q],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(j,q,H,U);for(X in $)ie=$[X],ie.supplyLayoutDefaults&&ie.supplyLayoutDefaults(j,q,H)},o.purge=function(j){var q=j._fullLayout||{};q._glcontainer!==void 0&&(q._glcontainer.selectAll(".gl-canvas").remove(),q._glcontainer.remove(),q._glcanvas=null),q._modeBar&&q._modeBar.destroy(),j._transitionData&&(j._transitionData._interruptCallbacks&&(j._transitionData._interruptCallbacks.length=0),j._transitionData._animationRaf&&window.cancelAnimationFrame(j._transitionData._animationRaf)),r.clearThrottle(),r.clearResponsive(j),delete j.data,delete j.layout,delete j._fullData,delete j._fullLayout,delete j.calcdata,delete j.empty,delete j.fid,delete j.undoqueue,delete j.undonum,delete j.autoplay,delete j.changed,delete j._promises,delete j._redrawTimer,delete j._hmlumcount,delete j._hmpixcount,delete j._transitionData,delete j._transitioning,delete j._initialAutoSize,delete j._transitioningWithDuration,delete j._dragging,delete j._dragged,delete j._dragdata,delete j._hoverdata,delete j._snapshotInProgress,delete j._editing,delete j._mouseDownTime,delete j._legendMouseDownTime,j.removeAllListeners&&j.removeAllListeners()},o.style=function(j){var q=j._fullLayout._visibleModules,H=[],U;for(U=0;U<q.length;U++){var $=q[U];$.style&&r.pushUnique(H,$.style)}for(U=0;U<H.length;U++)H[U](j)},o.sanitizeMargins=function(j){if(!(!j||!j.margin)){var q=j.width,H=j.height,U=j.margin,$=q-(U.l+U.r),ne=H-(U.t+U.b),X;$<0&&(X=(q-1)/(U.l+U.r),U.l=Math.floor(X*U.l),U.r=Math.floor(X*U.r)),ne<0&&(X=(H-1)/(U.t+U.b),U.t=Math.floor(X*U.t),U.b=Math.floor(X*U.b))}},o.clearAutoMarginIds=function(j){j._fullLayout._pushmarginIds={}},o.allowAutoMargin=function(j,q){j._fullLayout._pushmarginIds[q]=1};function R(j){var q=j.margin;if(!j._size){var H=j._size={l:Math.round(q.l),r:Math.round(q.r),t:Math.round(q.t),b:Math.round(q.b),p:Math.round(q.pad)};H.w=Math.round(j.width)-H.l-H.r,H.h=Math.round(j.height)-H.t-H.b}j._pushmargin||(j._pushmargin={}),j._pushmarginIds||(j._pushmarginIds={})}var O=2,F=2;o.autoMargin=function(j,q,H){var U=j._fullLayout,$=U.width,ne=U.height,X=U.margin,Q=U.minreducedwidth,ie=U.minreducedheight,se=r.constrain($-X.l-X.r,O,Q),ae=r.constrain(ne-X.t-X.b,F,ie),oe=Math.max(0,$-se),be=Math.max(0,ne-ae),ce=U._pushmargin,de=U._pushmarginIds;if(X.autoexpand!==!1){if(!H)delete ce[q],delete de[q];else{var ye=H.pad;if(ye===void 0&&(ye=Math.min(12,X.l,X.r,X.t,X.b)),oe){var ge=(H.l+H.r)/oe;ge>1&&(H.l/=ge,H.r/=ge)}if(be){var me=(H.t+H.b)/be;me>1&&(H.t/=me,H.b/=me)}var Ee=H.xl!==void 0?H.xl:H.x,Pe=H.xr!==void 0?H.xr:H.x,Ue=H.yt!==void 0?H.yt:H.y,we=H.yb!==void 0?H.yb:H.y;ce[q]={l:{val:Ee,size:H.l+ye},r:{val:Pe,size:H.r+ye},b:{val:we,size:H.b+ye},t:{val:Ue,size:H.t+ye}},de[q]=1}if(!U._replotting)return o.doAutoMargin(j)}},o.doAutoMargin=function(j){var q=j._fullLayout,H=q.width,U=q.height;q._size||(q._size={}),R(q);var $=q._size,ne=q.margin,X=r.extendFlat({},$),Q=ne.l,ie=ne.r,se=ne.t,ae=ne.b,oe=q._pushmargin,be=q._pushmarginIds,ce=q.minreducedwidth,de=q.minreducedheight;if(q.margin.autoexpand!==!1){for(var ye in oe)be[ye]||delete oe[ye];oe.base={l:{val:0,size:Q},r:{val:1,size:ie},t:{val:1,size:se},b:{val:0,size:ae}};for(var ge in oe){var me=oe[ge].l||{},Ee=oe[ge].b||{},Pe=me.val,Ue=me.size,we=Ee.val,ke=Ee.size;for(var Xe in oe){if(M(Ue)&&oe[Xe].r){var Ve=oe[Xe].r.val,Ie=oe[Xe].r.size;if(Ve>Pe){var De=(Ue*Ve+(Ie-H)*Pe)/(Ve-Pe),Ye=(Ie*(1-Pe)+(Ue-H)*(1-Ve))/(Ve-Pe);De+Ye>Q+ie&&(Q=De,ie=Ye)}}if(M(ke)&&oe[Xe].t){var vt=oe[Xe].t.val,Dt=oe[Xe].t.size;if(vt>we){var Kt=(ke*vt+(Dt-U)*we)/(vt-we),Ft=(Dt*(1-we)+(ke-U)*(1-vt))/(vt-we);Kt+Ft>ae+se&&(ae=Kt,se=Ft)}}}}}var Mt=r.constrain(H-ne.l-ne.r,O,ce),Xt=r.constrain(U-ne.t-ne.b,F,de),It=Math.max(0,H-Mt),At=Math.max(0,U-Xt);if(It){var Ge=(Q+ie)/It;Ge>1&&(Q/=Ge,ie/=Ge)}if(At){var tt=(ae+se)/At;tt>1&&(ae/=tt,se/=tt)}if($.l=Math.round(Q),$.r=Math.round(ie),$.t=Math.round(se),$.b=Math.round(ae),$.p=Math.round(ne.pad),$.w=Math.round(H)-$.l-$.r,$.h=Math.round(U)-$.t-$.b,!q._replotting&&o.didMarginChange(X,$)){"_redrawFromAutoMarginCount"in q?q._redrawFromAutoMarginCount++:q._redrawFromAutoMarginCount=1;var He=3*(1+Object.keys(be).length);if(q._redrawFromAutoMarginCount<He)return e.call("_doPlot",j);q._size=X,r.warn("Too many auto-margin redraws.")}N(j)};function N(j){var q=s.list(j,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(H){for(var U=0;U<q.length;U++){var $=q[U][H];$&&$()}})}var G=["l","r","t","b","p","w","h"];o.didMarginChange=function(j,q){for(var H=0;H<G.length;H++){var U=G[H],$=j[U],ne=q[U];if(!M($)||Math.abs(ne-$)>1)return!0}return!1},o.graphJson=function(j,q,H,U,$,ne){($&&q&&!j._fullData||$&&!q&&!j._fullLayout)&&o.supplyDefaults(j);var X=$?j._fullData:j.data,Q=$?j._fullLayout:j.layout,ie=(j._transitionData||{})._frames;function se(be,ce){if(typeof be=="function")return ce?"_function_":null;if(r.isPlainObject(be)){var de={},ye;return Object.keys(be).sort().forEach(function(ge){if(["_","["].indexOf(ge.charAt(0))===-1){if(typeof be[ge]=="function"){ce&&(de[ge]="_function");return}if(H==="keepdata"){if(ge.substr(ge.length-3)==="src")return}else if(H==="keepstream"){if(ye=be[ge+"src"],typeof ye=="string"&&ye.indexOf(":")>0&&!r.isPlainObject(be.stream))return}else if(H!=="keepall"&&(ye=be[ge+"src"],typeof ye=="string"&&ye.indexOf(":")>0))return;de[ge]=se(be[ge],ce)}}),de}return Array.isArray(be)?be.map(function(ge){return se(ge,ce)}):r.isTypedArray(be)?r.simpleMap(be,r.identity):r.isJSDate(be)?r.ms2DateTimeLocal(+be):be}var ae={data:(X||[]).map(function(be){var ce=se(be);return q&&delete ce.fit,ce})};if(!q&&(ae.layout=se(Q),$)){var oe=Q._size;ae.layout.computed={margin:{b:oe.b,l:oe.l,r:oe.r,t:oe.t}}}return ie&&(ae.frames=se(ie)),ne&&(ae.config=se(j._context,!0)),U==="object"?ae:JSON.stringify(ae)},o.modifyFrames=function(j,q){var H,U,$,ne=j._transitionData._frames,X=j._transitionData._frameHash;for(H=0;H<q.length;H++)switch(U=q[H],U.type){case"replace":$=U.value;var Q=(ne[U.index]||{}).name,ie=$.name;ne[U.index]=X[ie]=$,ie!==Q&&(delete X[Q],X[ie]=$);break;case"insert":$=U.value,X[$.name]=$,ne.splice(U.index,0,$);break;case"delete":$=ne[U.index],delete X[$.name],ne.splice(U.index,1);break}return Promise.resolve()},o.computeFrame=function(j,q){var H=j._transitionData._frameHash,U,$,ne,X;if(!q)throw new Error("computeFrame must be given a string frame name");var Q=H[q.toString()];if(!Q)return!1;for(var ie=[Q],se=[Q.name];Q.baseframe&&(Q=H[Q.baseframe.toString()])&&se.indexOf(Q.name)===-1;)ie.push(Q),se.push(Q.name);for(var ae={};Q=ie.pop();)if(Q.layout&&(ae.layout=o.extendLayout(ae.layout,Q.layout)),Q.data){if(ae.data||(ae.data=[]),$=Q.traces,!$)for($=[],U=0;U<Q.data.length;U++)$[U]=U;for(ae.traces||(ae.traces=[]),U=0;U<Q.data.length;U++)ne=$[U],ne!=null&&(X=ae.traces.indexOf(ne),X===-1&&(X=ae.data.length,ae.traces[X]=ne),ae.data[X]=o.extendTrace(ae.data[X],Q.data[U]))}return ae},o.recomputeFrameHash=function(j){for(var q=j._transitionData._frameHash={},H=j._transitionData._frames,U=0;U<H.length;U++){var $=H[U];$&&$.name&&(q[$.name]=$)}},o.extendObjectWithContainers=function(j,q,H){var U,$,ne,X,Q,ie,se,ae,oe=r.extendDeepNoArrays({},q||{}),be=r.expandObjectPaths(oe),ce={};if(H&&H.length)for(ne=0;ne<H.length;ne++)U=r.nestedProperty(be,H[ne]),$=U.get(),$===void 0?r.nestedProperty(ce,H[ne]).set(null):(U.set(null),r.nestedProperty(ce,H[ne]).set($));if(j=r.extendDeepNoArrays(j||{},be),H&&H.length){for(ne=0;ne<H.length;ne++)if(Q=r.nestedProperty(ce,H[ne]),se=Q.get(),!!se){for(ie=r.nestedProperty(j,H[ne]),ae=ie.get(),Array.isArray(ae)||(ae=[],ie.set(ae)),X=0;X<se.length;X++){var de=se[X];de===null?ae[X]=null:ae[X]=o.extendObjectWithContainers(ae[X],de)}ie.set(ae)}}return j},o.dataArrayContainers=["transforms","dimensions"],o.layoutArrayContainers=e.layoutArrayContainers,o.extendTrace=function(j,q){return o.extendObjectWithContainers(j,q,o.dataArrayContainers)},o.extendLayout=function(j,q){return o.extendObjectWithContainers(j,q,o.layoutArrayContainers)},o.transition=function(j,q,H,U,$,ne){var X={redraw:$.redraw},Q={},ie=[];return X.prepareFn=function(){for(var se=Array.isArray(q)?q.length:0,ae=U.slice(0,se),oe=0;oe<ae.length;oe++){var be=ae[oe],ce=j._fullData[be],de=ce._module;if(de){if(de.animatable){var ye=de.basePlotModule.name;Q[ye]||(Q[ye]=[]),Q[ye].push(be)}j.data[ae[oe]]=o.extendTrace(j.data[ae[oe]],q[oe])}}var ge=r.expandObjectPaths(r.extendDeepNoArrays({},H)),me=/^[xy]axis[0-9]*$/;for(var Ee in ge)me.test(Ee)&&delete ge[Ee].range;o.extendLayout(j.layout,ge),delete j.calcdata,o.supplyDefaults(j),o.doCalcdata(j);var Pe=r.expandObjectPaths(H);if(Pe){var Ue=j._fullLayout._plots;for(var we in Ue){var ke=Ue[we],Xe=ke.xaxis,Ve=ke.yaxis,Ie=Xe.range.slice(),De=Ve.range.slice(),Ye=null,vt=null,Dt=null,Kt=null;Array.isArray(Pe[Xe._name+".range"])?Ye=Pe[Xe._name+".range"].slice():Array.isArray((Pe[Xe._name]||{}).range)&&(Ye=Pe[Xe._name].range.slice()),Array.isArray(Pe[Ve._name+".range"])?vt=Pe[Ve._name+".range"].slice():Array.isArray((Pe[Ve._name]||{}).range)&&(vt=Pe[Ve._name].range.slice()),Ie&&Ye&&(Xe.r2l(Ie[0])!==Xe.r2l(Ye[0])||Xe.r2l(Ie[1])!==Xe.r2l(Ye[1]))&&(Dt={xr0:Ie,xr1:Ye}),De&&vt&&(Ve.r2l(De[0])!==Ve.r2l(vt[0])||Ve.r2l(De[1])!==Ve.r2l(vt[1]))&&(Kt={yr0:De,yr1:vt}),(Dt||Kt)&&ie.push(r.extendFlat({plotinfo:ke},Dt,Kt))}}return Promise.resolve()},X.runFn=function(se){var ae,oe=j._fullLayout._basePlotModules,be=ie.length,ce;if(H)for(ce=0;ce<oe.length;ce++)oe[ce].transitionAxes&&oe[ce].transitionAxes(j,ie,ne,se);be?(ae=r.extendFlat({},ne),ae.duration=0,delete Q.cartesian):ae=ne;for(var de in Q){var ye=Q[de],ge=j._fullData[ye[0]]._module;ge.basePlotModule.plot(j,ye,ae,se)}},K(j,ne,X)},o.transitionFromReact=function(j,q,H,U){var $=j._fullLayout,ne=$.transition,X={},Q=[];return X.prepareFn=function(){var ie=$._plots;X.redraw=!1,q.anim==="some"&&(X.redraw=!0),H.anim==="some"&&(X.redraw=!0);for(var se in ie){var ae=ie[se],oe=ae.xaxis,be=ae.yaxis,ce=U[oe._name].range.slice(),de=U[be._name].range.slice(),ye=oe.range.slice(),ge=be.range.slice();oe.setScale(),be.setScale();var me=null,Ee=null;(oe.r2l(ce[0])!==oe.r2l(ye[0])||oe.r2l(ce[1])!==oe.r2l(ye[1]))&&(me={xr0:ce,xr1:ye}),(be.r2l(de[0])!==be.r2l(ge[0])||be.r2l(de[1])!==be.r2l(ge[1]))&&(Ee={yr0:de,yr1:ge}),(me||Ee)&&Q.push(r.extendFlat({plotinfo:ae},me,Ee))}return Promise.resolve()},X.runFn=function(ie){for(var se=j._fullData,ae=j._fullLayout,oe=ae._basePlotModules,be,ce,de,ye=[],ge=0;ge<se.length;ge++)ye.push(ge);function me(){if(j._fullLayout)for(var Pe=0;Pe<oe.length;Pe++)oe[Pe].transitionAxes&&oe[Pe].transitionAxes(j,Q,be,ie)}function Ee(){if(j._fullLayout)for(var Pe=0;Pe<oe.length;Pe++)oe[Pe].plot(j,de,ce,ie)}Q.length&&q.anim?ne.ordering==="traces first"?(be=r.extendFlat({},ne,{duration:0}),de=ye,ce=ne,setTimeout(me,ne.duration),Ee()):(be=ne,de=null,ce=r.extendFlat({},ne,{duration:0}),setTimeout(Ee,be.duration),me()):Q.length?(be=ne,me()):q.anim&&(de=ye,ce=ne,Ee())},K(j,ne,X)};function K(j,q,H){var U=!1;function $(oe){var be=Promise.resolve();if(!oe)return be;for(;oe.length;)be=be.then(oe.shift());return be}function ne(oe){if(oe)for(;oe.length;)oe.shift()}function X(){return j.emit("plotly_transitioning",[]),new Promise(function(oe){j._transitioning=!0,q.duration>0&&(j._transitioningWithDuration=!0),j._transitionData._interruptCallbacks.push(function(){U=!0}),H.redraw&&j._transitionData._interruptCallbacks.push(function(){return e.call("redraw",j)}),j._transitionData._interruptCallbacks.push(function(){j.emit("plotly_transitioninterrupted",[])});var be=0,ce=0;function de(){return be++,function(){ce++,!U&&ce===be&&Q(oe)}}H.runFn(de),setTimeout(de())})}function Q(oe){if(j._transitionData)return ne(j._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(H.redraw)return e.call("redraw",j)}).then(function(){j._transitioning=!1,j._transitioningWithDuration=!1,j.emit("plotly_transitioned",[])}).then(oe)}function ie(){if(j._transitionData)return j._transitioning=!1,$(j._transitionData._interruptCallbacks)}var se=[o.previousPromises,ie,H.prepareFn,o.rehover,o.reselect,X],ae=r.syncOrAsync(se,j);return(!ae||!ae.then)&&(ae=Promise.resolve()),ae.then(function(){return j})}o.doCalcdata=function(j,q){var H=s.list(j),U=j._fullData,$=j._fullLayout,ne,X,Q,ie,se=new Array(U.length),ae=(j.calcdata||[]).slice();for(j.calcdata=se,$._numBoxes=0,$._numViolins=0,$._violinScaleGroupStats={},j._hmpixcount=0,j._hmlumcount=0,$._piecolormap={},$._sunburstcolormap={},$._treemapcolormap={},$._iciclecolormap={},$._funnelareacolormap={},Q=0;Q<U.length;Q++)if(Array.isArray(q)&&q.indexOf(Q)===-1){se[Q]=ae[Q];continue}for(Q=0;Q<U.length;Q++)ne=U[Q],ne._arrayAttrs=a.findArrayAttributes(ne),ne._extremes={};var oe=$._subplots.polar||[];for(Q=0;Q<oe.length;Q++)H.push($[oe[Q]].radialaxis,$[oe[Q]].angularaxis);for(var be in $._colorAxes){var ce=$[be];ce.cauto!==!1&&(delete ce.cmin,delete ce.cmax)}var de=!1;function ye(Ee){if(ne=U[Ee],X=ne._module,ne.visible===!0&&ne.transforms){if(X&&X.calc){var Pe=X.calc(j,ne);Pe[0]&&Pe[0].t&&Pe[0].t._scene&&delete Pe[0].t._scene.dirty}for(ie=0;ie<ne.transforms.length;ie++){var Ue=ne.transforms[ie];X=m[Ue.type],X&&X.calcTransform&&(ne._hasCalcTransform=!0,de=!0,X.calcTransform(j,ne,Ue))}}}function ge(Ee,Pe){if(ne=U[Ee],X=ne._module,!!X.isContainer===Pe){var Ue=[];if(ne.visible===!0&&ne._length!==0){delete ne._indexToPoints;var we=ne.transforms||[];for(ie=we.length-1;ie>=0;ie--)if(we[ie].enabled){ne._indexToPoints=we[ie]._indexToPoints;break}X&&X.calc&&(Ue=X.calc(j,ne))}(!Array.isArray(Ue)||!Ue[0])&&(Ue=[{x:h,y:h}]),Ue[0].t||(Ue[0].t={}),Ue[0].trace=ne,se[Ee]=Ue}}for(re(H,U,$),Q=0;Q<U.length;Q++)ge(Q,!0);for(Q=0;Q<U.length;Q++)ye(Q);for(de&&re(H,U,$),Q=0;Q<U.length;Q++)ge(Q,!0);for(Q=0;Q<U.length;Q++)ge(Q,!1);ue(j);var me=Y(H,j);if(me.length){for($._numBoxes=0,$._numViolins=0,Q=0;Q<me.length;Q++)ge(me[Q],!0);for(Q=0;Q<me.length;Q++)ge(me[Q],!1);ue(j)}e.getComponentMethod("fx","calc")(j),e.getComponentMethod("errorbars","calc")(j)};var W=/(total|sum|min|max|mean|median) (ascending|descending)/;function Y(j,q){var H=[],U,$,ne,X,Q;function ie(Mt,Xt,It){var At=Xt._id.charAt(0);if(Mt==="histogram2dcontour"){var Ge=Xt._counterAxes[0],tt=s.getFromId(q,Ge),He=At==="x"||Ge==="x"&&tt.type==="category",Ae=At==="y"||Ge==="y"&&tt.type==="category";return function(Ne,Ze){return Ne===0||Ze===0||He&&Ne===It[Ze].length-1||Ae&&Ze===It.length-1?-1:(At==="y"?Ze:Ne)-1}}else return function(Ne,Ze){return At==="y"?Ze:Ne}}var se={min:function(Mt){return r.aggNums(Math.min,null,Mt)},max:function(Mt){return r.aggNums(Math.max,null,Mt)},sum:function(Mt){return r.aggNums(function(Xt,It){return Xt+It},null,Mt)},total:function(Mt){return r.aggNums(function(Xt,It){return Xt+It},null,Mt)},mean:function(Mt){return r.mean(Mt)},median:function(Mt){return r.median(Mt)}};for(U=0;U<j.length;U++){var ae=j[U];if(ae.type==="category"){var oe=ae.categoryorder.match(W);if(oe){var be=oe[1],ce=oe[2],de=ae._id.charAt(0),ye=de==="x",ge=[];for($=0;$<ae._categories.length;$++)ge.push([ae._categories[$],[]]);for($=0;$<ae._traceIndices.length;$++){var me=ae._traceIndices[$],Ee=q._fullData[me];if(Ee.visible===!0){var Pe=Ee.type;e.traceIs(Ee,"histogram")&&(delete Ee._xautoBinFinished,delete Ee._yautoBinFinished);var Ue=Pe==="splom",we=Pe==="scattergl",ke=q.calcdata[me];for(ne=0;ne<ke.length;ne++){var Xe=ke[ne],Ve,Ie;if(Ue){var De=Ee._axesDim[ae._id];if(!ye){var Ye=Ee._diag[De][0];Ye&&(ae=q._fullLayout[s.id2name(Ye)])}var vt=Xe.trace.dimensions[De].values;for(X=0;X<vt.length;X++)for(Ve=ae._categoriesMap[vt[X]],Q=0;Q<Xe.trace.dimensions.length;Q++)if(Q!==De){var Dt=Xe.trace.dimensions[Q];ge[Ve][1].push(Dt.values[X])}}else if(we){for(X=0;X<Xe.t.x.length;X++)ye?(Ve=Xe.t.x[X],Ie=Xe.t.y[X]):(Ve=Xe.t.y[X],Ie=Xe.t.x[X]),ge[Ve][1].push(Ie);Xe.t&&Xe.t._scene&&delete Xe.t._scene.dirty}else if(Xe.hasOwnProperty("z")){Ie=Xe.z;var Kt=ie(Ee.type,ae,Ie);for(X=0;X<Ie.length;X++)for(Q=0;Q<Ie[X].length;Q++)Ve=Kt(Q,X),Ve+1&&ge[Ve][1].push(Ie[X][Q])}else for(Ve=Xe.p,Ve===void 0&&(Ve=Xe[de]),Ie=Xe.s,Ie===void 0&&(Ie=Xe.v),Ie===void 0&&(Ie=ye?Xe.y:Xe.x),Array.isArray(Ie)||(Ie===void 0?Ie=[]:Ie=[Ie]),X=0;X<Ie.length;X++)ge[Ve][1].push(Ie[X])}}}ae._categoriesValue=ge;var Ft=[];for($=0;$<ge.length;$++)Ft.push([ge[$][0],se[be](ge[$][1])]);Ft.sort(function(Mt,Xt){return Mt[1]-Xt[1]}),ae._categoriesAggregatedValue=Ft,ae._initialCategories=Ft.map(function(Mt){return Mt[0]}),ce==="descending"&&ae._initialCategories.reverse(),H=H.concat(ae.sortByInitialCategories())}}}return H}function re(j,q,H){var U={};function $(ie){ie.clearCalc(),ie.type==="multicategory"&&ie.setupMultiCategory(q),U[ie._id]=1}r.simpleMap(j,$);for(var ne=H._axisMatchGroups||[],X=0;X<ne.length;X++)for(var Q in ne[X])U[Q]||$(H[s.id2name(Q)])}function ue(j){var q=j._fullLayout,H=q._visibleModules,U={},$,ne,X;for(ne=0;ne<H.length;ne++){var Q=H[ne],ie=Q.crossTraceCalc;if(ie){var se=Q.basePlotModule.name;U[se]?r.pushUnique(U[se],ie):U[se]=[ie]}}for(X in U){var ae=U[X],oe=q._subplots[X];if(Array.isArray(oe))for($=0;$<oe.length;$++){var be=oe[$],ce=X==="cartesian"?q._plots[be]:q[be];for(ne=0;ne<ae.length;ne++)ae[ne](j,ce,be)}else for(ne=0;ne<ae.length;ne++)ae[ne](j)}}o.rehover=function(j){j._fullLayout._rehover&&j._fullLayout._rehover()},o.redrag=function(j){j._fullLayout._redrag&&j._fullLayout._redrag()},o.reselect=function(j){var q=j._fullLayout,H=(j.layout||{}).selections,U=q._previousSelections;q._previousSelections=H;var $=q._reselect||JSON.stringify(H)!==JSON.stringify(U);e.getComponentMethod("selections","reselect")(j,$)},o.generalUpdatePerTraceModule=function(j,q,H,U){var $=q.traceHash,ne={},X;for(X=0;X<H.length;X++){var Q=H[X],ie=Q[0].trace;ie.visible&&(ne[ie.type]=ne[ie.type]||[],ne[ie.type].push(Q))}for(var se in $)if(!ne[se]){var ae=$[se][0],oe=ae[0].trace;oe.visible=!1,ne[se]=[ae]}for(var be in ne){var ce=ne[be],de=ce[0][0].trace._module;de.plot(j,q,r.filterVisible(ce),U)}q.traceHash=ne},o.plotBasePlot=function(j,q,H,U,$){var ne=e.getModule(j),X=v(q.calcdata,ne)[0];ne.plot(q,X,U,$)},o.cleanBasePlot=function(j,q,H,U,$){var ne=$._has&&$._has(j),X=H._has&&H._has(j);ne&&!X&&$["_"+j+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(y,ee,te){ee.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(y,ee,te){var A=y("../../lib"),g=y("../../lib/polygon").tester,S=A.findIndexOfMin,M=A.isAngleInsideSector,e=A.angleDelta,a=A.angleDist;function n(m,l,w,_,c){if(!M(l,_))return!1;var b,u;w[0]<w[1]?(b=w[0],u=w[1]):(b=w[1],u=w[0]);var L=g(i(b,_[0],_[1],c)),T=g(i(u,_[0],_[1],c)),k=[m*Math.cos(l),m*Math.sin(l)];return T.contains(k)&&!L.contains(k)}function r(m,l,w,_){var c,b,u=_[0],L=_[1],T=v(Math.sin(l)-Math.sin(m)),k=v(Math.cos(l)-Math.cos(m)),P=Math.tan(w),z=v(1/P),I=T/k,D=L-I*u;return z?T&&k?(c=D/(P-I),b=P*c):k?(c=L*z,b=L):(c=u,b=u*P):T&&k?(c=0,b=D):k?(c=0,b=L):c=b=NaN,[c,b]}function t(m,l,w,_){var c=-l*w,b=l*l+1,u=2*(l*c-w),L=c*c+w*w-m*m,T=Math.sqrt(u*u-4*b*L),k=(-u+T)/(2*b),P=(-u-T)/(2*b);return[[k,l*k+c+_],[P,l*P+c+_]]}function h(m,l){var w=l.length,_=new Array(w+1),c;for(c=0;c<w;c++){var b=l[c];_[c]=[m*Math.cos(b),m*Math.sin(b)]}return _[c]=_[0].slice(),_}function s(m,l,w,_){var c=_.length,b=[],u,L;function T(N){return[m*Math.cos(N),m*Math.sin(N)]}function k(N,G,K){return r(N,G,K,T(N))}function P(N){return A.mod(N,c)}function z(N){return M(N,[l,w])}var I=S(_,function(N){return z(N)?a(N,l):1/0}),D=k(_[I],_[P(I-1)],l);for(b.push(D),u=I,L=0;L<c;u++,L++){var R=_[P(u)];if(!z(R))break;b.push(T(R))}var O=S(_,function(N){return z(N)?a(N,w):1/0}),F=k(_[O],_[P(O+1)],w);return b.push(F),b.push([0,0]),b.push(b[0].slice()),b}function i(m,l,w,_){return A.isFullCircle([l,w])?h(m,_):s(m,l,w,_)}function x(m,l,w,_){for(var c=1/0,b=1/0,u=i(m,l,w,_),L=0;L<u.length;L++){var T=u[L];c=Math.min(c,T[0]),b=Math.min(b,-T[1])}return[c,b]}function p(m,l){var w=function(b){var u=e(b,m);return u>0?u:1/0},_=S(l,w),c=A.mod(_+1,l.length);return[l[_],l[c]]}function v(m){return Math.abs(m)>1e-10?m:0}function f(m,l,w){l=l||0,w=w||0;for(var _=m.length,c=new Array(_),b=0;b<_;b++){var u=m[b];c[b]=[l+u[0],w-u[1]]}return c}function d(m,l,w,_,c,b){var u=i(m,l,w,_);return"M"+f(u,c,b).join("L")}function o(m,l,w,_,c,b,u){var L,T;m<l?(L=m,T=l):(L=l,T=m);var k=f(i(L,w,_,c),b,u),P=f(i(T,w,_,c),b,u);return"M"+P.reverse().join("L")+"M"+k.join("L")}ee.exports={isPtInsidePolygon:n,findPolygonOffset:x,findEnclosingVertexAngles:p,findIntersectionXY:r,findXYatLength:t,clampTiny:v,pathPolygon:d,pathPolygonAnnulus:o}},{"../../lib":515,"../../lib/polygon":527}],631:[function(y,ee,te){var A=y("../get_data").getSubplotCalcData,g=y("../../lib").counterRegex,S=y("./polar"),M=y("./constants"),e=M.attr,a=M.name,n=g(a),r={};r[e]={valType:"subplotid",dflt:a,editType:"calc"};function t(s){for(var i=s._fullLayout,x=s.calcdata,p=i._subplots[a],v=0;v<p.length;v++){var f=p[v],d=A(x,a,f),o=i[f]._subplot;o||(o=S(s,f),i[f]._subplot=o),o.plot(d,i,s._promises)}}function h(s,i,x,p){for(var v=p._subplots[a]||[],f=p._has&&p._has("gl"),d=i._has&&i._has("gl"),o=f&&!d,m=0;m<v.length;m++){var l=v[m],w=p[l]._subplot;if(!i[l]&&w){w.framework.remove(),w.layers["radial-axis-title"].remove();for(var _ in w.clipPaths)w.clipPaths[_].remove()}o&&w._scene&&(w._scene.destroy(),w._scene=null)}}ee.exports={attr:e,name:a,idRoot:a,idRegex:n,attrRegex:n,attributes:r,layoutAttributes:y("./layout_attributes"),supplyLayoutDefaults:y("./layout_defaults"),plot:t,clean:h,toSVG:y("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(y,ee,te){var A=y("../../components/color/attributes"),g=y("../cartesian/layout_attributes"),S=y("../domain").attributes,M=y("../../lib").extendFlat,e=y("../../plot_api/edit_types").overrideAll,a=e({color:g.color,showline:M({},g.showline,{dflt:!0}),linecolor:g.linecolor,linewidth:g.linewidth,showgrid:M({},g.showgrid,{dflt:!0}),gridcolor:g.gridcolor,gridwidth:g.gridwidth,griddash:g.griddash},"plot","from-root"),n=e({tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,ticklabelstep:g.ticklabelstep,showticklabels:g.showticklabels,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,showexponent:g.showexponent,exponentformat:g.exponentformat,minexponent:g.minexponent,separatethousands:g.separatethousands,tickfont:g.tickfont,tickangle:g.tickangle,tickformat:g.tickformat,tickformatstops:g.tickformatstops,layer:g.layer},"plot","from-root"),r={visible:M({},g.visible,{dflt:!0}),type:M({},g.type,{values:["-","linear","log","date","category"]}),autotypenumbers:g.autotypenumbers,autorange:M({},g.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:M({},g.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:g.categoryorder,categoryarray:g.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:M({},g.title.text,{editType:"plot",dflt:""}),font:M({},g.title.font,{editType:"plot"}),editType:"plot"},hoverformat:g.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:g._deprecated.title,titlefont:g._deprecated.titlefont}};M(r,a,n);var t={visible:M({},g.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:g.autotypenumbers,categoryorder:g.categoryorder,categoryarray:g.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:g.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};M(t,a,n),ee.exports={domain:S({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:A.background},radialaxis:r,angularaxis:t,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color"),S=y("../../plot_api/plot_template"),M=y("../subplot_defaults"),e=y("../get_data").getSubplotData,a=y("../cartesian/tick_value_defaults"),n=y("../cartesian/tick_mark_defaults"),r=y("../cartesian/tick_label_defaults"),t=y("../cartesian/prefix_suffix_defaults"),h=y("../cartesian/category_order_defaults"),s=y("../cartesian/line_grid_defaults"),i=y("../cartesian/axis_autotype"),x=y("./layout_attributes"),p=y("./set_convert"),v=y("./constants"),f=v.axisNames;function d(m,l,w,_){var c=w("bgcolor");_.bgColor=g.combine(c,_.paper_bgcolor);var b=w("sector");w("hole");var u=e(_.fullData,v.name,_.id),L=_.layoutOut,T;function k(j,q){return w(T+"."+j,q)}for(var P=0;P<f.length;P++){T=f[P],A.isPlainObject(m[T])||(m[T]={});var z=m[T],I=S.newContainer(l,T);I._id=I._name=T,I._attr=_.id+"."+T,I._traceIndices=u.map(function(j){return j._expandedIndex});var D=v.axisName2dataArray[T],R=o(z,I,k,u,D,_);h(z,I,k,{axData:u,dataAttr:D});var O=k("visible");switch(p(I,l,L),k("uirevision",l.uirevision),I._m=1,T){case"radialaxis":var F=k("autorange",!I.isValidRange(z.range));z.autorange=F,F&&(R==="linear"||R==="-")&&k("rangemode"),F==="reversed"&&(I._m=-1),k("range"),I.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(R==="date"){A.log("Polar plots do not support date angular axes yet.");for(var N=0;N<u.length;N++)u[N].visible=!1;R=z.type=I.type="linear"}k(R==="linear"?"thetaunit":"period");var G=k("direction");k("rotation",{counterclockwise:0,clockwise:90}[G]);break}if(t(z,I,k,I.type,{tickSuffixDflt:I.thetaunit==="degrees"?"":void 0}),O){var K,W,Y,re,ue=_.font||{};K=k("color"),W=K===z.color?K:ue.color,Y=ue.size,re=ue.family,a(z,I,k,I.type),r(z,I,k,I.type,{font:{color:W,size:Y,family:re}}),n(z,I,k,{outerTicks:!0}),s(z,I,k,{dfltColor:K,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:x[T]}),k("layer"),T==="radialaxis"&&(k("side"),k("angle",b[0]),k("title.text"),A.coerceFont(k,"title.font",{color:W,size:A.bigFont(Y),family:re}))}R!=="category"&&k("hoverformat"),I._input=z}l.angularaxis.type==="category"&&w("gridshape")}function o(m,l,w,_,c,b){var u=w("autotypenumbers",b.autotypenumbersDflt),L=w("type");if(L==="-"){for(var T,k=0;k<_.length;k++)if(_[k].visible){T=_[k];break}T&&T[c]&&(l.type=i(T[c],"gregorian",{noMultiCategory:!0,autotypenumbers:u})),l.type==="-"?l.type="linear":m.type=l.type}return l.type}ee.exports=function(l,w,_){M(l,w,_,{type:v.name,attributes:x,handleDefaults:d,font:w.font,autotypenumbersDflt:w.autotypenumbers,paper_bgcolor:w.paper_bgcolor,fullData:_,layoutOut:w})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(y,ee,te){var A=y("@plotly/d3"),g=y("tinycolor2"),S=y("../../registry"),M=y("../../lib"),e=M.strRotate,a=M.strTranslate,n=y("../../components/color"),r=y("../../components/drawing"),t=y("../plots"),h=y("../../plots/cartesian/axes"),s=y("../cartesian/set_convert"),i=y("./set_convert"),x=y("../cartesian/autorange").doAutoRange,p=y("../cartesian/dragbox"),v=y("../../components/dragelement"),f=y("../../components/fx"),d=y("../../components/titles"),o=y("../../components/selections").prepSelect,m=y("../../components/selections").selectOnClick,l=y("../../components/selections").clearOutline,w=y("../../lib/setcursor"),_=y("../../lib/clear_gl_canvases"),c=y("../../plot_api/subroutines").redrawReglTraces,b=y("../../constants/alignment").MID_SHIFT,u=y("./constants"),L=y("./helpers"),T=y("../smith/helpers"),k=T.smith,P=T.reactanceArc,z=T.resistanceArc,I=T.smithTransform,D=M._,R=M.mod,O=M.deg2rad,F=M.rad2deg;function N(ue,j,q){this.isSmith=q||!1,this.id=j,this.gd=ue,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var H=ue._fullLayout,U="clip"+H._uid+j;this.clipIds.forTraces=U+"-for-traces",this.clipPaths.forTraces=H._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=H["_"+(q?"smith":"polar")+"layer"].append("g").attr("class",j),this.getHole=function($){return this.isSmith?0:$.hole},this.getSector=function($){return this.isSmith?[0,360]:$.sector},this.getRadial=function($){return this.isSmith?$.realaxis:$.radialaxis},this.getAngular=function($){return this.isSmith?$.imaginaryaxis:$.angularaxis},q||(this.radialTickLayout=null,this.angularTickLayout=null)}var G=N.prototype;ee.exports=function(j,q,H){return new N(j,q,H)},G.plot=function(ue,j){for(var q=this,H=j[q.id],U=!1,$=0;$<ue.length;$++){var ne=ue[$][0].trace;if(ne.cliponaxis===!1){U=!0;break}}q._hasClipOnAxisFalse=U,q.updateLayers(j,H),q.updateLayout(j,H),t.generalUpdatePerTraceModule(q.gd,q,ue,H),q.updateFx(j,H),q.isSmith&&(delete H.realaxis.range,delete H.imaginaryaxis.range)},G.updateLayers=function(ue,j){var q=this,H=q.isSmith,U=q.layers,$=q.getRadial(j),ne=q.getAngular(j),X=u.layerNames,Q=X.indexOf("frontplot"),ie=X.slice(0,Q),se=ne.layer==="below traces",ae=$.layer==="below traces";se&&ie.push("angular-line"),ae&&ie.push("radial-line"),se&&ie.push("angular-axis"),ae&&ie.push("radial-axis"),ie.push("frontplot"),se||ie.push("angular-line"),ae||ie.push("radial-line"),se||ie.push("angular-axis"),ae||ie.push("radial-axis");var oe=(H?"smith":"polar")+"sublayer",be=q.framework.selectAll("."+oe).data(ie,String);be.enter().append("g").attr("class",function(ce){return oe+" "+ce}).each(function(ce){var de=U[ce]=A.select(this);switch(ce){case"frontplot":H||de.append("g").classed("barlayer",!0),de.append("g").classed("scatterlayer",!0);break;case"backplot":de.append("g").classed("maplayer",!0);break;case"plotbg":U.bg=de.append("path");break;case"radial-grid":de.style("fill","none");break;case"angular-grid":de.style("fill","none");break;case"radial-line":de.append("line").style("fill","none");break;case"angular-line":de.append("path").style("fill","none");break}}),be.order()},G.updateLayout=function(ue,j){var q=this,H=q.layers,U=ue._size,$=q.getRadial(j),ne=q.getAngular(j),X=j.domain.x,Q=j.domain.y;q.xOffset=U.l+U.w*X[0],q.yOffset=U.t+U.h*(1-Q[1]);var ie=q.xLength=U.w*(X[1]-X[0]),se=q.yLength=U.h*(Q[1]-Q[0]),ae=q.getSector(j);q.sectorInRad=ae.map(O);var oe=q.sectorBBox=W(ae),be=oe[2]-oe[0],ce=oe[3]-oe[1],de=se/ie,ye=Math.abs(ce/be),ge,me,Ee,Pe,Ue;de>ye?(ge=ie,me=ie*ye,Ue=(se-me)/U.h/2,Ee=[X[0],X[1]],Pe=[Q[0]+Ue,Q[1]-Ue]):(ge=se/ye,me=se,Ue=(ie-ge)/U.w/2,Ee=[X[0]+Ue,X[1]-Ue],Pe=[Q[0],Q[1]]),q.xLength2=ge,q.yLength2=me,q.xDomain2=Ee,q.yDomain2=Pe;var we=q.xOffset2=U.l+U.w*Ee[0],ke=q.yOffset2=U.t+U.h*(1-Pe[1]),Xe=q.radius=ge/be,Ve=q.innerRadius=q.getHole(j)*Xe,Ie=q.cx=we-Xe*oe[0],De=q.cy=ke+Xe*oe[3],Ye=q.cxx=Ie-we,vt=q.cyy=De-ke,Dt=$.side,Kt;Dt==="counterclockwise"?(Kt=Dt,Dt="top"):Dt==="clockwise"&&(Kt=Dt,Dt="bottom"),q.radialAxis=q.mockAxis(ue,j,$,{_id:"x",side:Dt,_trueSide:Kt,domain:[Ve/U.w,Xe/U.w]}),q.angularAxis=q.mockAxis(ue,j,ne,{side:"right",domain:[0,Math.PI],autorange:!1}),q.doAutoRange(ue,j),q.updateAngularAxis(ue,j),q.updateRadialAxis(ue,j),q.updateRadialAxisTitle(ue,j),q.xaxis=q.mockCartesianAxis(ue,j,{_id:"x",domain:Ee}),q.yaxis=q.mockCartesianAxis(ue,j,{_id:"y",domain:Pe});var Ft=q.pathSubplot();q.clipPaths.forTraces.select("path").attr("d",Ft).attr("transform",a(Ye,vt)),H.frontplot.attr("transform",a(we,ke)).call(r.setClipUrl,q._hasClipOnAxisFalse?null:q.clipIds.forTraces,q.gd),H.bg.attr("d",Ft).attr("transform",a(Ie,De)).call(n.fill,j.bgcolor)},G.mockAxis=function(ue,j,q,H){var U=M.extendFlat({},q,H);return i(U,j,ue),U},G.mockCartesianAxis=function(ue,j,q){var H=this,U=H.isSmith,$=q._id,ne=M.extendFlat({type:"linear"},q);s(ne,ue);var X={x:[0,2],y:[1,3]};return ne.setRange=function(){var Q=H.sectorBBox,ie=X[$],se=H.radialAxis._rl,ae=(se[1]-se[0])/(1-H.getHole(j));ne.range=[Q[ie[0]]*ae,Q[ie[1]]*ae]},ne.isPtWithinRange=$==="x"&&!U?function(Q){return H.isPtInside(Q)}:function(){return!0},ne.setRange(),ne.setScale(),ne},G.doAutoRange=function(ue,j){var q=this,H=q.gd,U=q.radialAxis,$=q.getRadial(j);x(H,U);var ne=U.range;$.range=ne.slice(),$._input.range=ne.slice(),U._rl=[U.r2l(ne[0],null,"gregorian"),U.r2l(ne[1],null,"gregorian")]},G.updateRadialAxis=function(ue,j){var q=this,H=q.gd,U=q.layers,$=q.radius,ne=q.innerRadius,X=q.cx,Q=q.cy,ie=q.getRadial(j),se=R(q.getSector(j)[0],360),ae=q.radialAxis,oe=ne<$,be=q.isSmith;be||(q.fillViewInitialKey("radialaxis.angle",ie.angle),q.fillViewInitialKey("radialaxis.range",ae.range.slice()),ae.setGeometry()),ae.tickangle==="auto"&&se>90&&se<=270&&(ae.tickangle=180);var ce=be?function(Xe){var Ve=I(q,k([Xe.x,0]));return a(Ve[0]-X,Ve[1]-Q)}:function(Xe){return a(ae.l2p(Xe.x)+ne,0)},de=be?function(Xe){return z(q,Xe.x,-1/0,1/0)}:function(Xe){return q.pathArc(ae.r2p(Xe.x)+ne)},ye=K(ie);if(q.radialTickLayout!==ye&&(U["radial-axis"].selectAll(".xtick").remove(),q.radialTickLayout=ye),oe){ae.setScale();var ge=0,me=be?(ae.tickvals||[]).filter(function(Xe){return Xe>=0}).map(function(Xe){return h.tickText(ae,Xe,!0,!1)}):h.calcTicks(ae),Ee=be?me:h.clipEnds(ae,me),Pe=h.getTickSigns(ae)[2];be&&((ae.ticks==="top"&&ae.side==="bottom"||ae.ticks==="bottom"&&ae.side==="top")&&(Pe=-Pe),ae.ticks==="top"&&ae.side==="top"&&(ge=-ae.ticklen),ae.ticks==="bottom"&&ae.side==="bottom"&&(ge=ae.ticklen)),h.drawTicks(H,ae,{vals:me,layer:U["radial-axis"],path:h.makeTickPath(ae,0,Pe),transFn:ce,crisp:!1}),h.drawGrid(H,ae,{vals:Ee,layer:U["radial-grid"],path:de,transFn:M.noop,crisp:!1}),h.drawLabels(H,ae,{vals:me,layer:U["radial-axis"],transFn:ce,labelFns:h.makeLabelFns(ae,ge)})}var Ue=q.radialAxisAngle=q.vangles?F(Y(O(ie.angle),q.vangles)):ie.angle,we=a(X,Q),ke=we+e(-Ue);re(U["radial-axis"],oe&&(ie.showticklabels||ie.ticks),{transform:ke}),re(U["radial-grid"],oe&&ie.showgrid,{transform:be?"":we}),re(U["radial-line"].select("line"),oe&&ie.showline,{x1:be?-$:ne,y1:0,x2:$,y2:0,transform:ke}).attr("stroke-width",ie.linewidth).call(n.stroke,ie.linecolor)},G.updateRadialAxisTitle=function(ue,j,q){if(!this.isSmith){var H=this,U=H.gd,$=H.radius,ne=H.cx,X=H.cy,Q=H.getRadial(j),ie=H.id+"title",se=0;if(Q.title){var ae=r.bBox(H.layers["radial-axis"].node()).height,oe=Q.title.font.size,be=Q.side;se=be==="top"?oe:be==="counterclockwise"?-(ae+oe*.4):ae+oe*.8}var ce=q!==void 0?q:H.radialAxisAngle,de=O(ce),ye=Math.cos(de),ge=Math.sin(de),me=ne+$/2*ye+se*ge,Ee=X-$/2*ge+se*ye;H.layers["radial-axis-title"]=d.draw(U,ie,{propContainer:Q,propName:H.id+".radialaxis.title",placeholder:D(U,"Click to enter radial axis title"),attributes:{x:me,y:Ee,"text-anchor":"middle"},transform:{rotate:-ce}})}},G.updateAngularAxis=function(ue,j){var q=this,H=q.gd,U=q.layers,$=q.radius,ne=q.innerRadius,X=q.cx,Q=q.cy,ie=q.getAngular(j),se=q.angularAxis,ae=q.isSmith;ae||(q.fillViewInitialKey("angularaxis.rotation",ie.rotation),se.setGeometry(),se.setScale());var oe=ae?function(Ve){var Ie=I(q,k([0,Ve.x]));return Math.atan2(Ie[0]-X,Ie[1]-Q)-Math.PI/2}:function(Ve){return se.t2g(Ve.x)};se.type==="linear"&&se.thetaunit==="radians"&&(se.tick0=F(se.tick0),se.dtick=F(se.dtick));var be=function(Ve){return a(X+$*Math.cos(Ve),Q-$*Math.sin(Ve))},ce=ae?function(Ve){var Ie=I(q,k([0,Ve.x]));return a(Ie[0],Ie[1])}:function(Ve){return be(oe(Ve))},de=ae?function(Ve){var Ie=I(q,k([0,Ve.x])),De=Math.atan2(Ie[0]-X,Ie[1]-Q)-Math.PI/2;return a(Ie[0],Ie[1])+e(-F(De))}:function(Ve){var Ie=oe(Ve);return be(Ie)+e(-F(Ie))},ye=ae?function(Ve){return P(q,Ve.x,0,1/0)}:function(Ve){var Ie=oe(Ve),De=Math.cos(Ie),Ye=Math.sin(Ie);return"M"+[X+ne*De,Q-ne*Ye]+"L"+[X+$*De,Q-$*Ye]},ge=h.makeLabelFns(se,0),me=ge.labelStandoff,Ee={};Ee.xFn=function(Ve){var Ie=oe(Ve);return Math.cos(Ie)*me},Ee.yFn=function(Ve){var Ie=oe(Ve),De=Math.sin(Ie)>0?.2:1;return-Math.sin(Ie)*(me+Ve.fontSize*De)+Math.abs(Math.cos(Ie))*(Ve.fontSize*b)},Ee.anchorFn=function(Ve){var Ie=oe(Ve),De=Math.cos(Ie);return Math.abs(De)<.1?"middle":De>0?"start":"end"},Ee.heightFn=function(Ve,Ie,De){var Ye=oe(Ve);return-.5*(1+Math.sin(Ye))*De};var Pe=K(ie);q.angularTickLayout!==Pe&&(U["angular-axis"].selectAll("."+se._id+"tick").remove(),q.angularTickLayout=Pe);var Ue=ae?[1/0].concat(se.tickvals||[]).map(function(Ve){return h.tickText(se,Ve,!0,!1)}):h.calcTicks(se);ae&&(Ue[0].text="",Ue[0].fontSize*=1.75);var we;if(j.gridshape==="linear"?(we=Ue.map(oe),M.angleDelta(we[0],we[1])<0&&(we=we.slice().reverse())):we=null,q.vangles=we,se.type==="category"&&(Ue=Ue.filter(function(Ve){return M.isAngleInsideSector(oe(Ve),q.sectorInRad)})),se.visible){var ke=se.ticks==="inside"?-1:1,Xe=(se.linewidth||1)/2;h.drawTicks(H,se,{vals:Ue,layer:U["angular-axis"],path:"M"+ke*Xe+",0h"+ke*se.ticklen,transFn:de,crisp:!1}),h.drawGrid(H,se,{vals:Ue,layer:U["angular-grid"],path:ye,transFn:M.noop,crisp:!1}),h.drawLabels(H,se,{vals:Ue,layer:U["angular-axis"],repositionOnUpdate:!0,transFn:ce,labelFns:Ee})}re(U["angular-line"].select("path"),ie.showline,{d:q.pathSubplot(),transform:a(X,Q)}).attr("stroke-width",ie.linewidth).call(n.stroke,ie.linecolor)},G.updateFx=function(ue,j){if(!this.gd._context.staticPlot){var q=!this.isSmith;q&&(this.updateAngularDrag(ue),this.updateRadialDrag(ue,j,0),this.updateRadialDrag(ue,j,1)),this.updateHoverAndMainDrag(ue)}},G.updateHoverAndMainDrag=function(ue){var j=this,q=j.isSmith,H=j.gd,U=j.layers,$=ue._zoomlayer,ne=u.MINZOOM,X=u.OFFEDGE,Q=j.radius,ie=j.innerRadius,se=j.cx,ae=j.cy,oe=j.cxx,be=j.cyy,ce=j.sectorInRad,de=j.vangles,ye=j.radialAxis,ge=L.clampTiny,me=L.findXYatLength,Ee=L.findEnclosingVertexAngles,Pe=u.cornerHalfWidth,Ue=u.cornerLen/2,we,ke,Xe=p.makeDragger(U,"path","maindrag",ue.dragmode===!1?"none":"crosshair");A.select(Xe).attr("d",j.pathSubplot()).attr("transform",a(se,ae)),Xe.onmousemove=function(Wt){f.hover(H,Wt,j.id),H._fullLayout._lasthover=Xe,H._fullLayout._hoversubplot=j.id},Xe.onmouseout=function(Wt){H._dragging||v.unhover(H,Wt)};var Ve={element:Xe,gd:H,subplot:j.id,plotinfo:{id:j.id,xaxis:j.xaxis,yaxis:j.yaxis},xaxes:[j.xaxis],yaxes:[j.yaxis]},Ie,De,Ye,vt,Dt,Kt,Ft,Mt,Xt;function It(Wt,Vt){return Math.sqrt(Wt*Wt+Vt*Vt)}function At(Wt,Vt){return It(Wt-oe,Vt-be)}function Ge(Wt,Vt){return Math.atan2(be-Vt,Wt-oe)}function tt(Wt,Vt){return[Wt*Math.cos(Vt),Wt*Math.sin(-Vt)]}function He(Wt,Vt){if(Wt===0)return j.pathSector(2*Pe);var ir=Ue/Wt,Hr=Vt-ir,sn=Vt+ir,jr=Math.max(0,Math.min(Wt,Q)),at=jr-Pe,$t=jr+Pe;return"M"+tt(at,Hr)+"A"+[at,at]+" 0,0,0 "+tt(at,sn)+"L"+tt($t,sn)+"A"+[$t,$t]+" 0,0,1 "+tt($t,Hr)+"Z"}function Ae(Wt,Vt,ir){if(Wt===0)return j.pathSector(2*Pe);var Hr=tt(Wt,Vt),sn=tt(Wt,ir),jr=ge((Hr[0]+sn[0])/2),at=ge((Hr[1]+sn[1])/2),$t,Jt;if(jr&&at){var Gt=at/jr,_r=-1/Gt,rt=me(Pe,Gt,jr,at);$t=me(Ue,_r,rt[0][0],rt[0][1]),Jt=me(Ue,_r,rt[1][0],rt[1][1])}else{var Je,st;at?(Je=Ue,st=Pe):(Je=Pe,st=Ue),$t=[[jr-Je,at-st],[jr+Je,at-st]],Jt=[[jr-Je,at+st],[jr+Je,at+st]]}return"M"+$t.join("L")+"L"+Jt.reverse().join("L")+"Z"}function Ne(){Ye=null,vt=null,Dt=j.pathSubplot(),Kt=!1;var Wt=H._fullLayout[j.id];Ft=g(Wt.bgcolor).getLuminance(),Mt=p.makeZoombox($,Ft,se,ae,Dt),Mt.attr("fill-rule","evenodd"),Xt=p.makeCorners($,se,ae),l(H)}function Ze(Wt,Vt){return Vt=Math.max(Math.min(Vt,Q),ie),Wt<X?Wt=0:Q-Wt<X?Wt=Q:Vt<X?Vt=0:Q-Vt<X&&(Vt=Q),Math.abs(Vt-Wt)>ne?(Wt<Vt?(Ye=Wt,vt=Vt):(Ye=Vt,vt=Wt),!0):(Ye=null,vt=null,!1)}function Qe(Wt,Vt){Wt=Wt||Dt,Vt=Vt||"M0,0Z",Mt.attr("d",Wt),Xt.attr("d",Vt),p.transitionZoombox(Mt,Xt,Kt,Ft),Kt=!0;var ir={};Rt(ir),H.emit("plotly_relayouting",ir)}function bt(Wt,Vt){Wt=Wt*we,Vt=Vt*ke;var ir=Ie+Wt,Hr=De+Vt,sn=At(Ie,De),jr=Math.min(At(ir,Hr),Q),at=Ge(Ie,De),$t,Jt;Ze(sn,jr)&&($t=Dt+j.pathSector(vt),Ye&&($t+=j.pathSector(Ye)),Jt=He(Ye,at)+He(vt,at)),Qe($t,Jt)}function dt(Wt,Vt,ir,Hr){var sn=L.findIntersectionXY(ir,Hr,ir,[Wt-oe,be-Vt]);return It(sn[0],sn[1])}function wt(Wt,Vt){var ir=Ie+Wt,Hr=De+Vt,sn=Ge(Ie,De),jr=Ge(ir,Hr),at=Ee(sn,de),$t=Ee(jr,de),Jt=dt(Ie,De,at[0],at[1]),Gt=Math.min(dt(ir,Hr,$t[0],$t[1]),Q),_r,rt;Ze(Jt,Gt)&&(_r=Dt+j.pathSector(vt),Ye&&(_r+=j.pathSector(Ye)),rt=[Ae(Ye,at[0],at[1]),Ae(vt,at[0],at[1])].join(" ")),Qe(_r,rt)}function Ut(){if(p.removeZoombox(H),!(Ye===null||vt===null)){var Wt={};Rt(Wt),p.showDoubleClickNotifier(H),S.call("_guiRelayout",H,Wt)}}function Rt(Wt){var Vt=ye._rl,ir=(Vt[1]-Vt[0])/(1-ie/Q)/Q,Hr=[Vt[0]+(Ye-ie)*ir,Vt[0]+(vt-ie)*ir];Wt[j.id+".radialaxis.range"]=Hr}function Nt(Wt,Vt){var ir=H._fullLayout.clickmode;if(p.removeZoombox(H),Wt===2){var Hr={};for(var sn in j.viewInitial)Hr[j.id+"."+sn]=j.viewInitial[sn];H.emit("plotly_doubleclick",null),S.call("_guiRelayout",H,Hr)}ir.indexOf("select")>-1&&Wt===1&&m(Vt,H,[j.xaxis],[j.yaxis],j.id,Ve),ir.indexOf("event")>-1&&f.click(H,Vt,j.id)}Ve.prepFn=function(Wt,Vt,ir){var Hr=H._fullLayout.dragmode,sn=Xe.getBoundingClientRect();H._fullLayout._calcInverseTransform(H);var jr=H._fullLayout._invTransform;we=H._fullLayout._invScaleX,ke=H._fullLayout._invScaleY;var at=M.apply3DTransform(jr)(Vt-sn.left,ir-sn.top);if(Ie=at[0],De=at[1],de){var $t=L.findPolygonOffset(Q,ce[0],ce[1],de);Ie+=oe+$t[0],De+=be+$t[1]}switch(Hr){case"zoom":Ve.clickFn=Nt,q||(de?Ve.moveFn=wt:Ve.moveFn=bt,Ve.doneFn=Ut,Ne());break;case"select":case"lasso":o(Wt,Vt,ir,Ve,Hr);break}},v.init(Ve)},G.updateRadialDrag=function(ue,j,q){var H=this,U=H.gd,$=H.layers,ne=H.radius,X=H.innerRadius,Q=H.cx,ie=H.cy,se=H.radialAxis,ae=u.radialDragBoxSize,oe=ae/2;if(!se.visible)return;var be=O(H.radialAxisAngle),ce=se._rl,de=ce[0],ye=ce[1],ge=ce[q],me=.75*(ce[1]-ce[0])/(1-H.getHole(j))/ne,Ee,Pe,Ue;q?(Ee=Q+(ne+oe)*Math.cos(be),Pe=ie-(ne+oe)*Math.sin(be),Ue="radialdrag"):(Ee=Q+(X-oe)*Math.cos(be),Pe=ie-(X-oe)*Math.sin(be),Ue="radialdrag-inner");var we=p.makeRectDragger($,Ue,"crosshair",-oe,-oe,ae,ae),ke={element:we,gd:U};ue.dragmode===!1&&(ke.dragmode=!1),re(A.select(we),se.visible&&X<ne,{transform:a(Ee,Pe)});var Xe,Ve,Ie;function De(Ft,Mt){if(Xe)Xe(Ft,Mt);else{var Xt=[Ft,-Mt],It=[Math.cos(be),Math.sin(be)],At=Math.abs(M.dot(Xt,It)/Math.sqrt(M.dot(Xt,Xt)));isNaN(At)||(Xe=At<.5?Dt:Kt)}var Ge={};Ye(Ge),U.emit("plotly_relayouting",Ge)}function Ye(Ft){Ve!==null?Ft[H.id+".radialaxis.angle"]=Ve:Ie!==null&&(Ft[H.id+".radialaxis.range["+q+"]"]=Ie)}function vt(){Ve!==null?S.call("_guiRelayout",U,H.id+".radialaxis.angle",Ve):Ie!==null&&S.call("_guiRelayout",U,H.id+".radialaxis.range["+q+"]",Ie)}function Dt(Ft,Mt){if(q!==0){var Xt=Ee+Ft,It=Pe+Mt;Ve=Math.atan2(ie-It,Xt-Q),H.vangles&&(Ve=Y(Ve,H.vangles)),Ve=F(Ve);var At=a(Q,ie)+e(-Ve);$["radial-axis"].attr("transform",At),$["radial-line"].select("line").attr("transform",At);var Ge=H.gd._fullLayout,tt=Ge[H.id];H.updateRadialAxisTitle(Ge,tt,Ve)}}function Kt(Ft,Mt){var Xt=M.dot([Ft,-Mt],[Math.cos(be),Math.sin(be)]);if(Ie=ge-me*Xt,me>0!=(q?Ie>de:Ie<ye)){Ie=null;return}var It=U._fullLayout,At=It[H.id];se.range[q]=Ie,se._rl[q]=Ie,H.updateRadialAxis(It,At),H.xaxis.setRange(),H.xaxis.setScale(),H.yaxis.setRange(),H.yaxis.setScale();var Ge=!1;for(var tt in H.traceHash){var He=H.traceHash[tt],Ae=M.filterVisible(He),Ne=He[0][0].trace._module;Ne.plot(U,H,Ae,At),S.traceIs(tt,"gl")&&Ae.length&&(Ge=!0)}Ge&&(_(U),c(U))}ke.prepFn=function(){Xe=null,Ve=null,Ie=null,ke.moveFn=De,ke.doneFn=vt,l(U)},ke.clampFn=function(Ft,Mt){return Math.sqrt(Ft*Ft+Mt*Mt)<u.MINDRAG&&(Ft=0,Mt=0),[Ft,Mt]},v.init(ke)},G.updateAngularDrag=function(ue){var j=this,q=j.gd,H=j.layers,U=j.radius,$=j.angularAxis,ne=j.cx,X=j.cy,Q=j.cxx,ie=j.cyy,se=u.angularDragBoxSize,ae=p.makeDragger(H,"path","angulardrag",ue.dragmode===!1?"none":"move"),oe={element:ae,gd:q};ue.dragmode===!1?oe.dragmode=!1:A.select(ae).attr("d",j.pathAnnulus(U,U+se)).attr("transform",a(ne,X)).call(w,"move");function be(Ie,De){return Math.atan2(ie+se-De,Ie-Q-se)}var ce=H.frontplot.select(".scatterlayer").selectAll(".trace"),de=ce.selectAll(".point"),ye=ce.selectAll(".textpoint"),ge,me,Ee,Pe,Ue,we;function ke(Ie,De){var Ye=j.gd._fullLayout,vt=Ye[j.id],Dt=ge+Ie*ue._invScaleX,Kt=me+De*ue._invScaleY,Ft=be(Dt,Kt),Mt=F(Ft-we);if(Pe=Ee+Mt,H.frontplot.attr("transform",a(j.xOffset2,j.yOffset2)+e([-Mt,Q,ie])),j.vangles){Ue=j.radialAxisAngle+Mt;var Xt=a(ne,X)+e(-Mt),It=a(ne,X)+e(-Ue);H.bg.attr("transform",Xt),H["radial-grid"].attr("transform",Xt),H["radial-axis"].attr("transform",It),H["radial-line"].select("line").attr("transform",It),j.updateRadialAxisTitle(Ye,vt,Ue)}else j.clipPaths.forTraces.select("path").attr("transform",a(Q,ie)+e(Mt));de.each(function(){var Ze=A.select(this),Qe=r.getTranslate(Ze);Ze.attr("transform",a(Qe.x,Qe.y)+e([Mt]))}),ye.each(function(){var Ze=A.select(this),Qe=Ze.select("text"),bt=r.getTranslate(Ze);Ze.attr("transform",e([Mt,Qe.attr("x"),Qe.attr("y")])+a(bt.x,bt.y))}),$.rotation=M.modHalf(Pe,360),j.updateAngularAxis(Ye,vt),j._hasClipOnAxisFalse&&!M.isFullCircle(j.sectorInRad)&&ce.call(r.hideOutsideRangePoints,j);var At=!1;for(var Ge in j.traceHash)if(S.traceIs(Ge,"gl")){var tt=j.traceHash[Ge],He=M.filterVisible(tt),Ae=tt[0][0].trace._module;Ae.plot(q,j,He,vt),He.length&&(At=!0)}At&&(_(q),c(q));var Ne={};Xe(Ne),q.emit("plotly_relayouting",Ne)}function Xe(Ie){Ie[j.id+".angularaxis.rotation"]=Pe,j.vangles&&(Ie[j.id+".radialaxis.angle"]=Ue)}function Ve(){ye.select("text").attr("transform",null);var Ie={};Xe(Ie),S.call("_guiRelayout",q,Ie)}oe.prepFn=function(Ie,De,Ye){var vt=ue[j.id];Ee=vt.angularaxis.rotation;var Dt=ae.getBoundingClientRect();ge=De-Dt.left,me=Ye-Dt.top,q._fullLayout._calcInverseTransform(q);var Kt=M.apply3DTransform(ue._invTransform)(ge,me);ge=Kt[0],me=Kt[1],we=be(ge,me),oe.moveFn=ke,oe.doneFn=Ve,l(q)},j.vangles&&!M.isFullCircle(j.sectorInRad)&&(oe.prepFn=M.noop,w(A.select(ae),null)),v.init(oe)},G.isPtInside=function(ue){if(this.isSmith)return!0;var j=this.sectorInRad,q=this.vangles,H=this.angularAxis.c2g(ue.theta),U=this.radialAxis,$=U.c2l(ue.r),ne=U._rl,X=q?L.isPtInsidePolygon:M.isPtInsideSector;return X($,H,ne,j,q)},G.pathArc=function(ue){var j=this.sectorInRad,q=this.vangles,H=q?L.pathPolygon:M.pathArc;return H(ue,j[0],j[1],q)},G.pathSector=function(ue){var j=this.sectorInRad,q=this.vangles,H=q?L.pathPolygon:M.pathSector;return H(ue,j[0],j[1],q)},G.pathAnnulus=function(ue,j){var q=this.sectorInRad,H=this.vangles,U=H?L.pathPolygonAnnulus:M.pathAnnulus;return U(ue,j,q[0],q[1],H)},G.pathSubplot=function(){var ue=this.innerRadius,j=this.radius;return ue?this.pathAnnulus(ue,j):this.pathSector(j)},G.fillViewInitialKey=function(ue,j){ue in this.viewInitial||(this.viewInitial[ue]=j)};function K(ue){var j=ue.ticks+String(ue.ticklen)+String(ue.showticklabels);return"side"in ue&&(j+=ue.side),j}function W(ue){var j=ue[0],q=ue[1],H=q-j,U=R(j,360),$=U+H,ne=Math.cos(O(U)),X=Math.sin(O(U)),Q=Math.cos(O($)),ie=Math.sin(O($)),se,ae,oe,be;return U<=90&&$>=90||U>90&&$>=450?be=1:X<=0&&ie<=0?be=0:be=Math.max(X,ie),U<=180&&$>=180||U>180&&$>=540?se=-1:ne>=0&&Q>=0?se=0:se=Math.min(ne,Q),U<=270&&$>=270||U>270&&$>=630?ae=-1:X>=0&&ie>=0?ae=0:ae=Math.min(X,ie),$>=360?oe=1:ne<=0&&Q<=0?oe=0:oe=Math.max(ne,Q),[se,ae,oe,be]}function Y(ue,j){var q=function(U){return M.angleDist(ue,U)},H=M.findIndexOfMin(j,q);return j[H]}function re(ue,j,q){return j?(ue.attr("display",null),ue.attr(q)):ue&&ue.attr("display","none"),ue}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(y,ee,te){var A=y("../../lib"),g=y("../cartesian/set_convert"),S=A.deg2rad,M=A.rad2deg;ee.exports=function(h,s,i){switch(g(h,i),h._id){case"x":case"radialaxis":e(h,s);break;case"angularaxis":r(h,s);break}};function e(t,h){var s=h._subplot;t.setGeometry=function(){var i=t._rl[0],x=t._rl[1],p=s.innerRadius,v=(s.radius-p)/(x-i),f=p/v,d=i>x?function(o){return o<=0}:function(o){return o>=0};t.c2g=function(o){var m=t.c2l(o)-i;return(d(m)?m:0)+f},t.g2c=function(o){return t.l2c(o+i-f)},t.g2p=function(o){return o*v},t.c2p=function(o){return t.g2p(t.c2g(o))}}}function a(t,h){return h==="degrees"?S(t):t}function n(t,h){return h==="degrees"?M(t):t}function r(t,h){var s=t.type;if(s==="linear"){var i=t.d2c,x=t.c2d;t.d2c=function(p,v){return a(i(p),v)},t.c2d=function(p,v){return x(n(p,v))}}t.makeCalcdata=function(p,v){var f=p[v],d=p._length,o,m,l=function(u){return t.d2c(u,p.thetaunit)};if(f){if(A.isTypedArray(f)&&s==="linear"){if(d===f.length)return f;if(f.subarray)return f.subarray(0,d)}for(o=new Array(d),m=0;m<d;m++)o[m]=l(f[m])}else{var w=v+"0",_="d"+v,c=w in p?l(p[w]):0,b=p[_]?l(p[_]):(t.period||2*Math.PI)/d;for(o=new Array(d),m=0;m<d;m++)o[m]=c+m*b}return o},t.setGeometry=function(){var p=h.sector,v=p.map(S),f={clockwise:-1,counterclockwise:1}[t.direction],d=S(t.rotation),o=function(L){return f*L+d},m=function(L){return(L-d)/f},l,w,_,c;switch(s){case"linear":w=l=A.identity,c=S,_=M,t.range=A.isFullCircle(v)?[p[0],p[0]+360]:v.map(m).map(M);break;case"category":var b=t._categories.length,u=t.period?Math.max(t.period,b):b;u===0&&(u=1),w=c=function(L){return L*2*Math.PI/u},l=_=function(L){return L*u/Math.PI/2},t.range=[0,u];break}t.c2g=function(L){return o(w(L))},t.g2c=function(L){return l(m(L))},t.t2g=function(L){return o(c(L))},t.g2t=function(L){return _(m(L))}}}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(y,ee,te){ee.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(y,ee,te){function A(n){return n<0?-1:n>0?1:0}function g(n){var r=n[0],t=n[1];if(!isFinite(r)||!isFinite(t))return[1,0];var h=(r+1)*(r+1)+t*t;return[(r*r+t*t-1)/h,2*t/h]}function S(n,r){var t=r[0],h=r[1];return[t*n.radius+n.cx,-h*n.radius+n.cy]}function M(n,r){return r*n.radius}function e(n,r,t,h){var s=S(n,g([t,r])),i=s[0],x=s[1],p=S(n,g([h,r])),v=p[0],f=p[1];if(r===0)return["M"+i+","+x,"L"+v+","+f].join(" ");var d=M(n,1/Math.abs(r));return["M"+i+","+x,"A"+d+","+d+" 0 0,"+(r<0?1:0)+" "+v+","+f].join(" ")}function a(n,r,t,h){var s=M(n,1/(r+1)),i=S(n,g([r,t])),x=i[0],p=i[1],v=S(n,g([r,h])),f=v[0],d=v[1];if(A(t)!==A(h)){var o=S(n,g([r,0])),m=o[0],l=o[1];return["M"+x+","+p,"A"+s+","+s+" 0 0,"+(0<t?0:1)+" "+m+","+l,"A"+s+","+s+" 0 0,"+(h<0?0:1)+f+","+d].join(" ")}return["M"+x+","+p,"A"+s+","+s+" 0 0,"+(h<t?0:1)+" "+f+","+d].join(" ")}ee.exports={smith:g,reactanceArc:e,resistanceArc:a,smithTransform:S}},{}],638:[function(y,ee,te){var A=y("../get_data").getSubplotCalcData,g=y("../../lib").counterRegex,S=y("../polar/polar"),M=y("./constants"),e=M.attr,a=M.name,n=g(a),r={};r[e]={valType:"subplotid",dflt:a,editType:"calc"};function t(s){for(var i=s._fullLayout,x=s.calcdata,p=i._subplots[a],v=0;v<p.length;v++){var f=p[v],d=A(x,a,f),o=i[f]._subplot;o||(o=S(s,f,!0),i[f]._subplot=o),o.plot(d,i,s._promises)}}function h(s,i,x,p){for(var v=p._subplots[a]||[],f=0;f<v.length;f++){var d=v[f],o=p[d]._subplot;if(!i[d]&&o){o.framework.remove();for(var m in o.clipPaths)o.clipPaths[m].remove()}}}ee.exports={attr:e,name:a,idRoot:a,idRegex:n,attrRegex:n,attributes:r,layoutAttributes:y("./layout_attributes"),supplyLayoutDefaults:y("./layout_defaults"),plot:t,clean:h,toSVG:y("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(y,ee,te){var A=y("../../components/color/attributes"),g=y("../cartesian/layout_attributes"),S=y("../domain").attributes,M=y("../../lib").extendFlat,e=y("../../plot_api/edit_types").overrideAll,a=e({color:g.color,showline:M({},g.showline,{dflt:!0}),linecolor:g.linecolor,linewidth:g.linewidth,showgrid:M({},g.showgrid,{dflt:!0}),gridcolor:g.gridcolor,gridwidth:g.gridwidth,griddash:g.griddash},"plot","from-root"),n=e({ticklen:g.ticklen,tickwidth:M({},g.tickwidth,{dflt:2}),tickcolor:g.tickcolor,showticklabels:g.showticklabels,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,tickfont:g.tickfont,tickformat:g.tickformat,hoverformat:g.hoverformat,layer:g.layer},"plot","from-root"),r=M({visible:M({},g.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:M({},g.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},a,n),t=M({visible:M({},g.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:g.ticks,editType:"calc"},a,n);ee.exports={domain:S({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:A.background},realaxis:r,imaginaryaxis:t,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color"),S=y("../../plot_api/plot_template"),M=y("../subplot_defaults"),e=y("../get_data").getSubplotData,a=y("../cartesian/prefix_suffix_defaults"),n=y("../cartesian/tick_label_defaults"),r=y("../cartesian/line_grid_defaults"),t=y("../cartesian/set_convert"),h=y("./layout_attributes"),s=y("./constants"),i=s.axisNames,x=v(function(f){return f.slice().reverse().map(function(d){return-d}).concat([0]).concat(f)},String);function p(f,d,o,m){var l=o("bgcolor");m.bgColor=g.combine(l,m.paper_bgcolor);var w=e(m.fullData,s.name,m.id),_=m.layoutOut,c;function b(G,K){return o(c+"."+G,K)}for(var u=0;u<i.length;u++){c=i[u],A.isPlainObject(f[c])||(f[c]={});var L=f[c],T=S.newContainer(d,c);T._id=T._name=c,T._attr=m.id+"."+c,T._traceIndices=w.map(function(G){return G._expandedIndex});var k=b("visible");if(T.type="linear",t(T,_),a(L,T,b,T.type),k){var P=c==="realaxis";if(P&&b("side"),P)b("tickvals");else{var z=x(d.realaxis.tickvals||h.realaxis.tickvals.dflt);b("tickvals",z)}var I,D,R,O,F=m.font||{};k&&(I=b("color"),D=I===L.color?I:F.color,R=F.size,O=F.family),n(L,T,b,T.type,{noTicklabelstep:!0,noAng:!P,noExp:!0,font:{color:D,size:R,family:O}}),A.coerce2(f,d,h,c+".ticklen"),A.coerce2(f,d,h,c+".tickwidth"),A.coerce2(f,d,h,c+".tickcolor",d.color);var N=b("ticks");N||(delete d[c].ticklen,delete d[c].tickwidth,delete d[c].tickcolor),r(L,T,b,{dfltColor:I,bgColor:m.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:h[c]}),b("layer")}b("hoverformat"),delete T.type,T._input=L}}ee.exports=function(d,o,m){M(d,o,m,{noUirevision:!0,type:s.name,attributes:h,handleDefaults:p,font:o.font,paper_bgcolor:o.paper_bgcolor,fullData:m,layoutOut:o})};function v(f,d){var o={};return function(m){var l=d?d(m):m;if(l in o)return o[l];var w=f(m);return o[l]=w,w}}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(y,ee,te){var A=y("../lib"),g=y("../plot_api/plot_template"),S=y("./domain").defaults;ee.exports=function(e,a,n,r){var t=r.type,h=r.attributes,s=r.handleDefaults,i=r.partition||"x",x=a._subplots[t],p=x.length,v=p&&x[0].replace(/\d+$/,""),f,d;function o(_,c){return A.coerce(f,d,h,_,c)}for(var m=0;m<p;m++){var l=x[m];e[l]?f=e[l]:f=e[l]={},d=g.newContainer(a,l,v),r.noUirevision||o("uirevision",a.uirevision);var w={};w[i]=[m/p,(m+1)/p],S(d,a,o,w),r.id=l,s(f,d,o,r)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(y,ee,te){var A=y("../constants/docs");A.FORMAT_LINK,A.DATE_FORMAT_LINK;function g(S){var M=S.description?" "+S.description:"",e=S.keys||[];if(e.length>0){for(var a=[],n=0;n<e.length;n++)a[n]="`"+e[n]+"`";M=M+"Finally, the template string has access to ",e.length===1?M="variable "+a[0]:M="variables "+a.slice(0,-1).join(", ")+" and "+a.slice(-1)+"."}return M}te.hovertemplateAttrs=function(S,M){S=S||{},M=M||{},g(M);var e={valType:"string",dflt:"",editType:S.editType||"none"};return S.arrayOk!==!1&&(e.arrayOk=!0),e},te.texttemplateAttrs=function(S,M){S=S||{},M=M||{},g(M);var e={valType:"string",dflt:"",editType:S.editType||"calc"};return S.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(y,ee,te){var A=y("./ternary"),g=y("../../plots/get_data").getSubplotCalcData,S=y("../../lib").counterRegex,M="ternary";te.name=M;var e=te.attr="subplot";te.idRoot=M,te.idRegex=te.attrRegex=S(M);var a=te.attributes={};a[e]={valType:"subplotid",dflt:"ternary",editType:"calc"},te.layoutAttributes=y("./layout_attributes"),te.supplyLayoutDefaults=y("./layout_defaults"),te.plot=function(r){for(var t=r._fullLayout,h=r.calcdata,s=t._subplots[M],i=0;i<s.length;i++){var x=s[i],p=g(h,M,x),v=t[x]._subplot;v||(v=new A({id:x,graphDiv:r,container:t._ternarylayer.node()},t),t[x]._subplot=v),v.plot(p,t,r._promises)}},te.clean=function(n,r,t,h){for(var s=h._subplots[M]||[],i=0;i<s.length;i++){var x=s[i],p=h[x]._subplot;!r[x]&&p&&(p.plotContainer.remove(),p.clipDef.remove(),p.clipDefRelative.remove(),p.layers["a-title"].remove(),p.layers["b-title"].remove(),p.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(y,ee,te){var A=y("../../components/color/attributes"),g=y("../domain").attributes,S=y("../cartesian/layout_attributes"),M=y("../../plot_api/edit_types").overrideAll,e=y("../../lib/extend").extendFlat,a={title:{text:S.title.text,font:S.title.font},color:S.color,tickmode:S.tickmode,nticks:e({},S.nticks,{dflt:6,min:1}),tick0:S.tick0,dtick:S.dtick,tickvals:S.tickvals,ticktext:S.ticktext,ticks:S.ticks,ticklen:S.ticklen,tickwidth:S.tickwidth,tickcolor:S.tickcolor,ticklabelstep:S.ticklabelstep,showticklabels:S.showticklabels,showtickprefix:S.showtickprefix,tickprefix:S.tickprefix,showticksuffix:S.showticksuffix,ticksuffix:S.ticksuffix,showexponent:S.showexponent,exponentformat:S.exponentformat,minexponent:S.minexponent,separatethousands:S.separatethousands,tickfont:S.tickfont,tickangle:S.tickangle,tickformat:S.tickformat,tickformatstops:S.tickformatstops,hoverformat:S.hoverformat,showline:e({},S.showline,{dflt:!0}),linecolor:S.linecolor,linewidth:S.linewidth,showgrid:e({},S.showgrid,{dflt:!0}),gridcolor:S.gridcolor,gridwidth:S.gridwidth,griddash:S.griddash,layer:S.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:S._deprecated.title,titlefont:S._deprecated.titlefont}},n=ee.exports=M({domain:g({name:"ternary"}),bgcolor:{valType:"color",dflt:A.background},sum:{valType:"number",dflt:1,min:0},aaxis:a,baxis:a,caxis:a},"plot","from-root");n.uirevision={valType:"any",editType:"none"},n.aaxis.uirevision=n.baxis.uirevision=n.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(y,ee,te){var A=y("../../components/color"),g=y("../../plot_api/plot_template"),S=y("../../lib"),M=y("../subplot_defaults"),e=y("../cartesian/tick_label_defaults"),a=y("../cartesian/prefix_suffix_defaults"),n=y("../cartesian/tick_mark_defaults"),r=y("../cartesian/tick_value_defaults"),t=y("../cartesian/line_grid_defaults"),h=y("./layout_attributes"),s=["aaxis","baxis","caxis"];ee.exports=function(v,f,d){M(v,f,d,{type:"ternary",attributes:h,handleDefaults:i,font:f.font,paper_bgcolor:f.paper_bgcolor})};function i(p,v,f,d){var o=f("bgcolor"),m=f("sum");d.bgColor=A.combine(o,d.paper_bgcolor);for(var l,w,_,c=0;c<s.length;c++)l=s[c],w=p[l]||{},_=g.newContainer(v,l),_._name=l,x(w,_,d,v);var b=v.aaxis,u=v.baxis,L=v.caxis;b.min+u.min+L.min>=m&&(b.min=0,u.min=0,L.min=0,p.aaxis&&delete p.aaxis.min,p.baxis&&delete p.baxis.min,p.caxis&&delete p.caxis.min)}function x(p,v,f,d){var o=h[v._name];function m(T,k){return S.coerce(p,v,o,T,k)}m("uirevision",d.uirevision),v.type="linear";var l=m("color"),w=l!==o.color.dflt?l:f.font.color,_=v._name,c=_.charAt(0).toUpperCase(),b="Component "+c,u=m("title.text",b);v._hovertitle=u===b?u:c,S.coerceFont(m,"title.font",{family:f.font.family,size:S.bigFont(f.font.size),color:w}),m("min"),r(p,v,m,"linear"),a(p,v,m,"linear"),e(p,v,m,"linear"),n(p,v,m,{outerTicks:!0});var L=m("showticklabels");L&&(S.coerceFont(m,"tickfont",{family:f.font.family,size:f.font.size,color:w}),m("tickangle"),m("tickformat")),t(p,v,m,{dfltColor:l,bgColor:f.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:o}),m("hoverformat"),m("layer")}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(y,ee,te){var A=y("@plotly/d3"),g=y("tinycolor2"),S=y("../../registry"),M=y("../../lib"),e=M.strTranslate,a=M._,n=y("../../components/color"),r=y("../../components/drawing"),t=y("../cartesian/set_convert"),h=y("../../lib/extend").extendFlat,s=y("../plots"),i=y("../cartesian/axes"),x=y("../../components/dragelement"),p=y("../../components/fx"),v=y("../../components/dragelement/helpers"),f=v.freeMode,d=v.rectMode,o=y("../../components/titles"),m=y("../../components/selections").prepSelect,l=y("../../components/selections").selectOnClick,w=y("../../components/selections").clearOutline,_=y("../../components/selections").clearSelectionsCache,c=y("../cartesian/constants");function b(F,N){this.id=F.id,this.graphDiv=F.graphDiv,this.init(N),this.makeFramework(N),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}ee.exports=b;var u=b.prototype;u.init=function(F){this.container=F._ternarylayer,this.defs=F._defs,this.layoutId=F._uid,this.traceHash={},this.layers={}},u.plot=function(F,N){var G=this,K=N[G.id],W=N._size;G._hasClipOnAxisFalse=!1;for(var Y=0;Y<F.length;Y++){var re=F[Y][0].trace;if(re.cliponaxis===!1){G._hasClipOnAxisFalse=!0;break}}G.updateLayers(K),G.adjustLayout(K,W),s.generalUpdatePerTraceModule(G.graphDiv,G,F,K),G.layers.plotbg.select("path").call(n.fill,K.bgcolor)},u.makeFramework=function(F){var N=this,G=N.graphDiv,K=F[N.id],W=N.clipId="clip"+N.layoutId+N.id,Y=N.clipIdRelative="clip-relative"+N.layoutId+N.id;N.clipDef=M.ensureSingleById(F._clips,"clipPath",W,function(re){re.append("path").attr("d","M0,0Z")}),N.clipDefRelative=M.ensureSingleById(F._clips,"clipPath",Y,function(re){re.append("path").attr("d","M0,0Z")}),N.plotContainer=M.ensureSingle(N.container,"g",N.id),N.updateLayers(K),r.setClipUrl(N.layers.backplot,W,G),r.setClipUrl(N.layers.grids,W,G)},u.updateLayers=function(F){var N=this,G=N.layers,K=["draglayer","plotbg","backplot","grids"];F.aaxis.layer==="below traces"&&K.push("aaxis","aline"),F.baxis.layer==="below traces"&&K.push("baxis","bline"),F.caxis.layer==="below traces"&&K.push("caxis","cline"),K.push("frontplot"),F.aaxis.layer==="above traces"&&K.push("aaxis","aline"),F.baxis.layer==="above traces"&&K.push("baxis","bline"),F.caxis.layer==="above traces"&&K.push("caxis","cline");var W=N.plotContainer.selectAll("g.toplevel").data(K,String),Y=["agrid","bgrid","cgrid"];W.enter().append("g").attr("class",function(re){return"toplevel "+re}).each(function(re){var ue=A.select(this);G[re]=ue,re==="frontplot"?ue.append("g").classed("scatterlayer",!0):re==="backplot"?ue.append("g").classed("maplayer",!0):re==="plotbg"?ue.append("path").attr("d","M0,0Z"):re==="aline"||re==="bline"||re==="cline"?ue.append("path"):re==="grids"&&Y.forEach(function(j){G[j]=ue.append("g").classed("grid "+j,!0)})}),W.order()};var L=Math.sqrt(4/3);u.adjustLayout=function(F,N){var G=this,K=F.domain,W=(K.x[0]+K.x[1])/2,Y=(K.y[0]+K.y[1])/2,re=K.x[1]-K.x[0],ue=K.y[1]-K.y[0],j=re*N.w,q=ue*N.h,H=F.sum,U=F.aaxis.min,$=F.baxis.min,ne=F.caxis.min,X,Q,ie,se,ae,oe;j>L*q?(se=q,ie=se*L):(ie=j,se=ie/L),ae=re*ie/j,oe=ue*se/q,X=N.l+N.w*W-ie/2,Q=N.t+N.h*(1-Y)-se/2,G.x0=X,G.y0=Q,G.w=ie,G.h=se,G.sum=H,G.xaxis={type:"linear",range:[U+2*ne-H,H-U-2*$],domain:[W-ae/2,W+ae/2],_id:"x"},t(G.xaxis,G.graphDiv._fullLayout),G.xaxis.setScale(),G.xaxis.isPtWithinRange=function(ke){return ke.a>=G.aaxis.range[0]&&ke.a<=G.aaxis.range[1]&&ke.b>=G.baxis.range[1]&&ke.b<=G.baxis.range[0]&&ke.c>=G.caxis.range[1]&&ke.c<=G.caxis.range[0]},G.yaxis={type:"linear",range:[U,H-$-ne],domain:[Y-oe/2,Y+oe/2],_id:"y"},t(G.yaxis,G.graphDiv._fullLayout),G.yaxis.setScale(),G.yaxis.isPtWithinRange=function(){return!0};var be=G.yaxis.domain[0],ce=G.aaxis=h({},F.aaxis,{range:[U,H-$-ne],side:"left",tickangle:(+F.aaxis.tickangle||0)-30,domain:[be,be+oe*L],anchor:"free",position:0,_id:"y",_length:ie});t(ce,G.graphDiv._fullLayout),ce.setScale();var de=G.baxis=h({},F.baxis,{range:[H-U-ne,$],side:"bottom",domain:G.xaxis.domain,anchor:"free",position:0,_id:"x",_length:ie});t(de,G.graphDiv._fullLayout),de.setScale();var ye=G.caxis=h({},F.caxis,{range:[H-U-$,ne],side:"right",tickangle:(+F.caxis.tickangle||0)+30,domain:[be,be+oe*L],anchor:"free",position:0,_id:"y",_length:ie});t(ye,G.graphDiv._fullLayout),ye.setScale();var ge="M"+X+","+(Q+se)+"h"+ie+"l-"+ie/2+",-"+se+"Z";G.clipDef.select("path").attr("d",ge),G.layers.plotbg.select("path").attr("d",ge);var me="M0,"+se+"h"+ie+"l-"+ie/2+",-"+se+"Z";G.clipDefRelative.select("path").attr("d",me);var Ee=e(X,Q);G.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Ee),G.clipDefRelative.select("path").attr("transform",null);var Pe=e(X-de._offset,Q+se);G.layers.baxis.attr("transform",Pe),G.layers.bgrid.attr("transform",Pe);var Ue=e(X+ie/2,Q)+"rotate(30)"+e(0,-ce._offset);G.layers.aaxis.attr("transform",Ue),G.layers.agrid.attr("transform",Ue);var we=e(X+ie/2,Q)+"rotate(-30)"+e(0,-ye._offset);G.layers.caxis.attr("transform",we),G.layers.cgrid.attr("transform",we),G.drawAxes(!0),G.layers.aline.select("path").attr("d",ce.showline?"M"+X+","+(Q+se)+"l"+ie/2+",-"+se:"M0,0").call(n.stroke,ce.linecolor||"#000").style("stroke-width",(ce.linewidth||0)+"px"),G.layers.bline.select("path").attr("d",de.showline?"M"+X+","+(Q+se)+"h"+ie:"M0,0").call(n.stroke,de.linecolor||"#000").style("stroke-width",(de.linewidth||0)+"px"),G.layers.cline.select("path").attr("d",ye.showline?"M"+(X+ie/2)+","+Q+"l"+ie/2+","+se:"M0,0").call(n.stroke,ye.linecolor||"#000").style("stroke-width",(ye.linewidth||0)+"px"),G.graphDiv._context.staticPlot||G.initInteractions(),r.setClipUrl(G.layers.frontplot,G._hasClipOnAxisFalse?null:G.clipId,G.graphDiv)},u.drawAxes=function(F){var N=this,G=N.graphDiv,K=N.id.substr(7)+"title",W=N.layers,Y=N.aaxis,re=N.baxis,ue=N.caxis;if(N.drawAx(Y),N.drawAx(re),N.drawAx(ue),F){var j=Math.max(Y.showticklabels?Y.tickfont.size/2:0,(ue.showticklabels?ue.tickfont.size*.75:0)+(ue.ticks==="outside"?ue.ticklen*.87:0)),q=(re.showticklabels?re.tickfont.size:0)+(re.ticks==="outside"?re.ticklen:0)+3;W["a-title"]=o.draw(G,"a"+K,{propContainer:Y,propName:N.id+".aaxis.title",placeholder:a(G,"Click to enter Component A title"),attributes:{x:N.x0+N.w/2,y:N.y0-Y.title.font.size/3-j,"text-anchor":"middle"}}),W["b-title"]=o.draw(G,"b"+K,{propContainer:re,propName:N.id+".baxis.title",placeholder:a(G,"Click to enter Component B title"),attributes:{x:N.x0-q,y:N.y0+N.h+re.title.font.size*.83+q,"text-anchor":"middle"}}),W["c-title"]=o.draw(G,"c"+K,{propContainer:ue,propName:N.id+".caxis.title",placeholder:a(G,"Click to enter Component C title"),attributes:{x:N.x0+N.w+q,y:N.y0+N.h+ue.title.font.size*.83+q,"text-anchor":"middle"}})}},u.drawAx=function(F){var N=this,G=N.graphDiv,K=F._name,W=K.charAt(0),Y=F._id,re=N.layers[K],ue=30,j=W+"tickLayout",q=T(F);N[j]!==q&&(re.selectAll("."+Y+"tick").remove(),N[j]=q),F.setScale();var H=i.calcTicks(F),U=i.clipEnds(F,H),$=i.makeTransTickFn(F),ne=i.getTickSigns(F)[2],X=M.deg2rad(ue),Q=ne*(F.linewidth||1)/2,ie=ne*F.ticklen,se=N.w,ae=N.h,oe=W==="b"?"M0,"+Q+"l"+Math.sin(X)*ie+","+Math.cos(X)*ie:"M"+Q+",0l"+Math.cos(X)*ie+","+-Math.sin(X)*ie,be={a:"M0,0l"+ae+",-"+se/2,b:"M0,0l-"+se/2+",-"+ae,c:"M0,0l-"+ae+","+se/2}[W];i.drawTicks(G,F,{vals:F.ticks==="inside"?U:H,layer:re,path:oe,transFn:$,crisp:!1}),i.drawGrid(G,F,{vals:U,layer:N.layers[W+"grid"],path:be,transFn:$,crisp:!1}),i.drawLabels(G,F,{vals:H,layer:re,transFn:$,labelFns:i.makeLabelFns(F,0,ue)})};function T(F){return F.ticks+String(F.ticklen)+String(F.showticklabels)}var k=c.MINZOOM/2+.87,P="m-0.87,.5h"+k+"v3h-"+(k+5.2)+"l"+(k/2+2.6)+",-"+(k*.87+4.5)+"l2.6,1.5l-"+k/2+","+k*.87+"Z",z="m0.87,.5h-"+k+"v3h"+(k+5.2)+"l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-2.6,1.5l"+k/2+","+k*.87+"Z",I="m0,1l"+k/2+","+k*.87+"l2.6,-1.5l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-"+(k/2+2.6)+","+(k*.87+4.5)+"l2.6,1.5l"+k/2+",-"+k*.87+"Z",D="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",R=!0;u.clearOutline=function(){_(this.dragOptions),w(this.dragOptions.gd)},u.initInteractions=function(){var F=this,N=F.layers.plotbg.select("path").node(),G=F.graphDiv,K=G._fullLayout._zoomlayer,W,Y;this.dragOptions={element:N,gd:G,plotinfo:{id:F.id,domain:G._fullLayout[F.id].domain,xaxis:F.xaxis,yaxis:F.yaxis},subplot:F.id,prepFn:function(Pe,Ue,we){F.dragOptions.xaxes=[F.xaxis],F.dragOptions.yaxes=[F.yaxis],W=G._fullLayout._invScaleX,Y=G._fullLayout._invScaleY;var ke=F.dragOptions.dragmode=G._fullLayout.dragmode;f(ke)?F.dragOptions.minDrag=1:F.dragOptions.minDrag=void 0,ke==="zoom"?(F.dragOptions.moveFn=de,F.dragOptions.clickFn=se,F.dragOptions.doneFn=ye,ae(Pe,Ue,we)):ke==="pan"?(F.dragOptions.moveFn=me,F.dragOptions.clickFn=se,F.dragOptions.doneFn=Ee,ge(),F.clearOutline(G)):(d(ke)||f(ke))&&m(Pe,Ue,we,F.dragOptions,ke)}};var re,ue,j,q,H,U,$,ne,X,Q;function ie(Pe){var Ue={};return Ue[F.id+".aaxis.min"]=Pe.a,Ue[F.id+".baxis.min"]=Pe.b,Ue[F.id+".caxis.min"]=Pe.c,Ue}function se(Pe,Ue){var we=G._fullLayout.clickmode;O(G),Pe===2&&(G.emit("plotly_doubleclick",null),S.call("_guiRelayout",G,ie({a:0,b:0,c:0}))),we.indexOf("select")>-1&&Pe===1&&l(Ue,G,[F.xaxis],[F.yaxis],F.id,F.dragOptions),we.indexOf("event")>-1&&p.click(G,Ue,F.id)}function ae(Pe,Ue,we){var ke=N.getBoundingClientRect();re=Ue-ke.left,ue=we-ke.top,G._fullLayout._calcInverseTransform(G);var Xe=G._fullLayout._invTransform,Ve=M.apply3DTransform(Xe)(re,ue);re=Ve[0],ue=Ve[1],j={a:F.aaxis.range[0],b:F.baxis.range[1],c:F.caxis.range[1]},H=j,q=F.aaxis.range[1]-j.a,U=g(F.graphDiv._fullLayout[F.id].bgcolor).getLuminance(),$="M0,"+F.h+"L"+F.w/2+", 0L"+F.w+","+F.h+"Z",ne=!1,X=K.append("path").attr("class","zoombox").attr("transform",e(F.x0,F.y0)).style({fill:U>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",$),Q=K.append("path").attr("class","zoombox-corners").attr("transform",e(F.x0,F.y0)).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),F.clearOutline(G)}function oe(Pe,Ue){return 1-Ue/F.h}function be(Pe,Ue){return 1-(Pe+(F.h-Ue)/Math.sqrt(3))/F.w}function ce(Pe,Ue){return(Pe-(F.h-Ue)/Math.sqrt(3))/F.w}function de(Pe,Ue){var we=re+Pe*W,ke=ue+Ue*Y,Xe=Math.max(0,Math.min(1,oe(re,ue),oe(we,ke))),Ve=Math.max(0,Math.min(1,be(re,ue),be(we,ke))),Ie=Math.max(0,Math.min(1,ce(re,ue),ce(we,ke))),De=(Xe/2+Ie)*F.w,Ye=(1-Xe/2-Ve)*F.w,vt=(De+Ye)/2,Dt=Ye-De,Kt=(1-Xe)*F.h,Ft=Kt-Dt/L;Dt<c.MINZOOM?(H=j,X.attr("d",$),Q.attr("d","M0,0Z")):(H={a:j.a+Xe*q,b:j.b+Ve*q,c:j.c+Ie*q},X.attr("d",$+"M"+De+","+Kt+"H"+Ye+"L"+vt+","+Ft+"L"+De+","+Kt+"Z"),Q.attr("d","M"+re+","+ue+D+"M"+De+","+Kt+P+"M"+Ye+","+Kt+z+"M"+vt+","+Ft+I)),ne||(X.transition().style("fill",U>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),Q.transition().style("opacity",1).duration(200),ne=!0),G.emit("plotly_relayouting",ie(H))}function ye(){O(G),H!==j&&(S.call("_guiRelayout",G,ie(H)),R&&G.data&&G._context.showTips&&(M.notifier(a(G,"Double-click to zoom back out"),"long"),R=!1))}function ge(){j={a:F.aaxis.range[0],b:F.baxis.range[1],c:F.caxis.range[1]},H=j}function me(Pe,Ue){var we=Pe/F.xaxis._m,ke=Ue/F.yaxis._m;H={a:j.a-ke,b:j.b+(we+ke)/2,c:j.c-(we-ke)/2};var Xe=[H.a,H.b,H.c].sort(M.sorterAsc),Ve={a:Xe.indexOf(H.a),b:Xe.indexOf(H.b),c:Xe.indexOf(H.c)};Xe[0]<0&&(Xe[1]+Xe[0]/2<0?(Xe[2]+=Xe[0]+Xe[1],Xe[0]=Xe[1]=0):(Xe[2]+=Xe[0]/2,Xe[1]+=Xe[0]/2,Xe[0]=0),H={a:Xe[Ve.a],b:Xe[Ve.b],c:Xe[Ve.c]},Ue=(j.a-H.a)*F.yaxis._m,Pe=(j.c-H.c-j.b+H.b)*F.xaxis._m);var Ie=e(F.x0+Pe,F.y0+Ue);F.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Ie);var De=e(-Pe,-Ue);F.clipDefRelative.select("path").attr("transform",De),F.aaxis.range=[H.a,F.sum-H.b-H.c],F.baxis.range=[F.sum-H.a-H.c,H.b],F.caxis.range=[F.sum-H.a-H.b,H.c],F.drawAxes(!1),F._hasClipOnAxisFalse&&F.plotContainer.select(".scatterlayer").selectAll(".trace").call(r.hideOutsideRangePoints,F),G.emit("plotly_relayouting",ie(H))}function Ee(){S.call("_guiRelayout",G,ie(H))}N.onmousemove=function(Pe){p.hover(G,Pe,F.id),G._fullLayout._lasthover=N,G._fullLayout._hoversubplot=F.id},N.onmouseout=function(Pe){G._dragging||x.unhover(G,Pe)},x.init(this.dragOptions)};function O(F){A.select(F).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(y,ee,te){var A=y("./lib/loggers"),g=y("./lib/noop"),S=y("./lib/push_unique"),M=y("./lib/is_plain_object"),e=y("./lib/dom").addStyleRule,a=y("./lib/extend"),n=y("./plots/attributes"),r=y("./plots/layout_attributes"),t=a.extendFlat,h=a.extendDeepAll;te.modules={},te.allCategories={},te.allTypes=[],te.subplotsRegistry={},te.transformsRegistry={},te.componentsRegistry={},te.layoutArrayContainers=[],te.layoutArrayRegexes=[],te.traceLayoutAttributes={},te.localeRegistry={},te.apiMethodRegistry={},te.collectableSubplotTypes=null,te.register=function(_){if(te.collectableSubplotTypes=null,_)_&&!Array.isArray(_)&&(_=[_]);else throw new Error("No argument passed to Plotly.register.");for(var c=0;c<_.length;c++){var b=_[c];if(!b)throw new Error("Invalid module was attempted to be registered!");switch(b.moduleType){case"trace":s(b);break;case"transform":p(b);break;case"component":x(b);break;case"locale":v(b);break;case"apiMethod":var u=b.name;te.apiMethodRegistry[u]=b.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},te.getModule=function(w){var _=te.modules[l(w)];return _?_._module:!1},te.traceIs=function(w,_){if(w=l(w),w==="various")return!1;var c=te.modules[w];return c||(w&&A.log("Unrecognized trace type "+w+"."),c=te.modules[n.type.dflt]),!!c.categories[_]},te.getTransformIndices=function(w,_){for(var c=[],b=w.transforms||[],u=0;u<b.length;u++)b[u].type===_&&c.push(u);return c},te.hasTransform=function(w,_){for(var c=w.transforms||[],b=0;b<c.length;b++)if(c[b].type===_)return!0;return!1},te.getComponentMethod=function(w,_){var c=te.componentsRegistry[w];return c&&c[_]||g},te.call=function(){var w=arguments[0],_=[].slice.call(arguments,1);return te.apiMethodRegistry[w].apply(null,_)};function s(w){var _=w.name,c=w.categories,b=w.meta;if(te.modules[_]){A.log("Type "+_+" already registered");return}te.subplotsRegistry[w.basePlotModule.name]||i(w.basePlotModule);for(var u={},L=0;L<c.length;L++)u[c[L]]=!0,te.allCategories[c[L]]=!0;te.modules[_]={_module:w,categories:u},b&&Object.keys(b).length&&(te.modules[_].meta=b),te.allTypes.push(_);for(var T in te.componentsRegistry)d(T,_);w.layoutAttributes&&t(te.traceLayoutAttributes,w.layoutAttributes);var k=w.basePlotModule,P=k.name;if(P==="mapbox"){var z=k.constants.styleRules;for(var I in z)e(".js-plotly-plot .plotly .mapboxgl-"+I,z[I])}(P==="geo"||P==="mapbox")&&window.PlotlyGeoAssets===void 0&&(window.PlotlyGeoAssets={topojson:{}})}function i(w){var _=w.name;if(te.subplotsRegistry[_]){A.log("Plot type "+_+" already registered.");return}f(w),te.subplotsRegistry[_]=w;for(var c in te.componentsRegistry)m(c,w.name)}function x(w){if(typeof w.name!="string")throw new Error("Component module *name* must be a string.");var _=w.name;te.componentsRegistry[_]=w,w.layoutAttributes&&(w.layoutAttributes._isLinkedToArray&&S(te.layoutArrayContainers,_),f(w));for(var c in te.modules)d(_,c);for(var b in te.subplotsRegistry)m(_,b);for(var u in te.transformsRegistry)o(_,u);w.schema&&w.schema.layout&&h(r,w.schema.layout)}function p(w){if(typeof w.name!="string")throw new Error("Transform module *name* must be a string.");var _="Transform module "+w.name,c=typeof w.transform=="function",b=typeof w.calcTransform=="function";if(!c&&!b)throw new Error(_+" is missing a *transform* or *calcTransform* method.");c&&b&&A.log([_+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),M(w.attributes)||A.log(_+" registered without an *attributes* object."),typeof w.supplyDefaults!="function"&&A.log(_+" registered without a *supplyDefaults* method."),te.transformsRegistry[w.name]=w;for(var u in te.componentsRegistry)o(u,w.name)}function v(w){var _=w.name,c=_.split("-")[0],b=w.dictionary,u=w.format,L=b&&Object.keys(b).length,T=u&&Object.keys(u).length,k=te.localeRegistry,P=k[_];if(P||(k[_]=P={}),c!==_){var z=k[c];z||(k[c]=z={}),L&&z.dictionary===P.dictionary&&(z.dictionary=b),T&&z.format===P.format&&(z.format=u)}L&&(P.dictionary=b),T&&(P.format=u)}function f(w){if(w.layoutAttributes){var _=w.layoutAttributes._arrayAttrRegexps;if(_)for(var c=0;c<_.length;c++)S(te.layoutArrayRegexes,_[c])}}function d(w,_){var c=te.componentsRegistry[w].schema;if(!(!c||!c.traces)){var b=c.traces[_];b&&h(te.modules[_]._module.attributes,b)}}function o(w,_){var c=te.componentsRegistry[w].schema;if(!(!c||!c.transforms)){var b=c.transforms[_];b&&h(te.transformsRegistry[_].attributes,b)}}function m(w,_){var c=te.componentsRegistry[w].schema;if(!(!c||!c.subplots)){var b=te.subplotsRegistry[_],u=b.layoutAttributes,L=b.attr==="subplot"?b.name:b.attr;Array.isArray(L)&&(L=L[0]);var T=c.subplots[L];u&&T&&h(u,T)}}function l(w){return typeof w=="object"&&(w=w.type),w}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(y,ee,te){var A=y("../registry"),g=y("../lib"),S=g.extendFlat,M=g.extendDeep;function e(n){var r;switch(n){case"themes__thumb":r={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":r={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:r={}}return r}function a(n){var r=["xaxis","yaxis","zaxis"];return r.indexOf(n.slice(0,5))>-1}ee.exports=function(r,t){var h,s=r.data,i=r.layout,x=M([],s),p=M({},i,e(t.tileClass)),v=r._context||{};if(t.width&&(p.width=t.width),t.height&&(p.height=t.height),t.tileClass==="thumbnail"||t.tileClass==="themes__thumb"){p.annotations=[];var f=Object.keys(p);for(h=0;h<f.length;h++)a(f[h])&&(p[f[h]].title={text:""});for(h=0;h<x.length;h++){var d=x[h];d.showscale=!1,d.marker&&(d.marker.showscale=!1),A.traceIs(d,"pie-like")&&(d.textposition="none")}}if(Array.isArray(t.annotations))for(h=0;h<t.annotations.length;h++)p.annotations.push(t.annotations[h]);var o=Object.keys(p).filter(function(c){return c.match(/^scene\d*$/)});if(o.length){var m={};for(t.tileClass==="thumbnail"&&(m={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),h=0;h<o.length;h++){var l=p[o[h]];l.xaxis||(l.xaxis={}),l.yaxis||(l.yaxis={}),l.zaxis||(l.zaxis={}),S(l.xaxis,m),S(l.yaxis,m),S(l.zaxis,m),l._scene=null}}var w=document.createElement("div");t.tileClass&&(w.className=t.tileClass);var _={gd:w,td:w,layout:p,data:x,config:{staticPlot:t.staticPlot===void 0?!0:t.staticPlot,plotGlPixelRatio:t.plotGlPixelRatio===void 0?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:v.mapboxAccessToken}};return t.setBackground!=="transparent"&&(_.config.setBackground=t.setBackground||"opaque"),_.gd.defaultLayout=e(t.tileClass),_}},{"../lib":515,"../registry":647}],649:[function(y,ee,te){var A=y("../lib"),g=y("../plot_api/to_image"),S=y("./filesaver"),M=y("./helpers");function e(a,n){var r;return A.isPlainObject(a)||(r=A.getGraphDiv(a)),n=n||{},n.format=n.format||"png",n.width=n.width||null,n.height=n.height||null,n.imageDataOnly=!0,new Promise(function(t,h){r&&r._snapshotInProgress&&h(new Error("Snapshotting already in progress.")),A.isIE()&&n.format!=="svg"&&h(new Error(M.MSG_IE_BAD_FORMAT)),r&&(r._snapshotInProgress=!0);var s=g(a,n),i=n.filename||a.fn||"newplot";i+="."+n.format.replace("-","."),s.then(function(x){return r&&(r._snapshotInProgress=!1),S(x,i,n.format)}).then(function(x){t(x)}).catch(function(x){r&&(r._snapshotInProgress=!1),h(x)})})}ee.exports=e},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(y,ee,te){var A=y("../lib"),g=y("./helpers");function S(M,e,a){var n=document.createElement("a"),r="download"in n,t=new Promise(function(h,s){var i,x;if(A.isIE())return i=g.createBlob(M,"svg"),window.navigator.msSaveBlob(i,e),i=null,h(e);if(r)return i=g.createBlob(M,a),x=g.createObjectURL(i),n.href=x,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),g.revokeObjectURL(x),i=null,h(e);if(A.isSafari()){var p=a==="svg"?",":";base64,";return g.octetStream(p+encodeURIComponent(M)),h(e)}s(new Error("download error"))});return t}ee.exports=S},{"../lib":515,"./helpers":651}],651:[function(y,ee,te){var A=y("../registry");te.getDelay=function(M){return M._has&&(M._has("gl3d")||M._has("gl2d")||M._has("mapbox"))?500:0},te.getRedrawFunc=function(M){return function(){A.getComponentMethod("colorbar","draw")(M)}},te.encodeSVG=function(M){return"data:image/svg+xml,"+encodeURIComponent(M)},te.encodeJSON=function(M){return"data:application/json,"+encodeURIComponent(M)};var g=window.URL||window.webkitURL;te.createObjectURL=function(M){return g.createObjectURL(M)},te.revokeObjectURL=function(M){return g.revokeObjectURL(M)},te.createBlob=function(M,e){if(e==="svg")return new window.Blob([M],{type:"image/svg+xml;charset=utf-8"});if(e==="full-json")return new window.Blob([M],{type:"application/json;charset=utf-8"});var a=S(window.atob(M));return new window.Blob([a],{type:"image/"+e})},te.octetStream=function(M){document.location.href="data:application/octet-stream"+M};function S(M){for(var e=M.length,a=new ArrayBuffer(e),n=new Uint8Array(a),r=0;r<e;r++)n[r]=M.charCodeAt(r);return a}te.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,te.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(y,ee,te){var A=y("./helpers"),g={getDelay:A.getDelay,getRedrawFunc:A.getRedrawFunc,clone:y("./cloneplot"),toSVG:y("./tosvg"),svgToImg:y("./svgtoimg"),toImage:y("./toimage"),downloadImage:y("./download")};ee.exports=g},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(y,ee,te){var A=y("../lib"),g=y("events").EventEmitter,S=y("./helpers");function M(e){var a=e.emitter||new g,n=new Promise(function(r,t){var h=window.Image,s=e.svg,i=e.format||"png";if(A.isIE()&&i!=="svg"){var x=new Error(S.MSG_IE_BAD_FORMAT);return t(x),e.promise?n:a.emit("error",x)}var p=e.canvas,v=e.scale||1,f=e.width||300,d=e.height||150,o=v*f,m=v*d,l=p.getContext("2d",{willReadFrequently:!0}),w=new h,_,c;i==="svg"||A.isSafari()?c=S.encodeSVG(s):(_=S.createBlob(s,"svg"),c=S.createObjectURL(_)),p.width=o,p.height=m,w.onload=function(){var b;switch(_=null,S.revokeObjectURL(c),i!=="svg"&&l.drawImage(w,0,0,o,m),i){case"jpeg":b=p.toDataURL("image/jpeg");break;case"png":b=p.toDataURL("image/png");break;case"webp":b=p.toDataURL("image/webp");break;case"svg":b=c;break;default:var u="Image format is not jpeg, png, svg or webp.";if(t(new Error(u)),!e.promise)return a.emit("error",u)}r(b),e.promise||a.emit("success",b)},w.onerror=function(b){if(_=null,S.revokeObjectURL(c),t(b),!e.promise)return a.emit("error",b)},w.src=c});return e.promise?n:a}ee.exports=M},{"../lib":515,"./helpers":651,events:84}],654:[function(y,ee,te){var A=y("events").EventEmitter,g=y("../registry"),S=y("../lib"),M=y("./helpers"),e=y("./cloneplot"),a=y("./tosvg"),n=y("./svgtoimg");function r(t,h){var s=new A,i=e(t,{format:"png"}),x=i.gd;x.style.position="absolute",x.style.left="-5000px",document.body.appendChild(x);function p(){var f=M.getDelay(x._fullLayout);setTimeout(function(){var d=a(x),o=document.createElement("canvas");o.id=S.randstr(),s=n({format:h.format,width:x._fullLayout.width,height:x._fullLayout.height,canvas:o,emitter:s,svg:d}),s.clean=function(){x&&document.body.removeChild(x)}},f)}var v=M.getRedrawFunc(x);return g.call("_doPlot",x,i.data,i.layout,i.config).then(v).then(p).catch(function(f){s.emit("error",f)}),s}ee.exports=r},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../lib"),S=y("../components/drawing"),M=y("../components/color"),e=y("../constants/xmlns_namespaces"),a=/"/g,n="TOBESTRIPPED",r=new RegExp('("'+n+")|("+n+'")',"g");function t(s){var i=A.select("body").append("div").style({display:"none"}).html(""),x=s.replace(/(&[^;]*;)/gi,function(p){return p==="&lt;"?"&#60;":p==="&rt;"?"&#62;":p.indexOf("<")!==-1||p.indexOf(">")!==-1?"":i.html(p).text()});return i.remove(),x}function h(s){return s.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}ee.exports=function(i,x,p){var v=i._fullLayout,f=v._paper,d=v._toppaper,o=v.width,m=v.height,l;f.insert("rect",":first-child").call(S.setRect,0,0,o,m).call(M.fill,v.paper_bgcolor);var w=v._basePlotModules||[];for(l=0;l<w.length;l++){var _=w[l];_.toSVG&&_.toSVG(i)}if(d){var c=d.node().childNodes,b=Array.prototype.slice.call(c);for(l=0;l<b.length;l++){var u=b[l];u.childNodes.length&&f.node().appendChild(u)}}v._draggers&&v._draggers.remove(),f.node().style.background="",f.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var T=A.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){T.remove();return}else T.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&T.style("font-family",k.replace(a,n))}),f.selectAll(".gradient_filled,.pattern_filled").each(function(){var T=A.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&T.style("fill",k.replace(a,n));var P=this.style.stroke;P&&P.indexOf("url(")!==-1&&T.style("stroke",P.replace(a,n))}),(x==="pdf"||x==="eps")&&f.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),f.node().setAttributeNS(e.xmlns,"xmlns",e.svg),f.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),x==="svg"&&p&&(f.attr("width",p*o),f.attr("height",p*m),f.attr("viewBox","0 0 "+o+" "+m));var L=new window.XMLSerializer().serializeToString(f.node());return L=t(L),L=h(L),L=L.replace(r,"'"),g.isIE()&&(L=L.replace(/"/gi,"'"),L=L.replace(/(\('#)([^']*)('\))/gi,'("#$2")'),L=L.replace(/(\\')/gi,'"')),L}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;A.mergeArray(M.text,S,"tx"),A.mergeArray(M.hovertext,S,"htx");var a=M.marker;if(a){A.mergeArray(a.opacity,S,"mo",!0),A.mergeArray(a.color,S,"mc");var n=a.line;n&&(A.mergeArray(n.color,S,"mlc"),A.mergeArrayCastPositive(n.width,S,"mlw"))}}},{"../../lib":515}],657:[function(y,ee,te){var A=y("../scatter/attributes"),g=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../../plots/template_attributes").texttemplateAttrs,e=y("../../components/colorscale/attributes"),a=y("../../plots/font_attributes"),n=y("./constants"),r=y("../../components/drawing/attributes").pattern,t=y("../../lib/extend").extendFlat,h=a({editType:"calc",arrayOk:!0,colorEditType:"style"}),s=A.marker,i=s.line,x=t({},i.width,{dflt:0}),p=t({width:x,editType:"calc"},e("marker.line")),v=t({line:p,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:r});ee.exports={x:A.x,x0:A.x0,dx:A.dx,y:A.y,y0:A.y0,dy:A.dy,xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:A.xperiod0,yperiod0:A.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,xhoverformat:g("x"),yhoverformat:g("y"),text:A.text,texttemplate:M({editType:"plot"},{keys:n.eventDataKeys}),hovertext:A.hovertext,hovertemplate:S({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:t({},h,{}),insidetextfont:t({},h,{}),outsidetextfont:t({},h,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:t({},A.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:v,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:A.selected.marker.opacity,color:A.selected.marker.color,editType:"style"},textfont:A.selected.textfont,editType:"style"},unselected:{marker:{opacity:A.unselected.marker.opacity,color:A.unselected.marker.color,editType:"style"},textfont:A.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../plots/cartesian/align_period"),S=y("../../components/colorscale/helpers").hasColorscale,M=y("../../components/colorscale/calc"),e=y("./arrays_to_calcdata"),a=y("../scatter/calc_selection");ee.exports=function(r,t){var h=A.getFromId(r,t.xaxis||"x"),s=A.getFromId(r,t.yaxis||"y"),i,x,p,v,f,d,o={msUTC:!!(t.base||t.base===0)};t.orientation==="h"?(i=h.makeCalcdata(t,"x",o),p=s.makeCalcdata(t,"y"),v=g(t,s,"y",p),f=!!t.yperiodalignment,d="y"):(i=s.makeCalcdata(t,"y",o),p=h.makeCalcdata(t,"x"),v=g(t,h,"x",p),f=!!t.xperiodalignment,d="x"),x=v.vals;for(var m=Math.min(x.length,i.length),l=new Array(m),w=0;w<m;w++)l[w]={p:x[w],s:i[w]},f&&(l[w].orig_p=p[w],l[w][d+"End"]=v.ends[w],l[w][d+"Start"]=v.starts[w]),t.ids&&(l[w].id=String(t.ids[w]));return S(t,"marker")&&M(r,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),S(t,"marker.line")&&M(r,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(l,t),a(l,t),l}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(y,ee,te){ee.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib").isArrayOrTypedArray,S=y("../../constants/numerical").BADNUM,M=y("../../registry"),e=y("../../plots/cartesian/axes"),a=y("../../plots/cartesian/constraints").getAxisGroup,n=y("./sieve.js");function r(L,T){for(var k=T.xaxis,P=T.yaxis,z=L._fullLayout,I=L._fullData,D=L.calcdata,R=[],O=[],F=0;F<I.length;F++){var N=I[F];if(N.visible===!0&&M.traceIs(N,"bar")&&N.xaxis===k._id&&N.yaxis===P._id&&(N.orientation==="h"?R.push(D[F]):O.push(D[F]),N._computePh))for(var G=L.calcdata[F],K=0;K<G.length;K++)typeof G[K].ph0=="function"&&(G[K].ph0=G[K].ph0()),typeof G[K].ph1=="function"&&(G[K].ph1=G[K].ph1())}var W={xCat:k.type==="category"||k.type==="multicategory",yCat:P.type==="category"||P.type==="multicategory",mode:z.barmode,norm:z.barnorm,gap:z.bargap,groupgap:z.bargroupgap};t(L,k,P,O,W),t(L,P,k,R,W)}function t(L,T,k,P,z){if(P.length){var I,D,R,O,F;switch(h(k,P),z.mode){case"overlay":s(T,k,P,z);break;case"group":for(I=[],D=[],R=0;R<P.length;R++)O=P[R],F=O[0].trace,F.offset===void 0?D.push(O):I.push(O);D.length&&i(L,T,k,D,z),I.length&&s(T,k,I,z);break;case"stack":case"relative":for(I=[],D=[],R=0;R<P.length;R++)O=P[R],F=O[0].trace,F.base===void 0?D.push(O):I.push(O);D.length&&x(L,T,k,D,z),I.length&&s(T,k,I,z);break}b(P,T)}}function h(L,T){var k,P;for(k=0;k<T.length;k++){var z=T[k],I=z[0].trace,D=I.type==="funnel"?I._base:I.base,R,O=I.orientation==="h"?I.xcalendar:I.ycalendar,F=L.type==="category"||L.type==="multicategory"?function(){return null}:L.d2c;if(g(D)){for(P=0;P<Math.min(D.length,z.length);P++)R=F(D[P],0,O),A(R)?(z[P].b=+R,z[P].hasB=1):z[P].b=0;for(;P<z.length;P++)z[P].b=0}else{R=F(D,0,O);var N=A(R);for(R=N?R:0,P=0;P<z.length;P++)z[P].b=R,N&&(z[P].hasB=1)}}}function s(L,T,k,P){for(var z=0;z<k.length;z++){var I=k[z],D=new n([I],{posAxis:L,sepNegVal:!1,overlapNoMerge:!P.norm});p(L,D,P),P.norm?(w(D),c(T,D,P)):m(T,D)}}function i(L,T,k,P,z){var I=new n(P,{posAxis:T,sepNegVal:!1,overlapNoMerge:!z.norm});v(L,T,I,z),_(I,T),z.norm?(w(I),c(k,I,z)):m(k,I)}function x(L,T,k,P,z){var I=new n(P,{posAxis:T,sepNegVal:z.mode==="relative",overlapNoMerge:!(z.norm||z.mode==="stack"||z.mode==="relative")});p(T,I,z),l(k,I,z);for(var D=0;D<P.length;D++)for(var R=P[D],O=0;O<R.length;O++){var F=R[O];if(F.s!==S){var N=F.b+F.s===I.get(F.p,F.s);N&&(F._outmost=!0)}}z.norm&&c(k,I,z)}function p(L,T,k){for(var P=T.minDiff,z=T.traces,I=P*(1-k.gap),D=I,R=D*(1-(k.groupgap||0)),O=-R/2,F=0;F<z.length;F++){var N=z[F],G=N[0].t;G.barwidth=R,G.poffset=O,G.bargroupwidth=I,G.bardelta=P}T.binWidth=z[0][0].t.barwidth/100,f(T),d(L,T),o(L,T)}function v(L,T,k,P){for(var z=L._fullLayout,I=k.positions,D=k.distinctPositions,R=k.minDiff,O=k.traces,F=O.length,N=I.length!==D.length,G=R*(1-P.gap),K=a(z,T._id)+O[0][0].trace.orientation,W=z._alignmentOpts[K]||{},Y=0;Y<F;Y++){var re=O[Y],ue=re[0].trace,j=W[ue.alignmentgroup]||{},q=Object.keys(j.offsetGroups||{}).length,H;q?H=G/q:H=N?G/F:G;var U=H*(1-(P.groupgap||0)),$;q?$=((2*ue._offsetIndex+1-q)*H-U)/2:$=N?((2*Y+1-F)*H-U)/2:-U/2;var ne=re[0].t;ne.barwidth=U,ne.poffset=$,ne.bargroupwidth=G,ne.bardelta=R}k.binWidth=O[0][0].t.barwidth/100,f(k),d(T,k),o(T,k,N)}function f(L){var T=L.traces,k,P;for(k=0;k<T.length;k++){var z=T[k],I=z[0],D=I.trace,R=I.t,O=D._offset||D.offset,F=R.poffset,N;if(g(O)){for(N=Array.prototype.slice.call(O,0,z.length),P=0;P<N.length;P++)A(N[P])||(N[P]=F);for(P=N.length;P<z.length;P++)N.push(F);R.poffset=N}else O!==void 0&&(R.poffset=O);var G=D._width||D.width,K=R.barwidth;if(g(G)){var W=Array.prototype.slice.call(G,0,z.length);for(P=0;P<W.length;P++)A(W[P])||(W[P]=K);for(P=W.length;P<z.length;P++)W.push(K);if(R.barwidth=W,O===void 0){for(N=[],P=0;P<z.length;P++)N.push(F+(K-W[P])/2);R.poffset=N}}else G!==void 0&&(R.barwidth=G,O===void 0&&(R.poffset=F+(K-G)/2))}}function d(L,T){for(var k=T.traces,P=u(L),z=0;z<k.length;z++)for(var I=k[z],D=I[0].t,R=D.poffset,O=Array.isArray(R),F=D.barwidth,N=Array.isArray(F),G=0;G<I.length;G++){var K=I[G],W=K.w=N?F[G]:F;K[P]=K.p+(O?R[G]:R)+W/2}}function o(L,T,k){var P=T.traces,z=T.minDiff,I=z/2;e.minDtick(L,T.minDiff,T.distinctPositions[0],k);for(var D=0;D<P.length;D++){var R=P[D],O=R[0],F=O.trace,N=[],G,K,W,Y;for(Y=0;Y<R.length;Y++)G=R[Y],K=G.p-I,W=G.p+I,N.push(K,W);if(F.width||F.offset){var re=O.t,ue=re.poffset,j=re.barwidth,q=Array.isArray(ue),H=Array.isArray(j);for(Y=0;Y<R.length;Y++){G=R[Y];var U=q?ue[Y]:ue,$=H?j[Y]:j;K=G.p+U,W=K+$,N.push(K,W)}}F._extremes[L._id]=e.findExtremes(L,N,{padded:!1})}}function m(L,T){for(var k=T.traces,P=u(L),z=0;z<k.length;z++){for(var I=k[z],D=I[0].trace,R=[],O=!1,F=0;F<I.length;F++){var N=I[F],G=N.b,K=G+N.s;N[P]=K,R.push(K),N.hasB&&R.push(G),(!N.hasB||!N.b)&&(O=!0)}D._extremes[L._id]=e.findExtremes(L,R,{tozero:O,padded:!0})}}function l(L,T,k){var P=u(L),z=T.traces,I,D,R,O,F,N;for(O=0;O<z.length;O++)if(I=z[O],D=I[0].trace,D.type==="funnel")for(F=0;F<I.length;F++)N=I[F],N.s!==S&&T.put(N.p,-.5*N.s);for(O=0;O<z.length;O++){I=z[O],D=I[0].trace,R=D.type==="funnel";var G=[];for(F=0;F<I.length;F++)if(N=I[F],N.s!==S){var K;R?K=N.s:K=N.s+N.b;var W=T.put(N.p,K),Y=W+K;N.b=W,N[P]=Y,k.norm||(G.push(Y),N.hasB&&G.push(W))}k.norm||(D._extremes[L._id]=e.findExtremes(L,G,{tozero:!0,padded:!0}))}}function w(L){for(var T=L.traces,k=0;k<T.length;k++)for(var P=T[k],z=0;z<P.length;z++){var I=P[z];I.s!==S&&L.put(I.p,I.b+I.s)}}function _(L,T){for(var k=L.traces,P=0;P<k.length;P++){var z=k[P],I=z[0].trace;if(I.base===void 0)for(var D=new n([z],{posAxis:T,sepNegVal:!0,overlapNoMerge:!0}),R=0;R<z.length;R++){var O=z[R];if(O.p!==S){var F=D.put(O.p,O.b+O.s);F&&(O.b=F)}}}}function c(L,T,k){var P=T.traces,z=u(L),I=k.norm==="fraction"?1:100,D=I/1e9,R=L.l2c(L.c2l(0)),O=k.mode==="stack"?I:R;function F($){return A(L.c2l($))&&($<R-D||$>O+D||!A(R))}for(var N=0;N<P.length;N++){for(var G=P[N],K=G[0].trace,W=[],Y=!1,re=!1,ue=0;ue<G.length;ue++){var j=G[ue];if(j.s!==S){var q=Math.abs(I/T.get(j.p,j.s));j.b*=q,j.s*=q;var H=j.b,U=H+j.s;j[z]=U,W.push(U),re=re||F(U),j.hasB&&(W.push(H),re=re||F(H)),(!j.hasB||!j.b)&&(Y=!0)}}K._extremes[L._id]=e.findExtremes(L,W,{tozero:Y,padded:re})}}function b(L,T){var k=u(T),P={},z,I,D,R=1/0,O=-1/0;for(z=0;z<L.length;z++)for(D=L[z],I=0;I<D.length;I++){var F=D[I].p;A(F)&&(R=Math.min(R,F),O=Math.max(O,F))}var N=1e4/(O-R),G=P.round=function(q){return String(Math.round(N*(q-R)))};for(z=0;z<L.length;z++){D=L[z],D[0].t.extents=P;var K=D[0].t.poffset,W=Array.isArray(K);for(I=0;I<D.length;I++){var Y=D[I],re=Y[k]-Y.w/2;if(A(re)){var ue=Y[k]+Y.w/2,j=G(Y.p);P[j]?P[j]=[Math.min(re,P[j][0]),Math.max(ue,P[j][1])]:P[j]=[re,ue]}Y.p0=Y.p+(W?K[I]:K),Y.p1=Y.p0+Y.w,Y.s0=Y.b,Y.s1=Y.s0+Y.s}}}function u(L){return L._id.charAt(0)}ee.exports={crossTraceCalc:r,setGroupPositions:t}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color"),S=y("../../registry"),M=y("../scatter/xy_defaults"),e=y("../scatter/period_defaults"),a=y("./style_defaults"),n=y("../../plots/cartesian/constraints").getAxisGroup,r=y("./attributes"),t=A.coerceFont;function h(p,v,f,d){function o(c,b){return A.coerce(p,v,r,c,b)}var m=M(p,v,d,o);if(!m){v.visible=!1;return}e(p,v,d,o),o("xhoverformat"),o("yhoverformat"),o("orientation",v.x&&!v.y?"h":"v"),o("base"),o("offset"),o("width"),o("text"),o("hovertext"),o("hovertemplate");var l=o("textposition");x(p,v,d,o,l,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),a(p,v,o,f,d);var w=(v.marker.line||{}).color,_=S.getComponentMethod("errorbars","supplyDefaults");_(p,v,w||g.defaultLine,{axis:"y"}),_(p,v,w||g.defaultLine,{axis:"x",inherit:"y"}),A.coerceSelectionMarkerOpacity(v,o)}function s(p,v,f,d){var o=v.orientation,m=v[{v:"x",h:"y"}[o]+"axis"],l=n(f,m)+o,w=f._alignmentOpts||{},_=d("alignmentgroup"),c=w[l];c||(c=w[l]={});var b=c[_];b?b.traces.push(v):b=c[_]={traces:[v],alignmentIndex:Object.keys(c).length,offsetGroups:{}};var u=d("offsetgroup"),L=b.offsetGroups,T=L[u];u&&(T||(T=L[u]={offsetIndex:Object.keys(L).length}),v._offsetIndex=T.offsetIndex)}function i(p,v){var f,d;function o(l){return A.coerce(d._input,d,r,l)}if(v.barmode==="group")for(var m=0;m<p.length;m++)d=p[m],d.type==="bar"&&(f=d._input,s(f,d,v,o))}function x(p,v,f,d,o,m){m=m||{};var l=m.moduleHasSelected!==!1,w=m.moduleHasUnselected!==!1,_=m.moduleHasConstrain!==!1,c=m.moduleHasCliponaxis!==!1,b=m.moduleHasTextangle!==!1,u=m.moduleHasInsideanchor!==!1,L=!!m.hasPathbar,T=Array.isArray(o)||o==="auto",k=T||o==="inside",P=T||o==="outside";if(k||P){var z=t(d,"textfont",f.font),I=A.extendFlat({},z),D=p.textfont&&p.textfont.color,R=!D;if(R&&delete I.color,t(d,"insidetextfont",I),L){var O=A.extendFlat({},z);R&&delete O.color,t(d,"pathbar.textfont",O)}P&&t(d,"outsidetextfont",z),l&&d("selected.textfont.color"),w&&d("unselected.textfont.color"),_&&d("constraintext"),c&&d("cliponaxis"),b&&d("textangle"),d("texttemplate")}k&&u&&d("insidetextanchor")}ee.exports={supplyDefaults:h,crossTraceDefaults:i,handleGroupingDefaults:s,handleText:x}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(y,ee,te){ee.exports=function(g,S,M){return g.x="xVal"in S?S.xVal:S.x,g.y="yVal"in S?S.yVal:S.y,S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),M.orientation==="h"?(g.label=g.y,g.value=g.x):(g.label=g.x,g.value=g.y),g}},{}],663:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("tinycolor2"),S=y("../../lib").isArrayOrTypedArray;te.coerceString=function(M,e,a){if(typeof e=="string"){if(e||!M.noBlank)return e}else if((typeof e=="number"||e===!0)&&!M.strict)return String(e);return a!==void 0?a:M.dflt},te.coerceNumber=function(M,e,a){if(A(e)){e=+e;var n=M.min,r=M.max,t=n!==void 0&&e<n||r!==void 0&&e>r;if(!t)return e}return a!==void 0?a:M.dflt},te.coerceColor=function(M,e,a){return g(e).isValid()?e:a!==void 0?a:M.dflt},te.coerceEnumerated=function(M,e,a){return M.coerceNumber&&(e=+e),M.values.indexOf(e)!==-1?e:a!==void 0?a:M.dflt},te.getValue=function(M,e){var a;return Array.isArray(M)?e<M.length&&(a=M[e]):a=M,a},te.getLineWidth=function(M,e){var a=0<e.mlw?e.mlw:S(M.marker.line.width)?0:M.marker.line.width;return a}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(y,ee,te){var A=y("../../components/fx"),g=y("../../registry"),S=y("../../components/color"),M=y("../../lib").fillText,e=y("./helpers").getLineWidth,a=y("../../plots/cartesian/axes").hoverLabelText,n=y("../../constants/numerical").BADNUM;function r(s,i,x,p,v){var f=t(s,i,x,p,v);if(f){var d=f.cd,o=d[0].trace,m=d[f.index];return f.color=h(o,m),g.getComponentMethod("errorbars","hoverInfo")(m,o,f),[f]}}function t(s,i,x,p,v){var f=s.cd,d=f[0].trace,o=f[0].t,m=p==="closest",l=d.type==="waterfall",w=s.maxHoverDistance,_=s.maxSpikeDistance,c,b,u,L,T,k,P;d.orientation==="h"?(c=x,b=i,u="y",L="x",T=ue,k=W):(c=i,b=x,u="x",L="y",k=ue,T=W);var z=d[u+"period"],I=m||z;function D(ae){return O(ae,-1)}function R(ae){return O(ae,1)}function O(ae,oe){var be=ae.w;return ae[u]+oe*be/2}function F(ae){return ae[u+"End"]-ae[u+"Start"]}var N=m?D:z?function(ae){return ae.p-F(ae)/2}:function(ae){return Math.min(D(ae),ae.p-o.bardelta/2)},G=m?R:z?function(ae){return ae.p+F(ae)/2}:function(ae){return Math.max(R(ae),ae.p+o.bardelta/2)};function K(ae,oe,be){return v.finiteRange&&(be=0),A.inbox(ae-c,oe-c,be+Math.min(1,Math.abs(oe-ae)/P)-1)}function W(ae){return K(N(ae),G(ae),w)}function Y(ae){return K(D(ae),R(ae),_)}function re(ae){var oe=ae[L];if(l){var be=Math.abs(ae.rawS)||0;b>0?oe+=be:b<0&&(oe-=be)}return oe}function ue(ae){var oe=b,be=ae.b,ce=re(ae);return A.inbox(be-oe,ce-oe,w+(ce-oe)/(ce-be)-1)}function j(ae){var oe=b,be=ae.b,ce=re(ae);return A.inbox(be-oe,ce-oe,_+(ce-oe)/(ce-be)-1)}var q=s[u+"a"],H=s[L+"a"];P=Math.abs(q.r2c(q.range[1])-q.r2c(q.range[0]));function U(ae){return(T(ae)+k(ae))/2}var $=A.getDistanceFunction(p,T,k,U);if(A.getClosest(f,$,s),s.index!==!1&&f[s.index].p!==n){I||(N=function(ae){return Math.min(D(ae),ae.p-o.bargroupwidth/2)},G=function(ae){return Math.max(R(ae),ae.p+o.bargroupwidth/2)});var ne=s.index,X=f[ne],Q=d.base?X.b+X.s:X.s;s[L+"0"]=s[L+"1"]=H.c2p(X[L],!0),s[L+"LabelVal"]=Q;var ie=o.extents[o.extents.round(X.p)];s[u+"0"]=q.c2p(m?N(X):ie[0],!0),s[u+"1"]=q.c2p(m?G(X):ie[1],!0);var se=X.orig_p!==void 0;return s[u+"LabelVal"]=se?X.orig_p:X.p,s.labelLabel=a(q,s[u+"LabelVal"],d[u+"hoverformat"]),s.valueLabel=a(H,s[L+"LabelVal"],d[L+"hoverformat"]),s.baseLabel=a(H,X.b,d[L+"hoverformat"]),s.spikeDistance=(j(X)+Y(X))/2,s[u+"Spike"]=q.c2p(X.p,!0),M(X,d,s),s.hovertemplate=d.hovertemplate,s}}function h(s,i){var x=i.mcc||s.marker.color,p=i.mlcc||s.marker.line.color,v=e(s,i);if(S.opacity(x))return x;if(S.opacity(p)&&v)return p}ee.exports={hoverPoints:r,hoverOnBars:t,getTraceColor:h}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(y,ee,te){ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults").supplyDefaults,crossTraceDefaults:y("./defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc").crossTraceCalc,colorbar:y("../scatter/marker_colorbar"),arraysToCalcdata:y("./arrays_to_calcdata"),plot:y("./plot").plot,style:y("./style").style,styleOnSelect:y("./style").styleOnSelect,hoverPoints:y("./hover").hoverPoints,eventData:y("./event_data"),selectPoints:y("./select"),moduleType:"trace",name:"bar",basePlotModule:y("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(y,ee,te){ee.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(y,ee,te){var A=y("../../registry"),g=y("../../plots/cartesian/axes"),S=y("../../lib"),M=y("./layout_attributes");ee.exports=function(e,a,n){function r(o,m){return S.coerce(e,a,M,o,m)}for(var t=!1,h=!1,s=!1,i={},x=r("barmode"),p=0;p<n.length;p++){var v=n[p];if(A.traceIs(v,"bar")&&v.visible)t=!0;else continue;if(x==="group"){var f=v.xaxis+v.yaxis;i[f]&&(s=!0),i[f]=!0}if(v.visible&&v.type==="histogram"){var d=g.getFromId({_fullLayout:a},v[v.orientation==="v"?"xaxis":"yaxis"]);d.type!=="category"&&(h=!0)}}if(!t){delete a.barmode;return}x!=="overlay"&&r("barnorm"),r("bargap",h&&!s?0:.2),r("bargroupgap")}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("../../lib"),M=y("../../lib/svg_text_utils"),e=y("../../components/color"),a=y("../../components/drawing"),n=y("../../registry"),r=y("../../plots/cartesian/axes").tickText,t=y("./uniform_text"),h=t.recordMinTextSize,s=t.clearMinTextSize,i=y("./style"),x=y("./helpers"),p=y("./constants"),v=y("./attributes"),f=v.text,d=v.textposition,o=y("../../components/fx/helpers").appendArrayPointValue,m=p.TEXTPAD;function l(N){return N.id}function w(N){if(N.ids)return l}function _(N,G){return N<G?1:-1}function c(N,G,K,W){var Y=[],re=[],ue=W?G:K,j=W?K:G;return Y[0]=ue.c2p(N.s0,!0),re[0]=j.c2p(N.p0,!0),Y[1]=ue.c2p(N.s1,!0),re[1]=j.c2p(N.p1,!0),W?[Y,re]:[re,Y]}function b(N,G,K,W){if(!G.uniformtext.mode&&u(K)){var Y;return W&&(Y=W()),N.transition().duration(K.duration).ease(K.easing).each("end",function(){Y&&Y()}).each("interrupt",function(){Y&&Y()})}else return N}function u(N){return N&&N.duration>0}function L(N,G,K,W,Y,re){var ue=G.xaxis,j=G.yaxis,q=N._fullLayout;Y||(Y={mode:q.barmode,norm:q.barmode,gap:q.bargap,groupgap:q.bargroupgap},s("bar",q));var H=S.makeTraceGroups(W,K,"trace bars").each(function(U){var $=A.select(this),ne=U[0].trace,X=ne.type==="waterfall",Q=ne.type==="funnel",ie=ne.type==="bar",se=ie||Q,ae=0;X&&ne.connector.visible&&ne.connector.mode==="between"&&(ae=ne.connector.line.width/2);var oe=ne.orientation==="h",be=u(Y),ce=S.ensureSingle($,"g","points"),de=w(ne),ye=ce.selectAll("g.point").data(S.identity,de);ye.enter().append("g").classed("point",!0),ye.exit().remove(),ye.each(function(me,Ee){var Pe=A.select(this),Ue=c(me,ue,j,oe),we=Ue[0][0],ke=Ue[0][1],Xe=Ue[1][0],Ve=Ue[1][1],Ie=(oe?ke-we:Ve-Xe)===0;Ie&&se&&x.getLineWidth(ne,me)&&(Ie=!1),Ie||(Ie=!g(we)||!g(ke)||!g(Xe)||!g(Ve)),me.isBlank=Ie,Ie&&(oe?ke=we:Ve=Xe),ae&&!Ie&&(oe?(we-=_(we,ke)*ae,ke+=_(we,ke)*ae):(Xe-=_(Xe,Ve)*ae,Ve+=_(Xe,Ve)*ae));var De,Ye;if(ne.type==="waterfall"){if(!Ie){var vt=ne[me.dir].marker;De=vt.line.width,Ye=vt.color}}else De=x.getLineWidth(ne,me),Ye=me.mc||ne.marker.color;function Dt(At){var Ge=A.round(De/2%1,2);return Y.gap===0&&Y.groupgap===0?A.round(Math.round(At)-Ge,2):At}function Kt(At,Ge,tt){return tt&&At===Ge?At:Math.abs(At-Ge)>=2?Dt(At):At>Ge?Math.ceil(At):Math.floor(At)}if(!N._context.staticPlot){var Ft=e.opacity(Ye),Mt=Ft<1||De>.01?Dt:Kt;we=Mt(we,ke,oe),ke=Mt(ke,we,oe),Xe=Mt(Xe,Ve,!oe),Ve=Mt(Ve,Xe,!oe)}var Xt=b(S.ensureSingle(Pe,"path"),q,Y,re);if(Xt.style("vector-effect","non-scaling-stroke").attr("d",isNaN((ke-we)*(Ve-Xe))||Ie&&N._context.staticPlot?"M0,0Z":"M"+we+","+Xe+"V"+Ve+"H"+ke+"V"+Xe+"Z").call(a.setClipUrl,G.layerClipId,N),!q.uniformtext.mode&&be){var It=a.makePointStyleFns(ne);a.singlePointStyle(me,Xt,ne,It,N)}T(N,G,Pe,U,Ee,we,ke,Xe,Ve,Y,re),G.layerClipId&&a.hideOutsideRangePoint(me,Pe.select("text"),ue,j,ne.xcalendar,ne.ycalendar)});var ge=ne.cliponaxis===!1;a.setClipUrl($,ge?null:G.layerClipId,N)});n.getComponentMethod("errorbars","plot")(N,H,G,Y)}function T(N,G,K,W,Y,re,ue,j,q,H,U){var $=G.xaxis,ne=G.yaxis,X=N._fullLayout,Q;function ie(Ge,tt,He){var Ae=S.ensureSingle(Ge,"text").text(tt).attr({class:"bartext bartext-"+Q,"text-anchor":"middle","data-notex":1}).call(a.font,He).call(M.convertToTspans,N);return Ae}var se=W[0].trace,ae=se.orientation==="h",oe=D(X,W,Y,$,ne);Q=R(se,Y);var be=H.mode==="stack"||H.mode==="relative",ce=W[Y],de=!be||ce._outmost;if(!oe||Q==="none"||(ce.isBlank||re===ue||j===q)&&(Q==="auto"||Q==="inside")){K.select("text").remove();return}var ye=X.font,ge=i.getBarColor(W[Y],se),me=i.getInsideTextFont(se,Y,ye,ge),Ee=i.getOutsideTextFont(se,Y,ye),Pe=K.datum();ae?$.type==="log"&&Pe.s0<=0&&($.range[0]<$.range[1]?re=0:re=$._length):ne.type==="log"&&Pe.s0<=0&&(ne.range[0]<ne.range[1]?j=ne._length:j=0);var Ue=Math.abs(ue-re)-2*m,we=Math.abs(q-j)-2*m,ke,Xe,Ve,Ie,De;if(Q==="outside"&&!de&&!ce.hasB&&(Q="inside"),Q==="auto")if(de){Q="inside",De=S.ensureUniformFontSize(N,me),ke=ie(K,oe,De),Xe=a.bBox(ke.node()),Ve=Xe.width,Ie=Xe.height;var Ye=Ve>0&&Ie>0,vt=Ve<=Ue&&Ie<=we,Dt=Ve<=we&&Ie<=Ue,Kt=ae?Ue>=Ve*(we/Ie):we>=Ie*(Ue/Ve);Ye&&(vt||Dt||Kt)?Q="inside":(Q="outside",ke.remove(),ke=null)}else Q="inside";if(!ke){De=S.ensureUniformFontSize(N,Q==="outside"?Ee:me),ke=ie(K,oe,De);var Ft=ke.attr("transform");if(ke.attr("transform",""),Xe=a.bBox(ke.node()),Ve=Xe.width,Ie=Xe.height,ke.attr("transform",Ft),Ve<=0||Ie<=0){ke.remove();return}}var Mt=se.textangle,Xt,It;Q==="outside"?(It=se.constraintext==="both"||se.constraintext==="outside",Xt=I(re,ue,j,q,Xe,{isHorizontal:ae,constrained:It,angle:Mt})):(It=se.constraintext==="both"||se.constraintext==="inside",Xt=z(re,ue,j,q,Xe,{isHorizontal:ae,constrained:It,angle:Mt,anchor:se.insidetextanchor})),Xt.fontSize=De.size,h(se.type==="histogram"?"bar":se.type,Xt,X),ce.transform=Xt;var At=b(ke,X,H,U);S.setTransormAndDisplay(At,Xt)}function k(N){return N==="auto"?0:N}function P(N,G){var K=Math.PI/180*G,W=Math.abs(Math.sin(K)),Y=Math.abs(Math.cos(K));return{x:N.width*Y+N.height*W,y:N.width*W+N.height*Y}}function z(N,G,K,W,Y,re){var ue=!!re.isHorizontal,j=!!re.constrained,q=re.angle||0,H=re.anchor||"end",U=H==="end",$=H==="start",ne=re.leftToRight||0,X=(ne+1)/2,Q=1-X,ie=Y.width,se=Y.height,ae=Math.abs(G-N),oe=Math.abs(W-K),be=ae>2*m&&oe>2*m?m:0;ae-=2*be,oe-=2*be;var ce=k(q);q==="auto"&&!(ie<=ae&&se<=oe)&&(ie>ae||se>oe)&&(!(ie>oe||se>ae)||ie<se!=ae<oe)&&(ce+=90);var de=P(Y,ce),ye=1;j&&(ye=Math.min(1,ae/de.x,oe/de.y));var ge=Y.left*Q+Y.right*X,me=(Y.top+Y.bottom)/2,Ee=(N+m)*Q+(G-m)*X,Pe=(K+W)/2,Ue=0,we=0;if($||U){var ke=(ue?de.x:de.y)/2,Xe=ue?_(N,G):_(K,W);ue?$?(Ee=N+Xe*be,Ue=-Xe*ke):(Ee=G-Xe*be,Ue=Xe*ke):$?(Pe=K+Xe*be,we=-Xe*ke):(Pe=W-Xe*be,we=Xe*ke)}return{textX:ge,textY:me,targetX:Ee,targetY:Pe,anchorX:Ue,anchorY:we,scale:ye,rotate:ce}}function I(N,G,K,W,Y,re){var ue=!!re.isHorizontal,j=!!re.constrained,q=re.angle||0,H=Y.width,U=Y.height,$=Math.abs(G-N),ne=Math.abs(W-K),X;ue?X=ne>2*m?m:0:X=$>2*m?m:0;var Q=1;j&&(Q=ue?Math.min(1,ne/U):Math.min(1,$/H));var ie=k(q),se=P(Y,ie),ae=(ue?se.x:se.y)/2,oe=(Y.left+Y.right)/2,be=(Y.top+Y.bottom)/2,ce=(N+G)/2,de=(K+W)/2,ye=0,ge=0,me=ue?_(G,N):_(K,W);return ue?(ce=G-me*X,ye=me*ae):(de=W+me*X,ge=-me*ae),{textX:oe,textY:be,targetX:ce,targetY:de,anchorX:ye,anchorY:ge,scale:Q,rotate:ie}}function D(N,G,K,W,Y){var re=G[0].trace,ue=re.texttemplate,j;return ue?j=O(N,G,K,W,Y):re.textinfo?j=F(G,K,W,Y):j=x.getValue(re.text,K),x.coerceString(f,j)}function R(N,G){var K=x.getValue(N.textposition,G);return x.coerceEnumerated(d,K)}function O(N,G,K,W,Y){var re=G[0].trace,ue=S.castOption(re,K,"texttemplate");if(!ue)return"";var j=re.type==="histogram",q=re.type==="waterfall",H=re.type==="funnel",U=re.orientation==="h",$,ne,X,Q;U?($="y",ne=Y,X="x",Q=W):($="x",ne=W,X="y",Q=Y);function ie(ye){return r(ne,ne.c2l(ye),!0).text}function se(ye){return r(Q,Q.c2l(ye),!0).text}var ae=G[K],oe={};oe.label=ae.p,oe.labelLabel=oe[$+"Label"]=ie(ae.p);var be=S.castOption(re,ae.i,"text");(be===0||be)&&(oe.text=be),oe.value=ae.s,oe.valueLabel=oe[X+"Label"]=se(ae.s);var ce={};o(ce,re,ae.i),(j||ce.x===void 0)&&(ce.x=U?oe.value:oe.label),(j||ce.y===void 0)&&(ce.y=U?oe.label:oe.value),(j||ce.xLabel===void 0)&&(ce.xLabel=U?oe.valueLabel:oe.labelLabel),(j||ce.yLabel===void 0)&&(ce.yLabel=U?oe.labelLabel:oe.valueLabel),q&&(oe.delta=+ae.rawS||ae.s,oe.deltaLabel=se(oe.delta),oe.final=ae.v,oe.finalLabel=se(oe.final),oe.initial=oe.final-oe.delta,oe.initialLabel=se(oe.initial)),H&&(oe.value=ae.s,oe.valueLabel=se(oe.value),oe.percentInitial=ae.begR,oe.percentInitialLabel=S.formatPercent(ae.begR),oe.percentPrevious=ae.difR,oe.percentPreviousLabel=S.formatPercent(ae.difR),oe.percentTotal=ae.sumR,oe.percenTotalLabel=S.formatPercent(ae.sumR));var de=S.castOption(re,ae.i,"customdata");return de&&(oe.customdata=de),S.texttemplateString(ue,oe,N._d3locale,ce,oe,re._meta||{})}function F(N,G,K,W){var Y=N[0].trace,re=Y.orientation==="h",ue=Y.type==="waterfall",j=Y.type==="funnel";function q(de){var ye=re?W:K;return r(ye,de,!0).text}function H(de){var ye=re?K:W;return r(ye,+de,!0).text}var U=Y.textinfo,$=N[G],ne=U.split("+"),X=[],Q,ie=function(de){return ne.indexOf(de)!==-1};if(ie("label")&&X.push(q(N[G].p)),ie("text")&&(Q=S.castOption(Y,$.i,"text"),(Q===0||Q)&&X.push(Q)),ue){var se=+$.rawS||$.s,ae=$.v,oe=ae-se;ie("initial")&&X.push(H(oe)),ie("delta")&&X.push(H(se)),ie("final")&&X.push(H(ae))}if(j){ie("value")&&X.push(H($.s));var be=0;ie("percent initial")&&be++,ie("percent previous")&&be++,ie("percent total")&&be++;var ce=be>1;ie("percent initial")&&(Q=S.formatPercent($.begR),ce&&(Q+=" of initial"),X.push(Q)),ie("percent previous")&&(Q=S.formatPercent($.difR),ce&&(Q+=" of previous"),X.push(Q)),ie("percent total")&&(Q=S.formatPercent($.sumR),ce&&(Q+=" of total"),X.push(Q))}return X.join("<br>")}ee.exports={plot:L,toMoveInsideBar:z}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(y,ee,te){ee.exports=function(S,M){var e=S.cd,a=S.xaxis,n=S.yaxis,r=e[0].trace,t=r.type==="funnel",h=r.orientation==="h",s=[],i;if(M===!1)for(i=0;i<e.length;i++)e[i].selected=0;else for(i=0;i<e.length;i++){var x=e[i],p="ct"in x?x.ct:A(x,a,n,h,t);M.contains(p,!1,i,S)?(s.push({pointNumber:i,x:a.c2d(x.x),y:n.c2d(x.y)}),x.selected=1):x.selected=0}return s};function A(g,S,M,e,a){var n=S.c2p(e?g.s0:g.p0,!0),r=S.c2p(e?g.s1:g.p1,!0),t=M.c2p(e?g.p0:g.s0,!0),h=M.c2p(e?g.p1:g.s1,!0);return a?[(n+r)/2,(t+h)/2]:e?[r,(t+h)/2]:[(n+r)/2,h]}},{}],670:[function(y,ee,te){ee.exports=S;var A=y("../../lib").distinctVals,g=y("../../constants/numerical").BADNUM;function S(M,e){this.traces=M,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var a=1/0,n=[],r=0;r<M.length;r++){for(var t=M[r],h=0;h<t.length;h++){var s=t[h];s.p!==g&&n.push(s.p)}t[0]&&t[0].width1&&(a=Math.min(t[0].width1,a))}this.positions=n;var i=A(n);this.distinctPositions=i.vals,i.vals.length===1&&a!==1/0?this.minDiff=a:this.minDiff=Math.min(i.minDiff,a);var x=(e.posAxis||{}).type;(x==="category"||x==="multicategory")&&(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}S.prototype.put=function(e,a){var n=this.getLabel(e,a),r=this.bins[n]||0;return this.bins[n]=r+a,r},S.prototype.get=function(e,a){var n=this.getLabel(e,a);return this.bins[n]||0},S.prototype.getLabel=function(e,a){var n=a<0&&this.sepNegVal?"v":"^",r=this.overlapNoMerge?e:Math.round(e/this.binWidth);return n+r}},{"../../constants/numerical":491,"../../lib":515}],671:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/color"),S=y("../../components/drawing"),M=y("../../lib"),e=y("../../registry"),a=y("./uniform_text").resizeText,n=y("./attributes"),r=n.textfont,t=n.insidetextfont,h=n.outsidetextfont,s=y("./helpers");function i(b){var u=A.select(b).selectAll("g.barlayer").selectAll("g.trace");a(b,u,"bar");var L=u.size(),T=b._fullLayout;u.style("opacity",function(k){return k[0].trace.opacity}).each(function(k){(T.barmode==="stack"&&L>1||T.bargap===0&&T.bargroupgap===0&&!k[0].trace.marker.line.width)&&A.select(this).attr("shape-rendering","crispEdges")}),u.selectAll("g.points").each(function(k){var P=A.select(this),z=k[0].trace;x(P,z,b)}),e.getComponentMethod("errorbars","style")(u)}function x(b,u,L){S.pointStyle(b.selectAll("path"),u,L),p(b,u,L)}function p(b,u,L){b.selectAll("text").each(function(T){var k=A.select(this),P=M.ensureUniformFontSize(L,o(k,T,u,L));S.font(k,P)})}function v(b,u,L){var T=u[0].trace;T.selectedpoints?f(L,T,b):(x(L,T,b),e.getComponentMethod("errorbars","style")(L))}function f(b,u,L){S.selectedPointStyle(b.selectAll("path"),u),d(b.selectAll("text"),u,L)}function d(b,u,L){b.each(function(T){var k=A.select(this),P;if(T.selected){P=M.ensureUniformFontSize(L,o(k,T,u,L));var z=u.selected.textfont&&u.selected.textfont.color;z&&(P.color=z),S.font(k,P)}else S.selectedTextStyle(k,u)})}function o(b,u,L,T){var k=T._fullLayout.font,P=L.textfont;if(b.classed("bartext-inside")){var z=c(u,L);P=l(L,u.i,k,z)}else b.classed("bartext-outside")&&(P=w(L,u.i,k));return P}function m(b,u,L){return _(r,b.textfont,u,L)}function l(b,u,L,T){var k=m(b,u,L),P=b._input.textfont===void 0||b._input.textfont.color===void 0||Array.isArray(b.textfont.color)&&b.textfont.color[u]===void 0;return P&&(k={color:g.contrast(T),family:k.family,size:k.size}),_(t,b.insidetextfont,u,k)}function w(b,u,L){var T=m(b,u,L);return _(h,b.outsidetextfont,u,T)}function _(b,u,L,T){u=u||{};var k=s.getValue(u.family,L),P=s.getValue(u.size,L),z=s.getValue(u.color,L);return{family:s.coerceString(b.family,k,T.family),size:s.coerceNumber(b.size,P,T.size),color:s.coerceColor(b.color,z,T.color)}}function c(b,u){return u.type==="waterfall"?u[b.dir].marker.color:b.mcc||b.mc||u.marker.color}ee.exports={style:i,styleTextPoints:p,styleOnSelect:v,getInsideTextFont:l,getOutsideTextFont:w,getBarColor:c,resizeText:a}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(y,ee,te){var A=y("../../components/color"),g=y("../../components/colorscale/helpers").hasColorscale,S=y("../../components/colorscale/defaults"),M=y("../../lib").coercePattern;ee.exports=function(a,n,r,t,h){var s=r("marker.color",t),i=g(a,"marker");i&&S(a,n,h,r,{prefix:"marker.",cLetter:"c"}),r("marker.line.color",A.defaultLine),g(a,"marker.line")&&S(a,n,h,r,{prefix:"marker.line.",cLetter:"c"}),r("marker.line.width"),r("marker.opacity"),M(r,"marker.pattern",s,i),r("selected.marker.color"),r("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib");function S(n,r,t){var h=n._fullLayout,s=h["_"+t+"Text_minsize"];if(s){var i=h.uniformtext.mode==="hide",x;switch(t){case"funnelarea":case"pie":case"sunburst":x="g.slice";break;case"treemap":case"icicle":x="g.slice, g.pathbar";break;default:x="g.points > g.point"}r.selectAll(x).each(function(p){var v=p.transform;if(v){v.scale=i&&v.hide?0:s/v.fontSize;var f=A.select(this).select("text");g.setTransormAndDisplay(f,v)}})}}function M(n,r,t){if(t.uniformtext.mode){var h=a(n),s=t.uniformtext.minsize,i=r.scale*r.fontSize;r.hide=i<s,t[h]=t[h]||1/0,r.hide||(t[h]=Math.min(t[h],Math.max(i,s)))}}function e(n,r){var t=a(n);r[t]=void 0}function a(n){return"_"+n+"Text_minsize"}ee.exports={recordMinTextSize:M,clearMinTextSize:e,resizeText:S}},{"../../lib":515,"@plotly/d3":58}],674:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../../lib/extend").extendFlat,S=y("../scatterpolar/attributes"),M=y("../bar/attributes");ee.exports={r:S.r,theta:S.theta,r0:S.r0,dr:S.dr,theta0:S.theta0,dtheta:S.dtheta,thetaunit:S.thetaunit,base:g({},M.base,{}),offset:g({},M.offset,{}),width:g({},M.width,{}),text:g({},M.text,{}),hovertext:g({},M.hovertext,{}),marker:M.marker,hoverinfo:S.hoverinfo,hovertemplate:A(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(y,ee,te){var A=y("../../components/colorscale/helpers").hasColorscale,g=y("../../components/colorscale/calc"),S=y("../bar/arrays_to_calcdata"),M=y("../bar/cross_trace_calc").setGroupPositions,e=y("../scatter/calc_selection"),a=y("../../registry").traceIs,n=y("../../lib").extendFlat;function r(h,s){for(var i=h._fullLayout,x=s.subplot,p=i[x].radialaxis,v=i[x].angularaxis,f=p.makeCalcdata(s,"r"),d=v.makeCalcdata(s,"theta"),o=s._length,m=new Array(o),l=f,w=d,_=0;_<o;_++)m[_]={p:w[_],s:l[_]};function c(b){var u=s[b];u!==void 0&&(s["_"+b]=Array.isArray(u)?v.makeCalcdata(s,b):v.d2c(u,s.thetaunit))}return v.type==="linear"&&(c("width"),c("offset")),A(s,"marker")&&g(h,s,{vals:s.marker.color,containerStr:"marker",cLetter:"c"}),A(s,"marker.line")&&g(h,s,{vals:s.marker.line.color,containerStr:"marker.line",cLetter:"c"}),S(m,s),e(m,s),m}function t(h,s,i){for(var x=h.calcdata,p=[],v=0;v<x.length;v++){var f=x[v],d=f[0].trace;d.visible===!0&&a(d,"bar")&&d.subplot===i&&p.push(f)}var o=n({},s.radialaxis,{_id:"x"}),m=s.angularaxis;M(h,m,o,p,{mode:s.barmode,norm:s.barnorm,gap:s.bargap,groupgap:s.bargroupgap})}ee.exports={calc:r,crossTraceCalc:t}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(y,ee,te){var A=y("../../lib"),g=y("../scatterpolar/defaults").handleRThetaDefaults,S=y("../bar/style_defaults"),M=y("./attributes");ee.exports=function(a,n,r,t){function h(i,x){return A.coerce(a,n,M,i,x)}var s=g(a,n,t,h);if(!s){n.visible=!1;return}h("thetaunit"),h("base"),h("offset"),h("width"),h("text"),h("hovertext"),h("hovertemplate"),S(a,n,h,r,t),A.coerceSelectionMarkerOpacity(n,h)}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(y,ee,te){var A=y("../../components/fx"),g=y("../../lib"),S=y("../bar/hover").getTraceColor,M=g.fillText,e=y("../scatterpolar/hover").makeHoverPointText,a=y("../../plots/polar/helpers").isPtInsidePolygon;ee.exports=function(r,t,h){var s=r.cd,i=s[0].trace,x=r.subplot,p=x.radialAxis,v=x.angularAxis,f=x.vangles,d=f?a:g.isPtInsideSector,o=r.maxHoverDistance,m=v._period||2*Math.PI,l=Math.abs(p.g2p(Math.sqrt(t*t+h*h))),w=Math.atan2(h,t);p.range[0]>p.range[1]&&(w+=Math.PI);var _=function(L){return d(l,w,[L.rp0,L.rp1],[L.thetag0,L.thetag1],f)?o+Math.min(1,Math.abs(L.thetag1-L.thetag0)/m)-1+(L.rp1-l)/(L.rp1-L.rp0)-1:1/0};if(A.getClosest(s,_,r),r.index!==!1){var c=r.index,b=s[c];r.x0=r.x1=b.ct[0],r.y0=r.y1=b.ct[1];var u=g.extendFlat({},b,{r:b.s,theta:b.p});return M(b,i,r),e(u,i,x,r),r.hovertemplate=i.hovertemplate,r.color=S(i,b),r.xLabelVal=r.yLabelVal=void 0,b.s<0&&(r.idealAlign="left"),[r]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(y,ee,te){ee.exports={moduleType:"trace",name:"barpolar",basePlotModule:y("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("../scatterpolar/format_labels"),style:y("../bar/style").style,styleOnSelect:y("../bar/style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(y,ee,te){ee.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(S,M,e){var a={},n;function r(s,i){return A.coerce(S[n]||{},M[n],g,s,i)}for(var t=0;t<e.length;t++){var h=e[t];h.type==="barpolar"&&h.visible===!0&&(n=h.subplot,a[n]||(r("barmode"),r("bargap"),a[n]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(y,ee,te){var A=y("@plotly/d3"),g=y("fast-isnumeric"),S=y("../../lib"),M=y("../../components/drawing"),e=y("../../plots/polar/helpers");ee.exports=function(r,t,h){var s=t.xaxis,i=t.yaxis,x=t.radialAxis,p=t.angularAxis,v=a(t),f=t.layers.frontplot.select("g.barlayer");S.makeTraceGroups(f,h,"trace bars").each(function(){var d=A.select(this),o=S.ensureSingle(d,"g","points"),m=o.selectAll("g.point").data(S.identity);m.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),m.exit().remove(),m.each(function(l){var w=A.select(this),_=l.rp0=x.c2p(l.s0),c=l.rp1=x.c2p(l.s1),b=l.thetag0=p.c2g(l.p0),u=l.thetag1=p.c2g(l.p1),L;if(!g(_)||!g(c)||!g(b)||!g(u)||_===c||b===u)L="M0,0Z";else{var T=x.c2g(l.s1),k=(b+u)/2;l.ct=[s.c2p(T*Math.cos(k)),i.c2p(T*Math.sin(k))],L=v(_,c,b,u)}S.ensureSingle(w,"path").attr("d",L)}),M.setClipUrl(d,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,r)})};function a(n){var r=n.cxx,t=n.cyy;return n.vangles?function(h,s,i,x){var p,v;S.angleDelta(i,x)>0?(p=i,v=x):(p=x,v=i);var f=e.findEnclosingVertexAngles(p,n.vangles)[0],d=e.findEnclosingVertexAngles(v,n.vangles)[1],o=[f,(p+v)/2,d];return e.pathPolygonAnnulus(h,s,p,v,o,r,t)}:function(h,s,i,x){return S.pathAnnulus(h,s,i,x,r,t)}}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(y,ee,te){var A=y("../scatter/attributes"),g=y("../bar/attributes"),S=y("../../components/color/attributes"),M=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../plots/template_attributes").hovertemplateAttrs,a=y("../../lib/extend").extendFlat,n=A.marker,r=n.line;ee.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:A.xperiod0,yperiod0:A.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:a({},n.symbol,{arrayOk:!1,editType:"plot"}),opacity:a({},n.opacity,{arrayOk:!1,dflt:1,editType:"style"}),angle:a({},n.angle,{arrayOk:!1,editType:"calc"}),size:a({},n.size,{arrayOk:!1,editType:"calc"}),color:a({},n.color,{arrayOk:!1,editType:"style"}),line:{color:a({},r.color,{arrayOk:!1,dflt:S.defaultLine,editType:"style"}),width:a({},r.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:A.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:{marker:A.selected.marker,editType:"style"},unselected:{marker:A.unselected.marker,editType:"style"},text:a({},A.text,{}),hovertext:a({},A.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../plots/cartesian/axes"),S=y("../../plots/cartesian/align_period"),M=y("../../lib"),e=y("../../constants/numerical").BADNUM,a=M._;ee.exports=function(w,_){var c=w._fullLayout,b=g.getFromId(w,_.xaxis||"x"),u=g.getFromId(w,_.yaxis||"y"),L=[],T=_.type==="violin"?"_numViolins":"_numBoxes",k,P,z,I,D,R,O;_.orientation==="h"?(z=b,I="x",D=u,R="y",O=!!_.yperiodalignment):(z=u,I="y",D=b,R="x",O=!!_.xperiodalignment);var F=n(_,R,D,c[T]),N=F[0],G=F[1],K=M.distinctVals(N,D),W=K.vals,Y=K.minDiff/2,re,ue,j,q,H,U,$=(_.boxpoints||_.points)==="all"?M.identity:function(Ft){return Ft.v<re.lf||Ft.v>re.uf};if(_._hasPreCompStats){var ne=_[I],X=function(Ft){return z.d2c((_[Ft]||[])[k])},Q=1/0,ie=-1/0;for(k=0;k<_._length;k++){var se=N[k];if(A(se)){if(re={},re.pos=re[R]=se,O&&G&&(re.orig_p=G[k]),re.q1=X("q1"),re.med=X("median"),re.q3=X("q3"),ue=[],ne&&M.isArrayOrTypedArray(ne[k]))for(P=0;P<ne[k].length;P++)U=z.d2c(ne[k][P]),U!==e&&(H={v:U,i:[k,P]},s(H,_,[k,P]),ue.push(H));if(re.pts=ue.sort(x),j=re[I]=ue.map(p),q=j.length,re.med!==e&&re.q1!==e&&re.q3!==e&&re.med>=re.q1&&re.q3>=re.med){var ae=X("lowerfence");re.lf=ae!==e&&ae<=re.q1?ae:v(re,j,q);var oe=X("upperfence");re.uf=oe!==e&&oe>=re.q3?oe:f(re,j,q);var be=X("mean");re.mean=be!==e?be:q?M.mean(j,q):(re.q1+re.q3)/2;var ce=X("sd");re.sd=be!==e&&ce>=0?ce:q?M.stdev(j,q,re.mean):re.q3-re.q1,re.lo=d(re),re.uo=o(re);var de=X("notchspan");de=de!==e&&de>0?de:m(re,q),re.ln=re.med-de,re.un=re.med+de;var ye=re.lf,ge=re.uf;_.boxpoints&&j.length&&(ye=Math.min(ye,j[0]),ge=Math.max(ge,j[q-1])),_.notched&&(ye=Math.min(ye,re.ln),ge=Math.max(ge,re.un)),re.min=ye,re.max=ge}else{M.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+re.q1,"median = "+re.med,"q3 = "+re.q3].join(`
`));var me;re.med!==e?me=re.med:re.q1!==e?re.q3!==e?me=(re.q1+re.q3)/2:me=re.q1:re.q3!==e?me=re.q3:me=0,re.med=me,re.q1=re.q3=me,re.lf=re.uf=me,re.mean=re.sd=me,re.ln=re.un=me,re.min=re.max=me}Q=Math.min(Q,re.min),ie=Math.max(ie,re.max),re.pts2=ue.filter($),L.push(re)}}_._extremes[z._id]=g.findExtremes(z,[Q,ie],{padded:!0})}else{var Ee=z.makeCalcdata(_,I),Pe=r(W,Y),Ue=W.length,we=t(Ue);for(k=0;k<_._length;k++)if(U=Ee[k],!!A(U)){var ke=M.findBin(N[k],Pe);ke>=0&&ke<Ue&&(H={v:U,i:k},s(H,_,k),we[ke].push(H))}var Xe=1/0,Ve=-1/0,Ie=_.quartilemethod,De=Ie==="exclusive",Ye=Ie==="inclusive";for(k=0;k<Ue;k++)if(we[k].length>0){if(re={},re.pos=re[R]=W[k],ue=re.pts=we[k].sort(x),j=re[I]=ue.map(p),q=j.length,re.min=j[0],re.max=j[q-1],re.mean=M.mean(j,q),re.sd=M.stdev(j,q,re.mean),re.med=M.interp(j,.5),q%2&&(De||Ye)){var vt,Dt;De?(vt=j.slice(0,q/2),Dt=j.slice(q/2+1)):Ye&&(vt=j.slice(0,q/2+1),Dt=j.slice(q/2)),re.q1=M.interp(vt,.5),re.q3=M.interp(Dt,.5)}else re.q1=M.interp(j,.25),re.q3=M.interp(j,.75);re.lf=v(re,j,q),re.uf=f(re,j,q),re.lo=d(re),re.uo=o(re);var Kt=m(re,q);re.ln=re.med-Kt,re.un=re.med+Kt,Xe=Math.min(Xe,re.ln),Ve=Math.max(Ve,re.un),re.pts2=ue.filter($),L.push(re)}_._extremes[z._id]=g.findExtremes(z,_.notched?Ee.concat([Xe,Ve]):Ee,{padded:!0})}return i(L,_),L.length>0?(L[0].t={num:c[T],dPos:Y,posLetter:R,valLetter:I,labels:{med:a(w,"median:"),min:a(w,"min:"),q1:a(w,"q1:"),q3:a(w,"q3:"),max:a(w,"max:"),mean:_.boxmean==="sd"?a(w,"mean  :"):a(w,"mean:"),lf:a(w,"lower fence:"),uf:a(w,"upper fence:")}},c[T]++,L):[{t:{empty:!0}}]};function n(l,w,_,c){var b=w in l,u=w+"0"in l,L="d"+w in l;if(b||u&&L){var T=_.makeCalcdata(l,w),k=S(l,_,w,T).vals;return[k,T]}var P;u?P=l[w+"0"]:"name"in l&&(_.type==="category"||A(l.name)&&["linear","log"].indexOf(_.type)!==-1||M.isDateTime(l.name)&&_.type==="date")?P=l.name:P=c;for(var z=_.type==="multicategory"?_.r2c_just_indices(P):_.d2c(P,0,l[w+"calendar"]),I=l._length,D=new Array(I),R=0;R<I;R++)D[R]=z;return[D]}function r(l,w){for(var _=l.length,c=new Array(_+1),b=0;b<_;b++)c[b]=l[b]-w;return c[_]=l[_-1]+w,c}function t(l){for(var w=new Array(l),_=0;_<l;_++)w[_]=[];return w}var h={text:"tx",hovertext:"htx"};function s(l,w,_){for(var c in h)M.isArrayOrTypedArray(w[c])&&(Array.isArray(_)?M.isArrayOrTypedArray(w[c][_[0]])&&(l[h[c]]=w[c][_[0]][_[1]]):l[h[c]]=w[c][_])}function i(l,w){if(M.isArrayOrTypedArray(w.selectedpoints))for(var _=0;_<l.length;_++){for(var c=l[_].pts||[],b={},u=0;u<c.length;u++)b[c[u].i]=u;M.tagSelected(c,w,b)}}function x(l,w){return l.v-w.v}function p(l){return l.v}function v(l,w,_){return _===0?l.q1:Math.min(l.q1,w[Math.min(M.findBin(2.5*l.q1-1.5*l.q3,w,!0)+1,_-1)])}function f(l,w,_){return _===0?l.q3:Math.max(l.q3,w[Math.max(M.findBin(2.5*l.q3-1.5*l.q1,w),0)])}function d(l){return 4*l.q1-3*l.q3}function o(l){return 4*l.q3-3*l.q1}function m(l,w){return w===0?0:1.57*(l.q3-l.q1)/Math.sqrt(w)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../lib"),S=y("../../plots/cartesian/constraints").getAxisGroup,M=["v","h"];function e(n,r){for(var t=n.calcdata,h=r.xaxis,s=r.yaxis,i=0;i<M.length;i++){for(var x=M[i],p=x==="h"?s:h,v=[],f=0;f<t.length;f++){var d=t[f],o=d[0].t,m=d[0].trace;m.visible===!0&&(m.type==="box"||m.type==="candlestick")&&!o.empty&&(m.orientation||"v")===x&&m.xaxis===h._id&&m.yaxis===s._id&&v.push(f)}a("box",n,v,p)}}function a(n,r,t,h){var s=r.calcdata,i=r._fullLayout,x=h._id,p=x.charAt(0),v,f,d,o=[],m=0;for(v=0;v<t.length;v++)for(d=s[t[v]],f=0;f<d.length;f++)o.push(h.c2l(d[f].pos,!0)),m+=(d[f].pts2||[]).length;if(o.length){var l=g.distinctVals(o);(h.type==="category"||h.type==="multicategory")&&(l.minDiff=1);var w=l.minDiff/2;A.minDtick(h,l.minDiff,l.vals[0],!0);var _=n==="violin"?"_numViolins":"_numBoxes",c=i[_],b=i[n+"mode"]==="group"&&c>1,u=1-i[n+"gap"],L=1-i[n+"groupgap"];for(v=0;v<t.length;v++){d=s[t[v]];var T=d[0].trace,k=d[0].t,P=T.width,z=T.side,I,D,R,O;if(P)I=D=O=P/2,R=0;else if(I=w,b){var F=S(i,h._id)+T.orientation,N=i._alignmentOpts[F]||{},G=N[T.alignmentgroup]||{},K=Object.keys(G.offsetGroups||{}).length,W=K||c,Y=K?T._offsetIndex:k.num;D=I*u*L/W,R=2*I*(-.5+(Y+.5)/W)*u,O=I*u/W}else D=I*u*L,R=0,O=I;k.dPos=I,k.bPos=R,k.bdPos=D,k.wHover=O;var re,ue,j=R+D,q,H,U,$,ne,X,Q=!!P,ie=(T.boxpoints||T.points)&&m>0;if(z==="positive"?(re=I*(P?1:.5),q=j,ue=q=R):z==="negative"?(re=q=R,ue=I*(P?1:.5),H=j):(re=ue=I,q=H=j),ie){var se=T.pointpos,ae=T.jitter,oe=T.marker.size/2,be=0;se+ae>=0&&(be=j*(se+ae),be>re?(Q=!0,ne=oe,U=be):be>q&&(ne=oe,U=re)),be<=re&&(U=re);var ce=0;se-ae<=0&&(ce=-j*(se-ae),ce>ue?(Q=!0,X=oe,$=ce):ce>H&&(X=oe,$=ue)),ce<=ue&&($=ue)}else U=re,$=ue;var de=new Array(d.length);for(f=0;f<d.length;f++)de[f]=d[f].pos;T._extremes[x]=A.findExtremes(h,de,{padded:Q,vpadminus:$,vpadplus:U,vpadLinearized:!0,ppadminus:{x:X,y:ne}[p],ppadplus:{x:ne,y:X}[p]})}}}ee.exports={crossTraceCalc:e,setPositionOffset:a}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(y,ee,te){var A=y("../../lib"),g=y("../../registry"),S=y("../../components/color"),M=y("../scatter/period_defaults"),e=y("../bar/defaults").handleGroupingDefaults,a=y("../../plots/cartesian/axis_autotype"),n=y("./attributes");function r(i,x,p,v){function f(b,u){return A.coerce(i,x,n,b,u)}if(t(i,x,f,v),x.visible!==!1){M(i,x,v,f),f("xhoverformat"),f("yhoverformat");var d=x._hasPreCompStats;d&&(f("lowerfence"),f("upperfence")),f("line.color",(i.marker||{}).color||p),f("line.width"),f("fillcolor",S.addOpacity(x.line.color,.5));var o=!1;if(d){var m=f("mean"),l=f("sd");m&&m.length&&(o=!0,l&&l.length&&(o="sd"))}f("boxmean",o),f("whiskerwidth"),f("width"),f("quartilemethod");var w=!1;if(d){var _=f("notchspan");_&&_.length&&(w=!0)}else A.validate(i.notchwidth,n.notchwidth)&&(w=!0);var c=f("notched",w);c&&f("notchwidth"),h(i,x,f,{prefix:"box"})}}function t(i,x,p,v){function f(K){var W=0;return K&&K.length&&(W+=1,A.isArrayOrTypedArray(K[0])&&K[0].length&&(W+=1)),W}function d(K){return A.validate(i[K],n[K])}var o=p("y"),m=p("x"),l;if(x.type==="box"){var w=p("q1"),_=p("median"),c=p("q3");x._hasPreCompStats=w&&w.length&&_&&_.length&&c&&c.length,l=Math.min(A.minRowLength(w),A.minRowLength(_),A.minRowLength(c))}var b=f(o),u=f(m),L=b&&A.minRowLength(o),T=u&&A.minRowLength(m),k=v.calendar,P={autotypenumbers:v.autotypenumbers},z,I;if(x._hasPreCompStats)switch(String(u)+String(b)){case"00":var D=d("x0")||d("dx"),R=d("y0")||d("dy");R&&!D?z="h":z="v",I=l;break;case"10":z="v",I=Math.min(l,T);break;case"20":z="h",I=Math.min(l,m.length);break;case"01":z="h",I=Math.min(l,L);break;case"02":z="v",I=Math.min(l,o.length);break;case"12":z="v",I=Math.min(l,T,o.length);break;case"21":z="h",I=Math.min(l,m.length,L);break;case"11":I=0;break;case"22":var O=!1,F;for(F=0;F<m.length;F++)if(a(m[F],k,P)==="category"){O=!0;break}if(O)z="v",I=Math.min(l,T,o.length);else{for(F=0;F<o.length;F++)if(a(o[F],k,P)==="category"){O=!0;break}O?(z="h",I=Math.min(l,m.length,L)):(z="v",I=Math.min(l,T,o.length))}break}else b>0?(z="v",u>0?I=Math.min(T,L):I=Math.min(L)):u>0?(z="h",I=Math.min(T)):I=0;if(!I){x.visible=!1;return}x._length=I;var N=p("orientation",z);x._hasPreCompStats?N==="v"&&u===0?(p("x0",0),p("dx",1)):N==="h"&&b===0&&(p("y0",0),p("dy",1)):N==="v"&&u===0?p("x0"):N==="h"&&b===0&&p("y0");var G=g.getComponentMethod("calendars","handleTraceDefaults");G(i,x,["x","y"],v)}function h(i,x,p,v){var f=v.prefix,d=A.coerce2(i,x,n,"marker.outliercolor"),o=p("marker.line.outliercolor"),m="outliers";x._hasPreCompStats?m="all":(d||o)&&(m="suspectedoutliers");var l=p(f+"points",m);l?(p("jitter",l==="all"?.3:0),p("pointpos",l==="all"?-1.5:0),p("marker.symbol"),p("marker.opacity"),p("marker.size"),p("marker.angle"),p("marker.color",x.line.color),p("marker.line.color"),p("marker.line.width"),l==="suspectedoutliers"&&(p("marker.line.outliercolor",x.marker.color),p("marker.line.outlierwidth")),p("selected.marker.color"),p("unselected.marker.color"),p("selected.marker.size"),p("unselected.marker.size"),p("text"),p("hovertext")):delete x.marker;var w=p("hoveron");(w==="all"||w.indexOf("points")!==-1)&&p("hovertemplate"),A.coerceSelectionMarkerOpacity(x,p)}function s(i,x){var p,v;function f(m){return A.coerce(v._input,v,n,m)}for(var d=0;d<i.length;d++){v=i[d];var o=v.type;(o==="box"||o==="violin")&&(p=v._input,x[o+"mode"]==="group"&&e(p,v,x,f))}}ee.exports={supplyDefaults:r,crossTraceDefaults:s,handleSampleDefaults:t,handlePointsDefaults:h}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(y,ee,te){ee.exports=function(g,S){return S.hoverOnBox&&(g.hoverOnBox=S.hoverOnBox),"xVal"in S&&(g.x=S.xVal),"yVal"in S&&(g.y=S.yVal),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),g}},{}],687:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../lib"),S=y("../../components/fx"),M=y("../../components/color"),e=g.fillText;function a(t,h,s,i){var x=t.cd,p=x[0].trace,v=p.hoveron,f=[],d;return v.indexOf("boxes")!==-1&&(f=f.concat(n(t,h,s,i))),v.indexOf("points")!==-1&&(d=r(t,h,s)),i==="closest"?d?[d]:f:(d&&f.push(d),f)}function n(t,h,s,i){var x=t.cd,p=t.xa,v=t.ya,f=x[0].trace,d=x[0].t,o=f.type==="violin",m,l,w,_,c,b,u,L,T,k,P,z=d.bdPos,I,D,R=d.wHover,O=function(ce){return w.c2l(ce.pos)+d.bPos-w.c2l(b)};o&&f.side!=="both"?(f.side==="positive"&&(T=function(ce){var de=O(ce);return S.inbox(de,de+R,k)},I=z,D=0),f.side==="negative"&&(T=function(ce){var de=O(ce);return S.inbox(de-R,de,k)},I=0,D=z)):(T=function(ce){var de=O(ce);return S.inbox(de-R,de+R,k)},I=D=z);var F;o?F=function(ce){return S.inbox(ce.span[0]-c,ce.span[1]-c,k)}:F=function(ce){return S.inbox(ce.min-c,ce.max-c,k)},f.orientation==="h"?(c=h,b=s,u=F,L=T,m="y",w=v,l="x",_=p):(c=s,b=h,u=T,L=F,m="x",w=p,l="y",_=v);var N=Math.min(1,z/Math.abs(w.r2c(w.range[1])-w.r2c(w.range[0])));k=t.maxHoverDistance-N,P=t.maxSpikeDistance-N;function G(ce){return(u(ce)+L(ce))/2}var K=S.getDistanceFunction(i,u,L,G);if(S.getClosest(x,K,t),t.index===!1)return[];var W=x[t.index],Y=f.line.color,re=(f.marker||{}).color;M.opacity(Y)&&f.line.width?t.color=Y:M.opacity(re)&&f.boxpoints?t.color=re:t.color=f.fillcolor,t[m+"0"]=w.c2p(W.pos+d.bPos-D,!0),t[m+"1"]=w.c2p(W.pos+d.bPos+I,!0),t[m+"LabelVal"]=W.orig_p!==void 0?W.orig_p:W.pos;var ue=m+"Spike";t.spikeDistance=G(W)*P/k,t[ue]=w.c2p(W.pos,!0);var j=f.boxmean||(f.meanline||{}).visible,q=f.boxpoints||f.points,H=q&&j?["max","uf","q3","med","mean","q1","lf","min"]:q&&!j?["max","uf","q3","med","q1","lf","min"]:!q&&j?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"],U=_.range[1]<_.range[0];f.orientation===(U?"v":"h")&&H.reverse();for(var $=t.spikeDistance,ne=t[ue],X=[],Q=0;Q<H.length;Q++){var ie=H[Q];if(ie in W){var se=W[ie],ae=_.c2p(se,!0),oe=g.extendFlat({},t);oe.attr=ie,oe[l+"0"]=oe[l+"1"]=ae,oe[l+"LabelVal"]=se,oe[l+"Label"]=(d.labels?d.labels[ie]+" ":"")+A.hoverLabelText(_,se,f[l+"hoverformat"]),oe.hoverOnBox=!0,ie==="mean"&&"sd"in W&&f.boxmean==="sd"&&(oe[l+"err"]=W.sd),oe.hovertemplate=!1,X.push(oe)}}t.name="",t.spikeDistance=void 0,t[ue]=void 0;for(var be=0;be<X.length;be++)X[be].attr!=="med"?(X[be].name="",X[be].spikeDistance=void 0,X[be][ue]=void 0):(X[be].spikeDistance=$,X[be][ue]=ne);return X}function r(t,h,s){for(var i=t.cd,x=t.xa,p=t.ya,v=i[0].trace,f=x.c2p(h),d=p.c2p(s),o,m=function(F){var N=Math.max(3,F.mrc||0);return Math.max(Math.abs(x.c2p(F.x)-f)-N,1-3/N)},l=function(F){var N=Math.max(3,F.mrc||0);return Math.max(Math.abs(p.c2p(F.y)-d)-N,1-3/N)},w=S.quadrature(m,l),_=!1,c,b,u=0;u<i.length;u++){c=i[u];for(var L=0;L<(c.pts||[]).length;L++){b=c.pts[L];var T=w(b);T<=t.distance&&(t.distance=T,_=[u,L])}}if(!_)return!1;c=i[_[0]],b=c.pts[_[1]];var k=x.c2p(b.x,!0),P=p.c2p(b.y,!0),z=b.mrc||1;o=g.extendFlat({},t,{index:b.i,color:(v.marker||{}).color,name:v.name,x0:k-z,x1:k+z,y0:P-z,y1:P+z,spikeDistance:t.distance,hovertemplate:v.hovertemplate});var I=c.orig_p,D=I!==void 0?I:c.pos,R;v.orientation==="h"?(R=p,o.xLabelVal=b.x,o.yLabelVal=D):(R=x,o.xLabelVal=D,o.yLabelVal=b.y);var O=R._id.charAt(0);return o[O+"Spike"]=R.c2p(c.pos,!0),e(b,v,o),o}ee.exports={hoverPoints:a,hoverOnBoxes:n,hoverOnPoints:r}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(y,ee,te){ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults").supplyDefaults,crossTraceDefaults:y("./defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults").supplyLayoutDefaults,calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc").crossTraceCalc,plot:y("./plot").plot,style:y("./style").style,styleOnSelect:y("./style").styleOnSelect,hoverPoints:y("./hover").hoverPoints,eventData:y("./event_data"),selectPoints:y("./select"),moduleType:"trace",name:"box",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(y,ee,te){ee.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("./layout_attributes");function M(a,n,r,t,h){for(var s=h+"Layout",i=!1,x=0;x<r.length;x++){var p=r[x];if(A.traceIs(p,s)){i=!0;break}}i&&(t(h+"mode"),t(h+"gap"),t(h+"groupgap"))}function e(a,n,r){function t(h,s){return g.coerce(a,n,S,h,s)}M(a,n,r,t,"box")}ee.exports={supplyLayoutDefaults:e,_supply:M}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../components/drawing"),M=5,e=.01;function a(h,s,i,x){var p=s.xaxis,v=s.yaxis;g.makeTraceGroups(x,i,"trace boxes").each(function(f){var d=A.select(this),o=f[0],m=o.t,l=o.trace;if(m.wdPos=m.bdPos*l.whiskerwidth,l.visible!==!0||m.empty){d.remove();return}var w,_;l.orientation==="h"?(w=v,_=p):(w=p,_=v),n(d,{pos:w,val:_},l,m),r(d,{x:p,y:v},l,m),t(d,{pos:w,val:_},l,m)})}function n(h,s,i,x){var p=i.orientation==="h",v=s.val,f=s.pos,d=!!f.rangebreaks,o=x.bPos,m=x.wdPos||0,l=x.bPosPxOffset||0,w=i.whiskerwidth||0,_=i.notched||!1,c=_?1-2*i.notchwidth:1,b,u;Array.isArray(x.bdPos)?(b=x.bdPos[0],u=x.bdPos[1]):(b=x.bdPos,u=x.bdPos);var L=h.selectAll("path.box").data(i.type!=="violin"||i.box.visible?g.identity:[]);L.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),L.exit().remove(),L.each(function(T){if(T.empty)return"M0,0Z";var k=f.c2l(T.pos+o,!0),P=f.l2p(k-b)+l,z=f.l2p(k+u)+l,I=d?(P+z)/2:f.l2p(k)+l,D=i.whiskerwidth,R=d?P*D+(1-D)*I:f.l2p(k-m)+l,O=d?z*D+(1-D)*I:f.l2p(k+m)+l,F=f.l2p(k-b*c)+l,N=f.l2p(k+u*c)+l,G=v.c2p(T.q1,!0),K=v.c2p(T.q3,!0),W=g.constrain(v.c2p(T.med,!0),Math.min(G,K)+1,Math.max(G,K)-1),Y=T.lf===void 0||i.boxpoints===!1,re=v.c2p(Y?T.min:T.lf,!0),ue=v.c2p(Y?T.max:T.uf,!0),j=v.c2p(T.ln,!0),q=v.c2p(T.un,!0);p?A.select(this).attr("d","M"+W+","+F+"V"+N+"M"+G+","+P+"V"+z+(_?"H"+j+"L"+W+","+N+"L"+q+","+z:"")+"H"+K+"V"+P+(_?"H"+q+"L"+W+","+F+"L"+j+","+P:"")+"ZM"+G+","+I+"H"+re+"M"+K+","+I+"H"+ue+(w===0?"":"M"+re+","+R+"V"+O+"M"+ue+","+R+"V"+O)):A.select(this).attr("d","M"+F+","+W+"H"+N+"M"+P+","+G+"H"+z+(_?"V"+j+"L"+N+","+W+"L"+z+","+q:"")+"V"+K+"H"+P+(_?"V"+q+"L"+F+","+W+"L"+P+","+j:"")+"ZM"+I+","+G+"V"+re+"M"+I+","+K+"V"+ue+(w===0?"":"M"+R+","+re+"H"+O+"M"+R+","+ue+"H"+O))})}function r(h,s,i,x){var p=s.x,v=s.y,f=x.bdPos,d=x.bPos,o=i.boxpoints||i.points;g.seedPseudoRandom();var m=function(_){return _.forEach(function(c){c.t=x,c.trace=i}),_},l=h.selectAll("g.points").data(o?m:[]);l.enter().append("g").attr("class","points"),l.exit().remove();var w=l.selectAll("path").data(function(_){var c,b=_.pts2,u=Math.max((_.max-_.min)/10,_.q3-_.q1),L=u*1e-9,T=u*e,k=[],P=0,z;if(i.jitter){if(u===0)for(P=1,k=new Array(b.length),c=0;c<b.length;c++)k[c]=1;else for(c=0;c<b.length;c++){var I=Math.max(0,c-M),D=b[I].v,R=Math.min(b.length-1,c+M),O=b[R].v;o!=="all"&&(b[c].v<_.lf?O=Math.min(O,_.lf):D=Math.max(D,_.uf));var F=Math.sqrt(T*(R-I)/(O-D+L))||0;F=g.constrain(Math.abs(F),0,1),k.push(F),P=Math.max(F,P)}z=i.jitter*2/(P||1)}for(c=0;c<b.length;c++){var N=b[c],G=N.v,K=i.jitter?z*k[c]*(g.pseudoRandom()-.5):0,W=_.pos+d+f*(i.pointpos+K);i.orientation==="h"?(N.y=W,N.x=G):(N.x=W,N.y=G),o==="suspectedoutliers"&&G<_.uo&&G>_.lo&&(N.so=!0)}return b});w.enter().append("path").classed("point",!0),w.exit().remove(),w.call(S.translatePoints,p,v)}function t(h,s,i,x){var p=s.val,v=s.pos,f=!!v.rangebreaks,d=x.bPos,o=x.bPosPxOffset||0,m=i.boxmean||(i.meanline||{}).visible,l,w;Array.isArray(x.bdPos)?(l=x.bdPos[0],w=x.bdPos[1]):(l=x.bdPos,w=x.bdPos);var _=h.selectAll("path.mean").data(i.type==="box"&&i.boxmean||i.type==="violin"&&i.box.visible&&i.meanline.visible?g.identity:[]);_.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),_.exit().remove(),_.each(function(c){var b=v.c2l(c.pos+d,!0),u=v.l2p(b-l)+o,L=v.l2p(b+w)+o,T=f?(u+L)/2:v.l2p(b)+o,k=p.c2p(c.mean,!0),P=p.c2p(c.mean-c.sd,!0),z=p.c2p(c.mean+c.sd,!0);i.orientation==="h"?A.select(this).attr("d","M"+k+","+u+"V"+L+(m==="sd"?"m0,0L"+P+","+T+"L"+k+","+u+"L"+z+","+T+"Z":"")):A.select(this).attr("d","M"+u+","+k+"H"+L+(m==="sd"?"m0,0L"+T+","+P+"L"+u+","+k+"L"+T+","+z+"Z":""))})}ee.exports={plot:a,plotBoxAndWhiskers:n,plotPoints:r,plotBoxMean:t}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(y,ee,te){ee.exports=function(g,S){var M=g.cd,e=g.xaxis,a=g.yaxis,n=[],r,t;if(S===!1)for(r=0;r<M.length;r++)for(t=0;t<(M[r].pts||[]).length;t++)M[r].pts[t].selected=0;else for(r=0;r<M.length;r++)for(t=0;t<(M[r].pts||[]).length;t++){var h=M[r].pts[t],s=e.c2p(h.x),i=a.c2p(h.y);S.contains([s,i],null,h.i,g)?(n.push({pointNumber:h.i,x:e.c2d(h.x),y:a.c2d(h.y)}),h.selected=1):h.selected=0}return n}},{}],693:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/color"),S=y("../../components/drawing");function M(a,n,r){var t=r||A.select(a).selectAll("g.trace.boxes");t.style("opacity",function(h){return h[0].trace.opacity}),t.each(function(h){var s=A.select(this),i=h[0].trace,x=i.line.width;function p(d,o,m,l){d.style("stroke-width",o+"px").call(g.stroke,m).call(g.fill,l)}var v=s.selectAll("path.box");if(i.type==="candlestick")v.each(function(d){if(!d.empty){var o=A.select(this),m=i[d.dir];p(o,m.line.width,m.line.color,m.fillcolor),o.style("opacity",i.selectedpoints&&!d.selected?.3:1)}});else{p(v,x,i.line.color,i.fillcolor),s.selectAll("path.mean").style({"stroke-width":x,"stroke-dasharray":2*x+"px,"+x+"px"}).call(g.stroke,i.line.color);var f=s.selectAll("path.point");S.pointStyle(f,i,a)}})}function e(a,n,r){var t=n[0].trace,h=r.selectAll("path.point");t.selectedpoints?S.selectedPointStyle(h,t):S.pointStyle(h,t,a)}ee.exports={style:M,styleOnSelect:e}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(y,ee,te){var A=y("../../lib").extendFlat,g=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=y("../ohlc/attributes"),M=y("../box/attributes");function e(a){return{line:{color:A({},M.line.color,{dflt:a}),width:M.line.width,editType:"style"},fillcolor:M.fillcolor,editType:"style"}}ee.exports={xperiod:S.xperiod,xperiod0:S.xperiod0,xperiodalignment:S.xperiodalignment,xhoverformat:g("x"),yhoverformat:g("y"),x:S.x,open:S.open,high:S.high,low:S.low,close:S.close,line:{width:A({},M.line.width,{}),editType:"style"},increasing:e(S.increasing.line.color.dflt),decreasing:e(S.decreasing.line.color.dflt),text:S.text,hovertext:S.hovertext,whiskerwidth:A({},M.whiskerwidth,{dflt:0}),hoverlabel:S.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("../../plots/cartesian/align_period"),M=y("../ohlc/calc").calcCommon;ee.exports=function(a,n){var r=a._fullLayout,t=g.getFromId(a,n.xaxis),h=g.getFromId(a,n.yaxis),s=t.makeCalcdata(n,"x"),i=S(n,t,"x",s).vals,x=M(a,n,s,i,h,e);return x.length?(A.extendFlat(x[0].t,{num:r._numBoxes,dPos:A.distinctVals(i).minDiff/2,posLetter:"x",valLetter:"y"}),r._numBoxes++,x):[{t:{empty:!0}}]};function e(a,n,r,t){return{min:r,q1:Math.min(a,t),med:t,q3:Math.max(a,t),max:n}}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color"),S=y("../ohlc/ohlc_defaults"),M=y("../scatter/period_defaults"),e=y("./attributes");ee.exports=function(r,t,h,s){function i(p,v){return A.coerce(r,t,e,p,v)}var x=S(r,t,i,s);if(!x){t.visible=!1;return}M(r,t,s,i,{x:!0}),i("xhoverformat"),i("yhoverformat"),i("line.width"),a(r,t,i,"increasing"),a(r,t,i,"decreasing"),i("text"),i("hovertext"),i("whiskerwidth"),s._requestRangeslider[t.xaxis]=!0};function a(n,r,t,h){var s=t(h+".line.color");t(h+".line.width",r.line.width),t(h+".fillcolor",g.addOpacity(s,.5))}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(y,ee,te){ee.exports={moduleType:"trace",name:"candlestick",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:y("./attributes"),layoutAttributes:y("../box/layout_attributes"),supplyLayoutDefaults:y("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:y("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("../box/plot").plot,layerName:"boxlayer",style:y("../box/style").style,hoverPoints:y("../ohlc/hover").hoverPoints,selectPoints:y("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(y,ee,te){var A=y("./axis_defaults"),g=y("../../plot_api/plot_template");ee.exports=function(e,a,n,r,t){var h=r("a");h||(r("da"),r("a0"));var s=r("b");s||(r("db"),r("b0")),S(e,a,n,t)};function S(M,e,a,n){var r=["aaxis","baxis"];r.forEach(function(t){var h=t.charAt(0),s=M[t]||{},i=g.newContainer(e,t),x={noTicklabelstep:!0,tickfont:"x",id:h+"axis",letter:h,font:e.font,name:t,data:M[h],calendar:e.calendar,dfltColor:n,bgColor:a.paper_bgcolor,autotypenumbersDflt:a.autotypenumbers,fullLayout:a};A(s,i,x),i._categories=i._categories||[],!M[t]&&s.type!=="-"&&(M[t]={type:s.type})})}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(y,ee,te){var A=y("../../lib").isArrayOrTypedArray;ee.exports=function(S){return g(S,0)};function g(S,M){if(!A(S)||M>=10)return null;for(var e=1/0,a=-1/0,n=S.length,r=0;r<n;r++){var t=S[r];if(A(t)){var h=g(t,M+1);h&&(e=Math.min(h[0],e),a=Math.max(h[1],a))}else e=Math.min(t,e),a=Math.max(t,a)}return[e,a]}},{"../../lib":515}],700:[function(y,ee,te){var A=y("../../plots/font_attributes"),g=y("./axis_attributes"),S=y("../../components/color/attributes"),M=A({editType:"calc"});M.family.dflt='"Open Sans", verdana, arial, sans-serif',M.size.dflt=12,M.color.dflt=S.defaultLine,ee.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:g,baxis:g,font:M,color:{valType:"color",dflt:S.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(y,ee,te){var A=y("../../lib").isArrayOrTypedArray;ee.exports=function(g,S,M,e){var a,n,r,t,h,s,i,x,p,v,f,d,o,m=A(M)?"a":"b",l=m==="a"?g.aaxis:g.baxis,w=l.smoothing,_=m==="a"?g.a2i:g.b2j,c=m==="a"?M:e,b=m==="a"?e:M,u=m==="a"?S.a.length:S.b.length,L=m==="a"?S.b.length:S.a.length,T=Math.floor(m==="a"?g.b2j(b):g.a2i(b)),k=m==="a"?function(Y){return g.evalxy([],Y,T)}:function(Y){return g.evalxy([],T,Y)};w&&(r=Math.max(0,Math.min(L-2,T)),t=T-r,n=m==="a"?function(Y,re){return g.dxydi([],Y,r,re,t)}:function(Y,re){return g.dxydj([],r,Y,t,re)});var P=_(c[0]),z=_(c[1]),I=P<z?1:-1,D=(z-P)*1e-8,R=I>0?Math.floor:Math.ceil,O=I>0?Math.ceil:Math.floor,F=I>0?Math.min:Math.max,N=I>0?Math.max:Math.min,G=R(P+D),K=O(z-D);i=k(P);var W=[[i]];for(a=G;a*I<K*I;a+=I)h=[],f=N(P,a),d=F(z,a+I),o=d-f,s=Math.max(0,Math.min(u-2,Math.floor(.5*(f+d)))),x=k(d),w&&(p=n(s,f-s),v=n(s,d-s),h.push([i[0]+p[0]/3*o,i[1]+p[1]/3*o]),h.push([x[0]-v[0]/3*o,x[1]-v[1]/3*o])),h.push(x),W.push(h),i=x;return W}},{"../../lib":515}],702:[function(y,ee,te){var A=y("../../plots/font_attributes"),g=y("../../components/color/attributes"),S=y("../../plots/cartesian/layout_attributes"),M=y("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=y("../../plot_api/edit_types").overrideAll,a=y("../../components/drawing/attributes").dash,n=y("../../lib/extend").extendFlat;ee.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:A({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:S.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:A({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:M("tick label")},tickformatstops:e(S.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:g.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:n({},a,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:n({},a,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:g.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:A({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(y,ee,te){var A=y("./attributes"),g=y("../../components/color").addOpacity,S=y("../../registry"),M=y("../../lib"),e=y("../../plots/cartesian/tick_value_defaults"),a=y("../../plots/cartesian/tick_label_defaults"),n=y("../../plots/cartesian/prefix_suffix_defaults"),r=y("../../plots/cartesian/category_order_defaults"),t=y("../../plots/cartesian/set_convert"),h=y("../../plots/cartesian/axis_autotype");ee.exports=function(x,p,v){var f=v.letter,d=v.font||{},o=A[f+"axis"];function m(G,K){return M.coerce(x,p,o,G,K)}function l(G,K){return M.coerce2(x,p,o,G,K)}v.name&&(p._name=v.name,p._id=v.name),m("autotypenumbers",v.autotypenumbersDflt);var w=m("type");if(w==="-"&&(v.data&&s(p,v.data),p.type==="-"?p.type="linear":w=x.type=p.type),m("smoothing"),m("cheatertype"),m("showticklabels"),m("labelprefix",f+" = "),m("labelsuffix"),m("showtickprefix"),m("showticksuffix"),m("separatethousands"),m("tickformat"),m("exponentformat"),m("minexponent"),m("showexponent"),m("categoryorder"),m("tickmode"),m("tickvals"),m("ticktext"),m("tick0"),m("dtick"),p.tickmode==="array"&&(m("arraytick0"),m("arraydtick")),m("labelpadding"),p._hovertitle=f,w==="date"){var _=S.getComponentMethod("calendars","handleDefaults");_(x,p,"calendar",v.calendar)}t(p,v.fullLayout),p.c2p=M.identity;var c=m("color",v.dfltColor),b=c===x.color?c:d.color,u=m("title.text");u&&(M.coerceFont(m,"title.font",{family:d.family,size:M.bigFont(d.size),color:b}),m("title.offset")),m("tickangle");var L=m("autorange",!p.isValidRange(x.range));L&&m("rangemode"),m("range"),p.cleanRange(),m("fixedrange"),e(x,p,m,w),n(x,p,m,w,v),a(x,p,m,w,v),r(x,p,m,{data:v.data,dataAttr:f});var T=l("gridcolor",g(c,.3)),k=l("gridwidth"),P=l("griddash"),z=m("showgrid");z||(delete p.gridcolor,delete p.gridwidth,delete p.griddash);var I=l("startlinecolor",c),D=l("startlinewidth",k),R=m("startline",p.showgrid||!!I||!!D);R||(delete p.startlinecolor,delete p.startlinewidth);var O=l("endlinecolor",c),F=l("endlinewidth",k),N=m("endline",p.showgrid||!!O||!!F);return N||(delete p.endlinecolor,delete p.endlinewidth),z?(m("minorgridcount"),m("minorgridwidth",k),m("minorgriddash",P),m("minorgridcolor",g(T,.06)),p.minorgridcount||(delete p.minorgridwidth,delete p.minorgriddash,delete p.minorgridcolor)):(delete p.gridcolor,delete p.gridwidth,delete p.griddash),p.showticklabels==="none"&&(delete p.tickfont,delete p.tickangle,delete p.showexponent,delete p.exponentformat,delete p.minexponent,delete p.tickformat,delete p.showticksuffix,delete p.showtickprefix),p.showticksuffix||delete p.ticksuffix,p.showtickprefix||delete p.tickprefix,m("tickmode"),p};function s(i,x){if(i.type==="-"){var p=i._id,v=p.charAt(0),f=v+"calendar",d=i[f];i.type=h(x,d,{autotypenumbers:i.autotypenumbers})}}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../lib").isArray1D,S=y("./cheater_basis"),M=y("./array_minmax"),e=y("./calc_gridlines"),a=y("./calc_labels"),n=y("./calc_clippath"),r=y("../heatmap/clean_2d_array"),t=y("./smooth_fill_2d_array"),h=y("../heatmap/convert_column_xyz"),s=y("./set_convert");ee.exports=function(x,p){var v=A.getFromId(x,p.xaxis),f=A.getFromId(x,p.yaxis),d=p.aaxis,o=p.baxis,m=p.x,l=p.y,w=[];m&&g(m)&&w.push("x"),l&&g(l)&&w.push("y"),w.length&&h(p,d,o,"a","b",w);var _=p._a=p._a||p.a,c=p._b=p._b||p.b;m=p._x||p.x,l=p._y||p.y;var b={};if(p._cheater){var u=d.cheatertype==="index"?_.length:_,L=o.cheatertype==="index"?c.length:c;m=S(u,L,p.cheaterslope)}p._x=m=r(m),p._y=l=r(l),t(m,_,c),t(l,_,c),s(p),p.setScale();var T=M(m),k=M(l),P=.5*(T[1]-T[0]),z=.5*(T[1]+T[0]),I=.5*(k[1]-k[0]),D=.5*(k[1]+k[0]),R=1.3;return T=[z-P*R,z+P*R],k=[D-I*R,D+I*R],p._extremes[v._id]=A.findExtremes(v,T,{padded:!0}),p._extremes[f._id]=A.findExtremes(f,k,{padded:!0}),e(p,"a","b"),e(p,"b","a"),a(p,d),a(p,o),b.clipsegments=n(p._xctrl,p._yctrl,d,o),b.x=m,b.y=l,b.a=_,b.b=c,[b]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(y,ee,te){ee.exports=function(g,S,M,e){var a,n,r,t=[],h=!!M.smoothing,s=!!e.smoothing,i=g[0].length-1,x=g.length-1;for(a=0,n=[],r=[];a<=i;a++)n[a]=g[0][a],r[a]=S[0][a];for(t.push({x:n,y:r,bicubic:h}),a=0,n=[],r=[];a<=x;a++)n[a]=g[a][i],r[a]=S[a][i];for(t.push({x:n,y:r,bicubic:s}),a=i,n=[],r=[];a>=0;a--)n[i-a]=g[x][a],r[i-a]=S[x][a];for(t.push({x:n,y:r,bicubic:h}),a=x,n=[],r=[];a>=0;a--)n[x-a]=g[a][0],r[x-a]=S[a][0];return t.push({x:n,y:r,bicubic:s}),t}},{}],706:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../lib/extend").extendFlat;ee.exports=function(M,e,a){var n,r,t,h,s,i,x,p,v,f,d,o,m,l,w=M["_"+e],_=M[e+"axis"],c=_._gridlines=[],b=_._minorgridlines=[],u=_._boundarylines=[],L=M["_"+a],T=M[a+"axis"];_.tickmode==="array"&&(_.tickvals=w.slice());var k=M._xctrl,P=M._yctrl,z=k[0].length,I=k.length,D=M._a.length,R=M._b.length;A.prepTicks(_),_.tickmode==="array"&&delete _.tickvals;var O=_.smoothing?3:1;function F(G){var K,W,Y,re,ue,j,q,H,U,$,ne,X,Q=[],ie=[],se={};if(e==="b")for(W=M.b2j(G),Y=Math.floor(Math.max(0,Math.min(R-2,W))),re=W-Y,se.length=R,se.crossLength=D,se.xy=function(ae){return M.evalxy([],ae,W)},se.dxy=function(ae,oe){return M.dxydi([],ae,Y,oe,re)},K=0;K<D;K++)j=Math.min(D-2,K),q=K-j,H=M.evalxy([],K,W),T.smoothing&&K>0&&(U=M.dxydi([],K-1,Y,0,re),Q.push(ue[0]+U[0]/3),ie.push(ue[1]+U[1]/3),$=M.dxydi([],K-1,Y,1,re),Q.push(H[0]-$[0]/3),ie.push(H[1]-$[1]/3)),Q.push(H[0]),ie.push(H[1]),ue=H;else for(K=M.a2i(G),j=Math.floor(Math.max(0,Math.min(D-2,K))),q=K-j,se.length=D,se.crossLength=R,se.xy=function(ae){return M.evalxy([],K,ae)},se.dxy=function(ae,oe){return M.dxydj([],j,ae,q,oe)},W=0;W<R;W++)Y=Math.min(R-2,W),re=W-Y,H=M.evalxy([],K,W),T.smoothing&&W>0&&(ne=M.dxydj([],j,W-1,q,0),Q.push(ue[0]+ne[0]/3),ie.push(ue[1]+ne[1]/3),X=M.dxydj([],j,W-1,q,1),Q.push(H[0]-X[0]/3),ie.push(H[1]-X[1]/3)),Q.push(H[0]),ie.push(H[1]),ue=H;return se.axisLetter=e,se.axis=_,se.crossAxis=T,se.value=G,se.constvar=a,se.index=p,se.x=Q,se.y=ie,se.smoothing=T.smoothing,se}function N(G){var K,W,Y,re,ue,j=[],q=[],H={};if(H.length=w.length,H.crossLength=L.length,e==="b")for(Y=Math.max(0,Math.min(R-2,G)),ue=Math.min(1,Math.max(0,G-Y)),H.xy=function(U){return M.evalxy([],U,G)},H.dxy=function(U,$){return M.dxydi([],U,Y,$,ue)},K=0;K<z;K++)j[K]=k[G*O][K],q[K]=P[G*O][K];else for(W=Math.max(0,Math.min(D-2,G)),re=Math.min(1,Math.max(0,G-W)),H.xy=function(U){return M.evalxy([],G,U)},H.dxy=function(U,$){return M.dxydj([],W,U,re,$)},K=0;K<I;K++)j[K]=k[K][G*O],q[K]=P[K][G*O];return H.axisLetter=e,H.axis=_,H.crossAxis=T,H.value=w[G],H.constvar=a,H.index=G,H.x=j,H.y=q,H.smoothing=T.smoothing,H}if(_.tickmode==="array"){for(h=5e-15,s=[Math.floor((w.length-1-_.arraytick0)/_.arraydtick*(1+h)),Math.ceil(-_.arraytick0/_.arraydtick/(1+h))].sort(function(G,K){return G-K}),i=s[0]-1,x=s[1]+1,p=i;p<x;p++)r=_.arraytick0+_.arraydtick*p,!(r<0||r>w.length-1)&&c.push(g(N(r),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(p=i;p<x;p++)if(t=_.arraytick0+_.arraydtick*p,d=Math.min(t+_.arraydtick,w.length-1),!(t<0||t>w.length-1)&&!(d<0||d>w.length-1))for(o=w[t],m=w[d],n=0;n<_.minorgridcount;n++)l=d-t,!(l<=0)&&(f=o+(m-o)*(n+1)/(_.minorgridcount+1)*(_.arraydtick/l),!(f<w[0]||f>w[w.length-1])&&b.push(g(F(f),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash})));_.startline&&u.push(g(N(0),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&u.push(g(N(w.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}else{for(h=5e-15,s=[Math.floor((w[w.length-1]-_.tick0)/_.dtick*(1+h)),Math.ceil((w[0]-_.tick0)/_.dtick/(1+h))].sort(function(G,K){return G-K}),i=s[0],x=s[1],p=i;p<=x;p++)v=_.tick0+_.dtick*p,c.push(g(F(v),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(p=i-1;p<x+1;p++)for(v=_.tick0+_.dtick*p,n=0;n<_.minorgridcount;n++)f=v+_.dtick*(n+1)/(_.minorgridcount+1),!(f<w[0]||f>w[w.length-1])&&b.push(g(F(f),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&u.push(g(F(w[0]),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&u.push(g(F(w[w.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../lib/extend").extendFlat;ee.exports=function(M,e){var a,n,r,t,h,s=e._labels=[],i=e._gridlines;for(a=0;a<i.length;a++)h=i[a],["start","both"].indexOf(e.showticklabels)!==-1&&(n=A.tickText(e,h.value),g(n,{prefix:r,suffix:t,endAnchor:!0,xy:h.xy(0),dxy:h.dxy(0,0),axis:h.axis,length:h.crossAxis.length,font:h.axis.tickfont,isFirst:a===0,isLast:a===i.length-1}),s.push(n)),["end","both"].indexOf(e.showticklabels)!==-1&&(n=A.tickText(e,h.value),g(n,{endAnchor:!1,xy:h.xy(h.crossLength-1),dxy:h.dxy(h.crossLength-2,1),axis:h.axis,length:h.crossAxis.length,font:h.axis.tickfont,isFirst:a===0,isLast:a===i.length-1}),s.push(n))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(y,ee,te){var A=.5;ee.exports=function(S,M,e,a){var n=S[0]-M[0],r=S[1]-M[1],t=e[0]-M[0],h=e[1]-M[1],s=Math.pow(n*n+r*r,A/2),i=Math.pow(t*t+h*h,A/2),x=(i*i*n-s*s*t)*a,p=(i*i*r-s*s*h)*a,v=i*(s+i)*3,f=s*(s+i)*3;return[[M[0]+(v&&x/v),M[1]+(v&&p/v)],[M[0]-(f&&x/f),M[1]-(f&&p/f)]]}},{}],709:[function(y,ee,te){var A=y("../../lib").isArrayOrTypedArray;ee.exports=function(g,S,M){var e,a,n,r,t,h,s=[],i=A(g)?g.length:g,x=A(S)?S.length:S,p=A(g)?g:null,v=A(S)?S:null;p&&(n=(p.length-1)/(p[p.length-1]-p[0])/(i-1)),v&&(r=(v.length-1)/(v[v.length-1]-v[0])/(x-1));var f,d=1/0,o=-1/0;for(a=0;a<x;a++)for(s[a]=[],h=v?(v[a]-v[0])*r:a/(x-1),e=0;e<i;e++)t=p?(p[e]-p[0])*n:e/(i-1),f=t-h*M,d=Math.min(f,d),o=Math.max(f,o),s[a][e]=f;var m=1/(o-d),l=-d*m;for(a=0;a<x;a++)for(e=0;e<i;e++)s[a][e]=m*s[a][e]+l;return s}},{"../../lib":515}],710:[function(y,ee,te){var A=y("./catmull_rom"),g=y("../../lib").ensureArray;function S(M,e,a){var n=-.5*a[0]+1.5*e[0],r=-.5*a[1]+1.5*e[1];return[(2*n+M[0])/3,(2*r+M[1])/3]}ee.exports=function(e,a,n,r,t,h){var s,i,x,p,v,f,d,o,m,l,w=n[0].length,_=n.length,c=t?3*w-2:w,b=h?3*_-2:_;for(e=g(e,b),a=g(a,b),x=0;x<b;x++)e[x]=g(e[x],c),a[x]=g(a[x],c);for(i=0,p=0;i<_;i++,p+=h?3:1)for(v=e[p],f=a[p],d=n[i],o=r[i],s=0,x=0;s<w;s++,x+=t?3:1)v[x]=d[s],f[x]=o[s];if(t)for(i=0,p=0;i<_;i++,p+=h?3:1){for(s=1,x=3;s<w-1;s++,x+=3)m=A([n[i][s-1],r[i][s-1]],[n[i][s],r[i][s]],[n[i][s+1],r[i][s+1]],t),e[p][x-1]=m[0][0],a[p][x-1]=m[0][1],e[p][x+1]=m[1][0],a[p][x+1]=m[1][1];l=S([e[p][0],a[p][0]],[e[p][2],a[p][2]],[e[p][3],a[p][3]]),e[p][1]=l[0],a[p][1]=l[1],l=S([e[p][c-1],a[p][c-1]],[e[p][c-3],a[p][c-3]],[e[p][c-4],a[p][c-4]]),e[p][c-2]=l[0],a[p][c-2]=l[1]}if(h)for(x=0;x<c;x++){for(p=3;p<b-3;p+=3)m=A([e[p-3][x],a[p-3][x]],[e[p][x],a[p][x]],[e[p+3][x],a[p+3][x]],h),e[p-1][x]=m[0][0],a[p-1][x]=m[0][1],e[p+1][x]=m[1][0],a[p+1][x]=m[1][1];l=S([e[0][x],a[0][x]],[e[2][x],a[2][x]],[e[3][x],a[3][x]]),e[1][x]=l[0],a[1][x]=l[1],l=S([e[b-1][x],a[b-1][x]],[e[b-3][x],a[b-3][x]],[e[b-4][x],a[b-4][x]]),e[b-2][x]=l[0],a[b-2][x]=l[1]}if(t&&h)for(p=1;p<b;p+=(p+1)%3===0?2:1){for(x=3;x<c-3;x+=3)m=A([e[p][x-3],a[p][x-3]],[e[p][x],a[p][x]],[e[p][x+3],a[p][x+3]],t),e[p][x-1]=.5*(e[p][x-1]+m[0][0]),a[p][x-1]=.5*(a[p][x-1]+m[0][1]),e[p][x+1]=.5*(e[p][x+1]+m[1][0]),a[p][x+1]=.5*(a[p][x+1]+m[1][1]);l=S([e[p][0],a[p][0]],[e[p][2],a[p][2]],[e[p][3],a[p][3]]),e[p][1]=.5*(e[p][1]+l[0]),a[p][1]=.5*(a[p][1]+l[1]),l=S([e[p][c-1],a[p][c-1]],[e[p][c-3],a[p][c-3]],[e[p][c-4],a[p][c-4]]),e[p][c-2]=.5*(e[p][c-2]+l[0]),a[p][c-2]=.5*(a[p][c-2]+l[1])}return[e,a]}},{"../../lib":515,"./catmull_rom":708}],711:[function(y,ee,te){ee.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(y,ee,te){ee.exports=function(A,g,S){return g&&S?function(M,e,a,n,r){M||(M=[]);var t,h,s,i,x,p;e*=3,a*=3;var v=n*n,f=1-n,d=f*f,o=f*n*2,m=-3*d,l=3*(d-o),w=3*(o-v),_=3*v,c=r*r,b=c*r,u=1-r,L=u*u,T=L*u;for(p=0;p<A.length;p++)x=A[p],t=m*x[a][e]+l*x[a][e+1]+w*x[a][e+2]+_*x[a][e+3],h=m*x[a+1][e]+l*x[a+1][e+1]+w*x[a+1][e+2]+_*x[a+1][e+3],s=m*x[a+2][e]+l*x[a+2][e+1]+w*x[a+2][e+2]+_*x[a+2][e+3],i=m*x[a+3][e]+l*x[a+3][e+1]+w*x[a+3][e+2]+_*x[a+3][e+3],M[p]=T*t+3*(L*r*h+u*c*s)+b*i;return M}:g?function(M,e,a,n,r){M||(M=[]);var t,h,s,i;e*=3;var x=n*n,p=1-n,v=p*p,f=p*n*2,d=-3*v,o=3*(v-f),m=3*(f-x),l=3*x,w=1-r;for(s=0;s<A.length;s++)i=A[s],t=d*i[a][e]+o*i[a][e+1]+m*i[a][e+2]+l*i[a][e+3],h=d*i[a+1][e]+o*i[a+1][e+1]+m*i[a+1][e+2]+l*i[a+1][e+3],M[s]=w*t+r*h;return M}:S?function(M,e,a,n,r){M||(M=[]);var t,h,s,i,x,p;a*=3;var v=r*r,f=v*r,d=1-r,o=d*d,m=o*d;for(x=0;x<A.length;x++)p=A[x],t=p[a][e+1]-p[a][e],h=p[a+1][e+1]-p[a+1][e],s=p[a+2][e+1]-p[a+2][e],i=p[a+3][e+1]-p[a+3][e],M[x]=m*t+3*(o*r*h+d*v*s)+f*i;return M}:function(M,e,a,n,r){M||(M=[]);var t,h,s,i,x=1-r;for(s=0;s<A.length;s++)i=A[s],t=i[a][e+1]-i[a][e],h=i[a+1][e+1]-i[a+1][e],M[s]=x*t+r*h;return M}}},{}],713:[function(y,ee,te){ee.exports=function(A,g,S){return g&&S?function(M,e,a,n,r){M||(M=[]);var t,h,s,i,x,p;e*=3,a*=3;var v=n*n,f=v*n,d=1-n,o=d*d,m=o*d,l=r*r,w=1-r,_=w*w,c=w*r*2,b=-3*_,u=3*(_-c),L=3*(c-l),T=3*l;for(p=0;p<A.length;p++)x=A[p],t=b*x[a][e]+u*x[a+1][e]+L*x[a+2][e]+T*x[a+3][e],h=b*x[a][e+1]+u*x[a+1][e+1]+L*x[a+2][e+1]+T*x[a+3][e+1],s=b*x[a][e+2]+u*x[a+1][e+2]+L*x[a+2][e+2]+T*x[a+3][e+2],i=b*x[a][e+3]+u*x[a+1][e+3]+L*x[a+2][e+3]+T*x[a+3][e+3],M[p]=m*t+3*(o*n*h+d*v*s)+f*i;return M}:g?function(M,e,a,n,r){M||(M=[]);var t,h,s,i,x,p;e*=3;var v=r*r,f=v*r,d=1-r,o=d*d,m=o*d;for(x=0;x<A.length;x++)p=A[x],t=p[a+1][e]-p[a][e],h=p[a+1][e+1]-p[a][e+1],s=p[a+1][e+2]-p[a][e+2],i=p[a+1][e+3]-p[a][e+3],M[x]=m*t+3*(o*r*h+d*v*s)+f*i;return M}:S?function(M,e,a,n,r){M||(M=[]);var t,h,s,i;a*=3;var x=1-n,p=r*r,v=1-r,f=v*v,d=v*r*2,o=-3*f,m=3*(f-d),l=3*(d-p),w=3*p;for(s=0;s<A.length;s++)i=A[s],t=o*i[a][e]+m*i[a+1][e]+l*i[a+2][e]+w*i[a+3][e],h=o*i[a][e+1]+m*i[a+1][e+1]+l*i[a+2][e+1]+w*i[a+3][e+1],M[s]=x*t+n*h;return M}:function(M,e,a,n,r){M||(M=[]);var t,h,s,i,x=1-n;for(s=0;s<A.length;s++)i=A[s],t=i[a+1][e]-i[a][e],h=i[a+1][e+1]-i[a][e+1],M[s]=x*t+n*h;return M}}},{}],714:[function(y,ee,te){ee.exports=function(A,g,S,M,e){var a=g-2,n=S-2;return M&&e?function(r,t,h){r||(r=[]);var s,i,x,p,v,f,d=Math.max(0,Math.min(Math.floor(t),a)),o=Math.max(0,Math.min(Math.floor(h),n)),m=Math.max(0,Math.min(1,t-d)),l=Math.max(0,Math.min(1,h-o));d*=3,o*=3;var w=m*m,_=w*m,c=1-m,b=c*c,u=b*c,L=l*l,T=L*l,k=1-l,P=k*k,z=P*k;for(f=0;f<A.length;f++)v=A[f],s=u*v[o][d]+3*(b*m*v[o][d+1]+c*w*v[o][d+2])+_*v[o][d+3],i=u*v[o+1][d]+3*(b*m*v[o+1][d+1]+c*w*v[o+1][d+2])+_*v[o+1][d+3],x=u*v[o+2][d]+3*(b*m*v[o+2][d+1]+c*w*v[o+2][d+2])+_*v[o+2][d+3],p=u*v[o+3][d]+3*(b*m*v[o+3][d+1]+c*w*v[o+3][d+2])+_*v[o+3][d+3],r[f]=z*s+3*(P*l*i+k*L*x)+T*p;return r}:M?function(r,t,h){r||(r=[]);var s=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(h),n)),x=Math.max(0,Math.min(1,t-s)),p=Math.max(0,Math.min(1,h-i)),v,f,d,o,m,l;s*=3;var w=x*x,_=w*x,c=1-x,b=c*c,u=b*c,L=1-p;for(m=0;m<A.length;m++)l=A[m],v=L*l[i][s]+p*l[i+1][s],f=L*l[i][s+1]+p*l[i+1][s+1],d=L*l[i][s+2]+p*l[i+1][s+1],o=L*l[i][s+3]+p*l[i+1][s+1],r[m]=u*v+3*(b*x*f+c*w*d)+_*o;return r}:e?function(r,t,h){r||(r=[]);var s=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(h),n)),x=Math.max(0,Math.min(1,t-s)),p=Math.max(0,Math.min(1,h-i)),v,f,d,o,m,l;i*=3;var w=p*p,_=w*p,c=1-p,b=c*c,u=b*c,L=1-x;for(m=0;m<A.length;m++)l=A[m],v=L*l[i][s]+x*l[i][s+1],f=L*l[i+1][s]+x*l[i+1][s+1],d=L*l[i+2][s]+x*l[i+2][s+1],o=L*l[i+3][s]+x*l[i+3][s+1],r[m]=u*v+3*(b*p*f+c*w*d)+_*o;return r}:function(r,t,h){r||(r=[]);var s=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(h),n)),x=Math.max(0,Math.min(1,t-s)),p=Math.max(0,Math.min(1,h-i)),v,f,d,o,m=1-p,l=1-x;for(d=0;d<A.length;d++)o=A[d],v=l*o[i][s]+x*o[i][s+1],f=l*o[i+1][s]+x*o[i+1][s+1],r[d]=m*v+p*f;return r}}},{}],715:[function(y,ee,te){var A=y("../../lib"),g=y("./xy_defaults"),S=y("./ab_defaults"),M=y("./attributes"),e=y("../../components/color/attributes");ee.exports=function(n,r,t,h){function s(p,v){return A.coerce(n,r,M,p,v)}r._clipPathId="clip"+r.uid+"carpet";var i=s("color",e.defaultLine);if(A.coerceFont(s,"font"),s("carpet"),S(n,r,h,s,i),!r.a||!r.b){r.visible=!1;return}r.a.length<3&&(r.aaxis.smoothing=0),r.b.length<3&&(r.baxis.smoothing=0);var x=g(n,r,s);x||(r.visible=!1),r._cheater&&s("cheaterslope")}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),plot:y("./plot"),calc:y("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(y,ee,te){ee.exports=function(A,g){for(var S=A._fullData.length,M,e=0;e<S;e++){var a=A._fullData[e];if(a.index!==g.index&&a.type==="carpet"&&(M||(M=a),a.carpet===g.carpet))return a}return M}},{}],718:[function(y,ee,te){ee.exports=function(g,S,M){if(g.length===0)return"";var e,a=[],n=M?3:1;for(e=0;e<g.length;e+=n)a.push(g[e]+","+S[e]),M&&e<g.length-n&&(a.push("C"),a.push([g[e+1]+","+S[e+1],g[e+2]+","+S[e+2]+" "].join(" ")));return a.join(M?"":"L")}},{}],719:[function(y,ee,te){var A=y("../../lib").isArrayOrTypedArray;ee.exports=function(S,M,e){var a;for(A(S)?S.length>M.length&&(S=S.slice(0,M.length)):S=[],a=0;a<M.length;a++)S[a]=e(M[a]);return S}},{"../../lib":515}],720:[function(y,ee,te){ee.exports=function(g,S,M,e,a,n){var r=a[0]*g.dpdx(S),t=a[1]*g.dpdy(M),h=1,s=1;if(n){var i=Math.sqrt(a[0]*a[0]+a[1]*a[1]),x=Math.sqrt(n[0]*n[0]+n[1]*n[1]),p=(a[0]*n[0]+a[1]*n[1])/i/x;s=Math.max(0,p)}var v=Math.atan2(t,r)*180/Math.PI;return v<-90?(v+=180,h=-h):v>90&&(v-=180,h=-h),{angle:v,flip:h,p:g.c2p(e,S,M),offsetMultplier:s}}},{}],721:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/drawing"),S=y("./map_1d_array"),M=y("./makepath"),e=y("./orient_text"),a=y("../../lib/svg_text_utils"),n=y("../../lib"),r=n.strRotate,t=n.strTranslate,h=y("../../constants/alignment");ee.exports=function(m,l,w,_){var c=l.xaxis,b=l.yaxis,u=m._fullLayout,L=u._clips;n.makeTraceGroups(_,w,"trace").each(function(T){var k=A.select(this),P=T[0],z=P.trace,I=z.aaxis,D=z.baxis,R=n.ensureSingle(k,"g","minorlayer"),O=n.ensureSingle(k,"g","majorlayer"),F=n.ensureSingle(k,"g","boundarylayer"),N=n.ensureSingle(k,"g","labellayer");k.style("opacity",z.opacity),i(c,b,O,I,"a",I._gridlines),i(c,b,O,D,"b",D._gridlines),i(c,b,R,I,"a",I._minorgridlines),i(c,b,R,D,"b",D._minorgridlines),i(c,b,F,I,"a-boundary",I._boundarylines),i(c,b,F,D,"b-boundary",D._boundarylines);var G=x(m,c,b,z,P,N,I._labels,"a-label"),K=x(m,c,b,z,P,N,D._labels,"b-label");p(m,N,z,P,c,b,G,K),s(z,P,L,c,b)})};function s(o,m,l,w,_){var c,b,u,L,T=l.select("#"+o._clipPathId);T.size()||(T=l.append("clipPath").classed("carpetclip",!0));var k=n.ensureSingle(T,"path","carpetboundary"),P=m.clipsegments,z=[];for(L=0;L<P.length;L++)c=P[L],b=S([],c.x,w.c2p),u=S([],c.y,_.c2p),z.push(M(b,u,c.bicubic));var I="M"+z.join("L")+"Z";T.attr("id",o._clipPathId),k.attr("d",I)}function i(o,m,l,w,_,c){var b="const-"+_+"-lines",u=l.selectAll("."+b).data(c);u.enter().append("path").classed(b,!0).style("vector-effect","non-scaling-stroke"),u.each(function(L){var T=L,k=T.x,P=T.y,z=S([],k,o.c2p),I=S([],P,m.c2p),D="M"+M(z,I,T.smoothing),R=A.select(this);R.attr("d",D).style("stroke-width",T.width).style("stroke",T.color).style("stroke-dasharray",g.dashStyle(T.dash,T.width)).style("fill","none")}),u.exit().remove()}function x(o,m,l,w,_,c,b,u){var L=c.selectAll("text."+u).data(b);L.enter().append("text").classed(u,!0);var T=0,k={};return L.each(function(P,z){var I;if(P.axis.tickangle==="auto")I=e(w,m,l,P.xy,P.dxy);else{var D=(P.axis.tickangle+180)*Math.PI/180;I=e(w,m,l,P.xy,[Math.cos(D),Math.sin(D)])}z||(k={angle:I.angle,flip:I.flip});var R=(P.endAnchor?-1:1)*I.flip,O=A.select(this).attr({"text-anchor":R>0?"start":"end","data-notex":1}).call(g.font,P.font).text(P.text).call(a.convertToTspans,o),F=g.bBox(this);O.attr("transform",t(I.p[0],I.p[1])+r(I.angle)+t(P.axis.labelpadding*R,F.height*.3)),T=Math.max(T,F.width+P.axis.labelpadding)}),L.exit().remove(),k.maxExtent=T,k}function p(o,m,l,w,_,c,b,u){var L,T,k,P,z=n.aggNums(Math.min,null,l.a),I=n.aggNums(Math.max,null,l.a),D=n.aggNums(Math.min,null,l.b),R=n.aggNums(Math.max,null,l.b);L=.5*(z+I),T=D,k=l.ab2xy(L,T,!0),P=l.dxyda_rough(L,T),b.angle===void 0&&n.extendFlat(b,e(l,_,c,k,l.dxydb_rough(L,T))),d(o,m,l,w,k,P,l.aaxis,_,c,b,"a-title"),L=z,T=.5*(D+R),k=l.ab2xy(L,T,!0),P=l.dxydb_rough(L,T),u.angle===void 0&&n.extendFlat(u,e(l,_,c,k,l.dxyda_rough(L,T))),d(o,m,l,w,k,P,l.baxis,_,c,u,"b-title")}var v=h.LINE_SPACING,f=(1-h.MID_SHIFT)/v+1;function d(o,m,l,w,_,c,b,u,L,T,k){var P=[];b.title.text&&P.push(b.title.text);var z=m.selectAll("text."+k).data(P),I=T.maxExtent;z.enter().append("text").classed(k,!0),z.each(function(){var D=e(l,u,L,_,c);["start","both"].indexOf(b.showticklabels)===-1&&(I=0);var R=b.title.font.size;I+=R+b.title.offset;var O=T.angle+(T.flip<0?180:0),F=(O-D.angle+450)%360,N=F>90&&F<270,G=A.select(this);G.text(b.title.text).call(a.convertToTspans,o),N&&(I=(-a.lineCount(G)+f)*v*R-I),G.attr("transform",t(D.p[0],D.p[1])+r(D.angle)+t(0,I)).attr("text-anchor","middle").call(g.font,b.title.font)}),z.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(y,ee,te){var A=y("./constants"),g=y("../../lib/search").findBin,S=y("./compute_control_points"),M=y("./create_spline_evaluator"),e=y("./create_i_derivative_evaluator"),a=y("./create_j_derivative_evaluator");ee.exports=function(r){var t=r._a,h=r._b,s=t.length,i=h.length,x=r.aaxis,p=r.baxis,v=t[0],f=t[s-1],d=h[0],o=h[i-1],m=t[t.length-1]-t[0],l=h[h.length-1]-h[0],w=m*A.RELATIVE_CULL_TOLERANCE,_=l*A.RELATIVE_CULL_TOLERANCE;v-=w,f+=w,d-=_,o+=_,r.isVisible=function(c,b){return c>v&&c<f&&b>d&&b<o},r.isOccluded=function(c,b){return c<v||c>f||b<d||b>o},r.setScale=function(){var c=r._x,b=r._y,u=S(r._xctrl,r._yctrl,c,b,x.smoothing,p.smoothing);r._xctrl=u[0],r._yctrl=u[1],r.evalxy=M([r._xctrl,r._yctrl],s,i,x.smoothing,p.smoothing),r.dxydi=e([r._xctrl,r._yctrl],x.smoothing,p.smoothing),r.dxydj=a([r._xctrl,r._yctrl],x.smoothing,p.smoothing)},r.i2a=function(c){var b=Math.max(0,Math.floor(c[0]),s-2),u=c[0]-b;return(1-u)*t[b]+u*t[b+1]},r.j2b=function(c){var b=Math.max(0,Math.floor(c[1]),s-2),u=c[1]-b;return(1-u)*h[b]+u*h[b+1]},r.ij2ab=function(c){return[r.i2a(c[0]),r.j2b(c[1])]},r.a2i=function(c){var b=Math.max(0,Math.min(g(c,t),s-2)),u=t[b],L=t[b+1];return Math.max(0,Math.min(s-1,b+(c-u)/(L-u)))},r.b2j=function(c){var b=Math.max(0,Math.min(g(c,h),i-2)),u=h[b],L=h[b+1];return Math.max(0,Math.min(i-1,b+(c-u)/(L-u)))},r.ab2ij=function(c){return[r.a2i(c[0]),r.b2j(c[1])]},r.i2c=function(c,b){return r.evalxy([],c,b)},r.ab2xy=function(c,b,u){if(!u&&(c<t[0]||c>t[s-1]|b<h[0]||b>h[i-1]))return[!1,!1];var L=r.a2i(c),T=r.b2j(b),k=r.evalxy([],L,T);if(u){var P=0,z=0,I=[],D,R,O,F;c<t[0]?(D=0,R=0,P=(c-t[0])/(t[1]-t[0])):c>t[s-1]?(D=s-2,R=1,P=(c-t[s-1])/(t[s-1]-t[s-2])):(D=Math.max(0,Math.min(s-2,Math.floor(L))),R=L-D),b<h[0]?(O=0,F=0,z=(b-h[0])/(h[1]-h[0])):b>h[i-1]?(O=i-2,F=1,z=(b-h[i-1])/(h[i-1]-h[i-2])):(O=Math.max(0,Math.min(i-2,Math.floor(T))),F=T-O),P&&(r.dxydi(I,D,O,R,F),k[0]+=I[0]*P,k[1]+=I[1]*P),z&&(r.dxydj(I,D,O,R,F),k[0]+=I[0]*z,k[1]+=I[1]*z)}return k},r.c2p=function(c,b,u){return[b.c2p(c[0]),u.c2p(c[1])]},r.p2x=function(c,b,u){return[b.p2c(c[0]),u.p2c(c[1])]},r.dadi=function(c){var b=Math.max(0,Math.min(t.length-2,c));return t[b+1]-t[b]},r.dbdj=function(c){var b=Math.max(0,Math.min(h.length-2,c));return h[b+1]-h[b]},r.dxyda=function(c,b,u,L){var T=r.dxydi(null,c,b,u,L),k=r.dadi(c,u);return[T[0]/k,T[1]/k]},r.dxydb=function(c,b,u,L){var T=r.dxydj(null,c,b,u,L),k=r.dbdj(b,L);return[T[0]/k,T[1]/k]},r.dxyda_rough=function(c,b,u){var L=m*(u||.1),T=r.ab2xy(c+L,b,!0),k=r.ab2xy(c-L,b,!0);return[(T[0]-k[0])*.5/L,(T[1]-k[1])*.5/L]},r.dxydb_rough=function(c,b,u){var L=l*(u||.1),T=r.ab2xy(c,b+L,!0),k=r.ab2xy(c,b-L,!0);return[(T[0]-k[0])*.5/L,(T[1]-k[1])*.5/L]},r.dpdx=function(c){return c._m},r.dpdy=function(c){return c._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M,e){var a,n,r,t=[],h=[],s=S[0].length,i=S.length;function x(W,Y){var re=0,ue,j=0;return W>0&&(ue=S[Y][W-1])!==void 0&&(j++,re+=ue),W<s-1&&(ue=S[Y][W+1])!==void 0&&(j++,re+=ue),Y>0&&(ue=S[Y-1][W])!==void 0&&(j++,re+=ue),Y<i-1&&(ue=S[Y+1][W])!==void 0&&(j++,re+=ue),re/Math.max(1,j)}var p=0;for(a=0;a<s;a++)for(n=0;n<i;n++)S[n][a]===void 0&&(t.push(a),h.push(n),S[n][a]=x(a,n)),p=Math.max(p,Math.abs(S[n][a]));if(!t.length)return S;var v,f,d,o,m,l,w,_,c,b,u,L=1e-5,T=0,k=100,P=0,z=t.length;do{for(T=0,r=0;r<z;r++){a=t[r],n=h[r];var I=0,D=0,R,O,F,N,G,K;a===0?(G=Math.min(s-1,2),F=M[G],N=M[1],R=S[n][G],O=S[n][1],D+=O+(O-R)*(M[0]-N)/(N-F),I++):a===s-1&&(G=Math.max(0,s-3),F=M[G],N=M[s-2],R=S[n][G],O=S[n][s-2],D+=O+(O-R)*(M[s-1]-N)/(N-F),I++),(a===0||a===s-1)&&n>0&&n<i-1&&(v=e[n+1]-e[n],f=e[n]-e[n-1],D+=(f*S[n+1][a]+v*S[n-1][a])/(f+v),I++),n===0?(K=Math.min(i-1,2),F=e[K],N=e[1],R=S[K][a],O=S[1][a],D+=O+(O-R)*(e[0]-N)/(N-F),I++):n===i-1&&(K=Math.max(0,i-3),F=e[K],N=e[i-2],R=S[K][a],O=S[i-2][a],D+=O+(O-R)*(e[i-1]-N)/(N-F),I++),(n===0||n===i-1)&&a>0&&a<s-1&&(v=M[a+1]-M[a],f=M[a]-M[a-1],D+=(f*S[n][a+1]+v*S[n][a-1])/(f+v),I++),I?D/=I:(d=M[a+1]-M[a],o=M[a]-M[a-1],m=e[n+1]-e[n],l=e[n]-e[n-1],w=d*o*(d+o),_=m*l*(m+l),D=(w*(l*S[n+1][a]+m*S[n-1][a])+_*(o*S[n][a+1]+d*S[n][a-1]))/(_*(o+d)+w*(l+m))),c=D-S[n][a],b=c/p,T+=b*b,u=I?0:.85,S[n][a]+=c*(1+u)}T=Math.sqrt(T)}while(P++<k&&T>L);return A.log("Smoother converged to",T,"after",P,"iterations"),S}},{"../../lib":515}],724:[function(y,ee,te){var A=y("../../lib").isArray1D;ee.exports=function(S,M,e){var a=e("x"),n=a&&a.length,r=e("y"),t=r&&r.length;if(!n&&!t)return!1;if(M._cheater=!a,(!n||A(a))&&(!t||A(r))){var h=n?a.length:1/0;t&&(h=Math.min(h,r.length)),M.a&&M.a.length&&(h=Math.min(h,M.a.length)),M.b&&M.b.length&&(h=Math.min(h,M.b.length)),M._length=h}else M._length=null;return!0}},{"../../lib":515}],725:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../scattergeo/attributes"),S=y("../../components/colorscale/attributes"),M=y("../../plots/attributes"),e=y("../../components/color/attributes").defaultLine,a=y("../../lib/extend").extendFlat,n=g.marker.line;ee.exports=a({locations:{valType:"data_array",editType:"calc"},locationmode:g.locationmode,z:{valType:"data_array",editType:"calc"},geojson:a({},g.geojson,{}),featureidkey:g.featureidkey,text:a({},g.text,{}),hovertext:a({},g.hovertext,{}),marker:{line:{color:a({},n.color,{dflt:e}),width:a({},n.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:g.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:g.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:a({},M.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:A(),showlegend:a({},M.showlegend,{dflt:!1})},S("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../constants/numerical").BADNUM,S=y("../../components/colorscale/calc"),M=y("../scatter/arrays_to_calcdata"),e=y("../scatter/calc_selection");function a(n){return n&&typeof n=="string"}ee.exports=function(r,t){var h=t._length,s=new Array(h),i;t.geojson?i=function(d){return a(d)||A(d)}:i=a;for(var x=0;x<h;x++){var p=s[x]={},v=t.locations[x],f=t.z[x];i(v)&&A(f)?(p.loc=v,p.z=f):(p.loc=null,p.z=g),p.index=x}return M(s,t),S(r,t,{vals:t.z,containerStr:"",cLetter:"z"}),e(s,t),s}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/colorscale/defaults"),S=y("./attributes");ee.exports=function(e,a,n,r){function t(f,d){return A.coerce(e,a,S,f,d)}var h=t("locations"),s=t("z");if(!(h&&h.length&&A.isArrayOrTypedArray(s)&&s.length)){a.visible=!1;return}a._length=Math.min(h.length,s.length);var i=t("geojson"),x;(typeof i=="string"&&i!==""||A.isPlainObject(i))&&(x="geojson-id");var p=t("locationmode",x);p==="geojson-id"&&t("featureidkey"),t("text"),t("hovertext"),t("hovertemplate");var v=t("marker.line.width");v&&t("marker.line.color"),t("marker.opacity"),g(e,a,r,t,{prefix:"",cLetter:"z"}),A.coerceSelectionMarkerOpacity(a,t)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(y,ee,te){ee.exports=function(g,S,M,e,a){g.location=S.location,g.z=S.z;var n=e[a];return n.fIn&&n.fIn.properties&&(g.properties=n.fIn.properties),g.ct=n.ct,g}},{}],729:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("./attributes"),S=y("../../lib").fillText;ee.exports=function(a,n,r){var t=a.cd,h=t[0].trace,s=a.subplot,i,x,p,v,f=[n,r],d=[n+360,r];for(x=0;x<t.length;x++)if(i=t[x],v=!1,i._polygons){for(p=0;p<i._polygons.length;p++)i._polygons[p].contains(f)&&(v=!v),i._polygons[p].contains(d)&&(v=!v);if(v)break}if(!(!v||!i))return a.x0=a.x1=a.xa.c2p(i.ct),a.y0=a.y1=a.ya.c2p(i.ct),a.index=i.index,a.location=i.loc,a.z=i.z,a.zLabel=A.tickText(s.mockAxis,s.mockAxis.c2l(i.z),"hover").text,a.hovertemplate=i.hovertemplate,M(a,h,i),[a]};function M(e,a,n){if(!a.hovertemplate){var r=n.hi||a.hoverinfo,t=String(n.loc),h=r==="all"?g.hoverinfo.flags:r.split("+"),s=h.indexOf("name")!==-1,i=h.indexOf("location")!==-1,x=h.indexOf("z")!==-1,p=h.indexOf("text")!==-1,v=!s&&i,f=[];v?e.nameOverride=t:(s&&(e.nameOverride=a.name),i&&f.push(t)),x&&f.push(e.zLabel),p&&S(n,a,f),e.extraText=f.join("<br>")}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../heatmap/colorbar"),calc:y("./calc"),calcGeoJSON:y("./plot").calcGeoJSON,plot:y("./plot").plot,style:y("./style").style,styleOnSelect:y("./style").styleOnSelect,hoverPoints:y("./hover"),eventData:y("./event_data"),selectPoints:y("./select"),moduleType:"trace",name:"choropleth",basePlotModule:y("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../lib/geo_location_utils"),M=y("../../lib/topojson_utils").getTopojsonFeatures,e=y("../../plots/cartesian/autorange").findExtremes,a=y("./style").style;function n(t,h,s){var i=h.layers.backplot.select(".choroplethlayer");g.makeTraceGroups(i,s,"trace choropleth").each(function(x){var p=A.select(this),v=p.selectAll("path.choroplethlocation").data(g.identity);v.enter().append("path").classed("choroplethlocation",!0),v.exit().remove(),a(t,x)})}function r(t,h){for(var s=t[0].trace,i=h[s.geo],x=i._subplot,p=s.locationmode,v=s._length,f=p==="geojson-id"?S.extractTraceFeature(t):M(s,x.topojson),d=[],o=[],m=0;m<v;m++){var l=t[m],w=p==="geojson-id"?l.fOut:S.locationToFeature(p,l.loc,f);if(w){l.geojson=w,l.ct=w.properties.ct,l._polygons=S.feature2polygons(w);var _=S.computeBbox(w);d.push(_[0],_[2]),o.push(_[1],_[3])}else l.geojson=null}if(i.fitbounds==="geojson"&&p==="geojson-id"){var c=S.computeBbox(S.getTraceGeojson(s));d=[c[0],c[2]],o=[c[1],c[3]]}var b={padded:!0};s._extremes.lon=e(i.lonaxis._ax,d,b),s._extremes.lat=e(i.lataxis._ax,o,b)}ee.exports={calcGeoJSON:r,plot:n}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(y,ee,te){ee.exports=function(g,S){var M=g.cd,e=g.xaxis,a=g.yaxis,n=[],r,t,h,s,i;if(S===!1)for(r=0;r<M.length;r++)M[r].selected=0;else for(r=0;r<M.length;r++)t=M[r],h=t.ct,h&&(s=e.c2p(h),i=a.c2p(h),S.contains([s,i],null,r,g)?(n.push({pointNumber:r,lon:h[0],lat:h[1]}),t.selected=1):t.selected=0);return n}},{}],733:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/color"),S=y("../../components/drawing"),M=y("../../components/colorscale");function e(r,t){t&&a(r,t)}function a(r,t){var h=t[0].trace,s=t[0].node3,i=s.selectAll(".choroplethlocation"),x=h.marker||{},p=x.line||{},v=M.makeColorScaleFuncFromTrace(h);i.each(function(f){A.select(this).attr("fill",v(f.z)).call(g.stroke,f.mlc||p.color).call(S.dashLine,"",f.mlw||p.width||0).style("opacity",x.opacity)}),S.selectedPointStyle(i,h)}function n(r,t){var h=t[0].node3,s=t[0].trace;s.selectedpoints?S.selectedPointStyle(h.selectAll(".choroplethlocation"),s):a(r,t)}ee.exports={style:e,styleOnSelect:n}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(y,ee,te){var A=y("../choropleth/attributes"),g=y("../../components/colorscale/attributes"),S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../../plots/attributes"),e=y("../../lib/extend").extendFlat;ee.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},A.featureidkey,{}),below:{valType:"string",editType:"plot"},text:A.text,hovertext:A.hovertext,marker:{line:{color:e({},A.marker.line.color,{editType:"plot"}),width:e({},A.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},A.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},A.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},A.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:A.hoverinfo,hovertemplate:S({},{keys:["properties"]}),showlegend:e({},M.showlegend,{dflt:!1})},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../components/colorscale"),M=y("../../components/drawing"),e=y("../../lib/geojson_utils").makeBlank,a=y("../../lib/geo_location_utils");function n(t){var h=t[0].trace,s=h.visible===!0&&h._length!==0,i={layout:{visibility:"none"},paint:{}},x={layout:{visibility:"none"},paint:{}},p=h._opts={fill:i,line:x,geojson:e()};if(!s)return p;var v=a.extractTraceFeature(t);if(!v)return p;var f=S.makeColorScaleFuncFromTrace(h),d=h.marker,o=d.line||{},m;g.isArrayOrTypedArray(d.opacity)&&(m=function(T){var k=T.mo;return A(k)?+g.constrain(k,0,1):0});var l;g.isArrayOrTypedArray(o.color)&&(l=function(T){return T.mlc});var w;g.isArrayOrTypedArray(o.width)&&(w=function(T){return T.mlw});for(var _=0;_<t.length;_++){var c=t[_],b=c.fOut;if(b){var u=b.properties;u.fc=f(c.z),m&&(u.mo=m(c)),l&&(u.mlc=l(c)),w&&(u.mlw=w(c)),c.ct=u.ct,c._polygons=a.feature2polygons(b)}}var L=m?{type:"identity",property:"mo"}:d.opacity;return g.extendFlat(i.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),g.extendFlat(x.paint,{"line-color":l?{type:"identity",property:"mlc"}:o.color,"line-width":w?{type:"identity",property:"mlw"}:o.width,"line-opacity":L}),i.layout.visibility="visible",x.layout.visibility="visible",p.geojson={type:"FeatureCollection",features:v},r(t),p}function r(t){var h=t[0].trace,s=h._opts,i;if(h.selectedpoints){for(var x=M.makeSelectedPointStyleFns(h),p=0;p<t.length;p++){var v=t[p];v.fOut&&(v.fOut.properties.mo2=x.selectedOpacityFn(v))}i={type:"identity",property:"mo2"}}else i=g.isArrayOrTypedArray(h.marker.opacity)?{type:"identity",property:"mo"}:h.marker.opacity;return g.extendFlat(s.fill.paint,{"fill-opacity":i}),g.extendFlat(s.line.paint,{"line-opacity":i}),s}ee.exports={convert:n,convertOnSelect:r}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/colorscale/defaults"),S=y("./attributes");ee.exports=function(e,a,n,r){function t(p,v){return A.coerce(e,a,S,p,v)}var h=t("locations"),s=t("z"),i=t("geojson");if(!A.isArrayOrTypedArray(h)||!h.length||!A.isArrayOrTypedArray(s)||!s.length||!(typeof i=="string"&&i!==""||A.isPlainObject(i))){a.visible=!1;return}t("featureidkey"),a._length=Math.min(h.length,s.length),t("below"),t("text"),t("hovertext"),t("hovertemplate");var x=t("marker.line.width");x&&t("marker.line.color"),t("marker.opacity"),g(e,a,r,t,{prefix:"",cLetter:"z"}),A.coerceSelectionMarkerOpacity(a,t)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../heatmap/colorbar"),calc:y("../choropleth/calc"),plot:y("./plot"),hoverPoints:y("../choropleth/hover"),eventData:y("../choropleth/event_data"),selectPoints:y("../choropleth/select"),styleOnSelect:function(A,g){if(g){var S=g[0].trace;S._glTrace.updateOnSelect(g)}},getBelow:function(A,g){for(var S=g.getMapLayers(),M=S.length-2;M>=0;M--){var e=S[M].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var a=M+1;a<S.length;a++)if(e=S[a].id,typeof e=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:y("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(y,ee,te){var A=y("./convert").convert,g=y("./convert").convertOnSelect,S=y("../../plots/mapbox/constants").traceLayerPrefix;function M(a,n){this.type="choroplethmapbox",this.subplot=a,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",S+n+"-fill"],["line",S+n+"-line"]],this.below=null}var e=M.prototype;e.update=function(a){this._update(A(a)),a[0].trace._glTrace=this},e.updateOnSelect=function(a){this._update(g(a))},e._update=function(a){var n=this.subplot,r=this.layerList,t=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(a.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(a,t),this.below=t);for(var h=0;h<r.length;h++){var s=r[h],i=s[0],x=s[1],p=a[i];n.setOptions(x,"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&n.setOptions(x,"setPaintProperty",p.paint)}},e._addLayers=function(a,n){for(var r=this.subplot,t=this.layerList,h=this.sourceId,s=0;s<t.length;s++){var i=t[s],x=i[0],p=a[x];r.addLayer({type:x,id:i[1],source:h,layout:p.layout,paint:p.paint},n)}},e._removeLayers=function(){for(var a=this.subplot.map,n=this.layerList,r=n.length-1;r>=0;r--)a.removeLayer(n[r][1])},e.dispose=function(){var a=this.subplot.map;this._removeLayers(),a.removeSource(this.sourceId)},ee.exports=function(n,r){var t=r[0].trace,h=new M(n,t.uid),s=h.sourceId,i=A(r),x=h.below=n.belowLookup["trace-"+t.uid];return n.map.addSource(s,{type:"geojson",data:i.geojson}),h._addLayers(i,x),r[0].trace._glTrace=h,h}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(y,ee,te){var A=y("../../components/colorscale/attributes"),g=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../mesh3d/attributes"),e=y("../../plots/attributes"),a=y("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:S({editType:"calc"},{keys:["norm"]}),uhoverformat:g("u",1),vhoverformat:g("v",1),whoverformat:g("w",1),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),showlegend:a({},e.showlegend,{dflt:!1})};a(n,A("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var r=["opacity","lightposition","lighting"];r.forEach(function(t){n[t]=M[t]}),n.hoverinfo=a({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,ee.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(y,ee,te){var A=y("../../components/colorscale/calc");ee.exports=function(S,M){for(var e=M.u,a=M.v,n=M.w,r=Math.min(M.x.length,M.y.length,M.z.length,e.length,a.length,n.length),t=-1/0,h=1/0,s=0;s<r;s++){var i=e[s],x=a[s],p=n[s],v=Math.sqrt(i*i+x*x+p*p);t=Math.max(t,v),h=Math.min(h,v)}M._len=r,M._normMax=t,A(S,M,{vals:[h,t],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_cone3d,g=y("../../../stackgl_modules").gl_cone3d.createConeMesh,S=y("../../lib").simpleMap,M=y("../../lib/gl_format_color").parseColorScale,e=y("../../components/colorscale").extractOpts,a=y("../../plots/gl3d/zip3");function n(p,v){this.scene=p,this.uid=v,this.mesh=null,this.data=null}var r=n.prototype;r.handlePick=function(p){if(p.object===this.mesh){var v=p.index=p.data.index,f=this.data.x[v],d=this.data.y[v],o=this.data.z[v],m=this.data.u[v],l=this.data.v[v],w=this.data.w[v];p.traceCoordinate=[f,d,o,m,l,w,Math.sqrt(m*m+l*l+w*w)];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[v]!==void 0?p.textLabel=_[v]:_&&(p.textLabel=_),!0}};var t={xaxis:0,yaxis:1,zaxis:2},h={tip:1,tail:0,cm:.25,center:.5},s={tip:1,tail:1,cm:.75,center:.5};function i(p,v){var f=p.fullSceneLayout,d=p.dataScale,o={};function m(c,b){var u=f[b],L=d[t[b]];return S(c,function(T){return u.d2l(T)*L})}o.vectors=a(m(v.u,"xaxis"),m(v.v,"yaxis"),m(v.w,"zaxis"),v._len),o.positions=a(m(v.x,"xaxis"),m(v.y,"yaxis"),m(v.z,"zaxis"),v._len);var l=e(v);o.colormap=M(v),o.vertexIntensityBounds=[l.min/v._normMax,l.max/v._normMax],o.coneOffset=h[v.anchor],v.sizemode==="scaled"?o.coneSize=v.sizeref||.5:o.coneSize=v.sizeref&&v._normMax?v.sizeref/v._normMax:.5;var w=A(o),_=v.lightposition;return w.lightPosition=[_.x,_.y,_.z],w.ambient=v.lighting.ambient,w.diffuse=v.lighting.diffuse,w.specular=v.lighting.specular,w.roughness=v.lighting.roughness,w.fresnel=v.lighting.fresnel,w.opacity=v.opacity,v._pad=s[v.anchor]*w.vectorScale*w.coneScale*v._normMax,w}r.update=function(p){this.data=p;var v=i(this.scene,p);this.mesh.update(v)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function x(p,v){var f=p.glplot.gl,d=i(p,v),o=g(f,d),m=new n(p,v.uid);return m.mesh=o,m.data=v,o._trace=m,p.glplot.add(o),m}ee.exports=x},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/colorscale/defaults"),S=y("./attributes");ee.exports=function(e,a,n,r){function t(f,d){return A.coerce(e,a,S,f,d)}var h=t("u"),s=t("v"),i=t("w"),x=t("x"),p=t("y"),v=t("z");if(!h||!h.length||!s||!s.length||!i||!i.length||!x||!x.length||!p||!p.length||!v||!v.length){a.visible=!1;return}t("sizeref"),t("sizemode"),t("anchor"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),g(e,a,r,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(y,ee,te){ee.exports={moduleType:"trace",name:"cone",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:y("./calc"),plot:y("./convert"),eventData:function(A,g){return A.norm=g.traceCoordinate[6],A},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(y,ee,te){var A=y("../heatmap/attributes"),g=y("../scatter/attributes"),S=y("../../plots/cartesian/axis_format_attributes"),M=S.axisHoverFormat,e=S.descriptionOnlyNumbers,a=y("../../components/colorscale/attributes"),n=y("../../components/drawing/attributes").dash,r=y("../../plots/font_attributes"),t=y("../../lib/extend").extendFlat,h=y("../../constants/filter_ops"),s=h.COMPARISON_OPS2,i=h.INTERVAL_OPS,x=g.line;ee.exports=t({z:A.z,x:A.x,x0:A.x0,dx:A.dx,y:A.y,y0:A.y0,dy:A.dy,xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,text:A.text,hovertext:A.hovertext,transpose:A.transpose,xtype:A.xtype,ytype:A.ytype,xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:A.hovertemplate,texttemplate:t({},A.texttemplate,{}),textfont:t({},A.textfont,{}),hoverongaps:A.hoverongaps,connectgaps:t({},A.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:r({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(s).concat(i),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:t({},x.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:n,smoothing:t({},x.smoothing,{}),editType:"plot"}},a("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(y,ee,te){var A=y("../../components/colorscale"),g=y("../heatmap/calc"),S=y("./set_contours"),M=y("./end_plus");ee.exports=function(a,n){var r=g(a,n),t=r[0].z;S(n,t);var h=n.contours,s=A.extractOpts(n),i;if(h.coloring==="heatmap"&&s.auto&&n.autocontour===!1){var x=h.start,p=M(h),v=h.size||1,f=Math.floor((p-x)/v)+1;isFinite(v)||(v=1,f=1);var d=x-v/2,o=d+f*v;i=[d,o]}else i=t;return A.calc(a,n,{vals:i,cLetter:"z"}),r}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(y,ee,te){ee.exports=function(A,g){var S=A[0],M=S.z,e;switch(g.type){case"levels":var a=Math.min(M[0][0],M[0][1]);for(e=0;e<A.length;e++){var n=A[e];n.prefixBoundary=!n.edgepaths.length&&(a>n.level||n.starts.length&&a===n.level)}break;case"constraint":if(S.prefixBoundary=!1,S.edgepaths.length)return;var r=S.x.length,t=S.y.length,h=-1/0,s=1/0;for(e=0;e<t;e++)s=Math.min(s,M[e][0]),s=Math.min(s,M[e][r-1]),h=Math.max(h,M[e][0]),h=Math.max(h,M[e][r-1]);for(e=1;e<r-1;e++)s=Math.min(s,M[0][e]),s=Math.min(s,M[t-1][e]),h=Math.max(h,M[0][e]),h=Math.max(h,M[t-1][e]);var i=g.value,x,p;switch(g._operation){case">":i>h&&(S.prefixBoundary=!0);break;case"<":(i<s||S.starts.length&&i===s)&&(S.prefixBoundary=!0);break;case"[]":x=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),(p<s||x>h||S.starts.length&&p===s)&&(S.prefixBoundary=!0);break;case"][":x=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),x<s&&p>h&&(S.prefixBoundary=!0);break}break}}},{}],747:[function(y,ee,te){var A=y("../../components/colorscale"),g=y("./make_color_map"),S=y("./end_plus");function M(e,a,n){var r=a.contours,t=a.line,h=r.size||1,s=r.coloring,i=g(a,{isColorbar:!0});if(s==="heatmap"){var x=A.extractOpts(a);n._fillgradient=x.reversescale?A.flipScale(x.colorscale):x.colorscale,n._zrange=[x.min,x.max]}else s==="fill"&&(n._fillcolor=i);n._line={color:s==="lines"?i:t.color,width:r.showlines!==!1?t.width:0,dash:t.dash},n._levels={start:r.start,end:S(r),size:h}}ee.exports={min:"zmin",max:"zmax",calc:M}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(y,ee,te){ee.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("./label_defaults"),S=y("../../components/color"),M=S.addOpacity,e=S.opacity,a=y("../../constants/filter_ops"),n=a.CONSTRAINT_REDUCTION,r=a.COMPARISON_OPS2;ee.exports=function(s,i,x,p,v,f){var d=i.contours,o,m,l,w=x("contours.operation");if(d._operation=n[w],t(x,d),w==="="?o=d.showlines=!0:(o=x("contours.showlines"),l=x("fillcolor",M((s.line||{}).color||v,.5))),o){var _=l&&e(l)?M(i.fillcolor,1):v;m=x("line.color",_),x("line.width",2),x("line.dash")}x("line.smoothing"),g(x,p,m,f)};function t(h,s){var i;r.indexOf(s.operation)===-1?(h("contours.value",[0,1]),Array.isArray(s.value)?s.value.length>2?s.value=s.value.slice(2):s.length===0?s.value=[0,1]:s.length<2?(i=parseFloat(s.value[0]),s.value=[i,i+1]):s.value=[parseFloat(s.value[0]),parseFloat(s.value[1])]:A(s.value)&&(i=parseFloat(s.value),s.value=[i,i+1])):(h("contours.value",0),A(s.value)||(Array.isArray(s.value)?s.value=parseFloat(s.value[0]):s.value=0))}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(y,ee,te){var A=y("../../constants/filter_ops"),g=y("fast-isnumeric");ee.exports={"[]":M("[]"),"][":M("]["),">":e(">"),"<":e("<"),"=":e("=")};function S(a,n){var r=Array.isArray(n),t;function h(s){return g(s)?+s:null}return A.COMPARISON_OPS2.indexOf(a)!==-1?t=h(r?n[0]:n):A.INTERVAL_OPS.indexOf(a)!==-1?t=r?[h(n[0]),h(n[1])]:[h(n),h(n)]:A.SET_OPS.indexOf(a)!==-1&&(t=r?n.map(h):[h(n)]),t}function M(a){return function(n){n=S(a,n);var r=Math.min(n[0],n[1]),t=Math.max(n[0],n[1]);return{start:r,end:t,size:t-r}}}function e(a){return function(n){return n=S(a,n),{start:n,end:1/0,size:1/0}}}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(y,ee,te){ee.exports=function(g,S,M,e){var a=e("contours.start"),n=e("contours.end"),r=a===!1||n===!1,t=M("contours.size"),h;r?h=S.autocontour=!0:h=M("autocontour",!1),(h||!t)&&M("ncontours")}},{}],752:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){var e,a,n,r=function(s){return s.reverse()},t=function(s){return s};switch(M){case"=":case"<":return S;case">":for(S.length!==1&&A.warn("Contour data invalid for the specified inequality operation."),a=S[0],e=0;e<a.edgepaths.length;e++)a.edgepaths[e]=r(a.edgepaths[e]);for(e=0;e<a.paths.length;e++)a.paths[e]=r(a.paths[e]);for(e=0;e<a.starts.length;e++)a.starts[e]=r(a.starts[e]);return S;case"][":var h=r;r=t,t=h;case"[]":for(S.length!==2&&A.warn("Contour data invalid for the specified inequality range operation."),a=g(S[0]),n=g(S[1]),e=0;e<a.edgepaths.length;e++)a.edgepaths[e]=r(a.edgepaths[e]);for(e=0;e<a.paths.length;e++)a.paths[e]=r(a.paths[e]);for(e=0;e<a.starts.length;e++)a.starts[e]=r(a.starts[e]);for(;n.edgepaths.length;)a.edgepaths.push(t(n.edgepaths.shift()));for(;n.paths.length;)a.paths.push(t(n.paths.shift()));for(;n.starts.length;)a.starts.push(t(n.starts.shift()));return[a]}};function g(S){return A.extendFlat({},S,{edgepaths:A.extendDeep([],S.edgepaths),paths:A.extendDeep([],S.paths),starts:A.extendDeep([],S.starts)})}},{"../../lib":515}],753:[function(y,ee,te){var A=y("../../lib"),g=y("../heatmap/xyz_defaults"),S=y("../scatter/period_defaults"),M=y("./constraint_defaults"),e=y("./contours_defaults"),a=y("./style_defaults"),n=y("../heatmap/label_defaults"),r=y("./attributes");ee.exports=function(h,s,i,x){function p(o,m){return A.coerce(h,s,r,o,m)}function v(o){return A.coerce2(h,s,r,o)}var f=g(h,s,p,x);if(!f){s.visible=!1;return}S(h,s,x,p),p("xhoverformat"),p("yhoverformat"),p("text"),p("hovertext"),p("hoverongaps"),p("hovertemplate");var d=p("contours.type")==="constraint";p("connectgaps",A.isArray1D(s.z)),d?M(h,s,p,x,i):(e(h,s,p,v),a(h,s,p,x)),s.contours&&s.contours.coloring==="heatmap"&&n(p,x)}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(y,ee,te){var A=y("../../lib"),g=y("./constraint_mapping"),S=y("./end_plus");ee.exports=function(e,a,n){for(var r=e.type==="constraint"?g[e._operation](e.value):e,t=r.size,h=[],s=S(r),i=n.trace._carpetTrace,x=i?{xaxis:i.aaxis,yaxis:i.baxis,x:n.a,y:n.b}:{xaxis:a.xaxis,yaxis:a.yaxis,x:n.x,y:n.y},p=r.start;p<s;p+=t)if(h.push(A.extendFlat({level:p,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},x)),h.length>1e3){A.warn("Too many contours, clipping at 1000",e);break}return h}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(y,ee,te){ee.exports=function(g){return g.end+g.size/1e6}},{}],756:[function(y,ee,te){var A=y("../../lib"),g=y("./constants");ee.exports=function(t,h,s){var i,x,p,v,f;for(h=h||.01,s=s||.01,p=0;p<t.length;p++){for(v=t[p],f=0;f<v.starts.length;f++)x=v.starts[f],e(v,x,"edge",h,s);for(i=0;Object.keys(v.crossings).length&&i<1e4;)i++,x=Object.keys(v.crossings)[0].split(",").map(Number),e(v,x,void 0,h,s);i===1e4&&A.log("Infinite loop in contour?")}};function S(r,t,h,s){return Math.abs(r[0]-t[0])<h&&Math.abs(r[1]-t[1])<s}function M(r,t){var h=r[2]-t[2],s=r[3]-t[3];return Math.sqrt(h*h+s*s)}function e(r,t,h,s,i){var x=t.join(","),p=r.crossings[x],v=a(p,h,t),f=[n(r,t,[-v[0],-v[1]])],d=r.z.length,o=r.z[0].length,m=t.slice(),l=v.slice(),w;for(w=0;w<1e4;w++){if(p>20?(p=g.CHOOSESADDLE[p][(v[0]||v[1])<0?0:1],r.crossings[x]=g.SADDLEREMAINDER[p]):delete r.crossings[x],v=g.NEWDELTA[p],!v){A.log("Found bad marching index:",p,t,r.level);break}f.push(n(r,t,v)),t[0]+=v[0],t[1]+=v[1],x=t.join(","),S(f[f.length-1],f[f.length-2],s,i)&&f.pop();var _=v[0]&&(t[0]<0||t[0]>o-2)||v[1]&&(t[1]<0||t[1]>d-2),c=t[0]===m[0]&&t[1]===m[1]&&v[0]===l[0]&&v[1]===l[1];if(c||h&&_)break;p=r.crossings[x]}w===1e4&&A.log("Infinite loop in contour?");var b=S(f[0],f[f.length-1],s,i),u=0,L=.2*r.smoothing,T=[],k=0,P,z,I,D,R,O,F,N,G,K,W;for(w=1;w<f.length;w++)F=M(f[w],f[w-1]),u+=F,T.push(F);var Y=u/T.length*L;function re(q){return f[q%f.length]}for(w=f.length-2;w>=k;w--)if(P=T[w],P<Y){for(I=0,z=w-1;z>=k&&P+T[z]<Y;z--)P+=T[z];if(b&&w===f.length-2)for(I=0;I<z&&P+T[I]<Y;I++)P+=T[I];R=w-z+I+1,O=Math.floor((w+z+I+2)/2),!b&&w===f.length-2?D=f[f.length-1]:!b&&z===-1?D=f[0]:R%2?D=re(O):D=[(re(O)[0]+re(O+1)[0])/2,(re(O)[1]+re(O+1)[1])/2],f.splice(z+1,w-z+1,D),w=z+1,I&&(k=I),b&&(w===f.length-2?f[I]=f[f.length-1]:w===0&&(f[f.length-1]=f[0]))}for(f.splice(0,k),w=0;w<f.length;w++)f[w].length=2;if(!(f.length<2))if(b)f.pop(),r.paths.push(f);else{h||A.log("Unclosed interior contour?",r.level,m.join(","),f.join("L"));var ue=!1;for(N=0;N<r.edgepaths.length;N++)if(K=r.edgepaths[N],!ue&&S(K[0],f[f.length-1],s,i)){f.pop(),ue=!0;var j=!1;for(G=0;G<r.edgepaths.length;G++)if(W=r.edgepaths[G],S(W[W.length-1],f[0],s,i)){j=!0,f.shift(),r.edgepaths.splice(N,1),G===N?r.paths.push(f.concat(W)):(G>N&&G--,r.edgepaths[G]=W.concat(f,K));break}j||(r.edgepaths[N]=f.concat(K))}for(N=0;N<r.edgepaths.length&&!ue;N++)K=r.edgepaths[N],S(K[K.length-1],f[0],s,i)&&(f.shift(),r.edgepaths[N]=K.concat(f),ue=!0);ue||r.edgepaths.push(f)}}function a(r,t,h){var s=0,i=0;return r>20&&t?r===208||r===1114?s=h[0]===0?1:-1:i=h[1]===0?1:-1:g.BOTTOMSTART.indexOf(r)!==-1?i=1:g.LEFTSTART.indexOf(r)!==-1?s=1:g.TOPSTART.indexOf(r)!==-1?i=-1:s=-1,[s,i]}function n(r,t,h){var s=t[0]+Math.max(h[0],0),i=t[1]+Math.max(h[1],0),x=r.z[i][s],p=r.xaxis,v=r.yaxis;if(h[1]){var f=(r.level-x)/(r.z[i][s+1]-x),d=(f!==1?(1-f)*p.c2l(r.x[s]):0)+(f!==0?f*p.c2l(r.x[s+1]):0);return[p.c2p(p.l2c(d),!0),v.c2p(r.y[i],!0),s+f,i]}else{var o=(r.level-x)/(r.z[i+1][s]-x),m=(o!==1?(1-o)*v.c2l(r.y[i]):0)+(o!==0?o*v.c2l(r.y[i+1]):0);return[p.c2p(r.x[s],!0),v.c2p(v.l2c(m),!0),s,i+o]}}},{"../../lib":515,"./constants":748}],757:[function(y,ee,te){var A=y("../../components/color"),g=y("../heatmap/hover");ee.exports=function(M,e,a,n,r){r||(r={}),r.isContour=!0;var t=g(M,e,a,n,r);return t&&t.forEach(function(h){var s=h.trace;s.contours.type==="constraint"&&(s.fillcolor&&A.opacity(s.fillcolor)?h.color=A.addOpacity(s.fillcolor,1):s.contours.showlines&&A.opacity(s.line.color)&&(h.color=A.addOpacity(s.line.color,1)))}),t}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot").plot,style:y("./style"),colorbar:y("./colorbar"),hoverPoints:y("./hover"),moduleType:"trace",name:"contour",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M,e,a){a||(a={});var n=S("contours.showlabels");if(n){var r=M.font;A.coerceFont(S,"contours.labelfont",{family:r.family,size:r.size,color:e}),S("contours.labelformat")}a.hasHover!==!1&&S("zhoverformat")}},{"../../lib":515}],760:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/colorscale"),S=y("./end_plus");ee.exports=function(e){var a=e.contours,n=a.start,r=S(a),t=a.size||1,h=Math.floor((r-n)/t)+1,s=a.coloring==="lines"?0:1,i=g.extractOpts(e);isFinite(t)||(t=1,h=1);var x=i.reversescale?g.flipScale(i.colorscale):i.colorscale,p=x.length,v=new Array(p),f=new Array(p),d,o;if(a.coloring==="heatmap"){var m=i.min,l=i.max;for(o=0;o<p;o++)d=x[o],v[o]=d[0]*(l-m)+m,f[o]=d[1];var w=A.extent([m,l,a.start,a.start+t*(h-1)]),_=w[m<l?0:1],c=w[m<l?1:0];_!==m&&(v.splice(0,0,_),f.splice(0,0,f[0])),c!==l&&(v.push(c),f.push(f[f.length-1]))}else for(o=0;o<p;o++)d=x[o],v[o]=(d[0]*(h+s-1)-s/2)*t+n,f[o]=d[1];return g.makeColorScaleFunc({domain:v,range:f},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(y,ee,te){var A=y("./constants");ee.exports=function(M){var e=M[0].z,a=e.length,n=e[0].length,r=a===2||n===2,t,h,s,i,x,p,v,f,d;for(h=0;h<a-1;h++)for(i=[],h===0&&(i=i.concat(A.BOTTOMSTART)),h===a-2&&(i=i.concat(A.TOPSTART)),t=0;t<n-1;t++)for(s=i.slice(),t===0&&(s=s.concat(A.LEFTSTART)),t===n-2&&(s=s.concat(A.RIGHTSTART)),x=t+","+h,p=[[e[h][t],e[h][t+1]],[e[h+1][t],e[h+1][t+1]]],d=0;d<M.length;d++)f=M[d],v=g(f.level,p),v&&(f.crossings[x]=v,s.indexOf(v)!==-1&&(f.starts.push([t,h]),r&&s.indexOf(v,s.indexOf(v)+1)!==-1&&f.starts.push([t,h])))};function g(S,M){var e=(M[0][0]>S?0:1)+(M[0][1]>S?0:2)+(M[1][1]>S?0:4)+(M[1][0]>S?0:8);if(e===5||e===10){var a=(M[0][0]+M[0][1]+M[1][0]+M[1][1])/4;return S>a?e===5?713:1114:e===5?104:208}return e===15?0:e}},{"./constants":748}],762:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../components/drawing"),M=y("../../components/colorscale"),e=y("../../lib/svg_text_utils"),a=y("../../plots/cartesian/axes"),n=y("../../plots/cartesian/set_convert"),r=y("../heatmap/plot"),t=y("./make_crossings"),h=y("./find_all_paths"),s=y("./empty_pathinfo"),i=y("./convert_to_constraints"),x=y("./close_boundaries"),p=y("./constants"),v=p.LABELOPTIMIZER;te.plot=function(b,u,L,T){var k=u.xaxis,P=u.yaxis;g.makeTraceGroups(T,L,"contour").each(function(z){var I=A.select(this),D=z[0],R=D.trace,O=D.x,F=D.y,N=R.contours,G=s(N,u,D),K=g.ensureSingle(I,"g","heatmapcoloring"),W=[];N.coloring==="heatmap"&&(W=[z]),r(b,u,W,K),t(G),h(G);var Y=k.c2p(O[0],!0),re=k.c2p(O[O.length-1],!0),ue=P.c2p(F[0],!0),j=P.c2p(F[F.length-1],!0),q=[[Y,j],[re,j],[re,ue],[Y,ue]],H=G;N.type==="constraint"&&(H=i(G,N._operation)),f(I,q,N),d(I,H,q,N),m(I,G,b,D,N),w(I,u,b,D,q)})};function f(c,b,u){var L=g.ensureSingle(c,"g","contourbg"),T=L.selectAll("path").data(u.coloring==="fill"?[0]:[]);T.enter().append("path"),T.exit().remove(),T.attr("d","M"+b.join("L")+"Z").style("stroke","none")}function d(c,b,u,L){var T=L.coloring==="fill"||L.type==="constraint"&&L._operation!=="=",k="M"+u.join("L")+"Z";T&&x(b,L);var P=g.ensureSingle(c,"g","contourfill"),z=P.selectAll("path").data(T?b:[]);z.enter().append("path"),z.exit().remove(),z.each(function(I){var D=(I.prefixBoundary?k:"")+o(I,u);D?A.select(this).attr("d",D).style("stroke","none"):A.select(this).remove()})}function o(c,b){var u="",L=0,T=c.edgepaths.map(function(Y,re){return re}),k=!0,P,z,I,D,R,O;function F(Y){return Math.abs(Y[1]-b[0][1])<.01}function N(Y){return Math.abs(Y[1]-b[2][1])<.01}function G(Y){return Math.abs(Y[0]-b[0][0])<.01}function K(Y){return Math.abs(Y[0]-b[2][0])<.01}for(;T.length;){for(O=S.smoothopen(c.edgepaths[L],c.smoothing),u+=k?O:O.replace(/^M/,"L"),T.splice(T.indexOf(L),1),P=c.edgepaths[L][c.edgepaths[L].length-1],D=-1,I=0;I<4;I++){if(!P){g.log("Missing end?",L,c);break}for(F(P)&&!K(P)?z=b[1]:G(P)?z=b[0]:N(P)?z=b[3]:K(P)&&(z=b[2]),R=0;R<c.edgepaths.length;R++){var W=c.edgepaths[R][0];Math.abs(P[0]-z[0])<.01?Math.abs(P[0]-W[0])<.01&&(W[1]-P[1])*(z[1]-W[1])>=0&&(z=W,D=R):Math.abs(P[1]-z[1])<.01?Math.abs(P[1]-W[1])<.01&&(W[0]-P[0])*(z[0]-W[0])>=0&&(z=W,D=R):g.log("endpt to newendpt is not vert. or horz.",P,z,W)}if(P=z,D>=0)break;u+="L"+z}if(D===c.edgepaths.length){g.log("unclosed perimeter path");break}L=D,k=T.indexOf(L)===-1,k&&(L=T[0],u+="Z")}for(L=0;L<c.paths.length;L++)u+=S.smoothclosed(c.paths[L],c.smoothing);return u}function m(c,b,u,L,T){var k=g.ensureSingle(c,"g","contourlines"),P=T.showlines!==!1,z=T.showlabels,I=P&&z,D=te.createLines(k,P||z,b),R=te.createLineClip(k,I,u,L.trace.uid),O=c.selectAll("g.contourlabels").data(z?[0]:[]);if(O.exit().remove(),O.enter().append("g").classed("contourlabels",!0),z){var F=[],N=[];g.clearLocationCache();var G=te.labelFormatter(u,L),K=S.tester.append("text").attr("data-notex",1).call(S.font,T.labelfont),W=b[0].xaxis,Y=b[0].yaxis,re=W._length,ue=Y._length,j=W.range,q=Y.range,H=g.aggNums(Math.min,null,L.x),U=g.aggNums(Math.max,null,L.x),$=g.aggNums(Math.min,null,L.y),ne=g.aggNums(Math.max,null,L.y),X=Math.max(W.c2p(H,!0),0),Q=Math.min(W.c2p(U,!0),re),ie=Math.max(Y.c2p(ne,!0),0),se=Math.min(Y.c2p($,!0),ue),ae={};j[0]<j[1]?(ae.left=X,ae.right=Q):(ae.left=Q,ae.right=X),q[0]<q[1]?(ae.top=ie,ae.bottom=se):(ae.top=se,ae.bottom=ie),ae.middle=(ae.top+ae.bottom)/2,ae.center=(ae.left+ae.right)/2,F.push([[ae.left,ae.top],[ae.right,ae.top],[ae.right,ae.bottom],[ae.left,ae.bottom]]);var oe=Math.sqrt(re*re+ue*ue),be=p.LABELDISTANCE*oe/Math.max(1,b.length/p.LABELINCREASE);D.each(function(ce){var de=te.calcTextOpts(ce.level,G,K,u);A.select(this).selectAll("path").each(function(){var ye=this,ge=g.getVisibleSegment(ye,ae,de.height/2);if(ge&&!(ge.len<(de.width+de.height)*p.LABELMIN))for(var me=Math.min(Math.ceil(ge.len/be),p.LABELMAX),Ee=0;Ee<me;Ee++){var Pe=te.findBestTextLocation(ye,ge,de,N,ae);if(!Pe)break;te.addLabelData(Pe,de,N,F)}})}),K.remove(),te.drawLabels(O,N,u,R,I?F:null)}z&&!P&&D.remove()}te.createLines=function(c,b,u){var L=u[0].smoothing,T=c.selectAll("g.contourlevel").data(b?u:[]);if(T.exit().remove(),T.enter().append("g").classed("contourlevel",!0),b){var k=T.selectAll("path.openline").data(function(z){return z.pedgepaths||z.edgepaths});k.exit().remove(),k.enter().append("path").classed("openline",!0),k.attr("d",function(z){return S.smoothopen(z,L)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var P=T.selectAll("path.closedline").data(function(z){return z.ppaths||z.paths});P.exit().remove(),P.enter().append("path").classed("closedline",!0),P.attr("d",function(z){return S.smoothclosed(z,L)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return T},te.createLineClip=function(c,b,u,L){var T=u._fullLayout._clips,k=b?"clipline"+L:null,P=T.selectAll("#"+k).data(b?[0]:[]);return P.exit().remove(),P.enter().append("clipPath").classed("contourlineclip",!0).attr("id",k),S.setClipUrl(c,k,u),P},te.labelFormatter=function(c,b){var u=c._fullLayout,L=b.trace,T=L.contours,k={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(T.labelformat)k.tickformat=T.labelformat,n(k,u);else{var P=M.extractOpts(L);if(P&&P.colorbar&&P.colorbar._axis)k=P.colorbar._axis;else{if(T.type==="constraint"){var z=T.value;Array.isArray(z)?k.range=[z[0],z[z.length-1]]:k.range=[z,z]}else k.range=[T.start,T.end],k.nticks=(T.end-T.start)/T.size;k.range[0]===k.range[1]&&(k.range[1]+=k.range[0]||1),k.nticks||(k.nticks=1e3),n(k,u),a.prepTicks(k),k._tmin=null,k._tmax=null}}return function(I){return a.tickText(k,I).text}},te.calcTextOpts=function(c,b,u,L){var T=b(c);u.text(T).call(e.convertToTspans,L);var k=u.node(),P=S.bBox(k,!0);return{text:T,width:P.width,height:P.height,fontSize:+k.style["font-size"].replace("px",""),level:c,dy:(P.top+P.bottom)/2}},te.findBestTextLocation=function(c,b,u,L,T){var k=u.width,P,z,I,D,R;b.isClosed?(z=b.len/v.INITIALSEARCHPOINTS,P=b.min+z/2,I=b.max):(z=(b.len-k)/(v.INITIALSEARCHPOINTS+1),P=b.min+z+k/2,I=b.max-(z+k)/2);for(var O=1/0,F=0;F<v.ITERATIONS;F++){for(var N=P;N<I;N+=z){var G=g.getTextLocation(c,b.total,N,k),K=l(G,u,L,T);K<O&&(O=K,R=G,D=N)}if(O>v.MAXCOST*2)break;F&&(z/=2),P=D-z/2,I=P+z*1.5}if(O<=v.MAXCOST)return R};function l(c,b,u,L){var T=b.width/2,k=b.height/2,P=c.x,z=c.y,I=c.theta,D=Math.cos(I)*T,R=Math.sin(I)*T,O=(P>L.center?L.right-P:P-L.left)/(D+Math.abs(Math.sin(I)*k)),F=(z>L.middle?L.bottom-z:z-L.top)/(Math.abs(R)+Math.cos(I)*k);if(O<1||F<1)return 1/0;var N=v.EDGECOST*(1/(O-1)+1/(F-1));N+=v.ANGLECOST*I*I;for(var G=P-D,K=z-R,W=P+D,Y=z+R,re=0;re<u.length;re++){var ue=u[re],j=Math.cos(ue.theta)*ue.width/2,q=Math.sin(ue.theta)*ue.width/2,H=g.segmentDistance(G,K,W,Y,ue.x-j,ue.y-q,ue.x+j,ue.y+q)*2/(b.height+ue.height),U=ue.level===b.level,$=U?v.SAMELEVELDISTANCE:1;if(H<=$)return 1/0;var ne=v.NEIGHBORCOST*(U?v.SAMELEVELFACTOR:1);N+=ne/(H-$)}return N}te.addLabelData=function(c,b,u,L){var T=b.fontSize,k=b.width+T/3,P=Math.max(0,b.height-T/3),z=c.x,I=c.y,D=c.theta,R=Math.sin(D),O=Math.cos(D),F=function(G,K){return[z+G*O-K*R,I+G*R+K*O]},N=[F(-k/2,-P/2),F(-k/2,P/2),F(k/2,P/2),F(k/2,-P/2)];u.push({text:b.text,x:z,y:I,dy:b.dy,theta:D,level:b.level,width:k,height:P}),L.push(N)},te.drawLabels=function(c,b,u,L,T){var k=c.selectAll("text").data(b,function(D){return D.text+","+D.x+","+D.y+","+D.theta});if(k.exit().remove(),k.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(D){var R=D.x+Math.sin(D.theta)*D.dy,O=D.y-Math.cos(D.theta)*D.dy;A.select(this).text(D.text).attr({x:R,y:O,transform:"rotate("+180*D.theta/Math.PI+" "+R+" "+O+")"}).call(e.convertToTspans,u)}),T){for(var P="",z=0;z<T.length;z++)P+="M"+T[z].join("L")+"Z";var I=g.ensureSingle(L,"path","");I.attr("d",P)}};function w(c,b,u,L,T){var k=L.trace,P=u._fullLayout._clips,z="clip"+k.uid,I=P.selectAll("#"+z).data(k.connectgaps?[]:[0]);if(I.enter().append("clipPath").classed("contourclip",!0).attr("id",z),I.exit().remove(),k.connectgaps===!1){var D={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:b.xaxis,yaxis:b.yaxis,x:L.x,y:L.y,z:_(L),smoothing:0};t([D]),h([D]),x([D],{type:"levels"});var R=g.ensureSingle(I,"path","");R.attr("d",(D.prefixBoundary?"M"+T.join("L")+"Z":"")+o(D,T))}else z=null;S.setClipUrl(c,z,u)}function _(c){var b=c.trace._emptypoints,u=[],L=c.z.length,T=c.z[0].length,k,P=[],z;for(k=0;k<T;k++)P.push(1);for(k=0;k<L;k++)u.push(P.slice());for(k=0;k<b.length;k++)z=b[k],u[z[0]][z[1]]=0;return c.zmask=u,u}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../lib");ee.exports=function(e,a){var n=e.contours;if(e.autocontour){var r=e.zmin,t=e.zmax;(e.zauto||r===void 0)&&(r=g.aggNums(Math.min,null,a)),(e.zauto||t===void 0)&&(t=g.aggNums(Math.max,null,a));var h=S(r,t,e.ncontours);n.size=h.dtick,n.start=A.tickFirst(h),h.range.reverse(),n.end=A.tickFirst(h),n.start===r&&(n.start+=n.size),n.end===t&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),e._input.contours||(e._input.contours={}),g.extendFlat(e._input.contours,{start:n.start,end:n.end,size:n.size}),e._input.autocontour=!0}else if(n.type!=="constraint"){var s=n.start,i=n.end,x=e._input.contours;if(s>i&&(n.start=x.start=i,i=n.end=x.end=s,s=n.start),!(n.size>0)){var p;s===i?p=1:p=S(s,i,e.ncontours).dtick,x.size=n.size=p}}};function S(M,e,a){var n={type:"linear",range:[M,e]};return A.autoTicks(n,(e-M)/(a||15)),n}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/drawing"),S=y("../heatmap/style"),M=y("./make_color_map");ee.exports=function(a){var n=A.select(a).selectAll("g.contour");n.style("opacity",function(r){return r[0].trace.opacity}),n.each(function(r){var t=A.select(this),h=r[0].trace,s=h.contours,i=h.line,x=s.size||1,p=s.start,v=s.type==="constraint",f=!v&&s.coloring==="lines",d=!v&&s.coloring==="fill",o=f||d?M(h):null;t.selectAll("g.contourlevel").each(function(w){A.select(this).selectAll("path").call(g.lineGroupStyle,i.width,f?o(w.level):i.color,i.dash)});var m=s.labelfont;if(t.selectAll("g.contourlabels text").each(function(w){g.font(A.select(this),{family:m.family,size:m.size,color:m.color||(f?o(w.level):i.color)})}),v)t.selectAll("g.contourfill path").style("fill",h.fillcolor);else if(d){var l;t.selectAll("g.contourfill path").style("fill",function(w){return l===void 0&&(l=w.level),o(w.level+.5*x)}),l===void 0&&(l=p),t.selectAll("g.contourbg path").style("fill",o(l-.5*x))}}),S(a)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(y,ee,te){var A=y("../../components/colorscale/defaults"),g=y("./label_defaults");ee.exports=function(M,e,a,n,r){var t=a("contours.coloring"),h,s="";t==="fill"&&(h=a("contours.showlines")),h!==!1&&(t!=="lines"&&(s=a("line.color","#000")),a("line.width",.5),a("line.dash")),t!=="none"&&(M.showlegend!==!0&&(e.showlegend=!1),e._dfltShowLegend=!1,A(M,e,n,a,{prefix:"",cLetter:"z"})),a("line.smoothing"),g(a,n,s,r)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(y,ee,te){var A=y("../heatmap/attributes"),g=y("../contour/attributes"),S=y("../../components/colorscale/attributes"),M=y("../../lib/extend").extendFlat,e=g.contours;ee.exports=M({carpet:{valType:"string",editType:"calc"},z:A.z,a:A.x,a0:A.x0,da:A.dx,b:A.y,b0:A.y0,db:A.dy,text:A.text,hovertext:A.hovertext,transpose:A.transpose,atype:A.xtype,btype:A.ytype,fillcolor:g.fillcolor,autocontour:g.autocontour,ncontours:g.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:g.line.color,width:g.line.width,dash:g.line.dash,smoothing:g.line.smoothing,editType:"plot"},transforms:void 0},S("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(y,ee,te){var A=y("../../components/colorscale/calc"),g=y("../../lib"),S=y("../heatmap/convert_column_xyz"),M=y("../heatmap/clean_2d_array"),e=y("../heatmap/interp2d"),a=y("../heatmap/find_empties"),n=y("../heatmap/make_bound_array"),r=y("./defaults"),t=y("../carpet/lookup_carpetid"),h=y("../contour/set_contours");ee.exports=function(x,p){var v=p._carpetTrace=t(x,p);if(!(!v||!v.visible||v.visible==="legendonly")){if(!p.a||!p.b){var f=x.data[v.index],d=x.data[p.index];d.a||(d.a=f.a),d.b||(d.b=f.b),r(d,p,p._defaultColor,x._fullLayout)}var o=s(x,p);return h(p,p._z),o}};function s(i,x){var p=x._carpetTrace,v=p.aaxis,f=p.baxis,d,o,m,l,w,_,c;v._minDtick=0,f._minDtick=0,g.isArray1D(x.z)&&S(x,v,f,"a","b",["z"]),d=x._a=x._a||x.a,l=x._b=x._b||x.b,d=d?v.makeCalcdata(x,"_a"):[],l=l?f.makeCalcdata(x,"_b"):[],o=x.a0||0,m=x.da||1,w=x.b0||0,_=x.db||1,c=x._z=M(x._z||x.z,x.transpose),x._emptypoints=a(c),e(c,x._emptypoints);var b=g.maxRowLength(c),u=x.xtype==="scaled"?"":d,L=n(x,u,o,m,b,v),T=x.ytype==="scaled"?"":l,k=n(x,T,w,_,c.length,f),P={a:L,b:k,z:c};return x.contours.type==="levels"&&x.contours.coloring!=="none"&&A(i,x,{vals:c,containerStr:"",cLetter:"z"}),[P]}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(y,ee,te){var A=y("../../lib"),g=y("../heatmap/xyz_defaults"),S=y("./attributes"),M=y("../contour/constraint_defaults"),e=y("../contour/contours_defaults"),a=y("../contour/style_defaults");ee.exports=function(r,t,h,s){function i(f,d){return A.coerce(r,t,S,f,d)}function x(f){return A.coerce2(r,t,S,f)}if(i("carpet"),r.a&&r.b){var p=g(r,t,i,s,"a","b");if(!p){t.visible=!1;return}i("text");var v=i("contours.type")==="constraint";v?M(r,t,i,s,h,{hasHover:!1}):(e(r,t,i,x),a(r,t,i,s,{hasHover:!1}))}else t._defaultColor=h,t._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../contour/colorbar"),calc:y("./calc"),plot:y("./plot"),style:y("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../carpet/map_1d_array"),S=y("../carpet/makepath"),M=y("../../components/drawing"),e=y("../../lib"),a=y("../contour/make_crossings"),n=y("../contour/find_all_paths"),r=y("../contour/plot"),t=y("../contour/constants"),h=y("../contour/convert_to_constraints"),s=y("../contour/empty_pathinfo"),i=y("../contour/close_boundaries"),x=y("../carpet/lookup_carpetid"),p=y("../carpet/axis_aligned_line");ee.exports=function(u,L,T,k){var P=L.xaxis,z=L.yaxis;e.makeTraceGroups(k,T,"contour").each(function(I){var D=A.select(this),R=I[0],O=R.trace,F=O._carpetTrace=x(u,O),N=u.calcdata[F.index][0];if(!F.visible||F.visible==="legendonly")return;var G=R.a,K=R.b,W=O.contours,Y=s(W,L,R),re=W.type==="constraint",ue=W._operation,j=re?ue==="="?"lines":"fill":W.coloring;function q(be){var ce=F.ab2xy(be[0],be[1],!0);return[P.c2p(ce[0]),z.c2p(ce[1])]}var H=[[G[0],K[K.length-1]],[G[G.length-1],K[K.length-1]],[G[G.length-1],K[0]],[G[0],K[0]]];a(Y);var U=(G[G.length-1]-G[0])*1e-8,$=(K[K.length-1]-K[0])*1e-8;n(Y,U,$);var ne=Y;W.type==="constraint"&&(ne=h(Y,ue)),v(Y,q);var X,Q,ie,se,ae=[];for(se=N.clipsegments.length-1;se>=0;se--)X=N.clipsegments[se],Q=g([],X.x,P.c2p),ie=g([],X.y,z.c2p),Q.reverse(),ie.reverse(),ae.push(S(Q,ie,X.bicubic));var oe="M"+ae.join("L")+"Z";w(D,N.clipsegments,P,z,re,j),_(O,D,P,z,ne,H,q,F,N,j,oe),f(D,Y,u,R,W,L,F),M.setClipUrl(D,F._clipPathId,u)})};function v(b,u){var L,T,k,P,z,I,D,R,O;for(L=0;L<b.length;L++){for(P=b[L],z=P.pedgepaths=[],I=P.ppaths=[],T=0;T<P.edgepaths.length;T++){for(O=P.edgepaths[T],D=[],k=0;k<O.length;k++)D[k]=u(O[k]);z.push(D)}for(T=0;T<P.paths.length;T++){for(O=P.paths[T],R=[],k=0;k<O.length;k++)R[k]=u(O[k]);I.push(R)}}}function f(b,u,L,T,k,P,z){var I=e.ensureSingle(b,"g","contourlines"),D=k.showlines!==!1,R=k.showlabels,O=D&&R,F=r.createLines(I,D||R,u),N=r.createLineClip(I,O,L,T.trace.uid),G=b.selectAll("g.contourlabels").data(R?[0]:[]);if(G.exit().remove(),G.enter().append("g").classed("contourlabels",!0),R){var K=P.xaxis,W=P.yaxis,Y=K._length,re=W._length,ue=[[[0,0],[Y,0],[Y,re],[0,re]]],j=[];e.clearLocationCache();var q=r.labelFormatter(L,T),H=M.tester.append("text").attr("data-notex",1).call(M.font,k.labelfont),U={left:0,right:Y,center:Y/2,top:0,bottom:re,middle:re/2},$=Math.sqrt(Y*Y+re*re),ne=t.LABELDISTANCE*$/Math.max(1,u.length/t.LABELINCREASE);F.each(function(X){var Q=r.calcTextOpts(X.level,q,H,L);A.select(this).selectAll("path").each(function(ie){var se=this,ae=e.getVisibleSegment(se,U,Q.height/2);if(ae&&(d(se,ie,X,ae,z,Q.height),!(ae.len<(Q.width+Q.height)*t.LABELMIN)))for(var oe=Math.min(Math.ceil(ae.len/ne),t.LABELMAX),be=0;be<oe;be++){var ce=r.findBestTextLocation(se,ae,Q,j,U);if(!ce)break;r.addLabelData(ce,Q,j,ue)}})}),H.remove(),r.drawLabels(G,j,L,N,O?ue:null)}R&&!D&&F.remove()}function d(b,u,L,T,k,P){for(var z,I=0;I<L.pedgepaths.length;I++)u===L.pedgepaths[I]&&(z=L.edgepaths[I]);if(!z)return;var D=k.a[0],R=k.a[k.a.length-1],O=k.b[0],F=k.b[k.b.length-1];function N(re,ue){var j=0,q,H=.1;return(Math.abs(re[0]-D)<H||Math.abs(re[0]-R)<H)&&(q=m(k.dxydb_rough(re[0],re[1],H)),j=Math.max(j,P*l(ue,q)/2)),(Math.abs(re[1]-O)<H||Math.abs(re[1]-F)<H)&&(q=m(k.dxyda_rough(re[0],re[1],H)),j=Math.max(j,P*l(ue,q)/2)),j}var G=o(b,0,1),K=o(b,T.total,T.total-1),W=N(z[0],G),Y=T.total-N(z[z.length-1],K);T.min<W&&(T.min=W),T.max>Y&&(T.max=Y),T.len=T.max-T.min}function o(b,u,L){var T=b.getPointAtLength(u),k=b.getPointAtLength(L),P=k.x-T.x,z=k.y-T.y,I=Math.sqrt(P*P+z*z);return[P/I,z/I]}function m(b){var u=Math.sqrt(b[0]*b[0]+b[1]*b[1]);return[b[0]/u,b[1]/u]}function l(b,u){var L=Math.abs(b[0]*u[0]+b[1]*u[1]),T=Math.sqrt(1-L*L);return T/L}function w(b,u,L,T,k,P){var z,I,D,R,O=e.ensureSingle(b,"g","contourbg"),F=O.selectAll("path").data(P==="fill"&&!k?[0]:[]);F.enter().append("path"),F.exit().remove();var N=[];for(R=0;R<u.length;R++)z=u[R],I=g([],z.x,L.c2p),D=g([],z.y,T.c2p),N.push(S(I,D,z.bicubic));F.attr("d","M"+N.join("L")+"Z").style("stroke","none")}function _(b,u,L,T,k,P,z,I,D,R,O){var F=R==="fill";F&&i(k,b.contours);var N=e.ensureSingle(u,"g","contourfill"),G=N.selectAll("path").data(F?k:[]);G.enter().append("path"),G.exit().remove(),G.each(function(K){var W=(K.prefixBoundary?O:"")+c(b,K,P,z,I,D,L,T);W?A.select(this).attr("d",W).style("stroke","none"):A.select(this).remove()})}function c(b,u,L,T,k,P,z,I){var D,R="",O=u.edgepaths.map(function(ie,se){return se}),F=!0,N,G,K,W,Y,re,ue=Math.abs(L[0][0]-L[2][0])*1e-4,j=Math.abs(L[0][1]-L[2][1])*1e-4;function q(ie){return Math.abs(ie[1]-L[0][1])<j}function H(ie){return Math.abs(ie[1]-L[2][1])<j}function U(ie){return Math.abs(ie[0]-L[0][0])<ue}function $(ie){return Math.abs(ie[0]-L[2][0])<ue}function ne(ie,se){var ae,oe,be,ce,de="";for(q(ie)&&!$(ie)||H(ie)&&!U(ie)?(ce=k.aaxis,be=p(k,P,[ie[0],se[0]],.5*(ie[1]+se[1]))):(ce=k.baxis,be=p(k,P,.5*(ie[0]+se[0]),[ie[1],se[1]])),ae=1;ae<be.length;ae++)for(de+=ce.smoothing?"C":"L",oe=0;oe<be[ae].length;oe++){var ye=be[ae][oe];de+=[z.c2p(ye[0]),I.c2p(ye[1])]+" "}return de}for(D=0,N=null;O.length;){var X=u.edgepaths[D][0];for(N&&(R+=ne(N,X)),re=M.smoothopen(u.edgepaths[D].map(T),u.smoothing),R+=F?re:re.replace(/^M/,"L"),O.splice(O.indexOf(D),1),N=u.edgepaths[D][u.edgepaths[D].length-1],W=-1,K=0;K<4;K++){if(!N){e.log("Missing end?",D,u);break}for(q(N)&&!$(N)?G=L[1]:U(N)?G=L[0]:H(N)?G=L[3]:$(N)&&(G=L[2]),Y=0;Y<u.edgepaths.length;Y++){var Q=u.edgepaths[Y][0];Math.abs(N[0]-G[0])<ue?Math.abs(N[0]-Q[0])<ue&&(Q[1]-N[1])*(G[1]-Q[1])>=0&&(G=Q,W=Y):Math.abs(N[1]-G[1])<j?Math.abs(N[1]-Q[1])<j&&(Q[0]-N[0])*(G[0]-Q[0])>=0&&(G=Q,W=Y):e.log("endpt to newendpt is not vert. or horz.",N,G,Q)}if(W>=0)break;R+=ne(N,G),N=G}if(W===u.edgepaths.length){e.log("unclosed perimeter path");break}D=W,F=O.indexOf(D)===-1,F&&(D=O[0],R+=ne(N,G)+"Z",N=null)}for(D=0;D<u.paths.length;D++)R+=M.smoothclosed(u.paths[D].map(T),u.smoothing);return R}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(y,ee,te){var A=y("../../components/colorscale/attributes"),g=y("../../plots/template_attributes").hovertemplateAttrs,S=y("../../plots/attributes"),M=y("../scattermapbox/attributes"),e=y("../../lib/extend").extendFlat;ee.exports=e({lon:M.lon,lat:M.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:M.text,hovertext:M.hovertext,hoverinfo:e({},S.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:g(),showlegend:e({},S.showlegend,{dflt:!1})},A("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib").isArrayOrTypedArray,S=y("../../constants/numerical").BADNUM,M=y("../../components/colorscale/calc"),e=y("../../lib")._;ee.exports=function(n,r){for(var t=r._length,h=new Array(t),s=r.z,i=g(s)&&s.length,x=0;x<t;x++){var p=h[x]={},v=r.lon[x],f=r.lat[x];if(p.lonlat=A(v)&&A(f)?[+v,+f]:[S,S],i){var d=s[x];p.z=A(d)?d:S}}return M(n,r,{vals:i?s:[0,1],containerStr:"",cLetter:"z"}),t&&(h[0].t={labels:{lat:e(n,"lat:")+" ",lon:e(n,"lon:")+" "}}),h}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../components/color"),M=y("../../components/colorscale"),e=y("../../constants/numerical").BADNUM,a=y("../../lib/geojson_utils").makeBlank;ee.exports=function(r){var t=r[0].trace,h=t.visible===!0&&t._length!==0,s={layout:{visibility:"none"},paint:{}},i=t._opts={heatmap:s,geojson:a()};if(!h)return i;var x=[],p,v=t.z,f=t.radius,d=g.isArrayOrTypedArray(v)&&v.length,o=g.isArrayOrTypedArray(f);for(p=0;p<r.length;p++){var m=r[p],l=m.lonlat;if(l[0]!==e){var w={};if(d){var _=m.z;w.z=_!==e?_:0}o&&(w.r=A(f[p])&&f[p]>0?+f[p]:0),x.push({type:"Feature",geometry:{type:"Point",coordinates:l},properties:w})}}var c=M.extractOpts(t),b=c.reversescale?M.flipScale(c.colorscale):c.colorscale,u=b[0][1],L=S.opacity(u)<1?u:S.addOpacity(u,0),T=["interpolate",["linear"],["heatmap-density"],0,L];for(p=1;p<b.length;p++)T.push(b[p][0],b[p][1]);var k=["interpolate",["linear"],["get","z"],c.min,0,c.max,1];return g.extendFlat(i.heatmap.paint,{"heatmap-weight":d?k:1/(c.max-c.min),"heatmap-color":T,"heatmap-radius":o?{type:"identity",property:"r"}:t.radius,"heatmap-opacity":t.opacity}),i.geojson={type:"FeatureCollection",features:x},i.heatmap.layout.visibility="visible",i}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/colorscale/defaults"),S=y("./attributes");ee.exports=function(e,a,n,r){function t(x,p){return A.coerce(e,a,S,x,p)}var h=t("lon")||[],s=t("lat")||[],i=Math.min(h.length,s.length);if(!i){a.visible=!1;return}a._length=i,t("z"),t("radius"),t("below"),t("text"),t("hovertext"),t("hovertemplate"),g(e,a,r,t,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(y,ee,te){ee.exports=function(g,S){return g.lon=S.lon,g.lat=S.lat,g.z=S.z,g}},{}],776:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../scattermapbox/hover").hoverPoints,S=y("../scattermapbox/hover").getExtraText;ee.exports=function(e,a,n){var r=g(e,a,n);if(r){var t=r[0],h=t.cd,s=h[0].trace,i=h[t.index];if(delete t.color,"z"in i){var x=t.subplot.mockAxis;t.z=i.z,t.zLabel=A.tickText(x,x.c2l(i.z),"hover").text}return t.extraText=S(s,i,h[0].t.labels),[t]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../heatmap/colorbar"),formatLabels:y("../scattermapbox/format_labels"),calc:y("./calc"),plot:y("./plot"),hoverPoints:y("./hover"),eventData:y("./event_data"),getBelow:function(A,g){for(var S=g.getMapLayers(),M=0;M<S.length;M++){var e=S[M],a=e.id;if(e.type==="symbol"&&typeof a=="string"&&a.indexOf("plotly-")===-1)return a}},moduleType:"trace",name:"densitymapbox",basePlotModule:y("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(y,ee,te){var A=y("./convert"),g=y("../../plots/mapbox/constants").traceLayerPrefix;function S(e,a){this.type="densitymapbox",this.subplot=e,this.uid=a,this.sourceId="source-"+a,this.layerList=[["heatmap",g+a+"-heatmap"]],this.below=null}var M=S.prototype;M.update=function(e){var a=this.subplot,n=this.layerList,r=A(e),t=a.belowLookup["trace-"+this.uid];a.map.getSource(this.sourceId).setData(r.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(r,t),this.below=t);for(var h=0;h<n.length;h++){var s=n[h],i=s[0],x=s[1],p=r[i];a.setOptions(x,"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&a.setOptions(x,"setPaintProperty",p.paint)}},M._addLayers=function(e,a){for(var n=this.subplot,r=this.layerList,t=this.sourceId,h=0;h<r.length;h++){var s=r[h],i=s[0],x=e[i];n.addLayer({type:i,id:s[1],source:t,layout:x.layout,paint:x.paint},a)}},M._removeLayers=function(){for(var e=this.subplot.map,a=this.layerList,n=a.length-1;n>=0;n--)e.removeLayer(a[n][1])},M.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},ee.exports=function(a,n){var r=n[0].trace,t=new S(a,r.uid),h=t.sourceId,s=A(n),i=t.below=a.belowLookup["trace-"+r.uid];return a.map.addSource(h,{type:"geojson",data:s.geojson}),t._addLayers(s,i),t}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;A.mergeArray(M.text,S,"tx"),A.mergeArray(M.hovertext,S,"htx");var a=M.marker;if(a){A.mergeArray(a.opacity,S,"mo"),A.mergeArray(a.color,S,"mc");var n=a.line;n&&(A.mergeArray(n.color,S,"mlc"),A.mergeArrayCastPositive(n.width,S,"mlw"))}}},{"../../lib":515}],780:[function(y,ee,te){var A=y("../bar/attributes"),g=y("../scatter/attributes").line,S=y("../../plots/attributes"),M=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../plots/template_attributes").hovertemplateAttrs,a=y("../../plots/template_attributes").texttemplateAttrs,n=y("./constants"),r=y("../../lib/extend").extendFlat,t=y("../../components/color");ee.exports={x:A.x,x0:A.x0,dx:A.dx,y:A.y,y0:A.y0,dy:A.dy,xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:A.xperiod0,yperiod0:A.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),hovertext:A.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:r({},S.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:a({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),text:A.text,textposition:A.textposition,insidetextanchor:r({},A.insidetextanchor,{dflt:"middle"}),textangle:r({},A.textangle,{dflt:0}),textfont:A.textfont,insidetextfont:A.insidetextfont,outsidetextfont:A.outsidetextfont,constraintext:A.constraintext,cliponaxis:A.cliponaxis,orientation:r({},A.orientation,{}),offset:r({},A.offset,{arrayOk:!1}),width:r({},A.width,{arrayOk:!1}),marker:h(),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},g.color,{dflt:t.defaultLine}),width:r({},g.width,{dflt:0,editType:"plot"}),dash:g.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:A.offsetgroup,alignmentgroup:A.alignmentgroup};function h(){var s=r({},A.marker);return delete s.pattern,s}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../plots/cartesian/align_period"),S=y("./arrays_to_calcdata"),M=y("../scatter/calc_selection"),e=y("../../constants/numerical").BADNUM;ee.exports=function(r,t){var h=A.getFromId(r,t.xaxis||"x"),s=A.getFromId(r,t.yaxis||"y"),i,x,p,v,f,d,o,m;t.orientation==="h"?(i=h.makeCalcdata(t,"x"),p=s.makeCalcdata(t,"y"),v=g(t,s,"y",p),f=!!t.yperiodalignment,d="y"):(i=s.makeCalcdata(t,"y"),p=h.makeCalcdata(t,"x"),v=g(t,h,"x",p),f=!!t.xperiodalignment,d="x"),x=v.vals;var l=Math.min(x.length,i.length),w=new Array(l);for(t._base=[],o=0;o<l;o++){i[o]<0&&(i[o]=e);var _=!1;i[o]!==e&&o+1<l&&i[o+1]!==e&&(_=!0),m=w[o]={p:x[o],s:i[o],cNext:_},t._base[o]=-.5*m.s,f&&(w[o].orig_p=p[o],w[o][d+"End"]=v.ends[o],w[o][d+"Start"]=v.starts[o]),t.ids&&(m.id=String(t.ids[o])),o===0&&(w[0].vTotal=0),w[0].vTotal+=a(m.s),m.begR=a(m.s)/a(w[0].s)}var c;for(o=0;o<l;o++)m=w[o],m.s!==e&&(m.sumR=m.s/w[0].vTotal,m.difR=c!==void 0?m.s/c:1,c=m.s);return S(w,t),M(w,t),w};function a(n){return n===e?0:n}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(y,ee,te){ee.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(y,ee,te){var A=y("../bar/cross_trace_calc").setGroupPositions;ee.exports=function(S,M){var e=S._fullLayout,a=S._fullData,n=S.calcdata,r=M.xaxis,t=M.yaxis,h=[],s=[],i=[],x,p;for(p=0;p<a.length;p++){var v=a[p],f=v.orientation==="h";v.visible===!0&&v.xaxis===r._id&&v.yaxis===t._id&&v.type==="funnel"&&(x=n[p],f?i.push(x):s.push(x),h.push(x))}var d={mode:e.funnelmode,norm:e.funnelnorm,gap:e.funnelgap,groupgap:e.funnelgroupgap};for(A(S,r,t,s,d),A(S,t,r,i,d),p=0;p<h.length;p++){x=h[p];for(var o=0;o<x.length;o++)o+1<x.length&&(x[o].nextP0=x[o+1].p0,x[o].nextS0=x[o+1].s0,x[o].nextP1=x[o+1].p1,x[o].nextS1=x[o+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(y,ee,te){var A=y("../../lib"),g=y("../bar/defaults").handleGroupingDefaults,S=y("../bar/defaults").handleText,M=y("../scatter/xy_defaults"),e=y("../scatter/period_defaults"),a=y("./attributes"),n=y("../../components/color");function r(s,i,x,p){function v(_,c){return A.coerce(s,i,a,_,c)}var f=M(s,i,p,v);if(!f){i.visible=!1;return}e(s,i,p,v),v("xhoverformat"),v("yhoverformat"),v("orientation",i.y&&!i.x?"v":"h"),v("offset"),v("width");var d=v("text");v("hovertext"),v("hovertemplate");var o=v("textposition");S(s,i,p,v,o,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i.textposition!=="none"&&!i.texttemplate&&v("textinfo",Array.isArray(d)?"text+value":"value");var m=v("marker.color",x);v("marker.line.color",n.defaultLine),v("marker.line.width");var l=v("connector.visible");if(l){v("connector.fillcolor",t(m));var w=v("connector.line.width");w&&(v("connector.line.color"),v("connector.line.dash"))}}function t(s){var i=A.isArrayOrTypedArray(s)?"#000":s;return n.addOpacity(i,.5*n.opacity(i))}function h(s,i){var x,p;function v(d){return A.coerce(p._input,p,a,d)}if(i.funnelmode==="group")for(var f=0;f<s.length;f++)p=s[f],x=p._input,g(x,p,i,v)}ee.exports={supplyDefaults:r,crossTraceDefaults:h}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(y,ee,te){ee.exports=function(g,S){return g.x="xVal"in S?S.xVal:S.x,g.y="yVal"in S?S.yVal:S.y,"percentInitial"in S&&(g.percentInitial=S.percentInitial),"percentPrevious"in S&&(g.percentPrevious=S.percentPrevious),"percentTotal"in S&&(g.percentTotal=S.percentTotal),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),g}},{}],786:[function(y,ee,te){var A=y("../../components/color").opacity,g=y("../bar/hover").hoverOnBars,S=y("../../lib").formatPercent;ee.exports=function(a,n,r,t,h){var s=g(a,n,r,t,h);if(s){var i=s.cd,x=i[0].trace,p=x.orientation==="h",v=s.index,f=i[v],d=p?"x":"y";s[d+"LabelVal"]=f.s,s.percentInitial=f.begR,s.percentInitialLabel=S(f.begR,1),s.percentPrevious=f.difR,s.percentPreviousLabel=S(f.difR,1),s.percentTotal=f.sumR,s.percentTotalLabel=S(f.sumR,1);var o=f.hi||x.hoverinfo,m=[];if(o&&o!=="none"&&o!=="skip"){var l=o==="all",w=o.split("+"),_=function(c){return l||w.indexOf(c)!==-1};_("percent initial")&&m.push(s.percentInitialLabel+" of initial"),_("percent previous")&&m.push(s.percentPreviousLabel+" of previous"),_("percent total")&&m.push(s.percentTotalLabel+" of total")}return s.extraText=m.join("<br>"),s.color=M(x,f),[s]}};function M(e,a){var n=e.marker,r=a.mc||n.color,t=a.mlc||n.line.color,h=a.mlw||n.line.width;if(A(r))return r;if(A(t)&&h)return t}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(y,ee,te){ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults").supplyDefaults,crossTraceDefaults:y("./defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc"),plot:y("./plot"),style:y("./style").style,hoverPoints:y("./hover"),eventData:y("./event_data"),selectPoints:y("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:y("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(y,ee,te){ee.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(S,M,e){var a=!1;function n(h,s){return A.coerce(S,M,g,h,s)}for(var r=0;r<e.length;r++){var t=e[r];if(t.visible&&t.type==="funnel"){a=!0;break}}a&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../components/drawing"),M=y("../../constants/numerical").BADNUM,e=y("../bar/plot"),a=y("../bar/uniform_text").clearMinTextSize;ee.exports=function(s,i,x,p){var v=s._fullLayout;a("funnel",v),n(s,i,x,p),r(s,i,x,p),e.plot(s,i,x,p,{mode:v.funnelmode,norm:v.funnelmode,gap:v.funnelgap,groupgap:v.funnelgroupgap})};function n(h,s,i,x){var p=s.xaxis,v=s.yaxis;g.makeTraceGroups(x,i,"trace bars").each(function(f){var d=A.select(this),o=f[0].trace,m=g.ensureSingle(d,"g","regions");if(!o.connector||!o.connector.visible){m.remove();return}var l=o.orientation==="h",w=m.selectAll("g.region").data(g.identity);w.enter().append("g").classed("region",!0),w.exit().remove();var _=w.size();w.each(function(c,b){if(!(b!==_-1&&!c.cNext)){var u=t(c,p,v,l),L=u[0],T=u[1],k="";L[0]!==M&&T[0]!==M&&L[1]!==M&&T[1]!==M&&L[2]!==M&&T[2]!==M&&L[3]!==M&&T[3]!==M&&(l?k+="M"+L[0]+","+T[1]+"L"+L[2]+","+T[2]+"H"+L[3]+"L"+L[1]+","+T[1]+"Z":k+="M"+L[1]+","+T[1]+"L"+L[2]+","+T[3]+"V"+T[2]+"L"+L[1]+","+T[0]+"Z"),k===""&&(k="M0,0Z"),g.ensureSingle(A.select(this),"path").attr("d",k).call(S.setClipUrl,s.layerClipId,h)}})})}function r(h,s,i,x){var p=s.xaxis,v=s.yaxis;g.makeTraceGroups(x,i,"trace bars").each(function(f){var d=A.select(this),o=f[0].trace,m=g.ensureSingle(d,"g","lines");if(!o.connector||!o.connector.visible||!o.connector.line.width){m.remove();return}var l=o.orientation==="h",w=m.selectAll("g.line").data(g.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var _=w.size();w.each(function(c,b){if(!(b!==_-1&&!c.cNext)){var u=t(c,p,v,l),L=u[0],T=u[1],k="";L[3]!==void 0&&T[3]!==void 0&&(l?(k+="M"+L[0]+","+T[1]+"L"+L[2]+","+T[2],k+="M"+L[1]+","+T[1]+"L"+L[3]+","+T[2]):(k+="M"+L[1]+","+T[1]+"L"+L[2]+","+T[3],k+="M"+L[1]+","+T[0]+"L"+L[2]+","+T[2])),k===""&&(k="M0,0Z"),g.ensureSingle(A.select(this),"path").attr("d",k).call(S.setClipUrl,s.layerClipId,h)}})})}function t(h,s,i,x){var p=[],v=[],f=x?s:i,d=x?i:s;return p[0]=f.c2p(h.s0,!0),v[0]=d.c2p(h.p0,!0),p[1]=f.c2p(h.s1,!0),v[1]=d.c2p(h.p1,!0),p[2]=f.c2p(h.nextS0,!0),v[2]=d.c2p(h.nextP0,!0),p[3]=f.c2p(h.nextS1,!0),v[3]=d.c2p(h.nextP1,!0),x?[p,v]:[v,p]}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/drawing"),S=y("../../components/color"),M=y("../../constants/interactions").DESELECTDIM,e=y("../bar/style"),a=y("../bar/uniform_text").resizeText,n=e.styleTextPoints;function r(t,h,s){var i=s||A.select(t).selectAll("g.funnellayer").selectAll("g.trace");a(t,i,"funnel"),i.style("opacity",function(x){return x[0].trace.opacity}),i.each(function(x){var p=A.select(this),v=x[0].trace;p.selectAll(".point > path").each(function(f){if(!f.isBlank){var d=v.marker;A.select(this).call(S.fill,f.mc||d.color).call(S.stroke,f.mlc||d.line.color).call(g.dashLine,d.line.dash,f.mlw||d.line.width).style("opacity",v.selectedpoints&&!f.selected?M:1)}}),n(p,v,t),p.selectAll(".regions").each(function(){A.select(this).selectAll("path").style("stroke-width",0).call(S.fill,v.connector.fillcolor)}),p.selectAll(".lines").each(function(){var f=v.connector.line;g.lineGroupStyle(A.select(this).selectAll("path"),f.width,f.color,f.dash)})})}ee.exports={style:r}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(y,ee,te){var A=y("../pie/attributes"),g=y("../../plots/attributes"),S=y("../../plots/domain").attributes,M=y("../../plots/template_attributes").hovertemplateAttrs,e=y("../../plots/template_attributes").texttemplateAttrs,a=y("../../lib/extend").extendFlat;ee.exports={labels:A.labels,label0:A.label0,dlabel:A.dlabel,values:A.values,marker:{colors:A.marker.colors,line:{color:a({},A.marker.line.color,{dflt:null}),width:a({},A.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:A.text,hovertext:A.hovertext,scalegroup:a({},A.scalegroup,{}),textinfo:a({},A.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:a({},g.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:M({},{keys:["label","color","value","text","percent"]}),textposition:a({},A.textposition,{values:["inside","none"],dflt:"inside"}),textfont:A.textfont,insidetextfont:A.insidetextfont,title:{text:A.title.text,font:A.title.font,position:a({},A.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:S({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(y,ee,te){var A=y("../../plots/plots");te.name="funnelarea",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],794:[function(y,ee,te){var A=y("../pie/calc");function g(M,e){return A.calc(M,e)}function S(M){A.crossTraceCalc(M,{type:"funnelarea"})}ee.exports={calc:g,crossTraceCalc:S}},{"../pie/calc":912}],795:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("../../plots/domain").defaults,M=y("../bar/defaults").handleText,e=y("../pie/defaults").handleLabelsAndValues;ee.exports=function(n,r,t,h){function s(_,c){return A.coerce(n,r,g,_,c)}var i=s("labels"),x=s("values"),p=e(i,x),v=p.len;if(r._hasLabels=p.hasLabels,r._hasValues=p.hasValues,!r._hasLabels&&r._hasValues&&(s("label0"),s("dlabel")),!v){r.visible=!1;return}r._length=v;var f=s("marker.line.width");f&&s("marker.line.color",h.paper_bgcolor),s("marker.colors"),s("scalegroup");var d=s("text"),o=s("texttemplate"),m;if(o||(m=s("textinfo",Array.isArray(d)?"text+percent":"percent")),s("hovertext"),s("hovertemplate"),o||m&&m!=="none"){var l=s("textposition");M(n,r,h,s,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}S(r,h,s);var w=s("title.text");w&&(s("title.position"),A.coerceFont(s,"title.font",h.font)),s("aspectratio"),s("baseratio")}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(y,ee,te){ee.exports={moduleType:"trace",name:"funnelarea",basePlotModule:y("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot"),style:y("./style"),styleOne:y("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(y,ee,te){var A=y("../pie/layout_attributes").hiddenlabels;ee.exports={hiddenlabels:A,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("hiddenlabels"),a("funnelareacolorway",e.colorway),a("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/drawing"),S=y("../../lib"),M=S.strScale,e=S.strTranslate,a=y("../../lib/svg_text_utils"),n=y("../bar/plot"),r=n.toMoveInsideBar,t=y("../bar/uniform_text"),h=t.recordMinTextSize,s=t.clearMinTextSize,i=y("../pie/helpers"),x=y("../pie/plot"),p=x.attachFxHandlers,v=x.determineInsideTextFont,f=x.layoutAreas,d=x.prerenderTitles,o=x.positionTitleOutside,m=x.formatSliceLabel;ee.exports=function(b,u){var L=b._context.staticPlot,T=b._fullLayout;s("funnelarea",T),d(u,b),f(u,T._size),S.makeTraceGroups(T._funnelarealayer,u,"trace").each(function(k){var P=A.select(this),z=k[0],I=z.trace;_(k),P.each(function(){var D=A.select(this).selectAll("g.slice").data(k);D.enter().append("g").classed("slice",!0),D.exit().remove(),D.each(function(O,F){if(O.hidden){A.select(this).selectAll("path,g").remove();return}O.pointNumber=O.i,O.curveNumber=I.index;var N=z.cx,G=z.cy,K=A.select(this),W=K.selectAll("path.surface").data([O]);W.enter().append("path").classed("surface",!0).style({"pointer-events":L?"none":"all"}),K.call(p,b,k);var Y="M"+(N+O.TR[0])+","+(G+O.TR[1])+l(O.TR,O.BR)+l(O.BR,O.BL)+l(O.BL,O.TL)+"Z";W.attr("d",Y),m(b,O,z);var re=i.castOption(I.textposition,O.pts),ue=K.selectAll("g.slicetext").data(O.text&&re!=="none"?[0]:[]);ue.enter().append("g").classed("slicetext",!0),ue.exit().remove(),ue.each(function(){var j=S.ensureSingle(A.select(this),"text","",function(ie){ie.attr("data-notex",1)}),q=S.ensureUniformFontSize(b,v(I,O,T.font));j.text(O.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(g.font,q).call(a.convertToTspans,b);var H=g.bBox(j.node()),U,$,ne,X=Math.min(O.BL[1],O.BR[1])+G,Q=Math.max(O.TL[1],O.TR[1])+G;$=Math.max(O.TL[0],O.BL[0])+N,ne=Math.min(O.TR[0],O.BR[0])+N,U=r($,ne,X,Q,H,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"}),U.fontSize=q.size,h(I.type,U,T),k[F].transform=U,S.setTransormAndDisplay(j,U)})});var R=A.select(this).selectAll("g.titletext").data(I.title.text?[0]:[]);R.enter().append("g").classed("titletext",!0),R.exit().remove(),R.each(function(){var O=S.ensureSingle(A.select(this),"text","",function(G){G.attr("data-notex",1)}),F=I.title.text;I._meta&&(F=S.templateString(F,I._meta)),O.text(F).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(g.font,I.title.font).call(a.convertToTspans,b);var N=o(z,T._size);O.attr("transform",e(N.x,N.y)+M(Math.min(1,N.scale))+e(N.tx,N.ty))})})})};function l(c,b){var u=b[0]-c[0],L=b[1]-c[1];return"l"+u+","+L}function w(c,b){return[.5*(c[0]+b[0]),.5*(c[1]+b[1])]}function _(c){if(!c.length)return;var b=c[0],u=b.trace,L=u.aspectratio,T=u.baseratio;T>.999&&(T=.999);var k=Math.pow(T,2),P=b.vTotal,z=P*k/(1-k),I=P,D=z/P;function R(){var se=Math.sqrt(D);return{x:se,y:-se}}function O(){var se=R();return[se.x,se.y]}var F,N=[];N.push(O());var G,K;for(G=c.length-1;G>-1;G--)if(K=c[G],!K.hidden){var W=K.v/I;D+=W,N.push(O())}var Y=1/0,re=-1/0;for(G=0;G<N.length;G++)F=N[G],Y=Math.min(Y,F[1]),re=Math.max(re,F[1]);for(G=0;G<N.length;G++)N[G][1]-=(re+Y)/2;var ue=N[N.length-1][0],j=b.r,q=(re-Y)/2,H=j/ue,U=j/q*L;for(b.r=U*q,G=0;G<N.length;G++)N[G][0]*=H,N[G][1]*=U;F=N[0];var $=[-F[0],F[1]],ne=[F[0],F[1]],X=0;for(G=c.length-1;G>-1;G--)if(K=c[G],!K.hidden){X+=1;var Q=N[X][0],ie=N[X][1];K.TL=[-Q,ie],K.TR=[Q,ie],K.BL=$,K.BR=ne,K.pxmid=w(K.TR,K.BR),$=K.TL,ne=K.TR}}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../pie/style_one"),S=y("../bar/uniform_text").resizeText;ee.exports=function(e){var a=e._fullLayout._funnelarealayer.selectAll(".trace");S(e,a,"funnelarea"),a.each(function(n){var r=n[0],t=r.trace,h=A.select(this);h.style({opacity:t.opacity}),h.selectAll("path.surface").each(function(s){A.select(this).call(g,s,t)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(y,ee,te){var A=y("../scatter/attributes"),g=y("../../plots/attributes"),S=y("../../plots/font_attributes"),M=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../plots/template_attributes").hovertemplateAttrs,a=y("../../plots/template_attributes").texttemplateAttrs,n=y("../../components/colorscale/attributes"),r=y("../../lib/extend").extendFlat;ee.exports=r({z:{valType:"data_array",editType:"calc"},x:r({},A.x,{impliedEdits:{xtype:"array"}}),x0:r({},A.x0,{impliedEdits:{xtype:"scaled"}}),dx:r({},A.dx,{impliedEdits:{xtype:"scaled"}}),y:r({},A.y,{impliedEdits:{ytype:"array"}}),y0:r({},A.y0,{impliedEdits:{ytype:"scaled"}}),dy:r({},A.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:r({},A.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:r({},A.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:r({},A.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:r({},A.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:r({},A.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:r({},A.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:e(),texttemplate:a({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:S({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:r({},g.showlegend,{dflt:!1})},{transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("../../plots/cartesian/axes"),M=y("../../plots/cartesian/align_period"),e=y("../histogram2d/calc"),a=y("../../components/colorscale/calc"),n=y("./convert_column_xyz"),r=y("./clean_2d_array"),t=y("./interp2d"),h=y("./find_empties"),s=y("./make_bound_array"),i=y("../../constants/numerical").BADNUM;ee.exports=function(f,d){var o=S.getFromId(f,d.xaxis||"x"),m=S.getFromId(f,d.yaxis||"y"),l=A.traceIs(d,"contour"),w=A.traceIs(d,"histogram"),_=A.traceIs(d,"gl2d"),c=l?"best":d.zsmooth,b,u,L,T,k,P,z,I,D,R,O;if(o._minDtick=0,m._minDtick=0,w)O=e(f,d),T=O.orig_x,b=O.x,u=O.x0,L=O.dx,I=O.orig_y,k=O.y,P=O.y0,z=O.dy,D=O.z;else{var F=d.z;g.isArray1D(F)?(n(d,o,m,"x","y",["z"]),b=d._x,k=d._y,F=d._z):(T=d.x?o.makeCalcdata(d,"x"):[],I=d.y?m.makeCalcdata(d,"y"):[],b=M(d,o,"x",T).vals,k=M(d,m,"y",I).vals,d._x=b,d._y=k),u=d.x0,L=d.dx,P=d.y0,z=d.dy,D=r(F,d,o,m)}(o.rangebreaks||m.rangebreaks)&&(D=p(b,k,D),w||(b=x(b),k=x(k),d._x=b,d._y=k)),!w&&(l||d.connectgaps)&&(d._emptypoints=h(D),t(D,d._emptypoints));function N(ne){c=d._input.zsmooth=d.zsmooth=!1,g.warn('cannot use zsmooth: "fast": '+ne)}if(c==="fast"){if(o.type==="log"||m.type==="log")N("log axis found");else if(!w){if(b.length){var G=(b[b.length-1]-b[0])/(b.length-1),K=Math.abs(G/100);for(R=0;R<b.length-1;R++)if(Math.abs(b[R+1]-b[R]-G)>K){N("x scale is not linear");break}}if(k.length&&c==="fast"){var W=(k[k.length-1]-k[0])/(k.length-1),Y=Math.abs(W/100);for(R=0;R<k.length-1;R++)if(Math.abs(k[R+1]-k[R]-W)>Y){N("y scale is not linear");break}}}}var re=g.maxRowLength(D),ue=d.xtype==="scaled"?"":b,j=s(d,ue,u,L,re,o),q=d.ytype==="scaled"?"":k,H=s(d,q,P,z,D.length,m);_||(d._extremes[o._id]=S.findExtremes(o,j),d._extremes[m._id]=S.findExtremes(m,H));var U={x:j,y:H,z:D,text:d._text||d.text,hovertext:d._hovertext||d.hovertext};if(d.xperiodalignment&&T&&(U.orig_x=T),d.yperiodalignment&&I&&(U.orig_y=I),ue&&ue.length===j.length-1&&(U.xCenter=ue),q&&q.length===H.length-1&&(U.yCenter=q),w&&(U.xRanges=O.xRanges,U.yRanges=O.yRanges,U.pts=O.pts),l||a(f,d,{vals:D,cLetter:"z"}),l&&d.contours&&d.contours.coloring==="heatmap"){var $={type:d.type==="contour"?"heatmap":"histogram2d",xcalendar:d.xcalendar,ycalendar:d.ycalendar};U.xfill=s($,ue,u,L,re,o),U.yfill=s($,q,P,z,D.length,m)}return[U]};function x(v){for(var f=[],d=v.length,o=0;o<d;o++){var m=v[o];m!==i&&f.push(m)}return f}function p(v,f,d){for(var o=[],m=-1,l=0;l<d.length;l++)if(f[l]!==i){m++,o[m]=[];for(var w=0;w<d[l].length;w++)v[w]!==i&&o[m].push(d[l][w])}return o}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../constants/numerical").BADNUM;ee.exports=function(e,a,n,r){var t,h,s,i,x,p;function v(w){if(A(w))return+w}if(a&&a.transpose){for(t=0,x=0;x<e.length;x++)t=Math.max(t,e[x].length);if(t===0)return!1;s=function(w){return w.length},i=function(w,_,c){return(w[c]||[])[_]}}else t=e.length,s=function(w,_){return w[_].length},i=function(w,_,c){return(w[_]||[])[c]};var f=function(w,_,c){return _===S||c===S?S:i(w,_,c)};function d(w){if(a&&a.type!=="carpet"&&a.type!=="contourcarpet"&&w&&w.type==="category"&&a["_"+w._id.charAt(0)].length){var _=w._id.charAt(0),c={},b=a["_"+_+"CategoryMap"]||a[_];for(x=0;x<b.length;x++)c[b[x]]=x;return function(u){var L=c[w._categories[u]];return L+1?L:S}}else return g.identity}var o=d(n),m=d(r);r&&r.type==="category"&&(t=r._categories.length);var l=new Array(t);for(x=0;x<t;x++)for(n&&n.type==="category"?h=n._categories.length:h=s(e,x),l[x]=new Array(h),p=0;p<h;p++)l[x][p]=v(f(e,m(x),o(p)));return l}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(y,ee,te){ee.exports={min:"zmin",max:"zmax"}},{}],805:[function(y,ee,te){var A=y("../../lib"),g=y("../../constants/numerical").BADNUM,S=y("../../plots/cartesian/align_period");ee.exports=function(e,a,n,r,t,h){var s=e._length,i=a.makeCalcdata(e,r),x=n.makeCalcdata(e,t);i=S(e,a,r,i).vals,x=S(e,n,t,x).vals;var p=e.text,v=p!==void 0&&A.isArray1D(p),f=e.hovertext,d=f!==void 0&&A.isArray1D(f),o,m,l=A.distinctVals(i),w=l.vals,_=A.distinctVals(x),c=_.vals,b=[],u,L,T=c.length,k=w.length;for(o=0;o<h.length;o++)b[o]=A.init2dArray(T,k);v&&(u=A.init2dArray(T,k)),d&&(L=A.init2dArray(T,k));var P=A.init2dArray(T,k);for(o=0;o<s;o++)if(i[o]!==g&&x[o]!==g){var z=A.findBin(i[o]+l.minDiff/2,w),I=A.findBin(x[o]+_.minDiff/2,c);for(m=0;m<h.length;m++){var D=h[m],R=e[D],O=b[m];O[I][z]=R[o],P[I][z]=o}v&&(u[I][z]=p[o]),d&&(L[I][z]=f[o])}for(e["_"+r]=w,e["_"+t]=c,m=0;m<h.length;m++)e["_"+h[m]]=b[m];v&&(e._text=u),d&&(e._hovertext=L),a&&a.type==="category"&&(e["_"+r+"CategoryMap"]=w.map(function(F){return a._categories[F]})),n&&n.type==="category"&&(e["_"+t+"CategoryMap"]=c.map(function(F){return n._categories[F]})),e._after2before=P}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(y,ee,te){var A=y("../../lib"),g=y("./xyz_defaults"),S=y("./label_defaults"),M=y("../scatter/period_defaults"),e=y("./style_defaults"),a=y("../../components/colorscale/defaults"),n=y("./attributes");ee.exports=function(t,h,s,i){function x(v,f){return A.coerce(t,h,n,v,f)}var p=g(t,h,x,i);if(!p){h.visible=!1;return}M(t,h,i,x),x("xhoverformat"),x("yhoverformat"),x("text"),x("hovertext"),x("hovertemplate"),S(x,i),e(t,h,x,i),x("hoverongaps"),x("connectgaps",A.isArray1D(h.z)&&h.zsmooth!==!1),a(t,h,i,x,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(y,ee,te){var A=y("../../lib").maxRowLength;ee.exports=function(S){var M=[],e={},a=[],n=S[0],r=[],t=[0,0,0],h=A(S),s,i,x,p,v,f,d,o;for(i=0;i<S.length;i++)for(s=r,r=n,n=S[i+1]||[],x=0;x<h;x++)r[x]===void 0&&(f=(r[x-1]!==void 0?1:0)+(r[x+1]!==void 0?1:0)+(s[x]!==void 0?1:0)+(n[x]!==void 0?1:0),f?(i===0&&f++,x===0&&f++,i===S.length-1&&f++,x===r.length-1&&f++,f<4&&(e[[i,x]]=[i,x,f]),M.push([i,x,f])):a.push([i,x]));for(;a.length;){for(d={},o=!1,v=a.length-1;v>=0;v--)p=a[v],i=p[0],x=p[1],f=((e[[i-1,x]]||t)[2]+(e[[i+1,x]]||t)[2]+(e[[i,x-1]]||t)[2]+(e[[i,x+1]]||t)[2])/20,f&&(d[p]=[i,x,f],a.splice(v,1),o=!0);if(!o)throw"findEmpties iterated with no new neighbors";for(p in d)e[p]=d[p],M.push(d[p])}return M.sort(function(m,l){return l[2]-m[2]})}},{"../../lib":515}],808:[function(y,ee,te){var A=y("../../components/fx"),g=y("../../lib"),S=y("../../plots/cartesian/axes"),M=y("../../components/colorscale").extractOpts;ee.exports=function(a,n,r,t,h){h||(h={});var s=h.isContour,i=a.cd[0],x=i.trace,p=a.xa,v=a.ya,f=i.x,d=i.y,o=i.z,m=i.xCenter,l=i.yCenter,w=i.zmask,_=x.zhoverformat,c=f,b=d,u,L,T,k;if(a.index!==!1){try{T=Math.round(a.index[1]),k=Math.round(a.index[0])}catch{g.error("Error hovering on heatmap, pointNumber must be [row,col], found:",a.index);return}if(T<0||T>=o[0].length||k<0||k>o.length)return}else{if(A.inbox(n-f[0],n-f[f.length-1],0)>0||A.inbox(r-d[0],r-d[d.length-1],0)>0)return;if(s){var P;for(c=[2*f[0]-f[1]],P=1;P<f.length;P++)c.push((f[P]+f[P-1])/2);for(c.push([2*f[f.length-1]-f[f.length-2]]),b=[2*d[0]-d[1]],P=1;P<d.length;P++)b.push((d[P]+d[P-1])/2);b.push([2*d[d.length-1]-d[d.length-2]])}T=Math.max(0,Math.min(c.length-2,g.findBin(n,c))),k=Math.max(0,Math.min(b.length-2,g.findBin(r,b)))}var z=p.c2p(f[T]),I=p.c2p(f[T+1]),D=v.c2p(d[k]),R=v.c2p(d[k+1]),O,F;s?(O=i.orig_x||f,F=i.orig_y||d,I=z,u=O[T],R=D,L=F[k]):(O=i.orig_x||m||f,F=i.orig_y||l||d,u=m?O[T]:(O[T]+O[T+1])/2,L=l?F[k]:(F[k]+F[k+1])/2,p&&p.type==="category"&&(u=f[T]),v&&v.type==="category"&&(L=d[k]),x.zsmooth&&(z=I=p.c2p(u),D=R=v.c2p(L)));var N=o[k][T];if(w&&!w[k][T]&&(N=void 0),!(N===void 0&&!x.hoverongaps)){var G;Array.isArray(i.hovertext)&&Array.isArray(i.hovertext[k])?G=i.hovertext[k][T]:Array.isArray(i.text)&&Array.isArray(i.text[k])&&(G=i.text[k][T]);var K=M(x),W={type:"linear",range:[K.min,K.max],hoverformat:_,_separators:p._separators,_numFormat:p._numFormat},Y=S.tickText(W,N,"hover").text;return[g.extendFlat(a,{index:x._after2before?x._after2before[k][T]:[k,T],distance:a.maxHoverDistance,spikeDistance:a.maxSpikeDistance,x0:z,x1:I,y0:D,y1:R,xLabelVal:u,yLabelVal:L,zLabelVal:N,zLabel:Y,text:G})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),colorbar:y("./colorbar"),style:y("./style"),hoverPoints:y("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(y,ee,te){var A=y("../../lib"),g=.01,S=[[-1,0],[1,0],[0,-1],[0,1]];function M(a){return .5-.25*Math.min(1,a*.5)}ee.exports=function(n,r){var t=1,h;for(e(n,r),h=0;h<r.length&&!(r[h][2]<4);h++);for(r=r.slice(h),h=0;h<100&&t>g;h++)t=e(n,r,M(t));return t>g&&A.log("interp2d didn't converge quickly",t),n};function e(a,n,r){var t=0,h,s,i,x,p,v,f,d,o,m,l,w,_;for(x=0;x<n.length;x++){for(h=n[x],s=h[0],i=h[1],l=a[s][i],m=0,o=0,p=0;p<4;p++)v=S[p],f=a[s+v[0]],f&&(d=f[i+v[1]],d!==void 0&&(m===0?w=_=d:(w=Math.min(w,d),_=Math.max(_,d)),o++,m+=d));if(o===0)throw"iterateInterp2d order is wrong: no defined neighbors";a[s][i]=m/o,l===void 0?o<4&&(t=1):(a[s][i]=(1+r)*a[s][i]-r*l,_>w&&(t=Math.max(t,Math.abs(a[s][i]-l)/(_-w))))}return t}},{"../../lib":515}],811:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){S("texttemplate");var e=A.extendFlat({},M.font,{color:"auto",size:"auto"});A.coerceFont(S,"textfont",e)}},{"../../lib":515}],812:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n,r,t){var h=[],s=A.traceIs(M,"contour"),i=A.traceIs(M,"histogram"),x=A.traceIs(M,"gl2d"),p,v,f,d=g(e)&&e.length>1;if(d&&!i&&t.type!=="category"){var o=e.length;if(o<=r){if(s||x)h=e.slice(0,r);else if(r===1)h=[e[0]-.5,e[0]+.5];else{for(h=[1.5*e[0]-.5*e[1]],f=1;f<o;f++)h.push((e[f-1]+e[f])*.5);h.push(1.5*e[o-1]-.5*e[o-2])}if(o<r){var m=h[h.length-1],l=m-h[h.length-2];for(f=o;f<r;f++)m+=l,h.push(m)}}else return s?e.slice(0,r):e.slice(0,r+1)}else{var w=M[t._id.charAt(0)+"calendar"];if(i)p=t.r2c(a,0,w);else if(g(e)&&e.length===1)p=e[0];else if(a===void 0)p=0;else{var _=t.type==="log"?t.d2c:t.r2c;p=_(a,0,w)}for(v=n||1,f=s||x?0:-.5;f<r;f++)h.push(p+v*f)}return h}},{"../../lib":515,"../../registry":647}],813:[function(y,ee,te){var A=y("@plotly/d3"),g=y("tinycolor2"),S=y("../../registry"),M=y("../../components/drawing"),e=y("../../plots/cartesian/axes"),a=y("../../lib"),n=y("../../lib/svg_text_utils"),r=y("../scatter/format_labels"),t=y("../../components/color"),h=y("../../components/colorscale").extractOpts,s=y("../../components/colorscale").makeColorScaleFuncFromTrace,i=y("../../constants/xmlns_namespaces"),x=y("../../constants/alignment"),p=x.LINE_SPACING,v="heatmap-label";function f(w){return w.selectAll("g."+v)}function d(w){f(w).remove()}ee.exports=function(w,_,c,b){var u=_.xaxis,L=_.yaxis;a.makeTraceGroups(b,c,"hm").each(function(T){var k=A.select(this),P=T[0],z=P.trace,I=z.xgap||0,D=z.ygap||0,R=P.z,O=P.x,F=P.y,N=P.xCenter,G=P.yCenter,K=S.traceIs(z,"contour"),W=K?"best":z.zsmooth,Y=R.length,re=a.maxRowLength(R),ue=!1,j=!1,q,H,U,$,ne,X,Q,ie;for(X=0;q===void 0&&X<O.length-1;)q=u.c2p(O[X]),X++;for(X=O.length-1;H===void 0&&X>0;)H=u.c2p(O[X]),X--;for(H<q&&(U=H,H=q,q=U,ue=!0),X=0;$===void 0&&X<F.length-1;)$=L.c2p(F[X]),X++;for(X=F.length-1;ne===void 0&&X>0;)ne=L.c2p(F[X]),X--;if(ne<$&&(U=$,$=ne,ne=U,j=!0),K&&(N=O,G=F,O=P.xfill,F=P.yfill),W!=="fast"){var se=W==="best"?0:.5;q=Math.max(-se*u._length,q),H=Math.min((1+se)*u._length,H),$=Math.max(-se*L._length,$),ne=Math.min((1+se)*L._length,ne)}var ae=Math.round(H-q),oe=Math.round(ne-$),be=ae<=0||oe<=0;if(be){var ce=k.selectAll("image").data([]);ce.exit().remove(),d(k);return}var de,ye;W==="fast"?(de=re,ye=Y):(de=ae,ye=oe);var ge=document.createElement("canvas");ge.width=de,ge.height=ye;var me=ge.getContext("2d"),Ee=s(z,{noNumericCheck:!0,returnArray:!0}),Pe,Ue;W==="fast"?(Pe=ue?function(Er){return re-1-Er}:a.identity,Ue=j?function(Er){return Y-1-Er}:a.identity):(Pe=function(Er){return a.constrain(Math.round(u.c2p(O[Er])-q),0,ae)},Ue=function(Er){return a.constrain(Math.round(L.c2p(F[Er])-$),0,oe)});var we=Ue(0),ke=[we,we],Xe=ue?0:1,Ve=j?0:1,Ie=0,De=0,Ye=0,vt=0,Dt,Kt,Ft,Mt,Xt;function It(Er,wr){if(Er!==void 0){var Gr=Ee(Er);return Gr[0]=Math.round(Gr[0]),Gr[1]=Math.round(Gr[1]),Gr[2]=Math.round(Gr[2]),Ie+=wr,De+=Gr[0]*wr,Ye+=Gr[1]*wr,vt+=Gr[2]*wr,Gr}return[0,0,0,0]}function At(Er,wr,Gr,wn){var cn=Er[Gr.bin0];if(cn===void 0)return It(void 0,1);var Bn=Er[Gr.bin1],En=wr[Gr.bin0],Yn=wr[Gr.bin1],Vn=Bn-cn||0,pa=En-cn||0,Ma;return Bn===void 0?Yn===void 0?Ma=0:En===void 0?Ma=2*(Yn-cn):Ma=(2*Yn-En-cn)*2/3:Yn===void 0?En===void 0?Ma=0:Ma=(2*cn-Bn-En)*2/3:En===void 0?Ma=(2*Yn-Bn-cn)*2/3:Ma=Yn+cn-Bn-En,It(cn+Gr.frac*Vn+wn.frac*(pa+Gr.frac*Ma))}if(W){var Ge=0,tt;try{tt=new Uint8Array(ae*oe*4)}catch{tt=new Array(ae*oe*4)}if(W==="best"){var He=N||O,Ae=G||F,Ne=new Array(He.length),Ze=new Array(Ae.length),Qe=new Array(ae),bt=N?m:o,dt=G?m:o,wt,Ut,Rt;for(X=0;X<He.length;X++)Ne[X]=Math.round(u.c2p(He[X])-q);for(X=0;X<Ae.length;X++)Ze[X]=Math.round(L.c2p(Ae[X])-$);for(X=0;X<ae;X++)Qe[X]=bt(X,Ne);for(Q=0;Q<oe;Q++)for(wt=dt(Q,Ze),Ut=R[wt.bin0],Rt=R[wt.bin1],X=0;X<ae;X++,Ge+=4)Xt=At(Ut,Rt,Qe[X],wt),l(tt,Ge,Xt)}else for(Q=0;Q<Y;Q++)for(Mt=R[Q],ke=Ue(Q),X=0;X<ae;X++)Xt=It(Mt[X],1),Ge=(ke*ae+Pe(X))*4,l(tt,Ge,Xt);var Nt=me.createImageData(ae,oe);try{Nt.data.set(tt)}catch{var Wt=Nt.data,Vt=Wt.length;for(Q=0;Q<Vt;Q++)Wt[Q]=tt[Q]}me.putImageData(Nt,0,0)}else{var ir=Math.floor(I/2),Hr=Math.floor(D/2);for(Q=0;Q<Y;Q++)if(Mt=R[Q],ke.reverse(),ke[Ve]=Ue(Q+1),!(ke[0]===ke[1]||ke[0]===void 0||ke[1]===void 0))for(Kt=Pe(0),Dt=[Kt,Kt],X=0;X<re;X++)Dt.reverse(),Dt[Xe]=Pe(X+1),!(Dt[0]===Dt[1]||Dt[0]===void 0||Dt[1]===void 0)&&(Ft=Mt[X],Xt=It(Ft,(Dt[1]-Dt[0])*(ke[1]-ke[0])),me.fillStyle="rgba("+Xt.join(",")+")",me.fillRect(Dt[0]+ir,ke[0]+Hr,Dt[1]-Dt[0]-I,ke[1]-ke[0]-D))}De=Math.round(De/Ie),Ye=Math.round(Ye/Ie),vt=Math.round(vt/Ie);var sn=g("rgb("+De+","+Ye+","+vt+")");w._hmpixcount=(w._hmpixcount||0)+Ie,w._hmlumcount=(w._hmlumcount||0)+Ie*sn.getLuminance();var jr=k.selectAll("image").data(T);jr.enter().append("svg:image").attr({xmlns:i.svg,preserveAspectRatio:"none"}),jr.attr({height:oe,width:ae,x:q,y:$,"xlink:href":ge.toDataURL("image/png")}),d(k);var at=z.texttemplate;if(at){var $t=h(z),Jt={type:"linear",range:[$t.min,$t.max],_separators:u._separators,_numFormat:u._numFormat},Gt=z.type==="histogram2dcontour",_r=z.type==="contour",rt=_r?1:0,Je=_r?Y-1:Y,st=_r?1:0,lt=_r?re-1:re,Tt=[];for(X=rt;X<Je;X++){var zt;if(_r)zt=P.y[X];else if(Gt){if(X===0||X===Y-1)continue;zt=P.y[X]}else if(P.yCenter)zt=P.yCenter[X];else{if(X+1===Y&&P.y[X+1]===void 0)continue;zt=(P.y[X]+P.y[X+1])/2}var Ce=Math.round(L.c2p(zt));if(!(0>Ce||Ce>L._length))for(Q=st;Q<lt;Q++){var Se;if(_r)Se=P.x[Q];else if(Gt){if(Q===0||Q===re-1)continue;Se=P.x[Q]}else if(P.xCenter)Se=P.xCenter[Q];else{if(Q+1===re&&P.x[Q+1]===void 0)continue;Se=(P.x[Q]+P.x[Q+1])/2}var nt=Math.round(u.c2p(Se));if(!(0>nt||nt>u._length)){var it=r({x:Se,y:zt},z,w._fullLayout);it.x=Se,it.y=zt;var ct=P.z[X][Q];ct===void 0?(it.z="",it.zLabel=""):(it.z=ct,it.zLabel=e.tickText(Jt,ct,"hover").text);var kt=P.text&&P.text[X]&&P.text[X][Q];(kt===void 0||kt===!1)&&(kt=""),it.text=kt;var gt=a.texttemplateString(at,it,w._fullLayout._d3locale,it,z._meta||{});if(gt){var St=gt.split("<br>"),Yt=St.length,ar=0;for(ie=0;ie<Yt;ie++)ar=Math.max(ar,St[ie].length);Tt.push({l:Yt,c:ar,t:gt,x:nt,y:Ce,z:ct})}}}}var kr=z.textfont,br=kr.family,Mr=kr.size,Yr=w._fullLayout.font.size;if(!Mr||Mr==="auto"){var nr=1/0,gr=1/0,Rr=0,Br=0;for(ie=0;ie<Tt.length;ie++){var Sr=Tt[ie];if(Rr=Math.max(Rr,Sr.l),Br=Math.max(Br,Sr.c),ie<Tt.length-1){var et=Tt[ie+1],Lt=Math.abs(et.x-Sr.x),Zt=Math.abs(et.y-Sr.y);Lt&&(nr=Math.min(nr,Lt)),Zt&&(gr=Math.min(gr,Zt))}}!isFinite(nr)||!isFinite(gr)?Mr=Yr:(nr-=I,gr-=D,nr/=Br,gr/=Rr,nr/=p/2,gr/=p,Mr=Math.min(Math.floor(nr),Math.floor(gr),Yr))}if(Mr<=0||!isFinite(Mr))return;var or=function(Er){return Er.x},Ir=function(Er){return Er.y-Mr*(Er.l*p/2-1)},Or=f(k).data(Tt);Or.enter().append("g").classed(v,1).append("text").attr("text-anchor","middle").each(function(Er){var wr=A.select(this),Gr=kr.color;(!Gr||Gr==="auto")&&(Gr=t.contrast("rgba("+Ee(Er.z).join()+")")),wr.attr("data-notex",1).call(n.positionText,or(Er),Ir(Er)).call(M.font,br,Mr,Gr).text(Er.t).call(n.convertToTspans,w)})}})};function o(w,_){var c=_.length-2,b=a.constrain(a.findBin(w,_),0,c),u=_[b],L=_[b+1],T=a.constrain(b+(w-u)/(L-u)-.5,0,c),k=Math.round(T),P=Math.abs(T-k);return!T||T===c||!P?{bin0:k,bin1:k,frac:0}:{bin0:k,frac:P,bin1:Math.round(k+P/(T-k))}}function m(w,_){var c=_.length-1,b=a.constrain(a.findBin(w,_),0,c),u=_[b],L=_[b+1],T=(w-u)/(L-u)||0;return T<=0?{bin0:b,bin1:b,frac:0}:T<.5?{bin0:b,bin1:b+1,frac:T}:{bin0:b+1,bin1:b,frac:1-T}}function l(w,_,c){w[_]=c[0],w[_+1]=c[1],w[_+2]=c[2],w[_+3]=Math.round(c[3]*255)}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(y,ee,te){var A=y("@plotly/d3");ee.exports=function(S){A.select(S).selectAll(".hm image").style("opacity",function(M){return M.trace.opacity})}},{"@plotly/d3":58}],815:[function(y,ee,te){ee.exports=function(g,S,M){var e=M("zsmooth");e===!1&&(M("xgap"),M("ygap")),M("zhoverformat")}},{}],816:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../registry");ee.exports=function(n,r,t,h,s,i){var x=t("z");s=s||"x",i=i||"y";var p,v;if(x===void 0||!x.length)return 0;if(g.isArray1D(n.z)){p=t(s),v=t(i);var f=g.minRowLength(p),d=g.minRowLength(v);if(f===0||d===0)return 0;r._length=Math.min(f,d,x.length)}else{if(p=M(s,t),v=M(i,t),!e(x))return 0;t("transpose"),r._length=null}if(n.type==="heatmapgl")return!0;var o=S.getComponentMethod("calendars","handleTraceDefaults");return o(n,r,[s,i],h),!0};function M(a,n){var r=n(a),t=r?n(a+"type","array"):"scaled";return t==="scaled"&&(n(a+"0"),n("d"+a)),r}function e(a){for(var n=!0,r=!1,t=!1,h,s=0;s<a.length;s++){if(h=a[s],!g.isArrayOrTypedArray(h)){n=!1;break}h.length>0&&(r=!0);for(var i=0;i<h.length;i++)if(A(h[i])){t=!0;break}}return n&&r&&t}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(y,ee,te){for(var A=y("../heatmap/attributes"),g=y("../../components/colorscale/attributes"),S=y("../../lib/extend").extendFlat,M=y("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],a={},n=0;n<e.length;n++){var r=e[n];a[r]=A[r]}a.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},S(a,g("",{cLetter:"z",autoColorDflt:!1})),ee.exports=M(a,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_heatmap2d,g=y("../../plots/cartesian/axes"),S=y("../../lib/str2rgbarray");function M(r,t){this.scene=r,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=A(r.glplot,this.options),this.heatmap._trace=this}var e=M.prototype;e.handlePick=function(r){var t=this.options,h=t.shape,s=r.pointId,i=s%h[0],x=Math.floor(s/h[0]),p=s;return{trace:this,dataCoord:r.dataCoord,traceCoord:[t.x[i],t.y[x],t.z[p]],textLabel:this.textLabels[s],name:this.name,pointIndex:[x,i],hoverinfo:this.hoverinfo}},e.update=function(r,t){var h=t[0];this.index=r.index,this.name=r.name,this.hoverinfo=r.hoverinfo;var s=h.z;this.options.z=[].concat.apply([],s);var i=s[0].length,x=s.length;this.options.shape=[i,x],this.options.x=h.x,this.options.y=h.y,this.options.zsmooth=r.zsmooth;var p=a(r);this.options.colorLevels=p.colorLevels,this.options.colorValues=p.colorValues,this.textLabels=[].concat.apply([],r.text),this.heatmap.update(this.options);var v=this.scene.xaxis,f=this.scene.yaxis,d,o;r.zsmooth===!1&&(d={ppad:h.x[1]-h.x[0]},o={ppad:h.y[1]-h.y[0]}),r._extremes[v._id]=g.findExtremes(v,h.x,d),r._extremes[f._id]=g.findExtremes(f,h.y,o)},e.dispose=function(){this.heatmap.dispose()};function a(r){for(var t=r.colorscale,h=r.zmin,s=r.zmax,i=t.length,x=new Array(i),p=new Array(4*i),v=0;v<i;v++){var f=t[v],d=S(f[1]);x[v]=h+f[0]*(s-h);for(var o=0;o<4;o++)p[4*v+o]=d[o]}return{colorLevels:x,colorValues:p}}function n(r,t,h){var s=new M(r,t.uid);return s.update(t,h),s}ee.exports=n},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(y,ee,te){var A=y("../../lib"),g=y("../heatmap/xyz_defaults"),S=y("../../components/colorscale/defaults"),M=y("./attributes");ee.exports=function(a,n,r,t){function h(i,x){return A.coerce(a,n,M,i,x)}var s=g(a,n,h,t);if(!s){n.visible=!1;return}h("text"),h("zsmooth"),S(a,n,t,h,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../heatmap/colorbar"),calc:y("../heatmap/calc"),plot:y("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:y("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(y,ee,te){var A=y("../bar/attributes"),g=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../../plots/template_attributes").texttemplateAttrs,e=y("../../plots/font_attributes"),a=y("./bin_attributes"),n=y("./constants"),r=y("../../lib/extend").extendFlat;ee.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:g("x"),yhoverformat:g("y"),text:r({},A.text,{}),hovertext:r({},A.hovertext,{}),orientation:A.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:a("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:a("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:S({},{keys:n.eventDataKeys}),texttemplate:M({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:r({},A.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:A.insidetextanchor,textangle:A.textangle,cliponaxis:A.cliponaxis,constraintext:A.constraintext,marker:A.marker,offsetgroup:A.offsetgroup,alignmentgroup:A.alignmentgroup,selected:A.selected,unselected:A.unselected,_deprecated:{bardir:A._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(y,ee,te){ee.exports=function(g,S){for(var M=g.length,e=0,a=0;a<M;a++)S[a]?(g[a]/=S[a],e+=g[a]):g[a]=null;return e}},{}],823:[function(y,ee,te){ee.exports=function(g,S){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(y,ee,te){var A=y("fast-isnumeric");ee.exports={count:function(g,S,M){return M[g]++,1},sum:function(g,S,M,e){var a=e[S];return A(a)?(a=Number(a),M[g]+=a,a):0},avg:function(g,S,M,e,a){var n=e[S];return A(n)&&(n=Number(n),M[g]+=n,a[g]++),0},min:function(g,S,M,e){var a=e[S];if(A(a))if(a=Number(a),A(M[g])){if(M[g]>a){var n=a-M[g];return M[g]=a,n}}else return M[g]=a,a;return 0},max:function(g,S,M,e){var a=e[S];if(A(a))if(a=Number(a),A(M[g])){if(M[g]<a){var n=a-M[g];return M[g]=a,n}}else return M[g]=a,a;return 0}}},{"fast-isnumeric":190}],825:[function(y,ee,te){var A=y("../../constants/numerical"),g=A.ONEAVGYEAR,S=A.ONEAVGMONTH,M=A.ONEDAY,e=A.ONEHOUR,a=A.ONEMIN,n=A.ONESEC,r=y("../../plots/cartesian/axes").tickIncrement;ee.exports=function(p,v,f,d,o){var m=-1.1*v,l=-.1*v,w=p-l,_=f[0],c=f[1],b=Math.min(t(_+l,_+w,d,o),t(c+l,c+w,d,o)),u=Math.min(t(_+m,_+l,d,o),t(c+m,c+l,d,o)),L,T;if(b>u&&u<Math.abs(c-_)/4e3?(L=b,T=!1):(L=Math.min(b,u),T=!0),d.type==="date"&&L>M){var k=L===g?1:6,P=L===g?"M12":"M1";return function(z,I){var D=d.c2d(z,g,o),R=D.indexOf("-",k);R>0&&(D=D.substr(0,R));var O=d.d2c(D,0,o);if(O<z){var F=r(O,P,!1,o);(O+F)/2<z+p&&(O=F)}return I&&T?r(O,P,!0,o):O}}return function(z,I){var D=L*Math.round(z/L);return D+L/10<z&&D+L*.9<z+p&&(D+=L),I&&T&&(D-=L),D}};function t(x,p,v,f){if(x*p<=0)return 1/0;for(var d=Math.abs(p-x),o=v.type==="date",m=h(d,o),l=0;l<10;l++){var w=h(m*80,o);if(m===w)break;if(s(w,x,p,o,v,f))m=w;else break}return m}function h(x,p){return p&&x>n?x>M?x>g*1.1?g:x>S*1.1?S:M:x>e?e:x>a?a:n:Math.pow(10,Math.floor(Math.log(x)/Math.LN10))}function s(x,p,v,f,d,o){if(f&&x>M){var m=i(p,d,o),l=i(v,d,o),w=x===g?0:1;return m[w]!==l[w]}return Math.floor(v/x)-Math.floor(p/x)>.1}function i(x,p,v){var f=p.c2d(x,g,v).split("-");return f[0]===""&&(f.unshift(),f[0]="-"+f[0]),f}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../registry"),M=y("../../plots/cartesian/axes"),e=y("../bar/arrays_to_calcdata"),a=y("./bin_functions"),n=y("./norm_functions"),r=y("./average"),t=y("./bin_label_vals");function h(v,f){var d=[],o=[],m=f.orientation==="h",l=M.getFromId(v,m?f.yaxis:f.xaxis),w=m?"y":"x",_={x:"y",y:"x"}[w],c=f[w+"calendar"],b=f.cumulative,u,L=s(v,f,l,w),T=L[0],k=L[1],P=typeof T.size=="string",z=[],I=P?z:T,D=[],R=[],O=[],F=0,N=f.histnorm,G=f.histfunc,K=N.indexOf("density")!==-1,W,Y,re;b.enabled&&K&&(N=N.replace(/ ?density$/,""),K=!1);var ue=G==="max"||G==="min",j=ue?null:0,q=a.count,H=n[N],U=!1,$=function(Ue){return l.r2c(Ue,0,c)},ne;for(g.isArrayOrTypedArray(f[_])&&G!=="count"&&(ne=f[_],U=G==="avg",q=a[G]),u=$(T.start),Y=$(T.end)+(u-M.tickIncrement(u,T.size,!1,c))/1e6;u<Y&&d.length<1e6&&(W=M.tickIncrement(u,T.size,!1,c),d.push((u+W)/2),o.push(j),O.push([]),z.push(u),K&&D.push(1/(W-u)),U&&R.push(0),!(W<=u));)u=W;z.push(u),!P&&l.type==="date"&&(I={start:$(I.start),end:$(I.end),size:I.size}),v._fullLayout._roundFnOpts||(v._fullLayout._roundFnOpts={});var X=f["_"+w+"bingroup"],Q={leftGap:1/0,rightGap:1/0};X&&(v._fullLayout._roundFnOpts[X]||(v._fullLayout._roundFnOpts[X]=Q),Q=v._fullLayout._roundFnOpts[X]);var ie=o.length,se=!0,ae=Q.leftGap,oe=Q.rightGap,be={};for(u=0;u<k.length;u++){var ce=k[u];re=g.findBin(ce,I),re>=0&&re<ie&&(F+=q(re,u,o,ne,R),se&&O[re].length&&ce!==k[O[re][0]]&&(se=!1),O[re].push(u),be[u]=re,ae=Math.min(ae,ce-z[re]),oe=Math.min(oe,z[re+1]-ce))}Q.leftGap=ae,Q.rightGap=oe;var de;se||(de=function(Ue,we){return function(){var ke=v._fullLayout._roundFnOpts[X];return t(ke.leftGap,ke.rightGap,z,l,c)(Ue,we)}}),U&&(F=r(o,R)),H&&H(o,F,D),b.enabled&&p(o,b.direction,b.currentbin);var ye=Math.min(d.length,o.length),ge=[],me=0,Ee=ye-1;for(u=0;u<ye;u++)if(o[u]){me=u;break}for(u=ye-1;u>=me;u--)if(o[u]){Ee=u;break}for(u=me;u<=Ee;u++)if(A(d[u])&&A(o[u])){var Pe={p:d[u],s:o[u],b:0};b.enabled||(Pe.pts=O[u],se?Pe.ph0=Pe.ph1=O[u].length?k[O[u][0]]:d[u]:(f._computePh=!0,Pe.ph0=de(z[u]),Pe.ph1=de(z[u+1],!0))),ge.push(Pe)}return ge.length===1&&(ge[0].width1=M.tickIncrement(ge[0].p,T.size,!1,c)-ge[0].p),e(ge,f),g.isArrayOrTypedArray(f.selectedpoints)&&g.tagSelected(ge,f,be),ge}function s(v,f,d,o,m){var l=o+"bins",w=v._fullLayout,_=f["_"+o+"bingroup"],c=w._histogramBinOpts[_],b=w.barmode==="overlay",u,L,T,k,P,z,I,D=function(ce){return d.r2c(ce,0,k)},R=function(ce){return d.c2r(ce,0,k)},O=d.type==="date"?function(ce){return ce||ce===0?g.cleanDate(ce,null,k):null}:function(ce){return A(ce)?Number(ce):null};function F(ce,de,ye){de[ce+"Found"]?(de[ce]=O(de[ce]),de[ce]===null&&(de[ce]=ye[ce])):(z[ce]=de[ce]=ye[ce],g.nestedProperty(L[0],l+"."+ce).set(ye[ce]))}if(f["_"+o+"autoBinFinished"])delete f["_"+o+"autoBinFinished"];else{L=c.traces;var N=[],G=!0,K=!1,W=!1;for(u=0;u<L.length;u++)if(T=L[u],T.visible){var Y=c.dirs[u];P=T["_"+Y+"pos0"]=d.makeCalcdata(T,Y),N=g.concat(N,P),delete T["_"+o+"autoBinFinished"],f.visible===!0&&(G?G=!1:(delete T._autoBin,T["_"+o+"autoBinFinished"]=1),S.traceIs(T,"2dMap")&&(K=!0),T.type==="histogram2dcontour"&&(W=!0))}k=L[0][o+"calendar"];var re=M.autoBin(N,d,c.nbins,K,k,c.sizeFound&&c.size),ue=L[0]._autoBin={};if(z=ue[c.dirs[0]]={},W&&(c.size||(re.start=R(M.tickIncrement(D(re.start),re.size,!0,k))),c.end===void 0&&(re.end=R(M.tickIncrement(D(re.end),re.size,!1,k)))),b&&!S.traceIs(f,"2dMap")&&re._dataSpan===0&&d.type!=="category"&&d.type!=="multicategory"){if(m)return[re,P,!0];re=i(v,f,d,o,l)}I=T.cumulative||{},I.enabled&&I.currentbin!=="include"&&(I.direction==="decreasing"?re.start=R(M.tickIncrement(D(re.start),re.size,!0,k)):re.end=R(M.tickIncrement(D(re.end),re.size,!1,k))),c.size=re.size,c.sizeFound||(z.size=re.size,g.nestedProperty(L[0],l+".size").set(re.size)),F("start",c,re),F("end",c,re)}P=f["_"+o+"pos0"],delete f["_"+o+"pos0"];var j=f._input[l]||{},q=g.extendFlat({},c),H=c.start,U=d.r2l(j.start),$=U!==void 0;if((c.startFound||$)&&U!==d.r2l(H)){var ne=$?U:g.aggNums(Math.min,null,P),X={type:d.type==="category"||d.type==="multicategory"?"linear":d.type,r2l:d.r2l,dtick:c.size,tick0:H,calendar:k,range:[ne,M.tickIncrement(ne,c.size,!1,k)].map(d.l2r)},Q=M.tickFirst(X);Q>d.r2l(ne)&&(Q=M.tickIncrement(Q,c.size,!0,k)),q.start=d.l2r(Q),$||g.nestedProperty(f,l+".start").set(q.start)}var ie=c.end,se=d.r2l(j.end),ae=se!==void 0;if((c.endFound||ae)&&se!==d.r2l(ie)){var oe=ae?se:g.aggNums(Math.max,null,P);q.end=d.l2r(oe),ae||g.nestedProperty(f,l+".start").set(q.end)}var be="autobin"+o;return f._input[be]===!1&&(f._input[l]=g.extendFlat({},f[l]||{}),delete f._input[be],delete f[be]),[q,P]}function i(v,f,d,o,m){var l=v._fullLayout,w=x(v,f),_=!1,c=1/0,b=[f],u,L,T;for(u=0;u<w.length;u++)if(L=w[u],L===f)_=!0;else if(!_)T=l._histogramBinOpts[L["_"+o+"bingroup"]],c=Math.min(c,T.size||L[m].size);else{var k=s(v,L,d,o,!0),P=k[0],z=k[2];L["_"+o+"autoBinFinished"]=1,L["_"+o+"pos0"]=k[1],z?b.push(L):c=Math.min(c,P.size)}var I=new Array(b.length);for(u=0;u<b.length;u++)for(var D=b[u]["_"+o+"pos0"],R=0;R<D.length;R++)if(D[R]!==void 0){I[u]=D[R];break}for(isFinite(c)||(c=g.distinctVals(I).minDiff),u=0;u<b.length;u++){L=b[u];var O=L[o+"calendar"],F={start:d.c2r(I[u]-c/2,0,O),end:d.c2r(I[u]+c/2,0,O),size:c};L._input[m]=L[m]=F,T=l._histogramBinOpts[L["_"+o+"bingroup"]],T&&g.extendFlat(T,F)}return f[m]}function x(v,f){for(var d=f.xaxis,o=f.yaxis,m=f.orientation,l=[],w=v._fullData,_=0;_<w.length;_++){var c=w[_];c.type==="histogram"&&c.visible===!0&&c.orientation===m&&c.xaxis===d&&c.yaxis===o&&l.push(c)}return l}function p(v,f,d){var o,m,l;function w(c){l=v[c],v[c]/=2}function _(c){m=v[c],v[c]=l+m/2,l+=m}if(d==="half")if(f==="increasing")for(w(0),o=1;o<v.length;o++)_(o);else for(w(v.length-1),o=v.length-2;o>=0;o--)_(o);else if(f==="increasing"){for(o=1;o<v.length;o++)v[o]+=v[o-1];d==="exclude"&&(v.unshift(0),v.pop())}else{for(o=v.length-2;o>=0;o--)v[o]+=v[o+1];d==="exclude"&&(v.push(0),v.shift())}}ee.exports={calc:h,calcAllAutoBins:s}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(y,ee,te){ee.exports={eventDataKeys:["binNumber"]}},{}],828:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axis_ids"),S=y("../../registry").traceIs,M=y("../bar/defaults").handleGroupingDefaults,e=A.nestedProperty,a=y("../../plots/cartesian/constraints").getAxisGroup,n=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],r=["x","y"];ee.exports=function(h,s){var i=s._histogramBinOpts={},x=[],p={},v=[],f,d,o,m,l,w,_;function c(W,Y){return A.coerce(f._input,f,f._module.attributes,W,Y)}function b(W){return W.orientation==="v"?"x":"y"}function u(W,Y){var re=g.getFromTrace({_fullLayout:s},W,Y);return re.type}function L(W,Y,re){var ue=W.uid+"__"+re;Y||(Y=ue);var j=u(W,re),q=W[re+"calendar"]||"",H=i[Y],U=!0;H&&(j===H.axType&&q===H.calendar?(U=!1,H.traces.push(W),H.dirs.push(re)):(Y=ue,j!==H.axType&&A.warn(["Attempted to group the bins of trace",W.index,"set on a","type:"+j,"axis","with bins on","type:"+H.axType,"axis."].join(" ")),q!==H.calendar&&A.warn(["Attempted to group the bins of trace",W.index,"set with a",q,"calendar","with bins",H.calendar?"on a "+H.calendar+" calendar":"w/o a set calendar"].join(" ")))),U&&(i[Y]={traces:[W],dirs:[re],axType:j,calendar:W[re+"calendar"]||""}),W["_"+re+"bingroup"]=Y}for(l=0;l<h.length;l++)f=h[l],S(f,"histogram")&&(x.push(f),delete f._xautoBinFinished,delete f._yautoBinFinished,S(f,"2dMap")||M(f._input,f,s,c));var T=s._alignmentOpts||{};for(l=0;l<x.length;l++){if(f=x[l],o="",!S(f,"2dMap")){if(m=b(f),s.barmode==="group"&&f.alignmentgroup){var k=f[m+"axis"],P=a(s,k)+f.orientation;(T[P]||{})[f.alignmentgroup]&&(o=P)}!o&&s.barmode!=="overlay"&&(o=a(s,f.xaxis)+a(s,f.yaxis)+b(f))}o?(p[o]||(p[o]=[]),p[o].push(f)):v.push(f)}for(o in p){if(d=p[o],d.length===1){v.push(d[0]);continue}var z=!1;for(d.length&&(f=d[0],z=c("bingroup")),o=z||o,l=0;l<d.length;l++){f=d[l];var I=f._input.bingroup;I&&I!==o&&A.warn(["Trace",f.index,"must match","within bingroup",o+".","Ignoring its bingroup:",I,"setting."].join(" ")),f.bingroup=o,L(f,o,b(f))}}for(l=0;l<v.length;l++){f=v[l];var D=c("bingroup");if(S(f,"2dMap"))for(_=0;_<2;_++){m=r[_];var R=c(m+"bingroup",D?D+"__"+m:null);L(f,R,m)}else L(f,D,b(f))}for(o in i){var O=i[o];for(d=O.traces,w=0;w<n.length;w++){var F=n[w],N=F.name,G,K;if(!(N==="nbins"&&O.sizeFound)){for(l=0;l<d.length;l++){if(f=d[l],m=O.dirs[l],G=F.aStr[m],e(f._input,G).get()!==void 0){O[N]=c(G),O[N+"Found"]=!0;break}K=(f._autoBin||{})[m]||{},K[N]&&e(f,G).set(K[N])}if(N==="start"||N==="end")for(;l<d.length;l++)f=d[l],f["_"+m+"bingroup"]&&(K=(f._autoBin||{})[m]||{},c(G,K[N]));N==="nbins"&&!O.sizeFound&&!O.nbinsFound&&(f=d[0],O[N]=c(G))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("../../components/color"),M=y("../bar/defaults").handleText,e=y("../bar/style_defaults"),a=y("./attributes");ee.exports=function(r,t,h,s){function i(u,L){return g.coerce(r,t,a,u,L)}var x=i("x"),p=i("y"),v=i("cumulative.enabled");v&&(i("cumulative.direction"),i("cumulative.currentbin")),i("text");var f=i("textposition");M(r,t,s,i,f,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i("hovertext"),i("hovertemplate"),i("xhoverformat"),i("yhoverformat");var d=i("orientation",p&&!x?"h":"v"),o=d==="v"?"x":"y",m=d==="v"?"y":"x",l=x&&p?Math.min(g.minRowLength(x)&&g.minRowLength(p)):g.minRowLength(t[o]||[]);if(!l){t.visible=!1;return}t._length=l;var w=A.getComponentMethod("calendars","handleTraceDefaults");w(r,t,["x","y"],s);var _=t[m];_&&i("histfunc"),i("histnorm"),i("autobin"+o),e(r,t,i,h,s),g.coerceSelectionMarkerOpacity(t,i);var c=(t.marker.line||{}).color,b=A.getComponentMethod("errorbars","supplyDefaults");b(r,t,c||S.defaultLine,{axis:"y"}),b(r,t,c||S.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(y,ee,te){ee.exports=function(g,S,M,e,a){if(g.x="xVal"in S?S.xVal:S.x,g.y="yVal"in S?S.yVal:S.y,"zLabelVal"in S&&(g.z=S.zLabelVal),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),!(M.cumulative||{}).enabled){var n=Array.isArray(a)?e[0].pts[a[0]][a[1]]:e[a].pts;g.pointNumbers=n,g.binNumber=g.pointNumber,delete g.pointNumber,delete g.pointIndex;var r;if(M._indexToPoints){r=[];for(var t=0;t<n.length;t++)r=r.concat(M._indexToPoints[n[t]])}else r=n;g.pointIndices=r}return g}},{}],831:[function(y,ee,te){var A=y("../bar/hover").hoverPoints,g=y("../../plots/cartesian/axes").hoverLabelText;ee.exports=function(M,e,a,n,r){var t=A(M,e,a,n,r);if(t){M=t[0];var h=M.cd[M.index],s=M.cd[0].trace;if(!s.cumulative.enabled){var i=s.orientation==="h"?"y":"x";M[i+"Label"]=g(M[i+"a"],[h.ph0,h.ph1],s[i+"hoverformat"])}return t}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(y,ee,te){ee.exports={attributes:y("./attributes"),layoutAttributes:y("../bar/layout_attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("./cross_trace_defaults"),supplyLayoutDefaults:y("../bar/layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("../bar/cross_trace_calc").crossTraceCalc,plot:y("../bar/plot").plot,layerName:"barlayer",style:y("../bar/style").style,styleOnSelect:y("../bar/style").styleOnSelect,colorbar:y("../scatter/marker_colorbar"),hoverPoints:y("./hover"),selectPoints:y("../bar/select"),eventData:y("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:y("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(y,ee,te){ee.exports={percent:function(A,g){for(var S=A.length,M=100/g,e=0;e<S;e++)A[e]*=M},probability:function(A,g){for(var S=A.length,M=0;M<S;M++)A[M]/=g},density:function(A,g,S,M){var e=A.length;M=M||1;for(var a=0;a<e;a++)A[a]*=S[a]*M},"probability density":function(A,g,S,M){var e=A.length;M&&(g/=M);for(var a=0;a<e;a++)A[a]*=S[a]/g}}},{}],834:[function(y,ee,te){var A=y("../histogram/attributes"),g=y("../histogram/bin_attributes"),S=y("../heatmap/attributes"),M=y("../../plots/attributes"),e=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,a=y("../../plots/template_attributes").hovertemplateAttrs,n=y("../../plots/template_attributes").texttemplateAttrs,r=y("../../components/colorscale/attributes"),t=y("../../lib/extend").extendFlat;ee.exports=t({x:A.x,y:A.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:A.histnorm,histfunc:A.histfunc,nbinsx:A.nbinsx,xbins:g("x"),nbinsy:A.nbinsy,ybins:g("y"),autobinx:A.autobinx,autobiny:A.autobiny,bingroup:t({},A.bingroup,{}),xbingroup:t({},A.bingroup,{}),ybingroup:t({},A.bingroup,{}),xgap:S.xgap,ygap:S.ygap,zsmooth:S.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:a({},{keys:"z"}),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:S.textfont,showlegend:t({},M.showlegend,{dflt:!1})},r("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("../histogram/bin_functions"),M=y("../histogram/norm_functions"),e=y("../histogram/average"),a=y("../histogram/bin_label_vals"),n=y("../histogram/calc").calcAllAutoBins;ee.exports=function(i,x){var p=g.getFromId(i,x.xaxis),v=g.getFromId(i,x.yaxis),f=x.xcalendar,d=x.ycalendar,o=function(Ge){return p.r2c(Ge,0,f)},m=function(Ge){return v.r2c(Ge,0,d)},l=function(Ge){return p.c2r(Ge,0,f)},w=function(Ge){return v.c2r(Ge,0,d)},_,c,b,u,L=n(i,x,p,"x"),T=L[0],k=L[1],P=n(i,x,v,"y"),z=P[0],I=P[1],D=x._length;k.length>D&&k.splice(D,k.length-D),I.length>D&&I.splice(D,I.length-D);var R=[],O=[],F=[],N=typeof T.size=="string",G=typeof z.size=="string",K=[],W=[],Y=N?K:T,re=G?W:z,ue=0,j=[],q=[],H=x.histnorm,U=x.histfunc,$=H.indexOf("density")!==-1,ne=U==="max"||U==="min",X=ne?null:0,Q=S.count,ie=M[H],se=!1,ae=[],oe=[],be="z"in x?x.z:"marker"in x&&Array.isArray(x.marker.color)?x.marker.color:"";be&&U!=="count"&&(se=U==="avg",Q=S[U]);var ce=T.size,de=o(T.start),ye=o(T.end)+(de-g.tickIncrement(de,ce,!1,f))/1e6;for(_=de;_<ye;_=g.tickIncrement(_,ce,!1,f))O.push(X),K.push(_),se&&F.push(0);K.push(_);var ge=O.length,me=(_-de)/ge,Ee=l(de+me/2),Pe=z.size,Ue=m(z.start),we=m(z.end)+(Ue-g.tickIncrement(Ue,Pe,!1,d))/1e6;for(_=Ue;_<we;_=g.tickIncrement(_,Pe,!1,d)){R.push(O.slice()),W.push(_);var ke=new Array(ge);for(c=0;c<ge;c++)ke[c]=[];q.push(ke),se&&j.push(F.slice())}W.push(_);var Xe=R.length,Ve=(_-Ue)/Xe,Ie=w(Ue+Ve/2);$&&(ae=r(O.length,Y,me,N),oe=r(R.length,re,Ve,G)),!N&&p.type==="date"&&(Y=t(o,Y)),!G&&v.type==="date"&&(re=t(m,re));var De=!0,Ye=!0,vt=new Array(ge),Dt=new Array(Xe),Kt=1/0,Ft=1/0,Mt=1/0,Xt=1/0;for(_=0;_<D;_++){var It=k[_],At=I[_];b=A.findBin(It,Y),u=A.findBin(At,re),b>=0&&b<ge&&u>=0&&u<Xe&&(ue+=Q(b,_,R[u],be,j[u]),q[u][b].push(_),De&&(vt[b]===void 0?vt[b]=It:vt[b]!==It&&(De=!1)),Ye&&(Dt[u]===void 0?Dt[u]=At:Dt[u]!==At&&(Ye=!1)),Kt=Math.min(Kt,It-K[b]),Ft=Math.min(Ft,K[b+1]-It),Mt=Math.min(Mt,At-W[u]),Xt=Math.min(Xt,W[u+1]-At))}if(se)for(u=0;u<Xe;u++)ue+=e(R[u],j[u]);if(ie)for(u=0;u<Xe;u++)ie(R[u],ue,ae,oe[u]);return{x:k,xRanges:h(K,De&&vt,Kt,Ft,p,f),x0:Ee,dx:me,y:I,yRanges:h(W,Ye&&Dt,Mt,Xt,v,d),y0:Ie,dy:Ve,z:R,pts:q}};function r(s,i,x,p){var v=new Array(s),f;if(p)for(f=0;f<s;f++)v[f]=1/(i[f+1]-i[f]);else{var d=1/x;for(f=0;f<s;f++)v[f]=d}return v}function t(s,i){return{start:s(i.start),end:s(i.end),size:i.size}}function h(s,i,x,p,v,f){var d,o=s.length-1,m=new Array(o),l=a(x,p,s,v,f);for(d=0;d<o;d++){var w=(i||[])[d];m[d]=w===void 0?[l(s[d]),l(s[d+1],!0)]:[w,w]}return m}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(y,ee,te){var A=y("../../lib"),g=y("./sample_defaults"),S=y("../heatmap/style_defaults"),M=y("../../components/colorscale/defaults"),e=y("../heatmap/label_defaults"),a=y("./attributes");ee.exports=function(r,t,h,s){function i(x,p){return A.coerce(r,t,a,x,p)}g(r,t,i,s),t.visible!==!1&&(S(r,t,i,s),M(r,t,s,i,{prefix:"",cLetter:"z"}),i("hovertemplate"),e(i,s),i("xhoverformat"),i("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(y,ee,te){var A=y("../heatmap/hover"),g=y("../../plots/cartesian/axes").hoverLabelText;ee.exports=function(M,e,a,n,r){var t=A(M,e,a,n,r);if(t){M=t[0];var h=M.index,s=h[0],i=h[1],x=M.cd[0],p=x.trace,v=x.xRanges[i],f=x.yRanges[s];return M.xLabel=g(M.xa,[v[0],v[1]],p.xhoverformat),M.yLabel=g(M.ya,[f[0],f[1]],p.yhoverformat),t}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("../histogram/cross_trace_defaults"),calc:y("../heatmap/calc"),plot:y("../heatmap/plot"),layerName:"heatmaplayer",colorbar:y("../heatmap/colorbar"),style:y("../heatmap/style"),hoverPoints:y("./hover"),eventData:y("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib");ee.exports=function(M,e,a,n){var r=a("x"),t=a("y"),h=g.minRowLength(r),s=g.minRowLength(t);if(!h||!s){e.visible=!1;return}e._length=Math.min(h,s);var i=A.getComponentMethod("calendars","handleTraceDefaults");i(M,e,["x","y"],n);var x=a("z")||a("marker.color");x&&a("histfunc"),a("histnorm"),a("autobinx"),a("autobiny")}},{"../../lib":515,"../../registry":647}],840:[function(y,ee,te){var A=y("../histogram2d/attributes"),g=y("../contour/attributes"),S=y("../../components/colorscale/attributes"),M=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../lib/extend").extendFlat;ee.exports=e({x:A.x,y:A.y,z:A.z,marker:A.marker,histnorm:A.histnorm,histfunc:A.histfunc,nbinsx:A.nbinsx,xbins:A.xbins,nbinsy:A.nbinsy,ybins:A.ybins,autobinx:A.autobinx,autobiny:A.autobiny,bingroup:A.bingroup,xbingroup:A.xbingroup,ybingroup:A.ybingroup,autocontour:g.autocontour,ncontours:g.ncontours,contours:g.contours,line:{color:g.line.color,width:e({},g.line.width,{dflt:.5}),dash:g.line.dash,smoothing:g.line.smoothing,editType:"plot"},xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z",1),hovertemplate:A.hovertemplate,texttemplate:g.texttemplate,textfont:g.textfont},S("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(y,ee,te){var A=y("../../lib"),g=y("../histogram2d/sample_defaults"),S=y("../contour/contours_defaults"),M=y("../contour/style_defaults"),e=y("../heatmap/label_defaults"),a=y("./attributes");ee.exports=function(r,t,h,s){function i(p,v){return A.coerce(r,t,a,p,v)}function x(p){return A.coerce2(r,t,a,p)}g(r,t,i,s),t.visible!==!1&&(S(r,t,i,x),M(r,t,i,s),i("xhoverformat"),i("yhoverformat"),i("hovertemplate"),t.contours&&t.contours.coloring==="heatmap"&&e(i,s))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("../histogram/cross_trace_defaults"),calc:y("../contour/calc"),plot:y("../contour/plot").plot,layerName:"contourlayer",style:y("../contour/style"),colorbar:y("../contour/colorbar"),hoverPoints:y("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../../plots/template_attributes").texttemplateAttrs,S=y("../../components/colorscale/attributes"),M=y("../../plots/domain").attributes,e=y("../pie/attributes"),a=y("../sunburst/attributes"),n=y("../treemap/attributes"),r=y("../treemap/constants"),t=y("../../lib/extend").extendFlat;ee.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:n.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:t({colors:a.marker.colors,line:a.marker.line,editType:"calc"},S("marker",{colorAttr:"colors",anim:!1})),leaf:a.leaf,pathbar:n.pathbar,text:e.text,textinfo:a.textinfo,texttemplate:g({editType:"plot"},{keys:r.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:a.hoverinfo,hovertemplate:A({},{keys:r.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:n.outsidetextfont,textposition:n.textposition,sort:e.sort,root:a.root,domain:M({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(y,ee,te){var A=y("../../plots/plots");te.name="icicle",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],845:[function(y,ee,te){var A=y("../sunburst/calc");te.calc=function(g,S){return A.calc(g,S)},te.crossTraceCalc=function(g){return A._runCrossTraceCalc("icicle",g)}},{"../sunburst/calc":1060}],846:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("../../components/color"),M=y("../../plots/domain").defaults,e=y("../bar/defaults").handleText,a=y("../bar/constants").TEXTPAD,n=y("../../components/colorscale"),r=n.hasColorscale,t=n.handleDefaults;ee.exports=function(s,i,x,p){function v(b,u){return A.coerce(s,i,g,b,u)}var f=v("labels"),d=v("parents");if(!f||!f.length||!d||!d.length){i.visible=!1;return}var o=v("values");o&&o.length?v("branchvalues"):v("count"),v("level"),v("maxdepth"),v("tiling.orientation"),v("tiling.flip"),v("tiling.pad");var m=v("text");v("texttemplate"),i.texttemplate||v("textinfo",Array.isArray(m)?"text+label":"label"),v("hovertext"),v("hovertemplate");var l=v("pathbar.visible"),w="auto";e(s,i,p,v,w,{hasPathbar:l,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),v("textposition");var _=v("marker.line.width");_&&v("marker.line.color",p.paper_bgcolor),v("marker.colors");var c=i._hasColorscale=r(s,"marker","colors")||(s.marker||{}).coloraxis;c&&t(s,i,p,v,{prefix:"marker.",cLetter:"c"}),v("leaf.opacity",c?1:.7),i._hovered={marker:{line:{width:2,color:S.contrast(p.paper_bgcolor)}}},l&&(v("pathbar.thickness",i.pathbar.textfont.size+2*a),v("pathbar.side"),v("pathbar.edgeshape")),v("sort"),v("root.color"),M(i,p,v),i._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../components/drawing"),M=y("../../lib/svg_text_utils"),e=y("./partition"),a=y("./style").styleOne,n=y("../treemap/constants"),r=y("../sunburst/helpers"),t=y("../sunburst/fx"),h=y("../sunburst/plot").formatSliceLabel,s=!1;ee.exports=function(x,p,v,f,d){var o=d.width,m=d.height,l=d.viewX,w=d.viewY,_=d.pathSlice,c=d.toMoveInsideSlice,b=d.strTransform,u=d.hasTransition,L=d.handleSlicesExit,T=d.makeUpdateSliceInterpolator,k=d.makeUpdateTextInterpolator,P=d.prevEntry,z={},I=x._context.staticPlot,D=x._fullLayout,R=p[0],O=R.trace,F=O.textposition.indexOf("left")!==-1,N=O.textposition.indexOf("right")!==-1,G=O.textposition.indexOf("bottom")!==-1,K=e(v,[o,m],{flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1,orientation:O.tiling.orientation,pad:{inner:O.tiling.pad},maxDepth:O._maxDepth}),W=K.descendants(),Y=1/0,re=-1/0;W.forEach(function(U){var $=U.depth;$>=O._maxDepth?(U.x0=U.x1=(U.x0+U.x1)/2,U.y0=U.y1=(U.y0+U.y1)/2):(Y=Math.min(Y,$),re=Math.max(re,$))}),f=f.data(W,r.getPtId),O._maxVisibleLayers=isFinite(re)?re-Y+1:0,f.enter().append("g").classed("slice",!0),L(f,s,z,[o,m],_),f.order();var ue=null;if(u&&P){var j=r.getPtId(P);f.each(function(U){ue===null&&r.getPtId(U)===j&&(ue={x0:U.x0,x1:U.x1,y0:U.y0,y1:U.y1})})}var q=function(){return ue||{x0:0,x1:o,y0:0,y1:m}},H=f;return u&&(H=H.transition().each("end",function(){var U=A.select(this);r.setSliceCursor(U,x,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),H.each(function(U){U._x0=l(U.x0),U._x1=l(U.x1),U._y0=w(U.y0),U._y1=w(U.y1),U._hoverX=l(U.x1-O.tiling.pad),U._hoverY=w(G?U.y1-O.tiling.pad/2:U.y0+O.tiling.pad/2);var $=A.select(this),ne=g.ensureSingle($,"path","surface",function(se){se.style("pointer-events",I?"none":"all")});u?ne.transition().attrTween("d",function(se){var ae=T(se,s,q(),[o,m],{orientation:O.tiling.orientation,flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1});return function(oe){return _(ae(oe))}}):ne.attr("d",_),$.call(t,v,x,p,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,x,{isTransitioning:x._transitioning}),ne.call(a,U,O,{hovered:!1}),U.x0===U.x1||U.y0===U.y1?U._text="":U._text=h(U,v,O,p,D)||"";var X=g.ensureSingle($,"g","slicetext"),Q=g.ensureSingle(X,"text","",function(se){se.attr("data-notex",1)}),ie=g.ensureUniformFontSize(x,r.determineTextFont(O,U,D.font));Q.text(U._text||" ").classed("slicetext",!0).attr("text-anchor",N?"end":F?"start":"middle").call(S.font,ie).call(M.convertToTspans,x),U.textBB=S.bBox(Q.node()),U.transform=c(U,{fontSize:ie.size}),U.transform.fontSize=ie.size,u?Q.transition().attrTween("transform",function(se){var ae=k(se,s,q(),[o,m]);return function(oe){return b(ae(oe))}}):Q.attr("transform",b(U))}),ue}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(y,ee,te){ee.exports={moduleType:"trace",name:"icicle",basePlotModule:y("./base_plot"),categories:[],animatable:!0,attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot"),style:y("./style").style,colorbar:y("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(y,ee,te){ee.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("iciclecolorway",e.colorway),a("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(y,ee,te){var A=y("d3-hierarchy"),g=y("../treemap/flip_tree");ee.exports=function(M,e,a){var n=a.flipX,r=a.flipY,t=a.orientation==="h",h=a.maxDepth,s=e[0],i=e[1];h&&(s=(M.height+1)*e[0]/Math.min(M.height+1,h),i=(M.height+1)*e[1]/Math.min(M.height+1,h));var x=A.partition().padding(a.pad.inner).size(t?[e[1],s]:[e[0],i])(M);return(t||n||r)&&g(x,e,{swapXY:t,flipX:n,flipY:r}),x}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(y,ee,te){var A=y("../treemap/draw"),g=y("./draw_descendants");ee.exports=function(M,e,a,n){return A(M,e,a,n,{type:"icicle",drawDescendants:g})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/color"),S=y("../../lib"),M=y("../bar/uniform_text").resizeText;function e(n){var r=n._fullLayout._iciclelayer.selectAll(".trace");M(n,r,"icicle"),r.each(function(t){var h=A.select(this),s=t[0],i=s.trace;h.style("opacity",i.opacity),h.selectAll("path.surface").each(function(x){A.select(this).call(a,x,i)})})}function a(n,r,t){var h=r.data.data,s=!r.children,i=h.i,x=S.castOption(t,i,"marker.line.color")||g.defaultLine,p=S.castOption(t,i,"marker.line.width")||0;n.style("stroke-width",p).call(g.fill,h.color).call(g.stroke,x).style("opacity",s?t.leaf.opacity:null)}ee.exports={style:e,styleOne:a}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(y,ee,te){for(var A=y("../../plots/attributes"),g=y("../../plots/template_attributes").hovertemplateAttrs,S=y("../../lib/extend").extendFlat,M=y("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],a=[],n=[],r=0;r<e.length;r++){var t=M[e[r]];a.push("For the `"+e[r]+"` colormodel, it is ["+(t.zminDflt||t.min).join(", ")+"]."),n.push("For the `"+e[r]+"` colormodel, it is ["+(t.zmaxDflt||t.max).join(", ")+"].")}ee.exports=S({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:S({},A.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:g({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(y,ee,te){var A=y("../../lib"),g=y("./constants"),S=y("fast-isnumeric"),M=y("../../plots/cartesian/axes"),e=y("../../lib").maxRowLength,a=y("./helpers").getImageSize;ee.exports=function(s,i){var x,p;if(i._hasZ)x=i.z.length,p=e(i.z);else if(i._hasSource){var v=a(i.source);x=v.height,p=v.width}var f=M.getFromId(s,i.xaxis||"x"),d=M.getFromId(s,i.yaxis||"y"),o=f.d2c(i.x0)-i.dx/2,m=d.d2c(i.y0)-i.dy/2,l,w=[o,o+p*i.dx],_=[m,m+x*i.dy];if(f&&f.type==="log")for(l=0;l<p;l++)w.push(o+l*i.dx);if(d&&d.type==="log")for(l=0;l<x;l++)_.push(m+l*i.dy);i._extremes[f._id]=M.findExtremes(f,w),i._extremes[d._id]=M.findExtremes(d,_),i._scaler=t(i);var c={x0:o,y0:m,z:i.z,w:p,h:x};return[c]};function n(h,s,i,x){return function(p){return A.constrain((p-h)*s,i,x)}}function r(h,s){return function(i){return A.constrain(i,h,s)}}function t(h){var s=g.colormodel[h.colormodel],i=s.colormodel||h.colormodel,x=i.length;h._sArray=[];for(var p=0;p<x;p++)s.min[p]!==h.zmin[p]||s.max[p]!==h.zmax[p]?h._sArray.push(n(h.zmin[p],(s.max[p]-s.min[p])/(h.zmax[p]-h.zmin[p]),s.min[p],s.max[p])):h._sArray.push(r(s.min[p],s.max[p]));return function(v){for(var f=v.slice(0,x),d=0;d<x;d++){var o=f[d];if(!S(o))return!1;f[d]=h._sArray[d](o)}return f}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(y,ee,te){ee.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(A){return A.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(A){return A.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(A){return A.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(A){var g=A.slice(0,3);return g[1]=g[1]+"%",g[2]=g[2]+"%",g},suffix:["","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(A){var g=A.slice(0,4);return g[1]=g[1]+"%",g[2]=g[2]+"%",g},suffix:["","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("./constants"),M=y("../../snapshot/helpers").IMAGE_URL_PREFIX;ee.exports=function(a,n){function r(s,i){return A.coerce(a,n,g,s,i)}r("source"),n.source&&!n.source.match(M)&&delete n.source,n._hasSource=!!n.source;var t=r("z");if(n._hasZ=!(t===void 0||!t.length||!t[0]||!t[0].length),!n._hasZ&&!n._hasSource){n.visible=!1;return}r("x0"),r("y0"),r("dx"),r("dy");var h;n._hasZ?(r("colormodel","rgb"),h=S.colormodel[n.colormodel],r("zmin",h.zminDflt||h.min),r("zmax",h.zmaxDflt||h.max)):n._hasSource&&(n.colormodel="rgba256",h=S.colormodel[n.colormodel],n.zmin=h.zminDflt,n.zmax=h.zmaxDflt),r("zsmooth"),r("text"),r("hovertext"),r("hovertemplate"),n._length=null}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(y,ee,te){ee.exports=function(g,S){return"xVal"in S&&(g.x=S.xVal),"yVal"in S&&(g.y=S.yVal),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),g.color=S.color,g.colormodel=S.trace.colormodel,g.z||(g.z=S.color),g}},{}],859:[function(y,ee,te){var A=y("probe-image-size/sync"),g=y("../../snapshot/helpers").IMAGE_URL_PREFIX,S=y("buffer/").Buffer;te.getImageSize=function(M){var e=M.replace(g,""),a=new S(e,"base64");return A(a)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(y,ee,te){var A=y("../../components/fx"),g=y("../../lib"),S=y("./constants");ee.exports=function(e,a,n){var r=e.cd[0],t=r.trace,h=e.xa,s=e.ya;if(!(A.inbox(a-r.x0,a-(r.x0+r.w*t.dx),0)>0||A.inbox(n-r.y0,n-(r.y0+r.h*t.dy),0)>0)){var i=Math.floor((a-r.x0)/t.dx),x=Math.floor(Math.abs(n-r.y0)/t.dy),p;if(t._hasZ?p=r.z[x][i]:t._hasSource&&(p=t._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(i,x,1,1).data),!!p){var v=r.hi||t.hoverinfo,f;if(v){var d=v.split("+");d.indexOf("all")!==-1&&(d=["color"]),d.indexOf("color")!==-1&&(f=!0)}var o=S.colormodel[t.colormodel],m=o.colormodel||t.colormodel,l=m.length,w=t._scaler(p),_=o.suffix,c=[];(t.hovertemplate||f)&&(c.push("["+[w[0]+_[0],w[1]+_[1],w[2]+_[2]].join(", ")),l===4&&c.push(", "+w[3]+_[3]),c.push("]"),c=c.join(""),e.extraText=m.toUpperCase()+": "+c);var b;Array.isArray(t.hovertext)&&Array.isArray(t.hovertext[x])?b=t.hovertext[x][i]:Array.isArray(t.text)&&Array.isArray(t.text[x])&&(b=t.text[x][i]);var u=s.c2p(r.y0+(x+.5)*t.dy),L=r.x0+(i+.5)*t.dx,T=r.y0+(x+.5)*t.dy,k="["+p.slice(0,t.colormodel.length).join(", ")+"]";return[g.extendFlat(e,{index:[x,i],x0:h.c2p(r.x0+i*t.dx),x1:h.c2p(r.x0+(i+1)*t.dx),y0:u,y1:u,color:w,xVal:L,xLabelVal:L,yVal:T,yLabelVal:T,zLabelVal:k,text:b,hovertemplateLabels:{zLabel:k,colorLabel:c,"color[0]Label":w[0]+_[0],"color[1]Label":w[1]+_[1],"color[2]Label":w[2]+_[2],"color[3]Label":w[3]+_[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),style:y("./style"),hoverPoints:y("./hover"),eventData:y("./event_data"),moduleType:"trace",name:"image",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=g.strTranslate,M=y("../../constants/xmlns_namespaces"),e=y("./constants"),a=g.isIOS()||g.isSafari()||g.isIE();ee.exports=function(r,t,h,s){var i=t.xaxis,x=t.yaxis,p=!(a||r._context._exportedPlot);g.makeTraceGroups(s,h,"im").each(function(v){var f=A.select(this),d=v[0],o=d.trace,m=(o.zsmooth==="fast"||o.zsmooth===!1&&p)&&!o._hasZ&&o._hasSource&&i.type==="linear"&&x.type==="linear";o._realImage=m;var l=d.z,w=d.x0,_=d.y0,c=d.w,b=d.h,u=o.dx,L=o.dy,T,k,P,z,I,D;for(D=0;T===void 0&&D<c;)T=i.c2p(w+D*u),D++;for(D=c;k===void 0&&D>0;)k=i.c2p(w+D*u),D--;for(D=0;z===void 0&&D<b;)z=x.c2p(_+D*L),D++;for(D=b;I===void 0&&D>0;)I=x.c2p(_+D*L),D--;if(k<T&&(P=k,k=T,T=P),I<z&&(P=z,z=I,I=P),!m){var R=.5;T=Math.max(-R*i._length,T),k=Math.min((1+R)*i._length,k),z=Math.max(-R*x._length,z),I=Math.min((1+R)*x._length,I)}var O=Math.round(k-T),F=Math.round(I-z),N=O<=0||F<=0;if(N){var G=f.selectAll("image").data([]);G.exit().remove();return}function K(ne){var X=document.createElement("canvas");X.width=O,X.height=F;var Q=X.getContext("2d",{willReadFrequently:!0}),ie=function(Pe){return g.constrain(Math.round(i.c2p(w+Pe*u)-T),0,O)},se=function(Pe){return g.constrain(Math.round(x.c2p(_+Pe*L)-z),0,F)},ae=e.colormodel[o.colormodel],oe=ae.colormodel||o.colormodel,be=ae.fmt,ce;for(D=0;D<d.w;D++){var de=ie(D),ye=ie(D+1);if(!(ye===de||isNaN(ye)||isNaN(de)))for(var ge=0;ge<d.h;ge++){var me=se(ge),Ee=se(ge+1);Ee===me||isNaN(Ee)||isNaN(me)||!ne(D,ge)||(ce=o._scaler(ne(D,ge)),ce?Q.fillStyle=oe+"("+be(ce).join(",")+")":Q.fillStyle="rgba(0,0,0,0)",Q.fillRect(de,me,ye-de,Ee-me))}}return X}var W=f.selectAll("image").data([v]);W.enter().append("svg:image").attr({xmlns:M.svg,preserveAspectRatio:"none"}),W.exit().remove();var Y=o.zsmooth===!1?e.pixelatedStyle:"";if(m){var re=g.simpleMap(i.range,i.r2l),ue=g.simpleMap(x.range,x.r2l),j=re[1]<re[0],q=ue[1]>ue[0];if(j||q){var H=T+O/2,U=z+F/2;Y+="transform:"+S(H+"px",U+"px")+"scale("+(j?-1:1)+","+(q?-1:1)+")"+S(-H+"px",-U+"px")+";"}}W.attr("style",Y);var $=new Promise(function(ne){if(o._hasZ)ne();else if(o._hasSource)if(o._canvas&&o._canvas.el.width===c&&o._canvas.el.height===b&&o._canvas.source===o.source)ne();else{var X=document.createElement("canvas");X.width=c,X.height=b;var Q=X.getContext("2d",{willReadFrequently:!0});o._image=o._image||new Image;var ie=o._image;ie.onload=function(){Q.drawImage(ie,0,0),o._canvas={el:X,source:o.source},ne()},ie.setAttribute("src",o.source)}}).then(function(){var ne,X;if(o._hasZ)X=K(function(se,ae){return l[ae][se]}),ne=X.toDataURL("image/png");else if(o._hasSource)if(m)ne=o.source;else{var Q=o._canvas.el.getContext("2d",{willReadFrequently:!0}),ie=Q.getImageData(0,0,c,b).data;X=K(function(se,ae){var oe=4*(ae*c+se);return[ie[oe],ie[oe+1],ie[oe+2],ie[oe+3]]}),ne=X.toDataURL("image/png")}W.attr({"xlink:href":ne,height:F,width:O,x:T,y:z})});r._promises.push($)})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(y,ee,te){var A=y("@plotly/d3");ee.exports=function(S){A.select(S).selectAll(".im image").style("opacity",function(M){return M[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(y,ee,te){var A=y("../../lib/extend").extendFlat,g=y("../../lib/extend").extendDeep,S=y("../../plot_api/edit_types").overrideAll,M=y("../../plots/font_attributes"),e=y("../../components/color/attributes"),a=y("../../plots/domain").attributes,n=y("../../plots/cartesian/layout_attributes"),r=y("../../plot_api/plot_template").templatedArray,t=y("../../constants/delta.js"),h=y("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,s=M({editType:"plot",colorEditType:"plot"}),i={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},x={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},p=r("step",g({},i,{range:x}));ee.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:a({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:A({},s,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:h("value")},font:A({},s,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:h("value")},increasing:{symbol:{valType:"string",dflt:t.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:t.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:A({},s,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:g({},i,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:S({range:x,visible:A({},n.visible,{dflt:!0}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:A({},n.ticks,{dflt:"outside"}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,ticklabelstep:n.ticklabelstep,showticklabels:n.showticklabels,tickfont:M({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,editType:"plot"},"plot"),steps:p,threshold:{line:{color:A({},i.line.color,{}),width:A({},i.line.width,{dflt:1}),editType:"plot"},thickness:A({},i.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(y,ee,te){var A=y("../../plots/plots");te.name="indicator",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],866:[function(y,ee,te){function A(g,S){var M=[],e=S.value;typeof S._lastValue!="number"&&(S._lastValue=S.value);var a=S._lastValue,n=a;return S._hasDelta&&typeof S.delta.reference=="number"&&(n=S.delta.reference),M[0]={y:e,lastY:a,delta:e-n,relativeDelta:(e-n)/n},M}ee.exports={calc:A}},{}],867:[function(y,ee,te){ee.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("../../plots/domain").defaults,M=y("../../plot_api/plot_template"),e=y("../../plots/array_container_defaults"),a=y("./constants.js"),n=y("../../plots/cartesian/tick_value_defaults"),r=y("../../plots/cartesian/tick_mark_defaults"),t=y("../../plots/cartesian/tick_label_defaults"),h=y("../../plots/cartesian/prefix_suffix_defaults");function s(x,p,v,f){function d(D,R){return A.coerce(x,p,g,D,R)}S(p,f,d),d("mode"),p._hasNumber=p.mode.indexOf("number")!==-1,p._hasDelta=p.mode.indexOf("delta")!==-1,p._hasGauge=p.mode.indexOf("gauge")!==-1;var o=d("value");p._range=[0,typeof o=="number"?1.5*o:1];var m=new Array(2),l;p._hasNumber&&(d("number.valueformat"),d("number.font.color",f.font.color),d("number.font.family",f.font.family),d("number.font.size"),p.number.font.size===void 0&&(p.number.font.size=a.defaultNumberFontSize,m[0]=!0),d("number.prefix"),d("number.suffix"),l=p.number.font.size);var w;p._hasDelta&&(d("delta.font.color",f.font.color),d("delta.font.family",f.font.family),d("delta.font.size"),p.delta.font.size===void 0&&(p.delta.font.size=(p._hasNumber?.5:1)*(l||a.defaultNumberFontSize),m[1]=!0),d("delta.reference",p.value),d("delta.relative"),d("delta.valueformat",p.delta.relative?"2%":""),d("delta.increasing.symbol"),d("delta.increasing.color"),d("delta.decreasing.symbol"),d("delta.decreasing.color"),d("delta.position"),d("delta.prefix"),d("delta.suffix"),w=p.delta.font.size),p._scaleNumbers=(!p._hasNumber||m[0])&&(!p._hasDelta||m[1])||!1,d("title.font.color",f.font.color),d("title.font.family",f.font.family),d("title.font.size",.25*(l||w||a.defaultNumberFontSize)),d("title.text");var _,c,b,u;function L(D,R){return A.coerce(_,c,g.gauge,D,R)}function T(D,R){return A.coerce(b,u,g.gauge.axis,D,R)}if(p._hasGauge){_=x.gauge,_||(_={}),c=M.newContainer(p,"gauge"),L("shape");var k=p._isBullet=p.gauge.shape==="bullet";k||d("title.align","center");var P=p._isAngular=p.gauge.shape==="angular";P||d("align","center"),L("bgcolor",f.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width");var z=a.valueThickness*(p.gauge.shape==="bullet"?.5:1);L("bar.thickness",z),e(_,c,{name:"steps",handleItemDefaults:i}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),b={},_&&(b=_.axis||{}),u=M.newContainer(c,"axis"),T("visible"),p._range=T("range",p._range);var I={outerTicks:!0};n(b,u,T,"linear"),h(b,u,T,"linear",I),t(b,u,T,"linear",I),r(b,u,T,I)}else d("title.align","center"),d("align","center"),p._isAngular=p._isBullet=!1;p._length=null}function i(x,p){function v(f,d){return A.coerce(x,p,g.gauge.steps,f,d)}v("color"),v("line.color"),v("line.width"),v("range"),v("thickness")}ee.exports={supplyDefaults:s}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(y,ee,te){ee.exports={moduleType:"trace",name:"indicator",basePlotModule:y("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,calc:y("./calc").calc,plot:y("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(y,ee,te){var A=y("@plotly/d3"),g=y("d3-interpolate").interpolate,S=y("d3-interpolate").interpolateNumber,M=y("../../lib"),e=M.strScale,a=M.strTranslate,n=M.rad2deg,r=y("../../constants/alignment").MID_SHIFT,t=y("../../components/drawing"),h=y("./constants"),s=y("../../lib/svg_text_utils"),i=y("../../plots/cartesian/axes"),x=y("../../plots/cartesian/axis_defaults"),p=y("../../plots/cartesian/position_defaults"),v=y("../../plots/cartesian/layout_attributes"),f=y("../../components/color"),d={left:"start",center:"middle",right:"end"},o={left:0,center:.5,right:1},m=/[yzafpnmkMGTPEZY]/;function l(I){return I&&I.duration>0}ee.exports=function(D,R,O,F){var N=D._fullLayout,G;l(O)&&F&&(G=F()),M.makeTraceGroups(N._indicatorlayer,R,"trace").each(function(K){var W=K[0],Y=W.trace,re=A.select(this),ue=Y._hasGauge,j=Y._isAngular,q=Y._isBullet,H=Y.domain,U={w:N._size.w*(H.x[1]-H.x[0]),h:N._size.h*(H.y[1]-H.y[0]),l:N._size.l+N._size.w*H.x[0],r:N._size.r+N._size.w*(1-H.x[1]),t:N._size.t+N._size.h*(1-H.y[1]),b:N._size.b+N._size.h*H.y[0]},$=U.l+U.w/2,ne=U.t+U.h/2,X=Math.min(U.w/2,U.h),Q=h.innerRadius*X,ie,se,ae,oe=Y.align||"center";if(se=ne,!ue)ie=U.l+o[oe]*U.w,ae=function(we){return T(we,U.w,U.h)};else if(j&&(ie=$,se=ne+X/2,ae=function(we){return k(we,.9*Q)}),q){var be=h.bulletPadding,ce=1-h.bulletNumberDomainSize+be;ie=U.l+(ce+(1-ce)*o[oe])*U.w,ae=function(we){return T(we,(h.bulletNumberDomainSize-be)*U.w,U.h)}}c(D,re,K,{numbersX:ie,numbersY:se,numbersScaler:ae,transitionOpts:O,onComplete:G});var de,ye;ue&&(de={range:Y.gauge.axis.range,color:Y.gauge.bgcolor,line:{color:Y.gauge.bordercolor,width:0},thickness:1},ye={range:Y.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Y.gauge.bordercolor,width:Y.gauge.borderwidth},thickness:1});var ge=re.selectAll("g.angular").data(j?K:[]);ge.exit().remove();var me=re.selectAll("g.angularaxis").data(j?K:[]);me.exit().remove(),j&&_(D,re,K,{radius:X,innerRadius:Q,gauge:ge,layer:me,size:U,gaugeBg:de,gaugeOutline:ye,transitionOpts:O,onComplete:G});var Ee=re.selectAll("g.bullet").data(q?K:[]);Ee.exit().remove();var Pe=re.selectAll("g.bulletaxis").data(q?K:[]);Pe.exit().remove(),q&&w(D,re,K,{gauge:Ee,layer:Pe,size:U,gaugeBg:de,gaugeOutline:ye,transitionOpts:O,onComplete:G});var Ue=re.selectAll("text.title").data(K);Ue.exit().remove(),Ue.enter().append("text").classed("title",!0),Ue.attr("text-anchor",function(){return q?d.right:d[Y.title.align]}).text(Y.title.text).call(t.font,Y.title.font).call(s.convertToTspans,D),Ue.attr("transform",function(){var we=U.l+U.w*o[Y.title.align],ke,Xe=h.titlePadding,Ve=t.bBox(Ue.node());if(ue){if(j)if(Y.gauge.axis.visible){var Ie=t.bBox(me.node());ke=Ie.top-Xe-Ve.bottom}else ke=U.t+U.h/2-X/2-Ve.bottom-Xe;q&&(ke=se-(Ve.top+Ve.bottom)/2,we=U.l-h.bulletPadding*U.w)}else ke=Y._numbersTop-Xe-Ve.bottom;return a(we,ke)})})};function w(I,D,R,O){var F=R[0].trace,N=O.gauge,G=O.layer,K=O.gaugeBg,W=O.gaugeOutline,Y=O.size,re=F.domain,ue=O.transitionOpts,j=O.onComplete,q,H,U,$,ne;N.enter().append("g").classed("bullet",!0),N.attr("transform",a(Y.l,Y.t)),G.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),G.selectAll("g.xbulletaxistick,path,text").remove();var X=Y.h,Q=F.gauge.bar.thickness*X,ie=re.x[0],se=re.x[0]+(re.x[1]-re.x[0])*(F._hasNumber||F._hasDelta?1-h.bulletNumberDomainSize:1);q=L(I,F.gauge.axis),q._id="xbulletaxis",q.domain=[ie,se],q.setScale(),H=i.calcTicks(q),U=i.makeTransTickFn(q),$=i.getTickSigns(q)[2],ne=Y.t+Y.h,q.visible&&(i.drawTicks(I,q,{vals:q.ticks==="inside"?i.clipEnds(q,H):H,layer:G,path:i.makeTickPath(q,ne,$),transFn:U}),i.drawLabels(I,q,{vals:H,layer:G,transFn:U,labelFns:i.makeLabelFns(q,ne)}));function ae(me){me.attr("width",function(Ee){return Math.max(0,q.c2p(Ee.range[1])-q.c2p(Ee.range[0]))}).attr("x",function(Ee){return q.c2p(Ee.range[0])}).attr("y",function(Ee){return .5*(1-Ee.thickness)*X}).attr("height",function(Ee){return Ee.thickness*X})}var oe=[K].concat(F.gauge.steps),be=N.selectAll("g.bg-bullet").data(oe);be.enter().append("g").classed("bg-bullet",!0).append("rect"),be.select("rect").call(ae).call(b),be.exit().remove();var ce=N.selectAll("g.value-bullet").data([F.gauge.bar]);ce.enter().append("g").classed("value-bullet",!0).append("rect"),ce.select("rect").attr("height",Q).attr("y",(X-Q)/2).call(b),l(ue)?ce.select("rect").transition().duration(ue.duration).ease(ue.easing).each("end",function(){j&&j()}).each("interrupt",function(){j&&j()}).attr("width",Math.max(0,q.c2p(Math.min(F.gauge.axis.range[1],R[0].y)))):ce.select("rect").attr("width",typeof R[0].y=="number"?Math.max(0,q.c2p(Math.min(F.gauge.axis.range[1],R[0].y))):0),ce.exit().remove();var de=R.filter(function(){return F.gauge.threshold.value||F.gauge.threshold.value===0}),ye=N.selectAll("g.threshold-bullet").data(de);ye.enter().append("g").classed("threshold-bullet",!0).append("line"),ye.select("line").attr("x1",q.c2p(F.gauge.threshold.value)).attr("x2",q.c2p(F.gauge.threshold.value)).attr("y1",(1-F.gauge.threshold.thickness)/2*X).attr("y2",(1-(1-F.gauge.threshold.thickness)/2)*X).call(f.stroke,F.gauge.threshold.line.color).style("stroke-width",F.gauge.threshold.line.width),ye.exit().remove();var ge=N.selectAll("g.gauge-outline").data([W]);ge.enter().append("g").classed("gauge-outline",!0).append("rect"),ge.select("rect").call(ae).call(b),ge.exit().remove()}function _(I,D,R,O){var F=R[0].trace,N=O.size,G=O.radius,K=O.innerRadius,W=O.gaugeBg,Y=O.gaugeOutline,re=[N.l+N.w/2,N.t+N.h/2+G/2],ue=O.gauge,j=O.layer,q=O.transitionOpts,H=O.onComplete,U=Math.PI/2;function $(De){var Ye=F.gauge.axis.range[0],vt=F.gauge.axis.range[1],Dt=(De-Ye)/(vt-Ye)*Math.PI-U;return Dt<-U?-U:Dt>U?U:Dt}function ne(De){return A.svg.arc().innerRadius((K+G)/2-De/2*(G-K)).outerRadius((K+G)/2+De/2*(G-K)).startAngle(-U)}function X(De){De.attr("d",function(Ye){return ne(Ye.thickness).startAngle($(Ye.range[0])).endAngle($(Ye.range[1]))()})}var Q,ie,se,ae;ue.enter().append("g").classed("angular",!0),ue.attr("transform",a(re[0],re[1])),j.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),j.selectAll("g.xangularaxistick,path,text").remove(),Q=L(I,F.gauge.axis),Q.type="linear",Q.range=F.gauge.axis.range,Q._id="xangularaxis",Q.ticklabeloverflow="allow",Q.setScale();var oe=function(De){return(Q.range[0]-De.x)/(Q.range[1]-Q.range[0])*Math.PI+Math.PI},be={},ce=i.makeLabelFns(Q,0),de=ce.labelStandoff;be.xFn=function(De){var Ye=oe(De);return Math.cos(Ye)*de},be.yFn=function(De){var Ye=oe(De),vt=Math.sin(Ye)>0?.2:1;return-Math.sin(Ye)*(de+De.fontSize*vt)+Math.abs(Math.cos(Ye))*(De.fontSize*r)},be.anchorFn=function(De){var Ye=oe(De),vt=Math.cos(Ye);return Math.abs(vt)<.1?"middle":vt>0?"start":"end"},be.heightFn=function(De,Ye,vt){var Dt=oe(De);return-.5*(1+Math.sin(Dt))*vt};var ye=function(De){return a(re[0]+G*Math.cos(De),re[1]-G*Math.sin(De))};se=function(De){return ye(oe(De))};var ge=function(De){var Ye=oe(De);return ye(Ye)+"rotate("+-n(Ye)+")"};if(ie=i.calcTicks(Q),ae=i.getTickSigns(Q)[2],Q.visible){ae=Q.ticks==="inside"?-1:1;var me=(Q.linewidth||1)/2;i.drawTicks(I,Q,{vals:ie,layer:j,path:"M"+ae*me+",0h"+ae*Q.ticklen,transFn:ge}),i.drawLabels(I,Q,{vals:ie,layer:j,transFn:se,labelFns:be})}var Ee=[W].concat(F.gauge.steps),Pe=ue.selectAll("g.bg-arc").data(Ee);Pe.enter().append("g").classed("bg-arc",!0).append("path"),Pe.select("path").call(X).call(b),Pe.exit().remove();var Ue=ne(F.gauge.bar.thickness),we=ue.selectAll("g.value-arc").data([F.gauge.bar]);we.enter().append("g").classed("value-arc",!0).append("path");var ke=we.select("path");l(q)?(ke.transition().duration(q.duration).ease(q.easing).each("end",function(){H&&H()}).each("interrupt",function(){H&&H()}).attrTween("d",u(Ue,$(R[0].lastY),$(R[0].y))),F._lastValue=R[0].y):ke.attr("d",typeof R[0].y=="number"?Ue.endAngle($(R[0].y)):"M0,0Z"),ke.call(b),we.exit().remove(),Ee=[];var Xe=F.gauge.threshold.value;(Xe||Xe===0)&&Ee.push({range:[Xe,Xe],color:F.gauge.threshold.color,line:{color:F.gauge.threshold.line.color,width:F.gauge.threshold.line.width},thickness:F.gauge.threshold.thickness});var Ve=ue.selectAll("g.threshold-arc").data(Ee);Ve.enter().append("g").classed("threshold-arc",!0).append("path"),Ve.select("path").call(X).call(b),Ve.exit().remove();var Ie=ue.selectAll("g.gauge-outline").data([Y]);Ie.enter().append("g").classed("gauge-outline",!0).append("path"),Ie.select("path").call(X).call(b),Ie.exit().remove()}function c(I,D,R,O){var F=R[0].trace,N=O.numbersX,G=O.numbersY,K=F.align||"center",W=d[K],Y=O.transitionOpts,re=O.onComplete,ue=M.ensureSingle(D,"g","numbers"),j,q,H,U=[];F._hasNumber&&U.push("number"),F._hasDelta&&(U.push("delta"),F.delta.position==="left"&&U.reverse());var $=ue.selectAll("text").data(U);$.enter().append("text"),$.attr("text-anchor",function(){return W}).attr("class",function(ye){return ye}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),$.exit().remove();function ne(ye,ge,me,Ee){if(ye.match("s")&&me>=0!=Ee>=0&&!ge(me).slice(-1).match(m)&&!ge(Ee).slice(-1).match(m)){var Pe=ye.slice().replace("s","f").replace(/\d+/,function(we){return parseInt(we)-1}),Ue=L(I,{tickformat:Pe});return function(we){return Math.abs(we)<1?i.tickText(Ue,we).text:ge(we)}}else return ge}function X(){var ye=L(I,{tickformat:F.number.valueformat},F._range);ye.setScale(),i.prepTicks(ye);var ge=function(we){return i.tickText(ye,we).text},me=F.number.suffix,Ee=F.number.prefix,Pe=ue.select("text.number");function Ue(){var we=typeof R[0].y=="number"?Ee+ge(R[0].y)+me:"-";Pe.text(we).call(t.font,F.number.font).call(s.convertToTspans,I)}return l(Y)?Pe.transition().duration(Y.duration).ease(Y.easing).each("end",function(){Ue(),re&&re()}).each("interrupt",function(){Ue(),re&&re()}).attrTween("text",function(){var we=A.select(this),ke=S(R[0].lastY,R[0].y);F._lastValue=R[0].y;var Xe=ne(F.number.valueformat,ge,R[0].lastY,R[0].y);return function(Ve){we.text(Ee+Xe(ke(Ve))+me)}}):Ue(),j=P(Ee+ge(R[0].y)+me,F.number.font,W,I),Pe}function Q(){var ye=L(I,{tickformat:F.delta.valueformat},F._range);ye.setScale(),i.prepTicks(ye);var ge=function(Ve){return i.tickText(ye,Ve).text},me=F.delta.suffix,Ee=F.delta.prefix,Pe=function(Ve){var Ie=F.delta.relative?Ve.relativeDelta:Ve.delta;return Ie},Ue=function(Ve,Ie){return Ve===0||typeof Ve!="number"||isNaN(Ve)?"-":(Ve>0?F.delta.increasing.symbol:F.delta.decreasing.symbol)+Ee+Ie(Ve)+me},we=function(Ve){return Ve.delta>=0?F.delta.increasing.color:F.delta.decreasing.color};F._deltaLastValue===void 0&&(F._deltaLastValue=Pe(R[0]));var ke=ue.select("text.delta");ke.call(t.font,F.delta.font).call(f.fill,we({delta:F._deltaLastValue}));function Xe(){ke.text(Ue(Pe(R[0]),ge)).call(f.fill,we(R[0])).call(s.convertToTspans,I)}return l(Y)?ke.transition().duration(Y.duration).ease(Y.easing).tween("text",function(){var Ve=A.select(this),Ie=Pe(R[0]),De=F._deltaLastValue,Ye=ne(F.delta.valueformat,ge,De,Ie),vt=S(De,Ie);return F._deltaLastValue=Ie,function(Dt){Ve.text(Ue(vt(Dt),Ye)),Ve.call(f.fill,we({delta:vt(Dt)}))}}).each("end",function(){Xe(),re&&re()}).each("interrupt",function(){Xe(),re&&re()}):Xe(),q=P(Ue(Pe(R[0]),ge),F.delta.font,W,I),ke}var ie=F.mode+F.align,se;if(F._hasDelta&&(se=Q(),ie+=F.delta.position+F.delta.font.size+F.delta.font.family+F.delta.valueformat,ie+=F.delta.increasing.symbol+F.delta.decreasing.symbol,H=q),F._hasNumber&&(X(),ie+=F.number.font.size+F.number.font.family+F.number.valueformat+F.number.suffix+F.number.prefix,H=j),F._hasDelta&&F._hasNumber){var ae=[(j.left+j.right)/2,(j.top+j.bottom)/2],oe=[(q.left+q.right)/2,(q.top+q.bottom)/2],be,ce,de=.75*F.delta.font.size;F.delta.position==="left"&&(be=z(F,"deltaPos",0,-1*(j.width*o[F.align]+q.width*(1-o[F.align])+de),ie,Math.min),ce=ae[1]-oe[1],H={width:j.width+q.width+de,height:Math.max(j.height,q.height),left:q.left+be,right:j.right,top:Math.min(j.top,q.top+ce),bottom:Math.max(j.bottom,q.bottom+ce)}),F.delta.position==="right"&&(be=z(F,"deltaPos",0,j.width*(1-o[F.align])+q.width*o[F.align]+de,ie,Math.max),ce=ae[1]-oe[1],H={width:j.width+q.width+de,height:Math.max(j.height,q.height),left:j.left,right:q.right+be,top:Math.min(j.top,q.top+ce),bottom:Math.max(j.bottom,q.bottom+ce)}),F.delta.position==="bottom"&&(be=null,ce=q.height,H={width:Math.max(j.width,q.width),height:j.height+q.height,left:Math.min(j.left,q.left),right:Math.max(j.right,q.right),top:j.bottom-j.height,bottom:j.bottom+q.height}),F.delta.position==="top"&&(be=null,ce=j.top,H={width:Math.max(j.width,q.width),height:j.height+q.height,left:Math.min(j.left,q.left),right:Math.max(j.right,q.right),top:j.bottom-j.height-q.height,bottom:j.bottom}),se.attr({dx:be,dy:ce})}(F._hasNumber||F._hasDelta)&&ue.attr("transform",function(){var ye=O.numbersScaler(H);ie+=ye[2];var ge=z(F,"numbersScale",1,ye[0],ie,Math.min),me;F._scaleNumbers||(ge=1),F._isAngular?me=G-ge*H.bottom:me=G-ge*(H.top+H.bottom)/2,F._numbersTop=ge*H.top+me;var Ee=H[K];K==="center"&&(Ee=(H.left+H.right)/2);var Pe=N-ge*Ee;return Pe=z(F,"numbersTranslate",0,Pe,ie,Math.max),a(Pe,me)+e(ge)})}function b(I){I.each(function(D){f.stroke(A.select(this),D.line.color)}).each(function(D){f.fill(A.select(this),D.color)}).style("stroke-width",function(D){return D.line.width})}function u(I,D,R){return function(){var O=g(D,R);return function(F){return I.endAngle(O(F))()}}}function L(I,D,R){var O=I._fullLayout,F=M.extendFlat({type:"linear",ticks:"outside",range:R,showline:!0},D),N={type:"linear",_id:"x"+D._id},G={letter:"x",font:O.font,noHover:!0,noTickson:!0};function K(W,Y){return M.coerce(F,N,v,W,Y)}return x(F,N,K,G,O),p(F,N,K,G),N}function T(I,D,R){var O=Math.min(D/I.width,R/I.height);return[O,I,D+"x"+R]}function k(I,D){var R=Math.sqrt(I.width/2*(I.width/2)+I.height*I.height),O=D/R;return[O,I,D]}function P(I,D,R,O){var F=document.createElementNS("http://www.w3.org/2000/svg","text"),N=A.select(F);return N.text(I).attr("x",0).attr("y",0).attr("text-anchor",R).attr("data-unformatted",I).call(s.convertToTspans,O).call(t.font,D),t.bBox(N.node())}function z(I,D,R,O,F,N){var G="_cache"+D;I[G]&&I[G].key===F||(I[G]={key:F,value:R});var K=M.aggNums(N,null,[I[G].value,O],2);return I[G].value=K,K}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(y,ee,te){var A=y("../../components/colorscale/attributes"),g=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../mesh3d/attributes"),e=y("../../plots/attributes"),a=y("../../lib/extend").extendFlat,n=y("../../plot_api/edit_types").overrideAll;function r(s){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function t(s){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var h=ee.exports=n(a({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:r(),y:r(),z:r()},caps:{x:t(),y:t(),z:t()},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:S(),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),valuehoverformat:g("value",1),showlegend:a({},e.showlegend,{dflt:!1})},A("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:M.opacity,lightposition:M.lightposition,lighting:M.lighting,flatshading:M.flatshading,contour:M.contour,hoverinfo:a({},e.hoverinfo)}),"calc","nested");h.flatshading.dflt=!0,h.lighting.facenormalsepsilon.dflt=0,h.x.editType=h.y.editType=h.z.editType=h.value.editType="calc+clearAxisTypes",h.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(y,ee,te){var A=y("../../components/colorscale/calc"),g=y("../streamtube/calc").processGrid,S=y("../streamtube/calc").filter;ee.exports=function(e,a){a._len=Math.min(a.x.length,a.y.length,a.z.length,a.value.length),a._x=S(a.x,a._len),a._y=S(a.y,a._len),a._z=S(a.z,a._len),a._value=S(a.value,a._len);var n=g(a);a._gridFill=n.fill,a._Xs=n.Xs,a._Ys=n.Ys,a._Zs=n.Zs,a._len=n.len;for(var r=1/0,t=-1/0,h=0;h<a._len;h++){var s=a._value[h];r=Math.min(r,s),t=Math.max(t,s)}a._minValues=r,a._maxValues=t,a._vMin=a.isomin===void 0||a.isomin===null?r:a.isomin,a._vMax=a.isomax===void 0||a.isomin===null?t:a.isomax,A(e,a,{vals:[a._vMin,a._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_mesh3d,g=y("../../lib/gl_format_color").parseColorScale,S=y("../../lib/str2rgbarray"),M=y("../../components/colorscale").extractOpts,e=y("../../plots/gl3d/zip3"),a=function(i,x){for(var p=x.length-1;p>0;p--){var v=Math.min(x[p],x[p-1]),f=Math.max(x[p],x[p-1]);if(f>v&&v<i&&i<=f)return{id:p,distRatio:(f-i)/(f-v)}}return{id:0,distRatio:0}};function n(i,x,p){this.scene=i,this.uid=p,this.mesh=x,this.name="",this.data=null,this.showContour=!1}var r=n.prototype;r.handlePick=function(i){if(i.object===this.mesh){var x=i.data.index,p=this.data._meshX[x],v=this.data._meshY[x],f=this.data._meshZ[x],d=this.data._Ys.length,o=this.data._Zs.length,m=a(p,this.data._Xs).id,l=a(v,this.data._Ys).id,w=a(f,this.data._Zs).id,_=i.index=w+o*l+o*d*m;i.traceCoordinate=[this.data._meshX[_],this.data._meshY[_],this.data._meshZ[_],this.data._value[_]];var c=this.data.hovertext||this.data.text;return Array.isArray(c)&&c[_]!==void 0?i.textLabel=c[_]:c&&(i.textLabel=c),!0}},r.update=function(i){var x=this.scene,p=x.fullSceneLayout;this.data=h(i);function v(l,w,_,c){return w.map(function(b){return l.d2l(b,0,c)*_})}var f=e(v(p.xaxis,i._meshX,x.dataScale[0],i.xcalendar),v(p.yaxis,i._meshY,x.dataScale[1],i.ycalendar),v(p.zaxis,i._meshZ,x.dataScale[2],i.zcalendar)),d=e(i._meshI,i._meshJ,i._meshK),o={positions:f,cells:d,lightPosition:[i.lightposition.x,i.lightposition.y,i.lightposition.z],ambient:i.lighting.ambient,diffuse:i.lighting.diffuse,specular:i.lighting.specular,roughness:i.lighting.roughness,fresnel:i.lighting.fresnel,vertexNormalsEpsilon:i.lighting.vertexnormalsepsilon,faceNormalsEpsilon:i.lighting.facenormalsepsilon,opacity:i.opacity,contourEnable:i.contour.show,contourColor:S(i.contour.color).slice(0,3),contourWidth:i.contour.width,useFacetNormals:i.flatshading},m=M(i);o.vertexIntensity=i._meshIntensity,o.vertexIntensityBounds=[m.min,m.max],o.colormap=g(i),this.mesh.update(o)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var t=["xyz","xzy","yxz","yzx","zxy","zyx"];function h(i){i._meshI=[],i._meshJ=[],i._meshK=[];var x=i.surface.show,p=i.spaceframe.show,v=i.surface.fill,f=i.spaceframe.fill,d=!1,o=!1,m=0,l,w,_=i._Xs,c=i._Ys,b=i._Zs,u=_.length,L=c.length,T=b.length,k=t.indexOf(i._gridFill.replace(/-/g,"").replace(/\+/g,"")),P=function(It,At,Ge){switch(k){case 5:return Ge+T*At+T*L*It;case 4:return Ge+T*It+T*u*At;case 3:return At+L*Ge+L*T*It;case 2:return At+L*It+L*u*Ge;case 1:return It+u*Ge+u*T*At;default:return It+u*At+u*L*Ge}},z=i._minValues,I=i._maxValues,D=i._vMin,R=i._vMax,O,F,N,G;function K(It,At,Ge){for(var tt=G.length,He=w;He<tt;He++)if(It===O[He]&&At===F[He]&&Ge===N[He])return He;return-1}function W(){w=l}function Y(){O=[],F=[],N=[],G=[],l=0,W()}function re(It,At,Ge,tt){return O.push(It),F.push(At),N.push(Ge),G.push(tt),l++,l-1}function ue(It,At,Ge){return i._meshI.push(It),i._meshJ.push(At),i._meshK.push(Ge),m++,m-1}function j(It,At,Ge){for(var tt=[],He=0;He<It.length;He++)tt[He]=(It[He]+At[He]+Ge[He])/3;return tt}function q(It,At,Ge){for(var tt=[],He=0;He<It.length;He++)tt[He]=It[He]*(1-Ge)+Ge*At[He];return tt}var H;function U(It){H=It}function $(It,At){var Ge=It[0],tt=It[1],He=It[2],Ae=j(Ge,tt,He),Ne=Math.sqrt(1-H),Ze=q(Ae,Ge,Ne),Qe=q(Ae,tt,Ne),bt=q(Ae,He,Ne),dt=At[0],wt=At[1],Ut=At[2];return{xyzv:[[Ge,tt,Qe],[Qe,Ze,Ge],[tt,He,bt],[bt,Qe,tt],[He,Ge,Ze],[Ze,bt,He]],abc:[[dt,wt,-1],[-1,-1,dt],[wt,Ut,-1],[-1,-1,wt],[Ut,dt,-1],[-1,-1,Ut]]}}function ne(It,At){return It==="all"||It===null?!0:It.indexOf(At)>-1}function X(It,At){return It===null?At:It}function Q(It,At,Ge){W();var tt=[At],He=[Ge];if(H>=1)tt=[At],He=[Ge];else if(H>0){var Ae=$(At,Ge);tt=Ae.xyzv,He=Ae.abc}for(var Ne=0;Ne<tt.length;Ne++){At=tt[Ne],Ge=He[Ne];for(var Ze=[],Qe=0;Qe<3;Qe++){var bt=At[Qe][0],dt=At[Qe][1],wt=At[Qe][2],Ut=At[Qe][3],Rt=Ge[Qe]>-1?Ge[Qe]:K(bt,dt,wt);Rt>-1?Ze[Qe]=Rt:Ze[Qe]=re(bt,dt,wt,X(It,Ut))}ue(Ze[0],Ze[1],Ze[2])}}function ie(It,At,Ge){var tt=function(He,Ae,Ne){Q(It,[At[He],At[Ae],At[Ne]],[Ge[He],Ge[Ae],Ge[Ne]])};tt(0,1,2),tt(2,3,0)}function se(It,At,Ge){var tt=function(He,Ae,Ne){Q(It,[At[He],At[Ae],At[Ne]],[Ge[He],Ge[Ae],Ge[Ne]])};tt(0,1,2),tt(3,0,1),tt(2,3,0),tt(1,2,3)}function ae(It,At,Ge,tt){var He=It[3];He<Ge&&(He=Ge),He>tt&&(He=tt);for(var Ae=(It[3]-He)/(It[3]-At[3]+1e-9),Ne=[],Ze=0;Ze<4;Ze++)Ne[Ze]=(1-Ae)*It[Ze]+Ae*At[Ze];return Ne}function oe(It,At,Ge){return It>=At&&It<=Ge}function be(It){var At=.001*(R-D);return It>=D-At&&It<=R+At}function ce(It){for(var At=[],Ge=0;Ge<4;Ge++){var tt=It[Ge];At.push([i._x[tt],i._y[tt],i._z[tt],i._value[tt]])}return At}var de=3;function ye(It,At,Ge,tt,He,Ae){Ae||(Ae=1),Ge=[-1,-1,-1];var Ne=!1,Ze=[oe(At[0][3],tt,He),oe(At[1][3],tt,He),oe(At[2][3],tt,He)];if(!Ze[0]&&!Ze[1]&&!Ze[2])return!1;var Qe=function(dt,wt,Ut){return be(wt[0][3])&&be(wt[1][3])&&be(wt[2][3])?(Q(dt,wt,Ut),!0):Ae<de?ye(dt,wt,Ut,D,R,++Ae):!1};if(Ze[0]&&Ze[1]&&Ze[2])return Qe(It,At,Ge)||Ne;var bt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(dt){if(Ze[dt[0]]&&Ze[dt[1]]&&!Ze[dt[2]]){var wt=At[dt[0]],Ut=At[dt[1]],Rt=At[dt[2]],Nt=ae(Rt,wt,tt,He),Wt=ae(Rt,Ut,tt,He);Ne=Qe(It,[Wt,Nt,wt],[-1,-1,Ge[dt[0]]])||Ne,Ne=Qe(It,[wt,Ut,Wt],[Ge[dt[0]],Ge[dt[1]],-1])||Ne,bt=!0}}),bt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(dt){if(Ze[dt[0]]&&!Ze[dt[1]]&&!Ze[dt[2]]){var wt=At[dt[0]],Ut=At[dt[1]],Rt=At[dt[2]],Nt=ae(Ut,wt,tt,He),Wt=ae(Rt,wt,tt,He);Ne=Qe(It,[Wt,Nt,wt],[-1,-1,Ge[dt[0]]])||Ne,bt=!0}}),Ne}function ge(It,At,Ge,tt){var He=!1,Ae=ce(At),Ne=[oe(Ae[0][3],Ge,tt),oe(Ae[1][3],Ge,tt),oe(Ae[2][3],Ge,tt),oe(Ae[3][3],Ge,tt)];if(!Ne[0]&&!Ne[1]&&!Ne[2]&&!Ne[3])return He;if(Ne[0]&&Ne[1]&&Ne[2]&&Ne[3])return o&&(He=se(It,Ae,At)||He),He;var Ze=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(Qe){if(Ne[Qe[0]]&&Ne[Qe[1]]&&Ne[Qe[2]]&&!Ne[Qe[3]]){var bt=Ae[Qe[0]],dt=Ae[Qe[1]],wt=Ae[Qe[2]],Ut=Ae[Qe[3]];if(o)He=Q(It,[bt,dt,wt],[At[Qe[0]],At[Qe[1]],At[Qe[2]]])||He;else{var Rt=ae(Ut,bt,Ge,tt),Nt=ae(Ut,dt,Ge,tt),Wt=ae(Ut,wt,Ge,tt);He=Q(null,[Rt,Nt,Wt],[-1,-1,-1])||He}Ze=!0}}),Ze||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(Qe){if(Ne[Qe[0]]&&Ne[Qe[1]]&&!Ne[Qe[2]]&&!Ne[Qe[3]]){var bt=Ae[Qe[0]],dt=Ae[Qe[1]],wt=Ae[Qe[2]],Ut=Ae[Qe[3]],Rt=ae(wt,bt,Ge,tt),Nt=ae(wt,dt,Ge,tt),Wt=ae(Ut,dt,Ge,tt),Vt=ae(Ut,bt,Ge,tt);o?(He=Q(It,[bt,Vt,Rt],[At[Qe[0]],-1,-1])||He,He=Q(It,[dt,Nt,Wt],[At[Qe[1]],-1,-1])||He):He=ie(null,[Rt,Nt,Wt,Vt],[-1,-1,-1,-1])||He,Ze=!0}}),Ze)||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(Qe){if(Ne[Qe[0]]&&!Ne[Qe[1]]&&!Ne[Qe[2]]&&!Ne[Qe[3]]){var bt=Ae[Qe[0]],dt=Ae[Qe[1]],wt=Ae[Qe[2]],Ut=Ae[Qe[3]],Rt=ae(dt,bt,Ge,tt),Nt=ae(wt,bt,Ge,tt),Wt=ae(Ut,bt,Ge,tt);o?(He=Q(It,[bt,Rt,Nt],[At[Qe[0]],-1,-1])||He,He=Q(It,[bt,Nt,Wt],[At[Qe[0]],-1,-1])||He,He=Q(It,[bt,Wt,Rt],[At[Qe[0]],-1,-1])||He):He=Q(null,[Rt,Nt,Wt],[-1,-1,-1])||He,Ze=!0}}),He}function me(It,At,Ge,tt,He,Ae,Ne,Ze,Qe,bt,dt){var wt=!1;return d&&(ne(It,"A")&&(wt=ge(null,[At,Ge,tt,Ae],bt,dt)||wt),ne(It,"B")&&(wt=ge(null,[Ge,tt,He,Qe],bt,dt)||wt),ne(It,"C")&&(wt=ge(null,[Ge,Ae,Ne,Qe],bt,dt)||wt),ne(It,"D")&&(wt=ge(null,[tt,Ae,Ze,Qe],bt,dt)||wt),ne(It,"E")&&(wt=ge(null,[Ge,tt,Ae,Qe],bt,dt)||wt)),o&&(wt=ge(It,[Ge,tt,Ae,Qe],bt,dt)||wt),wt}function Ee(It,At,Ge,tt,He,Ae,Ne,Ze){return[Ze[0]===!0?!0:ye(It,ce([At,Ge,tt]),[At,Ge,tt],Ae,Ne),Ze[1]===!0?!0:ye(It,ce([tt,He,At]),[tt,He,At],Ae,Ne)]}function Pe(It,At,Ge,tt,He,Ae,Ne,Ze,Qe){return Ze?Ee(It,At,Ge,He,tt,Ae,Ne,Qe):Ee(It,Ge,He,tt,At,Ae,Ne,Qe)}function Ue(It,At,Ge,tt,He,Ae,Ne){var Ze=!1,Qe,bt,dt,wt,Ut=function(){Ze=ye(It,[Qe,bt,dt],[-1,-1,-1],He,Ae)||Ze,Ze=ye(It,[dt,wt,Qe],[-1,-1,-1],He,Ae)||Ze},Rt=Ne[0],Nt=Ne[1],Wt=Ne[2];return Rt&&(Qe=q(ce([P(At,Ge-0,tt-0)])[0],ce([P(At-1,Ge-0,tt-0)])[0],Rt),bt=q(ce([P(At,Ge-0,tt-1)])[0],ce([P(At-1,Ge-0,tt-1)])[0],Rt),dt=q(ce([P(At,Ge-1,tt-1)])[0],ce([P(At-1,Ge-1,tt-1)])[0],Rt),wt=q(ce([P(At,Ge-1,tt-0)])[0],ce([P(At-1,Ge-1,tt-0)])[0],Rt),Ut()),Nt&&(Qe=q(ce([P(At-0,Ge,tt-0)])[0],ce([P(At-0,Ge-1,tt-0)])[0],Nt),bt=q(ce([P(At-0,Ge,tt-1)])[0],ce([P(At-0,Ge-1,tt-1)])[0],Nt),dt=q(ce([P(At-1,Ge,tt-1)])[0],ce([P(At-1,Ge-1,tt-1)])[0],Nt),wt=q(ce([P(At-1,Ge,tt-0)])[0],ce([P(At-1,Ge-1,tt-0)])[0],Nt),Ut()),Wt&&(Qe=q(ce([P(At-0,Ge-0,tt)])[0],ce([P(At-0,Ge-0,tt-1)])[0],Wt),bt=q(ce([P(At-0,Ge-1,tt)])[0],ce([P(At-0,Ge-1,tt-1)])[0],Wt),dt=q(ce([P(At-1,Ge-1,tt)])[0],ce([P(At-1,Ge-1,tt-1)])[0],Wt),wt=q(ce([P(At-1,Ge-0,tt)])[0],ce([P(At-1,Ge-0,tt-1)])[0],Wt),Ut()),Ze}function we(It,At,Ge,tt,He,Ae,Ne,Ze,Qe,bt,dt,wt){var Ut=It;return wt?(d&&It==="even"&&(Ut=null),me(Ut,At,Ge,tt,He,Ae,Ne,Ze,Qe,bt,dt)):(d&&It==="odd"&&(Ut=null),me(Ut,Qe,Ze,Ne,Ae,He,tt,Ge,At,bt,dt))}function ke(It,At,Ge,tt,He){for(var Ae=[],Ne=0,Ze=0;Ze<At.length;Ze++)for(var Qe=At[Ze],bt=1;bt<T;bt++)for(var dt=1;dt<L;dt++)Ae.push(Pe(It,P(Qe,dt-1,bt-1),P(Qe,dt-1,bt),P(Qe,dt,bt-1),P(Qe,dt,bt),Ge,tt,(Qe+dt+bt)%2,He&&He[Ne]?He[Ne]:[])),Ne++;return Ae}function Xe(It,At,Ge,tt,He){for(var Ae=[],Ne=0,Ze=0;Ze<At.length;Ze++)for(var Qe=At[Ze],bt=1;bt<u;bt++)for(var dt=1;dt<T;dt++)Ae.push(Pe(It,P(bt-1,Qe,dt-1),P(bt,Qe,dt-1),P(bt-1,Qe,dt),P(bt,Qe,dt),Ge,tt,(bt+Qe+dt)%2,He&&He[Ne]?He[Ne]:[])),Ne++;return Ae}function Ve(It,At,Ge,tt,He){for(var Ae=[],Ne=0,Ze=0;Ze<At.length;Ze++)for(var Qe=At[Ze],bt=1;bt<L;bt++)for(var dt=1;dt<u;dt++)Ae.push(Pe(It,P(dt-1,bt-1,Qe),P(dt-1,bt,Qe),P(dt,bt-1,Qe),P(dt,bt,Qe),Ge,tt,(dt+bt+Qe)%2,He&&He[Ne]?He[Ne]:[])),Ne++;return Ae}function Ie(It,At,Ge){for(var tt=1;tt<T;tt++)for(var He=1;He<L;He++)for(var Ae=1;Ae<u;Ae++)we(It,P(Ae-1,He-1,tt-1),P(Ae-1,He-1,tt),P(Ae-1,He,tt-1),P(Ae-1,He,tt),P(Ae,He-1,tt-1),P(Ae,He-1,tt),P(Ae,He,tt-1),P(Ae,He,tt),At,Ge,(Ae+He+tt)%2)}function De(It,At,Ge){o=!0,Ie(It,At,Ge),o=!1}function Ye(It,At,Ge){d=!0,Ie(It,At,Ge),d=!1}function vt(It,At,Ge,tt,He,Ae){for(var Ne=[],Ze=0,Qe=0;Qe<At.length;Qe++)for(var bt=At[Qe],dt=1;dt<T;dt++)for(var wt=1;wt<L;wt++)Ne.push(Ue(It,bt,wt,dt,Ge,tt,He[Qe],Ae&&Ae[Ze]?Ae[Ze]:[])),Ze++;return Ne}function Dt(It,At,Ge,tt,He,Ae){for(var Ne=[],Ze=0,Qe=0;Qe<At.length;Qe++)for(var bt=At[Qe],dt=1;dt<u;dt++)for(var wt=1;wt<T;wt++)Ne.push(Ue(It,dt,bt,wt,Ge,tt,He[Qe],Ae&&Ae[Ze]?Ae[Ze]:[])),Ze++;return Ne}function Kt(It,At,Ge,tt,He,Ae){for(var Ne=[],Ze=0,Qe=0;Qe<At.length;Qe++)for(var bt=At[Qe],dt=1;dt<L;dt++)for(var wt=1;wt<u;wt++)Ne.push(Ue(It,wt,dt,bt,Ge,tt,He[Qe],Ae&&Ae[Ze]?Ae[Ze]:[])),Ze++;return Ne}function Ft(It,At){for(var Ge=[],tt=It;tt<At;tt++)Ge.push(tt);return Ge}function Mt(){for(var It=0;It<u;It++)for(var At=0;At<L;At++)for(var Ge=0;Ge<T;Ge++){var tt=P(It,At,Ge);re(i._x[tt],i._y[tt],i._z[tt],i._value[tt])}}function Xt(){Y(),Mt();var It=null;if(p&&f&&(U(f),De(It,D,R)),x&&v){U(v);for(var At=i.surface.pattern,Ge=i.surface.count,tt=0;tt<Ge;tt++){var He=Ge===1?.5:tt/(Ge-1),Ae=(1-He)*D+He*R,Ne=Math.abs(Ae-z),Ze=Math.abs(Ae-I),Qe=Ne>Ze?[z,Ae]:[Ae,I];Ye(At,Qe[0],Qe[1])}}var bt=[[Math.min(D,I),Math.max(D,I)],[Math.min(z,R),Math.max(z,R)]];["x","y","z"].forEach(function(dt){for(var wt=[],Ut=0;Ut<bt.length;Ut++){var Rt=0,Nt=bt[Ut][0],Wt=bt[Ut][1],Vt=i.slices[dt];if(Vt.show&&Vt.fill){U(Vt.fill);var ir=[],Hr=[],sn=[];if(Vt.locations.length)for(var jr=0;jr<Vt.locations.length;jr++){var at=a(Vt.locations[jr],dt==="x"?_:dt==="y"?c:b);at.distRatio===0?ir.push(at.id):at.id>0&&(Hr.push(at.id),dt==="x"?sn.push([at.distRatio,0,0]):dt==="y"?sn.push([0,at.distRatio,0]):sn.push([0,0,at.distRatio]))}else dt==="x"?ir=Ft(1,u-1):dt==="y"?ir=Ft(1,L-1):ir=Ft(1,T-1);Hr.length>0&&(dt==="x"?wt[Rt]=vt(It,Hr,Nt,Wt,sn,wt[Rt]):dt==="y"?wt[Rt]=Dt(It,Hr,Nt,Wt,sn,wt[Rt]):wt[Rt]=Kt(It,Hr,Nt,Wt,sn,wt[Rt]),Rt++),ir.length>0&&(dt==="x"?wt[Rt]=ke(It,ir,Nt,Wt,wt[Rt]):dt==="y"?wt[Rt]=Xe(It,ir,Nt,Wt,wt[Rt]):wt[Rt]=Ve(It,ir,Nt,Wt,wt[Rt]),Rt++)}var $t=i.caps[dt];$t.show&&$t.fill&&(U($t.fill),dt==="x"?wt[Rt]=ke(It,[0,u-1],Nt,Wt,wt[Rt]):dt==="y"?wt[Rt]=Xe(It,[0,L-1],Nt,Wt,wt[Rt]):wt[Rt]=Ve(It,[0,T-1],Nt,Wt,wt[Rt]),Rt++)}}),m===0&&Y(),i._meshX=O,i._meshY=F,i._meshZ=N,i._meshIntensity=G,i._Xs=_,i._Ys=c,i._Zs=b}return Xt(),i}function s(i,x){var p=i.glplot.gl,v=A({gl:p}),f=new n(i,v,x.uid);return v._trace=f,f.update(x),i.glplot.add(v),f}ee.exports={findNearestOnAxis:a,generateIsoMeshes:h,createIsosurfaceTrace:s}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(y,ee,te){var A=y("../../lib"),g=y("../../registry"),S=y("./attributes"),M=y("../../components/colorscale/defaults");function e(n,r,t,h){function s(i,x){return A.coerce(n,r,S,i,x)}a(n,r,t,h,s)}function a(n,r,t,h,s){var i=s("isomin"),x=s("isomax");x!=null&&i!==void 0&&i!==null&&i>x&&(r.isomin=null,r.isomax=null);var p=s("x"),v=s("y"),f=s("z"),d=s("value");if(!p||!p.length||!v||!v.length||!f||!f.length||!d||!d.length){r.visible=!1;return}var o=g.getComponentMethod("calendars","handleTraceDefaults");o(n,r,["x","y","z"],h),s("valuehoverformat"),["x","y","z"].forEach(function(_){s(_+"hoverformat");var c="caps."+_,b=s(c+".show");b&&s(c+".fill");var u="slices."+_,L=s(u+".show");L&&(s(u+".fill"),s(u+".locations"))});var m=s("spaceframe.show");m&&s("spaceframe.fill");var l=s("surface.show");l&&(s("surface.count"),s("surface.fill"),s("surface.pattern"));var w=s("contour.show");w&&(s("contour.color"),s("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(_){s(_)}),M(n,r,h,s,{prefix:"",cLetter:"c"}),r._length=null}ee.exports={supplyDefaults:e,supplyIsoDefaults:a}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,calc:y("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:y("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(y,ee,te){var A=y("../../components/colorscale/attributes"),g=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../surface/attributes"),e=y("../../plots/attributes"),a=y("../../lib/extend").extendFlat;ee.exports=a({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:S({editType:"calc"}),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},A("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:M.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:a({},M.contours.x.show,{}),color:M.contours.x.color,width:M.contours.x.width,editType:"calc"},lightposition:{x:a({},M.lightposition.x,{dflt:1e5}),y:a({},M.lightposition.y,{dflt:1e5}),z:a({},M.lightposition.z,{dflt:0}),editType:"calc"},lighting:a({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},M.lighting),hoverinfo:a({},e.hoverinfo,{editType:"calc"}),showlegend:a({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(y,ee,te){var A=y("../../components/colorscale/calc");ee.exports=function(S,M){M.intensity&&A(S,M,{vals:M.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_mesh3d,g=y("../../../stackgl_modules").delaunay_triangulate,S=y("../../../stackgl_modules").alpha_shape,M=y("../../../stackgl_modules").convex_hull,e=y("../../lib/gl_format_color").parseColorScale,a=y("../../lib/str2rgbarray"),n=y("../../components/colorscale").extractOpts,r=y("../../plots/gl3d/zip3");function t(d,o,m){this.scene=d,this.uid=m,this.mesh=o,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var h=t.prototype;h.handlePick=function(d){if(d.object===this.mesh){var o=d.index=d.data.index;d.data._cellCenter?d.traceCoordinate=d.data.dataCoordinate:d.traceCoordinate=[this.data.x[o],this.data.y[o],this.data.z[o]];var m=this.data.hovertext||this.data.text;return Array.isArray(m)&&m[o]!==void 0?d.textLabel=m[o]:m&&(d.textLabel=m),!0}};function s(d){for(var o=[],m=d.length,l=0;l<m;l++)o[l]=a(d[l]);return o}function i(d,o,m,l){for(var w=[],_=o.length,c=0;c<_;c++)w[c]=d.d2l(o[c],0,l)*m;return w}function x(d){for(var o=[],m=d.length,l=0;l<m;l++)o[l]=Math.round(d[l]);return o}function p(d,o){for(var m=["x","y","z"].indexOf(d),l=[],w=o.length,_=0;_<w;_++)l[_]=[o[_][(m+1)%3],o[_][(m+2)%3]];return g(l)}function v(d,o){for(var m=d.length,l=0;l<m;l++)if(d[l]<=-.5||d[l]>=o-.5)return!1;return!0}h.update=function(d){var o=this.scene,m=o.fullSceneLayout;this.data=d;var l=d.x.length,w=r(i(m.xaxis,d.x,o.dataScale[0],d.xcalendar),i(m.yaxis,d.y,o.dataScale[1],d.ycalendar),i(m.zaxis,d.z,o.dataScale[2],d.zcalendar)),_;if(d.i&&d.j&&d.k){if(d.i.length!==d.j.length||d.j.length!==d.k.length||!v(d.i,l)||!v(d.j,l)||!v(d.k,l))return;_=r(x(d.i),x(d.j),x(d.k))}else d.alphahull===0?_=M(w):d.alphahull>0?_=S(d.alphahull,w):_=p(d.delaunayaxis,w);var c={positions:w,cells:_,lightPosition:[d.lightposition.x,d.lightposition.y,d.lightposition.z],ambient:d.lighting.ambient,diffuse:d.lighting.diffuse,specular:d.lighting.specular,roughness:d.lighting.roughness,fresnel:d.lighting.fresnel,vertexNormalsEpsilon:d.lighting.vertexnormalsepsilon,faceNormalsEpsilon:d.lighting.facenormalsepsilon,opacity:d.opacity,contourEnable:d.contour.show,contourColor:a(d.contour.color).slice(0,3),contourWidth:d.contour.width,useFacetNormals:d.flatshading};if(d.intensity){var b=n(d);this.color="#fff";var u=d.intensitymode;c[u+"Intensity"]=d.intensity,c[u+"IntensityBounds"]=[b.min,b.max],c.colormap=e(d)}else d.vertexcolor?(this.color=d.vertexcolor[0],c.vertexColors=s(d.vertexcolor)):d.facecolor?(this.color=d.facecolor[0],c.cellColors=s(d.facecolor)):(this.color=d.color,c.meshColor=a(d.color));this.mesh.update(c)},h.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function f(d,o){var m=d.glplot.gl,l=A({gl:m}),w=new t(d,l,o.uid);return l._trace=w,w.update(o),d.glplot.add(l),w}ee.exports=f},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("../../components/colorscale/defaults"),M=y("./attributes");ee.exports=function(a,n,r,t){function h(v,f){return g.coerce(a,n,M,v,f)}function s(v){var f=v.map(function(d){var o=h(d);return o&&g.isArrayOrTypedArray(o)?o:null});return f.every(function(d){return d&&d.length===f[0].length})&&f}var i=s(["x","y","z"]);if(!i){n.visible=!1;return}if(s(["i","j","k"]),n.i&&(!n.j||!n.k)||n.j&&(!n.k||!n.i)||n.k&&(!n.i||!n.j)){n.visible=!1;return}var x=A.getComponentMethod("calendars","handleTraceDefaults");x(a,n,["x","y","z"],t),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(v){h(v)});var p=h("contour.show");p&&(h("contour.color"),h("contour.width")),"intensity"in a?(h("intensity"),h("intensitymode"),S(a,n,t,h,{prefix:"",cLetter:"c"})):(n.showscale=!1,"facecolor"in a?h("facecolor"):"vertexcolor"in a?h("vertexcolor"):h("color",r)),h("text"),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat"),h("zhoverformat"),n._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:y("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(y,ee,te){var A=y("../../lib").extendFlat,g=y("../scatter/attributes"),S=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=y("../../components/drawing/attributes").dash,e=y("../../components/fx/attributes"),a=y("../../constants/delta.js"),n=a.INCREASING.COLOR,r=a.DECREASING.COLOR,t=g.line;function h(s){return{line:{color:A({},t.color,{dflt:s}),width:t.width,dash:M,editType:"style"},editType:"style"}}ee.exports={xperiod:g.xperiod,xperiod0:g.xperiod0,xperiodalignment:g.xperiodalignment,xhoverformat:S("x"),yhoverformat:S("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:A({},t.width,{}),dash:A({},M,{}),editType:"style"},increasing:h(n),decreasing:h(r),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:A({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(y,ee,te){var A=y("../../lib"),g=A._,S=y("../../plots/cartesian/axes"),M=y("../../plots/cartesian/align_period"),e=y("../../constants/numerical").BADNUM;function a(h,s){var i=S.getFromId(h,s.xaxis),x=S.getFromId(h,s.yaxis),p=t(h,i,s),v=s._minDiff;s._minDiff=null;var f=s._origX;s._origX=null;var d=s._xcalc;s._xcalc=null;var o=r(h,s,f,d,x,n);return s._extremes[i._id]=S.findExtremes(i,d,{vpad:v/2}),o.length?(A.extendFlat(o[0].t,{wHover:v/2,tickLen:p}),o):[{t:{empty:!0}}]}function n(h,s,i,x){return{o:h,h:s,l:i,c:x}}function r(h,s,i,x,p,v){for(var f=p.makeCalcdata(s,"open"),d=p.makeCalcdata(s,"high"),o=p.makeCalcdata(s,"low"),m=p.makeCalcdata(s,"close"),l=Array.isArray(s.text),w=Array.isArray(s.hovertext),_=!0,c=null,b=!!s.xperiodalignment,u=[],L=0;L<x.length;L++){var T=x[L],k=f[L],P=d[L],z=o[L],I=m[L];if(T!==e&&k!==e&&P!==e&&z!==e&&I!==e){I===k?c!==null&&I!==c&&(_=I>c):_=I>k,c=I;var D=v(k,P,z,I);D.pos=T,D.yc=(k+I)/2,D.i=L,D.dir=_?"increasing":"decreasing",D.x=D.pos,D.y=[z,P],b&&(D.orig_p=i[L]),l&&(D.tx=s.text[L]),w&&(D.htx=s.hovertext[L]),u.push(D)}else u.push({pos:T,empty:!0})}return s._extremes[p._id]=S.findExtremes(p,A.concat(o,d),{padded:!0}),u.length&&(u[0].t={labels:{open:g(h,"open:")+" ",high:g(h,"high:")+" ",low:g(h,"low:")+" ",close:g(h,"close:")+" "}}),u}function t(h,s,i){var x=i._minDiff;if(!x){var p=h._fullData,v=[];x=1/0;var f;for(f=0;f<p.length;f++){var d=p[f];if(d.type==="ohlc"&&d.visible===!0&&d.xaxis===s._id){v.push(d);var o=s.makeCalcdata(d,"x");d._origX=o;var m=M(i,s,"x",o).vals;d._xcalc=m;var l=A.distinctVals(m).minDiff;l&&isFinite(l)&&(x=Math.min(x,l))}}for(x===1/0&&(x=1),f=0;f<v.length;f++)v[f]._minDiff=x}return x*i.tickwidth}ee.exports={calc:a,calcCommon:r}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(y,ee,te){var A=y("../../lib"),g=y("./ohlc_defaults"),S=y("../scatter/period_defaults"),M=y("./attributes");ee.exports=function(n,r,t,h){function s(x,p){return A.coerce(n,r,M,x,p)}var i=g(n,r,s,h);if(!i){r.visible=!1;return}S(n,r,h,s,{x:!0}),s("xhoverformat"),s("yhoverformat"),s("line.width"),s("line.dash"),e(n,r,s,"increasing"),e(n,r,s,"decreasing"),s("text"),s("hovertext"),s("tickwidth"),h._requestRangeslider[r.xaxis]=!0};function e(a,n,r,t){r(t+".line.color"),r(t+".line.width",n.line.width),r(t+".line.dash",n.line.dash)}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../lib"),S=y("../../components/fx"),M=y("../../components/color"),e=y("../../lib").fillText,a=y("../../constants/delta.js"),n={increasing:a.INCREASING.SYMBOL,decreasing:a.DECREASING.SYMBOL};function r(i,x,p,v){var f=i.cd,d=f[0].trace;return d.hoverlabel.split?h(i,x,p,v):s(i,x,p,v)}function t(i,x,p,v){var f=i.cd,d=i.xa,o=f[0].trace,m=f[0].t,l=o.type,w=l==="ohlc"?"l":"min",_=l==="ohlc"?"h":"max",c,b,u=m.bPos||0,L=function(K){return K.pos+u-x},T=m.bdPos||m.tickLen,k=m.wHover,P=Math.min(1,T/Math.abs(d.r2c(d.range[1])-d.r2c(d.range[0])));c=i.maxHoverDistance-P,b=i.maxSpikeDistance-P;function z(K){var W=L(K);return S.inbox(W-k,W+k,c)}function I(K){var W=K[w],Y=K[_];return W===Y||S.inbox(W-p,Y-p,c)}function D(K){return(z(K)+I(K))/2}var R=S.getDistanceFunction(v,z,I,D);if(S.getClosest(f,R,i),i.index===!1)return null;var O=f[i.index];if(O.empty)return null;var F=O.dir,N=o[F],G=N.line.color;return M.opacity(G)&&N.line.width?i.color=G:i.color=N.fillcolor,i.x0=d.c2p(O.pos+u-T,!0),i.x1=d.c2p(O.pos+u+T,!0),i.xLabelVal=O.orig_p!==void 0?O.orig_p:O.pos,i.spikeDistance=D(O)*b/c,i.xSpike=d.c2p(O.pos,!0),i}function h(i,x,p,v){var f=i.cd,d=i.ya,o=f[0].trace,m=f[0].t,l=[],w=t(i,x,p,v);if(!w)return[];var _=w.index,c=f[_],b=c.hi||o.hoverinfo,u=b.split("+"),L=b==="all",T=L||u.indexOf("y")!==-1;if(!T)return[];for(var k=["high","open","close","low"],P={},z=0;z<k.length;z++){var I=k[z],D=o[I][w.index],R=d.c2p(D,!0),O;D in P?(O=P[D],O.yLabel+="<br>"+m.labels[I]+A.hoverLabelText(d,D,o.yhoverformat)):(O=g.extendFlat({},w),O.y0=O.y1=R,O.yLabelVal=D,O.yLabel=m.labels[I]+A.hoverLabelText(d,D,o.yhoverformat),O.name="",l.push(O),P[D]=O)}return l}function s(i,x,p,v){var f=i.cd,d=i.ya,o=f[0].trace,m=f[0].t,l=t(i,x,p,v);if(!l)return[];var w=l.index,_=f[w],c=l.index=_.i,b=_.dir;function u(D){return m.labels[D]+A.hoverLabelText(d,o[D][c],o.yhoverformat)}var L=_.hi||o.hoverinfo,T=L.split("+"),k=L==="all",P=k||T.indexOf("y")!==-1,z=k||T.indexOf("text")!==-1,I=P?[u("open"),u("high"),u("low"),u("close")+"  "+n[b]]:[];return z&&e(_,o,I),l.extraText=I.join("<br>"),l.y0=l.y1=d.c2p(_.yc,!0),[l]}ee.exports={hoverPoints:r,hoverSplit:h,hoverOnPoints:s}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(y,ee,te){ee.exports={moduleType:"trace",name:"ohlc",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc").calc,plot:y("./plot"),style:y("./style"),hoverPoints:y("./hover").hoverPoints,selectPoints:y("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib");ee.exports=function(M,e,a,n){var r=a("x"),t=a("open"),h=a("high"),s=a("low"),i=a("close");a("hoverlabel.split");var x=A.getComponentMethod("calendars","handleTraceDefaults");if(x(M,e,["x"],n),!!(t&&h&&s&&i)){var p=Math.min(t.length,h.length,s.length,i.length);return r&&(p=Math.min(p,g.minRowLength(r))),e._length=p,p}}},{"../../lib":515,"../../registry":647}],887:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib");ee.exports=function(M,e,a,n){var r=e.yaxis,t=e.xaxis,h=!!t.rangebreaks;g.makeTraceGroups(n,a,"trace ohlc").each(function(s){var i=A.select(this),x=s[0],p=x.t,v=x.trace;if(v.visible!==!0||p.empty){i.remove();return}var f=p.tickLen,d=i.selectAll("path").data(g.identity);d.enter().append("path"),d.exit().remove(),d.attr("d",function(o){if(o.empty)return"M0,0Z";var m=t.c2p(o.pos-f,!0),l=t.c2p(o.pos+f,!0),w=h?(m+l)/2:t.c2p(o.pos,!0),_=r.c2p(o.o,!0),c=r.c2p(o.h,!0),b=r.c2p(o.l,!0),u=r.c2p(o.c,!0);return"M"+m+","+_+"H"+w+"M"+w+","+c+"V"+b+"M"+l+","+u+"H"+w})})}},{"../../lib":515,"@plotly/d3":58}],888:[function(y,ee,te){ee.exports=function(g,S){var M=g.cd,e=g.xaxis,a=g.yaxis,n=[],r,t=M[0].t.bPos||0;if(S===!1)for(r=0;r<M.length;r++)M[r].selected=0;else for(r=0;r<M.length;r++){var h=M[r];S.contains([e.c2p(h.pos+t),a.c2p(h.yc)],null,h.i,g)?(n.push({pointNumber:h.i,x:e.c2d(h.pos),y:a.c2d(h.yc)}),h.selected=1):h.selected=0}return n}},{}],889:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/drawing"),S=y("../../components/color");ee.exports=function(e,a,n){var r=n||A.select(e).selectAll("g.ohlclayer").selectAll("g.trace");r.style("opacity",function(t){return t[0].trace.opacity}),r.each(function(t){var h=t[0].trace;A.select(this).selectAll("path").each(function(s){if(!s.empty){var i=h[s.dir].line;A.select(this).style("fill","none").call(S.stroke,i.color).call(g.dashLine,i.dash,i.width).style("opacity",h.selectedpoints&&!s.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(y,ee,te){var A=y("../../lib/extend").extendFlat,g=y("../../plots/attributes"),S=y("../../plots/font_attributes"),M=y("../../components/colorscale/attributes"),e=y("../../plots/template_attributes").hovertemplateAttrs,a=y("../../plots/domain").attributes,n=A({editType:"calc"},M("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});ee.exports={domain:a({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:A({},g.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:S({editType:"calc"}),tickfont:S({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:n,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(y,ee,te){var A=y("../../plots/get_data").getModuleCalcData,g=y("./plot"),S="parcats";te.name=S,te.plot=function(M,e,a,n){var r=A(M.calcdata,S);if(r.length){var t=r[0];g(M,t,a,n)}},te.clean=function(M,e,a,n){var r=n._has&&n._has("parcats"),t=e._has&&e._has("parcats");r&&!t&&n._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(y,ee,te){var A=y("../../lib/gup").wrap,g=y("../../components/colorscale/helpers").hasColorscale,S=y("../../components/colorscale/calc"),M=y("../../lib/filter_unique.js"),e=y("../../components/drawing"),a=y("../../lib"),n=y("fast-isnumeric");ee.exports=function(m,l){var w=a.filterVisible(l.dimensions);if(w.length===0)return[];var _=w.map(function(j){var q;if(j.categoryorder==="trace")q=null;else if(j.categoryorder==="array")q=j.categoryarray;else{q=M(j.values);for(var H=!0,U=0;U<q.length;U++)if(!n(q[U])){H=!1;break}q.sort(H?a.sorterAsc:void 0),j.categoryorder==="category descending"&&(q=q.reverse())}return p(j.values,q)}),c,b,u;a.isArrayOrTypedArray(l.counts)?c=l.counts:c=[l.counts],v(w),w.forEach(function(j,q){f(j,_[q])});var L=l.line,T;L?(g(l,"line")&&S(m,l,{vals:l.line.color,containerStr:"line",cLetter:"c"}),T=e.tryColorscale(L)):T=a.identity;function k(j){var q,H;return a.isArrayOrTypedArray(L.color)?(q=L.color[j%L.color.length],H=q):q=L.color,{color:T(q),rawColor:H}}var P=w[0].values.length,z={},I=_.map(function(j){return j.inds});u=0;var D,R;for(D=0;D<P;D++){var O=[];for(R=0;R<I.length;R++)O.push(I[R][D]);b=c[D%c.length],u+=b;var F=k(D),N=O+"-"+F.rawColor;z[N]===void 0&&(z[N]=i(O,F.color,F.rawColor)),x(z[N],D,b)}var G=w.map(function(j,q){return t(q,j._index,j._displayindex,j.label,u)});for(D=0;D<P;D++)for(b=c[D%c.length],R=0;R<G.length;R++){var K=G[R].containerInd,W=_[R].inds[D],Y=G[R].categories;if(Y[W]===void 0){var re=l.dimensions[K]._categoryarray[W],ue=l.dimensions[K]._ticktext[W];Y[W]=h(R,W,re,ue)}s(Y[W],D,b)}return A(r(G,z,u))};function r(o,m,l){var w=o.map(function(_){return _.categories.length}).reduce(function(_,c){return Math.max(_,c)});return{dimensions:o,paths:m,trace:void 0,maxCats:w,count:l}}function t(o,m,l,w,_){return{dimensionInd:o,containerInd:m,displayInd:l,dimensionLabel:w,count:_,categories:[],dragX:null}}function h(o,m,l,w){return{dimensionInd:o,categoryInd:m,categoryValue:l,displayInd:m,categoryLabel:w,valueInds:[],count:0,dragY:null}}function s(o,m,l){o.valueInds.push(m),o.count+=l}function i(o,m,l){return{categoryInds:o,color:m,rawColor:l,valueInds:[],count:0}}function x(o,m,l){o.valueInds.push(m),o.count+=l}function p(o,m){m==null?m=[]:m=m.map(function(T){return T});var l={},w={},_=[];m.forEach(function(T,k){l[T]=0,w[T]=k});for(var c=0;c<o.length;c++){var b=o[c],u;l[b]===void 0?(l[b]=1,u=m.push(b)-1,w[b]=u):(l[b]++,u=w[b]),_.push(u)}var L=m.map(function(T){return l[T]});return{uniqueValues:m,uniqueCounts:L,inds:_}}function v(o){var m=o.map(function(w){return w.displayindex}),l;if(d(m))for(l=0;l<o.length;l++)o[l]._displayindex=o[l].displayindex;else for(l=0;l<o.length;l++)o[l]._displayindex=l}function f(o,m){o._categoryarray=m.uniqueValues,o.ticktext===null||o.ticktext===void 0?o._ticktext=[]:o._ticktext=o.ticktext.slice();for(var l=o._ticktext.length;l<m.uniqueValues.length;l++)o._ticktext.push(m.uniqueValues[l])}function d(o){for(var m=new Array(o.length),l=0;l<o.length;l++){if(o[l]<0||o[l]>=o.length||m[o[l]]!==void 0)return!1;m[o[l]]=!0}return!0}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/colorscale/helpers").hasColorscale,S=y("../../components/colorscale/defaults"),M=y("../../plots/domain").defaults,e=y("../../plots/array_container_defaults"),a=y("./attributes"),n=y("../parcoords/merge_length");function r(h,s,i,x,p){p("line.shape"),p("line.hovertemplate");var v=p("line.color",x.colorway[0]);if(g(h,"line")&&A.isArrayOrTypedArray(v)){if(v.length)return p("line.colorscale"),S(h,s,x,p,{prefix:"line.",cLetter:"c"}),v.length;s.line.color=i}return 1/0}function t(h,s){function i(m,l){return A.coerce(h,s,a.dimensions,m,l)}var x=i("values"),p=i("visible");if(x&&x.length||(p=s.visible=!1),p){i("label"),i("displayindex",s._index);var v=h.categoryarray,f=Array.isArray(v)&&v.length>0,d;f&&(d="array");var o=i("categoryorder",d);o==="array"?(i("categoryarray"),i("ticktext")):(delete h.categoryarray,delete h.ticktext),!f&&o==="array"&&(s.categoryorder="trace")}}ee.exports=function(s,i,x,p){function v(l,w){return A.coerce(s,i,a,l,w)}var f=e(s,i,{name:"dimensions",handleItemDefaults:t}),d=r(s,i,x,p,v);M(i,p,v),(!Array.isArray(f)||!f.length)&&(i.visible=!1),n(i,f,"values",d),v("hoveron"),v("hovertemplate"),v("arrangement"),v("bundlecolors"),v("sortpaths"),v("counts");var o={family:p.font.family,size:Math.round(p.font.size),color:p.font.color};A.coerceFont(v,"labelfont",o);var m={family:p.font.family,size:Math.round(p.font.size/1.2),color:p.font.color};A.coerceFont(v,"tickfont",m)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:y("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(y,ee,te){var A=y("@plotly/d3"),g=y("d3-interpolate").interpolateNumber,S=y("../../plot_api/plot_api"),M=y("../../components/fx"),e=y("../../lib"),a=e.strTranslate,n=y("../../components/drawing"),r=y("tinycolor2"),t=y("../../lib/svg_text_utils");function h(U,$,ne,X){var Q=$._context.staticPlot,ie=U.map(re.bind(0,$,ne)),se=X.selectAll("g.parcatslayer").data([null]);se.enter().append("g").attr("class","parcatslayer").style("pointer-events",Q?"none":"all");var ae=se.selectAll("g.trace.parcats").data(ie,s),oe=ae.enter().append("g").attr("class","trace parcats");ae.attr("transform",function(ke){return a(ke.x,ke.y)}),oe.append("g").attr("class","paths");var be=ae.select("g.paths"),ce=be.selectAll("path.path").data(function(ke){return ke.paths},s);ce.attr("fill",function(ke){return ke.model.color});var de=ce.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(ke){return ke.model.color}).attr("fill-opacity",0);m(de),ce.attr("d",function(ke){return ke.svgD}),de.empty()||ce.sort(x),ce.exit().remove(),ce.on("mouseover",p).on("mouseout",v).on("click",o),oe.append("g").attr("class","dimensions");var ye=ae.select("g.dimensions"),ge=ye.selectAll("g.dimension").data(function(ke){return ke.dimensions},s);ge.enter().append("g").attr("class","dimension"),ge.attr("transform",function(ke){return a(ke.x,0)}),ge.exit().remove();var me=ge.selectAll("g.category").data(function(ke){return ke.categories},s),Ee=me.enter().append("g").attr("class","category");me.attr("transform",function(ke){return a(0,ke.y)}),Ee.append("rect").attr("class","catrect").attr("pointer-events","none"),me.select("rect.catrect").attr("fill","none").attr("width",function(ke){return ke.width}).attr("height",function(ke){return ke.height}),_(Ee);var Pe=me.selectAll("rect.bandrect").data(function(ke){return ke.bands},s);Pe.each(function(){e.raiseToTop(this)}),Pe.attr("fill",function(ke){return ke.color});var Ue=Pe.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(ke){return ke.color}).attr("fill-opacity",0);Pe.attr("fill",function(ke){return ke.color}).attr("width",function(ke){return ke.width}).attr("height",function(ke){return ke.height}).attr("y",function(ke){return ke.y}).attr("cursor",function(ke){return ke.parcatsViewModel.arrangement==="fixed"?"default":ke.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),b(Ue),Pe.exit().remove(),Ee.append("text").attr("class","catlabel").attr("pointer-events","none");var we=$._fullLayout.paper_bgcolor;me.select("text.catlabel").attr("text-anchor",function(ke){return i(ke)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",t.makeTextShadow(we)).style("fill","rgb(0, 0, 0)").attr("x",function(ke){return i(ke)?ke.width+5:-5}).attr("y",function(ke){return ke.height/2}).text(function(ke){return ke.model.categoryLabel}).each(function(ke){n.font(A.select(this),ke.parcatsViewModel.categorylabelfont),t.convertToTspans(A.select(this),$)}),Ee.append("text").attr("class","dimlabel"),me.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(ke){return ke.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(ke){return ke.width/2}).attr("y",-5).text(function(ke,Xe){return Xe===0?ke.parcatsViewModel.model.dimensions[ke.model.dimensionInd].dimensionLabel:null}).each(function(ke){n.font(A.select(this),ke.parcatsViewModel.labelfont)}),me.selectAll("rect.bandrect").on("mouseover",R).on("mouseout",O),me.exit().remove(),ge.call(A.behavior.drag().origin(function(ke){return{x:ke.x,y:0}}).on("dragstart",F).on("drag",N).on("dragend",G)),ae.each(function(ke){ke.traceSelection=A.select(this),ke.pathSelection=A.select(this).selectAll("g.paths").selectAll("path.path"),ke.dimensionSelection=A.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),ae.exit().remove()}ee.exports=function(U,$,ne,X){h(ne,U,X,$)};function s(U){return U.key}function i(U){var $=U.parcatsViewModel.dimensions.length,ne=U.parcatsViewModel.dimensions[$-1].model.dimensionInd;return U.model.dimensionInd===ne}function x(U,$){return U.model.rawColor>$.model.rawColor?1:U.model.rawColor<$.model.rawColor?-1:0}function p(U){if(!U.parcatsViewModel.dragDimension&&U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),l(A.select(this));var $=f(U),ne=d(U);if(U.parcatsViewModel.graphDiv.emit("plotly_hover",{points:$,event:A.event,constraints:ne}),U.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var X=A.mouse(this)[0],Q=U.parcatsViewModel.graphDiv,ie=U.parcatsViewModel.trace,se=Q._fullLayout,ae=se._paperdiv.node().getBoundingClientRect(),oe=U.parcatsViewModel.graphDiv.getBoundingClientRect(),be,ce,de;for(de=0;de<U.leftXs.length-1;de++)if(U.leftXs[de]+U.dimWidths[de]-2<=X&&X<=U.leftXs[de+1]+2){var ye=U.parcatsViewModel.dimensions[de],ge=U.parcatsViewModel.dimensions[de+1];be=(ye.x+ye.width+ge.x)/2,ce=(U.topYs[de]+U.topYs[de+1]+U.height)/2;break}var me=U.parcatsViewModel.x+be,Ee=U.parcatsViewModel.y+ce,Pe=r.mostReadable(U.model.color,["black","white"]),Ue=U.model.count,we=Ue/U.parcatsViewModel.model.count,ke={countLabel:Ue,probabilityLabel:we.toFixed(3)},Xe=[];U.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Xe.push(["Count:",ke.countLabel].join(" ")),U.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Xe.push(["P:",ke.probabilityLabel].join(" "));var Ve=Xe.join("<br>"),Ie=A.mouse(Q)[0];M.loneHover({trace:ie,x:me-ae.left+oe.left,y:Ee-ae.top+oe.top,text:Ve,color:U.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:Pe,idealAlign:Ie<me?"right":"left",hovertemplate:(ie.line||{}).hovertemplate,hovertemplateLabels:ke,eventData:[{data:ie._input,fullData:ie,count:Ue,probability:we}]},{container:se._hoverlayer.node(),outerContainer:se._paper.node(),gd:Q})}}}function v(U){if(!U.parcatsViewModel.dragDimension&&(m(A.select(this)),M.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),U.parcatsViewModel.pathSelection.sort(x),U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var $=f(U),ne=d(U);U.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:$,event:A.event,constraints:ne})}}function f(U){for(var $=[],ne=K(U.parcatsViewModel),X=0;X<U.model.valueInds.length;X++){var Q=U.model.valueInds[X];$.push({curveNumber:ne,pointNumber:Q})}return $}function d(U){for(var $={},ne=U.parcatsViewModel.model.dimensions,X=0;X<ne.length;X++){var Q=ne[X],ie=Q.categories[U.model.categoryInds[X]];$[Q.containerInd]=ie.categoryValue}return U.model.rawColor!==void 0&&($.color=U.model.rawColor),$}function o(U){if(U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var $=f(U),ne=d(U);U.parcatsViewModel.graphDiv.emit("plotly_click",{points:$,event:A.event,constraints:ne})}}function m(U){U.attr("fill",function($){return $.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function l(U){U.attr("fill-opacity",.8).attr("stroke",function($){return r.mostReadable($.model.color,["black","white"])}).attr("stroke-width",.3)}function w(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function _(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function c(U){U.attr("stroke","black").attr("stroke-width",1.5)}function b(U){U.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function u(U){var $=U.parcatsViewModel.pathSelection,ne=U.categoryViewModel.model.dimensionInd,X=U.categoryViewModel.model.categoryInd;return $.filter(function(Q){return Q.model.categoryInds[ne]===X&&Q.model.color===U.color})}function L(U){var $=A.select(U.parentNode).selectAll("rect.bandrect");$.each(function(ne){var X=u(ne);l(X),X.each(function(){e.raiseToTop(this)})}),w(A.select(U.parentNode))}function T(U){var $=A.select(U).datum(),ne=u($);l(ne),ne.each(function(){e.raiseToTop(this)}),A.select(U.parentNode).selectAll("rect.bandrect").filter(function(X){return X.color===$.color}).each(function(){e.raiseToTop(this),c(A.select(this))})}function k(U,$,ne){var X=A.select(U).datum(),Q=X.categoryViewModel.model,ie=X.parcatsViewModel.graphDiv,se=A.select(U.parentNode).selectAll("rect.bandrect"),ae=[];se.each(function(be){var ce=u(be);ce.each(function(de){Array.prototype.push.apply(ae,f(de))})});var oe={};oe[Q.dimensionInd]=Q.categoryValue,ie.emit($,{points:ae,event:ne,constraints:oe})}function P(U,$,ne){var X=A.select(U).datum(),Q=X.categoryViewModel.model,ie=X.parcatsViewModel.graphDiv,se=u(X),ae=[];se.each(function(be){Array.prototype.push.apply(ae,f(be))});var oe={};oe[Q.dimensionInd]=Q.categoryValue,X.rawColor!==void 0&&(oe.color=X.rawColor),ie.emit($,{points:ae,event:ne,constraints:oe})}function z(U,$,ne){U._fullLayout._calcInverseTransform(U);var X=U._fullLayout._invScaleX,Q=U._fullLayout._invScaleY,ie=A.select(ne.parentNode).select("rect.catrect"),se=ie.node().getBoundingClientRect(),ae=ie.datum(),oe=ae.parcatsViewModel,be=oe.model.dimensions[ae.model.dimensionInd],ce=oe.trace,de=se.top+se.height/2,ye,ge;oe.dimensions.length>1&&be.displayInd===oe.dimensions.length-1?(ye=se.left,ge="left"):(ye=se.left+se.width,ge="right");var me=ae.model.count,Ee=ae.model.categoryLabel,Pe=me/ae.parcatsViewModel.model.count,Ue={countLabel:me,categoryLabel:Ee,probabilityLabel:Pe.toFixed(3)},we=[];ae.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&we.push(["Count:",Ue.countLabel].join(" ")),ae.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&we.push(["P("+Ue.categoryLabel+"):",Ue.probabilityLabel].join(" "));var ke=we.join("<br>");return{trace:ce,x:X*(ye-$.left),y:Q*(de-$.top),text:ke,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:ge,hovertemplate:ce.hovertemplate,hovertemplateLabels:Ue,eventData:[{data:ce._input,fullData:ce,count:me,category:Ee,probability:Pe}]}}function I(U,$,ne){var X=[];return A.select(ne.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var Q=this;X.push(z(U,$,Q))}),X}function D(U,$,ne){U._fullLayout._calcInverseTransform(U);var X=U._fullLayout._invScaleX,Q=U._fullLayout._invScaleY,ie=ne.getBoundingClientRect(),se=A.select(ne).datum(),ae=se.categoryViewModel,oe=ae.parcatsViewModel,be=oe.model.dimensions[ae.model.dimensionInd],ce=oe.trace,de=ie.y+ie.height/2,ye,ge;oe.dimensions.length>1&&be.displayInd===oe.dimensions.length-1?(ye=ie.left,ge="left"):(ye=ie.left+ie.width,ge="right");var me=ae.model.categoryLabel,Ee=se.parcatsViewModel.model.count,Pe=0;se.categoryViewModel.bands.forEach(function(Dt){Dt.color===se.color&&(Pe+=Dt.count)});var Ue=ae.model.count,we=0;oe.pathSelection.each(function(Dt){Dt.model.color===se.color&&(we+=Dt.model.count)});var ke=Pe/Ee,Xe=Pe/we,Ve=Pe/Ue,Ie={countLabel:Ee,categoryLabel:me,probabilityLabel:ke.toFixed(3)},De=[];ae.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&De.push(["Count:",Ie.countLabel].join(" ")),ae.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(De.push("P(color  "+me+"): "+Ie.probabilityLabel),De.push("P("+me+" | color): "+Xe.toFixed(3)),De.push("P(color | "+me+"): "+Ve.toFixed(3)));var Ye=De.join("<br>"),vt=r.mostReadable(se.color,["black","white"]);return{trace:ce,x:X*(ye-$.left),y:Q*(de-$.top),text:Ye,color:se.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:vt,fontSize:10,idealAlign:ge,hovertemplate:ce.hovertemplate,hovertemplateLabels:Ie,eventData:[{data:ce._input,fullData:ce,category:me,count:Ee,probability:ke,categorycount:Ue,colorcount:we,bandcolorcount:Pe}]}}function R(U){if(!U.parcatsViewModel.dragDimension&&U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var $=A.mouse(this)[1];if($<-1)return;var ne=U.parcatsViewModel.graphDiv,X=ne._fullLayout,Q=X._paperdiv.node().getBoundingClientRect(),ie=U.parcatsViewModel.hoveron,se=this;if(ie==="color"?(T(se),P(se,"plotly_hover",A.event)):(L(se),k(se,"plotly_hover",A.event)),U.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ae;ie==="category"?ae=z(ne,Q,se):ie==="color"?ae=D(ne,Q,se):ie==="dimension"&&(ae=I(ne,Q,se)),ae&&M.loneHover(ae,{container:X._hoverlayer.node(),outerContainer:X._paper.node(),gd:ne})}}}function O(U){var $=U.parcatsViewModel;if(!$.dragDimension&&(m($.pathSelection),_($.dimensionSelection.selectAll("g.category")),b($.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),M.loneUnhover($.graphDiv._fullLayout._hoverlayer.node()),$.pathSelection.sort(x),$.hoverinfoItems.indexOf("skip")===-1)){var ne=U.parcatsViewModel.hoveron,X=this;ne==="color"?P(X,"plotly_unhover",A.event):k(X,"plotly_unhover",A.event)}}function F(U){U.parcatsViewModel.arrangement!=="fixed"&&(U.dragDimensionDisplayInd=U.model.displayInd,U.initialDragDimensionDisplayInds=U.parcatsViewModel.model.dimensions.map(function($){return $.displayInd}),U.dragHasMoved=!1,U.dragCategoryDisplayInd=null,A.select(this).selectAll("g.category").select("rect.catrect").each(function($){var ne=A.mouse(this)[0],X=A.mouse(this)[1];-2<=ne&&ne<=$.width+2&&-2<=X&&X<=$.height+2&&(U.dragCategoryDisplayInd=$.model.displayInd,U.initialDragCategoryDisplayInds=U.model.categories.map(function(Q){return Q.displayInd}),$.model.dragY=$.y,e.raiseToTop(this.parentNode),A.select(this.parentNode).selectAll("rect.bandrect").each(function(Q){Q.y<X&&X<=Q.y+Q.height&&(U.potentialClickBand=this)}))}),U.parcatsViewModel.dragDimension=U,M.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function N(U){if(U.parcatsViewModel.arrangement!=="fixed"&&(U.dragHasMoved=!0,U.dragDimensionDisplayInd!==null)){var $=U.dragDimensionDisplayInd,ne=$-1,X=$+1,Q=U.parcatsViewModel.dimensions[$];if(U.dragCategoryDisplayInd!==null){var ie=Q.categories[U.dragCategoryDisplayInd];ie.model.dragY+=A.event.dy;var se=ie.model.dragY,ae=ie.model.displayInd,oe=Q.categories,be=oe[ae-1],ce=oe[ae+1];be!==void 0&&se<be.y+be.height/2&&(ie.model.displayInd=be.model.displayInd,be.model.displayInd=ae),ce!==void 0&&se+ie.height>ce.y+ce.height/2&&(ie.model.displayInd=ce.model.displayInd,ce.model.displayInd=ae),U.dragCategoryDisplayInd=ie.model.displayInd}if(U.dragCategoryDisplayInd===null||U.parcatsViewModel.arrangement==="freeform"){Q.model.dragX=A.event.x;var de=U.parcatsViewModel.dimensions[ne],ye=U.parcatsViewModel.dimensions[X];de!==void 0&&Q.model.dragX<de.x+de.width&&(Q.model.displayInd=de.model.displayInd,de.model.displayInd=$),ye!==void 0&&Q.model.dragX+Q.width>ye.x&&(Q.model.displayInd=ye.model.displayInd,ye.model.displayInd=U.dragDimensionDisplayInd),U.dragDimensionDisplayInd=Q.model.displayInd}q(U.parcatsViewModel),j(U.parcatsViewModel),Y(U.parcatsViewModel),W(U.parcatsViewModel)}}function G(U){if(U.parcatsViewModel.arrangement!=="fixed"&&U.dragDimensionDisplayInd!==null){A.select(this).selectAll("text").attr("font-weight","normal");var $={},ne=K(U.parcatsViewModel),X=U.parcatsViewModel.model.dimensions.map(function(ye){return ye.displayInd}),Q=U.initialDragDimensionDisplayInds.some(function(ye,ge){return ye!==X[ge]});Q&&X.forEach(function(ye,ge){var me=U.parcatsViewModel.model.dimensions[ge].containerInd;$["dimensions["+me+"].displayindex"]=ye});var ie=!1;if(U.dragCategoryDisplayInd!==null){var se=U.model.categories.map(function(ye){return ye.displayInd});if(ie=U.initialDragCategoryDisplayInds.some(function(ye,ge){return ye!==se[ge]}),ie){var ae=U.model.categories.slice().sort(function(ye,ge){return ye.displayInd-ge.displayInd}),oe=ae.map(function(ye){return ye.categoryValue}),be=ae.map(function(ye){return ye.categoryLabel});$["dimensions["+U.model.containerInd+"].categoryarray"]=[oe],$["dimensions["+U.model.containerInd+"].ticktext"]=[be],$["dimensions["+U.model.containerInd+"].categoryorder"]="array"}}if(U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!U.dragHasMoved&&U.potentialClickBand&&(U.parcatsViewModel.hoveron==="color"?P(U.potentialClickBand,"plotly_click",A.event.sourceEvent):k(U.potentialClickBand,"plotly_click",A.event.sourceEvent)),U.model.dragX=null,U.dragCategoryDisplayInd!==null){var ce=U.parcatsViewModel.dimensions[U.dragDimensionDisplayInd].categories[U.dragCategoryDisplayInd];ce.model.dragY=null,U.dragCategoryDisplayInd=null}U.dragDimensionDisplayInd=null,U.parcatsViewModel.dragDimension=null,U.dragHasMoved=null,U.potentialClickBand=null,q(U.parcatsViewModel),j(U.parcatsViewModel);var de=A.transition().duration(300).ease("cubic-in-out");de.each(function(){Y(U.parcatsViewModel,!0),W(U.parcatsViewModel,!0)}).each("end",function(){(Q||ie)&&S.restyle(U.parcatsViewModel.graphDiv,$,[ne])})}}function K(U){for(var $,ne=U.graphDiv._fullData,X=0;X<ne.length;X++)if(U.key===ne[X].uid){$=X;break}return $}function W(U,$){$===void 0&&($=!1);function ne(X){return $?X.transition():X}U.pathSelection.data(function(X){return X.paths},s),ne(U.pathSelection).attr("d",function(X){return X.svgD})}function Y(U,$){$===void 0&&($=!1);function ne(oe){return $?oe.transition():oe}U.dimensionSelection.data(function(oe){return oe.dimensions},s);var X=U.dimensionSelection.selectAll("g.category").data(function(oe){return oe.categories},s);ne(U.dimensionSelection).attr("transform",function(oe){return a(oe.x,0)}),ne(X).attr("transform",function(oe){return a(0,oe.y)});var Q=X.select(".dimlabel");Q.text(function(oe,be){return be===0?oe.parcatsViewModel.model.dimensions[oe.model.dimensionInd].dimensionLabel:null});var ie=X.select(".catlabel");ie.attr("text-anchor",function(oe){return i(oe)?"start":"end"}).attr("x",function(oe){return i(oe)?oe.width+5:-5}).each(function(oe){var be,ce;i(oe)?(be=oe.width+5,ce="start"):(be=-5,ce="end"),A.select(this).selectAll("tspan").attr("x",be).attr("text-anchor",ce)});var se=X.selectAll("rect.bandrect").data(function(oe){return oe.bands},s),ae=se.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(oe){return oe.color}).attr("fill-opacity",0);se.attr("fill",function(oe){return oe.color}).attr("width",function(oe){return oe.width}).attr("height",function(oe){return oe.height}).attr("y",function(oe){return oe.y}),b(ae),se.each(function(){e.raiseToTop(this)}),se.exit().remove()}function re(U,$,ne){var X=ne[0],Q=$.margin||{l:80,r:80,t:100,b:80},ie=X.trace,se=ie.domain,ae=$.width,oe=$.height,be=Math.floor(ae*(se.x[1]-se.x[0])),ce=Math.floor(oe*(se.y[1]-se.y[0])),de=se.x[0]*ae+Q.l,ye=$.height-se.y[1]*$.height+Q.t,ge=ie.line.shape,me;ie.hoverinfo==="all"?me=["count","probability"]:me=(ie.hoverinfo||"").split("+");var Ee={trace:ie,key:ie.uid,model:X,x:de,y:ye,width:be,height:ce,hoveron:ie.hoveron,hoverinfoItems:me,arrangement:ie.arrangement,bundlecolors:ie.bundlecolors,sortpaths:ie.sortpaths,labelfont:ie.labelfont,categorylabelfont:ie.tickfont,pathShape:ge,dragDimension:null,margin:Q,paths:[],dimensions:[],graphDiv:U,traceSelection:null,pathSelection:null,dimensionSelection:null};return X.dimensions&&(q(Ee),j(Ee)),Ee}function ue(U,$,ne,X,Q){var ie=[],se=[],ae,oe;for(oe=0;oe<ne.length-1;oe++)ae=g(ne[oe]+U[oe],U[oe+1]),ie.push(ae(Q)),se.push(ae(1-Q));var be="M "+U[0]+","+$[0];for(be+="l"+ne[0]+",0 ",oe=1;oe<ne.length;oe++)be+="C"+ie[oe-1]+","+$[oe-1]+" "+se[oe-1]+","+$[oe]+" "+U[oe]+","+$[oe],be+="l"+ne[oe]+",0 ";for(be+="l0,"+X+" ",be+="l -"+ne[ne.length-1]+",0 ",oe=ne.length-2;oe>=0;oe--)be+="C"+se[oe]+","+($[oe+1]+X)+" "+ie[oe]+","+($[oe]+X)+" "+(U[oe]+ne[oe])+","+($[oe]+X),be+="l-"+ne[oe]+",0 ";return be+="Z",be}function j(U){var $=U.dimensions,ne=U.model,X=$.map(function(Mt){return Mt.categories.map(function(Xt){return Xt.y})}),Q=U.model.dimensions.map(function(Mt){return Mt.categories.map(function(Xt){return Xt.displayInd})}),ie=U.model.dimensions.map(function(Mt){return Mt.displayInd}),se=U.dimensions.map(function(Mt){return Mt.model.dimensionInd}),ae=$.map(function(Mt){return Mt.x}),oe=$.map(function(Mt){return Mt.width}),be=[];for(var ce in ne.paths)ne.paths.hasOwnProperty(ce)&&be.push(ne.paths[ce]);function de(Mt){var Xt=Mt.categoryInds.map(function(At,Ge){return Q[Ge][At]}),It=se.map(function(At){return Xt[At]});return It}be.sort(function(Mt,Xt){var It=de(Mt),At=de(Xt);return U.sortpaths==="backward"&&(It.reverse(),At.reverse()),It.push(Mt.valueInds[0]),At.push(Xt.valueInds[0]),U.bundlecolors&&(It.unshift(Mt.rawColor),At.unshift(Xt.rawColor)),It<At?-1:It>At?1:0});for(var ye=new Array(be.length),ge=$[0].model.count,me=$[0].categories.map(function(Mt){return Mt.height}).reduce(function(Mt,Xt){return Mt+Xt}),Ee=0;Ee<be.length;Ee++){var Pe=be[Ee],Ue;ge>0?Ue=me*(Pe.count/ge):Ue=0;for(var we=new Array(X.length),ke=0;ke<Pe.categoryInds.length;ke++){var Xe=Pe.categoryInds[ke],Ve=Q[ke][Xe],Ie=ie[ke];we[Ie]=X[Ie][Ve],X[Ie][Ve]+=Ue;var De=U.dimensions[Ie].categories[Ve],Ye=De.bands.length,vt=De.bands[Ye-1];if(vt===void 0||Pe.rawColor!==vt.rawColor){var Dt=vt===void 0?0:vt.y+vt.height;De.bands.push({key:Dt,color:Pe.color,rawColor:Pe.rawColor,height:Ue,width:De.width,count:Pe.count,y:Dt,categoryViewModel:De,parcatsViewModel:U})}else{var Kt=De.bands[Ye-1];Kt.height+=Ue,Kt.count+=Pe.count}}var Ft;U.pathShape==="hspline"?Ft=ue(ae,we,oe,Ue,.5):Ft=ue(ae,we,oe,Ue,0),ye[Ee]={key:Pe.valueInds[0],model:Pe,height:Ue,leftXs:ae,topYs:we,dimWidths:oe,svgD:Ft,parcatsViewModel:U}}U.paths=ye}function q(U){var $=U.model.dimensions.map(function(se){return{displayInd:se.displayInd,dimensionInd:se.dimensionInd}});$.sort(function(se,ae){return se.displayInd-ae.displayInd});var ne=[];for(var X in $){var Q=$[X].dimensionInd,ie=U.model.dimensions[Q];ne.push(H(U,ie))}U.dimensions=ne}function H(U,$){var ne=40,X=16,Q=U.model.dimensions.length,ie=$.displayInd,se,ae,oe;Q>1?se=(U.width-2*ne-X)/(Q-1):se=0,ae=ne,oe=ae+se*ie;var be=[],ce=U.model.maxCats,de=$.categories.length,ye=8,ge=$.count,me=U.height-ye*(ce-1),Ee,Pe,Ue,we,ke,Xe=(ce-de)*ye/2,Ve=$.categories.map(function(Ie){return{displayInd:Ie.displayInd,categoryInd:Ie.categoryInd}});for(Ve.sort(function(Ie,De){return Ie.displayInd-De.displayInd}),ke=0;ke<de;ke++)we=Ve[ke].categoryInd,Pe=$.categories[we],ge>0?Ee=Pe.count/ge*me:Ee=0,Ue={key:Pe.valueInds[0],model:Pe,width:X,height:Ee,y:Pe.dragY!==null?Pe.dragY:Xe,bands:[],parcatsViewModel:U},Xe=Xe+Ee+ye,be.push(Ue);return{key:$.dimensionInd,x:$.dragX!==null?$.dragX:oe,y:0,width:X,model:$,categories:be,parcatsViewModel:U,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(y,ee,te){var A=y("./parcats");ee.exports=function(S,M,e,a){var n=S._fullLayout,r=n._paper,t=n._size;A(S,r,M,{width:t.w,height:t.h,margin:{t:t.t,r:t.r,b:t.b,l:t.l}},e,a)}},{"./parcats":895}],897:[function(y,ee,te){var A=y("../../components/colorscale/attributes"),g=y("../../plots/cartesian/layout_attributes"),S=y("../../plots/font_attributes"),M=y("../../plots/domain").attributes,e=y("../../lib/extend").extendFlat,a=y("../../plot_api/plot_template").templatedArray;ee.exports={domain:M({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:S({editType:"plot"}),tickfont:S({editType:"plot"}),rangefont:S({editType:"plot"}),dimensions:a("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},g.tickvals,{editType:"plot"}),ticktext:e({},g.ticktext,{editType:"plot"}),tickformat:e({},g.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},A("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(y,ee,te){var A=y("./constants"),g=y("@plotly/d3"),S=y("../../lib/gup").keyFun,M=y("../../lib/gup").repeat,e=y("../../lib").sorterAsc,a=y("../../lib").strTranslate,n=A.bar.snapRatio;function r(G,K){return G*(1-n)+K*n}var t=A.bar.snapClose;function h(G,K){return G*(1-t)+K*t}function s(G,K,W,Y){if(i(W,Y))return W;var re=G?-1:1,ue=0,j=K.length-1;if(re<0){var q=ue;ue=j,j=q}for(var H=K[ue],U=H,$=ue;re*$<re*j;$+=re){var ne=$+re,X=K[ne];if(re*W<re*h(H,X))return r(H,U);if(re*W<re*X||ne===j)return r(X,H);U=H,H=X}}function i(G,K){for(var W=0;W<K.length;W++)if(G>=K[W][0]&&G<=K[W][1])return!0;return!1}function x(G){G.attr("x",-A.bar.captureWidth/2).attr("width",A.bar.captureWidth)}function p(G){G.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function v(G){if(!G.brush.filterSpecified)return"0,"+G.height;for(var K=f(G.brush.filter.getConsolidated(),G.height),W=[0],Y,re,ue,j=K.length?K[0][0]:null,q=0;q<K.length;q++)Y=K[q],re=Y[1]-Y[0],W.push(j),W.push(re),ue=q+1,ue<K.length&&(j=K[ue][0]-Y[1]);return W.push(G.height),W}function f(G,K){return G.map(function(W){return W.map(function(Y){return Math.max(0,Y*K)}).sort(e)})}function d(G,K){var W=A.bar.handleHeight;if(!(K>G[1]+W||K<G[0]-W))return K>=.9*G[1]+.1*G[0]?"n":K<=.9*G[0]+.1*G[1]?"s":"ns"}function o(){g.select(document.body).style("cursor",null)}function m(G){G.attr("stroke-dasharray",v)}function l(G,K){var W=g.select(G).selectAll(".highlight, .highlight-shadow"),Y=K?W.transition().duration(A.bar.snapDuration).each("end",K):W;m(Y)}function w(G,K){var W=G.brush,Y=W.filterSpecified,re=NaN,ue={},j;if(Y){var q=G.height,H=W.filter.getConsolidated(),U=f(H,q),$=NaN,ne=NaN,X=NaN;for(j=0;j<=U.length;j++){var Q=U[j];if(Q&&Q[0]<=K&&K<=Q[1]){$=j;break}else if(ne=j?j-1:NaN,Q&&Q[0]>K){X=j;break}}if(re=$,isNaN(re)&&(isNaN(ne)||isNaN(X)?re=isNaN(ne)?X:ne:re=K-U[ne][1]<U[X][0]-K?ne:X),!isNaN(re)){var ie=U[re],se=d(ie,K);se&&(ue.interval=H[re],ue.intervalPix=ie,ue.region=se)}}if(G.ordinal&&!ue.region){var ae=G.unitTickvals,oe=G.unitToPaddedPx.invert(K);for(j=0;j<ae.length;j++){var be=[ae[Math.max(j-1,0)]*.25+ae[j]*.75,ae[Math.min(j+1,ae.length-1)]*.25+ae[j]*.75];if(oe>=be[0]&&oe<=be[1]){ue.clickableOrdinalRange=be;break}}}return ue}function _(G,K){g.event.sourceEvent.stopPropagation();var W=K.height-g.mouse(G)[1]-2*A.verticalPadding,Y=K.unitToPaddedPx.invert(W),re=K.brush,ue=w(K,W),j=ue.interval,q=re.svgBrush;if(q.wasDragged=!1,q.grabbingBar=ue.region==="ns",q.grabbingBar){var H=j.map(K.unitToPaddedPx);q.grabPoint=W-H[0]-A.verticalPadding,q.barLength=H[1]-H[0]}q.clickableOrdinalRange=ue.clickableOrdinalRange,q.stayingIntervals=K.multiselect&&re.filterSpecified?re.filter.getConsolidated():[],j&&(q.stayingIntervals=q.stayingIntervals.filter(function(U){return U[0]!==j[0]&&U[1]!==j[1]})),q.startExtent=ue.region?j[ue.region==="s"?1:0]:Y,K.parent.inBrushDrag=!0,q.brushStartCallback()}function c(G,K){g.event.sourceEvent.stopPropagation();var W=K.height-g.mouse(G)[1]-2*A.verticalPadding,Y=K.brush.svgBrush;Y.wasDragged=!0,Y._dragging=!0,Y.grabbingBar?Y.newExtent=[W-Y.grabPoint,W+Y.barLength-Y.grabPoint].map(K.unitToPaddedPx.invert):Y.newExtent=[Y.startExtent,K.unitToPaddedPx.invert(W)].sort(e),K.brush.filterSpecified=!0,Y.extent=Y.stayingIntervals.concat([Y.newExtent]),Y.brushCallback(K),l(G.parentNode)}function b(G,K){var W=K.brush,Y=W.filter,re=W.svgBrush;re._dragging||(u(G,K),c(G,K),K.brush.svgBrush.wasDragged=!1),re._dragging=!1;var ue=g.event;ue.sourceEvent.stopPropagation();var j=re.grabbingBar;if(re.grabbingBar=!1,re.grabLocation=void 0,K.parent.inBrushDrag=!1,o(),!re.wasDragged){re.wasDragged=void 0,re.clickableOrdinalRange?W.filterSpecified&&K.multiselect?re.extent.push(re.clickableOrdinalRange):(re.extent=[re.clickableOrdinalRange],W.filterSpecified=!0):j?(re.extent=re.stayingIntervals,re.extent.length===0&&I(W)):I(W),re.brushCallback(K),l(G.parentNode),re.brushEndCallback(W.filterSpecified?Y.getConsolidated():[]);return}var q=function(){Y.set(Y.getConsolidated())};if(K.ordinal){var H=K.unitTickvals;H[H.length-1]<H[0]&&H.reverse(),re.newExtent=[s(0,H,re.newExtent[0],re.stayingIntervals),s(1,H,re.newExtent[1],re.stayingIntervals)];var U=re.newExtent[1]>re.newExtent[0];re.extent=re.stayingIntervals.concat(U?[re.newExtent]:[]),re.extent.length||I(W),re.brushCallback(K),U?l(G.parentNode,q):(q(),l(G.parentNode))}else q();re.brushEndCallback(W.filterSpecified?Y.getConsolidated():[])}function u(G,K){var W=K.height-g.mouse(G)[1]-2*A.verticalPadding,Y=w(K,W),re="crosshair";Y.clickableOrdinalRange?re="pointer":Y.region&&(re=Y.region+"-resize"),g.select(document.body).style("cursor",re)}function L(G){G.on("mousemove",function(K){g.event.preventDefault(),K.parent.inBrushDrag||u(this,K)}).on("mouseleave",function(K){K.parent.inBrushDrag||o()}).call(g.behavior.drag().on("dragstart",function(K){_(this,K)}).on("drag",function(K){c(this,K)}).on("dragend",function(K){b(this,K)}))}function T(G,K){return G[0]-K[0]}function k(G,K,W){var Y=W._context.staticPlot,re=G.selectAll(".background").data(M);re.enter().append("rect").classed("background",!0).call(x).call(p).style("pointer-events",Y?"none":"auto").attr("transform",a(0,A.verticalPadding)),re.call(L).attr("height",function(q){return q.height-A.verticalPadding});var ue=G.selectAll(".highlight-shadow").data(M);ue.enter().append("line").classed("highlight-shadow",!0).attr("x",-A.bar.width/2).attr("stroke-width",A.bar.width+A.bar.strokeWidth).attr("stroke",K).attr("opacity",A.bar.strokeOpacity).attr("stroke-linecap","butt"),ue.attr("y1",function(q){return q.height}).call(m);var j=G.selectAll(".highlight").data(M);j.enter().append("line").classed("highlight",!0).attr("x",-A.bar.width/2).attr("stroke-width",A.bar.width-A.bar.strokeWidth).attr("stroke",A.bar.fillColor).attr("opacity",A.bar.fillOpacity).attr("stroke-linecap","butt"),j.attr("y1",function(q){return q.height}).call(m)}function P(G,K,W){var Y=G.selectAll("."+A.cn.axisBrush).data(M,S);Y.enter().append("g").classed(A.cn.axisBrush,!0),k(Y,K,W)}function z(G){return G.svgBrush.extent.map(function(K){return K.slice()})}function I(G){G.filterSpecified=!1,G.svgBrush.extent=[[-1/0,1/0]]}function D(G){return function(W){var Y=W.brush,re=z(Y),ue=re.slice();Y.filter.set(ue),G()}}function R(G){for(var K=G.slice(),W=[],Y,re=K.shift();re;){for(Y=re.slice();(re=K.shift())&&re[0]<=Y[1];)Y[1]=Math.max(Y[1],re[1]);W.push(Y)}return W.length===1&&W[0][0]>W[0][1]&&(W=[]),W}function O(){var G=[],K,W;return{set:function(Y){G=Y.map(function(re){return re.slice().sort(e)}).sort(T),G.length===1&&G[0][0]===-1/0&&G[0][1]===1/0&&(G=[[0,-1]]),K=R(G),W=G.reduce(function(re,ue){return[Math.min(re[0],ue[0]),Math.max(re[1],ue[1])]},[1/0,-1/0])},get:function(){return G.slice()},getConsolidated:function(){return K},getBounds:function(){return W}}}function F(G,K,W,Y,re,ue){var j=O();return j.set(W),{filter:j,filterSpecified:K,svgBrush:{extent:[],brushStartCallback:Y,brushCallback:D(re),brushEndCallback:ue}}}function N(G,K){if(Array.isArray(G[0])?(G=G.map(function(Y){return Y.sort(e)}),K.multiselect?G=R(G.sort(T)):G=[G[0]]):G=[G.sort(e)],K.tickvals){var W=K.tickvals.slice().sort(e);if(G=G.map(function(Y){var re=[s(0,W,Y[0],[]),s(1,W,Y[1],[])];if(re[1]>re[0])return re}).filter(function(Y){return Y}),!G.length)return}return G.length>1?G:G[0]}ee.exports={makeBrush:F,ensureAxisBrush:P,cleanRanges:N}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:y("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../plots/get_data").getModuleCalcData,S=y("./plot"),M=y("../../constants/xmlns_namespaces");te.name="parcoords",te.plot=function(e){var a=g(e.calcdata,"parcoords")[0];a.length&&S(e,a)},te.clean=function(e,a,n,r){var t=r._has&&r._has("parcoords"),h=a._has&&a._has("parcoords");t&&!h&&(r._paperdiv.selectAll(".parcoords").remove(),r._glimages.selectAll("*").remove())},te.toSVG=function(e){var a=e._fullLayout._glimages,n=A.select(e).selectAll(".svg-container"),r=n.filter(function(h,s){return s===n.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function t(){var h=this,s=h.toDataURL("image/png"),i=a.append("svg:image");i.attr({xmlns:M.svg,"xlink:href":s,preserveAspectRatio:"none",x:0,y:0,width:h.style.width,height:h.style.height})}r.each(t),window.setTimeout(function(){A.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(y,ee,te){var A=y("../../lib").isArrayOrTypedArray,g=y("../../components/colorscale"),S=y("../../lib/gup").wrap;ee.exports=function(a,n){var r,t;return g.hasColorscale(n,"line")&&A(n.line.color)?(r=n.line.color,t=g.extractOpts(n.line).colorscale,g.calc(a,n,{vals:r,containerStr:"line",cLetter:"c"})):(r=M(n._length),t=[[0,n.line.color],[1,n.line.color]]),S({lineColor:r,cscale:t})};function M(e){for(var a=new Array(e),n=0;n<e;n++)a[n]=.5;return a}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(y,ee,te){ee.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/colorscale/helpers").hasColorscale,S=y("../../components/colorscale/defaults"),M=y("../../plots/domain").defaults,e=y("../../plots/array_container_defaults"),a=y("../../plots/cartesian/axes"),n=y("./attributes"),r=y("./axisbrush"),t=y("./constants").maxDimensionCount,h=y("./merge_length");function s(x,p,v,f,d){var o=d("line.color",v);if(g(x,"line")&&A.isArrayOrTypedArray(o)){if(o.length)return d("line.colorscale"),S(x,p,f,d,{prefix:"line.",cLetter:"c"}),o.length;p.line.color=v}return 1/0}function i(x,p,v,f){function d(_,c){return A.coerce(x,p,n.dimensions,_,c)}var o=d("values"),m=d("visible");if(o&&o.length||(m=p.visible=!1),m){d("label"),d("tickvals"),d("ticktext"),d("tickformat");var l=d("range");p._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:l},a.setConvert(p._ax,f.layout),d("multiselect");var w=d("constraintrange");w&&(p.constraintrange=r.cleanRanges(w,p))}}ee.exports=function(p,v,f,d){function o(c,b){return A.coerce(p,v,n,c,b)}var m=p.dimensions;Array.isArray(m)&&m.length>t&&(A.log("parcoords traces support up to "+t+" dimensions at the moment"),m.splice(t));var l=e(p,v,{name:"dimensions",layout:d,handleItemDefaults:i}),w=s(p,v,f,d,o);M(v,d,o),(!Array.isArray(l)||!l.length)&&(v.visible=!1),h(v,l,"values",w);var _={family:d.font.family,size:Math.round(d.font.size/1.2),color:d.font.color};A.coerceFont(o,"labelfont",_),A.coerceFont(o,"tickfont",_),A.coerceFont(o,"rangefont",_),o("labelangle"),o("labelside"),o("unselected.line.color"),o("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(y,ee,te){var A=y("../../lib").isTypedArray;te.convertTypedArray=function(g){return A(g)?Array.prototype.slice.call(g):g},te.isOrdinal=function(g){return!!g.tickvals},te.isVisible=function(g){return g.visible||!("visible"in g)}},{"../../lib":515}],905:[function(y,ee,te){var A=y("./base_index");A.plot=y("./plot"),ee.exports=A},{"./base_index":899,"./plot":909}],906:[function(y,ee,te){var A=y("glslify"),g=A([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),S=A([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),M=y("./constants").maxDimensionCount,e=y("../../lib"),a=1e-6,n=2048,r=new Uint8Array(4),t=new Uint8Array(4),h={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function s(u){u.read({x:0,y:0,width:1,height:1,data:r})}function i(u,L,T,k,P){var z=u._gl;z.enable(z.SCISSOR_TEST),z.scissor(L,T,k,P),u.clear({color:[0,0,0,0],depth:1})}function x(u,L,T,k,P,z){var I=z.key;function D(R){var O=Math.min(k,P-R*k);R===0&&(window.cancelAnimationFrame(T.currentRafs[I]),delete T.currentRafs[I],i(u,z.scissorX,z.scissorY,z.scissorWidth,z.viewBoxSize[1])),!T.clearOnly&&(z.count=2*O,z.offset=2*R*k,L(z),R*k+O<P&&(T.currentRafs[I]=window.requestAnimationFrame(function(){D(R+1)})),T.drawCompleted=!1)}T.drawCompleted||(s(u),T.drawCompleted=!0),D(0)}function p(u){return Math.max(a,Math.min(1-a,u))}function v(u,L){for(var T=new Array(256),k=0;k<256;k++)T[k]=u(k/255).concat(L);return T}function f(u,L){return(u>>>8*L)%256/255}function d(u,L,T){for(var k=new Array(u*(M+4)),P=0,z=0;z<u;z++){for(var I=0;I<M;I++)k[P++]=I<L.length?L[I].paddedUnitValues[z]:.5;k[P++]=f(z,2),k[P++]=f(z,1),k[P++]=f(z,0),k[P++]=p(T[z])}return k}function o(u,L,T){for(var k=new Array(L*8),P=0,z=0;z<L;z++)for(var I=0;I<2;I++)for(var D=0;D<4;D++){var R=u*4+D,O=T[z*64+R];R===63&&I===0&&(O*=-1),k[P++]=O}return k}function m(u){var L="0"+u;return L.substr(L.length-2)}function l(u){return u<M?"p"+m(u+1)+"_"+m(u+4):"colors"}function w(u,L,T){for(var k=0;k<=M;k+=4)u[l(k)](o(k/4,L,T))}function _(u){for(var L={},T=0;T<=M;T+=4)L[l(T)]=u.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return L}function c(u,L,T,k,P,z,I,D,R,O,F,N,G,K){for(var W=[[],[]],Y=0;Y<64;Y++)W[0][Y]=Y===P?1:0,W[1][Y]=Y===z?1:0;I*=K,D*=K,R*=K,O*=K;var re=u.lines.canvasOverdrag*K,ue=u.domain,j=u.canvasWidth*K,q=u.canvasHeight*K,H=u.pad.l*K,U=u.pad.b*K,$=u.layoutHeight*K,ne=u.layoutWidth*K,X=u.deselectedLines.color,Q=u.deselectedLines.opacity,ie=e.extendFlat({key:F,resolution:[j,q],viewBoxPos:[I+re,D],viewBoxSize:[R,O],i0:P,i1:z,dim0A:W[0].slice(0,16),dim0B:W[0].slice(16,32),dim0C:W[0].slice(32,48),dim0D:W[0].slice(48,64),dim1A:W[1].slice(0,16),dim1B:W[1].slice(16,32),dim1C:W[1].slice(32,48),dim1D:W[1].slice(48,64),drwLayer:N,contextColor:[X[0]/255,X[1]/255,X[2]/255,Q!=="auto"?X[3]*Q:Math.max(1/255,Math.pow(1/u.lines.color.length,1/3))],scissorX:(k===L?0:I+re)+(H-re)+ne*ue.x[0],scissorWidth:(k===T?j-I+re:R+.5)+(k===L?I+re:0),scissorY:D+U+$*ue.y[0],scissorHeight:O,viewportX:H-re+ne*ue.x[0],viewportY:U+$*ue.y[0],viewportWidth:j,viewportHeight:q},G);return ie}function b(u){var L=n-1,T=Math.max(0,Math.floor(u[0]*L),0),k=Math.min(L,Math.ceil(u[1]*L),L);return[Math.min(T,k),Math.max(T,k)]}ee.exports=function(u,L){var T=L.context,k=L.pick,P=L.regl,z=P._gl,I=z.getParameter(z.ALIASED_LINE_WIDTH_RANGE),D=Math.max(I[0],Math.min(I[1],L.viewModel.plotGlPixelRatio)),R={currentRafs:{},drawCompleted:!0,clearOnly:!1},O,F,N,G,K=_(P),W,Y=P.texture(h),re=[];j(L);var ue=P({profile:!1,blend:{enable:T,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!T,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:P.prop("scissorX"),y:P.prop("scissorY"),width:P.prop("scissorWidth"),height:P.prop("scissorHeight")}},viewport:{x:P.prop("viewportX"),y:P.prop("viewportY"),width:P.prop("viewportWidth"),height:P.prop("viewportHeight")},dither:!1,vert:g,frag:S,primitive:"lines",lineWidth:D,attributes:K,uniforms:{resolution:P.prop("resolution"),viewBoxPos:P.prop("viewBoxPos"),viewBoxSize:P.prop("viewBoxSize"),dim0A:P.prop("dim0A"),dim1A:P.prop("dim1A"),dim0B:P.prop("dim0B"),dim1B:P.prop("dim1B"),dim0C:P.prop("dim0C"),dim1C:P.prop("dim1C"),dim0D:P.prop("dim0D"),dim1D:P.prop("dim1D"),loA:P.prop("loA"),hiA:P.prop("hiA"),loB:P.prop("loB"),hiB:P.prop("hiB"),loC:P.prop("loC"),hiC:P.prop("hiC"),loD:P.prop("loD"),hiD:P.prop("hiD"),palette:Y,contextColor:P.prop("contextColor"),maskTexture:P.prop("maskTexture"),drwLayer:P.prop("drwLayer"),maskHeight:P.prop("maskHeight")},offset:P.prop("offset"),count:P.prop("count")});function j(X){O=X.model,F=X.viewModel,N=F.dimensions.slice(),G=N[0]?N[0].values.length:0;var Q=O.lines,ie=k?Q.color.map(function(ae,oe){return oe/Q.color.length}):Q.color,se=d(G,N,ie);w(K,G,se),!T&&!k&&(Y=P.texture(e.extendFlat({data:v(O.unitToColor,255)},h)))}function q(X){var Q,ie,se,ae=[[],[]];for(se=0;se<64;se++){var oe=!X&&se<N.length?N[se].brush.filter.getBounds():[-1/0,1/0];ae[0][se]=oe[0],ae[1][se]=oe[1]}var be=n*8,ce=new Array(be);for(Q=0;Q<be;Q++)ce[Q]=255;if(!X)for(Q=0;Q<N.length;Q++){var de=Q%8,ye=(Q-de)/8,ge=Math.pow(2,de),me=N[Q],Ee=me.brush.filter.get();if(!(Ee.length<2)){var Pe=b(Ee[0])[1];for(ie=1;ie<Ee.length;ie++){var Ue=b(Ee[ie]);for(se=Pe+1;se<Ue[0];se++)ce[se*8+ye]&=~ge;Pe=Math.max(Pe,Ue[1])}}}var we={shape:[8,n],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:ce};return W?W(we):W=P.texture(we),{maskTexture:W,maskHeight:n,loA:ae[0].slice(0,16),loB:ae[0].slice(16,32),loC:ae[0].slice(32,48),loD:ae[0].slice(48,64),hiA:ae[1].slice(0,16),hiB:ae[1].slice(16,32),hiC:ae[1].slice(32,48),hiD:ae[1].slice(48,64)}}function H(X,Q,ie){var se=X.length,ae,oe,be,ce=1/0,de=-1/0;for(ae=0;ae<se;ae++)X[ae].dim0.canvasX<ce&&(ce=X[ae].dim0.canvasX,oe=ae),X[ae].dim1.canvasX>de&&(de=X[ae].dim1.canvasX,be=ae);se===0&&i(P,0,0,O.canvasWidth,O.canvasHeight);var ye=q(T);for(ae=0;ae<se;ae++){var ge=X[ae],me=ge.dim0.crossfilterDimensionIndex,Ee=ge.dim1.crossfilterDimensionIndex,Pe=ge.canvasX,Ue=ge.canvasY,we=Pe+ge.panelSizeX,ke=ge.plotGlPixelRatio;if(Q||!re[me]||re[me][0]!==Pe||re[me][1]!==we){re[me]=[Pe,we];var Xe=c(O,oe,be,ae,me,Ee,Pe,Ue,ge.panelSizeX,ge.panelSizeY,ge.dim0.crossfilterDimensionIndex,T?0:k?2:1,ye,ke);R.clearOnly=ie;var Ve=Q?O.lines.blockLineCount:G;x(P,ue,R,Ve,G,Xe)}}}function U(X,Q){return P.read({x:X,y:Q,width:1,height:1,data:t}),t}function $(X,Q,ie,se){var ae=new Uint8Array(4*ie*se);return P.read({x:X,y:Q,width:ie,height:se,data:ae}),ae}function ne(){u.style["pointer-events"]="none",Y.destroy(),W&&W.destroy();for(var X in K)K[X].destroy()}return{render:H,readPixel:U,readPixels:$,destroy:ne,update:j}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(y,ee,te){ee.exports=function(A,g,S,M){M||(M=1/0);var e,a;for(e=0;e<g.length;e++)a=g[e],a.visible&&(M=Math.min(M,a[S].length));for(M===1/0&&(M=0),A._length=M,e=0;e<g.length;e++)a=g[e],a.visible&&(a._length=M);return M}},{}],908:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=g.numberFormat,M=y("color-rgba"),e=y("../../plots/cartesian/axes"),a=g.strRotate,n=g.strTranslate,r=y("../../lib/svg_text_utils"),t=y("../../components/drawing"),h=y("../../components/colorscale"),s=y("../../lib/gup"),i=s.keyFun,x=s.repeat,p=s.unwrap,v=y("./helpers"),f=y("./constants"),d=y("./axisbrush"),o=y("./lines");function m(W,Y,re){return g.aggNums(W,null,Y,re)}function l(W,Y){return _(m(Math.min,W,Y),m(Math.max,W,Y))}function w(W){var Y=W.range;return Y?_(Y[0],Y[1]):l(W.values,W._length)}function _(W,Y){return(isNaN(W)||!isFinite(W))&&(W=0),(isNaN(Y)||!isFinite(Y))&&(Y=0),W===Y&&(W===0?(W-=1,Y+=1):(W*=.9,Y*=1.1)),[W,Y]}function c(W,Y){return Y?function(re,ue){var j=Y[ue];return j??W(re)}:W}function b(W,Y,re,ue,j){var q=w(re);return ue?A.scale.ordinal().domain(ue.map(c(S(re.tickformat),j))).range(ue.map(function(H){var U=(H-q[0])/(q[1]-q[0]);return W-Y+U*(2*Y-W)})):A.scale.linear().domain(q).range([W-Y,Y])}function u(W,Y){return A.scale.linear().range([Y,W-Y])}function L(W,Y){return A.scale.linear().domain(w(W)).range([Y,1-Y])}function T(W){if(W.tickvals){var Y=w(W);return A.scale.ordinal().domain(W.tickvals).range(W.tickvals.map(function(re){return(re-Y[0])/(Y[1]-Y[0])}))}}function k(W){var Y=W.map(function(q){return q[0]}),re=W.map(function(q){var H=M(q[1]);return A.rgb("rgb("+H[0]+","+H[1]+","+H[2]+")")}),ue=function(q){return function(H){return H[q]}},j="rgb".split("").map(function(q){return A.scale.linear().clamp(!0).domain(Y).range(re.map(ue(q)))});return function(q){return j.map(function(H){return H(q)})}}function P(W){return W.dimensions.some(function(Y){return Y.brush.filterSpecified})}function z(W,Y,re){var ue=p(Y),j=ue.trace,q=v.convertTypedArray(ue.lineColor),H=j.line,U={color:M(j.unselected.line.color),opacity:j.unselected.line.opacity},$=h.extractOpts(H),ne=$.reversescale?h.flipScale(ue.cscale):ue.cscale,X=j.domain,Q=j.dimensions,ie=W.width,se=j.labelangle,ae=j.labelside,oe=j.labelfont,be=j.tickfont,ce=j.rangefont,de=g.extendDeepNoArrays({},H,{color:q.map(A.scale.linear().domain(w({values:q,range:[$.min,$.max],_length:j._length}))),blockLineCount:f.blockLineCount,canvasOverdrag:f.overdrag*f.canvasPixelRatio}),ye=Math.floor(ie*(X.x[1]-X.x[0])),ge=Math.floor(W.height*(X.y[1]-X.y[0])),me=W.margin||{l:80,r:80,t:100,b:80},Ee=ye,Pe=ge;return{key:re,colCount:Q.filter(v.isVisible).length,dimensions:Q,tickDistance:f.tickDistance,unitToColor:k(ne),lines:de,deselectedLines:U,labelAngle:se,labelSide:ae,labelFont:oe,tickFont:be,rangeFont:ce,layoutWidth:ie,layoutHeight:W.height,domain:X,translateX:X.x[0]*ie,translateY:W.height-X.y[1]*W.height,pad:me,canvasWidth:Ee*f.canvasPixelRatio+2*de.canvasOverdrag,canvasHeight:Pe*f.canvasPixelRatio,width:Ee,height:Pe,canvasPixelRatio:f.canvasPixelRatio}}function I(W,Y,re){var ue=re.width,j=re.height,q=re.dimensions,H=re.canvasPixelRatio,U=function(ie){return ue*ie/Math.max(1,re.colCount-1)},$=f.verticalPadding/j,ne=u(j,f.verticalPadding),X={key:re.key,xScale:U,model:re,inBrushDrag:!1},Q={};return X.dimensions=q.filter(v.isVisible).map(function(ie,se){var ae=L(ie,$),oe=Q[ie.label];Q[ie.label]=(oe||0)+1;var be=ie.label+(oe?"__"+oe:""),ce=ie.constraintrange,de=ce&&ce.length;de&&!Array.isArray(ce[0])&&(ce=[ce]);var ye=de?ce.map(function(Ie){return Ie.map(ae)}):[[-1/0,1/0]],ge=function(){var Ie=X;Ie.focusLayer&&Ie.focusLayer.render(Ie.panels,!0);var De=P(Ie);!W.contextShown()&&De?(Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!0),W.contextShown(!0)):W.contextShown()&&!De&&(Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!0,!0),W.contextShown(!1))},me=ie.values;me.length>ie._length&&(me=me.slice(0,ie._length));var Ee=ie.tickvals,Pe;function Ue(Ie,De){return{val:Ie,text:Pe[De]}}function we(Ie,De){return Ie.val-De.val}if(Array.isArray(Ee)&&Ee.length){Pe=ie.ticktext,!Array.isArray(Pe)||!Pe.length?Pe=Ee.map(S(ie.tickformat)):Pe.length>Ee.length?Pe=Pe.slice(0,Ee.length):Ee.length>Pe.length&&(Ee=Ee.slice(0,Pe.length));for(var ke=1;ke<Ee.length;ke++)if(Ee[ke]<Ee[ke-1]){for(var Xe=Ee.map(Ue).sort(we),Ve=0;Ve<Ee.length;Ve++)Ee[Ve]=Xe[Ve].val,Pe[Ve]=Xe[Ve].text;break}}else Ee=void 0;return me=v.convertTypedArray(me),{key:be,label:ie.label,tickFormat:ie.tickformat,tickvals:Ee,ticktext:Pe,ordinal:v.isOrdinal(ie),multiselect:ie.multiselect,xIndex:se,crossfilterDimensionIndex:se,visibleIndex:ie._index,height:j,values:me,paddedUnitValues:me.map(ae),unitTickvals:Ee&&Ee.map(ae),xScale:U,x:U(se),canvasX:U(se)*H,unitToPaddedPx:ne,domainScale:b(j,f.verticalPadding,ie,Ee,Pe),ordinalScale:T(ie),parent:X,model:re,brush:d.makeBrush(W,de,ye,function(){W.linePickActive(!1)},ge,function(Ie){if(X.focusLayer.render(X.panels,!0),X.pickLayer&&X.pickLayer.render(X.panels,!0),W.linePickActive(!0),Y&&Y.filterChanged){var De=ae.invert,Ye=Ie.map(function(vt){return vt.map(De).sort(g.sorterAsc)}).sort(function(vt,Dt){return vt[0]-Dt[0]});Y.filterChanged(X.key,ie._index,Ye)}})}}),X}function D(W){W.classed(f.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function R(){var W=!0,Y=!1;return{linePickActive:function(re){return arguments.length?W=!!re:W},contextShown:function(re){return arguments.length?Y=!!re:Y}}}function O(W,Y){var re=Y==="top"?1:-1,ue=W*Math.PI/180,j=Math.sin(ue),q=Math.cos(ue);return{dir:re,dx:j,dy:q,degrees:W}}function F(W,Y,re){for(var ue=Y.panels||(Y.panels=[]),j=W.data(),q=0;q<j.length-1;q++){var H=ue[q]||(ue[q]={}),U=j[q],$=j[q+1];H.dim0=U,H.dim1=$,H.canvasX=U.canvasX,H.panelSizeX=$.canvasX-U.canvasX,H.panelSizeY=Y.model.canvasHeight,H.y=0,H.canvasY=0,H.plotGlPixelRatio=re}}function N(W){for(var Y=0;Y<W.length;Y++)for(var re=0;re<W[Y].length;re++)for(var ue=W[Y][re].trace,j=ue.dimensions,q=0;q<j.length;q++){var H=j[q].values,U=j[q]._ax;U&&(U.range?U.range=_(U.range[0],U.range[1]):U.range=l(H,ue._length),U.dtick||(U.dtick=.01*(Math.abs(U.range[1]-U.range[0])||1)),U.tickformat=j[q].tickformat,e.calcTicks(U),U.cleanRange())}}function G(W,Y){return e.tickText(W._ax,Y,!1).text}function K(W,Y){if(W.ordinal)return"";var re=W.domainScale.domain(),ue=re[Y?re.length-1:0];return G(W.model.dimensions[W.visibleIndex],ue)}ee.exports=function(Y,re,ue,j){var q=Y._context.staticPlot,H=Y._fullLayout,U=H._toppaper,$=H._glcontainer,ne=Y._context.plotGlPixelRatio,X=Y._fullLayout.paper_bgcolor;N(re);var Q=R(),ie=re.filter(function(Ve){return p(Ve).trace.visible}).map(z.bind(0,ue)).map(I.bind(0,Q,j));$.each(function(Ve,Ie){return g.extendFlat(Ve,ie[Ie])});var se=$.selectAll(".gl-canvas").each(function(Ve){Ve.viewModel=ie[0],Ve.viewModel.plotGlPixelRatio=ne,Ve.viewModel.paperColor=X,Ve.model=Ve.viewModel?Ve.viewModel.model:null}),ae=null,oe=se.filter(function(Ve){return Ve.pick});oe.style("pointer-events",q?"none":"auto").on("mousemove",function(Ve){if(Q.linePickActive()&&Ve.lineLayer&&j&&j.hover){var Ie=A.event,De=this.width,Ye=this.height,vt=A.mouse(this),Dt=vt[0],Kt=vt[1];if(Dt<0||Kt<0||Dt>=De||Kt>=Ye)return;var Ft=Ve.lineLayer.readPixel(Dt,Ye-1-Kt),Mt=Ft[3]!==0,Xt=Mt?Ft[2]+256*(Ft[1]+256*Ft[0]):null,It={x:Dt,y:Kt,clientX:Ie.clientX,clientY:Ie.clientY,dataIndex:Ve.model.key,curveNumber:Xt};Xt!==ae&&(Mt?j.hover(It):j.unhover&&j.unhover(It),ae=Xt)}}),se.style("opacity",function(Ve){return Ve.pick?0:1}),U.style("background","rgba(255, 255, 255, 0)");var be=U.selectAll("."+f.cn.parcoords).data(ie,i);be.exit().remove(),be.enter().append("g").classed(f.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),be.attr("transform",function(Ve){return n(Ve.model.translateX,Ve.model.translateY)});var ce=be.selectAll("."+f.cn.parcoordsControlView).data(x,i);ce.enter().append("g").classed(f.cn.parcoordsControlView,!0),ce.attr("transform",function(Ve){return n(Ve.model.pad.l,Ve.model.pad.t)});var de=ce.selectAll("."+f.cn.yAxis).data(function(Ve){return Ve.dimensions},i);de.enter().append("g").classed(f.cn.yAxis,!0),ce.each(function(Ve){F(de,Ve,ne)}),se.each(function(Ve){if(Ve.viewModel){!Ve.lineLayer||j?Ve.lineLayer=o(this,Ve):Ve.lineLayer.update(Ve),(Ve.key||Ve.key===0)&&(Ve.viewModel[Ve.key]=Ve.lineLayer);var Ie=!Ve.context||j;Ve.lineLayer.render(Ve.viewModel.panels,Ie)}}),de.attr("transform",function(Ve){return n(Ve.xScale(Ve.xIndex),0)}),de.call(A.behavior.drag().origin(function(Ve){return Ve}).on("drag",function(Ve){var Ie=Ve.parent;Q.linePickActive(!1),Ve.x=Math.max(-f.overdrag,Math.min(Ve.model.width+f.overdrag,A.event.x)),Ve.canvasX=Ve.x*Ve.model.canvasPixelRatio,de.sort(function(De,Ye){return De.x-Ye.x}).each(function(De,Ye){De.xIndex=Ye,De.x=Ve===De?De.x:De.xScale(De.xIndex),De.canvasX=De.x*De.model.canvasPixelRatio}),F(de,Ie,ne),de.filter(function(De){return Math.abs(Ve.xIndex-De.xIndex)!==0}).attr("transform",function(De){return n(De.xScale(De.xIndex),0)}),A.select(this).attr("transform",n(Ve.x,0)),de.each(function(De,Ye,vt){vt===Ve.parent.key&&(Ie.dimensions[Ye]=De)}),Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!1,!P(Ie)),Ie.focusLayer.render&&Ie.focusLayer.render(Ie.panels)}).on("dragend",function(Ve){var Ie=Ve.parent;Ve.x=Ve.xScale(Ve.xIndex),Ve.canvasX=Ve.x*Ve.model.canvasPixelRatio,F(de,Ie,ne),A.select(this).attr("transform",function(De){return n(De.x,0)}),Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!1,!P(Ie)),Ie.focusLayer&&Ie.focusLayer.render(Ie.panels),Ie.pickLayer&&Ie.pickLayer.render(Ie.panels,!0),Q.linePickActive(!0),j&&j.axesMoved&&j.axesMoved(Ie.key,Ie.dimensions.map(function(De){return De.crossfilterDimensionIndex}))})),de.exit().remove();var ye=de.selectAll("."+f.cn.axisOverlays).data(x,i);ye.enter().append("g").classed(f.cn.axisOverlays,!0),ye.selectAll("."+f.cn.axis).remove();var ge=ye.selectAll("."+f.cn.axis).data(x,i);ge.enter().append("g").classed(f.cn.axis,!0),ge.each(function(Ve){var Ie=Ve.model.height/Ve.model.tickDistance,De=Ve.domainScale,Ye=De.domain();A.select(this).call(A.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Ie,Ve.tickFormat).tickValues(Ve.ordinal?Ye:null).tickFormat(function(vt){return v.isOrdinal(Ve)?vt:G(Ve.model.dimensions[Ve.visibleIndex],vt)}).scale(De)),t.font(ge.selectAll("text"),Ve.model.tickFont)}),ge.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ge.selectAll("text").style("text-shadow",r.makeTextShadow(X)).style("cursor","default");var me=ye.selectAll("."+f.cn.axisHeading).data(x,i);me.enter().append("g").classed(f.cn.axisHeading,!0);var Ee=me.selectAll("."+f.cn.axisTitle).data(x,i);Ee.enter().append("text").classed(f.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events",q?"none":"auto"),Ee.text(function(Ve){return Ve.label}).each(function(Ve){var Ie=A.select(this);t.font(Ie,Ve.model.labelFont),r.convertToTspans(Ie,Y)}).attr("transform",function(Ve){var Ie=O(Ve.model.labelAngle,Ve.model.labelSide),De=f.axisTitleOffset;return(Ie.dir>0?"":n(0,2*De+Ve.model.height))+a(Ie.degrees)+n(-De*Ie.dx,-De*Ie.dy)}).attr("text-anchor",function(Ve){var Ie=O(Ve.model.labelAngle,Ve.model.labelSide),De=Math.abs(Ie.dx),Ye=Math.abs(Ie.dy);return 2*De>Ye?Ie.dir*Ie.dx<0?"start":"end":"middle"});var Pe=ye.selectAll("."+f.cn.axisExtent).data(x,i);Pe.enter().append("g").classed(f.cn.axisExtent,!0);var Ue=Pe.selectAll("."+f.cn.axisExtentTop).data(x,i);Ue.enter().append("g").classed(f.cn.axisExtentTop,!0),Ue.attr("transform",n(0,-f.axisExtentOffset));var we=Ue.selectAll("."+f.cn.axisExtentTopText).data(x,i);we.enter().append("text").classed(f.cn.axisExtentTopText,!0).call(D),we.text(function(Ve){return K(Ve,!0)}).each(function(Ve){t.font(A.select(this),Ve.model.rangeFont)});var ke=Pe.selectAll("."+f.cn.axisExtentBottom).data(x,i);ke.enter().append("g").classed(f.cn.axisExtentBottom,!0),ke.attr("transform",function(Ve){return n(0,Ve.model.height+f.axisExtentOffset)});var Xe=ke.selectAll("."+f.cn.axisExtentBottomText).data(x,i);Xe.enter().append("text").classed(f.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(D),Xe.text(function(Ve){return K(Ve,!1)}).each(function(Ve){t.font(A.select(this),Ve.model.rangeFont)}),d.ensureAxisBrush(ye,X,Y)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(y,ee,n){var A=y("./parcoords"),g=y("../../lib/prepare_regl"),S=y("./helpers").isVisible,M={};function e(r,t,h){var s=t.indexOf(h),i=r.indexOf(s);return i===-1&&(i+=t.length),i}function a(r,t){return function(s,i){return e(r,t,s)-e(r,t,i)}}var n=ee.exports=function(t,h){var s=t._fullLayout,i=g(t,[],M);if(i){var x={},p={},v={},f={},d=s._size;h.forEach(function(_,c){var b=_[0].trace;v[c]=b.index;var u=f[c]=b._fullInput.index;x[c]=t.data[u].dimensions,p[c]=t.data[u].dimensions.slice()});var o=function(_,c,b){var u=p[_][c],L=b.map(function(D){return D.slice()}),T="dimensions["+c+"].constraintrange",k=s._tracePreGUI[t._fullData[v[_]]._fullInput.uid];if(k[T]===void 0){var P=u.constraintrange;k[T]=P||null}var z=t._fullData[v[_]].dimensions[c];L.length?(L.length===1&&(L=L[0]),u.constraintrange=L,z.constraintrange=L.slice(),L=[L]):(delete u.constraintrange,delete z.constraintrange,L=null);var I={};I[T]=L,t.emit("plotly_restyle",[I,[f[_]]])},m=function(_){t.emit("plotly_hover",_)},l=function(_){t.emit("plotly_unhover",_)},w=function(_,c){var b=a(c,p[_].filter(S));x[_].sort(b),p[_].filter(function(u){return!S(u)}).sort(function(u){return p[_].indexOf(u)}).forEach(function(u){x[_].splice(x[_].indexOf(u),1),x[_].splice(p[_].indexOf(u),0,u)}),t.emit("plotly_restyle",[{dimensions:[x[_]]},[f[_]]])};A(t,h,{width:d.w,height:d.h,margin:{t:d.t,r:d.r,b:d.b,l:d.l}},{filterChanged:o,hover:m,unhover:l,axesMoved:w})}};n.reglPrecompiled=M},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(y,ee,te){var A=y("../../plots/attributes"),g=y("../../plots/domain").attributes,S=y("../../plots/font_attributes"),M=y("../../components/color/attributes"),e=y("../../plots/template_attributes").hovertemplateAttrs,a=y("../../plots/template_attributes").texttemplateAttrs,n=y("../../lib/extend").extendFlat,r=S({editType:"plot",arrayOk:!0,colorEditType:"plot"});ee.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:M.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:n({},A.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:a({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:n({},r,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:n({},r,{}),outsidetextfont:n({},r,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:n({},r,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:g({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:n({},r,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(y,ee,te){var A=y("../../plots/plots");te.name="pie",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],912:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("tinycolor2"),S=y("../../components/color"),M={};function e(t,h){var s=[],i=t._fullLayout,x=i.hiddenlabels||[],p=h.labels,v=h.marker.colors||[],f=h.values,d=h._length,o=h._hasValues&&d,m,l;if(h.dlabel)for(p=new Array(d),m=0;m<d;m++)p[m]=String(h.label0+m*h.dlabel);var w={},_=a(i["_"+h.type+"colormap"]),c=0,b=!1;for(m=0;m<d;m++){var u,L,T;if(o){if(u=f[m],!A(u))continue;u=+u}else u=1;L=p[m],(L===void 0||L==="")&&(L=m),L=String(L);var k=w[L];k===void 0?(w[L]=s.length,T=x.indexOf(L)!==-1,T||(c+=u),s.push({v:u,label:L,color:_(v[m],L),i:m,pts:[m],hidden:T})):(b=!0,l=s[k],l.v+=u,l.pts.push(m),l.hidden||(c+=u),l.color===!1&&v[m]&&(l.color=_(v[m],L)))}s=s.filter(function(z){return z.v>=0});var P=h.type==="funnelarea"?b:h.sort;return P&&s.sort(function(z,I){return I.v-z.v}),s[0]&&(s[0].vTotal=c),s}function a(t){return function(s,i){return!s||(s=g(s),!s.isValid())?!1:(s=S.addOpacity(s,s.getAlpha()),t[i]||(t[i]=s),s)}}function n(t,h){var s=(h||{}).type;s||(s="pie");var i=t._fullLayout,x=t.calcdata,p=i[s+"colorway"],v=i["_"+s+"colormap"];i["extend"+s+"colors"]&&(p=r(p,M));for(var f=0,d=0;d<x.length;d++){var o=x[d],m=o[0].trace.type;if(m===s)for(var l=0;l<o.length;l++){var w=o[l];w.color===!1&&(v[w.label]?w.color=v[w.label]:(v[w.label]=w.color=p[f%p.length],f++))}}}function r(t,h){var s,i=JSON.stringify(t),x=h[i];if(!x){for(x=t.slice(),s=0;s<t.length;s++)x.push(g(t[s]).lighten(20).toHexString());for(s=0;s<t.length;s++)x.push(g(t[s]).darken(20).toHexString());h[i]=x}return x}ee.exports={calc:e,crossTraceCalc:n,makePullColorFn:a,generateExtendedColors:r}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("./attributes"),M=y("../../plots/domain").defaults,e=y("../bar/defaults").handleText;function a(r,t){var h=Array.isArray(r),s=g.isArrayOrTypedArray(t),i=Math.min(h?r.length:1/0,s?t.length:1/0);if(isFinite(i)||(i=0),i&&s){for(var x,p=0;p<i;p++){var v=t[p];if(A(v)&&v>0){x=!0;break}}x||(i=0)}return{hasLabels:h,hasValues:s,len:i}}function n(r,t,h,s){function i(T,k){return g.coerce(r,t,S,T,k)}var x=i("labels"),p=i("values"),v=a(x,p),f=v.len;if(t._hasLabels=v.hasLabels,t._hasValues=v.hasValues,!t._hasLabels&&t._hasValues&&(i("label0"),i("dlabel")),!f){t.visible=!1;return}t._length=f;var d=i("marker.line.width");d&&i("marker.line.color"),i("marker.colors"),i("scalegroup");var o=i("text"),m=i("texttemplate"),l;if(m||(l=i("textinfo",Array.isArray(o)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),m||l&&l!=="none"){var w=i("textposition");e(r,t,s,i,w,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1});var _=Array.isArray(w)||w==="auto",c=_||w==="outside";c&&i("automargin"),(w==="inside"||w==="auto"||Array.isArray(w))&&i("insidetextorientation")}M(t,s,i);var b=i("hole"),u=i("title.text");if(u){var L=i("title.position",b?"middle center":"top center");!b&&L==="middle center"&&(t.title.position="top center"),g.coerceFont(i,"title.font",s.font)}i("sort"),i("direction"),i("rotation"),i("pull")}ee.exports={handleLabelsAndValues:a,supplyDefaults:n}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(y,ee,te){var A=y("../../components/fx/helpers").appendArrayMultiPointValues;ee.exports=function(S,M){var e={curveNumber:M.index,pointNumbers:S.pts,data:M._input,fullData:M,label:S.label,color:S.color,value:S.v,percent:S.percent,text:S.text,bbox:S.bbox,v:S.v};return S.pts.length===1&&(e.pointNumber=e.i=S.pts[0]),A(e,M,S.pts),M.type==="funnelarea"&&(delete e.v,delete e.i),e}},{"../../components/fx/helpers":403}],915:[function(y,ee,te){var A=y("../../lib");function g(S){return S.indexOf("e")!==-1?S.replace(/[.]?0+e/,"e"):S.indexOf(".")!==-1?S.replace(/[.]?0+$/,""):S}te.formatPiePercent=function(M,e){var a=g((M*100).toPrecision(3));return A.numSeparate(a,e)+"%"},te.formatPieValue=function(M,e){var a=g(M.toPrecision(10));return A.numSeparate(a,e)},te.getFirstFilled=function(M,e){if(Array.isArray(M))for(var a=0;a<e.length;a++){var n=M[e[a]];if(n||n===0||n==="")return n}},te.castOption=function(M,e){if(Array.isArray(M))return te.getFirstFilled(M,e);if(M)return M},te.getRotationAngle=function(S){return(S==="auto"?0:S)*Math.PI/180}},{"../../lib":515}],916:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,supplyLayoutDefaults:y("./layout_defaults"),layoutAttributes:y("./layout_attributes"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot").plot,style:y("./style"),styleOne:y("./style_one"),moduleType:"trace",name:"pie",basePlotModule:y("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(y,ee,te){ee.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("hiddenlabels"),a("piecolorway",e.colorway),a("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../plots/plots"),S=y("../../components/fx"),M=y("../../components/color"),e=y("../../components/drawing"),a=y("../../lib"),n=a.strScale,r=a.strTranslate,t=y("../../lib/svg_text_utils"),h=y("../bar/uniform_text"),s=h.recordMinTextSize,i=h.clearMinTextSize,x=y("../bar/constants").TEXTPAD,p=y("./helpers"),v=y("./event_data"),f=y("../../lib").isValidTextValue;function d(q,H){var U=q._context.staticPlot,$=q._fullLayout,ne=$._size;i("pie",$),_(H,q),K(H,ne);var X=a.makeTraceGroups($._pielayer,H,"trace").each(function(Q){var ie=A.select(this),se=Q[0],ae=se.trace;Y(Q),ie.attr("stroke-linejoin","round"),ie.each(function(){var oe=A.select(this).selectAll("g.slice").data(Q);oe.enter().append("g").classed("slice",!0),oe.exit().remove();var be=[[[],[]],[[],[]]],ce=!1;oe.each(function(we,ke){if(we.hidden){A.select(this).selectAll("path,g").remove();return}we.pointNumber=we.i,we.curveNumber=ae.index,be[we.pxmid[1]<0?0:1][we.pxmid[0]<0?0:1].push(we);var Xe=se.cx,Ve=se.cy,Ie=A.select(this),De=Ie.selectAll("path.surface").data([we]);if(De.enter().append("path").classed("surface",!0).style({"pointer-events":U?"none":"all"}),Ie.call(m,q,Q),ae.pull){var Ye=+p.castOption(ae.pull,we.pts)||0;Ye>0&&(Xe+=Ye*we.pxmid[0],Ve+=Ye*we.pxmid[1])}we.cxFinal=Xe,we.cyFinal=Ve;function vt(At,Ge,tt,He){var Ae=He*(Ge[0]-At[0]),Ne=He*(Ge[1]-At[1]);return"a"+He*se.r+","+He*se.r+" 0 "+we.largeArc+(tt?" 1 ":" 0 ")+Ae+","+Ne}var Dt=ae.hole;if(we.v===se.vTotal){var Kt="M"+(Xe+we.px0[0])+","+(Ve+we.px0[1])+vt(we.px0,we.pxmid,!0,1)+vt(we.pxmid,we.px0,!0,1)+"Z";Dt?De.attr("d","M"+(Xe+Dt*we.px0[0])+","+(Ve+Dt*we.px0[1])+vt(we.px0,we.pxmid,!1,Dt)+vt(we.pxmid,we.px0,!1,Dt)+"Z"+Kt):De.attr("d",Kt)}else{var Ft=vt(we.px0,we.px1,!0,1);if(Dt){var Mt=1-Dt;De.attr("d","M"+(Xe+Dt*we.px1[0])+","+(Ve+Dt*we.px1[1])+vt(we.px1,we.px0,!1,Dt)+"l"+Mt*we.px0[0]+","+Mt*we.px0[1]+Ft+"Z")}else De.attr("d","M"+Xe+","+Ve+"l"+we.px0[0]+","+we.px0[1]+Ft+"Z")}ue(q,we,se);var Xt=p.castOption(ae.textposition,we.pts),It=Ie.selectAll("g.slicetext").data(we.text&&Xt!=="none"?[0]:[]);It.enter().append("g").classed("slicetext",!0),It.exit().remove(),It.each(function(){var At=a.ensureSingle(A.select(this),"text","",function(bt){bt.attr("data-notex",1)}),Ge=a.ensureUniformFontSize(q,Xt==="outside"?l(ae,we,$.font):w(ae,we,$.font));At.text(we.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Ge).call(t.convertToTspans,q);var tt=e.bBox(At.node()),He;if(Xt==="outside")He=I(tt,we);else if(He=c(tt,we,se),Xt==="auto"&&He.scale<1){var Ae=a.ensureUniformFontSize(q,ae.outsidetextfont);At.call(e.font,Ae),tt=e.bBox(At.node()),He=I(tt,we)}var Ne=He.textPosAngle,Ze=Ne===void 0?we.pxmid:re(se.r,Ne);if(He.targetX=Xe+Ze[0]*He.rCenter+(He.x||0),He.targetY=Ve+Ze[1]*He.rCenter+(He.y||0),j(He,tt),He.outside){var Qe=He.targetY;we.yLabelMin=Qe-tt.height/2,we.yLabelMid=Qe,we.yLabelMax=Qe+tt.height/2,we.labelExtraX=0,we.labelExtraY=0,ce=!0}He.fontSize=Ge.size,s(ae.type,He,$),Q[ke].transform=He,a.setTransormAndDisplay(At,He)})});var de=A.select(this).selectAll("g.titletext").data(ae.title.text?[0]:[]);if(de.enter().append("g").classed("titletext",!0),de.exit().remove(),de.each(function(){var we=a.ensureSingle(A.select(this),"text","",function(Ve){Ve.attr("data-notex",1)}),ke=ae.title.text;ae._meta&&(ke=a.templateString(ke,ae._meta)),we.text(ke).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,ae.title.font).call(t.convertToTspans,q);var Xe;ae.title.position==="middle center"?Xe=D(se):Xe=R(se,ne),we.attr("transform",r(Xe.x,Xe.y)+n(Math.min(1,Xe.scale))+r(Xe.tx,Xe.ty))}),ce&&G(be,ae),o(oe,ae),ce&&ae.automargin){var ye=e.bBox(ie.node()),ge=ae.domain,me=ne.w*(ge.x[1]-ge.x[0]),Ee=ne.h*(ge.y[1]-ge.y[0]),Pe=(.5*me-se.r)/ne.w,Ue=(.5*Ee-se.r)/ne.h;g.autoMargin(q,"pie."+ae.uid+".automargin",{xl:ge.x[0]-Pe,xr:ge.x[1]+Pe,yb:ge.y[0]-Ue,yt:ge.y[1]+Ue,l:Math.max(se.cx-se.r-ye.left,0),r:Math.max(ye.right-(se.cx+se.r),0),b:Math.max(ye.bottom-(se.cy+se.r),0),t:Math.max(se.cy-se.r-ye.top,0),pad:5})}})});setTimeout(function(){X.selectAll("tspan").each(function(){var Q=A.select(this);Q.attr("dy")&&Q.attr("dy",Q.attr("dy"))})},0)}function o(q,H){q.each(function(U){var $=A.select(this);if(!U.labelExtraX&&!U.labelExtraY){$.select("path.textline").remove();return}var ne=$.select("g.slicetext text");U.transform.targetX+=U.labelExtraX,U.transform.targetY+=U.labelExtraY,a.setTransormAndDisplay(ne,U.transform);var X=U.cxFinal+U.pxmid[0],Q=U.cyFinal+U.pxmid[1],ie="M"+X+","+Q,se=(U.yLabelMax-U.yLabelMin)*(U.pxmid[0]<0?-1:1)/4;if(U.labelExtraX){var ae=U.labelExtraX*U.pxmid[1]/U.pxmid[0],oe=U.yLabelMid+U.labelExtraY-(U.cyFinal+U.pxmid[1]);Math.abs(ae)>Math.abs(oe)?ie+="l"+oe*U.pxmid[0]/U.pxmid[1]+","+oe+"H"+(X+U.labelExtraX+se):ie+="l"+U.labelExtraX+","+ae+"v"+(oe-ae)+"h"+se}else ie+="V"+(U.yLabelMid+U.labelExtraY)+"h"+se;a.ensureSingle($,"path","textline").call(M.stroke,H.outsidetextfont.color).attr({"stroke-width":Math.min(2,H.outsidetextfont.size/8),d:ie,fill:"none"})})}function m(q,H,U){var $=U[0],ne=$.cx,X=$.cy,Q=$.trace,ie=Q.type==="funnelarea";"_hasHoverLabel"in Q||(Q._hasHoverLabel=!1),"_hasHoverEvent"in Q||(Q._hasHoverEvent=!1),q.on("mouseover",function(se){var ae=H._fullLayout,oe=H._fullData[Q.index];if(!(H._dragging||ae.hovermode===!1)){var be=oe.hoverinfo;if(Array.isArray(be)&&(be=S.castHoverinfo({hoverinfo:[p.castOption(be,se.pts)],_module:Q._module},ae,0)),be==="all"&&(be="label+text+value+percent+name"),oe.hovertemplate||be!=="none"&&be!=="skip"&&be){var ce=se.rInscribed||0,de=ne+se.pxmid[0]*(1-ce),ye=X+se.pxmid[1]*(1-ce),ge=ae.separators,me=[];if(be&&be.indexOf("label")!==-1&&me.push(se.label),se.text=p.castOption(oe.hovertext||oe.text,se.pts),be&&be.indexOf("text")!==-1){var Ee=se.text;a.isValidTextValue(Ee)&&me.push(Ee)}se.value=se.v,se.valueLabel=p.formatPieValue(se.v,ge),be&&be.indexOf("value")!==-1&&me.push(se.valueLabel),se.percent=se.v/$.vTotal,se.percentLabel=p.formatPiePercent(se.percent,ge),be&&be.indexOf("percent")!==-1&&me.push(se.percentLabel);var Pe=oe.hoverlabel,Ue=Pe.font,we=[];S.loneHover({trace:Q,x0:de-ce*$.r,x1:de+ce*$.r,y:ye,_x0:ie?ne+se.TL[0]:de-ce*$.r,_x1:ie?ne+se.TR[0]:de+ce*$.r,_y0:ie?X+se.TL[1]:ye-ce*$.r,_y1:ie?X+se.BL[1]:ye+ce*$.r,text:me.join("<br>"),name:oe.hovertemplate||be.indexOf("name")!==-1?oe.name:void 0,idealAlign:se.pxmid[0]<0?"left":"right",color:p.castOption(Pe.bgcolor,se.pts)||se.color,borderColor:p.castOption(Pe.bordercolor,se.pts),fontFamily:p.castOption(Ue.family,se.pts),fontSize:p.castOption(Ue.size,se.pts),fontColor:p.castOption(Ue.color,se.pts),nameLength:p.castOption(Pe.namelength,se.pts),textAlign:p.castOption(Pe.align,se.pts),hovertemplate:p.castOption(oe.hovertemplate,se.pts),hovertemplateLabels:se,eventData:[v(se,oe)]},{container:ae._hoverlayer.node(),outerContainer:ae._paper.node(),gd:H,inOut_bbox:we}),se.bbox=we[0],Q._hasHoverLabel=!0}Q._hasHoverEvent=!0,H.emit("plotly_hover",{points:[v(se,oe)],event:A.event})}}),q.on("mouseout",function(se){var ae=H._fullLayout,oe=H._fullData[Q.index],be=A.select(this).datum();Q._hasHoverEvent&&(se.originalEvent=A.event,H.emit("plotly_unhover",{points:[v(be,oe)],event:A.event}),Q._hasHoverEvent=!1),Q._hasHoverLabel&&(S.loneUnhover(ae._hoverlayer.node()),Q._hasHoverLabel=!1)}),q.on("click",function(se){var ae=H._fullLayout,oe=H._fullData[Q.index];H._dragging||ae.hovermode===!1||(H._hoverdata=[v(se,oe)],S.click(H,A.event))})}function l(q,H,U){var $=p.castOption(q.outsidetextfont.color,H.pts)||p.castOption(q.textfont.color,H.pts)||U.color,ne=p.castOption(q.outsidetextfont.family,H.pts)||p.castOption(q.textfont.family,H.pts)||U.family,X=p.castOption(q.outsidetextfont.size,H.pts)||p.castOption(q.textfont.size,H.pts)||U.size;return{color:$,family:ne,size:X}}function w(q,H,U){var $=p.castOption(q.insidetextfont.color,H.pts);!$&&q._input.textfont&&($=p.castOption(q._input.textfont.color,H.pts));var ne=p.castOption(q.insidetextfont.family,H.pts)||p.castOption(q.textfont.family,H.pts)||U.family,X=p.castOption(q.insidetextfont.size,H.pts)||p.castOption(q.textfont.size,H.pts)||U.size;return{color:$||M.contrast(H.color),family:ne,size:X}}function _(q,H){for(var U,$,ne=0;ne<q.length;ne++)if(U=q[ne][0],$=U.trace,$.title.text){var X=$.title.text;$._meta&&(X=a.templateString(X,$._meta));var Q=e.tester.append("text").attr("data-notex",1).text(X).call(e.font,$.title.font).call(t.convertToTspans,H),ie=e.bBox(Q.node(),!0);U.titleBox={width:ie.width,height:ie.height},Q.remove()}}function c(q,H,U){var $=U.r||H.rpx1,ne=H.rInscribed,X=H.startangle===H.stopangle;if(X)return{rCenter:1-ne,scale:0,rotate:0,textPosAngle:0};var Q=H.ring,ie=Q===1&&Math.abs(H.startangle-H.stopangle)===Math.PI*2,se=H.halfangle,ae=H.midangle,oe=U.trace.insidetextorientation,be=oe==="horizontal",ce=oe==="tangential",de=oe==="radial",ye=oe==="auto",ge=[],me;if(!ye){var Ee=function(Ie,De){if(b(H,Ie)){var Ye=Math.abs(Ie-H.startangle),vt=Math.abs(Ie-H.stopangle),Dt=Ye<vt?Ye:vt;De==="tan"?me=L(q,$,Q,Dt,0):me=u(q,$,Q,Dt,Math.PI/2),me.textPosAngle=Ie,ge.push(me)}},Pe;if(be||ce){for(Pe=4;Pe>=-4;Pe-=2)Ee(Math.PI*Pe,"tan");for(Pe=4;Pe>=-4;Pe-=2)Ee(Math.PI*(Pe+1),"tan")}if(be||de){for(Pe=4;Pe>=-4;Pe-=2)Ee(Math.PI*(Pe+1.5),"rad");for(Pe=4;Pe>=-4;Pe-=2)Ee(Math.PI*(Pe+.5),"rad")}}if(ie||ye||be){var Ue=Math.sqrt(q.width*q.width+q.height*q.height);if(me={scale:ne*$*2/Ue,rCenter:1-ne,rotate:0},me.textPosAngle=(H.startangle+H.stopangle)/2,me.scale>=1)return me;ge.push(me)}(ye||de)&&(me=u(q,$,Q,se,ae),me.textPosAngle=(H.startangle+H.stopangle)/2,ge.push(me)),(ye||ce)&&(me=L(q,$,Q,se,ae),me.textPosAngle=(H.startangle+H.stopangle)/2,ge.push(me));for(var we=0,ke=0,Xe=0;Xe<ge.length;Xe++){var Ve=ge[Xe].scale;if(ke<Ve&&(ke=Ve,we=Xe),!ye&&ke>=1)break}return ge[we]}function b(q,H){var U=q.startangle,$=q.stopangle;return U>H&&H>$||U<H&&H<$}function u(q,H,U,$,ne){H=Math.max(0,H-2*x);var X=q.width/q.height,Q=P(X,$,H,U);return{scale:Q*2/q.height,rCenter:T(X,Q/H),rotate:k(ne)}}function L(q,H,U,$,ne){H=Math.max(0,H-2*x);var X=q.height/q.width,Q=P(X,$,H,U);return{scale:Q*2/q.width,rCenter:T(X,Q/H),rotate:k(ne+Math.PI/2)}}function T(q,H){return Math.cos(H)-q*H}function k(q){return(180/Math.PI*q+720)%180-90}function P(q,H,U,$){var ne=q+1/(2*Math.tan(H));return U*Math.min(1/(Math.sqrt(ne*ne+.5)+ne),$/(Math.sqrt(q*q+$/2)+q))}function z(q,H){return q.v===H.vTotal&&!H.trace.hole?1:Math.min(1/(1+1/Math.sin(q.halfangle)),q.ring/2)}function I(q,H){var U=H.pxmid[0],$=H.pxmid[1],ne=q.width/2,X=q.height/2;return U<0&&(ne*=-1),$<0&&(X*=-1),{scale:1,rCenter:1,rotate:0,x:ne+Math.abs(X)*(ne>0?1:-1)/2,y:X/(1+U*U/($*$)),outside:!0}}function D(q){var H=Math.sqrt(q.titleBox.width*q.titleBox.width+q.titleBox.height*q.titleBox.height);return{x:q.cx,y:q.cy,scale:q.trace.hole*q.r*2/H,tx:0,ty:-q.titleBox.height/2+q.trace.title.font.size}}function R(q,H){var U=1,$=1,ne,X=q.trace,Q={x:q.cx,y:q.cy},ie={tx:0,ty:0};ie.ty+=X.title.font.size,ne=N(X),X.title.position.indexOf("top")!==-1?(Q.y-=(1+ne)*q.r,ie.ty-=q.titleBox.height):X.title.position.indexOf("bottom")!==-1&&(Q.y+=(1+ne)*q.r);var se=O(q.r,q.trace.aspectratio),ae=H.w*(X.domain.x[1]-X.domain.x[0])/2;return X.title.position.indexOf("left")!==-1?(ae=ae+se,Q.x-=(1+ne)*se,ie.tx+=q.titleBox.width/2):X.title.position.indexOf("center")!==-1?ae*=2:X.title.position.indexOf("right")!==-1&&(ae=ae+se,Q.x+=(1+ne)*se,ie.tx-=q.titleBox.width/2),U=ae/q.titleBox.width,$=F(q,H)/q.titleBox.height,{x:Q.x,y:Q.y,scale:Math.min(U,$),tx:ie.tx,ty:ie.ty}}function O(q,H){return q/(H===void 0?1:H)}function F(q,H){var U=q.trace,$=H.h*(U.domain.y[1]-U.domain.y[0]);return Math.min(q.titleBox.height,$/2)}function N(q){var H=q.pull;if(!H)return 0;var U;if(Array.isArray(H))for(H=0,U=0;U<q.pull.length;U++)q.pull[U]>H&&(H=q.pull[U]);return H}function G(q,H){var U,$,ne,X,Q,ie,se,ae,oe,be,ce,de,ye;function ge(Ue,we){return Ue.pxmid[1]-we.pxmid[1]}function me(Ue,we){return we.pxmid[1]-Ue.pxmid[1]}function Ee(Ue,we){we||(we={});var ke=we.labelExtraY+($?we.yLabelMax:we.yLabelMin),Xe=$?Ue.yLabelMin:Ue.yLabelMax,Ve=$?Ue.yLabelMax:Ue.yLabelMin,Ie=Ue.cyFinal+Q(Ue.px0[1],Ue.px1[1]),De=ke-Xe,Ye,vt,Dt,Kt,Ft,Mt;if(De*se>0&&(Ue.labelExtraY=De),!!Array.isArray(H.pull))for(vt=0;vt<be.length;vt++)Dt=be[vt],!(Dt===Ue||(p.castOption(H.pull,Ue.pts)||0)>=(p.castOption(H.pull,Dt.pts)||0))&&((Ue.pxmid[1]-Dt.pxmid[1])*se>0?(Kt=Dt.cyFinal+Q(Dt.px0[1],Dt.px1[1]),De=Kt-Xe-Ue.labelExtraY,De*se>0&&(Ue.labelExtraY+=De)):(Ve+Ue.labelExtraY-Ie)*se>0&&(Ye=3*ie*Math.abs(vt-be.indexOf(Ue)),Ft=Dt.cxFinal+X(Dt.px0[0],Dt.px1[0]),Mt=Ft+Ye-(Ue.cxFinal+Ue.pxmid[0])-Ue.labelExtraX,Mt*ie>0&&(Ue.labelExtraX+=Mt)))}for($=0;$<2;$++)for(ne=$?ge:me,Q=$?Math.max:Math.min,se=$?1:-1,U=0;U<2;U++){for(X=U?Math.max:Math.min,ie=U?1:-1,ae=q[$][U],ae.sort(ne),oe=q[1-$][U],be=oe.concat(ae),de=[],ce=0;ce<ae.length;ce++)ae[ce].yLabelMid!==void 0&&de.push(ae[ce]);for(ye=!1,ce=0;$&&ce<oe.length;ce++)if(oe[ce].yLabelMid!==void 0){ye=oe[ce];break}for(ce=0;ce<de.length;ce++){var Pe=ce&&de[ce-1];ye&&!ce&&(Pe=ye),Ee(de[ce],Pe)}}}function K(q,H){for(var U=[],$=0;$<q.length;$++){var ne=q[$][0],X=ne.trace,Q=X.domain,ie=H.w*(Q.x[1]-Q.x[0]),se=H.h*(Q.y[1]-Q.y[0]);X.title.text&&X.title.position!=="middle center"&&(se-=F(ne,H));var ae=ie/2,oe=se/2;X.type==="funnelarea"&&!X.scalegroup&&(oe/=X.aspectratio),ne.r=Math.min(ae,oe)/(1+N(X)),ne.cx=H.l+H.w*(X.domain.x[1]+X.domain.x[0])/2,ne.cy=H.t+H.h*(1-X.domain.y[0])-se/2,X.title.text&&X.title.position.indexOf("bottom")!==-1&&(ne.cy-=F(ne,H)),X.scalegroup&&U.indexOf(X.scalegroup)===-1&&U.push(X.scalegroup)}W(q,U)}function W(q,H){for(var U,$,ne,X=0;X<H.length;X++){var Q=1/0,ie=H[X];for($=0;$<q.length;$++)if(U=q[$][0],ne=U.trace,ne.scalegroup===ie){var se;if(ne.type==="pie")se=U.r*U.r;else if(ne.type==="funnelarea"){var ae,oe;ne.aspectratio>1?(ae=U.r,oe=ae/ne.aspectratio):(oe=U.r,ae=oe*ne.aspectratio),ae*=(1+ne.baseratio)/2,se=ae*oe}Q=Math.min(Q,se/U.vTotal)}for($=0;$<q.length;$++)if(U=q[$][0],ne=U.trace,ne.scalegroup===ie){var be=Q*U.vTotal;ne.type==="funnelarea"&&(be/=(1+ne.baseratio)/2,be/=ne.aspectratio),U.r=Math.sqrt(be)}}}function Y(q){var H=q[0],U=H.r,$=H.trace,ne=p.getRotationAngle($.rotation),X=2*Math.PI/H.vTotal,Q="px0",ie="px1",se,ae,oe;if($.direction==="counterclockwise"){for(se=0;se<q.length&&q[se].hidden;se++);if(se===q.length)return;ne+=X*q[se].v,X*=-1,Q="px1",ie="px0"}for(oe=re(U,ne),se=0;se<q.length;se++)ae=q[se],!ae.hidden&&(ae[Q]=oe,ae.startangle=ne,ne+=X*ae.v/2,ae.pxmid=re(U,ne),ae.midangle=ne,ne+=X*ae.v/2,oe=re(U,ne),ae.stopangle=ne,ae[ie]=oe,ae.largeArc=ae.v>H.vTotal/2?1:0,ae.halfangle=Math.PI*Math.min(ae.v/H.vTotal,.5),ae.ring=1-$.hole,ae.rInscribed=z(ae,H))}function re(q,H){return[q*Math.sin(H),-q*Math.cos(H)]}function ue(q,H,U){var $=q._fullLayout,ne=U.trace,X=ne.texttemplate,Q=ne.textinfo;if(!X&&Q&&Q!=="none"){var ie=Q.split("+"),se=function(we){return ie.indexOf(we)!==-1},ae=se("label"),oe=se("text"),be=se("value"),ce=se("percent"),de=$.separators,ye;if(ye=ae?[H.label]:[],oe){var ge=p.getFirstFilled(ne.text,H.pts);f(ge)&&ye.push(ge)}be&&ye.push(p.formatPieValue(H.v,de)),ce&&ye.push(p.formatPiePercent(H.v/U.vTotal,de)),H.text=ye.join("<br>")}function me(we){return{label:we.label,value:we.v,valueLabel:p.formatPieValue(we.v,$.separators),percent:we.v/U.vTotal,percentLabel:p.formatPiePercent(we.v/U.vTotal,$.separators),color:we.color,text:we.text,customdata:a.castOption(ne,we.i,"customdata")}}if(X){var Ee=a.castOption(ne,H.i,"texttemplate");if(!Ee)H.text="";else{var Pe=me(H),Ue=p.getFirstFilled(ne.text,H.pts);(f(Ue)||Ue==="")&&(Pe.text=Ue),H.text=a.texttemplateString(Ee,Pe,q._fullLayout._d3locale,Pe,ne._meta||{})}}}function j(q,H){var U=q.rotate*Math.PI/180,$=Math.cos(U),ne=Math.sin(U),X=(H.left+H.right)/2,Q=(H.top+H.bottom)/2;q.textX=X*$-Q*ne,q.textY=X*ne+Q*$,q.noCenter=!0}ee.exports={plot:d,formatSliceLabel:ue,transformInsideText:c,determineInsideTextFont:w,positionTitleOutside:R,prerenderTitles:_,layoutAreas:K,attachFxHandlers:m,computeTransform:j}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(y,ee,te){var A=y("@plotly/d3"),g=y("./style_one"),S=y("../bar/uniform_text").resizeText;ee.exports=function(e){var a=e._fullLayout._pielayer.selectAll(".trace");S(e,a,"pie"),a.each(function(n){var r=n[0],t=r.trace,h=A.select(this);h.style({opacity:t.opacity}),h.selectAll("path.surface").each(function(s){A.select(this).call(g,s,t)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(y,ee,te){var A=y("../../components/color"),g=y("./helpers").castOption;ee.exports=function(M,e,a){var n=a.marker.line,r=g(n.color,e.pts)||A.defaultLine,t=g(n.width,e.pts)||0;M.style("stroke-width",t).call(A.fill,e.color).call(A.stroke,r)}},{"../../components/color":367,"./helpers":915}],922:[function(y,ee,te){var A=y("../scatter/attributes");ee.exports={x:A.x,y:A.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:A.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_pointcloud2d,g=y("../../lib/str2rgbarray"),S=y("../../plots/cartesian/autorange").findExtremes,M=y("../scatter/get_trace_color");function e(r,t){this.scene=r,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=A(r.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var a=e.prototype;a.handlePick=function(r){var t=this.idToIndex[r.pointId];return{trace:this,dataCoord:r.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[t*2],this.pickXYData[t*2+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},a.update=function(r){this.index=r.index,this.textLabels=r.text,this.name=r.name,this.hoverinfo=r.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(r),this.color=M(r,{})},a.updateFast=function(r){var t=this.xData=this.pickXData=r.x,h=this.yData=this.pickYData=r.y,s=this.pickXYData=r.xy,i=r.xbounds&&r.ybounds,x=r.indices,p,v,f,d=this.bounds,o,m,l;if(s){if(f=s,p=s.length>>>1,i)d[0]=r.xbounds[0],d[2]=r.xbounds[1],d[1]=r.ybounds[0],d[3]=r.ybounds[1];else for(l=0;l<p;l++)o=f[l*2],m=f[l*2+1],o<d[0]&&(d[0]=o),o>d[2]&&(d[2]=o),m<d[1]&&(d[1]=m),m>d[3]&&(d[3]=m);if(x)v=x;else for(v=new Int32Array(p),l=0;l<p;l++)v[l]=l}else for(p=t.length,f=new Float32Array(2*p),v=new Int32Array(p),l=0;l<p;l++)o=t[l],m=h[l],v[l]=l,f[l*2]=o,f[l*2+1]=m,o<d[0]&&(d[0]=o),o>d[2]&&(d[2]=o),m<d[1]&&(d[1]=m),m>d[3]&&(d[3]=m);this.idToIndex=v,this.pointcloudOptions.idToIndex=v,this.pointcloudOptions.positions=f;var w=g(r.marker.color),_=g(r.marker.border.color),c=r.opacity*r.marker.opacity;w[3]*=c,this.pointcloudOptions.color=w;var b=r.marker.blend;if(b===null){var u=100;b=t.length<u||h.length<u}this.pointcloudOptions.blend=b,_[3]*=c,this.pointcloudOptions.borderColor=_;var L=r.marker.sizemin,T=Math.max(r.marker.sizemax,r.marker.sizemin);this.pointcloudOptions.sizeMin=L,this.pointcloudOptions.sizeMax=T,this.pointcloudOptions.areaRatio=r.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,P=this.scene.yaxis,z=T/2||.5;r._extremes[k._id]=S(k,[d[0],d[2]],{ppad:z}),r._extremes[P._id]=S(P,[d[1],d[3]],{ppad:z})},a.dispose=function(){this.pointcloud.dispose()};function n(r,t){var h=new e(r,t.uid);return h.update(t),h}ee.exports=n},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes");ee.exports=function(M,e,a){function n(r,t){return A.coerce(M,e,g,r,t)}n("x"),n("y"),n("xbounds"),n("ybounds"),M.xy&&M.xy instanceof Float32Array&&(e.xy=M.xy),M.indices&&M.indices instanceof Int32Array&&(e.indices=M.indices),n("text"),n("marker.color",a),n("marker.opacity"),n("marker.blend"),n("marker.sizemin"),n("marker.sizemax"),n("marker.border.color",a),n("marker.border.arearatio"),e._length=null}},{"../../lib":515,"./attributes":922}],925:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("../scatter3d/calc"),plot:y("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:y("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(y,ee,te){var A=y("../../plots/font_attributes"),g=y("../../plots/attributes"),S=y("../../components/color/attributes"),M=y("../../components/fx/attributes"),e=y("../../plots/domain").attributes,a=y("../../plots/template_attributes").hovertemplateAttrs,n=y("../../components/colorscale/attributes"),r=y("../../plot_api/plot_template").templatedArray,t=y("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,h=y("../../lib/extend").extendFlat,s=y("../../plot_api/edit_types").overrideAll,i=ee.exports=s({hoverinfo:h({},g.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:M.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:t("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:A({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:S.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:M.hoverlabel,hovertemplate:a({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:S.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:M.hoverlabel,hovertemplate:a({},{keys:["value","label"]}),colorscales:r("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:h(n().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");i.transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(y,ee,te){var A=y("../../plot_api/edit_types").overrideAll,g=y("../../plots/get_data").getModuleCalcData,S=y("./plot"),M=y("../../components/fx/layout_attributes"),e=y("../../lib/setcursor"),a=y("../../components/dragelement"),n=y("../../components/selections").prepSelect,r=y("../../lib"),t=y("../../registry"),h="sankey";te.name=h,te.baseLayoutAttrOverrides=A({hoverlabel:M.hoverlabel},"plot","nested"),te.plot=function(i){var x=g(i.calcdata,h)[0];S(i,x),te.updateFx(i)},te.clean=function(i,x,p,v){var f=v._has&&v._has(h),d=x._has&&x._has(h);f&&!d&&(v._paperdiv.selectAll(".sankey").remove(),v._paperdiv.selectAll(".bgsankey").remove())},te.updateFx=function(i){for(var x=0;x<i._fullData.length;x++)s(i,x)};function s(i,x){var p=i._fullData[x],v=i._fullLayout,f=v.dragmode,d=v.dragmode==="pan"?"move":"crosshair",o=p._bgRect;if(o&&!(f==="pan"||f==="zoom")){e(o,d);var m={_id:"x",c2p:r.identity,_offset:p._sankey.translateX,_length:p._sankey.width},l={_id:"y",c2p:r.identity,_offset:p._sankey.translateY,_length:p._sankey.height},w={gd:i,element:o.node(),plotinfo:{id:x,xaxis:m,yaxis:l,fillRangeItems:r.noop},subplot:x,xaxes:[m],yaxes:[l],doneFnCompleted:function(_){var c=i._fullData[x],b,u=c.node.groups.slice(),L=[];function T(I){for(var D=c._sankey.graph.nodes,R=0;R<D.length;R++)if(D[R].pointNumber===I)return D[R]}for(var k=0;k<_.length;k++){var P=T(_[k].pointNumber);if(P)if(P.group){for(var z=0;z<P.childrenNodes.length;z++)L.push(P.childrenNodes[z].pointNumber);u[P.pointNumber-c.node._count]=!1}else L.push(P.pointNumber)}b=u.filter(Boolean).concat([L]),t.call("_guiRestyle",i,{"node.groups":[b]},x)}};w.prepFn=function(_,c,b){n(_,c,b,w,f)},a.init(w)}}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(y,ee,te){var A=y("strongly-connected-components"),g=y("../../lib"),S=y("../../lib/gup").wrap,M=g.isArrayOrTypedArray,e=g.isIndex,a=y("../../components/colorscale");function n(t){var h=t.node,s=t.link,i=[],x=M(s.color),p=M(s.customdata),v={},f={},d=s.colorscales.length,o;for(o=0;o<d;o++){var m=s.colorscales[o],l=a.extractScale(m,{cLetter:"c"}),w=a.makeColorScaleFunc(l);f[m.label]=w}var _=0;for(o=0;o<s.value.length;o++)s.source[o]>_&&(_=s.source[o]),s.target[o]>_&&(_=s.target[o]);var c=_+1;t.node._count=c;var b,u=t.node.groups,L={};for(o=0;o<u.length;o++){var T=u[o];for(b=0;b<T.length;b++){var k=T[b],P=c+o;L.hasOwnProperty(k)?g.warn("Node "+k+" is already part of a group."):L[k]=P}}var z={source:[],target:[]};for(o=0;o<s.value.length;o++){var I=s.value[o],D=s.source[o],R=s.target[o];if(I>0&&e(D,c)&&e(R,c)&&!(L.hasOwnProperty(D)&&L.hasOwnProperty(R)&&L[D]===L[R])){L.hasOwnProperty(R)&&(R=L[R]),L.hasOwnProperty(D)&&(D=L[D]),D=+D,R=+R,v[D]=v[R]=!0;var O="";s.label&&s.label[o]&&(O=s.label[o]);var F=null;O&&f.hasOwnProperty(O)&&(F=f[O]),i.push({pointNumber:o,label:O,color:x?s.color[o]:s.color,customdata:p?s.customdata[o]:s.customdata,concentrationscale:F,source:D,target:R,value:+I}),z.source.push(D),z.target.push(R)}}var N=c+u.length,G=M(h.color),K=M(h.customdata),W=[];for(o=0;o<N;o++)if(v[o]){var Y=h.label[o];W.push({group:o>c-1,childrenNodes:[],pointNumber:o,label:Y,color:G?h.color[o]:h.color,customdata:K?h.customdata[o]:h.customdata})}var re=!1;return r(N,z.source,z.target)&&(re=!0),{circular:re,links:i,nodes:W,groups:u,groupLookup:L}}function r(t,h,s){for(var i=g.init2dArray(t,0),x=0;x<Math.min(h.length,s.length);x++)if(g.isIndex(h[x],t)&&g.isIndex(s[x],t)){if(h[x]===s[x])return!0;i[h[x]].push(s[x])}var p=A(i);return p.components.some(function(v){return v.length>1})}ee.exports=function(h,s){var i=n(s);return S({circular:i.circular,_nodes:i.nodes,_links:i.links,_groups:i.groups,_groupLookup:i.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(y,ee,te){ee.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("../../components/color"),M=y("tinycolor2"),e=y("../../plots/domain").defaults,a=y("../../components/fx/hoverlabel_defaults"),n=y("../../plot_api/plot_template"),r=y("../../plots/array_container_defaults");ee.exports=function(s,i,x,p){function v(T,k){return A.coerce(s,i,g,T,k)}var f=A.extendDeep(p.hoverlabel,s.hoverlabel),d=s.node,o=n.newContainer(i,"node");function m(T,k){return A.coerce(d,o,g.node,T,k)}m("label"),m("groups"),m("x"),m("y"),m("pad"),m("thickness"),m("line.color"),m("line.width"),m("hoverinfo",s.hoverinfo),a(d,o,m,f),m("hovertemplate");var l=p.colorway,w=function(T){return l[T%l.length]};m("color",o.label.map(function(T,k){return S.addOpacity(w(k),.8)})),m("customdata");var _=s.link||{},c=n.newContainer(i,"link");function b(T,k){return A.coerce(_,c,g.link,T,k)}b("label"),b("arrowlen"),b("source"),b("target"),b("value"),b("line.color"),b("line.width"),b("hoverinfo",s.hoverinfo),a(_,c,b,f),b("hovertemplate");var u=M(p.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";b("color",A.repeat(u,c.value.length)),b("customdata"),r(_,c,{name:"colorscales",handleItemDefaults:t}),e(i,p,v),v("orientation"),v("valueformat"),v("valuesuffix");var L;o.x.length&&o.y.length&&(L="freeform"),v("arrangement",L),A.coerceFont(v,"textfont",A.extendFlat({},p.font)),i._length=null};function t(h,s){function i(x,p){return A.coerce(h,s,g.link.colorscales,x,p)}i("label"),i("cmin"),i("cmax"),i("colorscale")}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),moduleType:"trace",name:"sankey",basePlotModule:y("./base_plot"),selectPoints:y("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=g.numberFormat,M=y("./render"),e=y("../../components/fx"),a=y("../../components/color"),n=y("./constants").cn,r=g._;function t(l){return l!==""}function h(l,w){return l.filter(function(_){return _.key===w.traceId})}function s(l,w){A.select(l).select("path").style("fill-opacity",w),A.select(l).select("rect").style("fill-opacity",w)}function i(l){A.select(l).select("text.name").style("fill","black")}function x(l){return function(w){return l.node.sourceLinks.indexOf(w.link)!==-1||l.node.targetLinks.indexOf(w.link)!==-1}}function p(l){return function(w){return w.node.sourceLinks.indexOf(l.link)!==-1||w.node.targetLinks.indexOf(l.link)!==-1}}function v(l,w,_){w&&_&&h(_,w).selectAll("."+n.sankeyLink).filter(x(w)).call(d.bind(0,w,_,!1))}function f(l,w,_){w&&_&&h(_,w).selectAll("."+n.sankeyLink).filter(x(w)).call(o.bind(0,w,_,!1))}function d(l,w,_,c){var b=c.datum().link.label;c.style("fill-opacity",function(u){if(!u.link.concentrationscale)return .4}),b&&h(w,l).selectAll("."+n.sankeyLink).filter(function(u){return u.link.label===b}).style("fill-opacity",function(u){if(!u.link.concentrationscale)return .4}),_&&h(w,l).selectAll("."+n.sankeyNode).filter(p(l)).call(v)}function o(l,w,_,c){var b=c.datum().link.label;c.style("fill-opacity",function(u){return u.tinyColorAlpha}),b&&h(w,l).selectAll("."+n.sankeyLink).filter(function(u){return u.link.label===b}).style("fill-opacity",function(u){return u.tinyColorAlpha}),_&&h(w,l).selectAll(n.sankeyNode).filter(p(l)).call(f)}function m(l,w){var _=l.hoverlabel||{},c=g.nestedProperty(_,w).get();return Array.isArray(c)?!1:c}ee.exports=function(w,_){for(var c=w._fullLayout,b=c._paper,u=c._size,L=0;L<w._fullData.length;L++)if(w._fullData[L].visible&&w._fullData[L].type===n.sankey&&!w._fullData[L]._viewInitial){var T=w._fullData[L].node;w._fullData[L]._viewInitial={node:{groups:T.groups.slice(),x:T.x.slice(),y:T.y.slice()}}}var k=function(re,ue){var j=ue.link;j.originalEvent=A.event,w._hoverdata=[j],e.click(w,{target:!0})},P=function(re,ue,j){w._fullLayout.hovermode!==!1&&(A.select(re).call(d.bind(0,ue,j,!0)),ue.link.trace.link.hoverinfo!=="skip"&&(ue.link.fullData=ue.link.trace,w.emit("plotly_hover",{event:A.event,points:[ue.link]})))},z=r(w,"source:")+" ",I=r(w,"target:")+" ",D=r(w,"concentration:")+" ",R=r(w,"incoming flow count:")+" ",O=r(w,"outgoing flow count:")+" ",F=function(re,ue){if(w._fullLayout.hovermode===!1)return;var j=ue.link.trace.link;if(j.hoverinfo==="none"||j.hoverinfo==="skip")return;var q=[];function H(se){var ae,oe;se.circular?(ae=(se.circularPathData.leftInnerExtent+se.circularPathData.rightInnerExtent)/2,oe=se.circularPathData.verticalFullExtent):(ae=(se.source.x1+se.target.x0)/2,oe=(se.y0+se.y1)/2);var be=[ae,oe];return se.trace.orientation==="v"&&be.reverse(),be[0]+=ue.parent.translateX,be[1]+=ue.parent.translateY,be}for(var U=0,$=0;$<ue.flow.links.length;$++){var ne=ue.flow.links[$];if(!(w._fullLayout.hovermode==="closest"&&ue.link.pointNumber!==ne.pointNumber)){ue.link.pointNumber===ne.pointNumber&&(U=$),ne.fullData=ne.trace,j=ue.link.trace.link;var X=H(ne),Q={valueLabel:S(ue.valueFormat)(ne.value)+ue.valueSuffix};q.push({x:X[0],y:X[1],name:Q.valueLabel,text:[ne.label||"",z+ne.source.label,I+ne.target.label,ne.concentrationscale?D+S("%0.2f")(ne.flow.labelConcentration):""].filter(t).join("<br>"),color:m(j,"bgcolor")||a.addOpacity(ne.color,1),borderColor:m(j,"bordercolor"),fontFamily:m(j,"font.family"),fontSize:m(j,"font.size"),fontColor:m(j,"font.color"),nameLength:m(j,"namelength"),textAlign:m(j,"align"),idealAlign:A.event.x<X[0]?"right":"left",hovertemplate:j.hovertemplate,hovertemplateLabels:Q,eventData:[ne]})}}var ie=e.loneHover(q,{container:c._hoverlayer.node(),outerContainer:c._paper.node(),gd:w,anchorIndex:U});ie.each(function(){var se=this;ue.link.concentrationscale||s(se,.65),i(se)})},N=function(re,ue,j){w._fullLayout.hovermode!==!1&&(A.select(re).call(o.bind(0,ue,j,!0)),ue.link.trace.link.hoverinfo!=="skip"&&(ue.link.fullData=ue.link.trace,w.emit("plotly_unhover",{event:A.event,points:[ue.link]})),e.loneUnhover(c._hoverlayer.node()))},G=function(re,ue,j){var q=ue.node;q.originalEvent=A.event,w._hoverdata=[q],A.select(re).call(f,ue,j),e.click(w,{target:!0})},K=function(re,ue,j){w._fullLayout.hovermode!==!1&&(A.select(re).call(v,ue,j),ue.node.trace.node.hoverinfo!=="skip"&&(ue.node.fullData=ue.node.trace,w.emit("plotly_hover",{event:A.event,points:[ue.node]})))},W=function(re,ue){if(w._fullLayout.hovermode!==!1){var j=ue.node.trace.node;if(!(j.hoverinfo==="none"||j.hoverinfo==="skip")){var q=A.select(re).select("."+n.nodeRect),H=w._fullLayout._paperdiv.node().getBoundingClientRect(),U=q.node().getBoundingClientRect(),$=U.left-2-H.left,ne=U.right+2-H.left,X=U.top+U.height/4-H.top,Q={valueLabel:S(ue.valueFormat)(ue.node.value)+ue.valueSuffix};ue.node.fullData=ue.node.trace,w._fullLayout._calcInverseTransform(w);var ie=w._fullLayout._invScaleX,se=w._fullLayout._invScaleY,ae=e.loneHover({x0:ie*$,x1:ie*ne,y:se*X,name:S(ue.valueFormat)(ue.node.value)+ue.valueSuffix,text:[ue.node.label,R+ue.node.targetLinks.length,O+ue.node.sourceLinks.length].filter(t).join("<br>"),color:m(j,"bgcolor")||ue.tinyColorHue,borderColor:m(j,"bordercolor"),fontFamily:m(j,"font.family"),fontSize:m(j,"font.size"),fontColor:m(j,"font.color"),nameLength:m(j,"namelength"),textAlign:m(j,"align"),idealAlign:"left",hovertemplate:j.hovertemplate,hovertemplateLabels:Q,eventData:[ue.node]},{container:c._hoverlayer.node(),outerContainer:c._paper.node(),gd:w});s(ae,.85),i(ae)}}},Y=function(re,ue,j){w._fullLayout.hovermode!==!1&&(A.select(re).call(f,ue,j),ue.node.trace.node.hoverinfo!=="skip"&&(ue.node.fullData=ue.node.trace,w.emit("plotly_unhover",{event:A.event,points:[ue.node]})),e.loneUnhover(c._hoverlayer.node()))};M(w,b,_,{width:u.w,height:u.h,margin:{t:u.t,r:u.r,b:u.b,l:u.l}},{linkEvents:{hover:P,follow:F,unhover:N,select:k},nodeEvents:{hover:K,follow:W,unhover:Y,select:G}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(y,ee,te){var A=y("d3-force"),g=y("d3-interpolate").interpolateNumber,S=y("@plotly/d3"),M=y("@plotly/d3-sankey"),e=y("@plotly/d3-sankey-circular"),a=y("./constants"),n=y("tinycolor2"),r=y("../../components/color"),t=y("../../components/drawing"),h=y("../../lib"),s=h.strTranslate,i=h.strRotate,x=y("../../lib/gup"),p=x.keyFun,v=x.repeat,f=x.unwrap,d=y("../../lib/svg_text_utils"),o=y("../../registry"),m=y("../../constants/alignment"),l=m.CAP_SHIFT,w=m.LINE_SPACING,_=3;function c(H,U,$){var ne=f(U),X=ne.trace,Q=X.domain,ie=X.orientation==="h",se=X.node.pad,ae=X.node.thickness,oe=H.width*(Q.x[1]-Q.x[0]),be=H.height*(Q.y[1]-Q.y[0]),ce=ne._nodes,de=ne._links,ye=ne.circular,ge;ye?ge=e.sankeyCircular().circularLinkGap(0):ge=M.sankey(),ge.iterations(a.sankeyIterations).size(ie?[oe,be]:[be,oe]).nodeWidth(ae).nodePadding(se).nodeId(function(Ft){return Ft.pointNumber}).nodes(ce).links(de);var me=ge();ge.nodePadding()<se&&h.warn("node.pad was reduced to ",ge.nodePadding()," to fit within the figure.");var Ee,Pe,Ue;for(var we in ne._groupLookup){var ke=parseInt(ne._groupLookup[we]),Xe;for(Ee=0;Ee<me.nodes.length;Ee++)if(me.nodes[Ee].pointNumber===ke){Xe=me.nodes[Ee];break}if(Xe){var Ve={pointNumber:parseInt(we),x0:Xe.x0,x1:Xe.x1,y0:Xe.y0,y1:Xe.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};me.nodes.unshift(Ve),Xe.childrenNodes.unshift(Ve)}}function Ie(){for(Ee=0;Ee<me.nodes.length;Ee++){var Ft=me.nodes[Ee],Mt={},Xt,It;for(Pe=0;Pe<Ft.targetLinks.length;Pe++)It=Ft.targetLinks[Pe],Xt=It.source.pointNumber+":"+It.target.pointNumber,Mt.hasOwnProperty(Xt)||(Mt[Xt]=[]),Mt[Xt].push(It);var At=Object.keys(Mt);for(Pe=0;Pe<At.length;Pe++){Xt=At[Pe];var Ge=Mt[Xt],tt=0,He={};for(Ue=0;Ue<Ge.length;Ue++)It=Ge[Ue],He[It.label]||(He[It.label]=0),He[It.label]+=It.value,tt+=It.value;for(Ue=0;Ue<Ge.length;Ue++)It=Ge[Ue],It.flow={value:tt,labelConcentration:He[It.label]/tt,concentration:It.value/tt,links:Ge},It.concentrationscale&&(It.color=n(It.concentrationscale(It.flow.labelConcentration)))}var Ae=0;for(Pe=0;Pe<Ft.sourceLinks.length;Pe++)Ae+=Ft.sourceLinks[Pe].value;for(Pe=0;Pe<Ft.sourceLinks.length;Pe++)It=Ft.sourceLinks[Pe],It.concentrationOut=It.value/Ae;var Ne=0;for(Pe=0;Pe<Ft.targetLinks.length;Pe++)Ne+=Ft.targetLinks[Pe].value;for(Pe=0;Pe<Ft.targetLinks.length;Pe++)It=Ft.targetLinks[Pe],It.concenrationIn=It.value/Ne}}Ie();function De(Ft){Ft.forEach(function(Mt){var Xt,It,At=0,Ge=Mt.length,tt;for(Mt.sort(function(He,Ae){return He.y0-Ae.y0}),tt=0;tt<Ge;++tt)Xt=Mt[tt],Xt.y0>=At||(It=At-Xt.y0,It>1e-6&&(Xt.y0+=It,Xt.y1+=It)),At=Xt.y1+se})}function Ye(Ft){var Mt=Ft.map(function(Ae,Ne){return{x0:Ae.x0,index:Ne}}).sort(function(Ae,Ne){return Ae.x0-Ne.x0}),Xt=[],It=-1,At,Ge=-1/0,tt;for(Ee=0;Ee<Mt.length;Ee++){var He=Ft[Mt[Ee].index];He.x0>Ge+ae&&(It+=1,At=He.x0),Ge=He.x0,Xt[It]||(Xt[It]=[]),Xt[It].push(He),tt=At-He.x0,He.x0+=tt,He.x1+=tt}return Xt}if(X.node.x.length&&X.node.y.length){for(Ee=0;Ee<Math.min(X.node.x.length,X.node.y.length,me.nodes.length);Ee++)if(X.node.x[Ee]&&X.node.y[Ee]){var vt=[X.node.x[Ee]*oe,X.node.y[Ee]*be];me.nodes[Ee].x0=vt[0]-ae/2,me.nodes[Ee].x1=vt[0]+ae/2;var Dt=me.nodes[Ee].y1-me.nodes[Ee].y0;me.nodes[Ee].y0=vt[1]-Dt/2,me.nodes[Ee].y1=vt[1]+Dt/2}if(X.arrangement==="snap"){ce=me.nodes;var Kt=Ye(ce);De(Kt)}ge.update(me)}return{circular:ye,key:$,trace:X,guid:h.randstr(),horizontal:ie,width:oe,height:be,nodePad:X.node.pad,nodeLineColor:X.node.line.color,nodeLineWidth:X.node.line.width,linkLineColor:X.link.line.color,linkLineWidth:X.link.line.width,linkArrowLength:X.link.arrowlen,valueFormat:X.valueformat,valueSuffix:X.valuesuffix,textFont:X.textfont,translateX:Q.x[0]*H.width+H.margin.l,translateY:H.height-Q.y[1]*H.height+H.margin.t,dragParallel:ie?be:oe,dragPerpendicular:ie?oe:be,arrangement:X.arrangement,sankey:ge,graph:me,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function b(H,U,$){var ne=n(U.color),X=U.source.label+"|"+U.target.label,Q=X+"__"+$;return U.trace=H.trace,U.curveNumber=H.trace.index,{circular:H.circular,key:Q,traceId:H.key,pointNumber:U.pointNumber,link:U,tinyColorHue:r.tinyRGB(ne),tinyColorAlpha:ne.getAlpha(),linkPath:L,linkLineColor:H.linkLineColor,linkLineWidth:H.linkLineWidth,linkArrowLength:H.linkArrowLength,valueFormat:H.valueFormat,valueSuffix:H.valueSuffix,sankey:H.sankey,parent:H,interactionState:H.interactionState,flow:U.flow}}function u(H,U){var $="",ne=H.width/2,X=H.circularPathData;return H.circularLinkType==="top"?$="M "+(X.targetX-U)+" "+(X.targetY+ne)+" L"+(X.rightInnerExtent-U)+" "+(X.targetY+ne)+"A"+(X.rightLargeArcRadius+ne)+" "+(X.rightSmallArcRadius+ne)+" 0 0 1 "+(X.rightFullExtent-ne-U)+" "+(X.targetY-X.rightSmallArcRadius)+"L"+(X.rightFullExtent-ne-U)+" "+X.verticalRightInnerExtent+"A"+(X.rightLargeArcRadius+ne)+" "+(X.rightLargeArcRadius+ne)+" 0 0 1 "+(X.rightInnerExtent-U)+" "+(X.verticalFullExtent-ne)+"L"+X.leftInnerExtent+" "+(X.verticalFullExtent-ne)+"A"+(X.leftLargeArcRadius+ne)+" "+(X.leftLargeArcRadius+ne)+" 0 0 1 "+(X.leftFullExtent+ne)+" "+X.verticalLeftInnerExtent+"L"+(X.leftFullExtent+ne)+" "+(X.sourceY-X.leftSmallArcRadius)+"A"+(X.leftLargeArcRadius+ne)+" "+(X.leftSmallArcRadius+ne)+" 0 0 1 "+X.leftInnerExtent+" "+(X.sourceY+ne)+"L"+X.sourceX+" "+(X.sourceY+ne)+"L"+X.sourceX+" "+(X.sourceY-ne)+"L"+X.leftInnerExtent+" "+(X.sourceY-ne)+"A"+(X.leftLargeArcRadius-ne)+" "+(X.leftSmallArcRadius-ne)+" 0 0 0 "+(X.leftFullExtent-ne)+" "+(X.sourceY-X.leftSmallArcRadius)+"L"+(X.leftFullExtent-ne)+" "+X.verticalLeftInnerExtent+"A"+(X.leftLargeArcRadius-ne)+" "+(X.leftLargeArcRadius-ne)+" 0 0 0 "+X.leftInnerExtent+" "+(X.verticalFullExtent+ne)+"L"+(X.rightInnerExtent-U)+" "+(X.verticalFullExtent+ne)+"A"+(X.rightLargeArcRadius-ne)+" "+(X.rightLargeArcRadius-ne)+" 0 0 0 "+(X.rightFullExtent+ne-U)+" "+X.verticalRightInnerExtent+"L"+(X.rightFullExtent+ne-U)+" "+(X.targetY-X.rightSmallArcRadius)+"A"+(X.rightLargeArcRadius-ne)+" "+(X.rightSmallArcRadius-ne)+" 0 0 0 "+(X.rightInnerExtent-U)+" "+(X.targetY-ne)+"L"+(X.targetX-U)+" "+(X.targetY-ne)+(U>0?"L"+X.targetX+" "+X.targetY:"")+"Z":$="M "+(X.targetX-U)+" "+(X.targetY-ne)+" L"+(X.rightInnerExtent-U)+" "+(X.targetY-ne)+"A"+(X.rightLargeArcRadius+ne)+" "+(X.rightSmallArcRadius+ne)+" 0 0 0 "+(X.rightFullExtent-ne-U)+" "+(X.targetY+X.rightSmallArcRadius)+"L"+(X.rightFullExtent-ne-U)+" "+X.verticalRightInnerExtent+"A"+(X.rightLargeArcRadius+ne)+" "+(X.rightLargeArcRadius+ne)+" 0 0 0 "+(X.rightInnerExtent-U)+" "+(X.verticalFullExtent+ne)+"L"+X.leftInnerExtent+" "+(X.verticalFullExtent+ne)+"A"+(X.leftLargeArcRadius+ne)+" "+(X.leftLargeArcRadius+ne)+" 0 0 0 "+(X.leftFullExtent+ne)+" "+X.verticalLeftInnerExtent+"L"+(X.leftFullExtent+ne)+" "+(X.sourceY+X.leftSmallArcRadius)+"A"+(X.leftLargeArcRadius+ne)+" "+(X.leftSmallArcRadius+ne)+" 0 0 0 "+X.leftInnerExtent+" "+(X.sourceY-ne)+"L"+X.sourceX+" "+(X.sourceY-ne)+"L"+X.sourceX+" "+(X.sourceY+ne)+"L"+X.leftInnerExtent+" "+(X.sourceY+ne)+"A"+(X.leftLargeArcRadius-ne)+" "+(X.leftSmallArcRadius-ne)+" 0 0 1 "+(X.leftFullExtent-ne)+" "+(X.sourceY+X.leftSmallArcRadius)+"L"+(X.leftFullExtent-ne)+" "+X.verticalLeftInnerExtent+"A"+(X.leftLargeArcRadius-ne)+" "+(X.leftLargeArcRadius-ne)+" 0 0 1 "+X.leftInnerExtent+" "+(X.verticalFullExtent-ne)+"L"+(X.rightInnerExtent-U)+" "+(X.verticalFullExtent-ne)+"A"+(X.rightLargeArcRadius-ne)+" "+(X.rightLargeArcRadius-ne)+" 0 0 1 "+(X.rightFullExtent+ne-U)+" "+X.verticalRightInnerExtent+"L"+(X.rightFullExtent+ne-U)+" "+(X.targetY+X.rightSmallArcRadius)+"A"+(X.rightLargeArcRadius-ne)+" "+(X.rightSmallArcRadius-ne)+" 0 0 1 "+(X.rightInnerExtent-U)+" "+(X.targetY+ne)+"L"+(X.targetX-U)+" "+(X.targetY+ne)+(U>0?"L"+X.targetX+" "+X.targetY:"")+"Z",$}function L(){var H=.5;function U($){var ne=$.linkArrowLength;if($.link.circular)return u($.link,ne);var X=Math.abs(($.link.target.x0-$.link.source.x1)/2);ne>X&&(ne=X);var Q=$.link.source.x1,ie=$.link.target.x0-ne,se=g(Q,ie),ae=se(H),oe=se(1-H),be=$.link.y0-$.link.width/2,ce=$.link.y0+$.link.width/2,de=$.link.y1-$.link.width/2,ye=$.link.y1+$.link.width/2,ge="M"+Q+","+be,me="C"+ae+","+be+" "+oe+","+de+" "+ie+","+de,Ee="C"+oe+","+ye+" "+ae+","+ce+" "+Q+","+ce,Pe=ne>0?"L"+(ie+ne)+","+(de+$.link.width/2):"";return Pe+="L"+ie+","+ye,ge+me+Pe+Ee+"Z"}return U}function T(H,U){var $=n(U.color),ne=a.nodePadAcross,X=H.nodePad/2;U.dx=U.x1-U.x0,U.dy=U.y1-U.y0;var Q=U.dx,ie=Math.max(.5,U.dy),se="node_"+U.pointNumber;return U.group&&(se=h.randstr()),U.trace=H.trace,U.curveNumber=H.trace.index,{index:U.pointNumber,key:se,partOfGroup:U.partOfGroup||!1,group:U.group,traceId:H.key,trace:H.trace,node:U,nodePad:H.nodePad,nodeLineColor:H.nodeLineColor,nodeLineWidth:H.nodeLineWidth,textFont:H.textFont,size:H.horizontal?H.height:H.width,visibleWidth:Math.ceil(Q),visibleHeight:ie,zoneX:-ne,zoneY:-X,zoneWidth:Q+2*ne,zoneHeight:ie+2*X,labelY:H.horizontal?U.dy/2+1:U.dx/2+1,left:U.originalLayer===1,sizeAcross:H.width,forceLayouts:H.forceLayouts,horizontal:H.horizontal,darkBackground:$.getBrightness()<=128,tinyColorHue:r.tinyRGB($),tinyColorAlpha:$.getAlpha(),valueFormat:H.valueFormat,valueSuffix:H.valueSuffix,sankey:H.sankey,graph:H.graph,arrangement:H.arrangement,uniqueNodeLabelPathId:[H.guid,H.key,se].join("_"),interactionState:H.interactionState,figure:H}}function k(H){H.attr("transform",function(U){return s(U.node.x0.toFixed(3),U.node.y0.toFixed(3))})}function P(H){H.call(k)}function z(H,U){H.call(P),U.attr("d",L())}function I(H){H.attr("width",function(U){return U.node.x1-U.node.x0}).attr("height",function(U){return U.visibleHeight})}function D(H){return H.link.width>1||H.linkLineWidth>0}function R(H){var U=s(H.translateX,H.translateY);return U+(H.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function O(H,U,$){H.on(".basic",null).on("mouseover.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&($.hover(this,ne,U),ne.interactionState.hovered=[this,ne])}).on("mousemove.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&($.follow(this,ne),ne.interactionState.hovered=[this,ne])}).on("mouseout.basic",function(ne){!ne.interactionState.dragInProgress&&!ne.partOfGroup&&($.unhover(this,ne,U),ne.interactionState.hovered=!1)}).on("click.basic",function(ne){ne.interactionState.hovered&&($.unhover(this,ne,U),ne.interactionState.hovered=!1),!ne.interactionState.dragInProgress&&!ne.partOfGroup&&$.select(this,ne,U)})}function F(H,U,$,ne){var X=S.behavior.drag().origin(function(Q){return{x:Q.node.x0+Q.visibleWidth/2,y:Q.node.y0+Q.visibleHeight/2}}).on("dragstart",function(Q){if(Q.arrangement!=="fixed"&&(h.ensureSingle(ne._fullLayout._infolayer,"g","dragcover",function(se){ne._fullLayout._dragCover=se}),h.raiseToTop(this),Q.interactionState.dragInProgress=Q.node,re(Q.node),Q.interactionState.hovered&&($.nodeEvents.unhover.apply(0,Q.interactionState.hovered),Q.interactionState.hovered=!1),Q.arrangement==="snap")){var ie=Q.traceId+"|"+Q.key;Q.forceLayouts[ie]?Q.forceLayouts[ie].alpha(1):N(H,ie,Q),G(H,U,Q,ie,ne)}}).on("drag",function(Q){if(Q.arrangement!=="fixed"){var ie=S.event.x,se=S.event.y;Q.arrangement==="snap"?(Q.node.x0=ie-Q.visibleWidth/2,Q.node.x1=ie+Q.visibleWidth/2,Q.node.y0=se-Q.visibleHeight/2,Q.node.y1=se+Q.visibleHeight/2):(Q.arrangement==="freeform"&&(Q.node.x0=ie-Q.visibleWidth/2,Q.node.x1=ie+Q.visibleWidth/2),se=Math.max(0,Math.min(Q.size-Q.visibleHeight/2,se)),Q.node.y0=se-Q.visibleHeight/2,Q.node.y1=se+Q.visibleHeight/2),re(Q.node),Q.arrangement!=="snap"&&(Q.sankey.update(Q.graph),z(H.filter(ue(Q)),U))}}).on("dragend",function(Q){if(Q.arrangement!=="fixed"){Q.interactionState.dragInProgress=!1;for(var ie=0;ie<Q.node.childrenNodes.length;ie++)Q.node.childrenNodes[ie].x=Q.node.x,Q.node.childrenNodes[ie].y=Q.node.y;Q.arrangement!=="snap"&&W(Q,ne)}});H.on(".drag",null).call(X)}function N(H,U,$,ne){j($.graph.nodes);var X=$.graph.nodes.filter(function(Q){return Q.originalX===$.node.originalX}).filter(function(Q){return!Q.partOfGroup});$.forceLayouts[U]=A.forceSimulation(X).alphaDecay(0).force("collide",A.forceCollide().radius(function(Q){return Q.dy/2+$.nodePad/2}).strength(1).iterations(a.forceIterations)).force("constrain",K(H,U,X,$)).stop()}function G(H,U,$,ne,X){window.requestAnimationFrame(function Q(){var ie;for(ie=0;ie<a.forceTicksPerFrame;ie++)$.forceLayouts[ne].tick();var se=$.graph.nodes;if(q(se),$.sankey.update($.graph),z(H.filter(ue($)),U),$.forceLayouts[ne].alpha()>0)window.requestAnimationFrame(Q);else{var ae=$.node.originalX;$.node.x0=ae-$.visibleWidth/2,$.node.x1=ae+$.visibleWidth/2,W($,X)}})}function K(H,U,$,ne){return function(){for(var Q=0,ie=0;ie<$.length;ie++){var se=$[ie];se===ne.interactionState.dragInProgress?(se.x=se.lastDraggedX,se.y=se.lastDraggedY):(se.vx=(se.originalX-se.x)/a.forceTicksPerFrame,se.y=Math.min(ne.size-se.dy/2,Math.max(se.dy/2,se.y))),Q=Math.max(Q,Math.abs(se.vx),Math.abs(se.vy))}!ne.interactionState.dragInProgress&&Q<.1&&ne.forceLayouts[U].alpha()>0&&ne.forceLayouts[U].alpha(0)}}function W(H,U){for(var $=[],ne=[],X=0;X<H.graph.nodes.length;X++){var Q=(H.graph.nodes[X].x0+H.graph.nodes[X].x1)/2,ie=(H.graph.nodes[X].y0+H.graph.nodes[X].y1)/2;$.push(Q/H.figure.width),ne.push(ie/H.figure.height)}o.call("_guiRestyle",U,{"node.x":[$],"node.y":[ne]},H.trace.index).then(function(){U._fullLayout._dragCover&&U._fullLayout._dragCover.remove()})}function Y(H){var U=[],$;for($=0;$<H.length;$++)H[$].originalX=(H[$].x0+H[$].x1)/2,H[$].originalY=(H[$].y0+H[$].y1)/2,U.indexOf(H[$].originalX)===-1&&U.push(H[$].originalX);for(U.sort(function(ne,X){return ne-X}),$=0;$<H.length;$++)H[$].originalLayerIndex=U.indexOf(H[$].originalX),H[$].originalLayer=H[$].originalLayerIndex/(U.length-1)}function re(H){H.lastDraggedX=H.x0+H.dx/2,H.lastDraggedY=H.y0+H.dy/2}function ue(H){return function(U){return U.node.originalX===H.node.originalX}}function j(H){for(var U=0;U<H.length;U++)H[U].y=(H[U].y0+H[U].y1)/2,H[U].x=(H[U].x0+H[U].x1)/2}function q(H){for(var U=0;U<H.length;U++)H[U].y0=H[U].y-H[U].dy/2,H[U].y1=H[U].y0+H[U].dy,H[U].x0=H[U].x-H[U].dx/2,H[U].x1=H[U].x0+H[U].dx}ee.exports=function(H,U,$,ne,X){var Q=H._context.staticPlot,ie=!1;h.ensureSingle(H._fullLayout._infolayer,"g","first-render",function(){ie=!0});var se=H._fullLayout._dragCover,ae=$.filter(function(Ee){return f(Ee).trace.visible}).map(c.bind(null,ne)),oe=U.selectAll("."+a.cn.sankey).data(ae,p);oe.exit().remove(),oe.enter().append("g").classed(a.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events",Q?"none":"auto").attr("transform",R),oe.each(function(Ee,Pe){H._fullData[Pe]._sankey=Ee;var Ue="bgsankey-"+Ee.trace.uid+"-"+Pe;h.ensureSingle(H._fullLayout._draggers,"rect",Ue),H._fullData[Pe]._bgRect=S.select("."+Ue),H._fullData[Pe]._bgRect.style("pointer-events",Q?"none":"all").attr("width",Ee.width).attr("height",Ee.height).attr("x",Ee.translateX).attr("y",Ee.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),oe.transition().ease(a.ease).duration(a.duration).attr("transform",R);var be=oe.selectAll("."+a.cn.sankeyLinks).data(v,p);be.enter().append("g").classed(a.cn.sankeyLinks,!0).style("fill","none");var ce=be.selectAll("."+a.cn.sankeyLink).data(function(Ee){var Pe=Ee.graph.links;return Pe.filter(function(Ue){return Ue.value}).map(b.bind(null,Ee))},p);ce.enter().append("path").classed(a.cn.sankeyLink,!0).call(O,oe,X.linkEvents),ce.style("stroke",function(Ee){return D(Ee)?r.tinyRGB(n(Ee.linkLineColor)):Ee.tinyColorHue}).style("stroke-opacity",function(Ee){return D(Ee)?r.opacity(Ee.linkLineColor):Ee.tinyColorAlpha}).style("fill",function(Ee){return Ee.tinyColorHue}).style("fill-opacity",function(Ee){return Ee.tinyColorAlpha}).style("stroke-width",function(Ee){return D(Ee)?Ee.linkLineWidth:1}).attr("d",L()),ce.style("opacity",function(){return H._context.staticPlot||ie||se?1:0}).transition().ease(a.ease).duration(a.duration).style("opacity",1),ce.exit().transition().ease(a.ease).duration(a.duration).style("opacity",0).remove();var de=oe.selectAll("."+a.cn.sankeyNodeSet).data(v,p);de.enter().append("g").classed(a.cn.sankeyNodeSet,!0),de.style("cursor",function(Ee){switch(Ee.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var ye=de.selectAll("."+a.cn.sankeyNode).data(function(Ee){var Pe=Ee.graph.nodes;return Y(Pe),Pe.map(T.bind(null,Ee))},p);ye.enter().append("g").classed(a.cn.sankeyNode,!0).call(k).style("opacity",function(Ee){return(H._context.staticPlot||ie)&&!Ee.partOfGroup?1:0}),ye.call(O,oe,X.nodeEvents).call(F,ce,X,H),ye.transition().ease(a.ease).duration(a.duration).call(k).style("opacity",function(Ee){return Ee.partOfGroup?0:1}),ye.exit().transition().ease(a.ease).duration(a.duration).style("opacity",0).remove();var ge=ye.selectAll("."+a.cn.nodeRect).data(v);ge.enter().append("rect").classed(a.cn.nodeRect,!0).call(I),ge.style("stroke-width",function(Ee){return Ee.nodeLineWidth}).style("stroke",function(Ee){return r.tinyRGB(n(Ee.nodeLineColor))}).style("stroke-opacity",function(Ee){return r.opacity(Ee.nodeLineColor)}).style("fill",function(Ee){return Ee.tinyColorHue}).style("fill-opacity",function(Ee){return Ee.tinyColorAlpha}),ge.transition().ease(a.ease).duration(a.duration).call(I);var me=ye.selectAll("."+a.cn.nodeLabel).data(v);me.enter().append("text").classed(a.cn.nodeLabel,!0).style("cursor","default"),me.attr("data-notex",1).text(function(Ee){return Ee.node.label}).each(function(Ee){var Pe=S.select(this);t.font(Pe,Ee.textFont),d.convertToTspans(Pe,H)}).style("text-shadow",d.makeTextShadow(H._fullLayout.paper_bgcolor)).attr("text-anchor",function(Ee){return Ee.horizontal&&Ee.left?"end":"start"}).attr("transform",function(Ee){var Pe=S.select(this),Ue=d.lineCount(Pe),we=Ee.textFont.size*((Ue-1)*w-l),ke=Ee.nodeLineWidth/2+_,Xe=((Ee.horizontal?Ee.visibleHeight:Ee.visibleWidth)-we)/2;Ee.horizontal&&(Ee.left?ke=-ke:ke+=Ee.visibleWidth);var Ve=Ee.horizontal?"":"scale(-1,1)"+i(90);return s(Ee.horizontal?ke:Xe,Ee.horizontal?Xe:ke)+Ve}),me.transition().ease(a.ease).duration(a.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(y,ee,te){ee.exports=function(g,S){for(var M=g.cd,e=[],a=M[0].trace,n=a._sankey.graph.nodes,r=0;r<n.length;r++){var t=n[r];if(!t.partOfGroup){var h=[(t.x0+t.x1)/2,(t.y0+t.y1)/2];a.orientation==="v"&&h.reverse(),S&&S.contains(h,!1,r,g)&&e.push({pointNumber:t.pointNumber})}}return e}},{}],935:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){for(var e=0;e<S.length;e++)S[e].i=e;A.mergeArray(M.text,S,"tx"),A.mergeArray(M.texttemplate,S,"txt"),A.mergeArray(M.hovertext,S,"htx"),A.mergeArray(M.customdata,S,"data"),A.mergeArray(M.textposition,S,"tp"),M.textfont&&(A.mergeArrayCastPositive(M.textfont.size,S,"ts"),A.mergeArray(M.textfont.color,S,"tc"),A.mergeArray(M.textfont.family,S,"tf"));var a=M.marker;if(a){A.mergeArrayCastPositive(a.size,S,"ms"),A.mergeArrayCastPositive(a.opacity,S,"mo"),A.mergeArray(a.symbol,S,"mx"),A.mergeArray(a.angle,S,"ma"),A.mergeArray(a.standoff,S,"mf"),A.mergeArray(a.color,S,"mc");var n=a.line;a.line&&(A.mergeArray(n.color,S,"mlc"),A.mergeArrayCastPositive(n.width,S,"mlw"));var r=a.gradient;r&&r.type!=="none"&&(A.mergeArray(r.type,S,"mgt"),A.mergeArray(r.color,S,"mgc"))}}},{"../../lib":515}],936:[function(y,ee,te){var A=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=y("../../plots/template_attributes").texttemplateAttrs,S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../../components/colorscale/attributes"),e=y("../../plots/font_attributes"),a=y("../../components/drawing/attributes").dash,n=y("../../components/drawing/attributes").pattern,r=y("../../components/drawing"),t=y("./constants"),h=y("../../lib/extend").extendFlat;function s(p){return{valType:"any",dflt:0,editType:"calc"}}function i(p){return{valType:"any",editType:"calc"}}function x(p){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}ee.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:s(),yperiod:s(),xperiod0:i(),yperiod0:i(),xperiodalignment:x(),yperiodalignment:x(),xhoverformat:A("x"),yhoverformat:A("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:g({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:S({},{keys:t.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:h({},a,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:n,marker:h({symbol:{valType:"enumerated",values:r.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:h({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},M("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},M("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../plots/cartesian/axes"),M=y("../../plots/cartesian/align_period"),e=y("../../constants/numerical").BADNUM,a=y("./subtypes"),n=y("./colorscale_calc"),r=y("./arrays_to_calcdata"),t=y("./calc_selection");function h(f,d){var o=f._fullLayout,m=d._xA=S.getFromId(f,d.xaxis||"x","x"),l=d._yA=S.getFromId(f,d.yaxis||"y","y"),w=m.makeCalcdata(d,"x"),_=l.makeCalcdata(d,"y"),c=M(d,m,"x",w),b=M(d,l,"y",_),u=c.vals,L=b.vals,T=d._length,k=new Array(T),P=d.ids,z=v(d,o,m,l),I=!1,D,R,O,F,N,G;x(o,d);var K="x",W="y",Y;if(z)g.pushUnique(z.traceIndices,d._expandedIndex),D=z.orientation==="v",D?(W="s",Y="x"):(K="s",Y="y"),N=z.stackgaps==="interpolate";else{var re=i(d,T);s(f,d,m,l,u,L,re)}var ue=!!d.xperiodalignment,j=!!d.yperiodalignment;for(R=0;R<T;R++){var q=k[R]={},H=A(u[R]),U=A(L[R]);H&&U?(q[K]=u[R],q[W]=L[R],ue&&(q.orig_x=w[R],q.xEnd=c.ends[R],q.xStart=c.starts[R]),j&&(q.orig_y=_[R],q.yEnd=b.ends[R],q.yStart=b.starts[R])):z&&(D?H:U)?(q[Y]=D?u[R]:L[R],q.gap=!0,N?(q.s=e,I=!0):q.s=0):q[K]=q[W]=e,P&&(q.id=String(P[R]))}if(r(k,d),n(f,d),t(k,d),z){for(R=0;R<k.length;)k[R][Y]===e?k.splice(R,1):R++;if(g.sort(k,function(Q,ie){return Q[Y]-ie[Y]||Q.i-ie.i}),I){for(R=0;R<k.length-1&&k[R].gap;)R++;for(G=k[R].s,G||(G=k[R].s=0),O=0;O<R;O++)k[O].s=G;for(F=k.length-1;F>R&&k[F].gap;)F--;for(G=k[F].s,O=k.length-1;O>F;O--)k[O].s=G;for(;R<F;)if(R++,k[R].gap){for(O=R+1;k[O].gap;)O++;for(var $=k[R-1][Y],ne=k[R-1].s,X=(k[O].s-ne)/(k[O][Y]-$);R<O;)k[R].s=ne+(k[R][Y]-$)*X,R++}}}return k}function s(f,d,o,m,l,w,_){var c=d._length,b=f._fullLayout,u=o._id,L=m._id,T=b._firstScatter[p(d)]===d.uid,k=(v(d,b,o,m)||{}).orientation,P=d.fill;o._minDtick=0,m._minDtick=0;var z={padded:!0},I={padded:!0};_&&(z.ppad=I.ppad=_);var D=c<2||l[0]!==l[c-1]||w[0]!==w[c-1];D&&(P==="tozerox"||P==="tonextx"&&(T||k==="h"))?z.tozero=!0:!(d.error_y||{}).visible&&(P==="tonexty"||P==="tozeroy"||!a.hasMarkers(d)&&!a.hasText(d))&&(z.padded=!1,z.ppad=0),D&&(P==="tozeroy"||P==="tonexty"&&(T||k==="v"))?I.tozero=!0:(P==="tonextx"||P==="tozerox")&&(I.padded=!1),u&&(d._extremes[u]=S.findExtremes(o,l,z)),L&&(d._extremes[L]=S.findExtremes(m,w,I))}function i(f,d){if(a.hasMarkers(f)){var o=f.marker,m=1.6*(f.marker.sizeref||1),l;if(f.marker.sizemode==="area"?l=function(u){return Math.max(Math.sqrt((u||0)/m),3)}:l=function(u){return Math.max((u||0)/m,3)},g.isArrayOrTypedArray(o.size)){var w={type:"linear"};S.setConvert(w);for(var _=w.makeCalcdata(f.marker,"size"),c=new Array(d),b=0;b<d;b++)c[b]=l(_[b]);return c}else return l(o.size)}}function x(f,d){var o=p(d),m=f._firstScatter;m[o]||(m[o]=d.uid)}function p(f){var d=f.stackgroup;return f.xaxis+f.yaxis+f.type+(d?"-"+d:"")}function v(f,d,o,m){var l=f.stackgroup;if(l){var w=d._scatterStackOpts[o._id+m._id][l],_=w.orientation==="v"?m:o;if(_.type==="linear"||_.type==="log")return w}}ee.exports={calc:h,calcMarkerSize:i,calcAxisExpansion:s,setFirstScatter:x,getStackOpts:v}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){A.isArrayOrTypedArray(M.selectedpoints)&&A.tagSelected(S,M)}},{"../../lib":515}],939:[function(y,ee,te){var A=y("../../components/colorscale/helpers").hasColorscale,g=y("../../components/colorscale/calc"),S=y("./subtypes");ee.exports=function(e,a){S.hasLines(a)&&A(a,"line")&&g(e,a,{vals:a.line.color,containerStr:"line",cLetter:"c"}),S.hasMarkers(a)&&(A(a,"marker")&&g(e,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),A(a,"marker.line")&&g(e,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(y,ee,te){ee.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(y,ee,te){var A=y("./calc");ee.exports=function(e,a){var n=a.xaxis,r=a.yaxis,t=n._id+r._id,h=e._fullLayout._scatterStackOpts[t];if(h){var s=e.calcdata,i,x,p,v,f,d,o,m,l,w,_,c,b,u,L;for(var T in h){w=h[T];var k=w.traceIndices;if(k.length){for(_=w.stackgaps==="interpolate",c=w.groupnorm,w.orientation==="v"?(b="x",u="y"):(b="y",u="x"),L=new Array(k.length),i=0;i<L.length;i++)L[i]=!1;d=s[k[0]];var P=new Array(d.length);for(i=0;i<d.length;i++)P[i]=d[i][b];for(i=1;i<k.length;i++){for(f=s[k[i]],x=p=0;x<f.length;x++){for(o=f[x][b];o>P[p]&&p<P.length;p++)g(f,x,P[p],i,L,_,b),x++;if(o!==P[p]){for(v=0;v<i;v++)g(s[k[v]],p,o,v,L,_,b);P.splice(p,0,o)}p++}for(;p<P.length;p++)g(f,x,P[p],i,L,_,b),x++}var z=P.length;for(x=0;x<d.length;x++){for(m=d[x][u]=d[x].s,i=1;i<k.length;i++)f=s[k[i]],f[0].trace._rawLength=f[0].trace._length,f[0].trace._length=z,m+=f[x].s,f[x][u]=m;if(c)for(l=(c==="fraction"?m:m/100)||1,i=0;i<k.length;i++){var I=s[k[i]][x];I[u]/=l,I.sNorm=I.s/l}}for(i=0;i<k.length;i++){f=s[k[i]];var D=f[0].trace,R=A.calcMarkerSize(D,D._rawLength),O=Array.isArray(R);if(R&&L[i]||O){var F=R;for(R=new Array(z),x=0;x<z;x++)R[x]=f[x].gap?0:O?F[f[x].i]:F}var N=new Array(z),G=new Array(z);for(x=0;x<z;x++)N[x]=f[x].x,G[x]=f[x].y;A.calcAxisExpansion(e,D,n,r,N,G,R),f[0].t.orientation=w.orientation}}}}};function g(M,e,a,n,r,t,h){r[n]=!0;var s={i:null,gap:!0,s:0};if(s[h]=a,M.splice(e,0,s),e&&a===M[e-1][h]){var i=M[e-1];s.s=i.s,s.i=i.i,s.gap=i.gap}else t&&(s.s=S(M,e,a,h));e||(M[0].t=M[1].t,M[0].trace=M[1].trace,delete M[1].t,delete M[1].trace)}function S(M,e,a,n){var r=M[e-1],t=M[e+1];return t?r?r.s+(t.s-r.s)*(a-r[n])/(t[n]-r[n]):t.s:r.s}},{"./calc":937}],942:[function(y,ee,te){ee.exports=function(g){for(var S=0;S<g.length;S++){var M=g[S];if(M.type==="scatter"){var e=M.fill;if(!(e==="none"||e==="toself")&&(M.opacity=void 0,e==="tonexty"||e==="tonextx"))for(var a=S-1;a>=0;a--){var n=g[a];if(n.type==="scatter"&&n.xaxis===M.xaxis&&n.yaxis===M.yaxis){n.opacity=void 0;break}}}}}},{}],943:[function(y,ee,te){var A=y("../../lib"),g=y("../../registry"),S=y("./attributes"),M=y("./constants"),e=y("./subtypes"),a=y("./xy_defaults"),n=y("./period_defaults"),r=y("./stack_defaults"),t=y("./marker_defaults"),h=y("./line_defaults"),s=y("./line_shape_defaults"),i=y("./text_defaults"),x=y("./fillcolor_defaults"),p=y("../../lib").coercePattern;ee.exports=function(f,d,o,m){function l(k,P){return A.coerce(f,d,S,k,P)}var w=a(f,d,m,l);if(w||(d.visible=!1),!!d.visible){n(f,d,m,l),l("xhoverformat"),l("yhoverformat");var _=r(f,d,m,l),c=!_&&w<M.PTS_LINESONLY?"lines+markers":"lines";l("text"),l("hovertext"),l("mode",c),e.hasLines(d)&&(h(f,d,o,m,l,{backoff:!0}),s(f,d,l),l("connectgaps"),l("line.simplify")),e.hasMarkers(d)&&t(f,d,o,m,l,{gradient:!0}),e.hasText(d)&&(l("texttemplate"),i(f,d,m,l));var b=[];(e.hasMarkers(d)||e.hasText(d))&&(l("cliponaxis"),l("marker.maxdisplayed"),b.push("points")),l("fill",_?_.fillDflt:"none"),d.fill!=="none"&&(x(f,d,o,l),e.hasLines(d)||s(f,d,l),p(l,"fillpattern",d.fillcolor,!1));var u=(d.line||{}).color,L=(d.marker||{}).color;(d.fill==="tonext"||d.fill==="toself")&&b.push("fills"),l("hoveron",b.join("+")||"points"),d.hoveron!=="fills"&&l("hovertemplate");var T=g.getComponentMethod("errorbars","supplyDefaults");T(f,d,u||L||o,{axis:"y"}),T(f,d,u||L||o,{axis:"x",inherit:"y"}),A.coerceSelectionMarkerOpacity(d,l)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(y,ee,te){var A=y("../../components/color"),g=y("../../lib").isArrayOrTypedArray;ee.exports=function(M,e,a,n){var r=!1;if(e.marker){var t=e.marker.color,h=(e.marker.line||{}).color;t&&!g(t)?r=t:h&&!g(h)&&(r=h)}n("fillcolor",A.addOpacity((e.line||{}).color||r||a,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(y,ee,te){var A=y("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n={_fullLayout:e},r=A.getFromTrace(n,M,"x"),t=A.getFromTrace(n,M,"y");return a.xLabel=A.tickText(r,r.c2l(S.x),!0).text,a.yLabel=A.tickText(t,t.c2l(S.y),!0).text,a}},{"../../plots/cartesian/axes":566}],946:[function(y,ee,te){var A=y("../../components/color"),g=y("./subtypes");ee.exports=function(M,e){var a,n;if(M.mode==="lines")return a=M.line.color,a&&A.opacity(a)?a:M.fillcolor;if(M.mode==="none")return M.fill?M.fillcolor:"";var r=e.mcc||(M.marker||{}).color,t=e.mlcc||((M.marker||{}).line||{}).color;return n=r&&A.opacity(r)?r:t&&A.opacity(t)&&(e.mlw||((M.marker||{}).line||{}).width)?t:"",n?A.opacity(n)<.3?A.addOpacity(n,.3):n:(a=(M.line||{}).color,a&&A.opacity(a)&&g.hasLines(M)&&M.line.width?a:M.fillcolor)}},{"../../components/color":367,"./subtypes":961}],947:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/fx"),S=y("../../registry"),M=y("./get_trace_color"),e=y("../../components/color"),a=A.fillText;ee.exports=function(r,t,h,s){var i=r.cd,x=i[0].trace,p=r.xa,v=r.ya,f=p.c2p(t),d=v.c2p(h),o=[f,d],m=x.hoveron||"",l=x.mode.indexOf("markers")!==-1?3:.5,w=!!x.xperiodalignment,_=!!x.yperiodalignment;if(m.indexOf("points")!==-1){var c=function(ae){if(w){var oe=p.c2p(ae.xStart),be=p.c2p(ae.xEnd);return f>=Math.min(oe,be)&&f<=Math.max(oe,be)?0:1/0}var ce=Math.max(3,ae.mrc||0),de=1-1/ce,ye=Math.abs(p.c2p(ae.x)-f);return ye<ce?de*ye/ce:ye-ce+de},b=function(ae){if(_){var oe=v.c2p(ae.yStart),be=v.c2p(ae.yEnd);return d>=Math.min(oe,be)&&d<=Math.max(oe,be)?0:1/0}var ce=Math.max(3,ae.mrc||0),de=1-1/ce,ye=Math.abs(v.c2p(ae.y)-d);return ye<ce?de*ye/ce:ye-ce+de},u=function(ae){var oe=Math.max(l,ae.mrc||0),be=p.c2p(ae.x)-f,ce=v.c2p(ae.y)-d;return Math.max(Math.sqrt(be*be+ce*ce)-oe,1-l/oe)},L=g.getDistanceFunction(s,c,b,u);if(g.getClosest(i,L,r),r.index!==!1){var T=i[r.index],k=p.c2p(T.x,!0),P=v.c2p(T.y,!0),z=T.mrc||1;r.index=T.i;var I=i[0].t.orientation,D=I&&(T.sNorm||T.s),R=I==="h"?D:T.orig_x!==void 0?T.orig_x:T.x,O=I==="v"?D:T.orig_y!==void 0?T.orig_y:T.y;return A.extendFlat(r,{color:M(x,T),x0:k-z,x1:k+z,xLabelVal:R,y0:P-z,y1:P+z,yLabelVal:O,spikeDistance:u(T),hovertemplate:x.hovertemplate}),a(T,x,r),S.getComponentMethod("errorbars","hoverInfo")(T,x,r),[r]}}if(m.indexOf("fills")!==-1&&x._polygons){var F=x._polygons,N=[],G=!1,K=1/0,W=-1/0,Y=1/0,re=-1/0,ue,j,q,H,U,$,ne,X,Q;for(ue=0;ue<F.length;ue++)q=F[ue],q.contains(o)&&(G=!G,N.push(q),Y=Math.min(Y,q.ymin),re=Math.max(re,q.ymax));if(G){Y=Math.max(Y,0),re=Math.min(re,v._length);var ie=(Y+re)/2;for(ue=0;ue<N.length;ue++)for(H=N[ue].pts,j=1;j<H.length;j++)X=H[j-1][1],Q=H[j][1],X>ie!=Q>=ie&&($=H[j-1][0],ne=H[j][0],Q-X&&(U=$+(ne-$)*(ie-X)/(Q-X),K=Math.min(K,U),W=Math.max(W,U)));K=Math.max(K,0),W=Math.min(W,p._length);var se=e.defaultLine;return e.opacity(x.fillcolor)?se=x.fillcolor:e.opacity((x.line||{}).color)&&(se=x.line.color),A.extendFlat(r,{distance:r.maxHoverDistance,x0:K,x1:W,y0:ie,y1:ie,color:se,hovertemplate:!1}),delete r.index,x.text&&!Array.isArray(x.text)?r.text=String(x.text):r.text=x.name,[r]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(y,ee,te){var A=y("./subtypes");ee.exports={hasLines:A.hasLines,hasMarkers:A.hasMarkers,hasText:A.hasText,isBubble:A.isBubble,attributes:y("./attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("./cross_trace_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./cross_trace_calc"),arraysToCalcdata:y("./arrays_to_calcdata"),plot:y("./plot"),colorbar:y("./marker_colorbar"),formatLabels:y("./format_labels"),style:y("./style").style,styleOnSelect:y("./style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(y,ee,te){var A=y("../../lib").isArrayOrTypedArray,g=y("../../components/colorscale/helpers").hasColorscale,S=y("../../components/colorscale/defaults");ee.exports=function(e,a,n,r,t,h){h||(h={});var s=(e.marker||{}).color;if(t("line.color",n),g(e,"line"))S(e,a,r,t,{prefix:"line.",cLetter:"c"});else{var i=(A(s)?!1:s)||n;t("line.color",i)}t("line.width"),h.noDash||t("line.dash"),h.backoff&&t("line.backoff")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(y,ee,te){var A=y("../../components/drawing"),g=y("../../constants/numerical"),S=g.BADNUM,M=g.LOG_CLIP,e=M+.5,a=M-.5,n=y("../../lib"),r=n.segmentsIntersect,t=n.constrain,h=y("./constants");ee.exports=function(i,x){var p=x.trace||{},v=x.xaxis,f=x.yaxis,d=v.type==="log",o=f.type==="log",m=v._length,l=f._length,w=x.backoff,_=p.marker,c=x.connectGaps,b=x.baseTolerance,u=x.shape,L=u==="linear",T=p.fill&&p.fill!=="none",k=[],P=h.minTolerance,z=i.length,I=new Array(z),D=0,R,O,F,N,G,K,W,Y,re,ue,j,q,H,U,$,ne;function X(wt){var Ut=i[wt];if(!Ut)return!1;var Rt=x.linearized?v.l2p(Ut.x):v.c2p(Ut.x),Nt=x.linearized?f.l2p(Ut.y):f.c2p(Ut.y);if(Rt===S){if(d&&(Rt=v.c2p(Ut.x,!0)),Rt===S)return!1;o&&Nt===S&&(Rt*=Math.abs(v._m*l*(v._m>0?e:a)/(f._m*m*(f._m>0?e:a)))),Rt*=1e3}if(Nt===S){if(o&&(Nt=f.c2p(Ut.y,!0)),Nt===S)return!1;Nt*=1e3}return[Rt,Nt]}function Q(wt,Ut,Rt,Nt){var Wt=Rt-wt,Vt=Nt-Ut,ir=.5-wt,Hr=.5-Ut,sn=Wt*Wt+Vt*Vt,jr=Wt*ir+Vt*Hr;if(jr>0&&jr<sn){var at=ir*Vt-Hr*Wt;if(at*at<sn)return!0}}var ie,se;function ae(wt,Ut){var Rt=wt[0]/m,Nt=wt[1]/l,Wt=Math.max(0,-Rt,Rt-1,-Nt,Nt-1);return Wt&&ie!==void 0&&Q(Rt,Nt,ie,se)&&(Wt=0),Wt&&Ut&&Q(Rt,Nt,Ut[0]/m,Ut[1]/l)&&(Wt=0),(1+h.toleranceGrowth*Wt)*b}function oe(wt,Ut){var Rt=wt[0]-Ut[0],Nt=wt[1]-Ut[1];return Math.sqrt(Rt*Rt+Nt*Nt)}var be=h.maxScreensAway,ce=-m*be,de=m*(1+be),ye=-l*be,ge=l*(1+be),me=[[ce,ye,de,ye],[de,ye,de,ge],[de,ge,ce,ge],[ce,ge,ce,ye]],Ee,Pe,Ue,we,ke,Xe;function Ve(wt,Ut){for(var Rt=[],Nt=0,Wt=0;Wt<4;Wt++){var Vt=me[Wt],ir=r(wt[0],wt[1],Ut[0],Ut[1],Vt[0],Vt[1],Vt[2],Vt[3]);ir&&(!Nt||Math.abs(ir.x-Rt[0][0])>1||Math.abs(ir.y-Rt[0][1])>1)&&(ir=[ir.x,ir.y],Nt&&oe(ir,wt)<oe(Rt[0],wt)?Rt.unshift(ir):Rt.push(ir),Nt++)}return Rt}function Ie(wt){if(wt[0]<ce||wt[0]>de||wt[1]<ye||wt[1]>ge)return[t(wt[0],ce,de),t(wt[1],ye,ge)]}function De(wt,Ut){if(wt[0]===Ut[0]&&(wt[0]===ce||wt[0]===de)||wt[1]===Ut[1]&&(wt[1]===ye||wt[1]===ge))return!0}function Ye(wt,Ut){var Rt=[],Nt=Ie(wt),Wt=Ie(Ut);return Nt&&Wt&&De(Nt,Wt)||(Nt&&Rt.push(Nt),Wt&&Rt.push(Wt)),Rt}function vt(wt,Ut,Rt){return function(Nt,Wt){var Vt=Ie(Nt),ir=Ie(Wt),Hr=[];if(Vt&&ir&&De(Vt,ir))return Hr;Vt&&Hr.push(Vt),ir&&Hr.push(ir);var sn=2*n.constrain((Nt[wt]+Wt[wt])/2,Ut,Rt)-((Vt||Nt)[wt]+(ir||Wt)[wt]);if(sn){var jr;Vt&&ir?jr=sn>0==Vt[wt]>ir[wt]?Vt:ir:jr=Vt||ir,jr[wt]+=sn}return Hr}}var Dt;u==="linear"||u==="spline"?Dt=Ve:u==="hv"||u==="vh"?Dt=Ye:u==="hvh"?Dt=vt(0,ce,de):u==="vhv"&&(Dt=vt(1,ye,ge));function Kt(wt,Ut){var Rt=Ut[0]-wt[0],Nt=(Ut[1]-wt[1])/Rt,Wt=(wt[1]*Ut[0]-Ut[1]*wt[0])/Rt;return Wt>0?[Nt>0?ce:de,ge]:[Nt>0?de:ce,ye]}function Ft(wt){var Ut=wt[0],Rt=wt[1],Nt=Ut===I[D-1][0],Wt=Rt===I[D-1][1];if(!(Nt&&Wt))if(D>1){var Vt=Ut===I[D-2][0],ir=Rt===I[D-2][1];Nt&&(Ut===ce||Ut===de)&&Vt?ir?D--:I[D-1]=wt:Wt&&(Rt===ye||Rt===ge)&&ir?Vt?D--:I[D-1]=wt:I[D++]=wt}else I[D++]=wt}function Mt(wt){I[D-1][0]!==wt[0]&&I[D-1][1]!==wt[1]&&Ft([Ue,we]),Ft(wt),ke=null,Ue=we=0}var Xt=n.isArrayOrTypedArray(_);function It(wt){if(wt&&w&&(wt.i=R,wt.d=i,wt.trace=p,wt.marker=Xt?_[wt.i]:_,wt.backoff=w),ie=wt[0]/m,se=wt[1]/l,Ee=wt[0]<ce?ce:wt[0]>de?de:0,Pe=wt[1]<ye?ye:wt[1]>ge?ge:0,Ee||Pe){if(!D)I[D++]=[Ee||wt[0],Pe||wt[1]];else if(ke){var Ut=Dt(ke,wt);Ut.length>1&&(Mt(Ut[0]),I[D++]=Ut[1])}else Xe=Dt(I[D-1],wt)[0],I[D++]=Xe;var Rt=I[D-1];Ee&&Pe&&(Rt[0]!==Ee||Rt[1]!==Pe)?(ke&&(Ue!==Ee&&we!==Pe?Ft(Ue&&we?Kt(ke,wt):[Ue||Ee,we||Pe]):Ue&&we&&Ft([Ue,we])),Ft([Ee,Pe])):Ue-Ee&&we-Pe&&Ft([Ee||Ue,Pe||we]),ke=wt,Ue=Ee,we=Pe}else ke&&Mt(Dt(ke,wt)[0]),I[D++]=wt}for(R=0;R<z;R++)if(O=X(R),!!O){for(D=0,ke=null,It(O),R++;R<z;R++){if(N=X(R),!N){if(c)continue;break}if(!L||!x.simplify){It(N);continue}var At=X(R+1);if(ue=oe(N,O),!(!(T&&(D===0||D===z-1))&&ue<ae(N,At)*P)){for(Y=[(N[0]-O[0])/ue,(N[1]-O[1])/ue],G=O,j=ue,q=U=$=0,W=!1,F=N,R++;R<i.length;R++){if(K=At,At=X(R+1),!K){if(c)continue;break}if(re=[K[0]-O[0],K[1]-O[1]],ne=re[0]*Y[1]-re[1]*Y[0],U=Math.min(U,ne),$=Math.max($,ne),$-U>ae(K,At))break;F=K,H=re[0]*Y[0]+re[1]*Y[1],H>j?(j=H,N=K,W=!1):H<q&&(q=H,G=K,W=!0)}if(W?(It(N),F!==G&&It(G)):(G!==O&&It(G),F!==N&&It(N)),It(F),R>=i.length||!K)break;It(K),O=K}}ke&&Ft([Ue||ke[0],we||ke[1]]),k.push(I.slice(0,D))}var Ge=u.slice(u.length-1);if(w&&Ge!=="h"&&Ge!=="v"){for(var tt=!1,He=-1,Ae=[],Ne=0;Ne<k.length;Ne++)for(var Ze=0;Ze<k[Ne].length-1;Ze++){var Qe=k[Ne][Ze],bt=k[Ne][Ze+1],dt=A.applyBackoff(bt,Qe);(dt[0]!==bt[0]||dt[1]!==bt[1])&&(tt=!0),Ae[He+1]||(He++,Ae[He]=[Qe,[dt[0],dt[1]]])}return tt?Ae:k}return k}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(y,ee,te){ee.exports=function(g,S,M){var e=M("line.shape");e==="spline"&&M("line.smoothing")}},{}],952:[function(y,ee,te){var A={tonextx:1,tonexty:1,tonext:1};ee.exports=function(S,M,e){var a,n,r,t,h,s={},i=!1,x=-1,p=0,v=-1;for(n=0;n<e.length;n++)a=e[n][0].trace,r=a.stackgroup||"",r?r in s?h=s[r]:(h=s[r]=p,p++):a.fill in A&&v>=0?h=v:(h=v=p,p++),h<x&&(i=!0),a._groupIndex=x=h;var f=e.slice();i&&f.sort(function(o,m){var l=o[0].trace,w=m[0].trace;return l._groupIndex-w._groupIndex||l.index-w.index});var d={};for(n=0;n<f.length;n++)a=f[n][0].trace,r=a.stackgroup||"",a.visible===!0?(a._nexttrace=null,a.fill in A&&(t=d[r],a._prevtrace=t||null,t&&(t._nexttrace=a)),a._ownfill=a.fill&&(a.fill.substr(0,6)==="tozero"||a.fill==="toself"||a.fill.substr(0,2)==="to"&&!a._prevtrace),d[r]=a):a._prevtrace=a._nexttrace=a._ownfill=null;return f}},{}],953:[function(y,ee,te){var A=y("fast-isnumeric");ee.exports=function(S,M){M||(M=2);var e=S.marker,a=e.sizeref||1,n=e.sizemin||0,r=e.sizemode==="area"?function(t){return Math.sqrt(t/a)}:function(t){return t/a};return function(t){var h=r(t/M);return A(h)&&h>0?Math.max(h,n):0}}},{"fast-isnumeric":190}],954:[function(y,ee,te){ee.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(y,ee,te){var A=y("../../components/color"),g=y("../../components/colorscale/helpers").hasColorscale,S=y("../../components/colorscale/defaults"),M=y("./subtypes");ee.exports=function(a,n,r,t,h,s){var i=M.isBubble(a),x=(a.line||{}).color,p;if(s=s||{},x&&(r=x),h("marker.symbol"),h("marker.opacity",i?.7:1),h("marker.size"),s.noAngle||(h("marker.angle"),s.noAngleRef||h("marker.angleref"),s.noStandOff||h("marker.standoff")),h("marker.color",r),g(a,"marker")&&S(a,n,t,h,{prefix:"marker.",cLetter:"c"}),s.noSelect||(h("selected.marker.color"),h("unselected.marker.color"),h("selected.marker.size"),h("unselected.marker.size")),s.noLine||(x&&!Array.isArray(x)&&n.marker.color!==x?p=x:i?p=A.background:p=A.defaultLine,h("marker.line.color",p),g(a,"marker.line")&&S(a,n,t,h,{prefix:"marker.line.",cLetter:"c"}),h("marker.line.width",i?1:0)),i&&(h("marker.sizeref"),h("marker.sizemin"),h("marker.sizemode")),s.gradient){var v=h("marker.gradient.type");v!=="none"&&h("marker.gradient.color")}}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(y,ee,te){var A=y("../../lib").dateTick0,g=y("../../constants/numerical"),S=g.ONEWEEK;function M(e,a){return e%S===0?A(a,1):A(a,0)}ee.exports=function(a,n,r,t,h){if(h||(h={x:!0,y:!0}),h.x){var s=t("xperiod");s&&(t("xperiod0",M(s,n.xcalendar)),t("xperiodalignment"))}if(h.y){var i=t("yperiod");i&&(t("yperiod0",M(i,n.ycalendar)),t("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../registry"),S=y("../../lib"),M=S.ensureSingle,e=S.identity,a=y("../../components/drawing"),n=y("./subtypes"),r=y("./line_points"),t=y("./link_traces"),h=y("../../lib/polygon").tester;ee.exports=function(v,f,d,o,m,l){var w,_,c=!m,b=!!m&&m.duration>0,u=t(v,f,d);if(w=o.selectAll("g.trace").data(u,function(T){return T[0].trace.uid}),w.enter().append("g").attr("class",function(T){return"trace scatter trace"+T[0].trace.uid}).style("stroke-miterlimit",2),w.order(),s(v,w,f),b){l&&(_=l());var L=A.transition().duration(m.duration).ease(m.easing).each("end",function(){_&&_()}).each("interrupt",function(){_&&_()});L.each(function(){o.selectAll("g.trace").each(function(T,k){i(v,k,f,T,u,this,m)})})}else w.each(function(T,k){i(v,k,f,T,u,this,m)});c&&w.exit().remove(),o.selectAll("path:not([d])").remove()};function s(p,v,f){v.each(function(d){var o=M(A.select(this),"g","fills");a.setClipUrl(o,f.layerClipId,p);var m=d[0].trace,l=[];m._ownfill&&l.push("_ownFill"),m._nexttrace&&l.push("_nextFill");var w=o.selectAll("g").data(l,e);w.enter().append("g"),w.exit().each(function(_){m[_]=null}).remove(),w.order().each(function(_){m[_]=M(A.select(this),"path","js-fill")})})}function i(p,v,f,d,o,m,l){var w;x(p,v,f,d,o);var _=!!l&&l.duration>0;function c(Ue){return _?Ue.transition():Ue}var b=f.xaxis,u=f.yaxis,L=d[0].trace,T=L.line,k=A.select(m),P=M(k,"g","errorbars"),z=M(k,"g","lines"),I=M(k,"g","points"),D=M(k,"g","text");if(g.getComponentMethod("errorbars","plot")(p,P,f,l),L.visible!==!0)return;c(k).style("opacity",L.opacity);var R,O,F=L.fill.charAt(L.fill.length-1);F!=="x"&&F!=="y"&&(F=""),d[0][f.isRangePlot?"nodeRangePlot3":"node3"]=k;var N="",G=[],K=L._prevtrace;K&&(N=K._prevRevpath||"",O=K._nextFill,G=K._polygons);var W,Y,re="",ue="",j,q,H,U,$,ne,X,Q=[],ie=S.noop;if(R=L._ownFill,n.hasLines(L)||L.fill!=="none"){for(O&&O.datum(d),["hv","vh","hvh","vhv"].indexOf(T.shape)!==-1?(j=a.steps(T.shape),q=a.steps(T.shape.split("").reverse().join(""))):T.shape==="spline"?j=q=function(Ue){var we=Ue[Ue.length-1];return Ue.length>1&&Ue[0][0]===we[0]&&Ue[0][1]===we[1]?a.smoothclosed(Ue.slice(1),T.smoothing):a.smoothopen(Ue,T.smoothing)}:j=q=function(Ue){return"M"+Ue.join("L")},H=function(Ue){return q(Ue.reverse())},Q=r(d,{xaxis:b,yaxis:u,trace:L,connectGaps:L.connectgaps,baseTolerance:Math.max(T.width||1,3)/4,shape:T.shape,backoff:T.backoff,simplify:T.simplify,fill:L.fill}),X=L._polygons=new Array(Q.length),w=0;w<Q.length;w++)L._polygons[w]=h(Q[w]);Q.length&&(U=Q[0][0],$=Q[Q.length-1],ne=$[$.length-1]),ie=function(Ue){return function(we){if(W=j(we),Y=H(we),re?F?(re+="L"+W.substr(1),ue=Y+("L"+ue.substr(1))):(re+="Z"+W,ue=Y+"Z"+ue):(re=W,ue=Y),n.hasLines(L)&&we.length>1){var ke=A.select(this);if(ke.datum(d),Ue)c(ke.style("opacity",0).attr("d",W).call(a.lineGroupStyle)).style("opacity",1);else{var Xe=c(ke);Xe.attr("d",W),a.singleLineStyle(d,Xe)}}}}}var se=z.selectAll(".js-line").data(Q);c(se.exit()).style("opacity",0).remove(),se.each(ie(!1)),se.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(a.lineGroupStyle).each(ie(!0)),a.setClipUrl(se,f.layerClipId,p);function ae(Ue){c(Ue).attr("d","M0,0Z")}Q.length?(R?(R.datum(d),U&&ne&&(F?(F==="y"?U[1]=ne[1]=u.c2p(0,!0):F==="x"&&(U[0]=ne[0]=b.c2p(0,!0)),c(R).attr("d","M"+ne+"L"+U+"L"+re.substr(1)).call(a.singleFillStyle,p)):c(R).attr("d",re+"Z").call(a.singleFillStyle,p))):O&&(L.fill.substr(0,6)==="tonext"&&re&&N?(L.fill==="tonext"?c(O).attr("d",re+"Z"+N+"Z").call(a.singleFillStyle,p):c(O).attr("d",re+"L"+N.substr(1)+"Z").call(a.singleFillStyle,p),L._polygons=L._polygons.concat(G)):(ae(O),L._polygons=null)),L._prevRevpath=ue,L._prevPolygons=X):(R?ae(R):O&&ae(O),L._polygons=L._prevRevpath=L._prevPolygons=null);function oe(Ue){return Ue.filter(function(we){return!we.gap&&we.vis})}function be(Ue){return Ue.filter(function(we){return we.vis})}function ce(Ue){return Ue.filter(function(we){return!we.gap})}function de(Ue){return Ue.id}function ye(Ue){if(Ue.ids)return de}function ge(){return!1}function me(Ue,we,ke){var Xe,Ve,Ie,De=ke[0].trace,Ye=n.hasMarkers(De),vt=n.hasText(De),Dt=ye(De),Kt=ge,Ft=ge;if(Ye||vt){var Mt=e,Xt=De.stackgroup,It=Xt&&p._fullLayout._scatterStackOpts[b._id+u._id][Xt].stackgaps==="infer zero";De.marker.maxdisplayed||De._needsCull?Mt=It?be:oe:Xt&&!It&&(Mt=ce),Ye&&(Kt=Mt),vt&&(Ft=Mt)}Ve=Ue.selectAll("path.point"),Xe=Ve.data(Kt,Dt);var At=Xe.enter().append("path").classed("point",!0);_&&At.call(a.pointStyle,De,p).call(a.translatePoints,b,u).style("opacity",0).transition().style("opacity",1),Xe.order();var Ge;Ye&&(Ge=a.makePointStyleFns(De)),Xe.each(function(tt){var He=A.select(this),Ae=c(He);Ie=a.translatePoint(tt,Ae,b,u),Ie?(a.singlePointStyle(tt,Ae,De,Ge,p),f.layerClipId&&a.hideOutsideRangePoint(tt,Ae,b,u,De.xcalendar,De.ycalendar),De.customdata&&He.classed("plotly-customdata",tt.data!==null&&tt.data!==void 0)):Ae.remove()}),_?Xe.exit().transition().style("opacity",0).remove():Xe.exit().remove(),Ve=we.selectAll("g"),Xe=Ve.data(Ft,Dt),Xe.enter().append("g").classed("textpoint",!0).append("text"),Xe.order(),Xe.each(function(tt){var He=A.select(this),Ae=c(He.select("text"));Ie=a.translatePoint(tt,Ae,b,u),Ie?f.layerClipId&&a.hideOutsideRangePoint(tt,He,b,u,De.xcalendar,De.ycalendar):He.remove()}),Xe.selectAll("text").call(a.textPointStyle,De,p).each(function(tt){var He=b.c2p(tt.x),Ae=u.c2p(tt.y);A.select(this).selectAll("tspan.line").each(function(){c(A.select(this)).attr({x:He,y:Ae})})}),Xe.exit().remove()}I.datum(d),D.datum(d),me(I,D,d);var Ee=L.cliponaxis===!1,Pe=Ee?null:f.layerClipId;a.setClipUrl(I,Pe,p),a.setClipUrl(D,Pe,p)}function x(p,v,f,d,o){var m=f.xaxis,l=f.yaxis,w=A.extent(S.simpleMap(m.range,m.r2c)),_=A.extent(S.simpleMap(l.range,l.r2c)),c=d[0].trace;if(n.hasMarkers(c)){var b=c.marker.maxdisplayed;if(b!==0){var u=d.filter(function(P){return P.x>=w[0]&&P.x<=w[1]&&P.y>=_[0]&&P.y<=_[1]}),L=Math.ceil(u.length/b),T=0;o.forEach(function(P,z){var I=P[0].trace;n.hasMarkers(I)&&I.marker.maxdisplayed>0&&z<v&&T++});var k=Math.round(T*L/3+Math.floor(T/3)*L/7.1);d.forEach(function(P){delete P.vis}),u.forEach(function(P,z){Math.round((z+k)%L)===0&&(P.vis=!0)})}}}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(y,ee,te){var A=y("./subtypes");ee.exports=function(S,M){var e=S.cd,a=S.xaxis,n=S.yaxis,r=[],t=e[0].trace,h,s,i,x,p=!A.hasMarkers(t)&&!A.hasText(t);if(p)return[];if(M===!1)for(h=0;h<e.length;h++)e[h].selected=0;else for(h=0;h<e.length;h++)s=e[h],i=a.c2p(s.x),x=n.c2p(s.y),s.i!==null&&M.contains([i,x],!1,h,S)?(r.push({pointNumber:s.i,x:a.c2d(s.x),y:n.c2d(s.y)}),s.selected=1):s.selected=0;return r}},{"./subtypes":961}],959:[function(y,ee,te){var A=["orientation","groupnorm","stackgaps"];ee.exports=function(S,M,e,a){var n=e._scatterStackOpts,r=a("stackgroup");if(r){var t=M.xaxis+M.yaxis,h=n[t];h||(h=n[t]={});var s=h[r],i=!1;s?s.traces.push(M):(s=h[r]={traceIndices:[],traces:[M]},i=!0);for(var x={orientation:M.x&&!M.y?"h":"v"},p=0;p<A.length;p++){var v=A[p],f=v+"Found";if(!s[f]){var d=S[v]!==void 0,o=v==="orientation";if((d||i)&&(s[v]=a(v,x[v]),o&&(s.fillDflt=s[v]==="h"?"tonextx":"tonexty"),d&&(s[f]=!0,!i&&(delete s.traces[0][v],o))))for(var m=0;m<s.traces.length-1;m++){var l=s.traces[m];l._input.fill!==l.fill&&(l.fill=s.fillDflt)}}}return s}}},{}],960:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/drawing"),S=y("../../registry");function M(r){var t=A.select(r).selectAll("g.trace.scatter");t.style("opacity",function(h){return h[0].trace.opacity}),t.selectAll("g.points").each(function(h){var s=A.select(this),i=h.trace||h[0].trace;e(s,i,r)}),t.selectAll("g.text").each(function(h){var s=A.select(this),i=h.trace||h[0].trace;a(s,i,r)}),t.selectAll("g.trace path.js-line").call(g.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(g.fillGroupStyle,r),S.getComponentMethod("errorbars","style")(t)}function e(r,t,h){g.pointStyle(r.selectAll("path.point"),t,h)}function a(r,t,h){g.textPointStyle(r.selectAll("text"),t,h)}function n(r,t,h){var s=t[0].trace;s.selectedpoints?(g.selectedPointStyle(h.selectAll("path.point"),s),g.selectedTextStyle(h.selectAll("text"),s)):(e(h,s,r),a(h,s,r))}ee.exports={style:M,stylePoints:e,styleText:a,styleOnSelect:n}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(y,ee,te){var A=y("../../lib");ee.exports={hasLines:function(g){return g.visible&&g.mode&&g.mode.indexOf("lines")!==-1},hasMarkers:function(g){return g.visible&&(g.mode&&g.mode.indexOf("markers")!==-1||g.type==="splom")},hasText:function(g){return g.visible&&g.mode&&g.mode.indexOf("text")!==-1},isBubble:function(g){return A.isPlainObject(g.marker)&&A.isArrayOrTypedArray(g.marker.size)}}},{"../../lib":515}],962:[function(y,ee,te){var A=y("../../lib");ee.exports=function(g,S,M,e,a){a=a||{},e("textposition"),A.coerceFont(e,"textfont",M.font),a.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(y,ee,te){var A=y("../../lib"),g=y("../../registry");ee.exports=function(M,e,a,n){var r=n("x"),t=n("y"),h,s=g.getComponentMethod("calendars","handleTraceDefaults");if(s(M,e,["x","y"],a),r){var i=A.minRowLength(r);t?h=Math.min(i,A.minRowLength(t)):(h=i,n("y0"),n("dy"))}else{if(!t)return 0;h=A.minRowLength(t),n("x0"),n("dx")}return e._length=h,h}},{"../../lib":515,"../../registry":647}],964:[function(y,ee,te){var A=y("../scatter/attributes"),g=y("../../components/colorscale/attributes"),S=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=y("../../plots/template_attributes").hovertemplateAttrs,e=y("../../plots/template_attributes").texttemplateAttrs,a=y("../../plots/attributes"),n=y("../../constants/gl3d_dashes"),r=y("../../constants/gl3d_markers"),t=y("../../lib/extend").extendFlat,h=y("../../plot_api/edit_types").overrideAll,s=y("../../lib/sort_object_keys"),i=A.line,x=A.marker,p=x.line,v=t({width:i.width,dash:{valType:"enumerated",values:s(n),dflt:"solid"}},g("line"));function f(o){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var d=ee.exports=h({x:A.x,y:A.y,z:{valType:"data_array"},text:t({},A.text,{}),texttemplate:e({},{}),hovertext:t({},A.hovertext,{}),hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),zhoverformat:S("z"),mode:t({},A.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:f(),y:f(),z:f()},connectgaps:A.connectgaps,line:v,marker:t({symbol:{valType:"enumerated",values:s(r),dflt:"circle",arrayOk:!0},size:t({},x.size,{dflt:8}),sizeref:x.sizeref,sizemin:x.sizemin,sizemode:x.sizemode,opacity:t({},x.opacity,{arrayOk:!1}),colorbar:x.colorbar,line:t({width:t({},p.width,{arrayOk:!1})},g("marker.line"))},g("marker")),textposition:t({},A.textposition,{dflt:"top center"}),textfont:{color:A.textfont.color,size:A.textfont.size,family:t({},A.textfont.family,{arrayOk:!1})},opacity:a.opacity,hoverinfo:t({},a.hoverinfo)},"calc","nested");d.x.editType=d.y.editType=d.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(y,ee,te){var A=y("../scatter/arrays_to_calcdata"),g=y("../scatter/colorscale_calc");ee.exports=function(M,e){var a=[{x:!1,y:!1,trace:e,t:{}}];return A(a,e),g(M,e),a}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(y,ee,te){var A=y("../../registry");function g(e,a,n,r){if(!a||!a.visible)return null;for(var t=A.getComponentMethod("errorbars","makeComputeError")(a),h=new Array(e.length),s=0;s<e.length;s++){var i=t(+e[s],s);if(r.type==="log"){var x=r.c2l(e[s]),p=e[s]-i[0],v=e[s]+i[1];if(h[s]=[(r.c2l(p,!0)-x)*n,(r.c2l(v,!0)-x)*n],p>0){var f=r.c2l(p);r._lowerLogErrorBound||(r._lowerLogErrorBound=f),r._lowerErrorBound=Math.min(r._lowerLogErrorBound,f)}}else h[s]=[-i[0]*n,i[1]*n]}return h}function S(e){for(var a=0;a<e.length;a++)if(e[a])return e[a].length;return 0}function M(e,a,n){var r=[g(e.x,e.error_x,a[0],n.xaxis),g(e.y,e.error_y,a[1],n.yaxis),g(e.z,e.error_z,a[2],n.zaxis)],t=S(r);if(t===0)return null;for(var h=new Array(t),s=0;s<t;s++){for(var i=[[0,0,0],[0,0,0]],x=0;x<3;x++)if(r[x])for(var p=0;p<2;p++)i[p][x]=r[x][s][p];h[s]=i}return h}ee.exports=M},{"../../registry":647}],967:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_line3d,g=y("../../../stackgl_modules").gl_scatter3d,S=y("../../../stackgl_modules").gl_error3d,M=y("../../../stackgl_modules").gl_mesh3d,e=y("../../../stackgl_modules").delaunay_triangulate,a=y("../../lib"),n=y("../../lib/str2rgbarray"),r=y("../../lib/gl_format_color").formatColor,t=y("../scatter/make_bubble_size_func"),h=y("../../constants/gl3d_dashes"),s=y("../../constants/gl3d_markers"),i=y("../../plots/cartesian/axes"),x=y("../../components/fx/helpers").appendArrayPointValue,p=y("./calc_errors");function v(P,z){this.scene=P,this.uid=z,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var f=v.prototype;f.handlePick=function(P){if(P.object&&(P.object===this.linePlot||P.object===this.delaunayMesh||P.object===this.textMarkers||P.object===this.scatterPlot)){var z=P.index=P.data.index;return P.object.highlight&&P.object.highlight(null),this.scatterPlot&&(P.object=this.scatterPlot,this.scatterPlot.highlight(P.data)),P.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[z]||this.textLabels[z]===0)&&(P.textLabel=this.textLabels[z]):P.textLabel=this.textLabels),P.traceCoordinate=[this.data.x[z],this.data.y[z],this.data.z[z]],!0}};function d(P,z,I){var D=(I+1)%3,R=(I+2)%3,O=[],F=[],N;for(N=0;N<P.length;++N){var G=P[N];isNaN(G[D])||!isFinite(G[D])||isNaN(G[R])||!isFinite(G[R])||(O.push([G[D],G[R]]),F.push(N))}var K=e(O);for(N=0;N<K.length;++N)for(var W=K[N],Y=0;Y<W.length;++Y)W[Y]=F[W[Y]];return{positions:P,cells:K,meshColor:z}}function o(P){for(var z=[0,0,0],I=[[0,0,0],[0,0,0],[0,0,0]],D=[1,1,1],R=0;R<3;R++){var O=P[R];O&&O.copy_zstyle!==!1&&P[2].visible!==!1&&(O=P[2]),!(!O||!O.visible)&&(z[R]=O.width/2,I[R]=n(O.color),D[R]=O.thickness)}return{capSize:z,color:I,lineWidth:D}}function m(P){return P==null?0:P.indexOf("left")>-1?-1:P.indexOf("right")>-1?1:0}function l(P){return P==null?0:P.indexOf("top")>-1?-1:P.indexOf("bottom")>-1?1:0}function w(P){var z=0,I=0,D=[z,I];if(Array.isArray(P))for(var R=0;R<P.length;R++)D[R]=[z,I],P[R]&&(D[R][0]=m(P[R]),D[R][1]=l(P[R]));else D[0]=m(P),D[1]=l(P);return D}function _(P,z){return z(P*4)}function c(P){return s[P]}function b(P,z,I,D,R){var O=null;if(a.isArrayOrTypedArray(P)){O=[];for(var F=0;F<z;F++)P[F]===void 0?O[F]=D:O[F]=I(P[F],R)}else O=I(P,a.identity);return O}function u(P,z){var I=[],D=P.fullSceneLayout,R=P.dataScale,O=D.xaxis,F=D.yaxis,N=D.zaxis,G=z.marker,K=z.line,W=z.x||[],Y=z.y||[],re=z.z||[],ue=W.length,j=z.xcalendar,q=z.ycalendar,H=z.zcalendar,U,$,ne,X,Q,ie;for(Q=0;Q<ue;Q++)U=O.d2l(W[Q],0,j)*R[0],$=F.d2l(Y[Q],0,q)*R[1],ne=N.d2l(re[Q],0,H)*R[2],I[Q]=[U,$,ne];if(Array.isArray(z.text))ie=z.text;else if(z.text!==void 0)for(ie=new Array(ue),Q=0;Q<ue;Q++)ie[Q]=z.text;function se(Ve,Ie){var De=D[Ve];return i.tickText(De,De.d2l(Ie),!0).text}var ae=z.texttemplate;if(ae){var oe=P.fullLayout,be=oe._d3locale,ce=Array.isArray(ae),de=ce?Math.min(ae.length,ue):ue,ye=ce?function(Ve){return ae[Ve]}:function(){return ae};for(ie=new Array(de),Q=0;Q<de;Q++){var ge={x:W[Q],y:Y[Q],z:re[Q]},me={xLabel:se("xaxis",W[Q]),yLabel:se("yaxis",Y[Q]),zLabel:se("zaxis",re[Q])},Ee={};x(Ee,z,Q);var Pe=z._meta||{};ie[Q]=a.texttemplateString(ye(Q),me,be,Ee,ge,Pe)}}if(X={position:I,mode:z.mode,text:ie},"line"in z&&(X.lineColor=r(K,1,ue),X.lineWidth=K.width,X.lineDashes=K.dash),"marker"in z){var Ue=t(z);X.scatterColor=r(G,1,ue),X.scatterSize=b(G.size,ue,_,20,Ue),X.scatterMarker=b(G.symbol,ue,c,""),X.scatterLineWidth=G.line.width,X.scatterLineColor=r(G.line,1,ue),X.scatterAngle=0}"textposition"in z&&(X.textOffset=w(z.textposition),X.textColor=r(z.textfont,1,ue),X.textSize=b(z.textfont.size,ue,a.identity,12),X.textFont=z.textfont.family,X.textAngle=0);var we=["x","y","z"];for(X.project=[!1,!1,!1],X.projectScale=[1,1,1],X.projectOpacity=[1,1,1],Q=0;Q<3;++Q){var ke=z.projection[we[Q]];(X.project[Q]=ke.show)&&(X.projectOpacity[Q]=ke.opacity,X.projectScale[Q]=ke.scale)}X.errorBounds=p(z,R,D);var Xe=o([z.error_x,z.error_y,z.error_z]);return X.errorColor=Xe.color,X.errorLineWidth=Xe.lineWidth,X.errorCapSize=Xe.capSize,X.delaunayAxis=z.surfaceaxis,X.delaunayColor=n(z.surfacecolor),X}function L(P){if(a.isArrayOrTypedArray(P)){var z=P[0];return a.isArrayOrTypedArray(z)&&(P=z),"rgb("+P.slice(0,3).map(function(I){return Math.round(I*255)})+")"}return null}function T(P){return a.isArrayOrTypedArray(P)?P.length===4&&typeof P[0]=="number"?L(P):P.map(L):null}f.update=function(P){var z=this.scene.glplot.gl,I,D,R,O,F=h.solid;this.data=P;var N=u(this.scene,P);"mode"in N&&(this.mode=N.mode),"lineDashes"in N&&N.lineDashes in h&&(F=h[N.lineDashes]),this.color=T(N.scatterColor)||T(N.lineColor),this.dataPoints=N.position,I={gl:this.scene.glplot.gl,position:N.position,color:N.lineColor,lineWidth:N.lineWidth||1,dashes:F[0],dashScale:F[1],opacity:P.opacity,connectGaps:P.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(I):(this.linePlot=A(I),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var G=P.opacity;if(P.marker&&P.marker.opacity&&(G*=P.marker.opacity),D={gl:this.scene.glplot.gl,position:N.position,color:N.scatterColor,size:N.scatterSize,glyph:N.scatterMarker,opacity:G,orthographic:!0,lineWidth:N.scatterLineWidth,lineColor:N.scatterLineColor,project:N.project,projectScale:N.projectScale,projectOpacity:N.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(D):(this.scatterPlot=g(D),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),O={gl:this.scene.glplot.gl,position:N.position,glyph:N.text,color:N.textColor,size:N.textSize,angle:N.textAngle,alignment:N.textOffset,font:N.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:P.opacity},this.textLabels=P.hovertext||P.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(O):(this.textMarkers=g(O),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),R={gl:this.scene.glplot.gl,position:N.position,color:N.errorColor,error:N.errorBounds,lineWidth:N.errorLineWidth,capSize:N.errorCapSize,opacity:P.opacity},this.errorBars?N.errorBounds?this.errorBars.update(R):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):N.errorBounds&&(this.errorBars=S(R),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),N.delaunayAxis>=0){var K=d(N.position,N.delaunayColor,N.delaunayAxis);K.opacity=P.opacity,this.delaunayMesh?this.delaunayMesh.update(K):(K.gl=z,this.delaunayMesh=M(K),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},f.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())};function k(P,z){var I=new v(P,z.uid);return I.update(z),I}ee.exports=k},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("../scatter/subtypes"),M=y("../scatter/marker_defaults"),e=y("../scatter/line_defaults"),a=y("../scatter/text_defaults"),n=y("./attributes");ee.exports=function(h,s,i,x){function p(_,c){return g.coerce(h,s,n,_,c)}var v=r(h,s,p,x);if(!v){s.visible=!1;return}p("text"),p("hovertext"),p("hovertemplate"),p("xhoverformat"),p("yhoverformat"),p("zhoverformat"),p("mode"),S.hasLines(s)&&(p("connectgaps"),e(h,s,i,x,p)),S.hasMarkers(s)&&M(h,s,i,x,p,{noSelect:!0,noAngle:!0}),S.hasText(s)&&(p("texttemplate"),a(h,s,x,p,{noSelect:!0}));var f=(s.line||{}).color,d=(s.marker||{}).color;p("surfaceaxis")>=0&&p("surfacecolor",f||d);for(var o=["x","y","z"],m=0;m<3;++m){var l="projection."+o[m];p(l+".show")&&(p(l+".opacity"),p(l+".scale"))}var w=A.getComponentMethod("errorbars","supplyDefaults");w(h,s,f||d||i,{axis:"z"}),w(h,s,f||d||i,{axis:"y",inherit:"z"}),w(h,s,f||d||i,{axis:"x",inherit:"z"})};function r(t,h,s,i){var x=0,p=s("x"),v=s("y"),f=s("z"),d=A.getComponentMethod("calendars","handleTraceDefaults");return d(t,h,["x","y","z"],i),p&&v&&f&&(x=Math.min(p.length,v.length,f.length),h._length=h._xlength=h._ylength=h._zlength=x),x}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(y,ee,te){ee.exports={plot:y("./convert"),attributes:y("./attributes"),markerSymbols:y("../../constants/gl3d_markers"),supplyDefaults:y("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:y("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(y,ee,te){var A=y("../scatter/attributes"),g=y("../../plots/attributes"),S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../../plots/template_attributes").texttemplateAttrs,e=y("../../components/colorscale/attributes"),a=y("../../lib/extend").extendFlat,n=A.marker,r=A.line,t=n.line;ee.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:a({},A.mode,{dflt:"markers"}),text:a({},A.text,{}),texttemplate:M({editType:"plot"},{keys:["a","b","text"]}),hovertext:a({},A.hovertext,{}),line:{color:r.color,width:r.width,dash:r.dash,backoff:r.backoff,shape:a({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:A.connectgaps,fill:a({},A.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:A.fillcolor,marker:a({symbol:n.symbol,opacity:n.opacity,maxdisplayed:n.maxdisplayed,angle:n.angle,angleref:n.angleref,standoff:n.standoff,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,line:a({width:t.width,editType:"calc"},e("marker.line")),gradient:n.gradient,editType:"calc"},e("marker")),textfont:A.textfont,textposition:A.textposition,selected:A.selected,unselected:A.unselected,hoverinfo:a({},g.hoverinfo,{flags:["a","b","text","name"]}),hoveron:A.hoveron,hovertemplate:S()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../scatter/colorscale_calc"),S=y("../scatter/arrays_to_calcdata"),M=y("../scatter/calc_selection"),e=y("../scatter/calc").calcMarkerSize,a=y("../carpet/lookup_carpetid");ee.exports=function(r,t){var h=t._carpetTrace=a(r,t);if(!(!h||!h.visible||h.visible==="legendonly")){var s;t.xaxis=h.xaxis,t.yaxis=h.yaxis;var i=t._length,x=new Array(i),p,v,f=!1;for(s=0;s<i;s++)if(p=t.a[s],v=t.b[s],A(p)&&A(v)){var d=h.ab2xy(+p,+v,!0),o=h.isVisible(+p,+v);o||(f=!0),x[s]={x:d[0],y:d[1],a:p,b:v,vis:o}}else x[s]={x:!1,y:!1};return t._needsCull=f,x[0].carpet=h,x[0].trace=t,e(t,i),g(r,t),S(x,t),M(x,t),x}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/constants"),S=y("../scatter/subtypes"),M=y("../scatter/marker_defaults"),e=y("../scatter/line_defaults"),a=y("../scatter/line_shape_defaults"),n=y("../scatter/text_defaults"),r=y("../scatter/fillcolor_defaults"),t=y("./attributes");ee.exports=function(s,i,x,p){function v(_,c){return A.coerce(s,i,t,_,c)}v("carpet"),i.xaxis="x",i.yaxis="y";var f=v("a"),d=v("b"),o=Math.min(f.length,d.length);if(!o){i.visible=!1;return}i._length=o,v("text"),v("texttemplate"),v("hovertext");var m=o<g.PTS_LINESONLY?"lines+markers":"lines";v("mode",m),S.hasLines(i)&&(e(s,i,x,p,v,{backoff:!0}),a(s,i,v),v("connectgaps")),S.hasMarkers(i)&&M(s,i,x,p,v,{gradient:!0}),S.hasText(i)&&n(s,i,p,v);var l=[];(S.hasMarkers(i)||S.hasText(i))&&(v("marker.maxdisplayed"),l.push("points")),v("fill"),i.fill!=="none"&&(r(s,i,x,v),S.hasLines(i)||a(s,i,v)),(i.fill==="tonext"||i.fill==="toself")&&l.push("fills");var w=v("hoveron",l.join("+")||"points");w!=="fills"&&v("hovertemplate"),A.coerceSelectionMarkerOpacity(i,v)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(y,ee,te){ee.exports=function(g,S,M,e,a){var n=e[a];return g.a=n.a,g.b=n.b,g.y=n.y,g}},{}],974:[function(y,ee,te){ee.exports=function(g,S){var M={},e=S._carpet,a=e.ab2ij([g.a,g.b]),n=Math.floor(a[0]),r=a[0]-n,t=Math.floor(a[1]),h=a[1]-t,s=e.evalxy([],n,t,r,h);return M.yLabel=s[1].toFixed(3),M}},{}],975:[function(y,ee,te){var A=y("../scatter/hover"),g=y("../../lib").fillText;ee.exports=function(M,e,a,n){var r=A(M,e,a,n);if(!r||r[0].index===!1)return;var t=r[0];if(t.index===void 0){var h=1-t.y0/M.ya._length,s=M.xa._length,i=s*h/2,x=s-i;return t.x0=Math.max(Math.min(t.x0,x),i),t.x1=Math.max(Math.min(t.x1,x),i),r}var p=t.cd[t.index];t.a=p.a,t.b=p.b,t.xLabelVal=void 0,t.yLabelVal=void 0;var v=t.trace,f=v._carpet,d=v._module.formatLabels(p,v);t.yLabel=d.yLabel,delete t.text;var o=[];function m(_,c){var b;_.labelprefix&&_.labelprefix.length>0?b=_.labelprefix.replace(/ = $/,""):b=_._hovertitle,o.push(b+": "+c.toFixed(3)+_.labelsuffix)}if(!v.hovertemplate){var l=p.hi||v.hoverinfo,w=l.split("+");w.indexOf("all")!==-1&&(w=["a","b","text"]),w.indexOf("a")!==-1&&m(f.aaxis,p.a),w.indexOf("b")!==-1&&m(f.baxis,p.b),o.push("y: "+t.yLabel),w.indexOf("text")!==-1&&g(p,v,o),t.extraText=o.join("<br>")}return r}},{"../../lib":515,"../scatter/hover":947}],976:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),plot:y("./plot"),style:y("../scatter/style").style,styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("../scatter/select"),eventData:y("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:y("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(y,ee,te){var A=y("../scatter/plot"),g=y("../../plots/cartesian/axes"),S=y("../../components/drawing");ee.exports=function(e,a,n,r){var t,h,s,i=n[0][0].carpet,x=g.getFromId(e,i.xaxis||"x"),p=g.getFromId(e,i.yaxis||"y"),v={xaxis:x,yaxis:p,plot:a.plot};for(t=0;t<n.length;t++)h=n[t][0].trace,h._xA=x,h._yA=p;for(A(e,v,n,r),t=0;t<n.length;t++)h=n[t][0].trace,s=r.selectAll("g.trace"+h.uid+" .js-line"),S.setClipUrl(s,n[t][0].carpet._clipPathId,e)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../../plots/template_attributes").texttemplateAttrs,S=y("../scatter/attributes"),M=y("../../plots/attributes"),e=y("../../components/colorscale/attributes"),a=y("../../components/drawing/attributes").dash,n=y("../../lib/extend").extendFlat,r=y("../../plot_api/edit_types").overrideAll,t=S.marker,h=S.line,s=t.line;ee.exports=r({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:n({},S.mode,{dflt:"markers"}),text:n({},S.text,{}),texttemplate:g({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:n({},S.hovertext,{}),textfont:S.textfont,textposition:S.textposition,line:{color:h.color,width:h.width,dash:a},connectgaps:S.connectgaps,marker:n({symbol:t.symbol,opacity:t.opacity,angle:t.angle,angleref:n({},t.angleref,{values:["previous","up","north"]}),standoff:t.standoff,size:t.size,sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,colorbar:t.colorbar,line:n({width:s.width},e("marker.line")),gradient:t.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:S.fillcolor,selected:S.selected,unselected:S.unselected,hoverinfo:n({},M.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:A()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../constants/numerical").BADNUM,S=y("../scatter/colorscale_calc"),M=y("../scatter/arrays_to_calcdata"),e=y("../scatter/calc_selection"),a=y("../../lib")._;function n(r){return r&&typeof r=="string"}ee.exports=function(t,h){var s=Array.isArray(h.locations),i=s?h.locations.length:h._length,x=new Array(i),p;h.geojson?p=function(l){return n(l)||A(l)}:p=n;for(var v=0;v<i;v++){var f=x[v]={};if(s){var d=h.locations[v];f.loc=p(d)?d:null}else{var o=h.lon[v],m=h.lat[v];A(o)&&A(m)?f.lonlat=[+o,+m]:f.lonlat=[g,g]}}return M(x,h),S(t,h),e(x,h),i&&(x[0].t={labels:{lat:a(t,"lat:")+" ",lon:a(t,"lon:")+" "}}),x}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/subtypes"),S=y("../scatter/marker_defaults"),M=y("../scatter/line_defaults"),e=y("../scatter/text_defaults"),a=y("../scatter/fillcolor_defaults"),n=y("./attributes");ee.exports=function(t,h,s,i){function x(w,_){return A.coerce(t,h,n,w,_)}var p=x("locations"),v;if(p&&p.length){var f=x("geojson"),d;(typeof f=="string"&&f!==""||A.isPlainObject(f))&&(d="geojson-id");var o=x("locationmode",d);o==="geojson-id"&&x("featureidkey"),v=p.length}else{var m=x("lon")||[],l=x("lat")||[];v=Math.min(m.length,l.length)}if(!v){h.visible=!1;return}h._length=v,x("text"),x("hovertext"),x("hovertemplate"),x("mode"),g.hasLines(h)&&(M(t,h,s,i,x),x("connectgaps")),g.hasMarkers(h)&&S(t,h,s,i,x,{gradient:!0}),g.hasText(h)&&(x("texttemplate"),e(t,h,i,x)),x("fill"),h.fill!=="none"&&a(t,h,s,x),A.coerceSelectionMarkerOpacity(h,x)}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(y,ee,te){ee.exports=function(g,S,M,e,a){g.lon=S.lon,g.lat=S.lat,g.location=S.loc?S.loc:null;var n=e[a];return n.fIn&&n.fIn.properties&&(g.properties=n.fIn.properties),g}},{}],982:[function(y,ee,te){var A=y("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.geo]._subplot,r=n.mockAxis,t=S.lonlat;return a.lonLabel=A.tickText(r,r.c2l(t[0]),!0).text,a.latLabel=A.tickText(r,r.c2l(t[1]),!0).text,a}},{"../../plots/cartesian/axes":566}],983:[function(y,ee,te){var A=y("../../components/fx"),g=y("../../constants/numerical").BADNUM,S=y("../scatter/get_trace_color"),M=y("../../lib").fillText,e=y("./attributes");ee.exports=function(r,t,h){var s=r.cd,i=s[0].trace,x=r.xa,p=r.ya,v=r.subplot,f=v.projection.isLonLatOverEdges,d=v.project;function o(u){var L=u.lonlat;if(L[0]===g||f(L))return 1/0;var T=d(L),k=d([t,h]),P=Math.abs(T[0]-k[0]),z=Math.abs(T[1]-k[1]),I=Math.max(3,u.mrc||0);return Math.max(Math.sqrt(P*P+z*z)-I,1-3/I)}if(A.getClosest(s,o,r),r.index!==!1){var m=s[r.index],l=m.lonlat,w=[x.c2p(l),p.c2p(l)],_=m.mrc||1;r.x0=w[0]-_,r.x1=w[0]+_,r.y0=w[1]-_,r.y1=w[1]+_,r.loc=m.loc,r.lon=l[0],r.lat=l[1];var c={};c[i.geo]={_subplot:v};var b=i._module.formatLabels(m,i,c);return r.lonLabel=b.lonLabel,r.latLabel=b.latLabel,r.color=S(i,m),r.extraText=a(i,m,r,s[0].t.labels),r.hovertemplate=i.hovertemplate,[r]}};function a(n,r,t,h){if(n.hovertemplate)return;var s=r.hi||n.hoverinfo,i=s==="all"?e.hoverinfo.flags:s.split("+"),x=i.indexOf("location")!==-1&&Array.isArray(n.locations),p=i.indexOf("lon")!==-1,v=i.indexOf("lat")!==-1,f=i.indexOf("text")!==-1,d=[];function o(m){return m+""}return x?d.push(r.loc):p&&v?d.push("("+o(t.latLabel)+", "+o(t.lonLabel)+")"):p?d.push(h.lon+o(t.lonLabel)):v&&d.push(h.lat+o(t.latLabel)),f&&M(r,n,d),d.join("<br>")}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),calcGeoJSON:y("./plot").calcGeoJSON,plot:y("./plot").plot,style:y("./style"),styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover"),eventData:y("./event_data"),selectPoints:y("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:y("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../lib/topojson_utils").getTopojsonFeatures,M=y("../../lib/geojson_utils"),e=y("../../lib/geo_location_utils"),a=y("../../plots/cartesian/autorange").findExtremes,n=y("../../constants/numerical").BADNUM,r=y("../scatter/calc").calcMarkerSize,t=y("../scatter/subtypes"),h=y("./style");function s(x,p,v){var f=p.layers.frontplot.select(".scatterlayer"),d=g.makeTraceGroups(f,v,"trace scattergeo");function o(m,l){m.lonlat[0]===n&&A.select(l).remove()}d.selectAll("*").remove(),d.each(function(m){var l=A.select(this),w=m[0].trace;if(t.hasLines(w)||w.fill!=="none"){var _=M.calcTraceToLineCoords(m),c=w.fill!=="none"?M.makePolygon(_):M.makeLine(_);l.selectAll("path.js-line").data([{geojson:c,trace:w}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}t.hasMarkers(w)&&l.selectAll("path.point").data(g.identity).enter().append("path").classed("point",!0).each(function(b){o(b,this)}),t.hasText(w)&&l.selectAll("g").data(g.identity).enter().append("g").append("text").each(function(b){o(b,this)}),h(x,m)})}function i(x,p){var v=x[0].trace,f=p[v.geo],d=f._subplot,o=v._length,m,l;if(Array.isArray(v.locations)){var w=v.locationmode,_=w==="geojson-id"?e.extractTraceFeature(x):S(v,d.topojson);for(m=0;m<o;m++){l=x[m];var c=w==="geojson-id"?l.fOut:e.locationToFeature(w,l.loc,_);l.lonlat=c?c.properties.ct:[n,n]}}var b={padded:!0},u,L;if(f.fitbounds==="geojson"&&v.locationmode==="geojson-id"){var T=e.computeBbox(e.getTraceGeojson(v));u=[T[0],T[2]],L=[T[1],T[3]]}else{for(u=new Array(o),L=new Array(o),m=0;m<o;m++)l=x[m],u[m]=l.lonlat[0],L[m]=l.lonlat[1];b.ppad=r(v,o)}v._extremes.lon=a(f.lonaxis._ax,u,b),v._extremes.lat=a(f.lataxis._ax,L,b)}ee.exports={calcGeoJSON:i,plot:s}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(y,ee,te){var A=y("../scatter/subtypes"),g=y("../../constants/numerical").BADNUM;ee.exports=function(M,e){var a=M.cd,n=M.xaxis,r=M.yaxis,t=[],h=a[0].trace,s,i,x,p,v,f=!A.hasMarkers(h)&&!A.hasText(h);if(f)return[];if(e===!1)for(v=0;v<a.length;v++)a[v].selected=0;else for(v=0;v<a.length;v++)s=a[v],i=s.lonlat,i[0]!==g&&(x=n.c2p(i),p=r.c2p(i),e.contains([x,p],null,v,M)?(t.push({pointNumber:v,lon:i[0],lat:i[1]}),s.selected=1):s.selected=0);return t}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/drawing"),S=y("../../components/color"),M=y("../scatter/style"),e=M.stylePoints,a=M.styleText;ee.exports=function(t,h){h&&n(t,h)};function n(r,t){var h=t[0].trace,s=t[0].node3;s.style("opacity",t[0].trace.opacity),e(s,h,r),a(s,h,r),s.selectAll("path.js-line").style("fill","none").each(function(i){var x=A.select(this),p=i.trace,v=p.line||{};x.call(S.stroke,v.color).call(g.dashLine,v.dash||"",v.width||0),p.fill!=="none"&&x.call(S.fill,p.fillcolor)})}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(y,ee,te){var A=y("../../plots/attributes"),g=y("../scatter/attributes"),S=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=y("../../components/colorscale/attributes"),e=y("../../lib/sort_object_keys"),a=y("../../lib/extend").extendFlat,n=y("../../plot_api/edit_types").overrideAll,r=y("./constants").DASHES,t=g.line,h=g.marker,s=h.line,i=ee.exports=n({x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:S("x"),yhoverformat:S("y"),text:g.text,hovertext:g.hovertext,textposition:g.textposition,textfont:g.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:t.color,width:t.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(r),dflt:"solid"}},marker:a({},M("marker"),{symbol:h.symbol,angle:h.angle,size:h.size,sizeref:h.sizeref,sizemin:h.sizemin,sizemode:h.sizemode,opacity:h.opacity,colorbar:h.colorbar,line:a({},M("marker.line"),{width:s.width})}),connectgaps:g.connectgaps,fill:a({},g.fill,{dflt:"none"}),fillcolor:g.fillcolor,selected:{marker:g.selected.marker,textfont:g.selected.textfont},unselected:{marker:g.unselected.marker,textfont:g.unselected.textfont},opacity:A.opacity},"calc","nested");i.x.editType=i.y.editType=i.x0.editType=i.y0.editType="calc+clearAxisTypes",i.hovertemplate=g.hovertemplate,i.texttemplate=g.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(y,ee,te){var A=y("./hover");ee.exports={moduleType:"trace",name:"scattergl",basePlotModule:y("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("../scatter/cross_trace_defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),hoverPoints:A.hoverPoints,selectPoints:y("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(y,ee,te){var A=y("@plotly/point-cluster"),g=y("../../lib"),S=y("../../plots/cartesian/axis_ids"),M=y("../../plots/cartesian/autorange").findExtremes,e=y("../../plots/cartesian/align_period"),a=y("../scatter/calc"),n=a.calcMarkerSize,r=a.calcAxisExpansion,t=a.setFirstScatter,h=y("../scatter/colorscale_calc"),s=y("./convert"),i=y("./scene_update"),x=y("../../constants/numerical").BADNUM,p=y("./constants").TOO_MANY_POINTS;ee.exports=function(o,m){var l=o._fullLayout,w=m._xA=S.getFromId(o,m.xaxis,"x"),_=m._yA=S.getFromId(o,m.yaxis,"y"),c=l._plots[m.xaxis+m.yaxis],b=m._length,u=b>=p,L=b*2,T={},k,P=w.makeCalcdata(m,"x"),z=_.makeCalcdata(m,"y"),I=e(m,w,"x",P),D=e(m,_,"y",z),R=I.vals,O=D.vals;m._x=R,m._y=O,m.xperiodalignment&&(m._origX=P,m._xStarts=I.starts,m._xEnds=I.ends),m.yperiodalignment&&(m._origY=z,m._yStarts=D.starts,m._yEnds=D.ends);var F=new Array(L),N=new Array(b);for(k=0;k<b;k++)F[k*2]=R[k]===x?NaN:R[k],F[k*2+1]=O[k]===x?NaN:O[k],N[k]=k;if(w.type==="log")for(k=0;k<L;k+=2)F[k]=w.c2l(F[k]);if(_.type==="log")for(k=1;k<L;k+=2)F[k]=_.c2l(F[k]);u&&w.type!=="log"&&_.type!=="log"?T.tree=A(F):T.ids=N,h(o,m);var G=f(o,c,m,F,R,O),K=i(o,c);t(l,m);var W;return u?G.marker&&(W=G.marker.sizeAvg||Math.max(G.marker.size,3)):W=n(m,b),r(o,m,w,_,R,O,W),G.errorX&&v(m,w,G.errorX),G.errorY&&v(m,_,G.errorY),G.fill&&!K.fill2d&&(K.fill2d=!0),G.marker&&!K.scatter2d&&(K.scatter2d=!0),G.line&&!K.line2d&&(K.line2d=!0),(G.errorX||G.errorY)&&!K.error2d&&(K.error2d=!0),G.text&&!K.glText&&(K.glText=!0),G.marker&&(G.marker.snap=b),K.lineOptions.push(G.line),K.errorXOptions.push(G.errorX),K.errorYOptions.push(G.errorY),K.fillOptions.push(G.fill),K.markerOptions.push(G.marker),K.markerSelectedOptions.push(G.markerSel),K.markerUnselectedOptions.push(G.markerUnsel),K.textOptions.push(G.text),K.textSelectedOptions.push(G.textSel),K.textUnselectedOptions.push(G.textUnsel),K.selectBatch.push([]),K.unselectBatch.push([]),T._scene=K,T.index=K.count,T.x=R,T.y=O,T.positions=F,K.count++,[{x:!1,y:!1,t:T,trace:m}]};function v(d,o,m){var l=d._extremes[o._id],w=M(o,m._bnds,{padded:!0});l.min=l.min.concat(w.min),l.max=l.max.concat(w.max)}function f(d,o,m,l,w,_){var c=s.style(d,m);if(c.marker&&(c.marker.positions=l),c.line&&l.length>1&&g.extendFlat(c.line,s.linePositions(d,m,l)),c.errorX||c.errorY){var b=s.errorBarPositions(d,m,l,w,_);c.errorX&&g.extendFlat(c.errorX,b.x),c.errorY&&g.extendFlat(c.errorY,b.y)}return c.text&&(g.extendFlat(c.text,{positions:l},s.textPosition(d,m,c.text,c.marker)),g.extendFlat(c.textSel,{positions:l},s.textPosition(d,m,c.text,c.markerSel)),g.extendFlat(c.textUnsel,{positions:l},s.textPosition(d,m,c.text,c.markerUnsel))),c}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(y,ee,te){var A=20;ee.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:A,SYMBOL_STROKE:A/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("svg-path-sdf"),S=y("color-normalize"),M=y("../../registry"),e=y("../../lib"),a=y("../../components/drawing"),n=y("../../plots/cartesian/axis_ids"),r=y("../../lib/gl_format_color").formatColor,t=y("../scatter/subtypes"),h=y("../scatter/make_bubble_size_func"),s=y("./helpers"),i=y("./constants"),x=y("../../constants/interactions").DESELECTDIM,p={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},v=y("../../components/fx/helpers").appendArrayPointValue;function f(I,D){var R,O={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},F=I._context.plotGlPixelRatio;if(D.visible!==!0)return O;if(t.hasText(D)&&(O.text=d(I,D),O.textSel=l(I,D,D.selected),O.textUnsel=l(I,D,D.unselected)),t.hasMarkers(D)&&(O.marker=o(I,D),O.markerSel=m(I,D,D.selected),O.markerUnsel=m(I,D,D.unselected),!D.unselected&&e.isArrayOrTypedArray(D.marker.opacity))){var N=D.marker.opacity;for(O.markerUnsel.opacity=new Array(N.length),R=0;R<N.length;R++)O.markerUnsel.opacity[R]=x*N[R]}if(t.hasLines(D)){O.line={overlay:!0,thickness:D.line.width*F,color:D.line.color,opacity:D.opacity};var G=(i.DASHES[D.line.dash]||[1]).slice();for(R=0;R<G.length;++R)G[R]*=D.line.width*F;O.line.dashes=G}return D.error_x&&D.error_x.visible&&(O.errorX=w(D,D.error_x,F)),D.error_y&&D.error_y.visible&&(O.errorY=w(D,D.error_y,F)),D.fill&&D.fill!=="none"&&(O.fill={closed:!0,fill:D.fillcolor,thickness:0}),O}function d(I,D){var R=I._fullLayout,O=D._length,F=D.textfont,N=D.textposition,G=Array.isArray(N)?N:[N],K=F.color,W=F.size,Y=F.family,re={},ue,j=I._context.plotGlPixelRatio,q=D.texttemplate;if(q){re.text=[];var H=R._d3locale,U=Array.isArray(q),$=U?Math.min(q.length,O):O,ne=U?function(be){return q[be]}:function(){return q};for(ue=0;ue<$;ue++){var X={i:ue},Q=D._module.formatLabels(X,D,R),ie={};v(ie,D,ue);var se=D._meta||{};re.text.push(e.texttemplateString(ne(ue),Q,H,ie,X,se))}}else Array.isArray(D.text)&&D.text.length<O?re.text=D.text.slice():re.text=D.text;if(Array.isArray(re.text))for(ue=re.text.length;ue<O;ue++)re.text[ue]="";for(re.opacity=D.opacity,re.font={},re.align=[],re.baseline=[],ue=0;ue<G.length;ue++){var ae=G[ue].split(/\s+/);switch(ae[1]){case"left":re.align.push("right");break;case"right":re.align.push("left");break;default:re.align.push(ae[1])}switch(ae[0]){case"top":re.baseline.push("bottom");break;case"bottom":re.baseline.push("top");break;default:re.baseline.push(ae[0])}}if(Array.isArray(K))for(re.color=new Array(O),ue=0;ue<O;ue++)re.color[ue]=K[ue];else re.color=K;if(e.isArrayOrTypedArray(W)||Array.isArray(Y))for(re.font=new Array(O),ue=0;ue<O;ue++){var oe=re.font[ue]={};oe.size=(e.isTypedArray(W)?W[ue]:Array.isArray(W)?A(W[ue])?W[ue]:0:W)*j,oe.family=Array.isArray(Y)?Y[ue]:Y}else re.font={size:W*j,family:Y};return re}function o(I,D){var R=D._length,O=D.marker,F={},N,G=e.isArrayOrTypedArray(O.symbol),K=e.isArrayOrTypedArray(O.angle),W=e.isArrayOrTypedArray(O.color),Y=e.isArrayOrTypedArray(O.line.color),re=e.isArrayOrTypedArray(O.opacity),ue=e.isArrayOrTypedArray(O.size),j=e.isArrayOrTypedArray(O.line.width),q;if(G||(q=s.isOpenSymbol(O.symbol)),G||W||Y||re||K){F.symbols=new Array(R),F.angles=new Array(R),F.colors=new Array(R),F.borderColors=new Array(R);var H=O.symbol,U=O.angle,$=r(O,O.opacity,R),ne=r(O.line,O.opacity,R);if(!Array.isArray(ne[0])){var X=ne;for(ne=Array(R),N=0;N<R;N++)ne[N]=X}if(!Array.isArray($[0])){var Q=$;for($=Array(R),N=0;N<R;N++)$[N]=Q}if(!Array.isArray(H)){var ie=H;for(H=Array(R),N=0;N<R;N++)H[N]=ie}if(!Array.isArray(U)){var se=U;for(U=Array(R),N=0;N<R;N++)U[N]=se}for(F.symbols=H,F.angles=U,F.colors=$,F.borderColors=ne,N=0;N<R;N++)G&&(q=s.isOpenSymbol(O.symbol[N])),q&&(ne[N]=$[N].slice(),$[N]=$[N].slice(),$[N][3]=0);for(F.opacity=D.opacity,F.markers=new Array(R),N=0;N<R;N++)F.markers[N]=T({mx:F.symbols[N],ma:F.angles[N]},D)}else q?(F.color=S(O.color,"uint8"),F.color[3]=0,F.borderColor=S(O.color,"uint8")):(F.color=S(O.color,"uint8"),F.borderColor=S(O.line.color,"uint8")),F.opacity=D.opacity*O.opacity,F.marker=T({mx:O.symbol,ma:O.angle},D);var ae=1,oe=h(D,ae),be;if(ue||j){var ce=F.sizes=new Array(R),de=F.borderSizes=new Array(R),ye=0,ge;if(ue){for(N=0;N<R;N++)ce[N]=oe(O.size[N]),ye+=ce[N];ge=ye/R}else for(be=oe(O.size),N=0;N<R;N++)ce[N]=be;if(j)for(N=0;N<R;N++)de[N]=O.line.width[N];else for(be=O.line.width,N=0;N<R;N++)de[N]=be;F.sizeAvg=ge}else F.size=oe(O&&O.size||10),F.borderSizes=oe(O.line.width);return F}function m(I,D,R){var O=D.marker,F={};return R&&(R.marker&&R.marker.symbol?F=o(I,e.extendFlat({},O,R.marker)):R.marker&&(R.marker.size&&(F.size=R.marker.size),R.marker.color&&(F.colors=R.marker.color),R.marker.opacity!==void 0&&(F.opacity=R.marker.opacity))),F}function l(I,D,R){var O={};if(!R)return O;if(R.textfont){var F={opacity:1,text:D.text,texttemplate:D.texttemplate,textposition:D.textposition,textfont:e.extendFlat({},D.textfont)};R.textfont&&e.extendFlat(F.textfont,R.textfont),O=d(I,F)}return O}function w(I,D,R){var O={capSize:D.width*2*R,lineWidth:D.thickness*R,color:D.color};return D.copy_ystyle&&(O=I.error_y),O}var _=i.SYMBOL_SDF_SIZE,c=i.SYMBOL_SIZE,b=i.SYMBOL_STROKE,u={},L=a.symbolFuncs[0](c*.05);function T(I,D){var R=I.mx;if(R==="circle")return null;var O,F,N=a.symbolNumber(R),G=a.symbolFuncs[N%100],K=!!a.symbolNoDot[N%100],W=!!a.symbolNoFill[N%100],Y=s.isDotSymbol(R);if(I.ma&&(R+="_"+I.ma),u[R])return u[R];var re=a.getMarkerAngle(I,D);return Y&&!K?O=G(c*1.1,re)+L:O=G(c,re),F=g(O,{w:_,h:_,viewBox:[-c,-c,c,c],stroke:W?b:-b}),u[R]=F,F||null}function k(I,D,R){var O=R.length,F=O/2,N,G;if(t.hasLines(D)&&F)if(D.line.shape==="hv"){for(N=[],G=0;G<F-1;G++)isNaN(R[G*2])||isNaN(R[G*2+1])?N.push(NaN,NaN,NaN,NaN):(N.push(R[G*2],R[G*2+1]),!isNaN(R[G*2+2])&&!isNaN(R[G*2+3])?N.push(R[G*2+2],R[G*2+1]):N.push(NaN,NaN));N.push(R[O-2],R[O-1])}else if(D.line.shape==="hvh"){for(N=[],G=0;G<F-1;G++)if(isNaN(R[G*2])||isNaN(R[G*2+1])||isNaN(R[G*2+2])||isNaN(R[G*2+3]))!isNaN(R[G*2])&&!isNaN(R[G*2+1])?N.push(R[G*2],R[G*2+1]):N.push(NaN,NaN),N.push(NaN,NaN);else{var K=(R[G*2]+R[G*2+2])/2;N.push(R[G*2],R[G*2+1],K,R[G*2+1],K,R[G*2+3])}N.push(R[O-2],R[O-1])}else if(D.line.shape==="vhv"){for(N=[],G=0;G<F-1;G++)if(isNaN(R[G*2])||isNaN(R[G*2+1])||isNaN(R[G*2+2])||isNaN(R[G*2+3]))!isNaN(R[G*2])&&!isNaN(R[G*2+1])?N.push(R[G*2],R[G*2+1]):N.push(NaN,NaN),N.push(NaN,NaN);else{var W=(R[G*2+1]+R[G*2+3])/2;N.push(R[G*2],R[G*2+1],R[G*2],W,R[G*2+2],W)}N.push(R[O-2],R[O-1])}else if(D.line.shape==="vh"){for(N=[],G=0;G<F-1;G++)isNaN(R[G*2])||isNaN(R[G*2+1])?N.push(NaN,NaN,NaN,NaN):(N.push(R[G*2],R[G*2+1]),!isNaN(R[G*2+2])&&!isNaN(R[G*2+3])?N.push(R[G*2],R[G*2+3]):N.push(NaN,NaN));N.push(R[O-2],R[O-1])}else N=R;var Y=!1;for(G=0;G<N.length;G++)if(isNaN(N[G])){Y=!0;break}var re=Y||N.length>i.TOO_MANY_POINTS||t.hasMarkers(D)?"rect":"round";if(Y&&D.connectgaps){var ue=N[0],j=N[1];for(G=0;G<N.length;G+=2)isNaN(N[G])||isNaN(N[G+1])?(N[G]=ue,N[G+1]=j):(ue=N[G],j=N[G+1])}return{join:re,positions:N}}function P(I,D,R,O,F){var N=M.getComponentMethod("errorbars","makeComputeError"),G=n.getFromId(I,D.xaxis,"x"),K=n.getFromId(I,D.yaxis,"y"),W=R.length/2,Y={};function re(ue,j){var q=j._id.charAt(0),H=D["error_"+q];if(H&&H.visible&&(j.type==="linear"||j.type==="log")){for(var U=N(H),$={x:0,y:1}[q],ne={x:[0,1,2,3],y:[2,3,0,1]}[q],X=new Float64Array(4*W),Q=1/0,ie=-1/0,se=0,ae=0;se<W;se++,ae+=4){var oe=ue[se];if(A(oe)){var be=R[se*2+$],ce=U(oe,se),de=ce[0],ye=ce[1];if(A(de)&&A(ye)){var ge=oe-de,me=oe+ye;X[ae+ne[0]]=be-j.c2l(ge),X[ae+ne[1]]=j.c2l(me)-be,X[ae+ne[2]]=0,X[ae+ne[3]]=0,Q=Math.min(Q,oe-de),ie=Math.max(ie,oe+ye)}}}Y[q]={positions:R,errors:X,_bnds:[Q,ie]}}}return re(O,G),re(F,K),Y}function z(I,D,R,O){var F=D._length,N={},G;if(t.hasMarkers(D)){var K=R.font,W=R.align,Y=R.baseline;for(N.offset=new Array(F),G=0;G<F;G++){var re=O.sizes?O.sizes[G]:O.size,ue=Array.isArray(K)?K[G].size:K.size,j=Array.isArray(W)?W.length>1?W[G]:W[0]:W,q=Array.isArray(Y)?Y.length>1?Y[G]:Y[0]:Y,H=p[j],U=p[q],$=re?re/.8+1:0,ne=-U*$-U*.5;N.offset[G]=[H*$/ue,ne/ue]}}return N}ee.exports={style:f,markerStyle:o,markerSelection:m,linePositions:k,errorBarPositions:P,textPosition:z}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(y,ee,te){var A=y("../../lib"),g=y("../../registry"),S=y("./helpers"),M=y("./attributes"),e=y("../scatter/constants"),a=y("../scatter/subtypes"),n=y("../scatter/xy_defaults"),r=y("../scatter/period_defaults"),t=y("../scatter/marker_defaults"),h=y("../scatter/line_defaults"),s=y("../scatter/fillcolor_defaults"),i=y("../scatter/text_defaults");ee.exports=function(p,v,f,d){function o(L,T){return A.coerce(p,v,M,L,T)}var m=p.marker?S.isOpenSymbol(p.marker.symbol):!1,l=a.isBubble(p),w=n(p,v,d,o);if(!w){v.visible=!1;return}r(p,v,d,o),o("xhoverformat"),o("yhoverformat");var _=w<e.PTS_LINESONLY?"lines+markers":"lines";o("text"),o("hovertext"),o("hovertemplate"),o("mode",_),a.hasLines(v)&&(o("connectgaps"),h(p,v,f,d,o),o("line.shape")),a.hasMarkers(v)&&(t(p,v,f,d,o,{noAngleRef:!0,noStandOff:!0}),o("marker.line.width",m||l?1:0)),a.hasText(v)&&(o("texttemplate"),i(p,v,d,o));var c=(v.line||{}).color,b=(v.marker||{}).color;o("fill"),v.fill!=="none"&&s(p,v,f,o);var u=g.getComponentMethod("errorbars","supplyDefaults");u(p,v,c||b||f,{axis:"y"}),u(p,v,c||b||f,{axis:"x",inherit:"y"}),A.coerceSelectionMarkerOpacity(v,o)}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color"),S=y("../../constants/interactions").DESELECTDIM;function M(e){var a=e[0],n=a.trace,r=a.t,t=r._scene,h=r.index,s=t.selectBatch[h],i=t.unselectBatch[h],x=t.textOptions[h],p=t.textSelectedOptions[h]||{},v=t.textUnselectedOptions[h]||{},f=A.extendFlat({},x),d,o;if(s.length||i.length){var m=p.color,l=v.color,w=x.color,_=Array.isArray(w);for(f.color=new Array(n._length),d=0;d<s.length;d++)o=s[d],f.color[o]=m||(_?w[o]:w);for(d=0;d<i.length;d++){o=i[d];var c=_?w[o]:w;f.color[o]=l||(m?c:g.addOpacity(c,S))}}t.glText[h].update(f)}ee.exports={styleTextSelection:M}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(y,ee,te){var A=y("../scatter/format_labels");ee.exports=function(S,M,e){var a=S.i;return"x"in S||(S.x=M._x[a]),"y"in S||(S.y=M._y[a]),A(S,M,e)}},{"../scatter/format_labels":945}],996:[function(y,ee,te){var A=y("./constants");te.isOpenSymbol=function(g){return typeof g=="string"?A.OPEN_RE.test(g):g%200>100},te.isDotSymbol=function(g){return typeof g=="string"?A.DOT_RE.test(g):g>200}},{"./constants":991}],997:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("../scatter/get_trace_color");function M(a,n,r,t){var h=a.cd,s=h[0].t,i=h[0].trace,x=a.xa,p=a.ya,v=s.x,f=s.y,d=x.c2p(n),o=p.c2p(r),m=a.distance,l;if(s.tree){var w=x.p2c(d-m),_=x.p2c(d+m),c=p.p2c(o-m),b=p.p2c(o+m);t==="x"?l=s.tree.range(Math.min(w,_),Math.min(p._rl[0],p._rl[1]),Math.max(w,_),Math.max(p._rl[0],p._rl[1])):l=s.tree.range(Math.min(w,_),Math.min(c,b),Math.max(w,_),Math.max(c,b))}else l=s.ids;var u,L,T,k,P,z,I,D,R,O=m;if(t==="x"){var F=!!i.xperiodalignment,N=!!i.yperiodalignment;for(P=0;P<l.length;P++){if(u=l[P],T=v[u],z=Math.abs(x.c2p(T)-d),F){var G=x.c2p(i._xStarts[u]),K=x.c2p(i._xEnds[u]);z=d>=Math.min(G,K)&&d<=Math.max(G,K)?0:1/0}if(z<O){if(O=z,k=f[u],I=p.c2p(k)-o,N){var W=p.c2p(i._yStarts[u]),Y=p.c2p(i._yEnds[u]);I=o>=Math.min(W,Y)&&o<=Math.max(W,Y)?0:1/0}R=Math.sqrt(z*z+I*I),L=l[P]}}}else for(P=l.length-1;P>-1;P--)u=l[P],T=v[u],k=f[u],z=x.c2p(T)-d,I=p.c2p(k)-o,D=Math.sqrt(z*z+I*I),D<O&&(O=R=D,L=u);return a.index=L,a.distance=O,a.dxy=R,L===void 0?[a]:[e(a,v,f,i)]}function e(a,n,r,t){var h=a.xa,s=a.ya,i=a.distance,x=a.dxy,p=a.index,v={pointNumber:p,x:n[p],y:r[p]};v.tx=Array.isArray(t.text)?t.text[p]:t.text,v.htx=Array.isArray(t.hovertext)?t.hovertext[p]:t.hovertext,v.data=Array.isArray(t.customdata)?t.customdata[p]:t.customdata,v.tp=Array.isArray(t.textposition)?t.textposition[p]:t.textposition;var f=t.textfont;f&&(v.ts=g.isArrayOrTypedArray(f.size)?f.size[p]:f.size,v.tc=Array.isArray(f.color)?f.color[p]:f.color,v.tf=Array.isArray(f.family)?f.family[p]:f.family);var d=t.marker;d&&(v.ms=g.isArrayOrTypedArray(d.size)?d.size[p]:d.size,v.mo=g.isArrayOrTypedArray(d.opacity)?d.opacity[p]:d.opacity,v.mx=g.isArrayOrTypedArray(d.symbol)?d.symbol[p]:d.symbol,v.ma=g.isArrayOrTypedArray(d.angle)?d.angle[p]:d.angle,v.mc=g.isArrayOrTypedArray(d.color)?d.color[p]:d.color);var o=d&&d.line;o&&(v.mlc=Array.isArray(o.color)?o.color[p]:o.color,v.mlw=g.isArrayOrTypedArray(o.width)?o.width[p]:o.width);var m=d&&d.gradient;m&&m.type!=="none"&&(v.mgt=Array.isArray(m.type)?m.type[p]:m.type,v.mgc=Array.isArray(m.color)?m.color[p]:m.color);var l=h.c2p(v.x,!0),w=s.c2p(v.y,!0),_=v.mrc||1,c=t.hoverlabel;c&&(v.hbg=Array.isArray(c.bgcolor)?c.bgcolor[p]:c.bgcolor,v.hbc=Array.isArray(c.bordercolor)?c.bordercolor[p]:c.bordercolor,v.hts=g.isArrayOrTypedArray(c.font.size)?c.font.size[p]:c.font.size,v.htc=Array.isArray(c.font.color)?c.font.color[p]:c.font.color,v.htf=Array.isArray(c.font.family)?c.font.family[p]:c.font.family,v.hnl=g.isArrayOrTypedArray(c.namelength)?c.namelength[p]:c.namelength);var b=t.hoverinfo;b&&(v.hi=Array.isArray(b)?b[p]:b);var u=t.hovertemplate;u&&(v.ht=Array.isArray(u)?u[p]:u);var L={};L[a.index]=v;var T=t._origX,k=t._origY,P=g.extendFlat({},a,{color:S(t,v),x0:l-_,x1:l+_,xLabelVal:T?T[p]:v.x,y0:w-_,y1:w+_,yLabelVal:k?k[p]:v.y,cd:L,distance:i,spikeDistance:x,hovertemplate:v.ht});return v.htx?P.text=v.htx:v.tx?P.text=v.tx:t.text&&(P.text=t.text),g.fillText(v,t,P),A.getComponentMethod("errorbars","hoverInfo")(v,t,P),P}ee.exports={hoverPoints:M,calcHover:e}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(y,ee,te){arguments[4][905][0].apply(te,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(y,ee,x){var A=y("regl-scatter2d"),g=y("regl-line2d"),S=y("regl-error2d"),M=y("gl-text"),e=y("../../lib"),a=y("../../components/dragelement/helpers").selectMode,n=y("../../lib/prepare_regl"),r=y("../scatter/subtypes"),t=y("../scatter/link_traces"),h=y("./edit_style").styleTextSelection,s={};function i(p,v,f,d){var o=p._size,m=p.width*d,l=p.height*d,w=o.l*d,_=o.b*d,c=o.r*d,b=o.t*d,u=o.w*d,L=o.h*d;return[w+v.domain[0]*u,_+f.domain[0]*L,m-c-(1-v.domain[1])*u,l-b-(1-f.domain[1])*L]}var x=ee.exports=function(v,f,d){if(d.length){var o=v._fullLayout,m=f._scene,l=f.xaxis,w=f.yaxis,_,c;if(m){var b=n(v,["ANGLE_instanced_arrays","OES_element_index_uint"],s);if(!b){m.init();return}var u=m.count,L=o._glcanvas.data()[0].regl;if(t(v,f,d),m.dirty){if(m.error2d===!0&&(m.error2d=S(L)),m.line2d===!0&&(m.line2d=g(L)),m.scatter2d===!0&&(m.scatter2d=A(L)),m.fill2d===!0&&(m.fill2d=g(L)),m.glText===!0)for(m.glText=new Array(u),_=0;_<u;_++)m.glText[_]=new M(L);if(m.glText){if(u>m.glText.length){var T=u-m.glText.length;for(_=0;_<T;_++)m.glText.push(new M(L))}else if(u<m.glText.length){var k=m.glText.length-u,P=m.glText.splice(u,k);P.forEach(function(X){X.destroy()})}for(_=0;_<u;_++)m.glText[_].update(m.textOptions[_])}if(m.line2d&&(m.line2d.update(m.lineOptions),m.lineOptions=m.lineOptions.map(function(X){if(X&&X.positions){for(var Q=X.positions,ie=0;ie<Q.length&&(isNaN(Q[ie])||isNaN(Q[ie+1]));)ie+=2;for(var se=Q.length-2;se>ie&&(isNaN(Q[se])||isNaN(Q[se+1]));)se-=2;X.positions=Q.slice(ie,se+2)}return X}),m.line2d.update(m.lineOptions)),m.error2d){var z=(m.errorXOptions||[]).concat(m.errorYOptions||[]);m.error2d.update(z)}m.scatter2d&&m.scatter2d.update(m.markerOptions),m.fillOrder=e.repeat(null,u),m.fill2d&&(m.fillOptions=m.fillOptions.map(function(X,Q){var ie=d[Q];if(!(!X||!ie||!ie[0]||!ie[0].trace)){var se=ie[0],ae=se.trace,oe=se.t,be=m.lineOptions[Q],ce,de,ye=[];ae._ownfill&&ye.push(Q),ae._nexttrace&&ye.push(Q+1),ye.length&&(m.fillOrder[Q]=ye);var ge=[],me=be&&be.positions||oe.positions,Ee,Pe;if(ae.fill==="tozeroy"){for(Ee=0;Ee<me.length&&isNaN(me[Ee+1]);)Ee+=2;for(Pe=me.length-2;Pe>Ee&&isNaN(me[Pe+1]);)Pe-=2;me[Ee+1]!==0&&(ge=[me[Ee],0]),ge=ge.concat(me.slice(Ee,Pe+2)),me[Pe+1]!==0&&(ge=ge.concat([me[Pe],0]))}else if(ae.fill==="tozerox"){for(Ee=0;Ee<me.length&&isNaN(me[Ee]);)Ee+=2;for(Pe=me.length-2;Pe>Ee&&isNaN(me[Pe]);)Pe-=2;me[Ee]!==0&&(ge=[0,me[Ee+1]]),ge=ge.concat(me.slice(Ee,Pe+2)),me[Pe]!==0&&(ge=ge.concat([0,me[Pe+1]]))}else if(ae.fill==="toself"||ae.fill==="tonext"){for(ge=[],ce=0,X.splitNull=!0,de=0;de<me.length;de+=2)(isNaN(me[de])||isNaN(me[de+1]))&&(ge=ge.concat(me.slice(ce,de)),ge.push(me[ce],me[ce+1]),ge.push(null,null),ce=de+2);ge=ge.concat(me.slice(ce)),ce&&ge.push(me[ce],me[ce+1])}else{var Ue=ae._nexttrace;if(Ue){var we=m.lineOptions[Q+1];if(we){var ke=we.positions;if(ae.fill==="tonexty"){for(ge=me.slice(),Q=Math.floor(ke.length/2);Q--;){var Xe=ke[Q*2],Ve=ke[Q*2+1];isNaN(Xe)||isNaN(Ve)||ge.push(Xe,Ve)}X.fill=Ue.fillcolor}}}}if(ae._prevtrace&&ae._prevtrace.fill==="tonext"){var Ie=m.lineOptions[Q-1].positions,De=ge.length/2;ce=De;var Ye=[ce];for(de=0;de<Ie.length;de+=2)(isNaN(Ie[de])||isNaN(Ie[de+1]))&&(Ye.push(de/2+De+1),ce=de+2);ge=ge.concat(Ie),X.hole=Ye}return X.fillmode=ae.fill,X.opacity=ae.opacity,X.positions=ge,X}}),m.fill2d.update(m.fillOptions))}var I=o.dragmode,D=a(I),R=o.clickmode.indexOf("select")>-1;for(_=0;_<u;_++){var O=d[_][0],F=O.trace,N=O.t,G=N.index,K=F._length,W=N.x,Y=N.y;if(F.selectedpoints||D||R){if(D||(D=!0),F.selectedpoints){var re=m.selectBatch[G]=e.selIndices2selPoints(F),ue={};for(c=0;c<re.length;c++)ue[re[c]]=1;var j=[];for(c=0;c<K;c++)ue[c]||j.push(c);m.unselectBatch[G]=j}var q=N.xpx=new Array(K),H=N.ypx=new Array(K);for(c=0;c<K;c++)q[c]=l.c2p(W[c]),H[c]=w.c2p(Y[c])}else N.xpx=N.ypx=null}if(D){if(m.select2d||(m.select2d=A(o._glcanvas.data()[1].regl)),m.scatter2d){var U=new Array(u);for(_=0;_<u;_++)U[_]=m.selectBatch[_].length||m.unselectBatch[_].length?m.markerUnselectedOptions[_]:{};m.scatter2d.update(U)}m.select2d&&(m.select2d.update(m.markerOptions),m.select2d.update(m.markerSelectedOptions)),m.glText&&d.forEach(function(X){var Q=((X||[])[0]||{}).trace||{};r.hasText(Q)&&h(X)})}else m.scatter2d&&m.scatter2d.update(m.markerOptions);var $={viewport:i(o,l,w,v._context.plotGlPixelRatio),range:[(l._rl||l.range)[0],(w._rl||w.range)[0],(l._rl||l.range)[1],(w._rl||w.range)[1]]},ne=e.repeat($,m.count);m.fill2d&&m.fill2d.update(ne),m.line2d&&m.line2d.update(ne),m.error2d&&m.error2d.update(ne.concat(ne)),m.scatter2d&&m.scatter2d.update(ne),m.select2d&&m.select2d.update(ne),m.glText&&m.glText.forEach(function(X){X.update($)})}}};x.reglPrecompiled=s},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){var e=M._scene,a={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},n={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return M._scene||(e=M._scene={},e.init=function(){A.extendFlat(e,n,a)},e.init(),e.update=function(t){var h=A.repeat(t,e.count);if(e.fill2d&&e.fill2d.update(h),e.scatter2d&&e.scatter2d.update(h),e.line2d&&e.line2d.update(h),e.error2d&&e.error2d.update(h.concat(h)),e.select2d&&e.select2d.update(h),e.glText)for(var s=0;s<e.count;s++)e.glText[s].update(t)},e.draw=function(){for(var t=e.count,h=e.fill2d,s=e.error2d,i=e.line2d,x=e.scatter2d,p=e.glText,v=e.select2d,f=e.selectBatch,d=e.unselectBatch,o=0;o<t;o++){if(h&&e.fillOrder[o]&&h.draw(e.fillOrder[o]),i&&e.lineOptions[o]&&i.draw(o),s&&(e.errorXOptions[o]&&s.draw(o),e.errorYOptions[o]&&s.draw(o+t)),x&&e.markerOptions[o])if(d[o].length){var m=A.repeat([],e.count);m[o]=d[o],x.draw(m)}else f[o].length||x.draw(o);p[o]&&e.textOptions[o]&&p[o].render()}v&&v.draw(f),e.dirty=!1},e.destroy=function(){e.fill2d&&e.fill2d.destroy&&e.fill2d.destroy(),e.scatter2d&&e.scatter2d.destroy&&e.scatter2d.destroy(),e.error2d&&e.error2d.destroy&&e.error2d.destroy(),e.line2d&&e.line2d.destroy&&e.line2d.destroy(),e.select2d&&e.select2d.destroy&&e.select2d.destroy(),e.glText&&e.glText.forEach(function(t){t.destroy&&t.destroy()}),e.lineOptions=null,e.fillOptions=null,e.markerOptions=null,e.markerSelectedOptions=null,e.markerUnselectedOptions=null,e.errorXOptions=null,e.errorYOptions=null,e.textOptions=null,e.textSelectedOptions=null,e.textUnselectedOptions=null,e.selectBatch=null,e.unselectBatch=null,M._scene=null}),e.dirty||A.extendFlat(e,a),e}},{"../../lib":515}],1001:[function(y,ee,te){var A=y("../scatter/subtypes"),g=y("./edit_style").styleTextSelection;ee.exports=function(M,e){var a=M.cd,n=M.xaxis,r=M.yaxis,t=[],h=a[0].trace,s=a[0].t,i=h._length,x=s.x,p=s.y,v=s._scene,f=s.index;if(!v)return t;var d=A.hasText(h),o=A.hasMarkers(h),m=!o&&!d;if(h.visible!==!0||m)return t;var l=[],w=[];if(e!==!1&&!e.degenerate)for(var _=0;_<i;_++)e.contains([s.xpx[_],s.ypx[_]],!1,_,M)?(l.push(_),t.push({pointNumber:_,x:n.c2d(x[_]),y:r.c2d(p[_])})):w.push(_);if(o){var c=v.scatter2d;if(!l.length&&!w.length){var b=new Array(v.count);b[f]=v.markerOptions[f],c.update.apply(c,b)}else if(!v.selectBatch[f].length&&!v.unselectBatch[f].length){var u=new Array(v.count);u[f]=v.markerUnselectedOptions[f],c.update.apply(c,u)}}return v.selectBatch[f]=l,v.unselectBatch[f]=w,d&&g(a),t}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../../plots/template_attributes").texttemplateAttrs,S=y("../scattergeo/attributes"),M=y("../scatter/attributes"),e=y("../../plots/mapbox/layout_attributes"),a=y("../../plots/attributes"),n=y("../../components/colorscale/attributes"),r=y("../../lib/extend").extendFlat,t=y("../../plot_api/edit_types").overrideAll,h=y("../../plots/mapbox/layout_attributes"),s=S.line,i=S.marker;ee.exports=t({lon:S.lon,lat:S.lat,cluster:{enabled:{valType:"boolean"},maxzoom:r({},h.layers.maxzoom,{}),step:{valType:"number",arrayOk:!0,dflt:-1,min:-1},size:{valType:"number",arrayOk:!0,dflt:20,min:0},color:{valType:"color",arrayOk:!0},opacity:r({},i.opacity,{dflt:1})},mode:r({},M.mode,{dflt:"markers"}),text:r({},M.text,{}),texttemplate:g({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:r({},M.hovertext,{}),line:{color:s.color,width:s.width},connectgaps:M.connectgaps,marker:r({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:i.opacity,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode},n("marker")),fill:S.fill,fillcolor:M.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:M.selected.marker},unselected:{marker:M.unselected.marker},hoverinfo:r({},a.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:A()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../lib"),S=y("../../constants/numerical").BADNUM,M=y("../../lib/geojson_utils"),e=y("../../components/colorscale"),a=y("../../components/drawing"),n=y("../scatter/make_bubble_size_func"),r=y("../scatter/subtypes"),t=y("../../plots/mapbox/convert_text_opts"),h=y("../../components/fx/helpers").appendArrayPointValue,s=y("../../lib/svg_text_utils").NEWLINES,i=y("../../lib/svg_text_utils").BR_TAG_ALL;ee.exports=function(w,_){var c=_[0].trace,b=c.visible===!0&&c._length!==0,u=c.fill!=="none",L=r.hasLines(c),T=r.hasMarkers(c),k=r.hasText(c),P=T&&c.marker.symbol==="circle",z=T&&c.marker.symbol!=="circle",I=c.cluster&&c.cluster.enabled,D=x("fill"),R=x("line"),O=x("circle"),F=x("symbol"),N={fill:D,line:R,circle:O,symbol:F};if(!b)return N;var G;if((u||L)&&(G=M.calcTraceToLineCoords(_)),u&&(D.geojson=M.makePolygon(G),D.layout.visibility="visible",g.extendFlat(D.paint,{"fill-color":c.fillcolor})),L&&(R.geojson=M.makeLine(G),R.layout.visibility="visible",g.extendFlat(R.paint,{"line-width":c.line.width,"line-color":c.line.color,"line-opacity":c.opacity})),P){var K=p(_);O.geojson=K.geojson,O.layout.visibility="visible",I&&(O.filter=["!",["has","point_count"]],N.cluster={type:"circle",filter:["has","point_count"],layout:{visibility:"visible"},paint:{"circle-color":m(c.cluster.color,c.cluster.step),"circle-radius":m(c.cluster.size,c.cluster.step),"circle-opacity":m(c.cluster.opacity,c.cluster.step)}},N.clusterCount={type:"symbol",filter:["has","point_count"],paint:{},layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12}}),g.extendFlat(O.paint,{"circle-color":K.mcc,"circle-radius":K.mrc,"circle-opacity":K.mo})}if(P&&I&&(O.filter=["!",["has","point_count"]]),(z||k)&&(F.geojson=v(_,w),g.extendFlat(F.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),z&&(g.extendFlat(F.layout,{"icon-size":c.marker.size/10}),"angle"in c.marker&&c.marker.angle!=="auto"&&g.extendFlat(F.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),F.layout["icon-allow-overlap"]=c.marker.allowoverlap,g.extendFlat(F.paint,{"icon-opacity":c.opacity*c.marker.opacity,"icon-color":c.marker.color})),k)){var W=(c.marker||{}).size,Y=t(c.textposition,W);g.extendFlat(F.layout,{"text-size":c.textfont.size,"text-anchor":Y.anchor,"text-offset":Y.offset}),g.extendFlat(F.paint,{"text-color":c.textfont.color,"text-opacity":c.opacity})}return N};function x(l){return{type:l,geojson:M.makeBlank(),layout:{visibility:"none"},filter:null,paint:{}}}function p(l){var w=l[0].trace,_=w.marker,c=w.selectedpoints,b=g.isArrayOrTypedArray(_.color),u=g.isArrayOrTypedArray(_.size),L=g.isArrayOrTypedArray(_.opacity),T;function k(W){return w.opacity*W}function P(W){return W/2}var z;b&&(e.hasColorscale(w,"marker")?z=e.makeColorScaleFuncFromTrace(_):z=g.identity);var I;u&&(I=n(w));var D;L&&(D=function(W){var Y=A(W)?+g.constrain(W,0,1):0;return k(Y)});var R=[];for(T=0;T<l.length;T++){var O=l[T],F=O.lonlat;if(!o(F)){var N={};z&&(N.mcc=O.mcc=z(O.mc)),I&&(N.mrc=O.mrc=I(O.ms)),D&&(N.mo=D(O.mo)),c&&(N.selected=O.selected||0),R.push({type:"Feature",id:T+1,geometry:{type:"Point",coordinates:F},properties:N})}}var G;if(c)for(G=a.makeSelectedPointStyleFns(w),T=0;T<R.length;T++){var K=R[T].properties;G.selectedOpacityFn&&(K.mo=k(G.selectedOpacityFn(K))),G.selectedColorFn&&(K.mcc=G.selectedColorFn(K)),G.selectedSizeFn&&(K.mrc=G.selectedSizeFn(K))}return{geojson:{type:"FeatureCollection",features:R},mcc:b||G&&G.selectedColorFn?{type:"identity",property:"mcc"}:_.color,mrc:u||G&&G.selectedSizeFn?{type:"identity",property:"mrc"}:P(_.size),mo:L||G&&G.selectedOpacityFn?{type:"identity",property:"mo"}:k(_.opacity)}}function v(l,w){for(var _=w._fullLayout,c=l[0].trace,b=c.marker||{},u=b.symbol,L=b.angle,T=u!=="circle"?f(u):d,k=L!=="auto"?f(L,!0):d,P=r.hasText(c)?f(c.text):d,z=[],I=0;I<l.length;I++){var D=l[I];if(!o(D.lonlat)){var R=c.texttemplate,O;if(R){var F=Array.isArray(R)?R[I]||"":R,N=c._module.formatLabels(D,c,_),G={};h(G,c,D.i);var K=c._meta||{};O=g.texttemplateString(F,N,_._d3locale,G,D,K)}else O=P(I);O&&(O=O.replace(s,"").replace(i,`
`)),z.push({type:"Feature",geometry:{type:"Point",coordinates:D.lonlat},properties:{symbol:T(I),angle:k(I),text:O}})}}return{type:"FeatureCollection",features:z}}function f(l,w){return g.isArrayOrTypedArray(l)?w?function(_){return A(l[_])?+l[_]:0}:function(_){return l[_]}:l?function(){return l}:d}function d(){return""}function o(l){return l[0]===S}function m(l,w){var _;if(g.isArrayOrTypedArray(l)&&g.isArrayOrTypedArray(w)){_=["step",["get","point_count"],l[0]];for(var c=1;c<l.length;c++)_.push(w[c-1],l[c])}else _=l;return _}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/subtypes"),S=y("../scatter/marker_defaults"),M=y("../scatter/line_defaults"),e=y("../scatter/text_defaults"),a=y("../scatter/fillcolor_defaults"),n=y("./attributes");ee.exports=function(h,s,i,x){function p(b,u){return A.coerce(h,s,n,b,u)}function v(b,u){return A.coerce2(h,s,n,b,u)}var f=r(h,s,p);if(!f){s.visible=!1;return}if(p("text"),p("texttemplate"),p("hovertext"),p("hovertemplate"),p("mode"),p("below"),g.hasLines(s)&&(M(h,s,i,x,p,{noDash:!0}),p("connectgaps")),g.hasMarkers(s)){S(h,s,i,x,p,{noLine:!0,noAngle:!0}),p("marker.allowoverlap"),p("marker.angle");var d=s.marker;d.symbol!=="circle"&&(A.isArrayOrTypedArray(d.size)&&(d.size=d.size[0]),A.isArrayOrTypedArray(d.color)&&(d.color=d.color[0]))}var o=v("cluster.maxzoom"),m=v("cluster.step"),l=v("cluster.color",s.marker&&s.marker.color||i),w=v("cluster.size"),_=v("cluster.opacity"),c=o!==!1||m!==!1||l!==!1||w!==!1||_!==!1;p("cluster.enabled",c),g.hasText(s)&&e(h,s,x,p,{noSelect:!0}),p("fill"),s.fill!=="none"&&a(h,s,i,p),A.coerceSelectionMarkerOpacity(s,p)};function r(t,h,s){var i=s("lon")||[],x=s("lat")||[],p=Math.min(i.length,x.length);return h._length=p,p}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(y,ee,te){ee.exports=function(g,S){return g.lon=S.lon,g.lat=S.lat,g}},{}],1006:[function(y,ee,te){var A=y("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot,r=n.mockAxis,t=S.lonlat;return a.lonLabel=A.tickText(r,r.c2l(t[0]),!0).text,a.latLabel=A.tickText(r,r.c2l(t[1]),!0).text,a}},{"../../plots/cartesian/axes":566}],1007:[function(y,ee,te){var A=y("../../components/fx"),g=y("../../lib"),S=y("../scatter/get_trace_color"),M=g.fillText,e=y("../../constants/numerical").BADNUM,a=y("../../plots/mapbox/constants").traceLayerPrefix;function n(t,h,s){var i=t.cd,x=i[0].trace,p=t.xa,v=t.ya,f=t.subplot,d=[],o=a+x.uid+"-circle",m=x.cluster&&x.cluster.enabled;if(m){var l=f.map.queryRenderedFeatures(null,{layers:[o]});d=l.map(function(R){return R.id})}var w=h>=0?Math.floor((h+180)/360):Math.ceil((h-180)/360),_=w*360,c=h-_;function b(R){var O=R.lonlat;if(O[0]===e||m&&d.indexOf(R.i+1)===-1)return 1/0;var F=g.modHalf(O[0],360),N=O[1],G=f.project([F,N]),K=G.x-p.c2p([c,N]),W=G.y-v.c2p([F,s]),Y=Math.max(3,R.mrc||0);return Math.max(Math.sqrt(K*K+W*W)-Y,1-3/Y)}if(A.getClosest(i,b,t),t.index!==!1){var u=i[t.index],L=u.lonlat,T=[g.modHalf(L[0],360)+_,L[1]],k=p.c2p(T),P=v.c2p(T),z=u.mrc||1;t.x0=k-z,t.x1=k+z,t.y0=P-z,t.y1=P+z;var I={};I[x.subplot]={_subplot:f};var D=x._module.formatLabels(u,x,I);return t.lonLabel=D.lonLabel,t.latLabel=D.latLabel,t.color=S(x,u),t.extraText=r(x,u,i[0].t.labels),t.hovertemplate=x.hovertemplate,[t]}}function r(t,h,s){if(t.hovertemplate)return;var i=h.hi||t.hoverinfo,x=i.split("+"),p=x.indexOf("all")!==-1,v=x.indexOf("lon")!==-1,f=x.indexOf("lat")!==-1,d=h.lonlat,o=[];function m(l){return l+""}return p||v&&f?o.push("("+m(d[1])+", "+m(d[0])+")"):v?o.push(s.lon+m(d[0])):f&&o.push(s.lat+m(d[1])),(p||x.indexOf("text")!==-1)&&M(h,t,o),o.join("<br>")}ee.exports={hoverPoints:n,getExtraText:r}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/mapbox/constants":620,"../scatter/get_trace_color":946}],1008:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("../scattergeo/calc"),plot:y("./plot"),hoverPoints:y("./hover").hoverPoints,eventData:y("./event_data"),selectPoints:y("./select"),styleOnSelect:function(A,g){if(g){var S=g[0].trace;S._glTrace.update(g)}},moduleType:"trace",name:"scattermapbox",basePlotModule:y("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(y,ee,te){var A=y("../../lib"),g=y("./convert"),S=y("../../plots/mapbox/constants").traceLayerPrefix,M={cluster:["cluster","clusterCount","circle"],nonCluster:["fill","line","circle","symbol"]};function e(n,r,t){this.type="scattermapbox",this.subplot=n,this.uid=r,this.clusterEnabled=t,this.sourceIds={fill:"source-"+r+"-fill",line:"source-"+r+"-line",circle:"source-"+r+"-circle",symbol:"source-"+r+"-symbol",cluster:"source-"+r+"-circle",clusterCount:"source-"+r+"-circle"},this.layerIds={fill:S+r+"-fill",line:S+r+"-line",circle:S+r+"-circle",symbol:S+r+"-symbol",cluster:S+r+"-cluster",clusterCount:S+r+"-cluster-count"},this.below=null}var a=e.prototype;a.addSource=function(n,r,t){var h={type:"geojson",data:r.geojson};t&&t.enabled&&A.extendFlat(h,{cluster:!0,clusterMaxZoom:t.maxzoom}),this.subplot.map.addSource(this.sourceIds[n],h)},a.setSourceData=function(n,r){this.subplot.map.getSource(this.sourceIds[n]).setData(r.geojson)},a.addLayer=function(n,r,t){var h={type:r.type,id:this.layerIds[n],source:this.sourceIds[n],layout:r.layout,paint:r.paint};r.filter&&(h.filter=r.filter),this.subplot.addLayer(h,t)},a.update=function(r){var t=r[0].trace,h=this.subplot,s=h.map,i=g(h.gd,r),x=h.belowLookup["trace-"+this.uid],p,v,f,d=!!(t.cluster&&t.cluster.enabled),o=!!this.clusterEnabled;if(x!==this.below){var m=M.nonCluster;for(p=m.length-1;p>=0;p--)v=m[p],s.removeLayer(this.layerIds[v]);for(p=0;p<m.length;p++)v=m[p],f=i[v],this.addLayer(v,f,x);this.below=x}else if(d&&!o){for(p=M.nonCluster.length-1;p>=0;p--)v=M.nonCluster[p],s.removeLayer(this.layerIds[v]),s.removeSource(this.sourceIds[v]);for(this.addSource("circle",i.circle,t.cluster),p=0;p<M.cluster.length;p++)v=M.cluster[p],f=i[v],this.addLayer(v,f,x);this.clusterEnabled=d}else if(!d&&o){for(p=0;p<M.cluster.length;p++)v=M.cluster[p],s.removeLayer(this.layerIds[v]);for(s.removeSource(this.sourceIds.circle),p=0;p<M.nonCluster.length;p++)v=M.nonCluster[p],f=i[v],this.addSource(v,f,t.cluster),this.addLayer(v,f,x);this.clusterEnabled=d}r[0].trace._glTrace=this},a.dispose=function(){for(var r=this.subplot.map,t=this.clusterEnabled?M.cluster:M.nonCluster,h=t.length-1;h>=0;h--){var s=t[h];r.removeLayer(this.layerIds[s]),r.removeSource(this.sourceIds[s])}},ee.exports=function(r,t){var h=t[0].trace,s=h.cluster&&h.cluster.enabled,i=new e(r,h.uid,s),x=g(r.gd,t),p=i.below=r.belowLookup["trace-"+h.uid],v,f,d;if(s)for(i.addSource("circle",x.circle,h.cluster),v=0;v<M.cluster.length;v++)f=M.cluster[v],d=x[f],i.addLayer(f,d,p);else for(v=0;v<M.nonCluster.length;v++)f=M.nonCluster[v],d=x[f],i.addSource(f,d,h.cluster),i.addLayer(f,d,p);return t[0].trace._glTrace=i,i}},{"../../lib":515,"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/subtypes"),S=y("../../constants/numerical").BADNUM;ee.exports=function(e,a){var n=e.cd,r=e.xaxis,t=e.yaxis,h=[],s=n[0].trace,i;if(!g.hasMarkers(s))return[];if(a===!1)for(i=0;i<n.length;i++)n[i].selected=0;else for(i=0;i<n.length;i++){var x=n[i],p=x.lonlat;if(p[0]!==S){var v=[A.modHalf(p[0],360),p[1]],f=[r.c2p(v),t.c2p(v)];a.contains(f,null,i,e)?(h.push({pointNumber:i,lon:p[0],lat:p[1]}),x.selected=1):x.selected=0}}return h}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../../plots/template_attributes").texttemplateAttrs,S=y("../../lib/extend").extendFlat,M=y("../scatter/attributes"),e=y("../../plots/attributes"),a=M.line;ee.exports={mode:M.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:M.text,texttemplate:g({editType:"plot"},{keys:["r","theta","text"]}),hovertext:M.hovertext,line:{color:a.color,width:a.width,dash:a.dash,backoff:a.backoff,shape:S({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:M.connectgaps,marker:M.marker,cliponaxis:S({},M.cliponaxis,{dflt:!1}),textposition:M.textposition,textfont:M.textfont,fill:S({},M.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:M.fillcolor,hoverinfo:S({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:M.hoveron,hovertemplate:A(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../constants/numerical").BADNUM,S=y("../../plots/cartesian/axes"),M=y("../scatter/colorscale_calc"),e=y("../scatter/arrays_to_calcdata"),a=y("../scatter/calc_selection"),n=y("../scatter/calc").calcMarkerSize;ee.exports=function(t,h){for(var s=t._fullLayout,i=h.subplot,x=s[i].radialaxis,p=s[i].angularaxis,v=x.makeCalcdata(h,"r"),f=p.makeCalcdata(h,"theta"),d=h._length,o=new Array(d),m=0;m<d;m++){var l=v[m],w=f[m],_=o[m]={};A(l)&&A(w)?(_.r=l,_.theta=w):_.r=g}var c=n(h,d);return h._extremes.x=S.findExtremes(x,v,{ppad:c}),M(t,h),e(o,h),a(o,h),o}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/subtypes"),S=y("../scatter/marker_defaults"),M=y("../scatter/line_defaults"),e=y("../scatter/line_shape_defaults"),a=y("../scatter/text_defaults"),n=y("../scatter/fillcolor_defaults"),r=y("../scatter/constants").PTS_LINESONLY,t=y("./attributes");function h(i,x,p,v){function f(m,l){return A.coerce(i,x,t,m,l)}var d=s(i,x,v,f);if(!d){x.visible=!1;return}f("thetaunit"),f("mode",d<r?"lines+markers":"lines"),f("text"),f("hovertext"),x.hoveron!=="fills"&&f("hovertemplate"),g.hasLines(x)&&(M(i,x,p,v,f,{backoff:!0}),e(i,x,f),f("connectgaps")),g.hasMarkers(x)&&S(i,x,p,v,f,{gradient:!0}),g.hasText(x)&&(f("texttemplate"),a(i,x,v,f));var o=[];(g.hasMarkers(x)||g.hasText(x))&&(f("cliponaxis"),f("marker.maxdisplayed"),o.push("points")),f("fill"),x.fill!=="none"&&(n(i,x,p,f),g.hasLines(x)||e(i,x,f)),(x.fill==="tonext"||x.fill==="toself")&&o.push("fills"),f("hoveron",o.join("+")||"points"),A.coerceSelectionMarkerOpacity(x,f)}function s(i,x,p,v){var f=v("r"),d=v("theta"),o;if(f)d?o=Math.min(f.length,d.length):(o=f.length,v("theta0"),v("dtheta"));else{if(!d)return 0;o=x.theta.length,v("r0"),v("dr")}return x._length=o,o}ee.exports={handleRThetaDefaults:s,supplyDefaults:h}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes");ee.exports=function(M,e,a){var n={},r=a[e.subplot]._subplot,t,h;r?(t=r.radialAxis,h=r.angularAxis):(r=a[e.subplot],t=r.radialaxis,h=r.angularaxis);var s=t.c2l(M.r);n.rLabel=g.tickText(t,s,!0).text;var i=h.thetaunit==="degrees"?A.rad2deg(M.theta):M.theta;return n.thetaLabel=g.tickText(h,i,!0).text,n}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(y,ee,te){var A=y("../scatter/hover");function g(M,e,a,n){var r=A(M,e,a,n);if(!(!r||r[0].index===!1)){var t=r[0];if(t.index===void 0)return r;var h=M.subplot,s=t.cd[t.index],i=t.trace;if(h.isPtInside(s))return t.xLabelVal=void 0,t.yLabelVal=void 0,S(s,i,h,t),t.hovertemplate=i.hovertemplate,r}}function S(M,e,a,n){var r=a.radialAxis,t=a.angularAxis;r._hovertitle="r",t._hovertitle="";var h={};h[e.subplot]={_subplot:a};var s=e._module.formatLabels(M,e,h);n.rLabel=s.rLabel,n.thetaLabel=s.thetaLabel;var i=M.hi||e.hoverinfo,x=[];function p(f,d){x.push(f._hovertitle+": "+d)}if(!e.hovertemplate){var v=i.split("+");v.indexOf("all")!==-1&&(v=["r","theta","text"]),v.indexOf("r")!==-1&&p(r,n.rLabel),v.indexOf("theta")!==-1&&p(t,n.thetaLabel),v.indexOf("text")!==-1&&n.text&&(x.push(n.text),delete n.text),n.extraText=x.join("<br>")}}ee.exports={hoverPoints:g,makeHoverPointText:S}},{"../scatter/hover":947}],1016:[function(y,ee,te){ee.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:y("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),plot:y("./plot"),style:y("../scatter/style").style,styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover").hoverPoints,selectPoints:y("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(y,ee,te){var A=y("../scatter/plot"),g=y("../../constants/numerical").BADNUM;ee.exports=function(M,e,a){for(var n=e.layers.frontplot.select("g.scatterlayer"),r=e.xaxis,t=e.yaxis,h={xaxis:r,yaxis:t,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},s=e.radialAxis,i=e.angularAxis,x=0;x<a.length;x++)for(var p=a[x],v=0;v<p.length;v++){v===0&&(p[0].trace._xA=r,p[0].trace._yA=t);var f=p[v],d=f.r;if(d===g)f.x=f.y=g;else{var o=s.c2g(d),m=i.c2g(f.theta);f.x=o*Math.cos(m),f.y=o*Math.sin(m)}}A(M,h,a,n)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(y,ee,te){var A=y("../scatterpolar/attributes"),g=y("../scattergl/attributes"),S=y("../../plots/template_attributes").texttemplateAttrs;ee.exports={mode:A.mode,r:A.r,theta:A.theta,r0:A.r0,dr:A.dr,theta0:A.theta0,dtheta:A.dtheta,thetaunit:A.thetaunit,text:A.text,texttemplate:S({editType:"plot"},{keys:["r","theta","text"]}),hovertext:A.hovertext,hovertemplate:A.hovertemplate,line:g.line,connectgaps:g.connectgaps,marker:g.marker,fill:g.fill,fillcolor:g.fillcolor,textposition:g.textposition,textfont:g.textfont,hoverinfo:A.hoverinfo,selected:A.selected,unselected:A.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(y,ee,te){ee.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:y("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),hoverPoints:y("./hover").hoverPoints,selectPoints:y("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(y,ee,te){var A=y("../scatter/colorscale_calc"),g=y("../scatter/calc").calcMarkerSize,S=y("../scattergl/convert"),M=y("../../plots/cartesian/axes"),e=y("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(n,r){var t=n._fullLayout,h=r.subplot,s=t[h].radialaxis,i=t[h].angularaxis,x=r._r=s.makeCalcdata(r,"r"),p=r._theta=i.makeCalcdata(r,"theta"),v=r._length,f={};v<x.length&&(x=x.slice(0,v)),v<p.length&&(p=p.slice(0,v)),f.r=x,f.theta=p,A(n,r);var d=f.opts=S.style(n,r),o;return v<e?o=g(r,v):d.marker&&(o=2*(d.marker.sizeAvg||Math.max(d.marker.size,3))),r._extremes.x=M.findExtremes(s,x,{ppad:o}),[{x:!1,y:!1,t:f,trace:r}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/subtypes"),S=y("../scatterpolar/defaults").handleRThetaDefaults,M=y("../scatter/marker_defaults"),e=y("../scatter/line_defaults"),a=y("../scatter/text_defaults"),n=y("../scatter/fillcolor_defaults"),r=y("../scatter/constants").PTS_LINESONLY,t=y("./attributes");ee.exports=function(s,i,x,p){function v(d,o){return A.coerce(s,i,t,d,o)}var f=S(s,i,p,v);if(!f){i.visible=!1;return}v("thetaunit"),v("mode",f<r?"lines+markers":"lines"),v("text"),v("hovertext"),i.hoveron!=="fills"&&v("hovertemplate"),g.hasLines(i)&&(e(s,i,x,p,v),v("connectgaps")),g.hasMarkers(i)&&M(s,i,x,p,v,{noAngleRef:!0,noStandOff:!0}),g.hasText(i)&&(v("texttemplate"),a(s,i,p,v)),v("fill"),i.fill!=="none"&&n(s,i,x,v),A.coerceSelectionMarkerOpacity(i,v)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(y,ee,te){var A=y("../scatterpolar/format_labels");ee.exports=function(S,M,e){var a=S.i;return"r"in S||(S.r=M._r[a]),"theta"in S||(S.theta=M._theta[a]),A(S,M,e)}},{"../scatterpolar/format_labels":1014}],1023:[function(y,ee,te){var A=y("../scattergl/hover"),g=y("../scatterpolar/hover").makeHoverPointText;function S(M,e,a,n){var r=M.cd,t=r[0].t,h=t.r,s=t.theta,i=A.hoverPoints(M,e,a,n);if(!(!i||i[0].index===!1)){var x=i[0];if(x.index===void 0)return i;var p=M.subplot,v=x.cd[x.index],f=x.trace;if(v.r=h[x.index],v.theta=s[x.index],!!p.isPtInside(v))return x.xLabelVal=void 0,x.yLabelVal=void 0,g(v,f,p,x),i}}ee.exports={hoverPoints:S}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(y,ee,te){arguments[4][905][0].apply(te,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(y,ee,te){var A=y("@plotly/point-cluster"),g=y("fast-isnumeric"),S=y("../scattergl/plot"),M=y("../scattergl/scene_update"),e=y("../scattergl/convert"),a=y("../../lib"),n=y("../scattergl/constants").TOO_MANY_POINTS,r={};ee.exports=function(h,s,i){if(i.length){var x=s.radialAxis,p=s.angularAxis,v=M(h,s);return i.forEach(function(f){if(!(!f||!f[0]||!f[0].trace)){var d=f[0],o=d.trace,m=d.t,l=o._length,w=m.r,_=m.theta,c=m.opts,b,u=w.slice(),L=_.slice();for(b=0;b<w.length;b++)s.isPtInside({r:w[b],theta:_[b]})||(u[b]=NaN,L[b]=NaN);var T=new Array(l*2),k=Array(l),P=Array(l);for(b=0;b<l;b++){var z=u[b],I,D;if(g(z)){var R=x.c2g(z),O=p.c2g(L[b],o.thetaunit);I=R*Math.cos(O),D=R*Math.sin(O)}else I=D=NaN;k[b]=T[b*2]=I,P[b]=T[b*2+1]=D}m.tree=A(T),c.marker&&l>=n&&(c.marker.cluster=m.tree),c.marker&&(c.markerSel.positions=c.markerUnsel.positions=c.marker.positions=T),c.line&&T.length>1&&a.extendFlat(c.line,e.linePositions(h,o,T)),c.text&&(a.extendFlat(c.text,{positions:T},e.textPosition(h,o,c.text,c.marker)),a.extendFlat(c.textSel,{positions:T},e.textPosition(h,o,c.text,c.markerSel)),a.extendFlat(c.textUnsel,{positions:T},e.textPosition(h,o,c.text,c.markerUnsel))),c.fill&&!v.fill2d&&(v.fill2d=!0),c.marker&&!v.scatter2d&&(v.scatter2d=!0),c.line&&!v.line2d&&(v.line2d=!0),c.text&&!v.glText&&(v.glText=!0),v.lineOptions.push(c.line),v.fillOptions.push(c.fill),v.markerOptions.push(c.marker),v.markerSelectedOptions.push(c.markerSel),v.markerUnselectedOptions.push(c.markerUnsel),v.textOptions.push(c.text),v.textSelectedOptions.push(c.textSel),v.textUnselectedOptions.push(c.textUnsel),v.selectBatch.push([]),v.unselectBatch.push([]),m.x=k,m.y=P,m.rawx=k,m.rawy=P,m.r=w,m.theta=_,m.positions=T,m._scene=v,m.index=v.count,v.count++}}),S(h,s,i)}},ee.exports.reglPrecompiled=r},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../../plots/template_attributes").texttemplateAttrs,S=y("../../lib/extend").extendFlat,M=y("../scatter/attributes"),e=y("../../plots/attributes"),a=M.line;ee.exports={mode:M.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:M.text,texttemplate:g({editType:"plot"},{keys:["real","imag","text"]}),hovertext:M.hovertext,line:{color:a.color,width:a.width,dash:a.dash,backoff:a.backoff,shape:S({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:M.connectgaps,marker:M.marker,cliponaxis:S({},M.cliponaxis,{dflt:!1}),textposition:M.textposition,textfont:M.textfont,fill:S({},M.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:M.fillcolor,hoverinfo:S({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:M.hoveron,hovertemplate:A(),selected:M.selected,unselected:M.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../../constants/numerical").BADNUM,S=y("../scatter/colorscale_calc"),M=y("../scatter/arrays_to_calcdata"),e=y("../scatter/calc_selection"),a=y("../scatter/calc").calcMarkerSize;ee.exports=function(r,t){for(var h=r._fullLayout,s=t.subplot,i=h[s].realaxis,x=h[s].imaginaryaxis,p=i.makeCalcdata(t,"real"),v=x.makeCalcdata(t,"imag"),f=t._length,d=new Array(f),o=0;o<f;o++){var m=p[o],l=v[o],w=d[o]={};A(m)&&A(l)?(w.real=m,w.imag=l):w.real=g}return a(t,f),S(r,t),M(d,t),e(d,t),d}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/subtypes"),S=y("../scatter/marker_defaults"),M=y("../scatter/line_defaults"),e=y("../scatter/line_shape_defaults"),a=y("../scatter/text_defaults"),n=y("../scatter/fillcolor_defaults"),r=y("../scatter/constants").PTS_LINESONLY,t=y("./attributes");ee.exports=function(i,x,p,v){function f(m,l){return A.coerce(i,x,t,m,l)}var d=h(i,x,v,f);if(!d){x.visible=!1;return}f("mode",d<r?"lines+markers":"lines"),f("text"),f("hovertext"),x.hoveron!=="fills"&&f("hovertemplate"),g.hasLines(x)&&(M(i,x,p,v,f,{backoff:!0}),e(i,x,f),f("connectgaps")),g.hasMarkers(x)&&S(i,x,p,v,f,{gradient:!0}),g.hasText(x)&&(f("texttemplate"),a(i,x,v,f));var o=[];(g.hasMarkers(x)||g.hasText(x))&&(f("cliponaxis"),f("marker.maxdisplayed"),o.push("points")),f("fill"),x.fill!=="none"&&(n(i,x,p,f),g.hasLines(x)||e(i,x,f)),(x.fill==="tonext"||x.fill==="toself")&&o.push("fills"),f("hoveron",o.join("+")||"points"),A.coerceSelectionMarkerOpacity(x,f)};function h(s,i,x,p){var v=p("real"),f=p("imag"),d;return v&&f&&(d=Math.min(v.length,f.length)),i._length=d,d}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(y,ee,te){var A=y("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot;return a.realLabel=A.tickText(n.radialAxis,S.real,!0).text,a.imagLabel=A.tickText(n.angularAxis,S.imag,!0).text,a}},{"../../plots/cartesian/axes":566}],1030:[function(y,ee,te){var A=y("../scatter/hover");function g(M,e,a,n){var r=A(M,e,a,n);if(!(!r||r[0].index===!1)){var t=r[0];if(t.index===void 0)return r;var h=M.subplot,s=t.cd[t.index],i=t.trace;if(h.isPtInside(s))return t.xLabelVal=void 0,t.yLabelVal=void 0,S(s,i,h,t),t.hovertemplate=i.hovertemplate,r}}function S(M,e,a,n){var r=a.radialAxis,t=a.angularAxis;r._hovertitle="real",t._hovertitle="imag";var h={};h[e.subplot]={_subplot:a};var s=e._module.formatLabels(M,e,h);n.realLabel=s.realLabel,n.imagLabel=s.imagLabel;var i=M.hi||e.hoverinfo,x=[];function p(f,d){x.push(f._hovertitle+": "+d)}if(!e.hovertemplate){var v=i.split("+");v.indexOf("all")!==-1&&(v=["real","imag","text"]),v.indexOf("real")!==-1&&p(r,n.realLabel),v.indexOf("imag")!==-1&&p(t,n.imagLabel),v.indexOf("text")!==-1&&n.text&&(x.push(n.text),delete n.text),n.extraText=x.join("<br>")}}ee.exports={hoverPoints:g,makeHoverPointText:S}},{"../scatter/hover":947}],1031:[function(y,ee,te){ee.exports={moduleType:"trace",name:"scattersmith",basePlotModule:y("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),plot:y("./plot"),style:y("../scatter/style").style,styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover").hoverPoints,selectPoints:y("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(y,ee,te){var A=y("../scatter/plot"),g=y("../../constants/numerical").BADNUM,S=y("../../plots/smith/helpers"),M=S.smith;ee.exports=function(a,n,r){for(var t=n.layers.frontplot.select("g.scatterlayer"),h=n.xaxis,s=n.yaxis,i={xaxis:h,yaxis:s,plot:n.framework,layerClipId:n._hasClipOnAxisFalse?n.clipIds.forTraces:null},x=0;x<r.length;x++)for(var p=r[x],v=0;v<p.length;v++){v===0&&(p[0].trace._xA=h,p[0].trace._yA=s);var f=p[v],d=f.real;if(d===g)f.x=f.y=g;else{var o=M([d,f.imag]);f.x=o[0],f.y=o[1]}}A(a,i,r,t)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../../plots/template_attributes").texttemplateAttrs,S=y("../scatter/attributes"),M=y("../../plots/attributes"),e=y("../../components/colorscale/attributes"),a=y("../../components/drawing/attributes").dash,n=y("../../lib/extend").extendFlat,r=S.marker,t=S.line,h=r.line;ee.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:n({},S.mode,{dflt:"markers"}),text:n({},S.text,{}),texttemplate:g({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:n({},S.hovertext,{}),line:{color:t.color,width:t.width,dash:a,backoff:t.backoff,shape:n({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:S.connectgaps,cliponaxis:S.cliponaxis,fill:n({},S.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:S.fillcolor,marker:n({symbol:r.symbol,opacity:r.opacity,angle:r.angle,angleref:r.angleref,standoff:r.standoff,maxdisplayed:r.maxdisplayed,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,line:n({width:h.width,editType:"calc"},e("marker.line")),gradient:r.gradient,editType:"calc"},e("marker")),textfont:S.textfont,textposition:S.textposition,selected:S.selected,unselected:S.unselected,hoverinfo:n({},M.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:S.hoveron,hovertemplate:A()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(y,ee,te){var A=y("fast-isnumeric"),g=y("../scatter/colorscale_calc"),S=y("../scatter/arrays_to_calcdata"),M=y("../scatter/calc_selection"),e=y("../scatter/calc").calcMarkerSize,a=["a","b","c"],n={a:["b","c"],b:["a","c"],c:["a","b"]};ee.exports=function(t,h){var s=t._fullLayout[h.subplot],i=s.sum,x=h.sum||i,p={a:h.a,b:h.b,c:h.c},v,f,d,o,m,l;for(v=0;v<a.length;v++)if(d=a[v],!p[d]){for(m=p[n[d][0]],l=p[n[d][1]],o=new Array(m.length),f=0;f<m.length;f++)o[f]=x-m[f]-l[f];p[d]=o}var w=h._length,_=new Array(w),c,b,u,L,T,k;for(v=0;v<w;v++)c=p.a[v],b=p.b[v],u=p.c[v],A(c)&&A(b)&&A(u)?(c=+c,b=+b,u=+u,L=i/(c+b+u),L!==1&&(c*=L,b*=L,u*=L),k=c,T=u-b,_[v]={x:T,y:k,a:c,b,c:u}):_[v]={x:!1,y:!1};return e(h,w),g(t,h),S(_,h),M(_,h),_}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/constants"),S=y("../scatter/subtypes"),M=y("../scatter/marker_defaults"),e=y("../scatter/line_defaults"),a=y("../scatter/line_shape_defaults"),n=y("../scatter/text_defaults"),r=y("../scatter/fillcolor_defaults"),t=y("./attributes");ee.exports=function(s,i,x,p){function v(_,c){return A.coerce(s,i,t,_,c)}var f=v("a"),d=v("b"),o=v("c"),m;if(f?(m=f.length,d?(m=Math.min(m,d.length),o&&(m=Math.min(m,o.length))):o?m=Math.min(m,o.length):m=0):d&&o&&(m=Math.min(d.length,o.length)),!m){i.visible=!1;return}i._length=m,v("sum"),v("text"),v("hovertext"),i.hoveron!=="fills"&&v("hovertemplate");var l=m<g.PTS_LINESONLY?"lines+markers":"lines";v("mode",l),S.hasLines(i)&&(e(s,i,x,p,v,{backoff:!0}),a(s,i,v),v("connectgaps")),S.hasMarkers(i)&&M(s,i,x,p,v,{gradient:!0}),S.hasText(i)&&(v("texttemplate"),n(s,i,p,v));var w=[];(S.hasMarkers(i)||S.hasText(i))&&(v("cliponaxis"),v("marker.maxdisplayed"),w.push("points")),v("fill"),i.fill!=="none"&&(r(s,i,x,v),S.hasLines(i)||a(s,i,v)),(i.fill==="tonext"||i.fill==="toself")&&w.push("fills"),v("hoveron",w.join("+")||"points"),A.coerceSelectionMarkerOpacity(i,v)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(y,ee,te){ee.exports=function(g,S,M,e,a){if(S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),e[a]){var n=e[a];g.a=n.a,g.b=n.b,g.c=n.c}else g.a=S.a,g.b=S.b,g.c=S.c;return g}},{}],1037:[function(y,ee,te){var A=y("../../plots/cartesian/axes");ee.exports=function(S,M,e){var a={},n=e[M.subplot]._subplot;return a.aLabel=A.tickText(n.aaxis,S.a,!0).text,a.bLabel=A.tickText(n.baxis,S.b,!0).text,a.cLabel=A.tickText(n.caxis,S.c,!0).text,a}},{"../../plots/cartesian/axes":566}],1038:[function(y,ee,te){var A=y("../scatter/hover");ee.exports=function(S,M,e,a){var n=A(S,M,e,a);if(!n||n[0].index===!1)return;var r=n[0];if(r.index===void 0){var t=1-r.y0/S.ya._length,h=S.xa._length,s=h*t/2,i=h-s;return r.x0=Math.max(Math.min(r.x0,i),s),r.x1=Math.max(Math.min(r.x1,i),s),n}var x=r.cd[r.index],p=r.trace,v=r.subplot;r.a=x.a,r.b=x.b,r.c=x.c,r.xLabelVal=void 0,r.yLabelVal=void 0;var f={};f[p.subplot]={_subplot:v};var d=p._module.formatLabels(x,p,f);r.aLabel=d.aLabel,r.bLabel=d.bLabel,r.cLabel=d.cLabel;var o=x.hi||p.hoverinfo,m=[];function l(_,c){m.push(_._hovertitle+": "+c)}if(!p.hovertemplate){var w=o.split("+");w.indexOf("all")!==-1&&(w=["a","b","c"]),w.indexOf("a")!==-1&&l(v.aaxis,r.aLabel),w.indexOf("b")!==-1&&l(v.baxis,r.bLabel),w.indexOf("c")!==-1&&l(v.caxis,r.cLabel)}return r.extraText=m.join("<br>"),r.hovertemplate=p.hovertemplate,n}},{"../scatter/hover":947}],1039:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),formatLabels:y("./format_labels"),calc:y("./calc"),plot:y("./plot"),style:y("../scatter/style").style,styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("../scatter/select"),eventData:y("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:y("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(y,ee,te){var A=y("../scatter/plot");ee.exports=function(S,M,e){var a=M.plotContainer;a.select(".scatterlayer").selectAll("*").remove();for(var n=M.xaxis,r=M.yaxis,t={xaxis:n,yaxis:r,plot:a,layerClipId:M._hasClipOnAxisFalse?M.clipIdRelative:null},h=M.layers.frontplot.select("g.scatterlayer"),s=0;s<e.length;s++){var i=e[s];i.length&&(i[0].trace._xA=n,i[0].trace._yA=r)}A(S,t,e,h)}},{"../scatter/plot":957}],1041:[function(y,ee,te){var A=y("../scatter/attributes"),g=y("../../components/colorscale/attributes"),S=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=y("../../plots/template_attributes").hovertemplateAttrs,e=y("../scattergl/attributes"),a=y("../../plots/cartesian/constants").idRegex,n=y("../../plot_api/plot_template").templatedArray,r=y("../../lib/extend").extendFlat,t=A.marker,h=t.line,s=r(g("marker.line",{editTypeOverride:"calc"}),{width:r({},h.width,{editType:"calc"}),editType:"calc"}),i=r(g("marker"),{symbol:t.symbol,angle:t.angle,size:r({},t.size,{editType:"markerSize"}),sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,opacity:t.opacity,colorbar:t.colorbar,line:s,editType:"calc"});i.color.editType=i.cmin.editType=i.cmax.editType="style";function x(p){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:a[p],editType:"plot"}}}ee.exports={dimensions:n("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:r({},e.text,{}),hovertext:r({},e.hovertext,{}),hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),marker:i,xaxes:x("x"),yaxes:x("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(y,ee,te){var A=y("../../registry"),g=y("../../components/grid");ee.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:y("../scatter/marker_colorbar"),calc:y("./calc"),plot:y("./plot"),hoverPoints:y("./hover").hoverPoints,selectPoints:y("./select"),editStyle:y("./edit_style"),meta:{}},A.register(g)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(y,ee,te){var A=y("regl-line2d"),g=y("../../registry"),S=y("../../lib/prepare_regl"),M=y("../../plots/get_data").getModuleCalcData,e=y("../../plots/cartesian"),a=y("../../plots/cartesian/axis_ids").getFromId,n=y("../../plots/cartesian/axes").shouldShowZeroLine,r="splom",t={};function h(f){var d=f._fullLayout,o=g.getModule(r),m=M(f.calcdata,o)[0],l=S(f,["ANGLE_instanced_arrays","OES_element_index_uint"],t);l&&(d._hasOnlyLargeSploms&&x(f),o.plot(f,{},m))}function s(f){var d=f.calcdata,o=f._fullLayout;o._hasOnlyLargeSploms&&x(f);for(var m=0;m<d.length;m++){var l=d[m][0],w=l.trace,_=o._splomScenes[w.uid];w.type==="splom"&&_&&_.matrix&&i(f,w,_)}}function i(f,d,o){for(var m=o.matrixOptions.data.length,l=d._visibleDims,w=o.viewOpts.ranges=new Array(m),_=0;_<l.length;_++){var c=l[_],b=w[_]=new Array(4),u=a(f,d._diag[c][0]);u&&(b[0]=u.r2l(u.range[0]),b[2]=u.r2l(u.range[1]));var L=a(f,d._diag[c][1]);L&&(b[1]=L.r2l(L.range[0]),b[3]=L.r2l(L.range[1]))}o.selectBatch.length||o.unselectBatch.length?o.matrix.update({ranges:w},{ranges:w}):o.matrix.update({ranges:w})}function x(f){var d=f._fullLayout,o=d._glcanvas.data()[0].regl,m=d._splomGrid;m||(m=d._splomGrid=A(o)),m.update(p(f))}function p(f){var d=f._context.plotGlPixelRatio,o=f._fullLayout,m=o._size,l=[0,0,o.width*d,o.height*d],w={},_;function c(K,W,Y,re,ue,j){Y*=d,re*=d,ue*=d,j*=d;var q=W[K+"color"],H=W[K+"width"],U=String(q+H);U in w?w[U].data.push(NaN,NaN,Y,re,ue,j):w[U]={data:[Y,re,ue,j],join:"rect",thickness:H*d,color:q,viewport:l,range:l,overlay:!1}}for(_ in o._splomSubplots){var b=o._plots[_],u=b.xaxis,L=b.yaxis,T=u._gridVals,k=L._gridVals,P=u._offset,z=u._length,I=L._length,D=m.b+L.domain[0]*m.h,R=-L._m,O=-R*L.r2l(L.range[0],L.calendar),F,N;if(u.showgrid)for(_=0;_<T.length;_++)F=P+u.l2p(T[_].x),c("grid",u,F,D,F,D+I);if(L.showgrid)for(_=0;_<k.length;_++)N=D+O+R*k[_].x,c("grid",L,P,N,P+z,N);n(f,u,L)&&(F=P+u.l2p(0),c("zeroline",u,F,D,F,D+I)),n(f,L,u)&&(N=D+O+0,c("zeroline",L,P,N,P+z,N))}var G=[];for(_ in w)G.push(w[_]);return G}function v(f,d,o,m){var l={},w;if(m._splomScenes){for(w=0;w<f.length;w++){var _=f[w];_.type==="splom"&&(l[_.uid]=1)}for(w=0;w<o.length;w++){var c=o[w];if(!l[c.uid]){var b=m._splomScenes[c.uid];b&&b.destroy&&b.destroy(),m._splomScenes[c.uid]=null,delete m._splomScenes[c.uid]}}}Object.keys(m._splomScenes||{}).length===0&&delete m._splomScenes,m._splomGrid&&!d._hasOnlyLargeSploms&&m._hasOnlyLargeSploms&&(m._splomGrid.destroy(),m._splomGrid=null,delete m._splomGrid),e.clean(f,d,o,m)}ee.exports={name:r,attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:h,drag:s,updateGrid:x,clean:v,updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:t}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axis_ids"),S=y("../scatter/calc").calcMarkerSize,M=y("../scatter/calc").calcAxisExpansion,e=y("../scatter/colorscale_calc"),a=y("../scattergl/convert").markerSelection,n=y("../scattergl/convert").markerStyle,r=y("./scene_update"),t=y("../../constants/numerical").BADNUM,h=y("../scattergl/constants").TOO_MANY_POINTS;ee.exports=function(i,x){var p=x.dimensions,v=x._length,f={},d=f.cdata=[],o=f.data=[],m=x._visibleDims=[],l,w,_,c,b;function u(z,I){for(var D=z.makeCalcdata({v:I.values,vcalendar:x.calendar},"v"),R=0;R<D.length;R++)D[R]=D[R]===t?NaN:D[R];d.push(D),o.push(z.type==="log"?A.simpleMap(D,z.c2l):D)}for(l=0;l<p.length;l++)if(_=p[l],_.visible){if(c=g.getFromId(i,x._diag[l][0]),b=g.getFromId(i,x._diag[l][1]),c&&b&&c.type!==b.type){A.log("Skipping splom dimension "+l+" with conflicting axis types");continue}c?(u(c,_),b&&b.type==="category"&&(b._categories=c._categories.slice())):u(b,_),m.push(l)}e(i,x),A.extendFlat(f,n(i,x));var L=d.length,T=L*v>h,k;for(T?k=f.sizeAvg||Math.max(f.size,3):k=S(x,v),w=0;w<m.length;w++)l=m[w],_=p[l],c=g.getFromId(i,x._diag[l][0])||{},b=g.getFromId(i,x._diag[l][1])||{},M(i,x,c,b,d[w],d[w],k);var P=r(i,x);return P.matrix||(P.matrix=!0),P.matrixOptions=f,P.selectedOptions=a(i,x,x.selected),P.unselectedOptions=a(i,x,x.unselected),[{x:!1,y:!1,t:{},trace:x}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/array_container_defaults"),S=y("./attributes"),M=y("../scatter/subtypes"),e=y("../scatter/marker_defaults"),a=y("../parcoords/merge_length"),n=y("../scattergl/helpers").isOpenSymbol;ee.exports=function(s,i,x,p){function v(c,b){return A.coerce(s,i,S,c,b)}var f=g(s,i,{name:"dimensions",handleItemDefaults:r}),d=v("diagonal.visible"),o=v("showupperhalf"),m=v("showlowerhalf"),l=a(i,f,"values");if(!l||!d&&!o&&!m){i.visible=!1;return}v("text"),v("hovertext"),v("hovertemplate"),v("xhoverformat"),v("yhoverformat"),e(s,i,x,p,v,{noAngleRef:!0,noStandOff:!0});var w=n(i.marker.symbol),_=M.isBubble(i);v("marker.line.width",w||_?1:0),t(s,i,p,v),A.coerceSelectionMarkerOpacity(i,v)};function r(h,s){function i(p,v){return A.coerce(h,s,S.dimensions,p,v)}i("label");var x=i("values");x&&x.length?i("visible"):s.visible=!1,i("axis.type"),i("axis.matches")}function t(h,s,i,x){var p=s.dimensions,v=p.length,f=s.showupperhalf,d=s.showlowerhalf,o=s.diagonal.visible,m,l,w=new Array(v),_=new Array(v);for(m=0;m<v;m++){var c=m?m+1:"";w[m]="x"+c,_[m]="y"+c}var b=x("xaxes",w),u=x("yaxes",_),L=s._diag=new Array(v);s._xaxes={},s._yaxes={};var T=[],k=[];function P(K,W,Y,re){if(K){var ue=K.charAt(0),j=i._splomAxes[ue];if(s["_"+ue+"axes"][K]=1,re.push(K),!(K in j)){var q=j[K]={};Y&&(q.label=Y.label||"",Y.visible&&Y.axis&&(Y.axis.type&&(q.type=Y.axis.type),Y.axis.matches&&(q.matches=W)))}}}var z=!o&&!d,I=!o&&!f;for(s._axesDim={},m=0;m<v;m++){var D=p[m],R=m===0,O=m===v-1,F=R&&z||O&&I?void 0:b[m],N=R&&I||O&&z?void 0:u[m];P(F,N,D,T),P(N,F,D,k),L[m]=[F,N],s._axesDim[F]=m,s._axesDim[N]=m}for(m=0;m<T.length;m++)for(l=0;l<k.length;l++){var G=T[m]+k[l];(m>l&&f||m<l&&d||m===l&&(o||!d||!f))&&(i._splomSubplots[G]=1)}(!d||!o&&f&&d)&&(i._splomGridDflt.xside="bottom",i._splomGridDflt.yside="left")}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(y,ee,te){var A=y("../../lib"),g=y("../scatter/colorscale_calc"),S=y("../scattergl/convert").markerStyle;ee.exports=function(e,a){var n=a.trace,r=e._fullLayout._splomScenes[n.uid];if(r){g(e,n),A.extendFlat(r.matrixOptions,S(e,n));var t=A.extendFlat({},r.matrixOptions,r.viewOpts);r.matrix.update(t,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(y,ee,te){te.getDimIndex=function(g,S){for(var M=S._id,e=M.charAt(0),a={x:0,y:1}[e],n=g._visibleDims,r=0;r<n.length;r++){var t=n[r];if(g._diag[t][a]===M)return r}return!1}},{}],1048:[function(y,ee,te){var A=y("./helpers"),g=y("../scattergl/hover").calcHover;function S(M,e,a){var n=M.cd,r=n[0].trace,t=M.scene,h=t.matrixOptions.cdata,s=M.xa,i=M.ya,x=s.c2p(e),p=i.c2p(a),v=M.distance,f=A.getDimIndex(r,s),d=A.getDimIndex(r,i);if(f===!1||d===!1)return[M];for(var o=h[f],m=h[d],l,w,_=v,c=0;c<o.length;c++){var b=o[c],u=m[c],L=s.c2p(b)-x,T=i.c2p(u)-p,k=Math.sqrt(L*L+T*T);k<_&&(_=w=k,l=c)}return M.index=l,M.distance=_,M.dxy=w,l===void 0?[M]:[g(M,o,m,r)]}ee.exports={hoverPoints:S}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(y,ee,te){var A=y("./base_index");A.basePlotModule=y("./base_plot"),ee.exports=A},{"./base_index":1042,"./base_plot":1043}],1050:[function(y,ee,te){var A=y("regl-splom"),g=y("../../lib"),S=y("../../plots/cartesian/axis_ids"),M=y("../../components/dragelement/helpers").selectMode;ee.exports=function(n,r,t){if(t.length)for(var h=0;h<t.length;h++)e(n,t[h][0])};function e(a,n){var r=a._fullLayout,t=r._size,h=n.trace,s=n.t,i=r._splomScenes[h.uid],x=i.matrixOptions,p=x.cdata,v=r._glcanvas.data()[0].regl,f=r.dragmode,d,o,m,l,w;if(p.length!==0){x.lower=h.showupperhalf,x.upper=h.showlowerhalf,x.diagonal=h.diagonal.visible;var _=h._visibleDims,c=p.length,b=i.viewOpts={};for(b.ranges=new Array(c),b.domains=new Array(c),w=0;w<_.length;w++){m=_[w];var u=b.ranges[w]=new Array(4),L=b.domains[w]=new Array(4);d=S.getFromId(a,h._diag[m][0]),d&&(u[0]=d._rl[0],u[2]=d._rl[1],L[0]=d.domain[0],L[2]=d.domain[1]),o=S.getFromId(a,h._diag[m][1]),o&&(u[1]=o._rl[0],u[3]=o._rl[1],L[1]=o.domain[0],L[3]=o.domain[1])}var T=a._context.plotGlPixelRatio,k=t.l*T,P=t.b*T,z=t.w*T,I=t.h*T;b.viewport=[k,P,z+k,I+P],i.matrix===!0&&(i.matrix=A(v));var D=r.clickmode.indexOf("select")>-1,R=M(f)||!!h.selectedpoints||D,O=!0;if(R){var F=h._length;if(h.selectedpoints){i.selectBatch=h.selectedpoints;var N=h.selectedpoints,G={};for(m=0;m<N.length;m++)G[N[m]]=!0;var K=[];for(m=0;m<F;m++)G[m]||K.push(m);i.unselectBatch=K}var W=s.xpx=new Array(c),Y=s.ypx=new Array(c);for(w=0;w<_.length;w++){if(m=_[w],d=S.getFromId(a,h._diag[m][0]),d)for(W[w]=new Array(F),l=0;l<F;l++)W[w][l]=d.c2p(p[w][l]);if(o=S.getFromId(a,h._diag[m][1]),o)for(Y[w]=new Array(F),l=0;l<F;l++)Y[w][l]=o.c2p(p[w][l])}if(i.selectBatch.length||i.unselectBatch.length){var re=g.extendFlat({},x,i.unselectedOptions,b),ue=g.extendFlat({},x,i.selectedOptions,b);i.matrix.update(re,ue),O=!1}}else s.xpx=s.ypx=null;if(O){var j=g.extendFlat({},x,b);i.matrix.update(j,null)}}}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(y,ee,te){var A=y("../../lib");ee.exports=function(S,M){var e=S._fullLayout,a=M.uid,n=e._splomScenes;n||(n=e._splomScenes={});var r={dirty:!0,selectBatch:[],unselectBatch:[]},t={matrix:!1,selectBatch:[],unselectBatch:[]},h=n[M.uid];return h||(h=n[a]=A.extendFlat({},r,t),h.draw=function(){h.matrix&&h.matrix.draw&&(h.selectBatch.length||h.unselectBatch.length?h.matrix.draw(h.unselectBatch,h.selectBatch):h.matrix.draw()),h.dirty=!1},h.destroy=function(){h.matrix&&h.matrix.destroy&&h.matrix.destroy(),h.matrixOptions=null,h.selectBatch=null,h.unselectBatch=null,h=null}),h.dirty||A.extendFlat(h,r),h}},{"../../lib":515}],1052:[function(y,ee,te){var A=y("../../lib"),g=A.pushUnique,S=y("../scatter/subtypes"),M=y("./helpers");ee.exports=function(a,n){var r=a.cd,t=r[0].trace,h=r[0].t,s=a.scene,i=s.matrixOptions.cdata,x=a.xaxis,p=a.yaxis,v=[];if(!s)return v;var f=!S.hasMarkers(t)&&!S.hasText(t);if(t.visible!==!0||f)return v;var d=M.getDimIndex(t,x),o=M.getDimIndex(t,p);if(d===!1||o===!1)return v;var m=h.xpx[d],l=h.ypx[o],w=i[d],_=i[o],c=(a.scene.selectBatch||[]).slice(),b=[];if(n!==!1&&!n.degenerate)for(var u=0;u<w.length;u++)n.contains([m[u],l[u]],null,u,a)?(v.push({pointNumber:u,x:w[u],y:_[u]}),g(c,u)):c.indexOf(u)!==-1?g(c,u):b.push(u);var L=s.matrixOptions;return!c.length&&!b.length?s.matrix.update(L,null):!s.selectBatch.length&&!s.unselectBatch.length&&s.matrix.update(s.unselectedOptions,A.extendFlat({},L,s.selectedOptions,s.viewOpts)),s.selectBatch=c,s.unselectBatch=b,v}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(y,ee,te){var A=y("../../components/colorscale/attributes"),g=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,S=y("../../plots/template_attributes").hovertemplateAttrs,M=y("../mesh3d/attributes"),e=y("../../plots/attributes"),a=y("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:S({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:g("u",1),vhoverformat:g("v",1),whoverformat:g("w",1),xhoverformat:g("x"),yhoverformat:g("y"),zhoverformat:g("z"),showlegend:a({},e.showlegend,{dflt:!1})};a(n,A("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var r=["opacity","lightposition","lighting"];r.forEach(function(t){n[t]=M[t]}),n.hoverinfo=a({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,ee.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/colorscale/calc");function S(n,r){r._len=Math.min(r.u.length,r.v.length,r.w.length,r.x.length,r.y.length,r.z.length),r._u=a(r.u,r._len),r._v=a(r.v,r._len),r._w=a(r.w,r._len),r._x=a(r.x,r._len),r._y=a(r.y,r._len),r._z=a(r.z,r._len);var t=M(r);r._gridFill=t.fill,r._Xs=t.Xs,r._Ys=t.Ys,r._Zs=t.Zs,r._len=t.len;var h=0,s,i,x;r.starts&&(s=a(r.starts.x||[]),i=a(r.starts.y||[]),x=a(r.starts.z||[]),h=Math.min(s.length,i.length,x.length)),r._startsX=s||[],r._startsY=i||[],r._startsZ=x||[];var p=0,v=1/0,f;for(f=0;f<r._len;f++){var d=r._u[f],o=r._v[f],m=r._w[f],l=Math.sqrt(d*d+o*o+m*m);p=Math.max(p,l),v=Math.min(v,l)}for(g(n,r,{vals:[v,p],containerStr:"",cLetter:"c"}),f=0;f<h;f++){var w=s[f];t.xMax=Math.max(t.xMax,w),t.xMin=Math.min(t.xMin,w);var _=i[f];t.yMax=Math.max(t.yMax,_),t.yMin=Math.min(t.yMin,_);var c=x[f];t.zMax=Math.max(t.zMax,c),t.zMin=Math.min(t.zMin,c)}r._slen=h,r._normMax=p,r._xbnds=[t.xMin,t.xMax],r._ybnds=[t.yMin,t.yMax],r._zbnds=[t.zMin,t.zMax]}function M(n){var r=n._x,t=n._y,h=n._z,s=n._len,i,x,p,v=-1/0,f=1/0,d=-1/0,o=1/0,m=-1/0,l=1/0,w="",_,c,b,u,L,T,k,P,z;for(s&&(u=r[0],T=t[0],P=h[0]),s>1&&(L=r[s-1],k=t[s-1],z=h[s-1]),i=0;i<s;i++)v=Math.max(v,r[i]),f=Math.min(f,r[i]),d=Math.max(d,t[i]),o=Math.min(o,t[i]),m=Math.max(m,h[i]),l=Math.min(l,h[i]),!_&&r[i]!==u&&(_=!0,w+="x"),!c&&t[i]!==T&&(c=!0,w+="y"),!b&&h[i]!==P&&(b=!0,w+="z");_||(w+="x"),c||(w+="y"),b||(w+="z");var I=e(n._x),D=e(n._y),R=e(n._z);w=w.replace("x",(u>L?"-":"+")+"x"),w=w.replace("y",(T>k?"-":"+")+"y"),w=w.replace("z",(P>z?"-":"+")+"z");var O=function(){s=0,I=[],D=[],R=[]};(!s||s<I.length*D.length*R.length)&&O();var F=function(ae){return ae==="x"?r:ae==="y"?t:h},N=function(ae){return ae==="x"?I:ae==="y"?D:R},G=function(ae){return ae[s-1]<ae[0]?-1:1},K=F(w[1]),W=F(w[3]),Y=F(w[5]),re=N(w[1]).length,ue=N(w[3]).length,j=N(w[5]).length,q=!1,H=function(ae,oe,be){return re*(ue*ae+oe)+be},U=G(F(w[1])),$=G(F(w[3])),ne=G(F(w[5]));for(i=0;i<j-1;i++){for(x=0;x<ue-1;x++){for(p=0;p<re-1;p++){var X=H(i,x,p),Q=H(i,x,p+1),ie=H(i,x+1,p),se=H(i+1,x,p);if((!(K[X]*U<K[Q]*U)||!(W[X]*$<W[ie]*$)||!(Y[X]*ne<Y[se]*ne))&&(q=!0),q)break}if(q)break}if(q)break}return q&&(A.warn("Encountered arbitrary coordinates! Unable to input data grid."),O()),{xMin:f,yMin:o,zMin:l,xMax:v,yMax:d,zMax:m,Xs:I,Ys:D,Zs:R,len:s,fill:w}}function e(n){return A.distinctVals(n).vals}function a(n,r){if(r===void 0&&(r=n.length),A.isTypedArray(n))return n.subarray(0,r);for(var t=[],h=0;h<r;h++)t[h]=+n[h];return t}ee.exports={calc:S,filter:a,processGrid:M}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_streamtube3d,g=A.createTubeMesh,S=y("../../lib"),M=y("../../lib/gl_format_color").parseColorScale,e=y("../../components/colorscale").extractOpts,a=y("../../plots/gl3d/zip3"),n={xaxis:0,yaxis:1,zaxis:2};function r(p,v){this.scene=p,this.uid=v,this.mesh=null,this.data=null}var t=r.prototype;t.handlePick=function(p){var v=this.scene.fullSceneLayout,f=this.scene.dataScale;function d(l,w){var _=v[w],c=f[n[w]];return _.l2c(l)/c}if(p.object===this.mesh){var o=p.data.position,m=p.data.velocity;return p.traceCoordinate=[d(o[0],"xaxis"),d(o[1],"yaxis"),d(o[2],"zaxis"),d(m[0],"xaxis"),d(m[1],"yaxis"),d(m[2],"zaxis"),p.data.intensity*this.data._normMax,p.data.divergence],p.textLabel=this.data.hovertext||this.data.text,!0}};function h(p){var v=p.length,f;return v>2?f=p.slice(1,v-1):v===2?f=[(p[0]+p[1])/2]:f=p,f}function s(p){var v=p.length;return v===1?[.5,.5]:[p[1]-p[0],p[v-1]-p[v-2]]}function i(p,v){var f=p.fullSceneLayout,d=p.dataScale,o=v._len,m={};function l(ue,j){var q=f[j],H=d[n[j]];return S.simpleMap(ue,function(U){return q.d2l(U)*H})}if(m.vectors=a(l(v._u,"xaxis"),l(v._v,"yaxis"),l(v._w,"zaxis"),o),!o)return{positions:[],cells:[]};var w=l(v._Xs,"xaxis"),_=l(v._Ys,"yaxis"),c=l(v._Zs,"zaxis");m.meshgrid=[w,_,c],m.gridFill=v._gridFill;var b=v._slen;if(b)m.startingPositions=a(l(v._startsX,"xaxis"),l(v._startsY,"yaxis"),l(v._startsZ,"zaxis"));else{for(var u=_[0],L=h(w),T=h(c),k=new Array(L.length*T.length),P=0,z=0;z<L.length;z++)for(var I=0;I<T.length;I++)k[P++]=[L[z],u,T[I]];m.startingPositions=k}m.colormap=M(v),m.tubeSize=v.sizeref,m.maxLength=v.maxdisplayed;var D=l(v._xbnds,"xaxis"),R=l(v._ybnds,"yaxis"),O=l(v._zbnds,"zaxis"),F=s(w),N=s(_),G=s(c),K=[[D[0]-F[0],R[0]-N[0],O[0]-G[0]],[D[1]+F[1],R[1]+N[1],O[1]+G[1]]],W=A(m,K),Y=e(v);W.vertexIntensityBounds=[Y.min/v._normMax,Y.max/v._normMax];var re=v.lightposition;return W.lightPosition=[re.x,re.y,re.z],W.ambient=v.lighting.ambient,W.diffuse=v.lighting.diffuse,W.specular=v.lighting.specular,W.roughness=v.lighting.roughness,W.fresnel=v.lighting.fresnel,W.opacity=v.opacity,v._pad=W.tubeScale*v.sizeref*2,W}t.update=function(p){this.data=p;var v=i(this.scene,p);this.mesh.update(v)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function x(p,v){var f=p.glplot.gl,d=i(p,v),o=g(f,d),m=new r(p,v.uid);return m.mesh=o,m.data=v,o._trace=m,p.glplot.add(o),m}ee.exports=x},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/colorscale/defaults"),S=y("./attributes");ee.exports=function(e,a,n,r){function t(f,d){return A.coerce(e,a,S,f,d)}var h=t("u"),s=t("v"),i=t("w"),x=t("x"),p=t("y"),v=t("z");if(!h||!h.length||!s||!s.length||!i||!i.length||!x||!x.length||!p||!p.length||!v||!v.length){a.visible=!1;return}t("starts.x"),t("starts.y"),t("starts.z"),t("maxdisplayed"),t("sizeref"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),g(e,a,r,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(y,ee,te){ee.exports={moduleType:"trace",name:"streamtube",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:y("./attributes"),supplyDefaults:y("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:y("./calc").calc,plot:y("./convert"),eventData:function(A,g){return A.tubex=A.x,A.tubey=A.y,A.tubez=A.z,A.tubeu=g.traceCoordinate[3],A.tubev=g.traceCoordinate[4],A.tubew=g.traceCoordinate[5],A.norm=g.traceCoordinate[6],A.divergence=g.traceCoordinate[7],delete A.x,delete A.y,delete A.z,A},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(y,ee,te){var A=y("../../plots/attributes"),g=y("../../plots/template_attributes").hovertemplateAttrs,S=y("../../plots/template_attributes").texttemplateAttrs,M=y("../../components/colorscale/attributes"),e=y("../../plots/domain").attributes,a=y("../pie/attributes"),n=y("./constants"),r=y("../../lib/extend").extendFlat;ee.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:r({colors:{valType:"data_array",editType:"calc"},line:{color:r({},a.marker.line.color,{dflt:null}),width:r({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},M("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:a.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:S({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:a.hovertext,hoverinfo:r({},A.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:g({},{keys:n.eventDataKeys}),textfont:a.textfont,insidetextorientation:a.insidetextorientation,insidetextfont:a.insidetextfont,outsidetextfont:r({},a.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:a.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(y,ee,te){var A=y("../../plots/plots");te.name="sunburst",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],1060:[function(y,ee,te){var A=y("d3-hierarchy"),g=y("fast-isnumeric"),S=y("../../lib"),M=y("../../components/colorscale").makeColorScaleFuncFromTrace,e=y("../pie/calc").makePullColorFn,a=y("../pie/calc").generateExtendedColors,n=y("../../components/colorscale").calc,r=y("../../constants/numerical").ALMOST_EQUAL,t={},h={},s={};te.calc=function(x,p){var v=x._fullLayout,f=p.ids,d=S.isArrayOrTypedArray(f),o=p.labels,m=p.parents,l=p.values,w=S.isArrayOrTypedArray(l),_=[],c={},b={},u=function(U,$){c[U]?c[U].push($):c[U]=[$],b[$]=1},L=function(U){return U||typeof U=="number"},T=function(U){return!w||g(l[U])&&l[U]>=0},k,P,z;d?(k=Math.min(f.length,m.length),P=function(U){return L(f[U])&&T(U)},z=function(U){return String(f[U])}):(k=Math.min(o.length,m.length),P=function(U){return L(o[U])&&T(U)},z=function(U){return String(o[U])}),w&&(k=Math.min(k,l.length));for(var I=0;I<k;I++)if(P(I)){var D=z(I),R=L(m[I])?String(m[I]):"",O={i:I,id:D,pid:R,label:L(o[I])?String(o[I]):""};w&&(O.v=+l[I]),_.push(O),u(R,D)}if(c[""]){if(c[""].length>1){for(var G=S.randstr(),K=0;K<_.length;K++)_[K].pid===""&&(_[K].pid=G);_.unshift({hasMultipleRoots:!0,id:G,pid:"",label:""})}}else{var F=[],N;for(N in c)b[N]||F.push(N);if(F.length===1)N=F[0],_.unshift({hasImpliedRoot:!0,id:N,pid:"",label:N});else return S.warn(["Multiple implied roots, cannot build",p.type,"hierarchy of",p.name+".","These roots include:",F.join(", ")].join(" "))}var W;try{W=A.stratify().id(function(U){return U.id}).parentId(function(U){return U.pid})(_)}catch(U){return S.warn(["Failed to build",p.type,"hierarchy of",p.name+".","Error:",U.message].join(" "))}var Y=A.hierarchy(W),re=!1;if(w)switch(p.branchvalues){case"remainder":Y.sum(function(U){return U.data.v});break;case"total":Y.each(function(U){var $=U.data.data,ne=$.v;if(U.children){var X=U.children.reduce(function(Q,ie){return Q+ie.data.data.v},0);if(($.hasImpliedRoot||$.hasMultipleRoots)&&(ne=X),ne<X*r)return re=!0,S.warn(["Total value for node",U.data.data.id,"of",p.name,"is smaller than the sum of its children.",`
parent value =`,ne,`
children sum =`,X].join(" "))}U.value=ne});break}else i(Y,p,{branches:p.count.indexOf("branches")!==-1,leaves:p.count.indexOf("leaves")!==-1});if(!re){p.sort&&Y.sort(function(U,$){return $.value-U.value});var ue,j,q=p.marker.colors||[],H=!!q.length;return p._hasColorscale?(H||(q=w?p.values:p._values),n(x,p,{vals:q,containerStr:"marker",cLetter:"c"}),j=M(p.marker)):ue=e(v["_"+p.type+"colormap"]),Y.each(function(U){var $=U.data.data;$.color=p._hasColorscale?j(q[$.i]):ue(q[$.i],$.id)}),_[0].hierarchy=Y,_}},te._runCrossTraceCalc=function(x,p){var v=p._fullLayout,f=p.calcdata,d=v[x+"colorway"],o=v["_"+x+"colormap"];v["extend"+x+"colors"]&&(d=a(d,x==="icicle"?s:x==="treemap"?h:t));var m=0,l;function w(u){var L=u.data.data,T=L.id;L.color===!1&&(o[T]?L.color=o[T]:u.parent?u.parent.parent?L.color=u.parent.data.data.color:(o[T]=L.color=d[m%d.length],m++):L.color=l)}for(var _=0;_<f.length;_++){var c=f[_],b=c[0];b.trace.type===x&&b.hierarchy&&(l=b.trace.root.color,b.hierarchy.each(w))}},te.crossTraceCalc=function(x){return te._runCrossTraceCalc("sunburst",x)};function i(x,p,v){var f=0,d=x.children;if(d){for(var o=d.length,m=0;m<o;m++)f+=i(d[m],p,v);v.branches&&f++}else v.leaves&&f++;return x.value=x.data.data.value=f,p._values||(p._values=[]),p._values[x.data.data.i]=f,f}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(y,ee,te){ee.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("../../plots/domain").defaults,M=y("../bar/defaults").handleText,e=y("../../components/colorscale"),a=e.hasColorscale,n=e.handleDefaults;ee.exports=function(t,h,s,i){function x(w,_){return A.coerce(t,h,g,w,_)}var p=x("labels"),v=x("parents");if(!p||!p.length||!v||!v.length){h.visible=!1;return}var f=x("values");f&&f.length?x("branchvalues"):x("count"),x("level"),x("maxdepth");var d=x("marker.line.width");d&&x("marker.line.color",i.paper_bgcolor),x("marker.colors");var o=h._hasColorscale=a(t,"marker","colors")||(t.marker||{}).coloraxis;o&&n(t,h,i,x,{prefix:"marker.",cLetter:"c"}),x("leaf.opacity",o?1:.7);var m=x("text");x("texttemplate"),h.texttemplate||x("textinfo",Array.isArray(m)?"text+label":"label"),x("hovertext"),x("hovertemplate");var l="auto";M(t,h,i,x,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),x("insidetextorientation"),x("sort"),x("rotation"),x("root.color"),S(h,i,x),h._length=null}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../registry"),S=y("../../components/fx/helpers").appendArrayPointValue,M=y("../../components/fx"),e=y("../../lib"),a=y("../../lib/events"),n=y("./helpers"),r=y("../pie/helpers"),t=r.formatPieValue;ee.exports=function(i,x,p,v,f){var d=v[0],o=d.trace,m=d.hierarchy,l=o.type==="sunburst",w=o.type==="treemap"||o.type==="icicle";"_hasHoverLabel"in o||(o._hasHoverLabel=!1),"_hasHoverEvent"in o||(o._hasHoverEvent=!1);var _=function(u){var L=p._fullLayout;if(!(p._dragging||L.hovermode===!1)){var T=p._fullData[o.index],k=u.data.data,P=k.i,z=n.isHierarchyRoot(u),I=n.getParent(m,u),D=n.getValue(u),R=function(Q){return e.castOption(T,P,Q)},O=R("hovertemplate"),F=M.castHoverinfo(T,L,P),N=L.separators,G;if(O||F&&F!=="none"&&F!=="skip"){var K,W;l&&(K=d.cx+u.pxmid[0]*(1-u.rInscribed),W=d.cy+u.pxmid[1]*(1-u.rInscribed)),w&&(K=u._hoverX,W=u._hoverY);var Y={},re=[],ue=[],j=function(Q){return re.indexOf(Q)!==-1};F&&(re=F==="all"?T._module.attributes.hoverinfo.flags:F.split("+")),Y.label=k.label,j("label")&&Y.label&&ue.push(Y.label),k.hasOwnProperty("v")&&(Y.value=k.v,Y.valueLabel=t(Y.value,N),j("value")&&ue.push(Y.valueLabel)),Y.currentPath=u.currentPath=n.getPath(u.data),j("current path")&&!z&&ue.push(Y.currentPath);var q,H=[],U=function(){H.indexOf(q)===-1&&(ue.push(q),H.push(q))};Y.percentParent=u.percentParent=D/n.getValue(I),Y.parent=u.parentString=n.getPtLabel(I),j("percent parent")&&(q=n.formatPercent(Y.percentParent,N)+" of "+Y.parent,U()),Y.percentEntry=u.percentEntry=D/n.getValue(x),Y.entry=u.entry=n.getPtLabel(x),j("percent entry")&&!z&&!u.onPathbar&&(q=n.formatPercent(Y.percentEntry,N)+" of "+Y.entry,U()),Y.percentRoot=u.percentRoot=D/n.getValue(m),Y.root=u.root=n.getPtLabel(m),j("percent root")&&!z&&(q=n.formatPercent(Y.percentRoot,N)+" of "+Y.root,U()),Y.text=R("hovertext")||R("text"),j("text")&&(q=Y.text,e.isValidTextValue(q)&&ue.push(q)),G=[h(u,T,f.eventDataKeys)];var $={trace:T,y:W,_x0:u._x0,_x1:u._x1,_y0:u._y0,_y1:u._y1,text:ue.join("<br>"),name:O||j("name")?T.name:void 0,color:R("hoverlabel.bgcolor")||k.color,borderColor:R("hoverlabel.bordercolor"),fontFamily:R("hoverlabel.font.family"),fontSize:R("hoverlabel.font.size"),fontColor:R("hoverlabel.font.color"),nameLength:R("hoverlabel.namelength"),textAlign:R("hoverlabel.align"),hovertemplate:O,hovertemplateLabels:Y,eventData:G};l&&($.x0=K-u.rInscribed*u.rpx1,$.x1=K+u.rInscribed*u.rpx1,$.idealAlign=u.pxmid[0]<0?"left":"right"),w&&($.x=K,$.idealAlign=K<0?"left":"right");var ne=[];M.loneHover($,{container:L._hoverlayer.node(),outerContainer:L._paper.node(),gd:p,inOut_bbox:ne}),G[0].bbox=ne[0],o._hasHoverLabel=!0}if(w){var X=i.select("path.surface");f.styleOne(X,u,T,{hovered:!0})}o._hasHoverEvent=!0,p.emit("plotly_hover",{points:G||[h(u,T,f.eventDataKeys)],event:A.event})}},c=function(u){var L=p._fullLayout,T=p._fullData[o.index],k=A.select(this).datum();if(o._hasHoverEvent&&(u.originalEvent=A.event,p.emit("plotly_unhover",{points:[h(k,T,f.eventDataKeys)],event:A.event}),o._hasHoverEvent=!1),o._hasHoverLabel&&(M.loneUnhover(L._hoverlayer.node()),o._hasHoverLabel=!1),w){var P=i.select("path.surface");f.styleOne(P,k,T,{hovered:!1})}},b=function(u){var L=p._fullLayout,T=p._fullData[o.index],k=l&&(n.isHierarchyRoot(u)||n.isLeaf(u)),P=n.getPtId(u),z=n.isEntry(u)?n.findEntryWithChild(m,P):n.findEntryWithLevel(m,P),I=n.getPtId(z),D={points:[h(u,T,f.eventDataKeys)],event:A.event};k||(D.nextLevel=I);var R=a.triggerHandler(p,"plotly_"+o.type+"click",D);if(R!==!1&&L.hovermode&&(p._hoverdata=[h(u,T,f.eventDataKeys)],M.click(p,A.event)),!k&&R!==!1&&!p._dragging&&!p._transitioning){g.call("_storeDirectGUIEdit",T,L._tracePreGUI[T.uid],{level:T.level});var O={data:[{level:I}],traces:[o.index]},F={frame:{redraw:!1,duration:f.transitionTime},transition:{duration:f.transitionTime,easing:f.transitionEasing},mode:"immediate",fromcurrent:!0};M.loneUnhover(L._hoverlayer.node()),g.call("animate",p,O,F)}};i.on("mouseover",_),i.on("mouseout",c),i.on("click",b)};function h(s,i,x){for(var p=s.data.data,v={curveNumber:i.index,pointNumber:p.i,data:i._input,fullData:i},f=0;f<x.length;f++){var d=x[f];d in s&&(v[d]=s[d])}return"parentString"in s&&!n.isHierarchyRoot(s)&&(v.parent=s.parentString),S(v,i,p.i),v}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color"),S=y("../../lib/setcursor"),M=y("../pie/helpers");te.findEntryWithLevel=function(r,t){var h;return t&&r.eachAfter(function(s){if(te.getPtId(s)===t)return h=s.copy()}),h||r},te.findEntryWithChild=function(r,t){var h;return r.eachAfter(function(s){for(var i=s.children||[],x=0;x<i.length;x++){var p=i[x];if(te.getPtId(p)===t)return h=s.copy()}}),h||r},te.isEntry=function(r){return!r.parent},te.isLeaf=function(r){return!r.children},te.getPtId=function(r){return r.data.data.id},te.getPtLabel=function(r){return r.data.data.label},te.getValue=function(r){return r.value},te.isHierarchyRoot=function(r){return n(r)===""},te.setSliceCursor=function(r,t,h){var s=h.isTransitioning;if(!s){var i=r.datum();s=h.hideOnRoot&&te.isHierarchyRoot(i)||h.hideOnLeaves&&te.isLeaf(i)}S(r,s?null:"pointer")};function e(r,t,h){return{color:te.getOutsideTextFontKey("color",r,t,h),family:te.getOutsideTextFontKey("family",r,t,h),size:te.getOutsideTextFontKey("size",r,t,h)}}function a(r,t,h,s){var i=(s||{}).onPathbar,x=t.data.data,p=x.i,v=A.castOption(r,p,(i?"pathbar.textfont":"insidetextfont")+".color");return!v&&r._input.textfont&&(v=A.castOption(r._input,p,"textfont.color")),{color:v||g.contrast(x.color),family:te.getInsideTextFontKey("family",r,t,h,s),size:te.getInsideTextFontKey("size",r,t,h,s)}}te.getInsideTextFontKey=function(r,t,h,s,i){var x=(i||{}).onPathbar,p=x?"pathbar.textfont":"insidetextfont",v=h.data.data.i;return A.castOption(t,v,p+"."+r)||A.castOption(t,v,"textfont."+r)||s.size},te.getOutsideTextFontKey=function(r,t,h,s){var i=h.data.data.i;return A.castOption(t,i,"outsidetextfont."+r)||A.castOption(t,i,"textfont."+r)||s.size},te.isOutsideText=function(r,t){return!r._hasColorscale&&te.isHierarchyRoot(t)},te.determineTextFont=function(r,t,h,s){return te.isOutsideText(r,t)?e(r,t,h):a(r,t,h,s)},te.hasTransition=function(r){return!!(r&&r.duration>0)},te.getMaxDepth=function(r){return r.maxdepth>=0?r.maxdepth:1/0},te.isHeader=function(r,t){return!(te.isLeaf(r)||r.depth===t._maxDepth-1)};function n(r){return r.data.data.pid}te.getParent=function(r,t){return te.findEntryWithLevel(r,n(t))},te.listPath=function(r,t){var h=r.parent;if(!h)return[];var s=t?[h.data[t]]:[h];return te.listPath(h,t).concat(s)},te.getPath=function(r){return te.listPath(r,"label").join("/")+"/"},te.formatValue=M.formatPieValue,te.formatPercent=function(r,t){var h=A.formatPercent(r,0);return h==="0%"&&(h=M.formatPiePercent(r,t)),h}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(y,ee,te){ee.exports={moduleType:"trace",name:"sunburst",basePlotModule:y("./base_plot"),categories:[],animatable:!0,attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot").plot,style:y("./style").style,colorbar:y("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(y,ee,te){ee.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("sunburstcolorway",e.colorway),a("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(y,ee,te){var A=y("@plotly/d3"),g=y("d3-hierarchy"),S=y("d3-interpolate").interpolate,M=y("../../components/drawing"),e=y("../../lib"),a=y("../../lib/svg_text_utils"),n=y("../bar/uniform_text"),r=n.recordMinTextSize,t=n.clearMinTextSize,h=y("../pie/plot"),s=y("../pie/helpers").getRotationAngle,i=h.computeTransform,x=h.transformInsideText,p=y("./style").styleOne,v=y("../bar/style").resizeText,f=y("./fx"),d=y("./constants"),o=y("./helpers");te.plot=function(b,u,L,T){var k=b._fullLayout,P=k._sunburstlayer,z,I,D=!L,R=!k.uniformtext.mode&&o.hasTransition(L);if(t("sunburst",k),z=P.selectAll("g.trace.sunburst").data(u,function(F){return F[0].trace.uid}),z.enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),z.order(),R){T&&(I=T());var O=A.transition().duration(L.duration).ease(L.easing).each("end",function(){I&&I()}).each("interrupt",function(){I&&I()});O.each(function(){P.selectAll("g.trace").each(function(F){m(b,F,this,L)})})}else z.each(function(F){m(b,F,this,L)}),k.uniformtext.mode&&v(b,k._sunburstlayer.selectAll(".trace"),"sunburst");D&&z.exit().remove()};function m(b,u,L,T){var k=b._context.staticPlot,P=b._fullLayout,z=!P.uniformtext.mode&&o.hasTransition(T),I=A.select(L),D=I.selectAll("g.slice"),R=u[0],O=R.trace,F=R.hierarchy,N=o.findEntryWithLevel(F,O.level),G=o.getMaxDepth(O),K=P._size,W=O.domain,Y=K.w*(W.x[1]-W.x[0]),re=K.h*(W.y[1]-W.y[0]),ue=.5*Math.min(Y,re),j=R.cx=K.l+K.w*(W.x[1]+W.x[0])/2,q=R.cy=K.t+K.h*(1-W.y[0])-re/2;if(!N)return D.remove();var H=null,U={};z&&D.each(function(ke){U[o.getPtId(ke)]={rpx0:ke.rpx0,rpx1:ke.rpx1,x0:ke.x0,x1:ke.x1,transform:ke.transform},!H&&o.isEntry(ke)&&(H=ke)});var $=l(N).descendants(),ne=N.height+1,X=0,Q=G;R.hasMultipleRoots&&o.isHierarchyRoot(N)&&($=$.slice(1),ne-=1,X=1,Q+=1),$=$.filter(function(ke){return ke.y1<=Q});var ie=s(O.rotation);ie&&$.forEach(function(ke){ke.x0+=ie,ke.x1+=ie});var se=Math.min(ne,G),ae=function(ke){return(ke-X)/se*ue},oe=function(ke,Xe){return[ke*Math.cos(Xe),-ke*Math.sin(Xe)]},be=function(ke){return e.pathAnnulus(ke.rpx0,ke.rpx1,ke.x0,ke.x1,j,q)},ce=function(ke){return j+_(ke)[0]*(ke.transform.rCenter||0)+(ke.transform.x||0)},de=function(ke){return q+_(ke)[1]*(ke.transform.rCenter||0)+(ke.transform.y||0)};D=D.data($,o.getPtId),D.enter().append("g").classed("slice",!0),z?D.exit().transition().each(function(){var ke=A.select(this),Xe=ke.select("path.surface");Xe.transition().attrTween("d",function(Ie){var De=Ee(Ie);return function(Ye){return be(De(Ye))}});var Ve=ke.select("g.slicetext");Ve.attr("opacity",0)}).remove():D.exit().remove(),D.order();var ye=null;if(z&&H){var ge=o.getPtId(H);D.each(function(ke){ye===null&&o.getPtId(ke)===ge&&(ye=ke.x1)})}var me=D;z&&(me=me.transition().each("end",function(){var ke=A.select(this);o.setSliceCursor(ke,b,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),me.each(function(ke){var Xe=A.select(this),Ve=e.ensureSingle(Xe,"path","surface",function(Kt){Kt.style("pointer-events",k?"none":"all")});ke.rpx0=ae(ke.y0),ke.rpx1=ae(ke.y1),ke.xmid=(ke.x0+ke.x1)/2,ke.pxmid=oe(ke.rpx1,ke.xmid),ke.midangle=-(ke.xmid-Math.PI/2),ke.startangle=-(ke.x0-Math.PI/2),ke.stopangle=-(ke.x1-Math.PI/2),ke.halfangle=.5*Math.min(e.angleDelta(ke.x0,ke.x1)||Math.PI,Math.PI),ke.ring=1-ke.rpx0/ke.rpx1,ke.rInscribed=w(ke),z?Ve.transition().attrTween("d",function(Kt){var Ft=Pe(Kt);return function(Mt){return be(Ft(Mt))}}):Ve.attr("d",be),Xe.call(f,N,b,u,{eventDataKeys:d.eventDataKeys,transitionTime:d.CLICK_TRANSITION_TIME,transitionEasing:d.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,b,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:b._transitioning}),Ve.call(p,ke,O);var Ie=e.ensureSingle(Xe,"g","slicetext"),De=e.ensureSingle(Ie,"text","",function(Kt){Kt.attr("data-notex",1)}),Ye=e.ensureUniformFontSize(b,o.determineTextFont(O,ke,P.font));De.text(te.formatSliceLabel(ke,N,O,u,P)).classed("slicetext",!0).attr("text-anchor","middle").call(M.font,Ye).call(a.convertToTspans,b);var vt=M.bBox(De.node());ke.transform=x(vt,ke,R),ke.transform.targetX=ce(ke),ke.transform.targetY=de(ke);var Dt=function(Kt,Ft){var Mt=Kt.transform;return i(Mt,Ft),Mt.fontSize=Ye.size,r(O.type,Mt,P),e.getTextTransform(Mt)};z?De.transition().attrTween("transform",function(Kt){var Ft=Ue(Kt);return function(Mt){return Dt(Ft(Mt),vt)}}):De.attr("transform",Dt(ke,vt))});function Ee(ke){var Xe=o.getPtId(ke),Ve=U[Xe],Ie=U[o.getPtId(N)],De;if(Ie){var Ye=(ke.x1>Ie.x1?2*Math.PI:0)+ie;De=ke.rpx1<Ie.rpx1?{x0:ke.x0,x1:ke.x1,rpx0:0,rpx1:0}:{x0:Ye,x1:Ye,rpx0:ke.rpx0,rpx1:ke.rpx1}}else{var vt,Dt=o.getPtId(ke.parent);D.each(function(It){if(o.getPtId(It)===Dt)return vt=It});var Kt=vt.children,Ft;Kt.forEach(function(It,At){if(o.getPtId(It)===Xe)return Ft=At});var Mt=Kt.length,Xt=S(vt.x0,vt.x1);De={rpx0:ue,rpx1:ue,x0:Xt(Ft/Mt),x1:Xt((Ft+1)/Mt)}}return S(Ve,De)}function Pe(ke){var Xe=U[o.getPtId(ke)],Ve,Ie={x0:ke.x0,x1:ke.x1,rpx0:ke.rpx0,rpx1:ke.rpx1};if(Xe)Ve=Xe;else if(H)if(ke.parent)if(ye){var De=(ke.x1>ye?2*Math.PI:0)+ie;Ve={x0:De,x1:De}}else Ve={rpx0:ue,rpx1:ue},e.extendFlat(Ve,we(ke));else Ve={rpx0:0,rpx1:0};else Ve={x0:ie,x1:ie};return S(Ve,Ie)}function Ue(ke){var Xe=U[o.getPtId(ke)],Ve,Ie=ke.transform;if(Xe)Ve=Xe;else if(Ve={rpx1:ke.rpx1,transform:{textPosAngle:Ie.textPosAngle,scale:0,rotate:Ie.rotate,rCenter:Ie.rCenter,x:Ie.x,y:Ie.y}},H)if(ke.parent)if(ye){var De=ke.x1>ye?2*Math.PI:0;Ve.x0=Ve.x1=De}else e.extendFlat(Ve,we(ke));else Ve.x0=Ve.x1=ie;else Ve.x0=Ve.x1=ie;var Ye=S(Ve.transform.textPosAngle,ke.transform.textPosAngle),vt=S(Ve.rpx1,ke.rpx1),Dt=S(Ve.x0,ke.x0),Kt=S(Ve.x1,ke.x1),Ft=S(Ve.transform.scale,Ie.scale),Mt=S(Ve.transform.rotate,Ie.rotate),Xt=Ie.rCenter===0?3:Ve.transform.rCenter===0?1/3:1,It=S(Ve.transform.rCenter,Ie.rCenter),At=function(Ge){return It(Math.pow(Ge,Xt))};return function(Ge){var tt=vt(Ge),He=Dt(Ge),Ae=Kt(Ge),Ne=At(Ge),Ze=oe(tt,(He+Ae)/2),Qe=Ye(Ge),bt={pxmid:Ze,rpx1:tt,transform:{textPosAngle:Qe,rCenter:Ne,x:Ie.x,y:Ie.y}};return r(O.type,Ie,P),{transform:{targetX:ce(bt),targetY:de(bt),scale:Ft(Ge),rotate:Mt(Ge),rCenter:Ne}}}}function we(ke){var Xe=ke.parent,Ve=U[o.getPtId(Xe)],Ie={};if(Ve){var De=Xe.children,Ye=De.indexOf(ke),vt=De.length,Dt=S(Ve.x0,Ve.x1);Ie.x0=Dt(Ye/vt),Ie.x1=Dt(Ye/vt)}else Ie.x0=Ie.x1=0;return Ie}}function l(b){return g.partition().size([2*Math.PI,b.height+1])(b)}te.formatSliceLabel=function(b,u,L,T,k){var P=L.texttemplate,z=L.textinfo;if(!P&&(!z||z==="none"))return"";var I=k.separators,D=T[0],R=b.data.data,O=D.hierarchy,F=o.isHierarchyRoot(b),N=o.getParent(O,b),G=o.getValue(b);if(!P){var K=z.split("+"),W=function(X){return K.indexOf(X)!==-1},Y=[],re;if(W("label")&&R.label&&Y.push(R.label),R.hasOwnProperty("v")&&W("value")&&Y.push(o.formatValue(R.v,I)),!F){W("current path")&&Y.push(o.getPath(b.data));var ue=0;W("percent parent")&&ue++,W("percent entry")&&ue++,W("percent root")&&ue++;var j=ue>1;if(ue){var q,H=function(X){re=o.formatPercent(q,I),j&&(re+=" of "+X),Y.push(re)};W("percent parent")&&!F&&(q=G/o.getValue(N),H("parent")),W("percent entry")&&(q=G/o.getValue(u),H("entry")),W("percent root")&&(q=G/o.getValue(O),H("root"))}}return W("text")&&(re=e.castOption(L,R.i,"text"),e.isValidTextValue(re)&&Y.push(re)),Y.join("<br>")}var U=e.castOption(L,R.i,"texttemplate");if(!U)return"";var $={};R.label&&($.label=R.label),R.hasOwnProperty("v")&&($.value=R.v,$.valueLabel=o.formatValue(R.v,I)),$.currentPath=o.getPath(b.data),F||($.percentParent=G/o.getValue(N),$.percentParentLabel=o.formatPercent($.percentParent,I),$.parent=o.getPtLabel(N)),$.percentEntry=G/o.getValue(u),$.percentEntryLabel=o.formatPercent($.percentEntry,I),$.entry=o.getPtLabel(u),$.percentRoot=G/o.getValue(O),$.percentRootLabel=o.formatPercent($.percentRoot,I),$.root=o.getPtLabel(O),R.hasOwnProperty("color")&&($.color=R.color);var ne=e.castOption(L,R.i,"text");return(e.isValidTextValue(ne)||ne==="")&&($.text=ne),$.customdata=e.castOption(L,R.i,"customdata"),e.texttemplateString(U,$,k._d3locale,$,L._meta||{})};function w(b){return b.rpx0===0&&e.isFullCircle([b.x0,b.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(b.halfangle)),b.ring/2))}function _(b){return c(b.rpx1,b.transform.textPosAngle)}function c(b,u){return[b*Math.sin(u),-b*Math.cos(u)]}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/color"),S=y("../../lib"),M=y("../bar/uniform_text").resizeText;function e(n){var r=n._fullLayout._sunburstlayer.selectAll(".trace");M(n,r,"sunburst"),r.each(function(t){var h=A.select(this),s=t[0],i=s.trace;h.style("opacity",i.opacity),h.selectAll("path.surface").each(function(x){A.select(this).call(a,x,i)})})}function a(n,r,t){var h=r.data.data,s=!r.children,i=h.i,x=S.castOption(t,i,"marker.line.color")||g.defaultLine,p=S.castOption(t,i,"marker.line.width")||0;n.style("stroke-width",p).call(g.fill,h.color).call(g.stroke,x).style("opacity",s?t.leaf.opacity:null)}ee.exports={style:e,styleOne:a}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(y,ee,te){var A=y("../../components/color"),g=y("../../components/colorscale/attributes"),S=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=y("../../plots/template_attributes").hovertemplateAttrs,e=y("../../plots/attributes"),a=y("../../lib/extend").extendFlat,n=y("../../plot_api/edit_types").overrideAll;function r(s){return{valType:"boolean",dflt:!1}}function t(s){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:r(),y:r(),z:r()},color:{valType:"color",dflt:A.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:A.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var h=ee.exports=n(a({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:M(),xhoverformat:S("x"),yhoverformat:S("y"),zhoverformat:S("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},g("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:t(),y:t(),z:t()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:a({},g.zauto,{}),zmin:a({},g.zmin,{}),zmax:a({},g.zmax,{})},hoverinfo:a({},e.hoverinfo),showlegend:a({},e.showlegend,{dflt:!1})}),"calc","nested");h.x.editType=h.y.editType=h.z.editType="calc+clearAxisTypes",h.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(y,ee,te){var A=y("../../components/colorscale/calc");ee.exports=function(S,M){M.surfacecolor?A(S,M,{vals:M.surfacecolor,containerStr:"",cLetter:"c"}):A(S,M,{vals:M.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_surface3d,g=y("../../../stackgl_modules").ndarray,S=y("../../../stackgl_modules").ndarray_linear_interpolate.d2,M=y("../heatmap/interp2d"),e=y("../heatmap/find_empties"),a=y("../../lib").isArrayOrTypedArray,n=y("../../lib/gl_format_color").parseColorScale,r=y("../../lib/str2rgbarray"),t=y("../../components/colorscale").extractOpts;function h(T,k,P){this.scene=T,this.uid=P,this.surface=k,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var s=h.prototype;s.getXat=function(T,k,P,z){var I=a(this.data.x)?a(this.data.x[0])?this.data.x[k][T]:this.data.x[T]:T;return P===void 0?I:z.d2l(I,0,P)},s.getYat=function(T,k,P,z){var I=a(this.data.y)?a(this.data.y[0])?this.data.y[k][T]:this.data.y[k]:k;return P===void 0?I:z.d2l(I,0,P)},s.getZat=function(T,k,P,z){var I=this.data.z[k][T];return I===null&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[k][T]),P===void 0?I:z.d2l(I,0,P)},s.handlePick=function(T){if(T.object===this.surface){var k=(T.data.index[0]-1)/this.dataScaleX-1,P=(T.data.index[1]-1)/this.dataScaleY-1,z=Math.max(Math.min(Math.round(k),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(P),this.data._ylength-1),0);T.index=[z,I],T.traceCoordinate=[this.getXat(z,I),this.getYat(z,I),this.getZat(z,I)],T.dataCoordinate=[this.getXat(z,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(z,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(z,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var D=0;D<3;D++){var R=T.dataCoordinate[D];R!=null&&(T.dataCoordinate[D]*=this.scene.dataScale[D])}var O=this.data.hovertext||this.data.text;return Array.isArray(O)&&O[I]&&O[I][z]!==void 0?T.textLabel=O[I][z]:O?T.textLabel=O:T.textLabel="",T.data.dataCoordinate=T.dataCoordinate.slice(),this.surface.highlight(T.data),this.scene.glplot.spikes.position=T.dataCoordinate,!0}};function i(T){var k=T[0].rgb,P=T[T.length-1].rgb;return k[0]===P[0]&&k[1]===P[1]&&k[2]===P[2]&&k[3]===P[3]}var x=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function p(T,k){if(T<k)return 0;for(var P=0;Math.floor(T%k)===0;)T/=k,P++;return P}function v(T){for(var k=[],P=0;P<x.length;P++){var z=x[P];k.push(p(T,z))}return k}function f(T){for(var k=v(T),P=T,z=0;z<x.length;z++)if(k[z]>0){P=x[z];break}return P}function d(T,k){if(!(T<1||k<1)){for(var P=v(T),z=v(k),I=1,D=0;D<x.length;D++)I*=Math.pow(x[D],Math.max(P[D],z[D]));return I}}function o(T){if(T.length!==0){for(var k=1,P=0;P<T.length;P++)k=d(k,T[P]);return k}}s.calcXnums=function(T){var k,P=[];for(k=1;k<T;k++){var z=this.getXat(k-1,0),I=this.getXat(k,0);I!==z&&z!==void 0&&z!==null&&I!==void 0&&I!==null?P[k-1]=Math.abs(I-z):P[k-1]=0}var D=0;for(k=1;k<T;k++)D+=P[k-1];for(k=1;k<T;k++)P[k-1]===0?P[k-1]=1:P[k-1]=Math.round(D/P[k-1]);return P},s.calcYnums=function(T){var k,P=[];for(k=1;k<T;k++){var z=this.getYat(0,k-1),I=this.getYat(0,k);I!==z&&z!==void 0&&z!==null&&I!==void 0&&I!==null?P[k-1]=Math.abs(I-z):P[k-1]=0}var D=0;for(k=1;k<T;k++)D+=P[k-1];for(k=1;k<T;k++)P[k-1]===0?P[k-1]=1:P[k-1]=Math.round(D/P[k-1]);return P};var m=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],l=m[9],w=m[13];s.estimateScale=function(T,k){for(var P=k===0?this.calcXnums(T):this.calcYnums(T),z=1+o(P);z<l;)z*=2;for(;z>w;)z--,z/=f(z),z++,z<l&&(z=w);var I=Math.round(z/T);return I>1?I:1};function _(T,k,P){var z=P[8]+P[2]*k[0]+P[5]*k[1];return T[0]=(P[6]+P[0]*k[0]+P[3]*k[1])/z,T[1]=(P[7]+P[1]*k[0]+P[4]*k[1])/z,T}function c(T,k,P){return b(T,k,_,P),T}function b(T,k,P,z){for(var I=[0,0],D=T.shape[0],R=T.shape[1],O=0;O<D;O++)for(var F=0;F<R;F++)P(I,[O,F],z),T.set(O,F,S(k,I[0],I[1]));return T}s.refineCoords=function(T){for(var k=this.dataScaleX,P=this.dataScaleY,z=T[0].shape[0],I=T[0].shape[1],D=Math.floor(T[0].shape[0]*k+1)|0,R=Math.floor(T[0].shape[1]*P+1)|0,O=1+z+1,F=1+I+1,N=g(new Float32Array(O*F),[O,F]),G=[1/k,0,0,0,1/P,0,0,0,1],K=0;K<T.length;++K){this.surface.padField(N,T[K]);var W=g(new Float32Array(D*R),[D,R]);c(W,N,G),T[K]=W}};function u(T,k){for(var P=!1,z=0;z<T.length;z++)if(k===T[z]){P=!0;break}P===!1&&T.push(k)}s.setContourLevels=function(){var T=[[],[],[]],k=[!1,!1,!1],P=!1,z,I,D;for(z=0;z<3;++z)if(this.showContour[z]&&(P=!0,this.contourSize[z]>0&&this.contourStart[z]!==null&&this.contourEnd[z]!==null&&this.contourEnd[z]>this.contourStart[z]))for(k[z]=!0,I=this.contourStart[z];I<this.contourEnd[z];I+=this.contourSize[z])D=I*this.scene.dataScale[z],u(T[z],D);if(P){var R=[[],[],[]];for(z=0;z<3;++z)this.showContour[z]&&(R[z]=k[z]?T[z]:this.scene.contourLevels[z]);this.surface.update({levels:R})}},s.update=function(T){var k=this.scene,P=k.fullSceneLayout,z=this.surface,I=n(T),D=k.dataScale,R=T.z[0].length,O=T._ylength,F=k.contourLevels;this.data=T;var N,G,K,W,Y=[];for(N=0;N<3;N++)for(Y[N]=[],G=0;G<R;G++)Y[N][G]=[];for(G=0;G<R;G++)for(K=0;K<O;K++)Y[0][G][K]=this.getXat(G,K,T.xcalendar,P.xaxis),Y[1][G][K]=this.getYat(G,K,T.ycalendar,P.yaxis),Y[2][G][K]=this.getZat(G,K,T.zcalendar,P.zaxis);if(T.connectgaps)for(T._emptypoints=e(Y[2]),M(Y[2],T._emptypoints),T._interpolatedZ=[],G=0;G<R;G++)for(T._interpolatedZ[G]=[],K=0;K<O;K++)T._interpolatedZ[G][K]=Y[2][G][K];for(N=0;N<3;N++)for(G=0;G<R;G++)for(K=0;K<O;K++)W=Y[N][G][K],W==null?Y[N][G][K]=NaN:W=Y[N][G][K]*=D[N];for(N=0;N<3;N++)for(G=0;G<R;G++)for(K=0;K<O;K++)W=Y[N][G][K],W!=null&&(this.minValues[N]>W&&(this.minValues[N]=W),this.maxValues[N]<W&&(this.maxValues[N]=W));for(N=0;N<3;N++)this.objectOffset[N]=.5*(this.minValues[N]+this.maxValues[N]);for(N=0;N<3;N++)for(G=0;G<R;G++)for(K=0;K<O;K++)W=Y[N][G][K],W!=null&&(Y[N][G][K]-=this.objectOffset[N]);var re=[g(new Float32Array(R*O),[R,O]),g(new Float32Array(R*O),[R,O]),g(new Float32Array(R*O),[R,O])];for(N=0;N<3;N++)for(G=0;G<R;G++)for(K=0;K<O;K++)re[N].set(G,K,Y[N][G][K]);Y=[];var ue={colormap:I,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!T.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:T.opacityscale,opacity:T.opacity},j=t(T);if(ue.intensityBounds=[j.min,j.max],T.surfacecolor){var q=g(new Float32Array(R*O),[R,O]);for(G=0;G<R;G++)for(K=0;K<O;K++)q.set(G,K,T.surfacecolor[K][G]);re.push(q)}else ue.intensityBounds[0]*=D[2],ue.intensityBounds[1]*=D[2];(w<re[0].shape[0]||w<re[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(re[0].shape[0],0),this.dataScaleY=this.estimateScale(re[0].shape[1],1),(this.dataScaleX!==1||this.dataScaleY!==1)&&this.refineCoords(re)),T.surfacecolor&&(ue.intensity=re.pop());var H=[!0,!0,!0],U=["x","y","z"];for(N=0;N<3;++N){var $=T.contours[U[N]];H[N]=$.highlight,ue.showContour[N]=$.show||$.highlight,ue.showContour[N]&&(ue.contourProject[N]=[$.project.x,$.project.y,$.project.z],$.show?(this.showContour[N]=!0,ue.levels[N]=F[N],z.highlightColor[N]=ue.contourColor[N]=r($.color),$.usecolormap?z.highlightTint[N]=ue.contourTint[N]=0:z.highlightTint[N]=ue.contourTint[N]=1,ue.contourWidth[N]=$.width,this.contourStart[N]=$.start,this.contourEnd[N]=$.end,this.contourSize[N]=$.size):(this.showContour[N]=!1,this.contourStart[N]=null,this.contourEnd[N]=null,this.contourSize[N]=0),$.highlight&&(ue.dynamicColor[N]=r($.highlightcolor),ue.dynamicWidth[N]=$.highlightwidth))}i(I)&&(ue.vertexColor=!0),ue.objectOffset=this.objectOffset,ue.coords=re,z.update(ue),z.visible=T.visible,z.enableDynamic=H,z.enableHighlight=H,z.snapToData=!0,"lighting"in T&&(z.ambientLight=T.lighting.ambient,z.diffuseLight=T.lighting.diffuse,z.specularLight=T.lighting.specular,z.roughness=T.lighting.roughness,z.fresnel=T.lighting.fresnel),"lightposition"in T&&(z.lightPosition=[T.lightposition.x,T.lightposition.y,T.lightposition.z])},s.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()};function L(T,k){var P=T.glplot.gl,z=A({gl:P}),I=new h(T,z,k.uid);return z._trace=I,I.update(k),T.glplot.add(z),I}ee.exports=L},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(y,ee,te){var A=y("../../registry"),g=y("../../lib"),S=y("../../components/colorscale/defaults"),M=y("./attributes"),e=.1;function a(s,i){for(var x=[],p=32,v=0;v<p;v++){var f=v/(p-1),d=i+(1-i)*(1-Math.pow(Math.sin(s*f*Math.PI),2));x.push([f,Math.max(0,Math.min(1,d))])}return x}function n(s){var i=0;if(!Array.isArray(s)||s.length<2||!s[0]||!s[s.length-1]||+s[0][0]!=0||+s[s.length-1][0]!=1)return!1;for(var x=0;x<s.length;x++){var p=s[x];if(p.length!==2||+p[0]<i)return!1;i=+p[0]}return!0}function r(s,i,x,p){var v,f;function d(T,k){return g.coerce(s,i,M,T,k)}var o=d("x"),m=d("y"),l=d("z");if(!l||!l.length||o&&o.length<1||m&&m.length<1){i.visible=!1;return}i._xlength=Array.isArray(o)&&g.isArrayOrTypedArray(o[0])?l.length:l[0].length,i._ylength=l.length;var w=A.getComponentMethod("calendars","handleTraceDefaults");w(s,i,["x","y","z"],p),d("text"),d("hovertext"),d("hovertemplate"),d("xhoverformat"),d("yhoverformat"),d("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(T){d(T)});var _=d("surfacecolor"),c=["x","y","z"];for(v=0;v<3;++v){var b="contours."+c[v],u=d(b+".show"),L=d(b+".highlight");if(u||L)for(f=0;f<3;++f)d(b+".project."+c[f]);u&&(d(b+".color"),d(b+".width"),d(b+".usecolormap")),L&&(d(b+".highlightcolor"),d(b+".highlightwidth")),d(b+".start"),d(b+".end"),d(b+".size")}_||(h(s,"zmin","cmin"),h(s,"zmax","cmax"),h(s,"zauto","cauto")),S(s,i,p,d,{prefix:"",cLetter:"c"}),t(s,i,p,d),i._length=null}function t(s,i,x,p){var v=p("opacityscale");v==="max"?i.opacityscale=[[0,e],[1,1]]:v==="min"?i.opacityscale=[[0,1],[1,e]]:v==="extremes"?i.opacityscale=a(1,e):n(v)||(i.opacityscale=void 0)}function h(s,i,x){i in s&&!(x in s)&&(s[x]=s[i])}ee.exports={supplyDefaults:r,opacityscaleDefaults:t}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:y("./calc"),plot:y("./convert"),moduleType:"trace",name:"surface",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(y,ee,te){var A=y("../../components/annotations/attributes"),g=y("../../lib/extend").extendFlat,S=y("../../plot_api/edit_types").overrideAll,M=y("../../plots/font_attributes"),e=y("../../plots/domain").attributes,a=y("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,n=ee.exports=S({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:a("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:g({},A.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:g({},M({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:a("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:g({},A.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:g({},M({arrayOk:!0}))}},"calc","from-root");n.transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(y,ee,te){var A=y("../../plots/get_data").getModuleCalcData,g=y("./plot"),S="table";te.name=S,te.plot=function(M){var e=A(M.calcdata,S)[0];e.length&&g(M,e)},te.clean=function(M,e,a,n){var r=n._has&&n._has(S),t=e._has&&e._has(S);r&&!t&&n._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(y,ee,te){var A=y("../../lib/gup").wrap;ee.exports=function(){return A({})}},{"../../lib/gup":512}],1078:[function(y,ee,te){ee.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(y,ee,te){var A=y("./constants"),g=y("../../lib/extend").extendFlat,S=y("fast-isnumeric");ee.exports=function(x,p){var v=a(p.cells.values),f=function(G){return G.slice(p.header.values.length,G.length)},d=a(p.header.values);d.length&&!d[0].length&&(d[0]=[""],d=a(d));var o=d.concat(f(v).map(function(){return n((d[0]||[""]).length)})),m=p.domain,l=Math.floor(x._fullLayout._size.w*(m.x[1]-m.x[0])),w=Math.floor(x._fullLayout._size.h*(m.y[1]-m.y[0])),_=p.header.values.length?o[0].map(function(){return p.header.height}):[A.emptyHeaderHeight],c=v.length?v[0].map(function(){return p.cells.height}):[],b=_.reduce(e,0),u=w-b,L=u+A.uplift,T=h(c,L),k=h(_,b),P=t(k,[]),z=t(T,P),I={},D=p._fullInput.columnorder.concat(f(v.map(function(G,K){return K}))),R=o.map(function(G,K){var W=Array.isArray(p.columnwidth)?p.columnwidth[Math.min(K,p.columnwidth.length-1)]:p.columnwidth;return S(W)?Number(W):1}),O=R.reduce(e,0);R=R.map(function(G){return G/O*l});var F=Math.max(M(p.header.line.width),M(p.cells.line.width)),N={key:p.uid+x._context.staticPlot,translateX:m.x[0]*x._fullLayout._size.w,translateY:x._fullLayout._size.h*(1-m.y[1]),size:x._fullLayout._size,width:l,maxLineWidth:F,height:w,columnOrder:D,groupHeight:w,rowBlocks:z,headerRowBlocks:P,scrollY:0,cells:g({},p.cells,{values:v}),headerCells:g({},p.header,{values:o}),gdColumns:o.map(function(G){return G[0]}),gdColumnsOriginalOrder:o.map(function(G){return G[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:o.map(function(G,K){var W=I[G];I[G]=(W||0)+1;var Y=G+"__"+I[G];return{key:Y,label:G,specIndex:K,xIndex:D[K],xScale:r,x:void 0,calcdata:void 0,columnWidth:R[K]}})};return N.columns.forEach(function(G){G.calcdata=N,G.x=r(G)}),N};function M(i){if(Array.isArray(i)){for(var x=0,p=0;p<i.length;p++)x=Math.max(x,M(i[p]));return x}return i}function e(i,x){return i+x}function a(i){var x=i.slice(),p=1/0,v=0,f;for(f=0;f<x.length;f++)Array.isArray(x[f])||(x[f]=[x[f]]),p=Math.min(p,x[f].length),v=Math.max(v,x[f].length);if(p!==v)for(f=0;f<x.length;f++){var d=v-x[f].length;d&&(x[f]=x[f].concat(n(d)))}return x}function n(i){for(var x=new Array(i),p=0;p<i;p++)x[p]="";return x}function r(i){return i.calcdata.columns.reduce(function(x,p){return p.xIndex<i.xIndex?x+p.columnWidth:x},0)}function t(i,x){var p=Object.keys(i);return p.map(function(v){return g({},i[v],{auxiliaryBlocks:x})})}function h(i,x){for(var p={},v,f=0,d=0,o=s(),m=0,l=0,w=0;w<i.length;w++)v=i[w],o.rows.push({rowIndex:w,rowHeight:v}),d+=v,(d>=x||w===i.length-1)&&(p[f]=o,o.key=l++,o.firstRowIndex=m,o.lastRowIndex=w,o=s(),f+=d,m=w+1,d=0);return p}function s(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(y,ee,te){var A=y("../../lib/extend").extendFlat;te.splitToPanels=function(S){var M=[0,0],e=A({},S,{key:"header",type:"header",page:0,prevPages:M,currentRepaint:[null,null],dragHandle:!0,values:S.calcdata.headerCells.values[S.specIndex],rowBlocks:S.calcdata.headerRowBlocks,calcdata:A({},S.calcdata,{cells:S.calcdata.headerCells})}),a=A({},S,{key:"cells1",type:"cells",page:0,prevPages:M,currentRepaint:[null,null],dragHandle:!1,values:S.calcdata.cells.values[S.specIndex],rowBlocks:S.calcdata.rowBlocks}),n=A({},S,{key:"cells2",type:"cells",page:1,prevPages:M,currentRepaint:[null,null],dragHandle:!1,values:S.calcdata.cells.values[S.specIndex],rowBlocks:S.calcdata.rowBlocks});return[a,n,e]},te.splitToCells=function(S){var M=g(S);return(S.values||[]).slice(M[0],M[1]).map(function(e,a){var n=typeof e=="string"&&e.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:a+n,key:M[0]+a,column:S,calcdata:S.calcdata,page:S.page,rowBlocks:S.rowBlocks,value:e}})};function g(S){var M=S.rowBlocks[S.page],e=M?M.rows[0].rowIndex:0,a=M?e+M.rows.length:0;return[e,a]}},{"../../lib/extend":505}],1081:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("../../plots/domain").defaults;function M(e,a){for(var n=e.columnorder||[],r=e.header.values.length,t=n.slice(0,r),h=t.slice().sort(function(x,p){return x-p}),s=t.map(function(x){return h.indexOf(x)}),i=s.length;i<r;i++)s.push(i);a("columnorder",s)}ee.exports=function(a,n,r,t){function h(s,i){return A.coerce(a,n,g,s,i)}S(n,t,h),h("columnwidth"),h("header.values"),h("header.format"),h("header.align"),h("header.prefix"),h("header.suffix"),h("header.height"),h("header.line.width"),h("header.line.color"),h("header.fill.color"),A.coerceFont(h,"header.font",A.extendFlat({},t.font)),M(n,h),h("cells.values"),h("cells.format"),h("cells.align"),h("cells.prefix"),h("cells.suffix"),h("cells.height"),h("cells.line.width"),h("cells.line.color"),h("cells.fill.color"),A.coerceFont(h,"cells.font",A.extendFlat({},t.font)),n._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("./calc"),plot:y("./plot"),moduleType:"trace",name:"table",basePlotModule:y("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(y,ee,te){var A=y("./constants"),g=y("@plotly/d3"),S=y("../../lib"),M=S.numberFormat,e=y("../../lib/gup"),a=y("../../components/drawing"),n=y("../../lib/svg_text_utils"),r=y("../../lib").raiseToTop,t=y("../../lib").strTranslate,h=y("../../lib").cancelTransition,s=y("./data_preparation_helper"),i=y("./data_split_helpers"),x=y("../../components/color");ee.exports=function(ie,se){var ae=!ie._context.staticPlot,oe=ie._fullLayout._paper.selectAll("."+A.cn.table).data(se.map(function(Ie){var De=e.unwrap(Ie),Ye=De.trace;return s(ie,Ye)}),e.keyFun);oe.exit().remove(),oe.enter().append("g").classed(A.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),oe.attr("width",function(Ie){return Ie.width+Ie.size.l+Ie.size.r}).attr("height",function(Ie){return Ie.height+Ie.size.t+Ie.size.b}).attr("transform",function(Ie){return t(Ie.translateX,Ie.translateY)});var be=oe.selectAll("."+A.cn.tableControlView).data(e.repeat,e.keyFun),ce=be.enter().append("g").classed(A.cn.tableControlView,!0).style("box-sizing","content-box");if(ae){var de="onwheel"in document?"wheel":"mousewheel";ce.on("mousemove",function(Ie){be.filter(function(De){return Ie===De}).call(o,ie)}).on(de,function(Ie){if(!Ie.scrollbarState.wheeling){Ie.scrollbarState.wheeling=!0;var De=Ie.scrollY+g.event.deltaY,Ye=W(ie,be,null,De)(Ie);Ye||(g.event.stopPropagation(),g.event.preventDefault()),Ie.scrollbarState.wheeling=!1}}).call(o,ie,!0)}be.attr("transform",function(Ie){return t(Ie.size.l,Ie.size.t)});var ye=be.selectAll("."+A.cn.scrollBackground).data(e.repeat,e.keyFun);ye.enter().append("rect").classed(A.cn.scrollBackground,!0).attr("fill","none"),ye.attr("width",function(Ie){return Ie.width}).attr("height",function(Ie){return Ie.height}),be.each(function(Ie){a.setClipUrl(g.select(this),v(ie,Ie),ie)});var ge=be.selectAll("."+A.cn.yColumn).data(function(Ie){return Ie.columns},e.keyFun);ge.enter().append("g").classed(A.cn.yColumn,!0),ge.exit().remove(),ge.attr("transform",function(Ie){return t(Ie.x,0)}),ae&&ge.call(g.behavior.drag().origin(function(Ie){var De=g.select(this);return R(De,Ie,-A.uplift),r(this),Ie.calcdata.columnDragInProgress=!0,o(be.filter(function(Ye){return Ie.calcdata.key===Ye.key}),ie),Ie}).on("drag",function(Ie){var De=g.select(this),Ye=function(Kt){return(Ie===Kt?g.event.x:Kt.x)+Kt.columnWidth/2};Ie.x=Math.max(-A.overdrag,Math.min(Ie.calcdata.width+A.overdrag-Ie.columnWidth,g.event.x));var vt=d(ge).filter(function(Kt){return Kt.calcdata.key===Ie.calcdata.key}),Dt=vt.sort(function(Kt,Ft){return Ye(Kt)-Ye(Ft)});Dt.forEach(function(Kt,Ft){Kt.xIndex=Ft,Kt.x=Ie===Kt?Kt.x:Kt.xScale(Kt)}),ge.filter(function(Kt){return Ie!==Kt}).transition().ease(A.transitionEase).duration(A.transitionDuration).attr("transform",function(Kt){return t(Kt.x,0)}),De.call(h).attr("transform",t(Ie.x,-A.uplift))}).on("dragend",function(Ie){var De=g.select(this),Ye=Ie.calcdata;Ie.x=Ie.xScale(Ie),Ie.calcdata.columnDragInProgress=!1,R(De,Ie,0),I(ie,Ye,Ye.columns.map(function(vt){return vt.xIndex}))})),ge.each(function(Ie){a.setClipUrl(g.select(this),f(ie,Ie),ie)});var me=ge.selectAll("."+A.cn.columnBlock).data(i.splitToPanels,e.keyFun);me.enter().append("g").classed(A.cn.columnBlock,!0).attr("id",function(Ie){return Ie.key}),me.style("cursor",function(Ie){return Ie.dragHandle?"ew-resize":Ie.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var Ee=me.filter(F),Pe=me.filter(O);ae&&Pe.call(g.behavior.drag().origin(function(Ie){return g.event.stopPropagation(),Ie}).on("drag",W(ie,be,-1)).on("dragend",function(){})),m(ie,be,Ee,me),m(ie,be,Pe,me);var Ue=be.selectAll("."+A.cn.scrollAreaClip).data(e.repeat,e.keyFun);Ue.enter().append("clipPath").classed(A.cn.scrollAreaClip,!0).attr("id",function(Ie){return v(ie,Ie)});var we=Ue.selectAll("."+A.cn.scrollAreaClipRect).data(e.repeat,e.keyFun);we.enter().append("rect").classed(A.cn.scrollAreaClipRect,!0).attr("x",-A.overdrag).attr("y",-A.uplift).attr("fill","none"),we.attr("width",function(Ie){return Ie.width+2*A.overdrag}).attr("height",function(Ie){return Ie.height+A.uplift});var ke=ge.selectAll("."+A.cn.columnBoundary).data(e.repeat,e.keyFun);ke.enter().append("g").classed(A.cn.columnBoundary,!0);var Xe=ge.selectAll("."+A.cn.columnBoundaryClippath).data(e.repeat,e.keyFun);Xe.enter().append("clipPath").classed(A.cn.columnBoundaryClippath,!0),Xe.attr("id",function(Ie){return f(ie,Ie)});var Ve=Xe.selectAll("."+A.cn.columnBoundaryRect).data(e.repeat,e.keyFun);Ve.enter().append("rect").classed(A.cn.columnBoundaryRect,!0).attr("fill","none"),Ve.attr("width",function(Ie){return Ie.columnWidth+2*p(Ie)}).attr("height",function(Ie){return Ie.calcdata.height+2*p(Ie)+A.uplift}).attr("x",function(Ie){return-p(Ie)}).attr("y",function(Ie){return-p(Ie)}),K(null,Pe,be)};function p(Q){return Math.ceil(Q.calcdata.maxLineWidth/2)}function v(Q,ie){return"clip"+Q._fullLayout._uid+"_scrollAreaBottomClip_"+ie.key}function f(Q,ie){return"clip"+Q._fullLayout._uid+"_columnBoundaryClippath_"+ie.calcdata.key+"_"+ie.specIndex}function d(Q){return[].concat.apply([],Q.map(function(ie){return ie})).map(function(ie){return ie.__data__})}function o(Q,ie,se){function ae(ge){var me=ge.rowBlocks;return H(me,me.length-1)+(me.length?U(me[me.length-1],1/0):1)}var oe=Q.selectAll("."+A.cn.scrollbarKit).data(e.repeat,e.keyFun);oe.enter().append("g").classed(A.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),oe.each(function(ge){var me=ge.scrollbarState;me.totalHeight=ae(ge),me.scrollableAreaHeight=ge.groupHeight-N(ge),me.currentlyVisibleHeight=Math.min(me.totalHeight,me.scrollableAreaHeight),me.ratio=me.currentlyVisibleHeight/me.totalHeight,me.barLength=Math.max(me.ratio*me.currentlyVisibleHeight,A.goldenRatio*A.scrollbarWidth),me.barWiggleRoom=me.currentlyVisibleHeight-me.barLength,me.wiggleRoom=Math.max(0,me.totalHeight-me.scrollableAreaHeight),me.topY=me.barWiggleRoom===0?0:ge.scrollY/me.wiggleRoom*me.barWiggleRoom,me.bottomY=me.topY+me.barLength,me.dragMultiplier=me.wiggleRoom/me.barWiggleRoom}).attr("transform",function(ge){var me=ge.width+A.scrollbarWidth/2+A.scrollbarOffset;return t(me,N(ge))});var be=oe.selectAll("."+A.cn.scrollbar).data(e.repeat,e.keyFun);be.enter().append("g").classed(A.cn.scrollbar,!0);var ce=be.selectAll("."+A.cn.scrollbarSlider).data(e.repeat,e.keyFun);ce.enter().append("g").classed(A.cn.scrollbarSlider,!0),ce.attr("transform",function(ge){return t(0,ge.scrollbarState.topY||0)});var de=ce.selectAll("."+A.cn.scrollbarGlyph).data(e.repeat,e.keyFun);de.enter().append("line").classed(A.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",A.scrollbarWidth).attr("stroke-linecap","round").attr("y1",A.scrollbarWidth/2),de.attr("y2",function(ge){return ge.scrollbarState.barLength-A.scrollbarWidth/2}).attr("stroke-opacity",function(ge){return ge.columnDragInProgress||!ge.scrollbarState.barWiggleRoom||se?0:.4}),de.transition().delay(0).duration(0),de.transition().delay(A.scrollbarHideDelay).duration(A.scrollbarHideDuration).attr("stroke-opacity",0);var ye=be.selectAll("."+A.cn.scrollbarCaptureZone).data(e.repeat,e.keyFun);ye.enter().append("line").classed(A.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",A.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(ge){var me=g.event.y,Ee=this.getBoundingClientRect(),Pe=ge.scrollbarState,Ue=me-Ee.top,we=g.scale.linear().domain([0,Pe.scrollableAreaHeight]).range([0,Pe.totalHeight]).clamp(!0);Pe.topY<=Ue&&Ue<=Pe.bottomY||W(ie,Q,null,we(Ue-Pe.barLength/2))(ge)}).call(g.behavior.drag().origin(function(ge){return g.event.stopPropagation(),ge.scrollbarState.scrollbarScrollInProgress=!0,ge}).on("drag",W(ie,Q)).on("dragend",function(){})),ye.attr("y2",function(ge){return ge.scrollbarState.scrollableAreaHeight}),ie._context.staticPlot&&(de.remove(),ye.remove())}function m(Q,ie,se,ae){var oe=l(se),be=w(oe);u(be);var ce=_(be);T(ce);var de=b(be),ye=c(de);L(ye),k(ye,ie,ae,Q),q(be)}function l(Q){var ie=Q.selectAll("."+A.cn.columnCells).data(e.repeat,e.keyFun);return ie.enter().append("g").classed(A.cn.columnCells,!0),ie.exit().remove(),ie}function w(Q){var ie=Q.selectAll("."+A.cn.columnCell).data(i.splitToCells,function(se){return se.keyWithinBlock});return ie.enter().append("g").classed(A.cn.columnCell,!0),ie.exit().remove(),ie}function _(Q){var ie=Q.selectAll("."+A.cn.cellRect).data(e.repeat,function(se){return se.keyWithinBlock});return ie.enter().append("rect").classed(A.cn.cellRect,!0),ie}function c(Q){var ie=Q.selectAll("."+A.cn.cellText).data(e.repeat,function(se){return se.keyWithinBlock});return ie.enter().append("text").classed(A.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){g.event.stopPropagation()}),ie}function b(Q){var ie=Q.selectAll("."+A.cn.cellTextHolder).data(e.repeat,function(se){return se.keyWithinBlock});return ie.enter().append("g").classed(A.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),ie}function u(Q){Q.each(function(ie,se){var ae=ie.calcdata.cells.font,oe=ie.column.specIndex,be={size:D(ae.size,oe,se),color:D(ae.color,oe,se),family:D(ae.family,oe,se)};ie.rowNumber=ie.key,ie.align=D(ie.calcdata.cells.align,oe,se),ie.cellBorderWidth=D(ie.calcdata.cells.line.width,oe,se),ie.font=be})}function L(Q){Q.each(function(ie){a.font(g.select(this),ie.font)})}function T(Q){Q.attr("width",function(ie){return ie.column.columnWidth}).attr("stroke-width",function(ie){return ie.cellBorderWidth}).each(function(ie){var se=g.select(this);x.stroke(se,D(ie.calcdata.cells.line.color,ie.column.specIndex,ie.rowNumber)),x.fill(se,D(ie.calcdata.cells.fill.color,ie.column.specIndex,ie.rowNumber))})}function k(Q,ie,se,ae){Q.text(function(oe){var be=oe.column.specIndex,ce=oe.rowNumber,de=oe.value,ye=typeof de=="string",ge=ye&&de.match(/<br>/i),me=!ye||ge;oe.mayHaveMarkup=ye&&de.match(/[<&>]/);var Ee=P(de);oe.latex=Ee;var Pe=Ee?"":D(oe.calcdata.cells.prefix,be,ce)||"",Ue=Ee?"":D(oe.calcdata.cells.suffix,be,ce)||"",we=Ee?null:D(oe.calcdata.cells.format,be,ce)||null,ke=Pe+(we?M(we)(oe.value):oe.value)+Ue,Xe;oe.wrappingNeeded=!oe.wrapped&&!me&&!Ee&&(Xe=z(ke)),oe.cellHeightMayIncrease=ge||Ee||oe.mayHaveMarkup||(Xe===void 0?z(ke):Xe),oe.needsConvertToTspans=oe.mayHaveMarkup||oe.wrappingNeeded||oe.latex;var Ve;if(oe.wrappingNeeded){var Ie=A.wrapSplitCharacter===" "?ke.replace(/<a href=/ig,"<a_href="):ke,De=Ie.split(A.wrapSplitCharacter),Ye=A.wrapSplitCharacter===" "?De.map(function(vt){return vt.replace(/<a_href=/ig,"<a href=")}):De;oe.fragments=Ye.map(function(vt){return{text:vt,width:null}}),oe.fragments.push({fragment:A.wrapSpacer,width:null}),Ve=Ye.join(A.lineBreaker)+A.lineBreaker+A.wrapSpacer}else delete oe.fragments,Ve=ke;return Ve}).attr("dy",function(oe){return oe.needsConvertToTspans?0:"0.75em"}).each(function(oe){var be=this,ce=g.select(be),de=oe.wrappingNeeded?re:ue;oe.needsConvertToTspans?n.convertToTspans(ce,ae,de(se,be,ie,ae,oe)):g.select(be.parentNode).attr("transform",function(ye){return t(j(ye),A.cellPad)}).attr("text-anchor",function(ye){return{left:"start",center:"middle",right:"end"}[ye.align]})})}function P(Q){return typeof Q=="string"&&Q.match(A.latexCheck)}function z(Q){return Q.indexOf(A.wrapSplitCharacter)!==-1}function I(Q,ie,se){var ae=ie.gdColumnsOriginalOrder;ie.gdColumns.sort(function(oe,be){return se[ae.indexOf(oe)]-se[ae.indexOf(be)]}),ie.columnorder=se,Q.emit("plotly_restyle")}function D(Q,ie,se){if(Array.isArray(Q)){var ae=Q[Math.min(ie,Q.length-1)];return Array.isArray(ae)?ae[Math.min(se,ae.length-1)]:ae}else return Q}function R(Q,ie,se){Q.transition().ease(A.releaseTransitionEase).duration(A.releaseTransitionDuration).attr("transform",t(ie.x,se))}function O(Q){return Q.type==="cells"}function F(Q){return Q.type==="header"}function N(Q){var ie=Q.rowBlocks.length?Q.rowBlocks[0].auxiliaryBlocks:[];return ie.reduce(function(se,ae){return se+U(ae,1/0)},0)}function G(Q,ie,se){for(var ae=[],oe=0,be=0;be<Q.length;be++){for(var ce=Q[be],de=ce.rows,ye=0,ge=0;ge<de.length;ge++)ye+=de[ge].rowHeight;ce.allRowsHeight=ye;var me=oe+ye,Ee=ie,Pe=Ee+se;Ee<me&&Pe>oe&&ae.push(be),oe+=ye}return ae}function K(Q,ie,se){var ae=d(ie)[0];if(ae!==void 0){var oe=ae.rowBlocks,be=ae.calcdata,ce=H(oe,oe.length),de=ae.calcdata.groupHeight-N(ae),ye=be.scrollY=Math.max(0,Math.min(ce-de,be.scrollY)),ge=G(oe,ye,de);ge.length===1&&(ge[0]===oe.length-1?ge.unshift(ge[0]-1):ge.push(ge[0]+1)),ge[0]%2&&ge.reverse(),ie.each(function(me,Ee){me.page=ge[Ee],me.scrollY=ye}),ie.attr("transform",function(me){var Ee=H(me.rowBlocks,me.page)-me.scrollY;return t(0,Ee)}),Q&&(Y(Q,se,ie,ge,ae.prevPages,ae,0),Y(Q,se,ie,ge,ae.prevPages,ae,1),o(se,Q))}}function W(Q,ie,se,ae){return function(be){var ce=be.calcdata?be.calcdata:be,de=ie.filter(function(Ee){return ce.key===Ee.key}),ye=se||ce.scrollbarState.dragMultiplier,ge=ce.scrollY;ce.scrollY=ae===void 0?ce.scrollY+ye*g.event.dy:ae;var me=de.selectAll("."+A.cn.yColumn).selectAll("."+A.cn.columnBlock).filter(O);return K(Q,me,de),ce.scrollY===ge}}function Y(Q,ie,se,ae,oe,be,ce){var de=ae[ce]!==oe[ce];de&&(clearTimeout(be.currentRepaint[ce]),be.currentRepaint[ce]=setTimeout(function(){var ye=se.filter(function(ge,me){return me===ce&&ae[me]!==oe[me]});m(Q,ie,ye,se),oe[ce]=ae[ce]}))}function re(Q,ie,se,ae){return function(){var be=g.select(ie.parentNode);be.each(function(ce){var de=ce.fragments;be.selectAll("tspan.line").each(function(ke,Xe){de[Xe].width=this.getComputedTextLength()});var ye=de[de.length-1].width,ge=de.slice(0,-1),me=[],Ee,Pe,Ue=0,we=ce.column.columnWidth-2*A.cellPad;for(ce.value="";ge.length;)Ee=ge.shift(),Pe=Ee.width+ye,Ue+Pe>we&&(ce.value+=me.join(A.wrapSpacer)+A.lineBreaker,me=[],Ue=0),me.push(Ee.text),Ue+=Pe;Ue&&(ce.value+=me.join(A.wrapSpacer)),ce.wrapped=!0}),be.selectAll("tspan.line").remove(),k(be.select("."+A.cn.cellText),se,Q,ae),g.select(ie.parentNode.parentNode).call(q)}}function ue(Q,ie,se,ae,oe){return function(){if(!oe.settledY){var ce=g.select(ie.parentNode),de=ne(oe),ye=oe.key-de.firstRowIndex,ge=de.rows[ye].rowHeight,me=oe.cellHeightMayIncrease?ie.parentNode.getBoundingClientRect().height+2*A.cellPad:ge,Ee=Math.max(me,ge),Pe=Ee-de.rows[ye].rowHeight;Pe&&(de.rows[ye].rowHeight=Ee,Q.selectAll("."+A.cn.columnCell).call(q),K(null,Q.filter(O),0),o(se,ae,!0)),ce.attr("transform",function(){var Ue=this,we=Ue.parentNode,ke=we.getBoundingClientRect(),Xe=g.select(Ue.parentNode).select("."+A.cn.cellRect).node().getBoundingClientRect(),Ve=Ue.transform.baseVal.consolidate(),Ie=Xe.top-ke.top+(Ve?Ve.matrix.f:A.cellPad);return t(j(oe,g.select(Ue.parentNode).select("."+A.cn.cellTextHolder).node().getBoundingClientRect().width),Ie)}),oe.settledY=!0}}}function j(Q,ie){switch(Q.align){case"left":return A.cellPad;case"right":return Q.column.columnWidth-(ie||0)-A.cellPad;case"center":return(Q.column.columnWidth-(ie||0))/2;default:return A.cellPad}}function q(Q){Q.attr("transform",function(ie){var se=ie.rowBlocks[0].auxiliaryBlocks.reduce(function(ce,de){return ce+U(de,1/0)},0),ae=ne(ie),oe=U(ae,ie.key),be=oe+se;return t(0,be)}).selectAll("."+A.cn.cellRect).attr("height",function(ie){return X(ne(ie),ie.key).rowHeight})}function H(Q,ie){for(var se=0,ae=ie-1;ae>=0;ae--)se+=$(Q[ae]);return se}function U(Q,ie){for(var se=0,ae=0;ae<Q.rows.length&&Q.rows[ae].rowIndex<ie;ae++)se+=Q.rows[ae].rowHeight;return se}function $(Q){var ie=Q.allRowsHeight;if(ie!==void 0)return ie;for(var se=0,ae=0;ae<Q.rows.length;ae++)se+=Q.rows[ae].rowHeight;return Q.allRowsHeight=se,se}function ne(Q){return Q.rowBlocks[Q.page]}function X(Q,ie){return Q.rows[ie-Q.firstRowIndex]}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(y,ee,te){var A=y("../../plots/template_attributes").hovertemplateAttrs,g=y("../../plots/template_attributes").texttemplateAttrs,S=y("../../components/colorscale/attributes"),M=y("../../plots/domain").attributes,e=y("../pie/attributes"),a=y("../sunburst/attributes"),n=y("./constants"),r=y("../../lib/extend").extendFlat;ee.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:r({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:a.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:a.marker.line,editType:"calc"},S("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:r({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:a.textinfo,texttemplate:g({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:a.hoverinfo,hovertemplate:A({},{keys:n.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:r({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:a.root,domain:M({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(y,ee,te){var A=y("../../plots/plots");te.name="treemap",te.plot=function(g,S,M,e){A.plotBasePlot(te.name,g,S,M,e)},te.clean=function(g,S,M,e){A.cleanBasePlot(te.name,g,S,M,e)}},{"../../plots/plots":628}],1086:[function(y,ee,te){var A=y("../sunburst/calc");te.calc=function(g,S){return A.calc(g,S)},te.crossTraceCalc=function(g){return A._runCrossTraceCalc("treemap",g)}},{"../sunburst/calc":1060}],1087:[function(y,ee,te){ee.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("../../components/color"),M=y("../../plots/domain").defaults,e=y("../bar/defaults").handleText,a=y("../bar/constants").TEXTPAD,n=y("../../components/colorscale"),r=n.hasColorscale,t=n.handleDefaults;ee.exports=function(s,i,x,p){function v(k,P){return A.coerce(s,i,g,k,P)}var f=v("labels"),d=v("parents");if(!f||!f.length||!d||!d.length){i.visible=!1;return}var o=v("values");o&&o.length?v("branchvalues"):v("count"),v("level"),v("maxdepth");var m=v("tiling.packing");m==="squarify"&&v("tiling.squarifyratio"),v("tiling.flip"),v("tiling.pad");var l=v("text");v("texttemplate"),i.texttemplate||v("textinfo",Array.isArray(l)?"text+label":"label"),v("hovertext"),v("hovertemplate");var w=v("pathbar.visible"),_="auto";e(s,i,p,v,_,{hasPathbar:w,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),v("textposition");var c=i.textposition.indexOf("bottom")!==-1,b=v("marker.line.width");b&&v("marker.line.color",p.paper_bgcolor);var u=v("marker.colors"),L=i._hasColorscale=r(s,"marker","colors")||(s.marker||{}).coloraxis;L?t(s,i,p,v,{prefix:"marker.",cLetter:"c"}):v("marker.depthfade",!(u||[]).length);var T=i.textfont.size*2;v("marker.pad.t",c?T/4:T),v("marker.pad.l",T/4),v("marker.pad.r",T/4),v("marker.pad.b",c?T:T/4),i._hovered={marker:{line:{width:2,color:S.contrast(p.paper_bgcolor)}}},w&&(v("pathbar.thickness",i.pathbar.textfont.size+2*a),v("pathbar.side"),v("pathbar.edgeshape")),v("sort"),v("root.color"),M(i,p,v),i._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../sunburst/helpers"),S=y("../bar/uniform_text"),M=S.clearMinTextSize,e=y("../bar/style").resizeText,a=y("./plot_one");ee.exports=function(r,t,h,s,i){var x=i.type,p=i.drawDescendants,v=r._fullLayout,f=v["_"+x+"layer"],d,o,m=!h;if(M(x,v),d=f.selectAll("g.trace."+x).data(t,function(w){return w[0].trace.uid}),d.enter().append("g").classed("trace",!0).classed(x,!0),d.order(),!v.uniformtext.mode&&g.hasTransition(h)){s&&(o=s());var l=A.transition().duration(h.duration).ease(h.easing).each("end",function(){o&&o()}).each("interrupt",function(){o&&o()});l.each(function(){f.selectAll("g.trace").each(function(w){a(r,w,this,h,p)})})}else d.each(function(w){a(r,w,this,h,p)}),v.uniformtext.mode&&e(r,f.selectAll(".trace"),x);m&&d.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../components/drawing"),M=y("../../lib/svg_text_utils"),e=y("./partition"),a=y("./style").styleOne,n=y("./constants"),r=y("../sunburst/helpers"),t=y("../sunburst/fx"),h=!0;ee.exports=function(i,x,p,v,f){var d=f.barDifY,o=f.width,m=f.height,l=f.viewX,w=f.viewY,_=f.pathSlice,c=f.toMoveInsideSlice,b=f.strTransform,u=f.hasTransition,L=f.handleSlicesExit,T=f.makeUpdateSliceInterpolator,k=f.makeUpdateTextInterpolator,P={},z=i._context.staticPlot,I=i._fullLayout,D=x[0],R=D.trace,O=D.hierarchy,F=o/R._entryDepth,N=r.listPath(p.data,"id"),G=e(O.copy(),[o,m],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();G=G.filter(function(W){var Y=N.indexOf(W.data.id);return Y===-1?!1:(W.x0=F*Y,W.x1=F*(Y+1),W.y0=d,W.y1=d+m,W.onPathbar=!0,!0)}),G.reverse(),v=v.data(G,r.getPtId),v.enter().append("g").classed("pathbar",!0),L(v,h,P,[o,m],_),v.order();var K=v;u&&(K=K.transition().each("end",function(){var W=A.select(this);r.setSliceCursor(W,i,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),K.each(function(W){W._x0=l(W.x0),W._x1=l(W.x1),W._y0=w(W.y0),W._y1=w(W.y1),W._hoverX=l(W.x1-Math.min(o,m)/2),W._hoverY=w(W.y1-m/2);var Y=A.select(this),re=g.ensureSingle(Y,"path","surface",function(H){H.style("pointer-events",z?"none":"all")});u?re.transition().attrTween("d",function(H){var U=T(H,h,P,[o,m]);return function($){return _(U($))}}):re.attr("d",_),Y.call(t,p,i,x,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,i,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:i._transitioning}),re.call(a,W,R,{hovered:!1}),W._text=(r.getPtLabel(W)||"").split("<br>").join(" ")||"";var ue=g.ensureSingle(Y,"g","slicetext"),j=g.ensureSingle(ue,"text","",function(H){H.attr("data-notex",1)}),q=g.ensureUniformFontSize(i,r.determineTextFont(R,W,I.font,{onPathbar:!0}));j.text(W._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(S.font,q).call(M.convertToTspans,i),W.textBB=S.bBox(j.node()),W.transform=c(W,{fontSize:q.size,onPathbar:!0}),W.transform.fontSize=q.size,u?j.transition().attrTween("transform",function(H){var U=k(H,h,P,[o,m]);return function($){return b(U($))}}):j.attr("transform",b(W))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../components/drawing"),M=y("../../lib/svg_text_utils"),e=y("./partition"),a=y("./style").styleOne,n=y("./constants"),r=y("../sunburst/helpers"),t=y("../sunburst/fx"),h=y("../sunburst/plot").formatSliceLabel,s=!1;ee.exports=function(x,p,v,f,d){var o=d.width,m=d.height,l=d.viewX,w=d.viewY,_=d.pathSlice,c=d.toMoveInsideSlice,b=d.strTransform,u=d.hasTransition,L=d.handleSlicesExit,T=d.makeUpdateSliceInterpolator,k=d.makeUpdateTextInterpolator,P=d.prevEntry,z={},I=x._context.staticPlot,D=x._fullLayout,R=p[0],O=R.trace,F=O.textposition.indexOf("left")!==-1,N=O.textposition.indexOf("right")!==-1,G=O.textposition.indexOf("bottom")!==-1,K=!G&&!O.marker.pad.t||G&&!O.marker.pad.b,W=e(v,[o,m],{packing:O.tiling.packing,squarifyratio:O.tiling.squarifyratio,flipX:O.tiling.flip.indexOf("x")>-1,flipY:O.tiling.flip.indexOf("y")>-1,pad:{inner:O.tiling.pad,top:O.marker.pad.t,left:O.marker.pad.l,right:O.marker.pad.r,bottom:O.marker.pad.b}}),Y=W.descendants(),re=1/0,ue=-1/0;Y.forEach(function($){var ne=$.depth;ne>=O._maxDepth?($.x0=$.x1=($.x0+$.x1)/2,$.y0=$.y1=($.y0+$.y1)/2):(re=Math.min(re,ne),ue=Math.max(ue,ne))}),f=f.data(Y,r.getPtId),O._maxVisibleLayers=isFinite(ue)?ue-re+1:0,f.enter().append("g").classed("slice",!0),L(f,s,z,[o,m],_),f.order();var j=null;if(u&&P){var q=r.getPtId(P);f.each(function($){j===null&&r.getPtId($)===q&&(j={x0:$.x0,x1:$.x1,y0:$.y0,y1:$.y1})})}var H=function(){return j||{x0:0,x1:o,y0:0,y1:m}},U=f;return u&&(U=U.transition().each("end",function(){var $=A.select(this);r.setSliceCursor($,x,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),U.each(function($){var ne=r.isHeader($,O);$._x0=l($.x0),$._x1=l($.x1),$._y0=w($.y0),$._y1=w($.y1),$._hoverX=l($.x1-O.marker.pad.r),$._hoverY=w(G?$.y1-O.marker.pad.b/2:$.y0+O.marker.pad.t/2);var X=A.select(this),Q=g.ensureSingle(X,"path","surface",function(oe){oe.style("pointer-events",I?"none":"all")});u?Q.transition().attrTween("d",function(oe){var be=T(oe,s,H(),[o,m]);return function(ce){return _(be(ce))}}):Q.attr("d",_),X.call(t,v,x,p,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,x,{isTransitioning:x._transitioning}),Q.call(a,$,O,{hovered:!1}),$.x0===$.x1||$.y0===$.y1?$._text="":ne?$._text=K?"":r.getPtLabel($)||"":$._text=h($,v,O,p,D)||"";var ie=g.ensureSingle(X,"g","slicetext"),se=g.ensureSingle(ie,"text","",function(oe){oe.attr("data-notex",1)}),ae=g.ensureUniformFontSize(x,r.determineTextFont(O,$,D.font));se.text($._text||" ").classed("slicetext",!0).attr("text-anchor",N?"end":F||ne?"start":"middle").call(S.font,ae).call(M.convertToTspans,x),$.textBB=S.bBox(se.node()),$.transform=c($,{fontSize:ae.size,isHeader:ne}),$.transform.fontSize=ae.size,u?se.transition().attrTween("transform",function(oe){var be=k(oe,s,H(),[o,m]);return function(ce){return b(be(ce))}}):se.attr("transform",b($))}),j}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(y,ee,te){ee.exports=function A(g,S,M){var e;M.swapXY&&(e=g.x0,g.x0=g.y0,g.y0=e,e=g.x1,g.x1=g.y1,g.y1=e),M.flipX&&(e=g.x0,g.x0=S[0]-g.x1,g.x1=S[0]-e),M.flipY&&(e=g.y0,g.y0=S[1]-g.y1,g.y1=S[1]-e);var a=g.children;if(a)for(var n=0;n<a.length;n++)A(a[n],S,M)}},{}],1093:[function(y,ee,te){ee.exports={moduleType:"trace",name:"treemap",basePlotModule:y("./base_plot"),categories:[],animatable:!0,attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc").calc,crossTraceCalc:y("./calc").crossTraceCalc,plot:y("./plot"),style:y("./style").style,colorbar:y("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(y,ee,te){ee.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(M,e){function a(n,r){return A.coerce(M,e,g,n,r)}a("treemapcolorway",e.colorway),a("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(y,ee,te){var A=y("d3-hierarchy"),g=y("./flip_tree");ee.exports=function(e,a,n){var r=n.flipX,t=n.flipY,h=n.packing==="dice-slice",s=n.pad[t?"bottom":"top"],i=n.pad[r?"right":"left"],x=n.pad[r?"left":"right"],p=n.pad[t?"top":"bottom"],v;h&&(v=i,i=s,s=v,v=x,x=p,p=v);var f=A.treemap().tile(S(n.packing,n.squarifyratio)).paddingInner(n.pad.inner).paddingLeft(i).paddingRight(x).paddingTop(s).paddingBottom(p).size(h?[a[1],a[0]]:a)(e);return(h||r||t)&&g(f,a,{swapXY:h,flipX:r,flipY:t}),f};function S(M,e){switch(M){case"squarify":return A.treemapSquarify.ratio(e);case"binary":return A.treemapBinary;case"dice":return A.treemapDice;case"slice":return A.treemapSlice;default:return A.treemapSliceDice}}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(y,ee,te){var A=y("./draw"),g=y("./draw_descendants");ee.exports=function(M,e,a,n){return A(M,e,a,n,{type:"treemap",drawDescendants:g})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(y,ee,te){var A=y("@plotly/d3"),g=y("d3-interpolate").interpolate,S=y("../sunburst/helpers"),M=y("../../lib"),e=y("../bar/constants").TEXTPAD,a=y("../bar/plot"),n=a.toMoveInsideBar,r=y("../bar/uniform_text"),t=r.recordMinTextSize,h=y("./constants"),s=y("./draw_ancestors");function i(x){return S.isHierarchyRoot(x)?"":S.getPtId(x)}ee.exports=function(p,v,f,d,o){var m=p._fullLayout,l=v[0],w=l.trace,_=w.type,c=_==="icicle",b=l.hierarchy,u=S.findEntryWithLevel(b,w.level),L=A.select(f),T=L.selectAll("g.pathbar"),k=L.selectAll("g.slice");if(!u){T.remove(),k.remove();return}var P=S.isHierarchyRoot(u),z=!m.uniformtext.mode&&S.hasTransition(d),I=S.getMaxDepth(w),D=function(Ye){return Ye.data.depth-u.data.depth<I},R=m._size,O=w.domain,F=R.w*(O.x[1]-O.x[0]),N=R.h*(O.y[1]-O.y[0]),G=F,K=w.pathbar.thickness,W=w.marker.line.width+h.gapWithPathbar,Y=w.pathbar.visible?w.pathbar.side.indexOf("bottom")>-1?N+W:-(K+W):0,re={x0:G,x1:G,y0:Y,y1:Y+K},ue=function(Ye,vt,Dt){var Kt=w.tiling.pad,Ft=function(At){return At-Kt<=vt.x0},Mt=function(At){return At+Kt>=vt.x1},Xt=function(At){return At-Kt<=vt.y0},It=function(At){return At+Kt>=vt.y1};return Ye.x0===vt.x0&&Ye.x1===vt.x1&&Ye.y0===vt.y0&&Ye.y1===vt.y1?{x0:Ye.x0,x1:Ye.x1,y0:Ye.y0,y1:Ye.y1}:{x0:Ft(Ye.x0-Kt)?0:Mt(Ye.x0-Kt)?Dt[0]:Ye.x0,x1:Ft(Ye.x1+Kt)?0:Mt(Ye.x1+Kt)?Dt[0]:Ye.x1,y0:Xt(Ye.y0-Kt)?0:It(Ye.y0-Kt)?Dt[1]:Ye.y0,y1:Xt(Ye.y1+Kt)?0:It(Ye.y1+Kt)?Dt[1]:Ye.y1}},j=null,q={},H={},U=null,$=function(Ye,vt){return vt?q[i(Ye)]:H[i(Ye)]},ne=function(Ye,vt,Dt,Kt){if(vt)return q[i(b)]||re;var Ft=H[w.level]||Dt;return D(Ye)?ue(Ye,Ft,Kt):{}};l.hasMultipleRoots&&P&&I++,w._maxDepth=I,w._backgroundColor=m.paper_bgcolor,w._entryDepth=u.data.depth,w._atRootLevel=P;var X=-F/2+R.l+R.w*(O.x[1]+O.x[0])/2,Q=-N/2+R.t+R.h*(1-(O.y[1]+O.y[0])/2),ie=function(Ye){return X+Ye},se=function(Ye){return Q+Ye},ae=se(0),oe=ie(0),be=function(Ye){return oe+Ye},ce=function(Ye){return ae+Ye};function de(Ye,vt){return Ye+","+vt}var ye=be(0),ge=function(Ye){Ye.x=Math.max(ye,Ye.x)},me=w.pathbar.edgeshape,Ee=function(Ye){var vt=be(Math.max(Math.min(Ye.x0,Ye.x0),0)),Dt=be(Math.min(Math.max(Ye.x1,Ye.x1),G)),Kt=ce(Ye.y0),Ft=ce(Ye.y1),Mt=K/2,Xt={},It={};Xt.x=vt,It.x=Dt,Xt.y=It.y=(Kt+Ft)/2;var At={x:vt,y:Kt},Ge={x:Dt,y:Kt},tt={x:Dt,y:Ft},He={x:vt,y:Ft};return me===">"?(At.x-=Mt,Ge.x-=Mt,tt.x-=Mt,He.x-=Mt):me==="/"?(tt.x-=Mt,He.x-=Mt,Xt.x-=Mt/2,It.x-=Mt/2):me==="\\"?(At.x-=Mt,Ge.x-=Mt,Xt.x-=Mt/2,It.x-=Mt/2):me==="<"&&(Xt.x-=Mt,It.x-=Mt),ge(At),ge(He),ge(Xt),ge(Ge),ge(tt),ge(It),"M"+de(At.x,At.y)+"L"+de(Ge.x,Ge.y)+"L"+de(It.x,It.y)+"L"+de(tt.x,tt.y)+"L"+de(He.x,He.y)+"L"+de(Xt.x,Xt.y)+"Z"},Pe=function(Ye){var vt=ie(Ye.x0),Dt=ie(Ye.x1),Kt=se(Ye.y0),Ft=se(Ye.y1),Mt=Dt-vt,Xt=Ft-Kt;if(!Mt||!Xt)return"";var It=0,At=Mt>2*It&&Xt>2*It?It:0,Ge=function(tt,He){return At?"a"+de(At,At)+" 0 0 1 "+de(tt,He):""};return"M"+de(vt,Kt+At)+Ge(At,-At)+"L"+de(Dt-At,Kt)+Ge(At,At)+"L"+de(Dt,Ft-At)+Ge(-At,At)+"L"+de(vt+At,Ft)+Ge(-At,-At)+"Z"},Ue=function(Ye,vt){var Dt=Ye.x0,Kt=Ye.x1,Ft=Ye.y0,Mt=Ye.y1,Xt=Ye.textBB,It=function(wt){return w.textposition.indexOf(wt)!==-1},At=It("bottom"),Ge=It("top")||vt.isHeader&&!At,tt=Ge?"start":At?"end":"middle",He=It("right"),Ae=It("left")||vt.onPathbar,Ne=Ae?-1:He?1:0,Ze=w[c?"tiling":"marker"].pad;if(vt.isHeader){if(Dt+=(c?Ze:Ze.l)-e,Kt-=(c?Ze:Ze.r)-e,Dt>=Kt){var Qe=(Dt+Kt)/2;Dt=Qe,Kt=Qe}var bt;At?(bt=Mt-(c?Ze:Ze.b),Ft<bt&&bt<Mt&&(Ft=bt)):(bt=Ft+(c?Ze:Ze.t),Ft<bt&&bt<Mt&&(Mt=bt))}var dt=n(Dt,Kt,Ft,Mt,Xt,{isHorizontal:!1,constrained:!0,angle:0,anchor:tt,leftToRight:Ne});return dt.fontSize=vt.fontSize,dt.targetX=ie(dt.targetX),dt.targetY=se(dt.targetY),isNaN(dt.targetX)||isNaN(dt.targetY)?{}:(Dt!==Kt&&Ft!==Mt&&t(w.type,dt,m),{scale:dt.scale,rotate:dt.rotate,textX:dt.textX,textY:dt.textY,anchorX:dt.anchorX,anchorY:dt.anchorY,targetX:dt.targetX,targetY:dt.targetY})},we=function(Ye,vt){for(var Dt,Kt=0,Ft=Ye;!Dt&&Kt<I;)Kt++,Ft=Ft.parent,Ft?Dt=$(Ft,vt):Kt=I;return Dt||{}},ke=function(Ye,vt,Dt,Kt){var Ft=$(Ye,vt),Mt;if(vt)Mt=re;else{var Xt=$(u,vt);Xt?Mt=ue(Ye,Xt,Kt):Mt={}}return g(Ft,Mt)},Xe=function(Ye,vt,Dt,Kt,Ft){var Mt=$(Ye,vt),Xt;if(Mt)Xt=Mt;else if(vt)Xt=re;else if(j)if(Ye.parent){var It=U||Dt;It&&!vt?Xt=ue(Ye,It,Kt):(Xt={},M.extendFlat(Xt,we(Ye,vt)))}else Xt=M.extendFlat({},Ye),c&&(Ft.orientation==="h"?Ft.flipX?Xt.x0=Ye.x1:Xt.x1=0:Ft.flipY?Xt.y0=Ye.y1:Xt.y1=0);else Xt={};return g(Xt,{x0:Ye.x0,x1:Ye.x1,y0:Ye.y0,y1:Ye.y1})},Ve=function(Ye,vt,Dt,Kt){var Ft=$(Ye,vt),Mt={},Xt=ne(Ye,vt,Dt,Kt);M.extendFlat(Mt,{transform:Ue({x0:Xt.x0,x1:Xt.x1,y0:Xt.y0,y1:Xt.y1,textBB:Ye.textBB,_text:Ye._text},{isHeader:S.isHeader(Ye,w)})}),Ft?Mt=Ft:Ye.parent&&M.extendFlat(Mt,we(Ye,vt));var It=Ye.transform;return Ye.x0!==Ye.x1&&Ye.y0!==Ye.y1&&t(w.type,It,m),g(Mt,{transform:{scale:It.scale,rotate:It.rotate,textX:It.textX,textY:It.textY,anchorX:It.anchorX,anchorY:It.anchorY,targetX:It.targetX,targetY:It.targetY}})},Ie=function(Ye,vt,Dt,Kt,Ft){var Mt=Kt[0],Xt=Kt[1];z?Ye.exit().transition().each(function(){var It=A.select(this),At=It.select("path.surface");At.transition().attrTween("d",function(tt){var He=ke(tt,vt,Dt,[Mt,Xt]);return function(Ae){return Ft(He(Ae))}});var Ge=It.select("g.slicetext");Ge.attr("opacity",0)}).remove():Ye.exit().remove()},De=function(Ye){var vt=Ye.transform;return Ye.x0!==Ye.x1&&Ye.y0!==Ye.y1&&t(w.type,vt,m),M.getTextTransform({textX:vt.textX,textY:vt.textY,anchorX:vt.anchorX,anchorY:vt.anchorY,targetX:vt.targetX,targetY:vt.targetY,scale:vt.scale,rotate:vt.rotate})};z&&(T.each(function(Ye){q[i(Ye)]={x0:Ye.x0,x1:Ye.x1,y0:Ye.y0,y1:Ye.y1},Ye.transform&&(q[i(Ye)].transform={textX:Ye.transform.textX,textY:Ye.transform.textY,anchorX:Ye.transform.anchorX,anchorY:Ye.transform.anchorY,targetX:Ye.transform.targetX,targetY:Ye.transform.targetY,scale:Ye.transform.scale,rotate:Ye.transform.rotate})}),k.each(function(Ye){H[i(Ye)]={x0:Ye.x0,x1:Ye.x1,y0:Ye.y0,y1:Ye.y1},Ye.transform&&(H[i(Ye)].transform={textX:Ye.transform.textX,textY:Ye.transform.textY,anchorX:Ye.transform.anchorX,anchorY:Ye.transform.anchorY,targetX:Ye.transform.targetX,targetY:Ye.transform.targetY,scale:Ye.transform.scale,rotate:Ye.transform.rotate}),!j&&S.isEntry(Ye)&&(j=Ye)})),U=o(p,v,u,k,{width:F,height:N,viewX:ie,viewY:se,pathSlice:Pe,toMoveInsideSlice:Ue,prevEntry:j,makeUpdateSliceInterpolator:Xe,makeUpdateTextInterpolator:Ve,handleSlicesExit:Ie,hasTransition:z,strTransform:De}),w.pathbar.visible?s(p,v,u,T,{barDifY:Y,width:G,height:K,viewX:be,viewY:ce,pathSlice:Ee,toMoveInsideSlice:Ue,makeUpdateSliceInterpolator:Xe,makeUpdateTextInterpolator:Ve,handleSlicesExit:Ie,hasTransition:z,strTransform:De}):T.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/color"),S=y("../../lib"),M=y("../sunburst/helpers"),e=y("../bar/uniform_text").resizeText;function a(r){var t=r._fullLayout._treemaplayer.selectAll(".trace");e(r,t,"treemap"),t.each(function(h){var s=A.select(this),i=h[0],x=i.trace;s.style("opacity",x.opacity),s.selectAll("path.surface").each(function(p){A.select(this).call(n,p,x,{hovered:!1})})})}function n(r,t,h,s){var i=(s||{}).hovered,x=t.data.data,p=x.i,v,f,d=x.color,o=M.isHierarchyRoot(t),m=1;if(i)v=h._hovered.marker.line.color,f=h._hovered.marker.line.width;else if(o&&d===h.root.color)m=100,v="rgba(0,0,0,0)",f=0;else if(v=S.castOption(h,p,"marker.line.color")||g.defaultLine,f=S.castOption(h,p,"marker.line.width")||0,!h._hasColorscale&&!t.onPathbar){var l=h.marker.depthfade;if(l){var w=g.combine(g.addOpacity(h._backgroundColor,.75),d),_;if(l===!0){var c=M.getMaxDepth(h);isFinite(c)?M.isLeaf(t)?_=0:_=h._maxVisibleLayers-(t.data.depth-h._entryDepth):_=t.data.height+1}else _=t.data.depth-h._entryDepth,h._atRootLevel||_++;if(_>0)for(var b=0;b<_;b++){var u=.5*b/_;d=g.combine(g.addOpacity(w,u),d)}}}r.style("stroke-width",f).call(g.fill,d).call(g.stroke,v).style("opacity",m)}ee.exports={style:a,styleOne:n}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(y,ee,te){var A=y("../box/attributes"),g=y("../../lib/extend").extendFlat,S=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat;ee.exports={y:A.y,x:A.x,x0:A.x0,y0:A.y0,xhoverformat:S("x"),yhoverformat:S("y"),name:g({},A.name,{}),orientation:g({},A.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:A.fillcolor,points:g({},A.boxpoints,{}),jitter:g({},A.jitter,{}),pointpos:g({},A.pointpos,{}),width:g({},A.width,{}),marker:A.marker,text:A.text,hovertext:A.hovertext,hovertemplate:A.hovertemplate,quartilemethod:A.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:A.offsetgroup,alignmentgroup:A.alignmentgroup,selected:A.selected,unselected:A.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(y,ee,te){var A=y("../../lib"),g=y("../../plots/cartesian/axes"),S=y("../box/calc"),M=y("./helpers"),e=y("../../constants/numerical").BADNUM;ee.exports=function(h,s){var i=S(h,s);if(i[0].t.empty)return i;for(var x=h._fullLayout,p=g.getFromId(h,s[s.orientation==="h"?"xaxis":"yaxis"]),v=1/0,f=-1/0,d=0,o=0,m=0;m<i.length;m++){var l=i[m],w=l.pts.map(M.extractVal),_=l.bandwidth=n(s,l,w),c=l.span=r(s,l,p,_);if(l.min===l.max&&_===0)c=l.span=[l.min,l.max],l.density=[{v:1,t:c[0]}],l.bandwidth=_,d=Math.max(d,1);else{var b=c[1]-c[0],u=Math.ceil(b/(_/3)),L=b/u;if(!isFinite(L)||!isFinite(u))return A.error("Something went wrong with computing the violin span"),i[0].t.empty=!0,i;var T=M.makeKDE(l,s,w);l.density=new Array(u);for(var k=0,P=c[0];P<c[1]+L/2;k++,P+=L){var z=T(P);l.density[k]={v:z,t:P},d=Math.max(d,z)}}o=Math.max(o,w.length),v=Math.min(v,c[0]),f=Math.max(f,c[1])}var I=g.findExtremes(p,[v,f],{padded:!0});if(s._extremes[p._id]=I,s.width)i[0].t.maxKDE=d;else{var D=x._violinScaleGroupStats,R=s.scalegroup,O=D[R];O?(O.maxKDE=Math.max(O.maxKDE,d),O.maxCount=Math.max(O.maxCount,o)):D[R]={maxKDE:d,maxCount:o}}return i[0].t.labels.kde=A._(h,"kde:"),i};function a(t,h,s){var i=Math.min(h,s/1.349);return 1.059*i*Math.pow(t,-.2)}function n(t,h,s){var i=h.max-h.min;if(!i)return t.bandwidth?t.bandwidth:0;if(t.bandwidth)return Math.max(t.bandwidth,i/1e4);var x=s.length,p=A.stdev(s,x-1,h.mean);return Math.max(a(x,p,h.q3-h.q1),i/100)}function r(t,h,s,i){var x=t.spanmode,p=t.span||[],v=[h.min,h.max],f=[h.min-2*i,h.max+2*i],d;function o(l){var w=p[l],_=s.type==="multicategory"?s.r2c(w):s.d2c(w,0,t[h.valLetter+"calendar"]);return _===e?f[l]:_}x==="soft"?d=f:x==="hard"?d=v:d=[o(0),o(1)];var m={type:"linear",range:d};return g.setConvert(m),m.cleanRange(),d}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(y,ee,te){var A=y("../box/cross_trace_calc").setPositionOffset,g=["v","h"];ee.exports=function(M,e){for(var a=M.calcdata,n=e.xaxis,r=e.yaxis,t=0;t<g.length;t++){for(var h=g[t],s=h==="h"?r:n,i=[],x=0;x<a.length;x++){var p=a[x],v=p[0].t,f=p[0].trace;f.visible===!0&&f.type==="violin"&&!v.empty&&f.orientation===h&&f.xaxis===n._id&&f.yaxis===r._id&&i.push(x)}A("violin",M,i,s)}}},{"../box/cross_trace_calc":684}],1103:[function(y,ee,te){var A=y("../../lib"),g=y("../../components/color"),S=y("../box/defaults"),M=y("./attributes");ee.exports=function(a,n,r,t){function h(L,T){return A.coerce(a,n,M,L,T)}function s(L,T){return A.coerce2(a,n,M,L,T)}if(S.handleSampleDefaults(a,n,h,t),n.visible!==!1){h("bandwidth"),h("side");var i=h("width");i||(h("scalegroup",n.name),h("scalemode"));var x=h("span"),p;Array.isArray(x)&&(p="manual"),h("spanmode",p);var v=h("line.color",(a.marker||{}).color||r),f=h("line.width"),d=h("fillcolor",g.addOpacity(n.line.color,.5));S.handlePointsDefaults(a,n,h,{prefix:""});var o=s("box.width"),m=s("box.fillcolor",d),l=s("box.line.color",v),w=s("box.line.width",f),_=h("box.visible",!!(o||m||l||w));_||(n.box={visible:!1});var c=s("meanline.color",v),b=s("meanline.width",f),u=h("meanline.visible",!!(c||b));u||(n.meanline={visible:!1}),h("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(y,ee,te){var A=y("../../lib"),g={gaussian:function(S){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*S*S)}};te.makeKDE=function(S,M,e){var a=e.length,n=g.gaussian,r=S.bandwidth,t=1/(a*r);return function(h){for(var s=0,i=0;i<a;i++)s+=n((h-e[i])/r);return t*s}},te.getPositionOnKdePath=function(S,M,e){var a,n;M.orientation==="h"?(a="y",n="x"):(a="x",n="y");var r=A.findPointOnPath(S.path,e,n,{pathLength:S.pathLength}),t=S.posCenterPx,h=r[a],s=M.side==="both"?2*t-h:t;return[h,s]},te.getKdeValue=function(S,M,e){var a=S.pts.map(te.extractVal),n=te.makeKDE(S,M,a);return n(e)/S.posDensityScale},te.extractVal=function(S){return S.v}},{"../../lib":515}],1105:[function(y,ee,te){var A=y("../../components/color"),g=y("../../lib"),S=y("../../plots/cartesian/axes"),M=y("../box/hover"),e=y("./helpers");ee.exports=function(n,r,t,h,s){s||(s={});var i=s.hoverLayer,x=n.cd,p=x[0].trace,v=p.hoveron,f=v.indexOf("violins")!==-1,d=v.indexOf("kde")!==-1,o=[],m,l;if(f||d){var w=M.hoverOnBoxes(n,r,t,h);if(d&&w.length>0){var _=n.xa,c=n.ya,b,u,L,T,k;p.orientation==="h"?(k=r,b="y",L=c,u="x",T=_):(k=t,b="x",L=_,u="y",T=c);var P=x[n.index];if(k>=P.span[0]&&k<=P.span[1]){var z=g.extendFlat({},n),I=T.c2p(k,!0),D=e.getKdeValue(P,p,k),R=e.getPositionOnKdePath(P,p,I),O=L._offset,F=L._length;z[b+"0"]=R[0],z[b+"1"]=R[1],z[u+"0"]=z[u+"1"]=I,z[u+"Label"]=u+": "+S.hoverLabelText(T,k,p[u+"hoverformat"])+", "+x[0].t.labels.kde+" "+D.toFixed(3);for(var N=0,G=0;G<w.length;G++)if(w[G].attr==="med"){N=G;break}z.spikeDistance=w[N].spikeDistance;var K=b+"Spike";z[K]=w[N][K],w[N].spikeDistance=void 0,w[N][K]=void 0,z.hovertemplate=!1,o.push(z),l={},l[b+"1"]=g.constrain(O+R[0],O,O+F),l[b+"2"]=g.constrain(O+R[1],O,O+F),l[u+"1"]=l[u+"2"]=T._offset+I}}f&&(o=o.concat(w))}v.indexOf("points")!==-1&&(m=M.hoverOnPoints(n,r,t));var W=i.selectAll(".violinline-"+p.uid).data(l?[0]:[]);return W.enter().append("line").classed("violinline-"+p.uid,!0).attr("stroke-width",1.5),W.exit().remove(),W.attr(l).call(A.stroke,n.color),h==="closest"?m?[m]:o:(m&&o.push(m),o)}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(y,ee,te){ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults"),crossTraceDefaults:y("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc"),plot:y("./plot"),style:y("./style"),styleOnSelect:y("../scatter/style").styleOnSelect,hoverPoints:y("./hover"),selectPoints:y("../box/select"),moduleType:"trace",name:"violin",basePlotModule:y("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(y,ee,te){var A=y("../box/layout_attributes"),g=y("../../lib").extendFlat;ee.exports={violinmode:g({},A.boxmode,{}),violingap:g({},A.boxgap,{}),violingroupgap:g({},A.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes"),S=y("../box/layout_defaults");ee.exports=function(e,a,n){function r(t,h){return A.coerce(e,a,g,t,h)}S._supply(e,a,n,r,"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../components/drawing"),M=y("../box/plot"),e=y("../scatter/line_points"),a=y("./helpers");ee.exports=function(r,t,h,s){var i=r._fullLayout,x=t.xaxis,p=t.yaxis;function v(f,d){var o=e(f,{xaxis:x,yaxis:p,trace:d,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return S.smoothopen(o[0],1)}g.makeTraceGroups(s,h,"trace violins").each(function(f){var d=A.select(this),o=f[0],m=o.t,l=o.trace;if(l.visible!==!0||m.empty){d.remove();return}var w=m.bPos,_=m.bdPos,c=t[m.valLetter+"axis"],b=t[m.posLetter+"axis"],u=l.side==="both",L=u||l.side==="positive",T=u||l.side==="negative",k=d.selectAll("path.violin").data(g.identity);k.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),k.exit().remove(),k.each(function(N){var G=A.select(this),K=N.density,W=K.length,Y=b.c2l(N.pos+w,!0),re=b.l2p(Y),ue;if(l.width)ue=m.maxKDE/_;else{var j=i._violinScaleGroupStats[l.scalegroup];ue=l.scalemode==="count"?j.maxKDE/_*(j.maxCount/N.pts.length):j.maxKDE/_}var q,H,U,$,ne,X,Q;if(L){for(X=new Array(W),$=0;$<W;$++)Q=X[$]={},Q[m.posLetter]=Y+K[$].v/ue,Q[m.valLetter]=c.c2l(K[$].t,!0);q=v(X,l)}if(T){for(X=new Array(W),ne=0,$=W-1;ne<W;ne++,$--)Q=X[ne]={},Q[m.posLetter]=Y-K[$].v/ue,Q[m.valLetter]=c.c2l(K[$].t,!0);H=v(X,l)}if(u)U=q+"L"+H.substr(1)+"Z";else{var ie=[re,c.c2p(K[0].t)],se=[re,c.c2p(K[W-1].t)];l.orientation==="h"&&(ie.reverse(),se.reverse()),L?U="M"+ie+"L"+q.substr(1)+"L"+se:U="M"+se+"L"+H.substr(1)+"L"+ie}G.attr("d",U),N.posCenterPx=re,N.posDensityScale=ue*_,N.path=G.node(),N.pathLength=N.path.getTotalLength()/(u?2:1)});var P=l.box,z=P.width,I=(P.line||{}).width,D,R;u?(D=_*z,R=0):L?(D=[0,_*z/2],R=I*{x:1,y:-1}[m.posLetter]):(D=[_*z/2,0],R=I*{x:-1,y:1}[m.posLetter]),M.plotBoxAndWhiskers(d,{pos:b,val:c},l,{bPos:w,bdPos:D,bPosPxOffset:R}),M.plotBoxMean(d,{pos:b,val:c},l,{bPos:w,bdPos:D,bPosPxOffset:R});var O;!l.box.visible&&l.meanline.visible&&(O=g.identity);var F=d.selectAll("path.meanline").data(O||[]);F.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),F.exit().remove(),F.each(function(N){var G=c.c2p(N.mean,!0),K=a.getPositionOnKdePath(N,l,G);A.select(this).attr("d",l.orientation==="h"?"M"+G+","+K[0]+"V"+K[1]:"M"+K[0]+","+G+"H"+K[1])}),M.plotPoints(d,{x,y:p},l,m)})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/color"),S=y("../scatter/style").stylePoints;ee.exports=function(e){var a=A.select(e).selectAll("g.trace.violins");a.style("opacity",function(n){return n[0].trace.opacity}),a.each(function(n){var r=n[0].trace,t=A.select(this),h=r.box||{},s=h.line||{},i=r.meanline||{},x=i.width;t.selectAll("path.violin").style("stroke-width",r.line.width+"px").call(g.stroke,r.line.color).call(g.fill,r.fillcolor),t.selectAll("path.box").style("stroke-width",s.width+"px").call(g.stroke,s.color).call(g.fill,h.fillcolor);var p={"stroke-width":x+"px","stroke-dasharray":2*x+"px,"+x+"px"};t.selectAll("path.mean").style(p).call(g.stroke,i.color),t.selectAll("path.meanline").style(p).call(g.stroke,i.color),S(t,r,e)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(y,ee,te){var A=y("../../components/colorscale/attributes"),g=y("../isosurface/attributes"),S=y("../surface/attributes"),M=y("../../plots/attributes"),e=y("../../lib/extend").extendFlat,a=y("../../plot_api/edit_types").overrideAll,n=ee.exports=a(e({x:g.x,y:g.y,z:g.z,value:g.value,isomin:g.isomin,isomax:g.isomax,surface:g.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:g.slices,caps:g.caps,text:g.text,hovertext:g.hovertext,xhoverformat:g.xhoverformat,yhoverformat:g.yhoverformat,zhoverformat:g.zhoverformat,valuehoverformat:g.valuehoverformat,hovertemplate:g.hovertemplate},A("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:g.colorbar,opacity:g.opacity,opacityscale:S.opacityscale,lightposition:g.lightposition,lighting:g.lighting,flatshading:g.flatshading,contour:g.contour,hoverinfo:e({},M.hoverinfo),showlegend:e({},M.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType=n.value.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(y,ee,te){var A=y("../../../stackgl_modules").gl_mesh3d,g=y("../../lib/gl_format_color").parseColorScale,S=y("../../lib/str2rgbarray"),M=y("../../components/colorscale").extractOpts,e=y("../../plots/gl3d/zip3"),a=y("../isosurface/convert").findNearestOnAxis,n=y("../isosurface/convert").generateIsoMeshes;function r(s,i,x){this.scene=s,this.uid=x,this.mesh=i,this.name="",this.data=null,this.showContour=!1}var t=r.prototype;t.handlePick=function(s){if(s.object===this.mesh){var i=s.data.index,x=this.data._meshX[i],p=this.data._meshY[i],v=this.data._meshZ[i],f=this.data._Ys.length,d=this.data._Zs.length,o=a(x,this.data._Xs).id,m=a(p,this.data._Ys).id,l=a(v,this.data._Zs).id,w=s.index=l+d*m+d*f*o;s.traceCoordinate=[this.data._meshX[w],this.data._meshY[w],this.data._meshZ[w],this.data._value[w]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[w]!==void 0?s.textLabel=_[w]:_&&(s.textLabel=_),!0}},t.update=function(s){var i=this.scene,x=i.fullSceneLayout;this.data=n(s);function p(m,l,w,_){return l.map(function(c){return m.d2l(c,0,_)*w})}var v=e(p(x.xaxis,s._meshX,i.dataScale[0],s.xcalendar),p(x.yaxis,s._meshY,i.dataScale[1],s.ycalendar),p(x.zaxis,s._meshZ,i.dataScale[2],s.zcalendar)),f=e(s._meshI,s._meshJ,s._meshK),d={positions:v,cells:f,lightPosition:[s.lightposition.x,s.lightposition.y,s.lightposition.z],ambient:s.lighting.ambient,diffuse:s.lighting.diffuse,specular:s.lighting.specular,roughness:s.lighting.roughness,fresnel:s.lighting.fresnel,vertexNormalsEpsilon:s.lighting.vertexnormalsepsilon,faceNormalsEpsilon:s.lighting.facenormalsepsilon,opacity:s.opacity,opacityscale:s.opacityscale,contourEnable:s.contour.show,contourColor:S(s.contour.color).slice(0,3),contourWidth:s.contour.width,useFacetNormals:s.flatshading},o=M(s);d.vertexIntensity=s._meshIntensity,d.vertexIntensityBounds=[o.min,o.max],d.colormap=g(s),this.mesh.update(d)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function h(s,i){var x=s.glplot.gl,p=A({gl:x}),v=new r(s,p,i.uid);return p._trace=v,v.update(i),s.glplot.add(p),v}ee.exports=h},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(y,ee,te){var A=y("../../lib"),g=y("./attributes"),S=y("../isosurface/defaults").supplyIsoDefaults,M=y("../surface/defaults").opacityscaleDefaults;ee.exports=function(a,n,r,t){function h(s,i){return A.coerce(a,n,g,s,i)}S(a,n,r,t,h),M(a,n,t,h)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(y,ee,te){ee.exports={attributes:y("./attributes"),supplyDefaults:y("./defaults"),calc:y("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:y("./convert"),moduleType:"trace",name:"volume",basePlotModule:y("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(y,ee,te){var A=y("../bar/attributes"),g=y("../scatter/attributes").line,S=y("../../plots/attributes"),M=y("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=y("../../plots/template_attributes").hovertemplateAttrs,a=y("../../plots/template_attributes").texttemplateAttrs,n=y("./constants"),r=y("../../lib/extend").extendFlat,t=y("../../components/color");function h(s){return{marker:{color:r({},A.marker.color,{arrayOk:!1,editType:"style"}),line:{color:r({},A.marker.line.color,{arrayOk:!1,editType:"style"}),width:r({},A.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}ee.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:A.x,x0:A.x0,dx:A.dx,y:A.y,y0:A.y0,dy:A.dy,xperiod:A.xperiod,yperiod:A.yperiod,xperiod0:A.xperiod0,yperiod0:A.yperiod0,xperiodalignment:A.xperiodalignment,yperiodalignment:A.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),hovertext:A.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:r({},S.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:a({editType:"plot"},{keys:n.eventDataKeys.concat(["label"])}),text:A.text,textposition:A.textposition,insidetextanchor:A.insidetextanchor,textangle:A.textangle,textfont:A.textfont,insidetextfont:A.insidetextfont,outsidetextfont:A.outsidetextfont,constraintext:A.constraintext,cliponaxis:A.cliponaxis,orientation:A.orientation,offset:A.offset,width:A.width,increasing:h(),decreasing:h(),totals:h(),connector:{line:{color:r({},g.color,{dflt:t.defaultLine}),width:r({},g.width,{editType:"plot"}),dash:g.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:A.offsetgroup,alignmentgroup:A.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(y,ee,te){var A=y("../../plots/cartesian/axes"),g=y("../../plots/cartesian/align_period"),S=y("../../lib").mergeArray,M=y("../scatter/calc_selection"),e=y("../../constants/numerical").BADNUM;function a(r){return r==="a"||r==="absolute"}function n(r){return r==="t"||r==="total"}ee.exports=function(t,h){var s=A.getFromId(t,h.xaxis||"x"),i=A.getFromId(t,h.yaxis||"y"),x,p,v,f,d,o;h.orientation==="h"?(x=s.makeCalcdata(h,"x"),v=i.makeCalcdata(h,"y"),f=g(h,i,"y",v),d=!!h.yperiodalignment,o="y"):(x=i.makeCalcdata(h,"y"),v=s.makeCalcdata(h,"x"),f=g(h,s,"x",v),d=!!h.xperiodalignment,o="x"),p=f.vals;for(var m=Math.min(p.length,x.length),l=new Array(m),w=0,_,c=!1,b=0;b<m;b++){var u=x[b]||0,L=!1;(x[b]!==e||n(h.measure[b])||a(h.measure[b]))&&b+1<m&&(x[b+1]!==e||n(h.measure[b+1])||a(h.measure[b+1]))&&(L=!0);var T=l[b]={i:b,p:p[b],s:u,rawS:u,cNext:L};a(h.measure[b])?(w=T.s,T.isSum=!0,T.dir="totals",T.s=w):n(h.measure[b])?(T.isSum=!0,T.dir="totals",T.s=w):(T.isSum=!1,T.dir=T.rawS<0?"decreasing":"increasing",_=T.s,T.s=w+_,w+=_),T.dir==="totals"&&(c=!0),d&&(l[b].orig_p=v[b],l[b][o+"End"]=f.ends[b],l[b][o+"Start"]=f.starts[b]),h.ids&&(T.id=String(h.ids[b])),T.v=(h.base||0)+w}return l.length&&(l[0].hasTotals=c),S(h.text,l,"tx"),S(h.hovertext,l,"htx"),M(l,h),l}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(y,ee,te){ee.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(y,ee,te){var A=y("../bar/cross_trace_calc").setGroupPositions;ee.exports=function(S,M){var e=S._fullLayout,a=S._fullData,n=S.calcdata,r=M.xaxis,t=M.yaxis,h=[],s=[],i=[],x,p;for(p=0;p<a.length;p++){var v=a[p];v.visible===!0&&v.xaxis===r._id&&v.yaxis===t._id&&v.type==="waterfall"&&(x=n[p],v.orientation==="h"?i.push(x):s.push(x),h.push(x))}var f={mode:e.waterfallmode,norm:e.waterfallnorm,gap:e.waterfallgap,groupgap:e.waterfallgroupgap};for(A(S,r,t,s,f),A(S,t,r,i,f),p=0;p<h.length;p++){x=h[p];for(var d=0;d<x.length;d++){var o=x[d];o.isSum===!1&&(o.s0+=d===0?0:x[d-1].s),d+1<x.length&&(x[d].nextP0=x[d+1].p0,x[d].nextS0=x[d+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(y,ee,te){var A=y("../../lib"),g=y("../bar/defaults").handleGroupingDefaults,S=y("../bar/defaults").handleText,M=y("../scatter/xy_defaults"),e=y("../scatter/period_defaults"),a=y("./attributes"),n=y("../../components/color"),r=y("../../constants/delta.js"),t=r.INCREASING.COLOR,h=r.DECREASING.COLOR,s="#4499FF";function i(v,f,d){v(f+".marker.color",d),v(f+".marker.line.color",n.defaultLine),v(f+".marker.line.width")}function x(v,f,d,o){function m(b,u){return A.coerce(v,f,a,b,u)}var l=M(v,f,o,m);if(!l){f.visible=!1;return}e(v,f,o,m),m("xhoverformat"),m("yhoverformat"),m("measure"),m("orientation",f.x&&!f.y?"h":"v"),m("base"),m("offset"),m("width"),m("text"),m("hovertext"),m("hovertemplate");var w=m("textposition");S(v,f,o,m,w,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),f.textposition!=="none"&&(m("texttemplate"),f.texttemplate||m("textinfo")),i(m,"increasing",t),i(m,"decreasing",h),i(m,"totals",s);var _=m("connector.visible");if(_){m("connector.mode");var c=m("connector.line.width");c&&(m("connector.line.color"),m("connector.line.dash"))}}function p(v,f){var d,o;function m(w){return A.coerce(o._input,o,a,w)}if(f.waterfallmode==="group")for(var l=0;l<v.length;l++)o=v[l],d=o._input,g(d,o,f,m)}ee.exports={supplyDefaults:x,crossTraceDefaults:p}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(y,ee,te){ee.exports=function(g,S){return g.x="xVal"in S?S.xVal:S.x,g.y="yVal"in S?S.yVal:S.y,"initial"in S&&(g.initial=S.initial),"delta"in S&&(g.delta=S.delta),"final"in S&&(g.final=S.final),S.xa&&(g.xaxis=S.xa),S.ya&&(g.yaxis=S.ya),g}},{}],1121:[function(y,ee,te){var A=y("../../plots/cartesian/axes").hoverLabelText,g=y("../../components/color").opacity,S=y("../bar/hover").hoverOnBars,M=y("../../constants/delta.js"),e={increasing:M.INCREASING.SYMBOL,decreasing:M.DECREASING.SYMBOL};ee.exports=function(r,t,h,s,i){var x=S(r,t,h,s,i);if(!x)return;var p=x.cd,v=p[0].trace,f=v.orientation==="h",d=f?"x":"y",o=f?r.xa:r.ya;function m(P){return A(o,P,v[d+"hoverformat"])}var l=x.index,w=p[l],_=w.isSum?w.b+w.s:w.rawS;if(!w.isSum){x.initial=w.b+w.s-_,x.delta=_,x.final=x.initial+x.delta;var c=m(Math.abs(x.delta));x.deltaLabel=_<0?"("+c+")":c,x.finalLabel=m(x.final),x.initialLabel=m(x.initial)}var b=w.hi||v.hoverinfo,u=[];if(b&&b!=="none"&&b!=="skip"){var L=b==="all",T=b.split("+"),k=function(P){return L||T.indexOf(P)!==-1};w.isSum||(k("final")&&(f?!k("x"):!k("y"))&&u.push(x.finalLabel),k("delta")&&(_<0?u.push(x.deltaLabel+" "+e.decreasing):u.push(x.deltaLabel+" "+e.increasing)),k("initial")&&u.push("Initial: "+x.initialLabel))}return u.length&&(x.extraText=u.join("<br>")),x.color=a(v,w),[x]};function a(n,r){var t=n[r.dir].marker,h=t.color,s=t.line.color,i=t.line.width;if(g(h))return h;if(g(s)&&i)return s}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(y,ee,te){ee.exports={attributes:y("./attributes"),layoutAttributes:y("./layout_attributes"),supplyDefaults:y("./defaults").supplyDefaults,crossTraceDefaults:y("./defaults").crossTraceDefaults,supplyLayoutDefaults:y("./layout_defaults"),calc:y("./calc"),crossTraceCalc:y("./cross_trace_calc"),plot:y("./plot"),style:y("./style").style,hoverPoints:y("./hover"),eventData:y("./event_data"),selectPoints:y("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:y("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(y,ee,te){ee.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(y,ee,te){var A=y("../../lib"),g=y("./layout_attributes");ee.exports=function(S,M,e){var a=!1;function n(h,s){return A.coerce(S,M,g,h,s)}for(var r=0;r<e.length;r++){var t=e[r];if(t.visible&&t.type==="waterfall"){a=!0;break}}a&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../lib"),S=y("../../components/drawing"),M=y("../../constants/numerical").BADNUM,e=y("../bar/plot"),a=y("../bar/uniform_text").clearMinTextSize;ee.exports=function(h,s,i,x){var p=h._fullLayout;a("waterfall",p),e.plot(h,s,i,x,{mode:p.waterfallmode,norm:p.waterfallmode,gap:p.waterfallgap,groupgap:p.waterfallgroupgap}),n(h,s,i,x)};function n(t,h,s,i){var x=h.xaxis,p=h.yaxis;g.makeTraceGroups(i,s,"trace bars").each(function(v){var f=A.select(this),d=v[0].trace,o=g.ensureSingle(f,"g","lines");if(!d.connector||!d.connector.visible){o.remove();return}var m=d.orientation==="h",l=d.connector.mode,w=o.selectAll("g.line").data(g.identity);w.enter().append("g").classed("line",!0),w.exit().remove();var _=w.size();w.each(function(c,b){if(!(b!==_-1&&!c.cNext)){var u=r(c,x,p,m),L=u[0],T=u[1],k="";L[0]!==M&&T[0]!==M&&L[1]!==M&&T[1]!==M&&(l==="spanning"&&!c.isSum&&b>0&&(m?k+="M"+L[0]+","+T[1]+"V"+T[0]:k+="M"+L[1]+","+T[0]+"H"+L[0]),l!=="between"&&(c.isSum||b<_-1)&&(m?k+="M"+L[1]+","+T[0]+"V"+T[1]:k+="M"+L[0]+","+T[1]+"H"+L[1]),L[2]!==M&&T[2]!==M&&(m?k+="M"+L[1]+","+T[1]+"V"+T[2]:k+="M"+L[1]+","+T[1]+"H"+L[2])),k===""&&(k="M0,0Z"),g.ensureSingle(A.select(this),"path").attr("d",k).call(S.setClipUrl,h.layerClipId,t)}})})}function r(t,h,s,i){var x=[],p=[],v=i?h:s,f=i?s:h;return x[0]=v.c2p(t.s0,!0),p[0]=f.c2p(t.p0,!0),x[1]=v.c2p(t.s1,!0),p[1]=f.c2p(t.p1,!0),x[2]=v.c2p(t.nextS0,!0),p[2]=f.c2p(t.nextP0,!0),i?[x,p]:[p,x]}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(y,ee,te){var A=y("@plotly/d3"),g=y("../../components/drawing"),S=y("../../components/color"),M=y("../../constants/interactions").DESELECTDIM,e=y("../bar/style"),a=y("../bar/uniform_text").resizeText,n=e.styleTextPoints;function r(t,h,s){var i=s||A.select(t).selectAll("g.waterfalllayer").selectAll("g.trace");a(t,i,"waterfall"),i.style("opacity",function(x){return x[0].trace.opacity}),i.each(function(x){var p=A.select(this),v=x[0].trace;p.selectAll(".point > path").each(function(f){if(!f.isBlank){var d=v[f.dir].marker;A.select(this).call(S.fill,d.color).call(S.stroke,d.line.color).call(g.dashLine,d.line.dash,d.line.width).style("opacity",v.selectedpoints&&!f.selected?M:1)}}),n(p,v,t),p.selectAll(".lines").each(function(){var f=v.connector.line;g.lineGroupStyle(A.select(this).selectAll("path"),f.width,f.color,f.dash)})})}ee.exports={style:r}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(y,ee,te){var A=y("../plots/cartesian/axes"),g=y("../lib"),S=y("../plot_api/plot_schema"),M=y("./helpers").pointsAccessorFunction,e=y("../constants/numerical").BADNUM;te.moduleType="transform",te.name="aggregate";var a=te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=a.aggregations;te.supplyDefaults=function(x,p){var v={},f;function d(P,z){return g.coerce(x,v,a,P,z)}var o=d("enabled");if(!o)return v;var m=S.findArrayAttributes(p),l={};for(f=0;f<m.length;f++)l[m[f]]=1;var w=d("groups");if(!Array.isArray(w)){if(!l[w])return v.enabled=!1,v;l[w]=0}var _=x.aggregations||[],c=v.aggregations=new Array(_.length),b;function u(P,z){return g.coerce(_[f],b,n,P,z)}for(f=0;f<_.length;f++){b={_index:f};var L=u("target"),T=u("func"),k=u("enabled");k&&L&&(l[L]||T==="count"&&l[L]===void 0)?(T==="stddev"&&u("funcmode"),l[L]=0,c[f]=b):c[f]={enabled:!1,_index:f}}for(f=0;f<m.length;f++)l[m[f]]&&c.push({target:m[f],func:n.func.dflt,enabled:!0,_index:-1});return v},te.calcTransform=function(x,p,v){if(v.enabled){var f=v.groups,d=g.getTargetArray(p,{target:f});if(d){var o,m,l,w,_={},c={},b=[],u=M(p.transforms,v),L=d.length;for(p._length&&(L=Math.min(L,p._length)),o=0;o<L;o++)m=d[o],l=_[m],l===void 0?(_[m]=b.length,w=[o],b.push(w),c[_[m]]=u(o)):(b[l].push(o),c[_[m]]=(c[_[m]]||[]).concat(u(o)));v._indexToPoints=c;var T=v.aggregations;for(o=0;o<T.length;o++)r(x,p,b,T[o]);typeof f=="string"&&r(x,p,b,{target:f,func:"first",enabled:!0}),p._length=b.length}}};function r(x,p,v,f){if(f.enabled){for(var d=f.target,o=g.nestedProperty(p,d),m=o.get(),l=A.getDataConversions(x,p,d,m),w=t(f,l),_=new Array(v.length),c=0;c<v.length;c++)_[c]=w(m,v[c]);o.set(_),f.func==="count"&&g.pushUnique(p._arrayAttrs,d)}}function t(x,p){var v=x.func,f=p.d2c,d=p.c2d;switch(v){case"count":return h;case"first":return s;case"last":return i;case"sum":return function(o,m){for(var l=0,w=0;w<m.length;w++){var _=f(o[m[w]]);_!==e&&(l+=_)}return d(l)};case"avg":return function(o,m){for(var l=0,w=0,_=0;_<m.length;_++){var c=f(o[m[_]]);c!==e&&(l+=c,w++)}return w?d(l/w):e};case"min":return function(o,m){for(var l=1/0,w=0;w<m.length;w++){var _=f(o[m[w]]);_!==e&&(l=Math.min(l,_))}return l===1/0?e:d(l)};case"max":return function(o,m){for(var l=-1/0,w=0;w<m.length;w++){var _=f(o[m[w]]);_!==e&&(l=Math.max(l,_))}return l===-1/0?e:d(l)};case"range":return function(o,m){for(var l=1/0,w=-1/0,_=0;_<m.length;_++){var c=f(o[m[_]]);c!==e&&(l=Math.min(l,c),w=Math.max(w,c))}return w===-1/0||l===1/0?e:d(w-l)};case"change":return function(o,m){var l=f(o[m[0]]),w=f(o[m[m.length-1]]);return l===e||w===e?e:d(w-l)};case"median":return function(o,m){for(var l=[],w=0;w<m.length;w++){var _=f(o[m[w]]);_!==e&&l.push(_)}if(!l.length)return e;l.sort(g.sorterAsc);var c=(l.length-1)/2;return d((l[Math.floor(c)]+l[Math.ceil(c)])/2)};case"mode":return function(o,m){for(var l={},w=0,_=e,c=0;c<m.length;c++){var b=f(o[m[c]]);if(b!==e){var u=l[b]=(l[b]||0)+1;u>w&&(w=u,_=b)}}return w?d(_):e};case"rms":return function(o,m){for(var l=0,w=0,_=0;_<m.length;_++){var c=f(o[m[_]]);c!==e&&(l+=c*c,w++)}return w?d(Math.sqrt(l/w)):e};case"stddev":return function(o,m){var l=0,w=0,_=1,c=e,b;for(b=0;b<m.length&&c===e;b++)c=f(o[m[b]]);if(c===e)return e;for(;b<m.length;b++){var u=f(o[m[b]]);if(u!==e){var L=u-c;l+=L,w+=L*L,_++}}var T=x.funcmode==="sample"?_-1:_;return T?Math.sqrt((w-l*l/_)/T):0}}}function h(x,p){return p.length}function s(x,p){return x[p[0]]}function i(x,p){return x[p[p.length-1]]}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(y,ee,te){var A=y("../lib"),g=y("../registry"),S=y("../plots/cartesian/axes"),M=y("./helpers").pointsAccessorFunction,e=y("../constants/filter_ops"),a=e.COMPARISON_OPS,n=e.INTERVAL_OPS,r=e.SET_OPS;te.moduleType="transform",te.name="filter",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(a).concat(n).concat(r),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},te.supplyDefaults=function(h){var s={};function i(f,d){return A.coerce(h,s,te.attributes,f,d)}var x=i("enabled");if(x){var p=i("target");if(A.isArrayOrTypedArray(p)&&p.length===0)return s.enabled=!1,s;i("preservegaps"),i("operation"),i("value");var v=g.getComponentMethod("calendars","handleDefaults");v(h,s,"valuecalendar",null),v(h,s,"targetcalendar",null)}return s},te.calcTransform=function(h,s,i){if(!i.enabled)return;var x=A.getTargetArray(s,i);if(!x)return;var p=i.target,v=x.length;s._length&&(v=Math.min(v,s._length));var f=i.targetcalendar,d=s._arrayAttrs,o=i.preservegaps;if(typeof p=="string"){var m=A.nestedProperty(s,p+"calendar").get();m&&(f=m)}var l=S.getDataToCoordFunc(h,s,p,x),w=t(i,l,f),_={},c={},b=0;function u(I,D){for(var R=0;R<d.length;R++){var O=A.nestedProperty(s,d[R]);I(O,D)}}var L,T;o?(L=function(I){_[I.astr]=A.extendDeep([],I.get()),I.set(new Array(v))},T=function(I,D){var R=_[I.astr][D];I.get()[D]=R}):(L=function(I){_[I.astr]=A.extendDeep([],I.get()),I.set([])},T=function(I,D){var R=_[I.astr][D];I.get().push(R)}),u(L);for(var k=M(s.transforms,i),P=0;P<v;P++){var z=w(x[P]);z?(u(T,P),c[b++]=k(P)):o&&b++}i._indexToPoints=c,s._length=b};function t(h,s,i){var x=h.operation,p=h.value,v=Array.isArray(p);function f(l){return l.indexOf(x)!==-1}var d=function(l){return s(l,0,h.valuecalendar)},o=function(l){return s(l,0,i)},m;switch(f(a)?m=d(v?p[0]:p):f(n)?m=v?[d(p[0]),d(p[1])]:[d(p),d(p)]:f(r)&&(m=v?p.map(d):[d(p)]),x){case"=":return function(l){return o(l)===m};case"!=":return function(l){return o(l)!==m};case"<":return function(l){return o(l)<m};case"<=":return function(l){return o(l)<=m};case">":return function(l){return o(l)>m};case">=":return function(l){return o(l)>=m};case"[]":return function(l){var w=o(l);return w>=m[0]&&w<=m[1]};case"()":return function(l){var w=o(l);return w>m[0]&&w<m[1]};case"[)":return function(l){var w=o(l);return w>=m[0]&&w<m[1]};case"(]":return function(l){var w=o(l);return w>m[0]&&w<=m[1]};case"][":return function(l){var w=o(l);return w<=m[0]||w>=m[1]};case")(":return function(l){var w=o(l);return w<m[0]||w>m[1]};case"](":return function(l){var w=o(l);return w<=m[0]||w>m[1]};case")[":return function(l){var w=o(l);return w<m[0]||w>=m[1]};case"{}":return function(l){return m.indexOf(o(l))!==-1};case"}{":return function(l){return m.indexOf(o(l))===-1}}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(y,ee,te){var A=y("../lib"),g=y("../plot_api/plot_schema"),S=y("../plots/plots"),M=y("./helpers").pointsAccessorFunction;te.moduleType="transform",te.name="groupby",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},te.supplyDefaults=function(a,n,r){var t,h={};function s(d,o){return A.coerce(a,h,te.attributes,d,o)}var i=s("enabled");if(!i)return h;s("groups"),s("nameformat",r._dataLength>1?"%{group} (%{trace})":"%{group}");var x=a.styles,p=h.styles=[];if(x)for(t=0;t<x.length;t++){var v=p[t]={};A.coerce(x[t],p[t],te.attributes.styles,"target");var f=A.coerce(x[t],p[t],te.attributes.styles,"value");A.isPlainObject(f)?v.value=A.extendDeep({},f):f&&delete v.value}return h},te.transform=function(a,n){var r,t,h,s=[];for(t=0;t<a.length;t++)for(r=e(a[t],n),h=0;h<r.length;h++)s.push(r[h]);return s};function e(a,n){var r,t,h,s,i,x,p,v,f,d,o=n.transform,m=n.transformIndex,l=a.transforms[m].groups,w=M(a.transforms,o);if(!A.isArrayOrTypedArray(l)||l.length===0)return[a];var _=A.filterUnique(l),c=new Array(_.length),b=l.length,u=g.findArrayAttributes(a),L=o.styles||[],T={};for(r=0;r<L.length;r++)T[L[r].target]=L[r].value;o.styles&&(d=A.keyedContainer(o,"styles","target","value.name"));var k={},P={};for(r=0;r<_.length;r++){x=_[r],k[x]=r,P[x]=0,p=c[r]=A.extendDeepNoArrays({},a),p._group=x,p.transforms[m]._indexToPoints={};var z=null;for(d&&(z=d.get(x)),z||z===""?p.name=z:p.name=A.templateString(o.nameformat,{trace:a.name,group:x}),v=p.transforms,p.transforms=[],t=0;t<v.length;t++)p.transforms[t]=A.extendDeepNoArrays({},v[t]);for(t=0;t<u.length;t++)A.nestedProperty(p,u[t]).set([])}for(h=0;h<u.length;h++){for(s=u[h],t=0,f=[];t<_.length;t++)f[t]=A.nestedProperty(c[t],s).get();for(i=A.nestedProperty(a,s).get(),t=0;t<b;t++)f[k[l[t]]].push(i[t])}for(t=0;t<b;t++){p=c[k[l[t]]];var I=p.transforms[m]._indexToPoints;I[P[l[t]]]=w(t),P[l[t]]++}for(r=0;r<_.length;r++)x=_[r],p=c[r],S.clearExpandedTraceDefaultColors(p),p=A.extendDeepNoArrays(p,T[x]||{});return c}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(y,ee,te){te.pointsAccessorFunction=function(A,g){for(var S,M,e=0;e<A.length&&(S=A[e],S!==g);e++)!S._indexToPoints||S.enabled===!1||(M=S._indexToPoints);var a=M?function(n){return M[n]}:function(n){return[n]};return a}},{}],1131:[function(y,ee,te){var A=y("../lib"),g=y("../plots/cartesian/axes"),S=y("./helpers").pointsAccessorFunction,M=y("../constants/numerical").BADNUM;te.moduleType="transform",te.name="sort",te.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},te.supplyDefaults=function(n){var r={};function t(s,i){return A.coerce(n,r,te.attributes,s,i)}var h=t("enabled");return h&&(t("target"),t("order")),r},te.calcTransform=function(n,r,t){if(t.enabled){var h=A.getTargetArray(r,t);if(h){var s=t.target,i=h.length;r._length&&(i=Math.min(i,r._length));var x=r._arrayAttrs,p=g.getDataToCoordFunc(n,r,s,h),v=e(t,h,p,i),f=S(r.transforms,t),d={},o,m;for(o=0;o<x.length;o++){var l=A.nestedProperty(r,x[o]),w=l.get(),_=new Array(i);for(m=0;m<i;m++)_[m]=w[v[m]];l.set(_)}for(m=0;m<i;m++)d[m]=f(v[m]);t._indexToPoints=d,r._length=i}}};function e(n,r,t,h){var s=new Array(h),i=new Array(h),x;for(x=0;x<h;x++)s[x]={v:r[x],i:x};for(s.sort(a(n,t)),x=0;x<h;x++)i[x]=s[x].i;return i}function a(n,r){switch(n.order){case"ascending":return function(t,h){var s=r(t.v),i=r(h.v);return s===M?1:i===M?-1:s-i};case"descending":return function(t,h){var s=r(t.v),i=r(h.v);return s===M?1:i===M?-1:i-s}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(y,ee,te){te.version="2.16.1"},{}],1133:[function(y,ee,te){(function(A){(function(){(function(g){if(typeof te=="object"&&typeof ee<"u")ee.exports=g();else{var S;typeof window<"u"?S=window:typeof A<"u"?S=A:typeof self<"u"?S=self:S=this,S.stackgl=g()}})(function(){return function(){function g(S,M,e){function a(t,h){if(!M[t]){if(!S[t]){var s=typeof y=="function"&&y;if(!h&&s)return s(t,!0);if(n)return n(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var x=M[t]={exports:{}};S[t][0].call(x.exports,function(p){var v=S[t][1][p];return a(v||p)},x,x.exports,g,S,M,e)}return M[t].exports}for(var n=typeof y=="function"&&y,r=0;r<e.length;r++)a(e[r]);return a}return g}()({1:[function(g,S,M){M.byteLength=i,M.toByteArray=p,M.fromByteArray=d;for(var e=[],a=[],n=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,h=r.length;t<h;++t)e[t]=r[t],a[r.charCodeAt(t)]=t;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63;function s(o){var m=o.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=o.indexOf("=");l===-1&&(l=m);var w=l===m?0:4-l%4;return[l,w]}function i(o){var m=s(o),l=m[0],w=m[1];return(l+w)*3/4-w}function x(o,m,l){return(m+l)*3/4-l}function p(o){var m,l=s(o),w=l[0],_=l[1],c=new n(x(o,w,_)),b=0,u=_>0?w-4:w,L;for(L=0;L<u;L+=4)m=a[o.charCodeAt(L)]<<18|a[o.charCodeAt(L+1)]<<12|a[o.charCodeAt(L+2)]<<6|a[o.charCodeAt(L+3)],c[b++]=m>>16&255,c[b++]=m>>8&255,c[b++]=m&255;return _===2&&(m=a[o.charCodeAt(L)]<<2|a[o.charCodeAt(L+1)]>>4,c[b++]=m&255),_===1&&(m=a[o.charCodeAt(L)]<<10|a[o.charCodeAt(L+1)]<<4|a[o.charCodeAt(L+2)]>>2,c[b++]=m>>8&255,c[b++]=m&255),c}function v(o){return e[o>>18&63]+e[o>>12&63]+e[o>>6&63]+e[o&63]}function f(o,m,l){for(var w,_=[],c=m;c<l;c+=3)w=(o[c]<<16&16711680)+(o[c+1]<<8&65280)+(o[c+2]&255),_.push(v(w));return _.join("")}function d(o){for(var m,l=o.length,w=l%3,_=[],c=16383,b=0,u=l-w;b<u;b+=c)_.push(f(o,b,b+c>u?u:b+c));return w===1?(m=o[l-1],_.push(e[m>>2]+e[m<<4&63]+"==")):w===2&&(m=(o[l-2]<<8)+o[l-1],_.push(e[m>>10]+e[m>>4&63]+e[m<<2&63]+"=")),_.join("")}},{}],2:[function(g,S,M){},{}],3:[function(g,S,M){(function(e){(function(){var a=g("base64-js"),n=g("ieee754");M.Buffer=s,M.SlowBuffer=w,M.INSPECT_MAX_BYTES=50;var r=2147483647;M.kMaxLength=r,s.TYPED_ARRAY_SUPPORT=t(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function t(){try{var ce=new Uint8Array(1);return ce.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ce.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function h(ce){if(ce>r)throw new RangeError('The value "'+ce+'" is invalid for option "size"');var de=new Uint8Array(ce);return de.__proto__=s.prototype,de}function s(ce,de,ye){if(typeof ce=="number"){if(typeof de=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(ce)}return i(ce,de,ye)}typeof Symbol<"u"&&Symbol.species!=null&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192;function i(ce,de,ye){if(typeof ce=="string")return f(ce,de);if(ArrayBuffer.isView(ce))return d(ce);if(ce==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ce);if(oe(ce,ArrayBuffer)||ce&&oe(ce.buffer,ArrayBuffer))return o(ce,de,ye);if(typeof ce=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ge=ce.valueOf&&ce.valueOf();if(ge!=null&&ge!==ce)return s.from(ge,de,ye);var me=m(ce);if(me)return me;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ce[Symbol.toPrimitive]=="function")return s.from(ce[Symbol.toPrimitive]("string"),de,ye);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ce)}s.from=function(ce,de,ye){return i(ce,de,ye)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array;function x(ce){if(typeof ce!="number")throw new TypeError('"size" argument must be of type number');if(ce<0)throw new RangeError('The value "'+ce+'" is invalid for option "size"')}function p(ce,de,ye){return x(ce),ce<=0?h(ce):de!==void 0?typeof ye=="string"?h(ce).fill(de,ye):h(ce).fill(de):h(ce)}s.alloc=function(ce,de,ye){return p(ce,de,ye)};function v(ce){return x(ce),h(ce<0?0:l(ce)|0)}s.allocUnsafe=function(ce){return v(ce)},s.allocUnsafeSlow=function(ce){return v(ce)};function f(ce,de){if((typeof de!="string"||de==="")&&(de="utf8"),!s.isEncoding(de))throw new TypeError("Unknown encoding: "+de);var ye=_(ce,de)|0,ge=h(ye),me=ge.write(ce,de);return me!==ye&&(ge=ge.slice(0,me)),ge}function d(ce){for(var de=ce.length<0?0:l(ce.length)|0,ye=h(de),ge=0;ge<de;ge+=1)ye[ge]=ce[ge]&255;return ye}function o(ce,de,ye){if(de<0||ce.byteLength<de)throw new RangeError('"offset" is outside of buffer bounds');if(ce.byteLength<de+(ye||0))throw new RangeError('"length" is outside of buffer bounds');var ge;return de===void 0&&ye===void 0?ge=new Uint8Array(ce):ye===void 0?ge=new Uint8Array(ce,de):ge=new Uint8Array(ce,de,ye),ge.__proto__=s.prototype,ge}function m(ce){if(s.isBuffer(ce)){var de=l(ce.length)|0,ye=h(de);return ye.length===0||ce.copy(ye,0,0,de),ye}if(ce.length!==void 0)return typeof ce.length!="number"||be(ce.length)?h(0):d(ce);if(ce.type==="Buffer"&&Array.isArray(ce.data))return d(ce.data)}function l(ce){if(ce>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return ce|0}function w(ce){return+ce!=ce&&(ce=0),s.alloc(+ce)}s.isBuffer=function(de){return de!=null&&de._isBuffer===!0&&de!==s.prototype},s.compare=function(de,ye){if(oe(de,Uint8Array)&&(de=s.from(de,de.offset,de.byteLength)),oe(ye,Uint8Array)&&(ye=s.from(ye,ye.offset,ye.byteLength)),!s.isBuffer(de)||!s.isBuffer(ye))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(de===ye)return 0;for(var ge=de.length,me=ye.length,Ee=0,Pe=Math.min(ge,me);Ee<Pe;++Ee)if(de[Ee]!==ye[Ee]){ge=de[Ee],me=ye[Ee];break}return ge<me?-1:me<ge?1:0},s.isEncoding=function(de){switch(String(de).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(de,ye){if(!Array.isArray(de))throw new TypeError('"list" argument must be an Array of Buffers');if(de.length===0)return s.alloc(0);var ge;if(ye===void 0)for(ye=0,ge=0;ge<de.length;++ge)ye+=de[ge].length;var me=s.allocUnsafe(ye),Ee=0;for(ge=0;ge<de.length;++ge){var Pe=de[ge];if(oe(Pe,Uint8Array)&&(Pe=s.from(Pe)),!s.isBuffer(Pe))throw new TypeError('"list" argument must be an Array of Buffers');Pe.copy(me,Ee),Ee+=Pe.length}return me};function _(ce,de){if(s.isBuffer(ce))return ce.length;if(ArrayBuffer.isView(ce)||oe(ce,ArrayBuffer))return ce.byteLength;if(typeof ce!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ce);var ye=ce.length,ge=arguments.length>2&&arguments[2]===!0;if(!ge&&ye===0)return 0;for(var me=!1;;)switch(de){case"ascii":case"latin1":case"binary":return ye;case"utf8":case"utf-8":return X(ce).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ye*2;case"hex":return ye>>>1;case"base64":return se(ce).length;default:if(me)return ge?-1:X(ce).length;de=(""+de).toLowerCase(),me=!0}}s.byteLength=_;function c(ce,de,ye){var ge=!1;if((de===void 0||de<0)&&(de=0),de>this.length||((ye===void 0||ye>this.length)&&(ye=this.length),ye<=0)||(ye>>>=0,de>>>=0,ye<=de))return"";for(ce||(ce="utf8");;)switch(ce){case"hex":return W(this,de,ye);case"utf8":case"utf-8":return O(this,de,ye);case"ascii":return G(this,de,ye);case"latin1":case"binary":return K(this,de,ye);case"base64":return R(this,de,ye);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,de,ye);default:if(ge)throw new TypeError("Unknown encoding: "+ce);ce=(ce+"").toLowerCase(),ge=!0}}s.prototype._isBuffer=!0;function b(ce,de,ye){var ge=ce[de];ce[de]=ce[ye],ce[ye]=ge}s.prototype.swap16=function(){var de=this.length;if(de%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ye=0;ye<de;ye+=2)b(this,ye,ye+1);return this},s.prototype.swap32=function(){var de=this.length;if(de%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ye=0;ye<de;ye+=4)b(this,ye,ye+3),b(this,ye+1,ye+2);return this},s.prototype.swap64=function(){var de=this.length;if(de%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ye=0;ye<de;ye+=8)b(this,ye,ye+7),b(this,ye+1,ye+6),b(this,ye+2,ye+5),b(this,ye+3,ye+4);return this},s.prototype.toString=function(){var de=this.length;return de===0?"":arguments.length===0?O(this,0,de):c.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(de){if(!s.isBuffer(de))throw new TypeError("Argument must be a Buffer");return this===de?!0:s.compare(this,de)===0},s.prototype.inspect=function(){var de="",ye=M.INSPECT_MAX_BYTES;return de=this.toString("hex",0,ye).replace(/(.{2})/g,"$1 ").trim(),this.length>ye&&(de+=" ... "),"<Buffer "+de+">"},s.prototype.compare=function(de,ye,ge,me,Ee){if(oe(de,Uint8Array)&&(de=s.from(de,de.offset,de.byteLength)),!s.isBuffer(de))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof de);if(ye===void 0&&(ye=0),ge===void 0&&(ge=de?de.length:0),me===void 0&&(me=0),Ee===void 0&&(Ee=this.length),ye<0||ge>de.length||me<0||Ee>this.length)throw new RangeError("out of range index");if(me>=Ee&&ye>=ge)return 0;if(me>=Ee)return-1;if(ye>=ge)return 1;if(ye>>>=0,ge>>>=0,me>>>=0,Ee>>>=0,this===de)return 0;for(var Pe=Ee-me,Ue=ge-ye,we=Math.min(Pe,Ue),ke=this.slice(me,Ee),Xe=de.slice(ye,ge),Ve=0;Ve<we;++Ve)if(ke[Ve]!==Xe[Ve]){Pe=ke[Ve],Ue=Xe[Ve];break}return Pe<Ue?-1:Ue<Pe?1:0};function u(ce,de,ye,ge,me){if(ce.length===0)return-1;if(typeof ye=="string"?(ge=ye,ye=0):ye>2147483647?ye=2147483647:ye<-2147483648&&(ye=-2147483648),ye=+ye,be(ye)&&(ye=me?0:ce.length-1),ye<0&&(ye=ce.length+ye),ye>=ce.length){if(me)return-1;ye=ce.length-1}else if(ye<0)if(me)ye=0;else return-1;if(typeof de=="string"&&(de=s.from(de,ge)),s.isBuffer(de))return de.length===0?-1:L(ce,de,ye,ge,me);if(typeof de=="number")return de=de&255,typeof Uint8Array.prototype.indexOf=="function"?me?Uint8Array.prototype.indexOf.call(ce,de,ye):Uint8Array.prototype.lastIndexOf.call(ce,de,ye):L(ce,[de],ye,ge,me);throw new TypeError("val must be string, number or Buffer")}function L(ce,de,ye,ge,me){var Ee=1,Pe=ce.length,Ue=de.length;if(ge!==void 0&&(ge=String(ge).toLowerCase(),ge==="ucs2"||ge==="ucs-2"||ge==="utf16le"||ge==="utf-16le")){if(ce.length<2||de.length<2)return-1;Ee=2,Pe/=2,Ue/=2,ye/=2}function we(De,Ye){return Ee===1?De[Ye]:De.readUInt16BE(Ye*Ee)}var ke;if(me){var Xe=-1;for(ke=ye;ke<Pe;ke++)if(we(ce,ke)===we(de,Xe===-1?0:ke-Xe)){if(Xe===-1&&(Xe=ke),ke-Xe+1===Ue)return Xe*Ee}else Xe!==-1&&(ke-=ke-Xe),Xe=-1}else for(ye+Ue>Pe&&(ye=Pe-Ue),ke=ye;ke>=0;ke--){for(var Ve=!0,Ie=0;Ie<Ue;Ie++)if(we(ce,ke+Ie)!==we(de,Ie)){Ve=!1;break}if(Ve)return ke}return-1}s.prototype.includes=function(de,ye,ge){return this.indexOf(de,ye,ge)!==-1},s.prototype.indexOf=function(de,ye,ge){return u(this,de,ye,ge,!0)},s.prototype.lastIndexOf=function(de,ye,ge){return u(this,de,ye,ge,!1)};function T(ce,de,ye,ge){ye=Number(ye)||0;var me=ce.length-ye;ge?(ge=Number(ge),ge>me&&(ge=me)):ge=me;var Ee=de.length;ge>Ee/2&&(ge=Ee/2);for(var Pe=0;Pe<ge;++Pe){var Ue=parseInt(de.substr(Pe*2,2),16);if(be(Ue))return Pe;ce[ye+Pe]=Ue}return Pe}function k(ce,de,ye,ge){return ae(X(de,ce.length-ye),ce,ye,ge)}function P(ce,de,ye,ge){return ae(Q(de),ce,ye,ge)}function z(ce,de,ye,ge){return P(ce,de,ye,ge)}function I(ce,de,ye,ge){return ae(se(de),ce,ye,ge)}function D(ce,de,ye,ge){return ae(ie(de,ce.length-ye),ce,ye,ge)}s.prototype.write=function(de,ye,ge,me){if(ye===void 0)me="utf8",ge=this.length,ye=0;else if(ge===void 0&&typeof ye=="string")me=ye,ge=this.length,ye=0;else if(isFinite(ye))ye=ye>>>0,isFinite(ge)?(ge=ge>>>0,me===void 0&&(me="utf8")):(me=ge,ge=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Ee=this.length-ye;if((ge===void 0||ge>Ee)&&(ge=Ee),de.length>0&&(ge<0||ye<0)||ye>this.length)throw new RangeError("Attempt to write outside buffer bounds");me||(me="utf8");for(var Pe=!1;;)switch(me){case"hex":return T(this,de,ye,ge);case"utf8":case"utf-8":return k(this,de,ye,ge);case"ascii":return P(this,de,ye,ge);case"latin1":case"binary":return z(this,de,ye,ge);case"base64":return I(this,de,ye,ge);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,de,ye,ge);default:if(Pe)throw new TypeError("Unknown encoding: "+me);me=(""+me).toLowerCase(),Pe=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(ce,de,ye){return de===0&&ye===ce.length?a.fromByteArray(ce):a.fromByteArray(ce.slice(de,ye))}function O(ce,de,ye){ye=Math.min(ce.length,ye);for(var ge=[],me=de;me<ye;){var Ee=ce[me],Pe=null,Ue=Ee>239?4:Ee>223?3:Ee>191?2:1;if(me+Ue<=ye){var we,ke,Xe,Ve;switch(Ue){case 1:Ee<128&&(Pe=Ee);break;case 2:we=ce[me+1],(we&192)===128&&(Ve=(Ee&31)<<6|we&63,Ve>127&&(Pe=Ve));break;case 3:we=ce[me+1],ke=ce[me+2],(we&192)===128&&(ke&192)===128&&(Ve=(Ee&15)<<12|(we&63)<<6|ke&63,Ve>2047&&(Ve<55296||Ve>57343)&&(Pe=Ve));break;case 4:we=ce[me+1],ke=ce[me+2],Xe=ce[me+3],(we&192)===128&&(ke&192)===128&&(Xe&192)===128&&(Ve=(Ee&15)<<18|(we&63)<<12|(ke&63)<<6|Xe&63,Ve>65535&&Ve<1114112&&(Pe=Ve))}}Pe===null?(Pe=65533,Ue=1):Pe>65535&&(Pe-=65536,ge.push(Pe>>>10&1023|55296),Pe=56320|Pe&1023),ge.push(Pe),me+=Ue}return N(ge)}var F=4096;function N(ce){var de=ce.length;if(de<=F)return String.fromCharCode.apply(String,ce);for(var ye="",ge=0;ge<de;)ye+=String.fromCharCode.apply(String,ce.slice(ge,ge+=F));return ye}function G(ce,de,ye){var ge="";ye=Math.min(ce.length,ye);for(var me=de;me<ye;++me)ge+=String.fromCharCode(ce[me]&127);return ge}function K(ce,de,ye){var ge="";ye=Math.min(ce.length,ye);for(var me=de;me<ye;++me)ge+=String.fromCharCode(ce[me]);return ge}function W(ce,de,ye){var ge=ce.length;(!de||de<0)&&(de=0),(!ye||ye<0||ye>ge)&&(ye=ge);for(var me="",Ee=de;Ee<ye;++Ee)me+=ne(ce[Ee]);return me}function Y(ce,de,ye){for(var ge=ce.slice(de,ye),me="",Ee=0;Ee<ge.length;Ee+=2)me+=String.fromCharCode(ge[Ee]+ge[Ee+1]*256);return me}s.prototype.slice=function(de,ye){var ge=this.length;de=~~de,ye=ye===void 0?ge:~~ye,de<0?(de+=ge,de<0&&(de=0)):de>ge&&(de=ge),ye<0?(ye+=ge,ye<0&&(ye=0)):ye>ge&&(ye=ge),ye<de&&(ye=de);var me=this.subarray(de,ye);return me.__proto__=s.prototype,me};function re(ce,de,ye){if(ce%1!==0||ce<0)throw new RangeError("offset is not uint");if(ce+de>ye)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUIntLE=function(de,ye,ge){de=de>>>0,ye=ye>>>0,ge||re(de,ye,this.length);for(var me=this[de],Ee=1,Pe=0;++Pe<ye&&(Ee*=256);)me+=this[de+Pe]*Ee;return me},s.prototype.readUIntBE=function(de,ye,ge){de=de>>>0,ye=ye>>>0,ge||re(de,ye,this.length);for(var me=this[de+--ye],Ee=1;ye>0&&(Ee*=256);)me+=this[de+--ye]*Ee;return me},s.prototype.readUInt8=function(de,ye){return de=de>>>0,ye||re(de,1,this.length),this[de]},s.prototype.readUInt16LE=function(de,ye){return de=de>>>0,ye||re(de,2,this.length),this[de]|this[de+1]<<8},s.prototype.readUInt16BE=function(de,ye){return de=de>>>0,ye||re(de,2,this.length),this[de]<<8|this[de+1]},s.prototype.readUInt32LE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),(this[de]|this[de+1]<<8|this[de+2]<<16)+this[de+3]*16777216},s.prototype.readUInt32BE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),this[de]*16777216+(this[de+1]<<16|this[de+2]<<8|this[de+3])},s.prototype.readIntLE=function(de,ye,ge){de=de>>>0,ye=ye>>>0,ge||re(de,ye,this.length);for(var me=this[de],Ee=1,Pe=0;++Pe<ye&&(Ee*=256);)me+=this[de+Pe]*Ee;return Ee*=128,me>=Ee&&(me-=Math.pow(2,8*ye)),me},s.prototype.readIntBE=function(de,ye,ge){de=de>>>0,ye=ye>>>0,ge||re(de,ye,this.length);for(var me=ye,Ee=1,Pe=this[de+--me];me>0&&(Ee*=256);)Pe+=this[de+--me]*Ee;return Ee*=128,Pe>=Ee&&(Pe-=Math.pow(2,8*ye)),Pe},s.prototype.readInt8=function(de,ye){return de=de>>>0,ye||re(de,1,this.length),this[de]&128?(255-this[de]+1)*-1:this[de]},s.prototype.readInt16LE=function(de,ye){de=de>>>0,ye||re(de,2,this.length);var ge=this[de]|this[de+1]<<8;return ge&32768?ge|4294901760:ge},s.prototype.readInt16BE=function(de,ye){de=de>>>0,ye||re(de,2,this.length);var ge=this[de+1]|this[de]<<8;return ge&32768?ge|4294901760:ge},s.prototype.readInt32LE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),this[de]|this[de+1]<<8|this[de+2]<<16|this[de+3]<<24},s.prototype.readInt32BE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),this[de]<<24|this[de+1]<<16|this[de+2]<<8|this[de+3]},s.prototype.readFloatLE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),n.read(this,de,!0,23,4)},s.prototype.readFloatBE=function(de,ye){return de=de>>>0,ye||re(de,4,this.length),n.read(this,de,!1,23,4)},s.prototype.readDoubleLE=function(de,ye){return de=de>>>0,ye||re(de,8,this.length),n.read(this,de,!0,52,8)},s.prototype.readDoubleBE=function(de,ye){return de=de>>>0,ye||re(de,8,this.length),n.read(this,de,!1,52,8)};function ue(ce,de,ye,ge,me,Ee){if(!s.isBuffer(ce))throw new TypeError('"buffer" argument must be a Buffer instance');if(de>me||de<Ee)throw new RangeError('"value" argument is out of bounds');if(ye+ge>ce.length)throw new RangeError("Index out of range")}s.prototype.writeUIntLE=function(de,ye,ge,me){if(de=+de,ye=ye>>>0,ge=ge>>>0,!me){var Ee=Math.pow(2,8*ge)-1;ue(this,de,ye,ge,Ee,0)}var Pe=1,Ue=0;for(this[ye]=de&255;++Ue<ge&&(Pe*=256);)this[ye+Ue]=de/Pe&255;return ye+ge},s.prototype.writeUIntBE=function(de,ye,ge,me){if(de=+de,ye=ye>>>0,ge=ge>>>0,!me){var Ee=Math.pow(2,8*ge)-1;ue(this,de,ye,ge,Ee,0)}var Pe=ge-1,Ue=1;for(this[ye+Pe]=de&255;--Pe>=0&&(Ue*=256);)this[ye+Pe]=de/Ue&255;return ye+ge},s.prototype.writeUInt8=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,1,255,0),this[ye]=de&255,ye+1},s.prototype.writeUInt16LE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,2,65535,0),this[ye]=de&255,this[ye+1]=de>>>8,ye+2},s.prototype.writeUInt16BE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,2,65535,0),this[ye]=de>>>8,this[ye+1]=de&255,ye+2},s.prototype.writeUInt32LE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,4,4294967295,0),this[ye+3]=de>>>24,this[ye+2]=de>>>16,this[ye+1]=de>>>8,this[ye]=de&255,ye+4},s.prototype.writeUInt32BE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,4,4294967295,0),this[ye]=de>>>24,this[ye+1]=de>>>16,this[ye+2]=de>>>8,this[ye+3]=de&255,ye+4},s.prototype.writeIntLE=function(de,ye,ge,me){if(de=+de,ye=ye>>>0,!me){var Ee=Math.pow(2,8*ge-1);ue(this,de,ye,ge,Ee-1,-Ee)}var Pe=0,Ue=1,we=0;for(this[ye]=de&255;++Pe<ge&&(Ue*=256);)de<0&&we===0&&this[ye+Pe-1]!==0&&(we=1),this[ye+Pe]=(de/Ue>>0)-we&255;return ye+ge},s.prototype.writeIntBE=function(de,ye,ge,me){if(de=+de,ye=ye>>>0,!me){var Ee=Math.pow(2,8*ge-1);ue(this,de,ye,ge,Ee-1,-Ee)}var Pe=ge-1,Ue=1,we=0;for(this[ye+Pe]=de&255;--Pe>=0&&(Ue*=256);)de<0&&we===0&&this[ye+Pe+1]!==0&&(we=1),this[ye+Pe]=(de/Ue>>0)-we&255;return ye+ge},s.prototype.writeInt8=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,1,127,-128),de<0&&(de=255+de+1),this[ye]=de&255,ye+1},s.prototype.writeInt16LE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,2,32767,-32768),this[ye]=de&255,this[ye+1]=de>>>8,ye+2},s.prototype.writeInt16BE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,2,32767,-32768),this[ye]=de>>>8,this[ye+1]=de&255,ye+2},s.prototype.writeInt32LE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,4,2147483647,-2147483648),this[ye]=de&255,this[ye+1]=de>>>8,this[ye+2]=de>>>16,this[ye+3]=de>>>24,ye+4},s.prototype.writeInt32BE=function(de,ye,ge){return de=+de,ye=ye>>>0,ge||ue(this,de,ye,4,2147483647,-2147483648),de<0&&(de=4294967295+de+1),this[ye]=de>>>24,this[ye+1]=de>>>16,this[ye+2]=de>>>8,this[ye+3]=de&255,ye+4};function j(ce,de,ye,ge,me,Ee){if(ye+ge>ce.length)throw new RangeError("Index out of range");if(ye<0)throw new RangeError("Index out of range")}function q(ce,de,ye,ge,me){return de=+de,ye=ye>>>0,me||j(ce,de,ye,4),n.write(ce,de,ye,ge,23,4),ye+4}s.prototype.writeFloatLE=function(de,ye,ge){return q(this,de,ye,!0,ge)},s.prototype.writeFloatBE=function(de,ye,ge){return q(this,de,ye,!1,ge)};function H(ce,de,ye,ge,me){return de=+de,ye=ye>>>0,me||j(ce,de,ye,8),n.write(ce,de,ye,ge,52,8),ye+8}s.prototype.writeDoubleLE=function(de,ye,ge){return H(this,de,ye,!0,ge)},s.prototype.writeDoubleBE=function(de,ye,ge){return H(this,de,ye,!1,ge)},s.prototype.copy=function(de,ye,ge,me){if(!s.isBuffer(de))throw new TypeError("argument should be a Buffer");if(ge||(ge=0),!me&&me!==0&&(me=this.length),ye>=de.length&&(ye=de.length),ye||(ye=0),me>0&&me<ge&&(me=ge),me===ge||de.length===0||this.length===0)return 0;if(ye<0)throw new RangeError("targetStart out of bounds");if(ge<0||ge>=this.length)throw new RangeError("Index out of range");if(me<0)throw new RangeError("sourceEnd out of bounds");me>this.length&&(me=this.length),de.length-ye<me-ge&&(me=de.length-ye+ge);var Ee=me-ge;if(this===de&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(ye,ge,me);else if(this===de&&ge<ye&&ye<me)for(var Pe=Ee-1;Pe>=0;--Pe)de[Pe+ye]=this[Pe+ge];else Uint8Array.prototype.set.call(de,this.subarray(ge,me),ye);return Ee},s.prototype.fill=function(de,ye,ge,me){if(typeof de=="string"){if(typeof ye=="string"?(me=ye,ye=0,ge=this.length):typeof ge=="string"&&(me=ge,ge=this.length),me!==void 0&&typeof me!="string")throw new TypeError("encoding must be a string");if(typeof me=="string"&&!s.isEncoding(me))throw new TypeError("Unknown encoding: "+me);if(de.length===1){var Ee=de.charCodeAt(0);(me==="utf8"&&Ee<128||me==="latin1")&&(de=Ee)}}else typeof de=="number"&&(de=de&255);if(ye<0||this.length<ye||this.length<ge)throw new RangeError("Out of range index");if(ge<=ye)return this;ye=ye>>>0,ge=ge===void 0?this.length:ge>>>0,de||(de=0);var Pe;if(typeof de=="number")for(Pe=ye;Pe<ge;++Pe)this[Pe]=de;else{var Ue=s.isBuffer(de)?de:s.from(de,me),we=Ue.length;if(we===0)throw new TypeError('The value "'+de+'" is invalid for argument "value"');for(Pe=0;Pe<ge-ye;++Pe)this[Pe+ye]=Ue[Pe%we]}return this};var U=/[^+/0-9A-Za-z-_]/g;function $(ce){if(ce=ce.split("=")[0],ce=ce.trim().replace(U,""),ce.length<2)return"";for(;ce.length%4!==0;)ce=ce+"=";return ce}function ne(ce){return ce<16?"0"+ce.toString(16):ce.toString(16)}function X(ce,de){de=de||1/0;for(var ye,ge=ce.length,me=null,Ee=[],Pe=0;Pe<ge;++Pe){if(ye=ce.charCodeAt(Pe),ye>55295&&ye<57344){if(!me){if(ye>56319){(de-=3)>-1&&Ee.push(239,191,189);continue}else if(Pe+1===ge){(de-=3)>-1&&Ee.push(239,191,189);continue}me=ye;continue}if(ye<56320){(de-=3)>-1&&Ee.push(239,191,189),me=ye;continue}ye=(me-55296<<10|ye-56320)+65536}else me&&(de-=3)>-1&&Ee.push(239,191,189);if(me=null,ye<128){if((de-=1)<0)break;Ee.push(ye)}else if(ye<2048){if((de-=2)<0)break;Ee.push(ye>>6|192,ye&63|128)}else if(ye<65536){if((de-=3)<0)break;Ee.push(ye>>12|224,ye>>6&63|128,ye&63|128)}else if(ye<1114112){if((de-=4)<0)break;Ee.push(ye>>18|240,ye>>12&63|128,ye>>6&63|128,ye&63|128)}else throw new Error("Invalid code point")}return Ee}function Q(ce){for(var de=[],ye=0;ye<ce.length;++ye)de.push(ce.charCodeAt(ye)&255);return de}function ie(ce,de){for(var ye,ge,me,Ee=[],Pe=0;Pe<ce.length&&!((de-=2)<0);++Pe)ye=ce.charCodeAt(Pe),ge=ye>>8,me=ye%256,Ee.push(me),Ee.push(ge);return Ee}function se(ce){return a.toByteArray($(ce))}function ae(ce,de,ye,ge){for(var me=0;me<ge&&!(me+ye>=de.length||me>=ce.length);++me)de[me+ye]=ce[me];return me}function oe(ce,de){return ce instanceof de||ce!=null&&ce.constructor!=null&&ce.constructor.name!=null&&ce.constructor.name===de.name}function be(ce){return ce!==ce}}).call(this)}).call(this,g("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(g,S,M){M.read=function(e,a,n,r,t){var h,s,i=t*8-r-1,x=(1<<i)-1,p=x>>1,v=-7,f=n?t-1:0,d=n?-1:1,o=e[a+f];for(f+=d,h=o&(1<<-v)-1,o>>=-v,v+=i;v>0;h=h*256+e[a+f],f+=d,v-=8);for(s=h&(1<<-v)-1,h>>=-v,v+=r;v>0;s=s*256+e[a+f],f+=d,v-=8);if(h===0)h=1-p;else{if(h===x)return s?NaN:(o?-1:1)*(1/0);s=s+Math.pow(2,r),h=h-p}return(o?-1:1)*s*Math.pow(2,h-r)},M.write=function(e,a,n,r,t,h){var s,i,x,p=h*8-t-1,v=(1<<p)-1,f=v>>1,d=t===23?Math.pow(2,-24)-Math.pow(2,-77):0,o=r?0:h-1,m=r?1:-1,l=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(i=isNaN(a)?1:0,s=v):(s=Math.floor(Math.log(a)/Math.LN2),a*(x=Math.pow(2,-s))<1&&(s--,x*=2),s+f>=1?a+=d/x:a+=d*Math.pow(2,1-f),a*x>=2&&(s++,x/=2),s+f>=v?(i=0,s=v):s+f>=1?(i=(a*x-1)*Math.pow(2,t),s=s+f):(i=a*Math.pow(2,f-1)*Math.pow(2,t),s=0));t>=8;e[n+o]=i&255,o+=m,i/=256,t-=8);for(s=s<<t|i,p+=t;p>0;e[n+o]=s&255,o+=m,s/=256,p-=8);e[n+o-m]|=l*128}},{}],5:[function(g,S,M){var e=S.exports={},a,n;function r(){throw new Error("setTimeout has not been defined")}function t(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?a=setTimeout:a=r}catch{a=r}try{typeof clearTimeout=="function"?n=clearTimeout:n=t}catch{n=t}})();function h(l){if(a===setTimeout)return setTimeout(l,0);if((a===r||!a)&&setTimeout)return a=setTimeout,setTimeout(l,0);try{return a(l,0)}catch{try{return a.call(null,l,0)}catch{return a.call(this,l,0)}}}function s(l){if(n===clearTimeout)return clearTimeout(l);if((n===t||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(l);try{return n(l)}catch{try{return n.call(null,l)}catch{return n.call(this,l)}}}var i=[],x=!1,p,v=-1;function f(){!x||!p||(x=!1,p.length?i=p.concat(i):v=-1,i.length&&d())}function d(){if(!x){var l=h(f);x=!0;for(var w=i.length;w;){for(p=i,i=[];++v<w;)p&&p[v].run();v=-1,w=i.length}p=null,x=!1,s(l)}}e.nextTick=function(l){var w=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)w[_-1]=arguments[_];i.push(new o(l,w)),i.length===1&&!x&&h(d)};function o(l,w){this.fun=l,this.array=w}o.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function m(){}e.on=m,e.addListener=m,e.once=m,e.off=m,e.removeListener=m,e.removeAllListeners=m,e.emit=m,e.prependListener=m,e.prependOnceListener=m,e.listeners=function(l){return[]},e.binding=function(l){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(l){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],6:[function(g,S,M){S.exports={alpha_shape:g("alpha-shape"),convex_hull:g("convex-hull"),delaunay_triangulate:g("delaunay-triangulate"),gl_cone3d:g("gl-cone3d"),gl_error3d:g("gl-error3d"),gl_heatmap2d:g("gl-heatmap2d"),gl_line3d:g("gl-line3d"),gl_mesh3d:g("gl-mesh3d"),gl_plot2d:g("gl-plot2d"),gl_plot3d:g("gl-plot3d"),gl_pointcloud2d:g("gl-pointcloud2d"),gl_scatter3d:g("gl-scatter3d"),gl_select_box:g("gl-select-box"),gl_spikes2d:g("gl-spikes2d"),gl_streamtube3d:g("gl-streamtube3d"),gl_surface3d:g("gl-surface3d"),ndarray:g("ndarray"),ndarray_linear_interpolate:g("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(g,S,M){S.exports=h;var e=g("turntable-camera-controller"),a=g("orbit-camera-controller"),n=g("matrix-camera-controller");function r(s,i){this._controllerNames=Object.keys(s),this._controllerList=this._controllerNames.map(function(x){return s[x]}),this._mode=i,this._active=s[i],this._active||(this._mode="turntable",this._active=s.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var t=r.prototype;t.flush=function(s){for(var i=this._controllerList,x=0;x<i.length;++x)i[x].flush(s)},t.idle=function(s){for(var i=this._controllerList,x=0;x<i.length;++x)i[x].idle(s)},t.lookAt=function(s,i,x,p){for(var v=this._controllerList,f=0;f<v.length;++f)v[f].lookAt(s,i,x,p)},t.rotate=function(s,i,x,p){for(var v=this._controllerList,f=0;f<v.length;++f)v[f].rotate(s,i,x,p)},t.pan=function(s,i,x,p){for(var v=this._controllerList,f=0;f<v.length;++f)v[f].pan(s,i,x,p)},t.translate=function(s,i,x,p){for(var v=this._controllerList,f=0;f<v.length;++f)v[f].translate(s,i,x,p)},t.setMatrix=function(s,i){for(var x=this._controllerList,p=0;p<x.length;++p)x[p].setMatrix(s,i)},t.setDistanceLimits=function(s,i){for(var x=this._controllerList,p=0;p<x.length;++p)x[p].setDistanceLimits(s,i)},t.setDistance=function(s,i){for(var x=this._controllerList,p=0;p<x.length;++p)x[p].setDistance(s,i)},t.recalcMatrix=function(s){this._active.recalcMatrix(s)},t.getDistance=function(s){return this._active.getDistance(s)},t.getDistanceLimits=function(s){return this._active.getDistanceLimits(s)},t.lastT=function(){return this._active.lastT()},t.setMode=function(s){if(s!==this._mode){var i=this._controllerNames.indexOf(s);if(!(i<0)){var x=this._active,p=this._controllerList[i],v=Math.max(x.lastT(),p.lastT());x.recalcMatrix(v),p.setMatrix(v,x.computedMatrix),this._active=p,this._mode=s,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},t.getMode=function(){return this._mode};function h(s){s=s||{};var i=s.eye||[0,0,1],x=s.center||[0,0,0],p=s.up||[0,1,0],v=s.distanceLimits||[0,1/0],f=s.mode||"turntable",d=e(),o=a(),m=n();return d.setDistanceLimits(v[0],v[1]),d.lookAt(0,i,x,p),o.setDistanceLimits(v[0],v[1]),o.lookAt(0,i,x,p),m.setDistanceLimits(v[0],v[1]),m.lookAt(0,i,x,p),new r({turntable:d,orbit:o,matrix:m},f)}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(g,S,M){var e=typeof WeakMap>"u"?g("weak-map"):WeakMap,a=g("gl-buffer"),n=g("gl-vao"),r=new e;function t(h){var s=r.get(h),i=s&&(s._triangleBuffer.handle||s._triangleBuffer.buffer);if(!i||!h.isBuffer(i)){var x=a(h,new Float32Array([-1,-1,-1,4,4,-1]));s=n(h,[{buffer:x,type:h.FLOAT,size:2}]),s._triangleBuffer=x,r.set(h,s)}s.bind(),h.drawArrays(h.TRIANGLES,0,3),s.unbind()}S.exports=t},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(g,S,M){var e=g("pad-left");S.exports=a;function a(n,r,t){r=typeof r=="number"?r:1,t=t||": ";var h=n.split(/\r?\n/),s=String(h.length+r-1).length;return h.map(function(i,x){var p=x+r,v=String(p).length,f=e(p,s-v);return f+t+i}).join(`
`)}},{"pad-left":264}],10:[function(g,S,M){S.exports=n;var e=g("robust-orientation");function a(r,t){for(var h=new Array(t+1),s=0;s<r.length;++s)h[s]=r[s];for(var s=0;s<=r.length;++s){for(var i=r.length;i<=t;++i){for(var x=new Array(t),p=0;p<t;++p)x[p]=Math.pow(i+1-s,p);h[i]=x}var v=e.apply(void 0,h);if(v)return!0}return!1}function n(r){var t=r.length;if(t===0)return[];if(t===1)return[0];for(var h=r[0].length,s=[r[0]],i=[0],x=1;x<t;++x){if(s.push(r[x]),!a(s,h)){s.pop();continue}if(i.push(x),i.length===h+1)return i}return i}},{"robust-orientation":284}],11:[function(g,S,M){S.exports=n;var e=g("delaunay-triangulate"),a=g("circumradius");function n(r,t){return e(t).filter(function(h){for(var s=new Array(h.length),i=0;i<h.length;++i)s[i]=t[h[i]];return a(s)*r<1})}},{circumradius:49,"delaunay-triangulate":63}],12:[function(g,S,M){S.exports=n;var e=g("alpha-complex"),a=g("simplicial-complex-boundary");function n(r,t){return a(e(r,t))}},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(g,S,M){S.exports=function(a){return atob(a)}},{}],14:[function(g,S,M){S.exports=n;var e=g("robust-linear-solve");function a(r){for(var t=0,h=0;h<r.length;++h)t+=r[h];return t}function n(r,t){for(var h=t.length,s=new Array(h+1),i=0;i<h;++i){for(var x=new Array(h+1),p=0;p<=h;++p)x[p]=r[p][i];s[i]=x}s[h]=new Array(h+1);for(var i=0;i<=h;++i)s[h][i]=1;for(var v=new Array(h+1),i=0;i<h;++i)v[i]=t[i];v[h]=1;var f=e(s,v),d=a(f[h+1]);d===0&&(d=1);for(var o=new Array(h+1),i=0;i<=h;++i)o[i]=a(f[i])/d;return o}},{"robust-linear-solve":283}],15:[function(g,S,M){var e=g("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]).add(r[0].mul(n[1])),n[1].mul(r[1]))}},{"./lib/rationalize":25}],16:[function(g,S,M){S.exports=e;function e(a,n){return a[0].mul(n[1]).cmp(n[0].mul(a[1]))}},{}],17:[function(g,S,M){var e=g("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]),n[1].mul(r[0]))}},{"./lib/rationalize":25}],18:[function(g,S,M){var e=g("./is-rat"),a=g("./lib/is-bn"),n=g("./lib/num-to-bn"),r=g("./lib/str-to-bn"),t=g("./lib/rationalize"),h=g("./div");S.exports=s;function s(i,x){if(e(i))return x?h(i,s(x)):[i[0].clone(),i[1].clone()];var p=0,v,f;if(a(i))v=i.clone();else if(typeof i=="string")v=r(i);else{if(i===0)return[n(0),n(1)];if(i===Math.floor(i))v=n(i);else{for(;i!==Math.floor(i);)i=i*Math.pow(2,256),p-=256;v=n(i)}}if(e(x))v.mul(x[1]),f=x[0].clone();else if(a(x))f=x.clone();else if(typeof x=="string")f=r(x);else if(!x)f=n(1);else if(x===Math.floor(x))f=n(x);else{for(;x!==Math.floor(x);)x=x*Math.pow(2,256),p+=256;f=n(x)}return p>0?v=v.ushln(p):p<0&&(f=f.ushln(-p)),t(v,f)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(g,S,M){var e=g("./lib/is-bn");S.exports=a;function a(n){return Array.isArray(n)&&n.length===2&&e(n[0])&&e(n[1])}},{"./lib/is-bn":23}],20:[function(g,S,M){var e=g("bn.js");S.exports=a;function a(n){return n.cmp(new e(0))}},{"bn.js":33}],21:[function(g,S,M){var e=g("./bn-sign");S.exports=a;function a(n){var r=n.length,t=n.words,h=0;if(r===1)h=t[0];else if(r===2)h=t[0]+t[1]*67108864;else for(var s=0;s<r;s++){var i=t[s];h+=i*Math.pow(67108864,s)}return e(n)*h}},{"./bn-sign":20}],22:[function(g,S,M){var e=g("double-bits"),a=g("bit-twiddle").countTrailingZeros;S.exports=n;function n(r){var t=a(e.lo(r));if(t<32)return t;var h=a(e.hi(r));return h>20?52:h+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(g,S,M){g("bn.js"),S.exports=e;function e(a){return a&&typeof a=="object"&&!!a.words}},{"bn.js":33}],24:[function(g,S,M){var e=g("bn.js"),a=g("double-bits");S.exports=n;function n(r){var t=a.exponent(r);return t<52?new e(r):new e(r*Math.pow(2,52-t)).ushln(t-52)}},{"bn.js":33,"double-bits":64}],25:[function(g,S,M){var e=g("./num-to-bn"),a=g("./bn-sign");S.exports=n;function n(r,t){var h=a(r),s=a(t);if(h===0)return[e(0),e(1)];if(s===0)return[e(0),e(0)];s<0&&(r=r.neg(),t=t.neg());var i=r.gcd(t);return i.cmpn(1)?[r.div(i),t.div(i)]:[r,t]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(g,S,M){var e=g("bn.js");S.exports=a;function a(n){return new e(n)}},{"bn.js":33}],27:[function(g,S,M){var e=g("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[0]),n[1].mul(r[1]))}},{"./lib/rationalize":25}],28:[function(g,S,M){var e=g("./lib/bn-sign");S.exports=a;function a(n){return e(n[0])*e(n[1])}},{"./lib/bn-sign":20}],29:[function(g,S,M){var e=g("./lib/rationalize");S.exports=a;function a(n,r){return e(n[0].mul(r[1]).sub(n[1].mul(r[0])),n[1].mul(r[1]))}},{"./lib/rationalize":25}],30:[function(g,S,M){var e=g("./lib/bn-to-num"),a=g("./lib/ctz");S.exports=n;function n(r){var t=r[0],h=r[1];if(t.cmpn(0)===0)return 0;var s=t.abs().divmod(h.abs()),i=s.div,x=e(i),p=s.mod,v=t.negative!==h.negative?-1:1;if(p.cmpn(0)===0)return v*x;if(x){var f=a(x)+4,d=e(p.ushln(f).divRound(h));return v*(x+d*Math.pow(2,-f))}else{var o=h.bitLength()-p.bitLength()+53,d=e(p.ushln(o).divRound(h));return o<1023?v*d*Math.pow(2,-o):(d*=Math.pow(2,-1023),v*d*Math.pow(2,1023-o))}}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(g,S,M){function e(s,i,x,p,v){for(var f=v+1;p<=v;){var d=p+v>>>1,o=s[d],m=x!==void 0?x(o,i):o-i;m>=0?(f=d,v=d-1):p=d+1}return f}function a(s,i,x,p,v){for(var f=v+1;p<=v;){var d=p+v>>>1,o=s[d],m=x!==void 0?x(o,i):o-i;m>0?(f=d,v=d-1):p=d+1}return f}function n(s,i,x,p,v){for(var f=p-1;p<=v;){var d=p+v>>>1,o=s[d],m=x!==void 0?x(o,i):o-i;m<0?(f=d,p=d+1):v=d-1}return f}function r(s,i,x,p,v){for(var f=p-1;p<=v;){var d=p+v>>>1,o=s[d],m=x!==void 0?x(o,i):o-i;m<=0?(f=d,p=d+1):v=d-1}return f}function t(s,i,x,p,v){for(;p<=v;){var f=p+v>>>1,d=s[f],o=x!==void 0?x(d,i):d-i;if(o===0)return f;o<=0?p=f+1:v=f-1}return-1}function h(s,i,x,p,v,f){return typeof x=="function"?f(s,i,x,p===void 0?0:p|0,v===void 0?s.length-1:v|0):f(s,i,void 0,x===void 0?0:x|0,p===void 0?s.length-1:p|0)}S.exports={ge:function(s,i,x,p,v){return h(s,i,x,p,v,e)},gt:function(s,i,x,p,v){return h(s,i,x,p,v,a)},lt:function(s,i,x,p,v){return h(s,i,x,p,v,n)},le:function(s,i,x,p,v){return h(s,i,x,p,v,r)},eq:function(s,i,x,p,v){return h(s,i,x,p,v,t)}}},{}],32:[function(g,S,M){var e=32;M.INT_BITS=e,M.INT_MAX=2147483647,M.INT_MIN=-1<<e-1,M.sign=function(r){return(r>0)-(r<0)},M.abs=function(r){var t=r>>e-1;return(r^t)-t},M.min=function(r,t){return t^(r^t)&-(r<t)},M.max=function(r,t){return r^(r^t)&-(r<t)},M.isPow2=function(r){return!(r&r-1)&&!!r},M.log2=function(r){var t,h;return t=(r>65535)<<4,r>>>=t,h=(r>255)<<3,r>>>=h,t|=h,h=(r>15)<<2,r>>>=h,t|=h,h=(r>3)<<1,r>>>=h,t|=h,t|r>>1},M.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0},M.popCount=function(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),(r+(r>>>4)&252645135)*16843009>>>24};function a(r){var t=32;return r&=-r,r&&t--,r&65535&&(t-=16),r&16711935&&(t-=8),r&252645135&&(t-=4),r&858993459&&(t-=2),r&1431655765&&(t-=1),t}M.countTrailingZeros=a,M.nextPow2=function(r){return r+=r===0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1},M.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r-(r>>>1)},M.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,r&=15,27030>>>r&1};var n=new Array(256);(function(r){for(var t=0;t<256;++t){var h=t,s=t,i=7;for(h>>>=1;h;h>>>=1)s<<=1,s|=h&1,--i;r[t]=s<<i&255}})(n),M.reverse=function(r){return n[r&255]<<24|n[r>>>8&255]<<16|n[r>>>16&255]<<8|n[r>>>24&255]},M.interleave2=function(r,t){return r&=65535,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t&=65535,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1},M.deinterleave2=function(r,t){return r=r>>>t&1431655765,r=(r|r>>>1)&858993459,r=(r|r>>>2)&252645135,r=(r|r>>>4)&16711935,r=(r|r>>>16)&65535,r<<16>>16},M.interleave3=function(r,t,h){return r&=1023,r=(r|r<<16)&4278190335,r=(r|r<<8)&251719695,r=(r|r<<4)&3272356035,r=(r|r<<2)&1227133513,t&=1023,t=(t|t<<16)&4278190335,t=(t|t<<8)&251719695,t=(t|t<<4)&3272356035,t=(t|t<<2)&1227133513,r|=t<<1,h&=1023,h=(h|h<<16)&4278190335,h=(h|h<<8)&251719695,h=(h|h<<4)&3272356035,h=(h|h<<2)&1227133513,r|h<<2},M.deinterleave3=function(r,t){return r=r>>>t&1227133513,r=(r|r>>>2)&3272356035,r=(r|r>>>4)&251719695,r=(r|r>>>8)&4278190335,r=(r|r>>>16)&1023,r<<22>>22},M.nextCombination=function(r){var t=r|r-1;return t+1|(~t&-~t)-1>>>a(r)+1}},{}],33:[function(g,S,M){(function(e,a){function n(I,D){if(!I)throw new Error(D||"Assertion failed")}function r(I,D){I.super_=D;var R=function(){};R.prototype=D.prototype,I.prototype=new R,I.prototype.constructor=I}function t(I,D,R){if(t.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&((D==="le"||D==="be")&&(R=D,D=10),this._init(I||0,D||10,R||"be"))}typeof e=="object"?e.exports=t:a.BN=t,t.BN=t,t.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=g("buffer").Buffer}catch{}t.isBN=function(D){return D instanceof t?!0:D!==null&&typeof D=="object"&&D.constructor.wordSize===t.wordSize&&Array.isArray(D.words)},t.max=function(D,R){return D.cmp(R)>0?D:R},t.min=function(D,R){return D.cmp(R)<0?D:R},t.prototype._init=function(D,R,O){if(typeof D=="number")return this._initNumber(D,R,O);if(typeof D=="object")return this._initArray(D,R,O);R==="hex"&&(R=16),n(R===(R|0)&&R>=2&&R<=36),D=D.toString().replace(/\s+/g,"");var F=0;D[0]==="-"&&(F++,this.negative=1),F<D.length&&(R===16?this._parseHex(D,F,O):(this._parseBase(D,R,F),O==="le"&&this._initArray(this.toArray(),R,O)))},t.prototype._initNumber=function(D,R,O){D<0&&(this.negative=1,D=-D),D<67108864?(this.words=[D&67108863],this.length=1):D<4503599627370496?(this.words=[D&67108863,D/67108864&67108863],this.length=2):(n(D<9007199254740992),this.words=[D&67108863,D/67108864&67108863,1],this.length=3),O==="le"&&this._initArray(this.toArray(),R,O)},t.prototype._initArray=function(D,R,O){if(n(typeof D.length=="number"),D.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(D.length/3),this.words=new Array(this.length);for(var F=0;F<this.length;F++)this.words[F]=0;var N,G,K=0;if(O==="be")for(F=D.length-1,N=0;F>=0;F-=3)G=D[F]|D[F-1]<<8|D[F-2]<<16,this.words[N]|=G<<K&67108863,this.words[N+1]=G>>>26-K&67108863,K+=24,K>=26&&(K-=26,N++);else if(O==="le")for(F=0,N=0;F<D.length;F+=3)G=D[F]|D[F+1]<<8|D[F+2]<<16,this.words[N]|=G<<K&67108863,this.words[N+1]=G>>>26-K&67108863,K+=24,K>=26&&(K-=26,N++);return this.strip()};function s(I,D){var R=I.charCodeAt(D);return R>=65&&R<=70?R-55:R>=97&&R<=102?R-87:R-48&15}function i(I,D,R){var O=s(I,R);return R-1>=D&&(O|=s(I,R-1)<<4),O}t.prototype._parseHex=function(D,R,O){this.length=Math.ceil((D.length-R)/6),this.words=new Array(this.length);for(var F=0;F<this.length;F++)this.words[F]=0;var N=0,G=0,K;if(O==="be")for(F=D.length-1;F>=R;F-=2)K=i(D,R,F)<<N,this.words[G]|=K&67108863,N>=18?(N-=18,G+=1,this.words[G]|=K>>>26):N+=8;else{var W=D.length-R;for(F=W%2===0?R+1:R;F<D.length;F+=2)K=i(D,R,F)<<N,this.words[G]|=K&67108863,N>=18?(N-=18,G+=1,this.words[G]|=K>>>26):N+=8}this.strip()};function x(I,D,R,O){for(var F=0,N=Math.min(I.length,R),G=D;G<N;G++){var K=I.charCodeAt(G)-48;F*=O,K>=49?F+=K-49+10:K>=17?F+=K-17+10:F+=K}return F}t.prototype._parseBase=function(D,R,O){this.words=[0],this.length=1;for(var F=0,N=1;N<=67108863;N*=R)F++;F--,N=N/R|0;for(var G=D.length-O,K=G%F,W=Math.min(G,G-K)+O,Y=0,re=O;re<W;re+=F)Y=x(D,re,re+F,R),this.imuln(N),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y);if(K!==0){var ue=1;for(Y=x(D,re,D.length,R),re=0;re<K;re++)ue*=R;this.imuln(ue),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y)}this.strip()},t.prototype.copy=function(D){D.words=new Array(this.length);for(var R=0;R<this.length;R++)D.words[R]=this.words[R];D.length=this.length,D.negative=this.negative,D.red=this.red},t.prototype.clone=function(){var D=new t(null);return this.copy(D),D},t.prototype._expand=function(D){for(;this.length<D;)this.words[this.length++]=0;return this},t.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},t.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},t.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];t.prototype.toString=function(D,R){D=D||10,R=R|0||1;var O;if(D===16||D==="hex"){O="";for(var F=0,N=0,G=0;G<this.length;G++){var K=this.words[G],W=((K<<F|N)&16777215).toString(16);N=K>>>24-F&16777215,N!==0||G!==this.length-1?O=p[6-W.length]+W+O:O=W+O,F+=2,F>=26&&(F-=26,G--)}for(N!==0&&(O=N.toString(16)+O);O.length%R!==0;)O="0"+O;return this.negative!==0&&(O="-"+O),O}if(D===(D|0)&&D>=2&&D<=36){var Y=v[D],re=f[D];O="";var ue=this.clone();for(ue.negative=0;!ue.isZero();){var j=ue.modn(re).toString(D);ue=ue.idivn(re),ue.isZero()?O=j+O:O=p[Y-j.length]+j+O}for(this.isZero()&&(O="0"+O);O.length%R!==0;)O="0"+O;return this.negative!==0&&(O="-"+O),O}n(!1,"Base should be between 2 and 36")},t.prototype.toNumber=function(){var D=this.words[0];return this.length===2?D+=this.words[1]*67108864:this.length===3&&this.words[2]===1?D+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-D:D},t.prototype.toJSON=function(){return this.toString(16)},t.prototype.toBuffer=function(D,R){return n(typeof h<"u"),this.toArrayLike(h,D,R)},t.prototype.toArray=function(D,R){return this.toArrayLike(Array,D,R)},t.prototype.toArrayLike=function(D,R,O){var F=this.byteLength(),N=O||Math.max(1,F);n(F<=N,"byte array longer than desired length"),n(N>0,"Requested array length <= 0"),this.strip();var G=R==="le",K=new D(N),W,Y,re=this.clone();if(G){for(Y=0;!re.isZero();Y++)W=re.andln(255),re.iushrn(8),K[Y]=W;for(;Y<N;Y++)K[Y]=0}else{for(Y=0;Y<N-F;Y++)K[Y]=0;for(Y=0;!re.isZero();Y++)W=re.andln(255),re.iushrn(8),K[N-Y-1]=W}return K},Math.clz32?t.prototype._countBits=function(D){return 32-Math.clz32(D)}:t.prototype._countBits=function(D){var R=D,O=0;return R>=4096&&(O+=13,R>>>=13),R>=64&&(O+=7,R>>>=7),R>=8&&(O+=4,R>>>=4),R>=2&&(O+=2,R>>>=2),O+R},t.prototype._zeroBits=function(D){if(D===0)return 26;var R=D,O=0;return R&8191||(O+=13,R>>>=13),R&127||(O+=7,R>>>=7),R&15||(O+=4,R>>>=4),R&3||(O+=2,R>>>=2),R&1||O++,O},t.prototype.bitLength=function(){var D=this.words[this.length-1],R=this._countBits(D);return(this.length-1)*26+R};function d(I){for(var D=new Array(I.bitLength()),R=0;R<D.length;R++){var O=R/26|0,F=R%26;D[R]=(I.words[O]&1<<F)>>>F}return D}t.prototype.zeroBits=function(){if(this.isZero())return 0;for(var D=0,R=0;R<this.length;R++){var O=this._zeroBits(this.words[R]);if(D+=O,O!==26)break}return D},t.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},t.prototype.toTwos=function(D){return this.negative!==0?this.abs().inotn(D).iaddn(1):this.clone()},t.prototype.fromTwos=function(D){return this.testn(D-1)?this.notn(D).iaddn(1).ineg():this.clone()},t.prototype.isNeg=function(){return this.negative!==0},t.prototype.neg=function(){return this.clone().ineg()},t.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},t.prototype.iuor=function(D){for(;this.length<D.length;)this.words[this.length++]=0;for(var R=0;R<D.length;R++)this.words[R]=this.words[R]|D.words[R];return this.strip()},t.prototype.ior=function(D){return n((this.negative|D.negative)===0),this.iuor(D)},t.prototype.or=function(D){return this.length>D.length?this.clone().ior(D):D.clone().ior(this)},t.prototype.uor=function(D){return this.length>D.length?this.clone().iuor(D):D.clone().iuor(this)},t.prototype.iuand=function(D){var R;this.length>D.length?R=D:R=this;for(var O=0;O<R.length;O++)this.words[O]=this.words[O]&D.words[O];return this.length=R.length,this.strip()},t.prototype.iand=function(D){return n((this.negative|D.negative)===0),this.iuand(D)},t.prototype.and=function(D){return this.length>D.length?this.clone().iand(D):D.clone().iand(this)},t.prototype.uand=function(D){return this.length>D.length?this.clone().iuand(D):D.clone().iuand(this)},t.prototype.iuxor=function(D){var R,O;this.length>D.length?(R=this,O=D):(R=D,O=this);for(var F=0;F<O.length;F++)this.words[F]=R.words[F]^O.words[F];if(this!==R)for(;F<R.length;F++)this.words[F]=R.words[F];return this.length=R.length,this.strip()},t.prototype.ixor=function(D){return n((this.negative|D.negative)===0),this.iuxor(D)},t.prototype.xor=function(D){return this.length>D.length?this.clone().ixor(D):D.clone().ixor(this)},t.prototype.uxor=function(D){return this.length>D.length?this.clone().iuxor(D):D.clone().iuxor(this)},t.prototype.inotn=function(D){n(typeof D=="number"&&D>=0);var R=Math.ceil(D/26)|0,O=D%26;this._expand(R),O>0&&R--;for(var F=0;F<R;F++)this.words[F]=~this.words[F]&67108863;return O>0&&(this.words[F]=~this.words[F]&67108863>>26-O),this.strip()},t.prototype.notn=function(D){return this.clone().inotn(D)},t.prototype.setn=function(D,R){n(typeof D=="number"&&D>=0);var O=D/26|0,F=D%26;return this._expand(O+1),R?this.words[O]=this.words[O]|1<<F:this.words[O]=this.words[O]&~(1<<F),this.strip()},t.prototype.iadd=function(D){var R;if(this.negative!==0&&D.negative===0)return this.negative=0,R=this.isub(D),this.negative^=1,this._normSign();if(this.negative===0&&D.negative!==0)return D.negative=0,R=this.isub(D),D.negative=1,R._normSign();var O,F;this.length>D.length?(O=this,F=D):(O=D,F=this);for(var N=0,G=0;G<F.length;G++)R=(O.words[G]|0)+(F.words[G]|0)+N,this.words[G]=R&67108863,N=R>>>26;for(;N!==0&&G<O.length;G++)R=(O.words[G]|0)+N,this.words[G]=R&67108863,N=R>>>26;if(this.length=O.length,N!==0)this.words[this.length]=N,this.length++;else if(O!==this)for(;G<O.length;G++)this.words[G]=O.words[G];return this},t.prototype.add=function(D){var R;return D.negative!==0&&this.negative===0?(D.negative=0,R=this.sub(D),D.negative^=1,R):D.negative===0&&this.negative!==0?(this.negative=0,R=D.sub(this),this.negative=1,R):this.length>D.length?this.clone().iadd(D):D.clone().iadd(this)},t.prototype.isub=function(D){if(D.negative!==0){D.negative=0;var R=this.iadd(D);return D.negative=1,R._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(D),this.negative=1,this._normSign();var O=this.cmp(D);if(O===0)return this.negative=0,this.length=1,this.words[0]=0,this;var F,N;O>0?(F=this,N=D):(F=D,N=this);for(var G=0,K=0;K<N.length;K++)R=(F.words[K]|0)-(N.words[K]|0)+G,G=R>>26,this.words[K]=R&67108863;for(;G!==0&&K<F.length;K++)R=(F.words[K]|0)+G,G=R>>26,this.words[K]=R&67108863;if(G===0&&K<F.length&&F!==this)for(;K<F.length;K++)this.words[K]=F.words[K];return this.length=Math.max(this.length,K),F!==this&&(this.negative=1),this.strip()},t.prototype.sub=function(D){return this.clone().isub(D)};function o(I,D,R){R.negative=D.negative^I.negative;var O=I.length+D.length|0;R.length=O,O=O-1|0;var F=I.words[0]|0,N=D.words[0]|0,G=F*N,K=G&67108863,W=G/67108864|0;R.words[0]=K;for(var Y=1;Y<O;Y++){for(var re=W>>>26,ue=W&67108863,j=Math.min(Y,D.length-1),q=Math.max(0,Y-I.length+1);q<=j;q++){var H=Y-q|0;F=I.words[H]|0,N=D.words[q]|0,G=F*N+ue,re+=G/67108864|0,ue=G&67108863}R.words[Y]=ue|0,W=re|0}return W!==0?R.words[Y]=W|0:R.length--,R.strip()}var m=function(D,R,O){var F=D.words,N=R.words,G=O.words,K=0,W,Y,re,ue=F[0]|0,j=ue&8191,q=ue>>>13,H=F[1]|0,U=H&8191,$=H>>>13,ne=F[2]|0,X=ne&8191,Q=ne>>>13,ie=F[3]|0,se=ie&8191,ae=ie>>>13,oe=F[4]|0,be=oe&8191,ce=oe>>>13,de=F[5]|0,ye=de&8191,ge=de>>>13,me=F[6]|0,Ee=me&8191,Pe=me>>>13,Ue=F[7]|0,we=Ue&8191,ke=Ue>>>13,Xe=F[8]|0,Ve=Xe&8191,Ie=Xe>>>13,De=F[9]|0,Ye=De&8191,vt=De>>>13,Dt=N[0]|0,Kt=Dt&8191,Ft=Dt>>>13,Mt=N[1]|0,Xt=Mt&8191,It=Mt>>>13,At=N[2]|0,Ge=At&8191,tt=At>>>13,He=N[3]|0,Ae=He&8191,Ne=He>>>13,Ze=N[4]|0,Qe=Ze&8191,bt=Ze>>>13,dt=N[5]|0,wt=dt&8191,Ut=dt>>>13,Rt=N[6]|0,Nt=Rt&8191,Wt=Rt>>>13,Vt=N[7]|0,ir=Vt&8191,Hr=Vt>>>13,sn=N[8]|0,jr=sn&8191,at=sn>>>13,$t=N[9]|0,Jt=$t&8191,Gt=$t>>>13;O.negative=D.negative^R.negative,O.length=19,W=Math.imul(j,Kt),Y=Math.imul(j,Ft),Y=Y+Math.imul(q,Kt)|0,re=Math.imul(q,Ft);var _r=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(_r>>>26)|0,_r&=67108863,W=Math.imul(U,Kt),Y=Math.imul(U,Ft),Y=Y+Math.imul($,Kt)|0,re=Math.imul($,Ft),W=W+Math.imul(j,Xt)|0,Y=Y+Math.imul(j,It)|0,Y=Y+Math.imul(q,Xt)|0,re=re+Math.imul(q,It)|0;var rt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(rt>>>26)|0,rt&=67108863,W=Math.imul(X,Kt),Y=Math.imul(X,Ft),Y=Y+Math.imul(Q,Kt)|0,re=Math.imul(Q,Ft),W=W+Math.imul(U,Xt)|0,Y=Y+Math.imul(U,It)|0,Y=Y+Math.imul($,Xt)|0,re=re+Math.imul($,It)|0,W=W+Math.imul(j,Ge)|0,Y=Y+Math.imul(j,tt)|0,Y=Y+Math.imul(q,Ge)|0,re=re+Math.imul(q,tt)|0;var Je=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Je>>>26)|0,Je&=67108863,W=Math.imul(se,Kt),Y=Math.imul(se,Ft),Y=Y+Math.imul(ae,Kt)|0,re=Math.imul(ae,Ft),W=W+Math.imul(X,Xt)|0,Y=Y+Math.imul(X,It)|0,Y=Y+Math.imul(Q,Xt)|0,re=re+Math.imul(Q,It)|0,W=W+Math.imul(U,Ge)|0,Y=Y+Math.imul(U,tt)|0,Y=Y+Math.imul($,Ge)|0,re=re+Math.imul($,tt)|0,W=W+Math.imul(j,Ae)|0,Y=Y+Math.imul(j,Ne)|0,Y=Y+Math.imul(q,Ae)|0,re=re+Math.imul(q,Ne)|0;var st=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(st>>>26)|0,st&=67108863,W=Math.imul(be,Kt),Y=Math.imul(be,Ft),Y=Y+Math.imul(ce,Kt)|0,re=Math.imul(ce,Ft),W=W+Math.imul(se,Xt)|0,Y=Y+Math.imul(se,It)|0,Y=Y+Math.imul(ae,Xt)|0,re=re+Math.imul(ae,It)|0,W=W+Math.imul(X,Ge)|0,Y=Y+Math.imul(X,tt)|0,Y=Y+Math.imul(Q,Ge)|0,re=re+Math.imul(Q,tt)|0,W=W+Math.imul(U,Ae)|0,Y=Y+Math.imul(U,Ne)|0,Y=Y+Math.imul($,Ae)|0,re=re+Math.imul($,Ne)|0,W=W+Math.imul(j,Qe)|0,Y=Y+Math.imul(j,bt)|0,Y=Y+Math.imul(q,Qe)|0,re=re+Math.imul(q,bt)|0;var lt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(lt>>>26)|0,lt&=67108863,W=Math.imul(ye,Kt),Y=Math.imul(ye,Ft),Y=Y+Math.imul(ge,Kt)|0,re=Math.imul(ge,Ft),W=W+Math.imul(be,Xt)|0,Y=Y+Math.imul(be,It)|0,Y=Y+Math.imul(ce,Xt)|0,re=re+Math.imul(ce,It)|0,W=W+Math.imul(se,Ge)|0,Y=Y+Math.imul(se,tt)|0,Y=Y+Math.imul(ae,Ge)|0,re=re+Math.imul(ae,tt)|0,W=W+Math.imul(X,Ae)|0,Y=Y+Math.imul(X,Ne)|0,Y=Y+Math.imul(Q,Ae)|0,re=re+Math.imul(Q,Ne)|0,W=W+Math.imul(U,Qe)|0,Y=Y+Math.imul(U,bt)|0,Y=Y+Math.imul($,Qe)|0,re=re+Math.imul($,bt)|0,W=W+Math.imul(j,wt)|0,Y=Y+Math.imul(j,Ut)|0,Y=Y+Math.imul(q,wt)|0,re=re+Math.imul(q,Ut)|0;var Tt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,W=Math.imul(Ee,Kt),Y=Math.imul(Ee,Ft),Y=Y+Math.imul(Pe,Kt)|0,re=Math.imul(Pe,Ft),W=W+Math.imul(ye,Xt)|0,Y=Y+Math.imul(ye,It)|0,Y=Y+Math.imul(ge,Xt)|0,re=re+Math.imul(ge,It)|0,W=W+Math.imul(be,Ge)|0,Y=Y+Math.imul(be,tt)|0,Y=Y+Math.imul(ce,Ge)|0,re=re+Math.imul(ce,tt)|0,W=W+Math.imul(se,Ae)|0,Y=Y+Math.imul(se,Ne)|0,Y=Y+Math.imul(ae,Ae)|0,re=re+Math.imul(ae,Ne)|0,W=W+Math.imul(X,Qe)|0,Y=Y+Math.imul(X,bt)|0,Y=Y+Math.imul(Q,Qe)|0,re=re+Math.imul(Q,bt)|0,W=W+Math.imul(U,wt)|0,Y=Y+Math.imul(U,Ut)|0,Y=Y+Math.imul($,wt)|0,re=re+Math.imul($,Ut)|0,W=W+Math.imul(j,Nt)|0,Y=Y+Math.imul(j,Wt)|0,Y=Y+Math.imul(q,Nt)|0,re=re+Math.imul(q,Wt)|0;var zt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(zt>>>26)|0,zt&=67108863,W=Math.imul(we,Kt),Y=Math.imul(we,Ft),Y=Y+Math.imul(ke,Kt)|0,re=Math.imul(ke,Ft),W=W+Math.imul(Ee,Xt)|0,Y=Y+Math.imul(Ee,It)|0,Y=Y+Math.imul(Pe,Xt)|0,re=re+Math.imul(Pe,It)|0,W=W+Math.imul(ye,Ge)|0,Y=Y+Math.imul(ye,tt)|0,Y=Y+Math.imul(ge,Ge)|0,re=re+Math.imul(ge,tt)|0,W=W+Math.imul(be,Ae)|0,Y=Y+Math.imul(be,Ne)|0,Y=Y+Math.imul(ce,Ae)|0,re=re+Math.imul(ce,Ne)|0,W=W+Math.imul(se,Qe)|0,Y=Y+Math.imul(se,bt)|0,Y=Y+Math.imul(ae,Qe)|0,re=re+Math.imul(ae,bt)|0,W=W+Math.imul(X,wt)|0,Y=Y+Math.imul(X,Ut)|0,Y=Y+Math.imul(Q,wt)|0,re=re+Math.imul(Q,Ut)|0,W=W+Math.imul(U,Nt)|0,Y=Y+Math.imul(U,Wt)|0,Y=Y+Math.imul($,Nt)|0,re=re+Math.imul($,Wt)|0,W=W+Math.imul(j,ir)|0,Y=Y+Math.imul(j,Hr)|0,Y=Y+Math.imul(q,ir)|0,re=re+Math.imul(q,Hr)|0;var Ce=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,W=Math.imul(Ve,Kt),Y=Math.imul(Ve,Ft),Y=Y+Math.imul(Ie,Kt)|0,re=Math.imul(Ie,Ft),W=W+Math.imul(we,Xt)|0,Y=Y+Math.imul(we,It)|0,Y=Y+Math.imul(ke,Xt)|0,re=re+Math.imul(ke,It)|0,W=W+Math.imul(Ee,Ge)|0,Y=Y+Math.imul(Ee,tt)|0,Y=Y+Math.imul(Pe,Ge)|0,re=re+Math.imul(Pe,tt)|0,W=W+Math.imul(ye,Ae)|0,Y=Y+Math.imul(ye,Ne)|0,Y=Y+Math.imul(ge,Ae)|0,re=re+Math.imul(ge,Ne)|0,W=W+Math.imul(be,Qe)|0,Y=Y+Math.imul(be,bt)|0,Y=Y+Math.imul(ce,Qe)|0,re=re+Math.imul(ce,bt)|0,W=W+Math.imul(se,wt)|0,Y=Y+Math.imul(se,Ut)|0,Y=Y+Math.imul(ae,wt)|0,re=re+Math.imul(ae,Ut)|0,W=W+Math.imul(X,Nt)|0,Y=Y+Math.imul(X,Wt)|0,Y=Y+Math.imul(Q,Nt)|0,re=re+Math.imul(Q,Wt)|0,W=W+Math.imul(U,ir)|0,Y=Y+Math.imul(U,Hr)|0,Y=Y+Math.imul($,ir)|0,re=re+Math.imul($,Hr)|0,W=W+Math.imul(j,jr)|0,Y=Y+Math.imul(j,at)|0,Y=Y+Math.imul(q,jr)|0,re=re+Math.imul(q,at)|0;var Se=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Se>>>26)|0,Se&=67108863,W=Math.imul(Ye,Kt),Y=Math.imul(Ye,Ft),Y=Y+Math.imul(vt,Kt)|0,re=Math.imul(vt,Ft),W=W+Math.imul(Ve,Xt)|0,Y=Y+Math.imul(Ve,It)|0,Y=Y+Math.imul(Ie,Xt)|0,re=re+Math.imul(Ie,It)|0,W=W+Math.imul(we,Ge)|0,Y=Y+Math.imul(we,tt)|0,Y=Y+Math.imul(ke,Ge)|0,re=re+Math.imul(ke,tt)|0,W=W+Math.imul(Ee,Ae)|0,Y=Y+Math.imul(Ee,Ne)|0,Y=Y+Math.imul(Pe,Ae)|0,re=re+Math.imul(Pe,Ne)|0,W=W+Math.imul(ye,Qe)|0,Y=Y+Math.imul(ye,bt)|0,Y=Y+Math.imul(ge,Qe)|0,re=re+Math.imul(ge,bt)|0,W=W+Math.imul(be,wt)|0,Y=Y+Math.imul(be,Ut)|0,Y=Y+Math.imul(ce,wt)|0,re=re+Math.imul(ce,Ut)|0,W=W+Math.imul(se,Nt)|0,Y=Y+Math.imul(se,Wt)|0,Y=Y+Math.imul(ae,Nt)|0,re=re+Math.imul(ae,Wt)|0,W=W+Math.imul(X,ir)|0,Y=Y+Math.imul(X,Hr)|0,Y=Y+Math.imul(Q,ir)|0,re=re+Math.imul(Q,Hr)|0,W=W+Math.imul(U,jr)|0,Y=Y+Math.imul(U,at)|0,Y=Y+Math.imul($,jr)|0,re=re+Math.imul($,at)|0,W=W+Math.imul(j,Jt)|0,Y=Y+Math.imul(j,Gt)|0,Y=Y+Math.imul(q,Jt)|0,re=re+Math.imul(q,Gt)|0;var nt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(nt>>>26)|0,nt&=67108863,W=Math.imul(Ye,Xt),Y=Math.imul(Ye,It),Y=Y+Math.imul(vt,Xt)|0,re=Math.imul(vt,It),W=W+Math.imul(Ve,Ge)|0,Y=Y+Math.imul(Ve,tt)|0,Y=Y+Math.imul(Ie,Ge)|0,re=re+Math.imul(Ie,tt)|0,W=W+Math.imul(we,Ae)|0,Y=Y+Math.imul(we,Ne)|0,Y=Y+Math.imul(ke,Ae)|0,re=re+Math.imul(ke,Ne)|0,W=W+Math.imul(Ee,Qe)|0,Y=Y+Math.imul(Ee,bt)|0,Y=Y+Math.imul(Pe,Qe)|0,re=re+Math.imul(Pe,bt)|0,W=W+Math.imul(ye,wt)|0,Y=Y+Math.imul(ye,Ut)|0,Y=Y+Math.imul(ge,wt)|0,re=re+Math.imul(ge,Ut)|0,W=W+Math.imul(be,Nt)|0,Y=Y+Math.imul(be,Wt)|0,Y=Y+Math.imul(ce,Nt)|0,re=re+Math.imul(ce,Wt)|0,W=W+Math.imul(se,ir)|0,Y=Y+Math.imul(se,Hr)|0,Y=Y+Math.imul(ae,ir)|0,re=re+Math.imul(ae,Hr)|0,W=W+Math.imul(X,jr)|0,Y=Y+Math.imul(X,at)|0,Y=Y+Math.imul(Q,jr)|0,re=re+Math.imul(Q,at)|0,W=W+Math.imul(U,Jt)|0,Y=Y+Math.imul(U,Gt)|0,Y=Y+Math.imul($,Jt)|0,re=re+Math.imul($,Gt)|0;var it=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(it>>>26)|0,it&=67108863,W=Math.imul(Ye,Ge),Y=Math.imul(Ye,tt),Y=Y+Math.imul(vt,Ge)|0,re=Math.imul(vt,tt),W=W+Math.imul(Ve,Ae)|0,Y=Y+Math.imul(Ve,Ne)|0,Y=Y+Math.imul(Ie,Ae)|0,re=re+Math.imul(Ie,Ne)|0,W=W+Math.imul(we,Qe)|0,Y=Y+Math.imul(we,bt)|0,Y=Y+Math.imul(ke,Qe)|0,re=re+Math.imul(ke,bt)|0,W=W+Math.imul(Ee,wt)|0,Y=Y+Math.imul(Ee,Ut)|0,Y=Y+Math.imul(Pe,wt)|0,re=re+Math.imul(Pe,Ut)|0,W=W+Math.imul(ye,Nt)|0,Y=Y+Math.imul(ye,Wt)|0,Y=Y+Math.imul(ge,Nt)|0,re=re+Math.imul(ge,Wt)|0,W=W+Math.imul(be,ir)|0,Y=Y+Math.imul(be,Hr)|0,Y=Y+Math.imul(ce,ir)|0,re=re+Math.imul(ce,Hr)|0,W=W+Math.imul(se,jr)|0,Y=Y+Math.imul(se,at)|0,Y=Y+Math.imul(ae,jr)|0,re=re+Math.imul(ae,at)|0,W=W+Math.imul(X,Jt)|0,Y=Y+Math.imul(X,Gt)|0,Y=Y+Math.imul(Q,Jt)|0,re=re+Math.imul(Q,Gt)|0;var ct=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(ct>>>26)|0,ct&=67108863,W=Math.imul(Ye,Ae),Y=Math.imul(Ye,Ne),Y=Y+Math.imul(vt,Ae)|0,re=Math.imul(vt,Ne),W=W+Math.imul(Ve,Qe)|0,Y=Y+Math.imul(Ve,bt)|0,Y=Y+Math.imul(Ie,Qe)|0,re=re+Math.imul(Ie,bt)|0,W=W+Math.imul(we,wt)|0,Y=Y+Math.imul(we,Ut)|0,Y=Y+Math.imul(ke,wt)|0,re=re+Math.imul(ke,Ut)|0,W=W+Math.imul(Ee,Nt)|0,Y=Y+Math.imul(Ee,Wt)|0,Y=Y+Math.imul(Pe,Nt)|0,re=re+Math.imul(Pe,Wt)|0,W=W+Math.imul(ye,ir)|0,Y=Y+Math.imul(ye,Hr)|0,Y=Y+Math.imul(ge,ir)|0,re=re+Math.imul(ge,Hr)|0,W=W+Math.imul(be,jr)|0,Y=Y+Math.imul(be,at)|0,Y=Y+Math.imul(ce,jr)|0,re=re+Math.imul(ce,at)|0,W=W+Math.imul(se,Jt)|0,Y=Y+Math.imul(se,Gt)|0,Y=Y+Math.imul(ae,Jt)|0,re=re+Math.imul(ae,Gt)|0;var kt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(kt>>>26)|0,kt&=67108863,W=Math.imul(Ye,Qe),Y=Math.imul(Ye,bt),Y=Y+Math.imul(vt,Qe)|0,re=Math.imul(vt,bt),W=W+Math.imul(Ve,wt)|0,Y=Y+Math.imul(Ve,Ut)|0,Y=Y+Math.imul(Ie,wt)|0,re=re+Math.imul(Ie,Ut)|0,W=W+Math.imul(we,Nt)|0,Y=Y+Math.imul(we,Wt)|0,Y=Y+Math.imul(ke,Nt)|0,re=re+Math.imul(ke,Wt)|0,W=W+Math.imul(Ee,ir)|0,Y=Y+Math.imul(Ee,Hr)|0,Y=Y+Math.imul(Pe,ir)|0,re=re+Math.imul(Pe,Hr)|0,W=W+Math.imul(ye,jr)|0,Y=Y+Math.imul(ye,at)|0,Y=Y+Math.imul(ge,jr)|0,re=re+Math.imul(ge,at)|0,W=W+Math.imul(be,Jt)|0,Y=Y+Math.imul(be,Gt)|0,Y=Y+Math.imul(ce,Jt)|0,re=re+Math.imul(ce,Gt)|0;var gt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(gt>>>26)|0,gt&=67108863,W=Math.imul(Ye,wt),Y=Math.imul(Ye,Ut),Y=Y+Math.imul(vt,wt)|0,re=Math.imul(vt,Ut),W=W+Math.imul(Ve,Nt)|0,Y=Y+Math.imul(Ve,Wt)|0,Y=Y+Math.imul(Ie,Nt)|0,re=re+Math.imul(Ie,Wt)|0,W=W+Math.imul(we,ir)|0,Y=Y+Math.imul(we,Hr)|0,Y=Y+Math.imul(ke,ir)|0,re=re+Math.imul(ke,Hr)|0,W=W+Math.imul(Ee,jr)|0,Y=Y+Math.imul(Ee,at)|0,Y=Y+Math.imul(Pe,jr)|0,re=re+Math.imul(Pe,at)|0,W=W+Math.imul(ye,Jt)|0,Y=Y+Math.imul(ye,Gt)|0,Y=Y+Math.imul(ge,Jt)|0,re=re+Math.imul(ge,Gt)|0;var St=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(St>>>26)|0,St&=67108863,W=Math.imul(Ye,Nt),Y=Math.imul(Ye,Wt),Y=Y+Math.imul(vt,Nt)|0,re=Math.imul(vt,Wt),W=W+Math.imul(Ve,ir)|0,Y=Y+Math.imul(Ve,Hr)|0,Y=Y+Math.imul(Ie,ir)|0,re=re+Math.imul(Ie,Hr)|0,W=W+Math.imul(we,jr)|0,Y=Y+Math.imul(we,at)|0,Y=Y+Math.imul(ke,jr)|0,re=re+Math.imul(ke,at)|0,W=W+Math.imul(Ee,Jt)|0,Y=Y+Math.imul(Ee,Gt)|0,Y=Y+Math.imul(Pe,Jt)|0,re=re+Math.imul(Pe,Gt)|0;var Yt=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,W=Math.imul(Ye,ir),Y=Math.imul(Ye,Hr),Y=Y+Math.imul(vt,ir)|0,re=Math.imul(vt,Hr),W=W+Math.imul(Ve,jr)|0,Y=Y+Math.imul(Ve,at)|0,Y=Y+Math.imul(Ie,jr)|0,re=re+Math.imul(Ie,at)|0,W=W+Math.imul(we,Jt)|0,Y=Y+Math.imul(we,Gt)|0,Y=Y+Math.imul(ke,Jt)|0,re=re+Math.imul(ke,Gt)|0;var ar=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(ar>>>26)|0,ar&=67108863,W=Math.imul(Ye,jr),Y=Math.imul(Ye,at),Y=Y+Math.imul(vt,jr)|0,re=Math.imul(vt,at),W=W+Math.imul(Ve,Jt)|0,Y=Y+Math.imul(Ve,Gt)|0,Y=Y+Math.imul(Ie,Jt)|0,re=re+Math.imul(Ie,Gt)|0;var kr=(K+W|0)+((Y&8191)<<13)|0;K=(re+(Y>>>13)|0)+(kr>>>26)|0,kr&=67108863,W=Math.imul(Ye,Jt),Y=Math.imul(Ye,Gt),Y=Y+Math.imul(vt,Jt)|0,re=Math.imul(vt,Gt);var br=(K+W|0)+((Y&8191)<<13)|0;return K=(re+(Y>>>13)|0)+(br>>>26)|0,br&=67108863,G[0]=_r,G[1]=rt,G[2]=Je,G[3]=st,G[4]=lt,G[5]=Tt,G[6]=zt,G[7]=Ce,G[8]=Se,G[9]=nt,G[10]=it,G[11]=ct,G[12]=kt,G[13]=gt,G[14]=St,G[15]=Yt,G[16]=ar,G[17]=kr,G[18]=br,K!==0&&(G[19]=K,O.length++),O};Math.imul||(m=o);function l(I,D,R){R.negative=D.negative^I.negative,R.length=I.length+D.length;for(var O=0,F=0,N=0;N<R.length-1;N++){var G=F;F=0;for(var K=O&67108863,W=Math.min(N,D.length-1),Y=Math.max(0,N-I.length+1);Y<=W;Y++){var re=N-Y,ue=I.words[re]|0,j=D.words[Y]|0,q=ue*j,H=q&67108863;G=G+(q/67108864|0)|0,H=H+K|0,K=H&67108863,G=G+(H>>>26)|0,F+=G>>>26,G&=67108863}R.words[N]=K,O=G,G=F}return O!==0?R.words[N]=O:R.length--,R.strip()}function w(I,D,R){var O=new _;return O.mulp(I,D,R)}t.prototype.mulTo=function(D,R){var O,F=this.length+D.length;return this.length===10&&D.length===10?O=m(this,D,R):F<63?O=o(this,D,R):F<1024?O=l(this,D,R):O=w(this,D,R),O};function _(I,D){this.x=I,this.y=D}_.prototype.makeRBT=function(D){for(var R=new Array(D),O=t.prototype._countBits(D)-1,F=0;F<D;F++)R[F]=this.revBin(F,O,D);return R},_.prototype.revBin=function(D,R,O){if(D===0||D===O-1)return D;for(var F=0,N=0;N<R;N++)F|=(D&1)<<R-N-1,D>>=1;return F},_.prototype.permute=function(D,R,O,F,N,G){for(var K=0;K<G;K++)F[K]=R[D[K]],N[K]=O[D[K]]},_.prototype.transform=function(D,R,O,F,N,G){this.permute(G,D,R,O,F,N);for(var K=1;K<N;K<<=1)for(var W=K<<1,Y=Math.cos(2*Math.PI/W),re=Math.sin(2*Math.PI/W),ue=0;ue<N;ue+=W)for(var j=Y,q=re,H=0;H<K;H++){var U=O[ue+H],$=F[ue+H],ne=O[ue+H+K],X=F[ue+H+K],Q=j*ne-q*X;X=j*X+q*ne,ne=Q,O[ue+H]=U+ne,F[ue+H]=$+X,O[ue+H+K]=U-ne,F[ue+H+K]=$-X,H!==W&&(Q=Y*j-re*q,q=Y*q+re*j,j=Q)}},_.prototype.guessLen13b=function(D,R){var O=Math.max(R,D)|1,F=O&1,N=0;for(O=O/2|0;O;O=O>>>1)N++;return 1<<N+1+F},_.prototype.conjugate=function(D,R,O){if(!(O<=1))for(var F=0;F<O/2;F++){var N=D[F];D[F]=D[O-F-1],D[O-F-1]=N,N=R[F],R[F]=-R[O-F-1],R[O-F-1]=-N}},_.prototype.normalize13b=function(D,R){for(var O=0,F=0;F<R/2;F++){var N=Math.round(D[2*F+1]/R)*8192+Math.round(D[2*F]/R)+O;D[F]=N&67108863,N<67108864?O=0:O=N/67108864|0}return D},_.prototype.convert13b=function(D,R,O,F){for(var N=0,G=0;G<R;G++)N=N+(D[G]|0),O[2*G]=N&8191,N=N>>>13,O[2*G+1]=N&8191,N=N>>>13;for(G=2*R;G<F;++G)O[G]=0;n(N===0),n((N&-8192)===0)},_.prototype.stub=function(D){for(var R=new Array(D),O=0;O<D;O++)R[O]=0;return R},_.prototype.mulp=function(D,R,O){var F=2*this.guessLen13b(D.length,R.length),N=this.makeRBT(F),G=this.stub(F),K=new Array(F),W=new Array(F),Y=new Array(F),re=new Array(F),ue=new Array(F),j=new Array(F),q=O.words;q.length=F,this.convert13b(D.words,D.length,K,F),this.convert13b(R.words,R.length,re,F),this.transform(K,G,W,Y,F,N),this.transform(re,G,ue,j,F,N);for(var H=0;H<F;H++){var U=W[H]*ue[H]-Y[H]*j[H];Y[H]=W[H]*j[H]+Y[H]*ue[H],W[H]=U}return this.conjugate(W,Y,F),this.transform(W,Y,q,G,F,N),this.conjugate(q,G,F),this.normalize13b(q,F),O.negative=D.negative^R.negative,O.length=D.length+R.length,O.strip()},t.prototype.mul=function(D){var R=new t(null);return R.words=new Array(this.length+D.length),this.mulTo(D,R)},t.prototype.mulf=function(D){var R=new t(null);return R.words=new Array(this.length+D.length),w(this,D,R)},t.prototype.imul=function(D){return this.clone().mulTo(D,this)},t.prototype.imuln=function(D){n(typeof D=="number"),n(D<67108864);for(var R=0,O=0;O<this.length;O++){var F=(this.words[O]|0)*D,N=(F&67108863)+(R&67108863);R>>=26,R+=F/67108864|0,R+=N>>>26,this.words[O]=N&67108863}return R!==0&&(this.words[O]=R,this.length++),this},t.prototype.muln=function(D){return this.clone().imuln(D)},t.prototype.sqr=function(){return this.mul(this)},t.prototype.isqr=function(){return this.imul(this.clone())},t.prototype.pow=function(D){var R=d(D);if(R.length===0)return new t(1);for(var O=this,F=0;F<R.length&&R[F]===0;F++,O=O.sqr());if(++F<R.length)for(var N=O.sqr();F<R.length;F++,N=N.sqr())R[F]!==0&&(O=O.mul(N));return O},t.prototype.iushln=function(D){n(typeof D=="number"&&D>=0);var R=D%26,O=(D-R)/26,F=67108863>>>26-R<<26-R,N;if(R!==0){var G=0;for(N=0;N<this.length;N++){var K=this.words[N]&F,W=(this.words[N]|0)-K<<R;this.words[N]=W|G,G=K>>>26-R}G&&(this.words[N]=G,this.length++)}if(O!==0){for(N=this.length-1;N>=0;N--)this.words[N+O]=this.words[N];for(N=0;N<O;N++)this.words[N]=0;this.length+=O}return this.strip()},t.prototype.ishln=function(D){return n(this.negative===0),this.iushln(D)},t.prototype.iushrn=function(D,R,O){n(typeof D=="number"&&D>=0);var F;R?F=(R-R%26)/26:F=0;var N=D%26,G=Math.min((D-N)/26,this.length),K=67108863^67108863>>>N<<N,W=O;if(F-=G,F=Math.max(0,F),W){for(var Y=0;Y<G;Y++)W.words[Y]=this.words[Y];W.length=G}if(G!==0)if(this.length>G)for(this.length-=G,Y=0;Y<this.length;Y++)this.words[Y]=this.words[Y+G];else this.words[0]=0,this.length=1;var re=0;for(Y=this.length-1;Y>=0&&(re!==0||Y>=F);Y--){var ue=this.words[Y]|0;this.words[Y]=re<<26-N|ue>>>N,re=ue&K}return W&&re!==0&&(W.words[W.length++]=re),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},t.prototype.ishrn=function(D,R,O){return n(this.negative===0),this.iushrn(D,R,O)},t.prototype.shln=function(D){return this.clone().ishln(D)},t.prototype.ushln=function(D){return this.clone().iushln(D)},t.prototype.shrn=function(D){return this.clone().ishrn(D)},t.prototype.ushrn=function(D){return this.clone().iushrn(D)},t.prototype.testn=function(D){n(typeof D=="number"&&D>=0);var R=D%26,O=(D-R)/26,F=1<<R;if(this.length<=O)return!1;var N=this.words[O];return!!(N&F)},t.prototype.imaskn=function(D){n(typeof D=="number"&&D>=0);var R=D%26,O=(D-R)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=O)return this;if(R!==0&&O++,this.length=Math.min(O,this.length),R!==0){var F=67108863^67108863>>>R<<R;this.words[this.length-1]&=F}return this.strip()},t.prototype.maskn=function(D){return this.clone().imaskn(D)},t.prototype.iaddn=function(D){return n(typeof D=="number"),n(D<67108864),D<0?this.isubn(-D):this.negative!==0?this.length===1&&(this.words[0]|0)<D?(this.words[0]=D-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(D),this.negative=1,this):this._iaddn(D)},t.prototype._iaddn=function(D){this.words[0]+=D;for(var R=0;R<this.length&&this.words[R]>=67108864;R++)this.words[R]-=67108864,R===this.length-1?this.words[R+1]=1:this.words[R+1]++;return this.length=Math.max(this.length,R+1),this},t.prototype.isubn=function(D){if(n(typeof D=="number"),n(D<67108864),D<0)return this.iaddn(-D);if(this.negative!==0)return this.negative=0,this.iaddn(D),this.negative=1,this;if(this.words[0]-=D,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var R=0;R<this.length&&this.words[R]<0;R++)this.words[R]+=67108864,this.words[R+1]-=1;return this.strip()},t.prototype.addn=function(D){return this.clone().iaddn(D)},t.prototype.subn=function(D){return this.clone().isubn(D)},t.prototype.iabs=function(){return this.negative=0,this},t.prototype.abs=function(){return this.clone().iabs()},t.prototype._ishlnsubmul=function(D,R,O){var F=D.length+O,N;this._expand(F);var G,K=0;for(N=0;N<D.length;N++){G=(this.words[N+O]|0)+K;var W=(D.words[N]|0)*R;G-=W&67108863,K=(G>>26)-(W/67108864|0),this.words[N+O]=G&67108863}for(;N<this.length-O;N++)G=(this.words[N+O]|0)+K,K=G>>26,this.words[N+O]=G&67108863;if(K===0)return this.strip();for(n(K===-1),K=0,N=0;N<this.length;N++)G=-(this.words[N]|0)+K,K=G>>26,this.words[N]=G&67108863;return this.negative=1,this.strip()},t.prototype._wordDiv=function(D,R){var O=this.length-D.length,F=this.clone(),N=D,G=N.words[N.length-1]|0,K=this._countBits(G);O=26-K,O!==0&&(N=N.ushln(O),F.iushln(O),G=N.words[N.length-1]|0);var W=F.length-N.length,Y;if(R!=="mod"){Y=new t(null),Y.length=W+1,Y.words=new Array(Y.length);for(var re=0;re<Y.length;re++)Y.words[re]=0}var ue=F.clone()._ishlnsubmul(N,1,W);ue.negative===0&&(F=ue,Y&&(Y.words[W]=1));for(var j=W-1;j>=0;j--){var q=(F.words[N.length+j]|0)*67108864+(F.words[N.length+j-1]|0);for(q=Math.min(q/G|0,67108863),F._ishlnsubmul(N,q,j);F.negative!==0;)q--,F.negative=0,F._ishlnsubmul(N,1,j),F.isZero()||(F.negative^=1);Y&&(Y.words[j]=q)}return Y&&Y.strip(),F.strip(),R!=="div"&&O!==0&&F.iushrn(O),{div:Y||null,mod:F}},t.prototype.divmod=function(D,R,O){if(n(!D.isZero()),this.isZero())return{div:new t(0),mod:new t(0)};var F,N,G;return this.negative!==0&&D.negative===0?(G=this.neg().divmod(D,R),R!=="mod"&&(F=G.div.neg()),R!=="div"&&(N=G.mod.neg(),O&&N.negative!==0&&N.iadd(D)),{div:F,mod:N}):this.negative===0&&D.negative!==0?(G=this.divmod(D.neg(),R),R!=="mod"&&(F=G.div.neg()),{div:F,mod:G.mod}):this.negative&D.negative?(G=this.neg().divmod(D.neg(),R),R!=="div"&&(N=G.mod.neg(),O&&N.negative!==0&&N.isub(D)),{div:G.div,mod:N}):D.length>this.length||this.cmp(D)<0?{div:new t(0),mod:this}:D.length===1?R==="div"?{div:this.divn(D.words[0]),mod:null}:R==="mod"?{div:null,mod:new t(this.modn(D.words[0]))}:{div:this.divn(D.words[0]),mod:new t(this.modn(D.words[0]))}:this._wordDiv(D,R)},t.prototype.div=function(D){return this.divmod(D,"div",!1).div},t.prototype.mod=function(D){return this.divmod(D,"mod",!1).mod},t.prototype.umod=function(D){return this.divmod(D,"mod",!0).mod},t.prototype.divRound=function(D){var R=this.divmod(D);if(R.mod.isZero())return R.div;var O=R.div.negative!==0?R.mod.isub(D):R.mod,F=D.ushrn(1),N=D.andln(1),G=O.cmp(F);return G<0||N===1&&G===0?R.div:R.div.negative!==0?R.div.isubn(1):R.div.iaddn(1)},t.prototype.modn=function(D){n(D<=67108863);for(var R=(1<<26)%D,O=0,F=this.length-1;F>=0;F--)O=(R*O+(this.words[F]|0))%D;return O},t.prototype.idivn=function(D){n(D<=67108863);for(var R=0,O=this.length-1;O>=0;O--){var F=(this.words[O]|0)+R*67108864;this.words[O]=F/D|0,R=F%D}return this.strip()},t.prototype.divn=function(D){return this.clone().idivn(D)},t.prototype.egcd=function(D){n(D.negative===0),n(!D.isZero());var R=this,O=D.clone();R.negative!==0?R=R.umod(D):R=R.clone();for(var F=new t(1),N=new t(0),G=new t(0),K=new t(1),W=0;R.isEven()&&O.isEven();)R.iushrn(1),O.iushrn(1),++W;for(var Y=O.clone(),re=R.clone();!R.isZero();){for(var ue=0,j=1;!(R.words[0]&j)&&ue<26;++ue,j<<=1);if(ue>0)for(R.iushrn(ue);ue-- >0;)(F.isOdd()||N.isOdd())&&(F.iadd(Y),N.isub(re)),F.iushrn(1),N.iushrn(1);for(var q=0,H=1;!(O.words[0]&H)&&q<26;++q,H<<=1);if(q>0)for(O.iushrn(q);q-- >0;)(G.isOdd()||K.isOdd())&&(G.iadd(Y),K.isub(re)),G.iushrn(1),K.iushrn(1);R.cmp(O)>=0?(R.isub(O),F.isub(G),N.isub(K)):(O.isub(R),G.isub(F),K.isub(N))}return{a:G,b:K,gcd:O.iushln(W)}},t.prototype._invmp=function(D){n(D.negative===0),n(!D.isZero());var R=this,O=D.clone();R.negative!==0?R=R.umod(D):R=R.clone();for(var F=new t(1),N=new t(0),G=O.clone();R.cmpn(1)>0&&O.cmpn(1)>0;){for(var K=0,W=1;!(R.words[0]&W)&&K<26;++K,W<<=1);if(K>0)for(R.iushrn(K);K-- >0;)F.isOdd()&&F.iadd(G),F.iushrn(1);for(var Y=0,re=1;!(O.words[0]&re)&&Y<26;++Y,re<<=1);if(Y>0)for(O.iushrn(Y);Y-- >0;)N.isOdd()&&N.iadd(G),N.iushrn(1);R.cmp(O)>=0?(R.isub(O),F.isub(N)):(O.isub(R),N.isub(F))}var ue;return R.cmpn(1)===0?ue=F:ue=N,ue.cmpn(0)<0&&ue.iadd(D),ue},t.prototype.gcd=function(D){if(this.isZero())return D.abs();if(D.isZero())return this.abs();var R=this.clone(),O=D.clone();R.negative=0,O.negative=0;for(var F=0;R.isEven()&&O.isEven();F++)R.iushrn(1),O.iushrn(1);do{for(;R.isEven();)R.iushrn(1);for(;O.isEven();)O.iushrn(1);var N=R.cmp(O);if(N<0){var G=R;R=O,O=G}else if(N===0||O.cmpn(1)===0)break;R.isub(O)}while(!0);return O.iushln(F)},t.prototype.invm=function(D){return this.egcd(D).a.umod(D)},t.prototype.isEven=function(){return(this.words[0]&1)===0},t.prototype.isOdd=function(){return(this.words[0]&1)===1},t.prototype.andln=function(D){return this.words[0]&D},t.prototype.bincn=function(D){n(typeof D=="number");var R=D%26,O=(D-R)/26,F=1<<R;if(this.length<=O)return this._expand(O+1),this.words[O]|=F,this;for(var N=F,G=O;N!==0&&G<this.length;G++){var K=this.words[G]|0;K+=N,N=K>>>26,K&=67108863,this.words[G]=K}return N!==0&&(this.words[G]=N,this.length++),this},t.prototype.isZero=function(){return this.length===1&&this.words[0]===0},t.prototype.cmpn=function(D){var R=D<0;if(this.negative!==0&&!R)return-1;if(this.negative===0&&R)return 1;this.strip();var O;if(this.length>1)O=1;else{R&&(D=-D),n(D<=67108863,"Number is too big");var F=this.words[0]|0;O=F===D?0:F<D?-1:1}return this.negative!==0?-O|0:O},t.prototype.cmp=function(D){if(this.negative!==0&&D.negative===0)return-1;if(this.negative===0&&D.negative!==0)return 1;var R=this.ucmp(D);return this.negative!==0?-R|0:R},t.prototype.ucmp=function(D){if(this.length>D.length)return 1;if(this.length<D.length)return-1;for(var R=0,O=this.length-1;O>=0;O--){var F=this.words[O]|0,N=D.words[O]|0;if(F!==N){F<N?R=-1:F>N&&(R=1);break}}return R},t.prototype.gtn=function(D){return this.cmpn(D)===1},t.prototype.gt=function(D){return this.cmp(D)===1},t.prototype.gten=function(D){return this.cmpn(D)>=0},t.prototype.gte=function(D){return this.cmp(D)>=0},t.prototype.ltn=function(D){return this.cmpn(D)===-1},t.prototype.lt=function(D){return this.cmp(D)===-1},t.prototype.lten=function(D){return this.cmpn(D)<=0},t.prototype.lte=function(D){return this.cmp(D)<=0},t.prototype.eqn=function(D){return this.cmpn(D)===0},t.prototype.eq=function(D){return this.cmp(D)===0},t.red=function(D){return new P(D)},t.prototype.toRed=function(D){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),D.convertTo(this)._forceRed(D)},t.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},t.prototype._forceRed=function(D){return this.red=D,this},t.prototype.forceRed=function(D){return n(!this.red,"Already a number in reduction context"),this._forceRed(D)},t.prototype.redAdd=function(D){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,D)},t.prototype.redIAdd=function(D){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,D)},t.prototype.redSub=function(D){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,D)},t.prototype.redISub=function(D){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,D)},t.prototype.redShl=function(D){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,D)},t.prototype.redMul=function(D){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.mul(this,D)},t.prototype.redIMul=function(D){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.imul(this,D)},t.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},t.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},t.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},t.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},t.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},t.prototype.redPow=function(D){return n(this.red&&!D.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,D)};var c={k256:null,p224:null,p192:null,p25519:null};function b(I,D){this.name=I,this.p=new t(D,16),this.n=this.p.bitLength(),this.k=new t(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}b.prototype._tmp=function(){var D=new t(null);return D.words=new Array(Math.ceil(this.n/13)),D},b.prototype.ireduce=function(D){var R=D,O;do this.split(R,this.tmp),R=this.imulK(R),R=R.iadd(this.tmp),O=R.bitLength();while(O>this.n);var F=O<this.n?-1:R.ucmp(this.p);return F===0?(R.words[0]=0,R.length=1):F>0?R.isub(this.p):R.strip!==void 0?R.strip():R._strip(),R},b.prototype.split=function(D,R){D.iushrn(this.n,0,R)},b.prototype.imulK=function(D){return D.imul(this.k)};function u(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}r(u,b),u.prototype.split=function(D,R){for(var O=4194303,F=Math.min(D.length,9),N=0;N<F;N++)R.words[N]=D.words[N];if(R.length=F,D.length<=9){D.words[0]=0,D.length=1;return}var G=D.words[9];for(R.words[R.length++]=G&O,N=10;N<D.length;N++){var K=D.words[N]|0;D.words[N-10]=(K&O)<<4|G>>>22,G=K}G>>>=22,D.words[N-10]=G,G===0&&D.length>10?D.length-=10:D.length-=9},u.prototype.imulK=function(D){D.words[D.length]=0,D.words[D.length+1]=0,D.length+=2;for(var R=0,O=0;O<D.length;O++){var F=D.words[O]|0;R+=F*977,D.words[O]=R&67108863,R=F*64+(R/67108864|0)}return D.words[D.length-1]===0&&(D.length--,D.words[D.length-1]===0&&D.length--),D};function L(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}r(L,b);function T(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}r(T,b);function k(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}r(k,b),k.prototype.imulK=function(D){for(var R=0,O=0;O<D.length;O++){var F=(D.words[O]|0)*19+R,N=F&67108863;F>>>=26,D.words[O]=N,R=F}return R!==0&&(D.words[D.length++]=R),D},t._prime=function(D){if(c[D])return c[D];var R;if(D==="k256")R=new u;else if(D==="p224")R=new L;else if(D==="p192")R=new T;else if(D==="p25519")R=new k;else throw new Error("Unknown prime "+D);return c[D]=R,R};function P(I){if(typeof I=="string"){var D=t._prime(I);this.m=D.p,this.prime=D}else n(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}P.prototype._verify1=function(D){n(D.negative===0,"red works only with positives"),n(D.red,"red works only with red numbers")},P.prototype._verify2=function(D,R){n((D.negative|R.negative)===0,"red works only with positives"),n(D.red&&D.red===R.red,"red works only with red numbers")},P.prototype.imod=function(D){return this.prime?this.prime.ireduce(D)._forceRed(this):D.umod(this.m)._forceRed(this)},P.prototype.neg=function(D){return D.isZero()?D.clone():this.m.sub(D)._forceRed(this)},P.prototype.add=function(D,R){this._verify2(D,R);var O=D.add(R);return O.cmp(this.m)>=0&&O.isub(this.m),O._forceRed(this)},P.prototype.iadd=function(D,R){this._verify2(D,R);var O=D.iadd(R);return O.cmp(this.m)>=0&&O.isub(this.m),O},P.prototype.sub=function(D,R){this._verify2(D,R);var O=D.sub(R);return O.cmpn(0)<0&&O.iadd(this.m),O._forceRed(this)},P.prototype.isub=function(D,R){this._verify2(D,R);var O=D.isub(R);return O.cmpn(0)<0&&O.iadd(this.m),O},P.prototype.shl=function(D,R){return this._verify1(D),this.imod(D.ushln(R))},P.prototype.imul=function(D,R){return this._verify2(D,R),this.imod(D.imul(R))},P.prototype.mul=function(D,R){return this._verify2(D,R),this.imod(D.mul(R))},P.prototype.isqr=function(D){return this.imul(D,D.clone())},P.prototype.sqr=function(D){return this.mul(D,D)},P.prototype.sqrt=function(D){if(D.isZero())return D.clone();var R=this.m.andln(3);if(n(R%2===1),R===3){var O=this.m.add(new t(1)).iushrn(2);return this.pow(D,O)}for(var F=this.m.subn(1),N=0;!F.isZero()&&F.andln(1)===0;)N++,F.iushrn(1);n(!F.isZero());var G=new t(1).toRed(this),K=G.redNeg(),W=this.m.subn(1).iushrn(1),Y=this.m.bitLength();for(Y=new t(2*Y*Y).toRed(this);this.pow(Y,W).cmp(K)!==0;)Y.redIAdd(K);for(var re=this.pow(Y,F),ue=this.pow(D,F.addn(1).iushrn(1)),j=this.pow(D,F),q=N;j.cmp(G)!==0;){for(var H=j,U=0;H.cmp(G)!==0;U++)H=H.redSqr();n(U<q);var $=this.pow(re,new t(1).iushln(q-U-1));ue=ue.redMul($),re=$.redSqr(),j=j.redMul(re),q=U}return ue},P.prototype.invm=function(D){var R=D._invmp(this.m);return R.negative!==0?(R.negative=0,this.imod(R).redNeg()):this.imod(R)},P.prototype.pow=function(D,R){if(R.isZero())return new t(1).toRed(this);if(R.cmpn(1)===0)return D.clone();var O=4,F=new Array(1<<O);F[0]=new t(1).toRed(this),F[1]=D;for(var N=2;N<F.length;N++)F[N]=this.mul(F[N-1],D);var G=F[0],K=0,W=0,Y=R.bitLength()%26;for(Y===0&&(Y=26),N=R.length-1;N>=0;N--){for(var re=R.words[N],ue=Y-1;ue>=0;ue--){var j=re>>ue&1;if(G!==F[0]&&(G=this.sqr(G)),j===0&&K===0){W=0;continue}K<<=1,K|=j,W++,!(W!==O&&(N!==0||ue!==0))&&(G=this.mul(G,F[K]),W=0,K=0)}Y=26}return G},P.prototype.convertTo=function(D){var R=D.umod(this.m);return R===D?R.clone():R},P.prototype.convertFrom=function(D){var R=D.clone();return R.red=null,R},t.mont=function(D){return new z(D)};function z(I){P.call(this,I),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new t(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}r(z,P),z.prototype.convertTo=function(D){return this.imod(D.ushln(this.shift))},z.prototype.convertFrom=function(D){var R=this.imod(D.mul(this.rinv));return R.red=null,R},z.prototype.imul=function(D,R){if(D.isZero()||R.isZero())return D.words[0]=0,D.length=1,D;var O=D.imul(R),F=O.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=O.isub(F).iushrn(this.shift),G=N;return N.cmp(this.m)>=0?G=N.isub(this.m):N.cmpn(0)<0&&(G=N.iadd(this.m)),G._forceRed(this)},z.prototype.mul=function(D,R){if(D.isZero()||R.isZero())return new t(0)._forceRed(this);var O=D.mul(R),F=O.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=O.isub(F).iushrn(this.shift),G=N;return N.cmp(this.m)>=0?G=N.isub(this.m):N.cmpn(0)<0&&(G=N.iadd(this.m)),G._forceRed(this)},z.prototype.invm=function(D){var R=this.imod(D._invmp(this.m).mul(this.r2));return R._forceRed(this)}})(typeof S>"u"||S,this)},{buffer:2}],34:[function(g,S,M){S.exports=e;function e(a){var n,r,t,h=a.length,s=0;for(n=0;n<h;++n)s+=a[n].length;var i=new Array(s),x=0;for(n=0;n<h;++n){var p=a[n],v=p.length;for(r=0;r<v;++r){var f=i[x++]=new Array(v-1),d=0;for(t=0;t<v;++t)t!==r&&(f[d++]=p[t]);if(r&1){var o=f[1];f[1]=f[0],f[0]=o}}}return i}},{}],35:[function(g,S,M){S.exports=v;var e=g("typedarray-pool"),a=g("./lib/sweep"),n=g("./lib/intersect");function r(f,d){for(var o=0;o<f;++o)if(!(d[o]<=d[o+f]))return!0;return!1}function t(f,d,o,m){for(var l=0,w=0,_=0,c=f.length;_<c;++_){var b=f[_];if(!r(d,b)){for(var u=0;u<2*d;++u)o[l++]=b[u];m[w++]=_}}return w}function h(f,d,o,m){var l=f.length,w=d.length;if(!(l<=0||w<=0)){var _=f[0].length>>>1;if(!(_<=0)){var c,b=e.mallocDouble(2*_*l),u=e.mallocInt32(l);if(l=t(f,_,b,u),l>0){if(_===1&&m)a.init(l),c=a.sweepComplete(_,o,0,l,b,u,0,l,b,u);else{var L=e.mallocDouble(2*_*w),T=e.mallocInt32(w);w=t(d,_,L,T),w>0&&(a.init(l+w),_===1?c=a.sweepBipartite(_,o,0,l,b,u,0,w,L,T):c=n(_,o,m,l,b,u,w,L,T),e.free(L),e.free(T))}e.free(b),e.free(u)}return c}}}var s;function i(f,d){s.push([f,d])}function x(f){return s=[],h(f,f,i,!0),s}function p(f,d){return s=[],h(f,d,i,!1),s}function v(f,d,o){switch(arguments.length){case 1:return x(f);case 2:return typeof d=="function"?h(f,f,d,!0):p(f,d);case 3:return h(f,d,o,!1);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(g,S,M){function e(){function r(s,i,x,p,v,f,d,o,m,l,w){for(var _=2*s,c=p,b=_*p;c<v;++c,b+=_){var u=f[i+b],L=f[i+b+s],T=d[c];e:for(var k=o,P=_*o;k<m;++k,P+=_){var z=l[i+P],I=l[i+P+s],D=w[k];if(!(I<u||L<z)){for(var R=i+1;R<s;++R){var O=f[R+b],F=f[R+s+b],N=l[R+P],G=l[R+s+P];if(F<N||G<O)continue e}var K=x(T,D);if(K!==void 0)return K}}}}function t(s,i,x,p,v,f,d,o,m,l,w){for(var _=2*s,c=o,b=_*o;c<m;++c,b+=_){var u=l[i+b],L=l[i+b+s],T=w[c];e:for(var k=p,P=_*p;k<v;++k,P+=_){var z=f[i+P],I=f[i+P+s],D=d[k];if(!(L<z||I<u)){for(var R=i+1;R<s;++R){var O=f[R+P],F=f[R+s+P],N=l[R+b],G=l[R+s+b];if(F<N||G<O)continue e}var K=x(D,T);if(K!==void 0)return K}}}}function h(s,i,x,p,v,f,d,o,m,l,w){return v-p>m-o?r(s,i,x,p,v,f,d,o,m,l,w):t(s,i,x,p,v,f,d,o,m,l,w)}return h}function a(){function r(x,p,v,f,d,o,m,l,w,_,c){for(var b=2*x,u=f,L=b*f;u<d;++u,L+=b){var T=o[p+L],k=o[p+L+x],P=m[u];e:for(var z=l,I=b*l;z<w;++z,I+=b){var D=_[p+I],R=c[z];if(!(D<=T||k<D)){for(var O=p+1;O<x;++O){var F=o[O+L],N=o[O+x+L],G=_[O+I],K=_[O+x+I];if(N<G||K<F)continue e}var W=v(R,P);if(W!==void 0)return W}}}}function t(x,p,v,f,d,o,m,l,w,_,c){for(var b=2*x,u=f,L=b*f;u<d;++u,L+=b){var T=o[p+L],k=o[p+L+x],P=m[u];e:for(var z=l,I=b*l;z<w;++z,I+=b){var D=_[p+I],R=c[z];if(!(D<T||k<D)){for(var O=p+1;O<x;++O){var F=o[O+L],N=o[O+x+L],G=_[O+I],K=_[O+x+I];if(N<G||K<F)continue e}var W=v(P,R);if(W!==void 0)return W}}}}function h(x,p,v,f,d,o,m,l,w,_,c){for(var b=2*x,u=l,L=b*l;u<w;++u,L+=b){var T=_[p+L],k=c[u];e:for(var P=f,z=b*f;P<d;++P,z+=b){var I=o[p+z],D=o[p+z+x],R=m[P];if(!(T<=I||D<T)){for(var O=p+1;O<x;++O){var F=o[O+z],N=o[O+x+z],G=_[O+L],K=_[O+x+L];if(N<G||K<F)continue e}var W=v(k,R);if(W!==void 0)return W}}}}function s(x,p,v,f,d,o,m,l,w,_,c){for(var b=2*x,u=l,L=b*l;u<w;++u,L+=b){var T=_[p+L],k=c[u];e:for(var P=f,z=b*f;P<d;++P,z+=b){var I=o[p+z],D=o[p+z+x],R=m[P];if(!(T<I||D<T)){for(var O=p+1;O<x;++O){var F=o[O+z],N=o[O+x+z],G=_[O+L],K=_[O+x+L];if(N<G||K<F)continue e}var W=v(R,k);if(W!==void 0)return W}}}}function i(x,p,v,f,d,o,m,l,w,_,c,b){return o-d>_-w?f?r(x,p,v,d,o,m,l,w,_,c,b):t(x,p,v,d,o,m,l,w,_,c,b):f?h(x,p,v,d,o,m,l,w,_,c,b):s(x,p,v,d,o,m,l,w,_,c,b)}return i}function n(r){return r?e():a()}M.partial=n(!1),M.full=n(!0)},{}],37:[function(g,S,M){S.exports=I;var e=g("typedarray-pool"),a=g("bit-twiddle"),n=g("./brute"),r=n.partial,t=n.full,h=g("./sweep"),s=g("./median"),i=g("./partition"),x=128,p=1<<22,v=1<<22,f=i("!(lo>=p0)&&!(p1>=hi)"),d=i("lo===p0"),o=i("lo<p0"),m=i("hi<=p0"),l=i("lo<=p0&&p0<=hi"),w=i("lo<p0&&p0<=hi"),_=6,c=2,b=1024,u=e.mallocInt32(b),L=e.mallocDouble(b);function T(D,R){var O=8*a.log2(R+1)*(D+1)|0,F=a.nextPow2(_*O);u.length<F&&(e.free(u),u=e.mallocInt32(F));var N=a.nextPow2(c*O);L.length<N&&(e.free(L),L=e.mallocDouble(N))}function k(D,R,O,F,N,G,K,W,Y){var re=_*D;u[re]=R,u[re+1]=O,u[re+2]=F,u[re+3]=N,u[re+4]=G,u[re+5]=K;var ue=c*D;L[ue]=W,L[ue+1]=Y}function P(D,R,O,F,N,G,K,W,Y,re,ue){var j=2*D,q=Y*j,H=re[q+R];e:for(var U=N,$=N*j;U<G;++U,$+=j){var ne=K[$+R],X=K[$+R+D];if(!(H<ne||X<H)&&!(F&&H===ne)){for(var Q=W[U],ie=R+1;ie<D;++ie){var ne=K[$+ie],X=K[$+ie+D],se=re[q+ie],ae=re[q+ie+D];if(X<se||ae<ne)continue e}var oe;if(F?oe=O(ue,Q):oe=O(Q,ue),oe!==void 0)return oe}}}function z(D,R,O,F,N,G,K,W,Y,re){var ue=2*D,j=W*ue,q=Y[j+R];e:for(var H=F,U=F*ue;H<N;++H,U+=ue){var $=K[H];if($!==re){var ne=G[U+R],X=G[U+R+D];if(!(q<ne||X<q)){for(var Q=R+1;Q<D;++Q){var ne=G[U+Q],X=G[U+Q+D],ie=Y[j+Q],se=Y[j+Q+D];if(X<ie||se<ne)continue e}var ae=O($,re);if(ae!==void 0)return ae}}}}function I(D,R,O,F,N,G,K,W,Y){T(D,F+K);var re=0,ue=2*D,j;for(k(re++,0,0,F,0,K,O?16:0,-1/0,1/0),O||k(re++,0,0,K,0,F,1,-1/0,1/0);re>0;){re-=1;var q=re*_,H=u[q],U=u[q+1],$=u[q+2],ne=u[q+3],X=u[q+4],Q=u[q+5],ie=re*c,se=L[ie],ae=L[ie+1],oe=Q&1,be=!!(Q&16),ce=N,de=G,ye=W,ge=Y;if(oe&&(ce=W,de=Y,ye=N,ge=G),!(Q&2&&($=o(D,H,U,$,ce,de,ae),U>=$))&&!(Q&4&&(U=m(D,H,U,$,ce,de,se),U>=$))){var me=$-U,Ee=X-ne;if(be){if(D*me*(me+Ee)<v){if(j=h.scanComplete(D,H,R,U,$,ce,de,ne,X,ye,ge),j!==void 0)return j;continue}}else if(D*Math.min(me,Ee)<x){if(j=r(D,H,R,oe,U,$,ce,de,ne,X,ye,ge),j!==void 0)return j;continue}else if(D*me*Ee<p){if(j=h.scanBipartite(D,H,R,oe,U,$,ce,de,ne,X,ye,ge),j!==void 0)return j;continue}var Pe=f(D,H,U,$,ce,de,se,ae);if(U<Pe)if(D*(Pe-U)<x){if(j=t(D,H+1,R,U,Pe,ce,de,ne,X,ye,ge),j!==void 0)return j}else if(H===D-2){if(oe?j=h.sweepBipartite(D,R,ne,X,ye,ge,U,Pe,ce,de):j=h.sweepBipartite(D,R,U,Pe,ce,de,ne,X,ye,ge),j!==void 0)return j}else k(re++,H+1,U,Pe,ne,X,oe,-1/0,1/0),k(re++,H+1,ne,X,U,Pe,oe^1,-1/0,1/0);if(Pe<$){var Ue=s(D,H,ne,X,ye,ge),we=ye[ue*Ue+H],ke=d(D,H,Ue,X,ye,ge,we);if(ke<X&&k(re++,H,Pe,$,ke,X,(oe|4)+(be?16:0),we,ae),ne<Ue&&k(re++,H,Pe,$,ne,Ue,(oe|2)+(be?16:0),se,we),Ue+1===ke){if(be?j=z(D,H,R,Pe,$,ce,de,Ue,ye,ge[Ue]):j=P(D,H,R,oe,Pe,$,ce,de,Ue,ye,ge[Ue]),j!==void 0)return j}else if(Ue<ke){var Xe;if(be){if(Xe=l(D,H,Pe,$,ce,de,we),Pe<Xe){var Ve=d(D,H,Pe,Xe,ce,de,we);if(H===D-2){if(Pe<Ve&&(j=h.sweepComplete(D,R,Pe,Ve,ce,de,Ue,ke,ye,ge),j!==void 0)||Ve<Xe&&(j=h.sweepBipartite(D,R,Ve,Xe,ce,de,Ue,ke,ye,ge),j!==void 0))return j}else Pe<Ve&&k(re++,H+1,Pe,Ve,Ue,ke,16,-1/0,1/0),Ve<Xe&&(k(re++,H+1,Ve,Xe,Ue,ke,0,-1/0,1/0),k(re++,H+1,Ue,ke,Ve,Xe,1,-1/0,1/0))}}else oe?Xe=w(D,H,Pe,$,ce,de,we):Xe=l(D,H,Pe,$,ce,de,we),Pe<Xe&&(H===D-2?oe?j=h.sweepBipartite(D,R,Ue,ke,ye,ge,Pe,Xe,ce,de):j=h.sweepBipartite(D,R,Pe,Xe,ce,de,Ue,ke,ye,ge):(k(re++,H+1,Pe,Xe,Ue,ke,oe,-1/0,1/0),k(re++,H+1,Ue,ke,Pe,Xe,oe^1,-1/0,1/0)))}}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(g,S,M){S.exports=t;var e=g("./partition"),a=e("lo<p0"),n=8;function r(h,s,i,x,p,v){for(var f=2*h,d=f*(i+1)+s,o=i+1;o<x;++o,d+=f)for(var m=p[d],l=o,w=f*(o-1);l>i&&p[w+s]>m;--l,w-=f){for(var _=w,c=w+f,b=0;b<f;++b,++_,++c){var u=p[_];p[_]=p[c],p[c]=u}var L=v[l];v[l]=v[l-1],v[l-1]=L}}function t(h,s,i,x,p,v){if(x<=i+1)return i;for(var f=i,d=x,o=x+i>>>1,m=2*h,l=o,w=p[m*o+s];f<d;){if(d-f<n){r(h,s,f,d,p,v),w=p[m*o+s];break}var _=d-f,c=Math.random()*_+f|0,b=p[m*c+s],u=Math.random()*_+f|0,L=p[m*u+s],T=Math.random()*_+f|0,k=p[m*T+s];b<=L?k>=L?(l=u,w=L):b>=k?(l=c,w=b):(l=T,w=k):L>=k?(l=u,w=L):k>=b?(l=c,w=b):(l=T,w=k);for(var I=m*(d-1),D=m*l,P=0;P<m;++P,++I,++D){var z=p[I];p[I]=p[D],p[D]=z}var R=v[d-1];v[d-1]=v[l],v[l]=R,l=a(h,s,f,d-1,p,v,w);for(var I=m*(d-1),D=m*l,P=0;P<m;++P,++I,++D){var z=p[I];p[I]=p[D],p[D]=z}var R=v[d-1];if(v[d-1]=v[l],v[l]=R,o<l){for(d=l-1;f<d&&p[m*(d-1)+s]===w;)d-=1;d+=1}else if(l<o)for(f=l+1;f<d&&p[m*f+s]===w;)f+=1;else break}return a(h,s,i,o,p,v,p[m*o+s])}},{"./partition":39}],39:[function(g,S,M){S.exports=a;var e={"lo===p0":n,"lo<p0":r,"lo<=p0":t,"hi<=p0":h,"lo<p0&&p0<=hi":i,"lo<=p0&&p0<=hi":s,"!(lo>=p0)&&!(p1>=hi)":x};function a(p){return e[p]}function n(p,v,f,d,o,m,l){for(var w=2*p,_=w*f,c=_,b=f,u=v,L=p+v,T=f;d>T;++T,_+=w){var k=o[_+u];if(k===l)if(b===T)b+=1,c+=w;else{for(var P=0;w>P;++P){var z=o[_+P];o[_+P]=o[c],o[c++]=z}var I=m[T];m[T]=m[b],m[b++]=I}}return b}function r(p,v,f,d,o,m,l){for(var w=2*p,_=w*f,c=_,b=f,u=v,L=p+v,T=f;d>T;++T,_+=w){var k=o[_+u];if(k<l)if(b===T)b+=1,c+=w;else{for(var P=0;w>P;++P){var z=o[_+P];o[_+P]=o[c],o[c++]=z}var I=m[T];m[T]=m[b],m[b++]=I}}return b}function t(p,v,f,d,o,m,l){for(var w=2*p,_=w*f,c=_,b=f,u=v,L=p+v,T=f;d>T;++T,_+=w){var k=o[_+L];if(k<=l)if(b===T)b+=1,c+=w;else{for(var P=0;w>P;++P){var z=o[_+P];o[_+P]=o[c],o[c++]=z}var I=m[T];m[T]=m[b],m[b++]=I}}return b}function h(p,v,f,d,o,m,l){for(var w=2*p,_=w*f,c=_,b=f,u=v,L=p+v,T=f;d>T;++T,_+=w){var k=o[_+L];if(k<=l)if(b===T)b+=1,c+=w;else{for(var P=0;w>P;++P){var z=o[_+P];o[_+P]=o[c],o[c++]=z}var I=m[T];m[T]=m[b],m[b++]=I}}return b}function s(p,v,f,d,o,m,l){for(var w=2*p,_=w*f,c=_,b=f,u=v,L=p+v,T=f;d>T;++T,_+=w){var k=o[_+u],P=o[_+L];if(k<=l&&l<=P)if(b===T)b+=1,c+=w;else{for(var z=0;w>z;++z){var I=o[_+z];o[_+z]=o[c],o[c++]=I}var D=m[T];m[T]=m[b],m[b++]=D}}return b}function i(p,v,f,d,o,m,l){for(var w=2*p,_=w*f,c=_,b=f,u=v,L=p+v,T=f;d>T;++T,_+=w){var k=o[_+u],P=o[_+L];if(k<l&&l<=P)if(b===T)b+=1,c+=w;else{for(var z=0;w>z;++z){var I=o[_+z];o[_+z]=o[c],o[c++]=I}var D=m[T];m[T]=m[b],m[b++]=D}}return b}function x(p,v,f,d,o,m,l,w){for(var _=2*p,c=_*f,b=c,u=f,L=v,T=p+v,k=f;d>k;++k,c+=_){var P=o[c+L],z=o[c+T];if(!(P>=l)&&!(w>=z))if(u===k)u+=1,b+=_;else{for(var I=0;_>I;++I){var D=o[c+I];o[c+I]=o[b],o[b++]=D}var R=m[k];m[k]=m[u],m[u++]=R}}return u}},{}],40:[function(g,S,M){S.exports=a;var e=32;function a(v,f){f<=4*e?n(0,f-1,v):p(0,f-1,v)}function n(v,f,d){for(var o=2*(v+1),m=v+1;m<=f;++m){for(var l=d[o++],w=d[o++],_=m,c=o-2;_-- >v;){var b=d[c-2],u=d[c-1];if(b<l)break;if(b===l&&u<w)break;d[c]=b,d[c+1]=u,c-=2}d[c]=l,d[c+1]=w}}function r(v,f,d){v*=2,f*=2;var o=d[v],m=d[v+1];d[v]=d[f],d[v+1]=d[f+1],d[f]=o,d[f+1]=m}function t(v,f,d){v*=2,f*=2,d[v]=d[f],d[v+1]=d[f+1]}function h(v,f,d,o){v*=2,f*=2,d*=2;var m=o[v],l=o[v+1];o[v]=o[f],o[v+1]=o[f+1],o[f]=o[d],o[f+1]=o[d+1],o[d]=m,o[d+1]=l}function s(v,f,d,o,m){v*=2,f*=2,m[v]=m[f],m[f]=d,m[v+1]=m[f+1],m[f+1]=o}function i(v,f,d){v*=2,f*=2;var o=d[v],m=d[f];return o<m?!1:o===m?d[v+1]>d[f+1]:!0}function x(v,f,d,o){v*=2;var m=o[v];return m<f?!0:m===f?o[v+1]<d:!1}function p(v,f,d){var o=(f-v+1)/6|0,m=v+o,l=f-o,w=v+f>>1,_=w-o,c=w+o,b=m,u=_,L=w,T=c,k=l,P=v+1,z=f-1,I=0;i(b,u,d)&&(I=b,b=u,u=I),i(T,k,d)&&(I=T,T=k,k=I),i(b,L,d)&&(I=b,b=L,L=I),i(u,L,d)&&(I=u,u=L,L=I),i(b,T,d)&&(I=b,b=T,T=I),i(L,T,d)&&(I=L,L=T,T=I),i(u,k,d)&&(I=u,u=k,k=I),i(u,L,d)&&(I=u,u=L,L=I),i(T,k,d)&&(I=T,T=k,k=I);for(var D=d[2*u],R=d[2*u+1],O=d[2*T],F=d[2*T+1],N=2*b,G=2*L,K=2*k,W=2*m,Y=2*w,re=2*l,ue=0;ue<2;++ue){var j=d[N+ue],q=d[G+ue],H=d[K+ue];d[W+ue]=j,d[Y+ue]=q,d[re+ue]=H}t(_,v,d),t(c,f,d);for(var U=P;U<=z;++U)if(x(U,D,R,d))U!==P&&r(U,P,d),++P;else if(!x(U,O,F,d))for(;;)if(x(z,O,F,d)){x(z,D,R,d)?(h(U,P,z,d),++P,--z):(r(U,z,d),--z);break}else{if(--z<U)break;continue}s(v,P-1,D,R,d),s(f,z+1,O,F,d),P-2-v<=e?n(v,P-2,d):p(v,P-2,d),f-(z+2)<=e?n(z+2,f,d):p(z+2,f,d),z-P<=e?n(P,z,d):p(P,z,d)}},{}],41:[function(g,S,M){S.exports={init:d,sweepBipartite:l,sweepComplete:w,scanBipartite:_,scanComplete:c};var e=g("typedarray-pool"),a=g("bit-twiddle"),n=g("./sort"),r=1<<28,t=1024,h=e.mallocInt32(t),s=e.mallocInt32(t),i=e.mallocInt32(t),x=e.mallocInt32(t),p=e.mallocInt32(t),v=e.mallocInt32(t),f=e.mallocDouble(t*8);function d(b){var u=a.nextPow2(b);h.length<u&&(e.free(h),h=e.mallocInt32(u)),s.length<u&&(e.free(s),s=e.mallocInt32(u)),i.length<u&&(e.free(i),i=e.mallocInt32(u)),x.length<u&&(e.free(x),x=e.mallocInt32(u)),p.length<u&&(e.free(p),p=e.mallocInt32(u)),v.length<u&&(e.free(v),v=e.mallocInt32(u));var L=8*u;f.length<L&&(e.free(f),f=e.mallocDouble(L))}function o(b,u,L,T){var k=u[T],P=b[L-1];b[k]=P,u[P]=k}function m(b,u,L,T){b[L]=T,u[T]=L}function l(b,u,L,T,k,P,z,I,D,R){for(var O=0,F=2*b,N=b-1,G=F-1,K=L;K<T;++K){var W=P[K],Y=F*K;f[O++]=k[Y+N],f[O++]=-(W+1),f[O++]=k[Y+G],f[O++]=W}for(var K=z;K<I;++K){var W=R[K]+r,re=F*K;f[O++]=D[re+N],f[O++]=-W,f[O++]=D[re+G],f[O++]=W}var ue=O>>>1;n(f,ue);for(var j=0,q=0,K=0;K<ue;++K){var H=f[2*K+1]|0;if(H>=r)H=H-r|0,o(i,x,q--,H);else if(H>=0)o(h,s,j--,H);else if(H<=-r){H=-H-r|0;for(var U=0;U<j;++U){var $=u(h[U],H);if($!==void 0)return $}m(i,x,q++,H)}else{H=-H-1|0;for(var U=0;U<q;++U){var $=u(H,i[U]);if($!==void 0)return $}m(h,s,j++,H)}}}function w(b,u,L,T,k,P,z,I,D,R){for(var O=0,F=2*b,N=b-1,G=F-1,K=L;K<T;++K){var W=P[K]+1<<1,Y=F*K;f[O++]=k[Y+N],f[O++]=-W,f[O++]=k[Y+G],f[O++]=W}for(var K=z;K<I;++K){var W=R[K]+1<<1,re=F*K;f[O++]=D[re+N],f[O++]=-W|1,f[O++]=D[re+G],f[O++]=W|1}var ue=O>>>1;n(f,ue);for(var j=0,q=0,H=0,K=0;K<ue;++K){var U=f[2*K+1]|0,$=U&1;if(K<ue-1&&U>>1===f[2*K+3]>>1&&($=2,K+=1),U<0){for(var ne=-(U>>1)-1,X=0;X<H;++X){var Q=u(p[X],ne);if(Q!==void 0)return Q}if($!==0)for(var X=0;X<j;++X){var Q=u(h[X],ne);if(Q!==void 0)return Q}if($!==1)for(var X=0;X<q;++X){var Q=u(i[X],ne);if(Q!==void 0)return Q}$===0?m(h,s,j++,ne):$===1?m(i,x,q++,ne):$===2&&m(p,v,H++,ne)}else{var ne=(U>>1)-1;$===0?o(h,s,j--,ne):$===1?o(i,x,q--,ne):$===2&&o(p,v,H--,ne)}}}function _(b,u,L,T,k,P,z,I,D,R,O,F){var N=0,G=2*b,K=u,W=u+b,Y=1,re=1;T?re=r:Y=r;for(var ue=k;ue<P;++ue){var j=ue+Y,q=G*ue;f[N++]=z[q+K],f[N++]=-j,f[N++]=z[q+W],f[N++]=j}for(var ue=D;ue<R;++ue){var j=ue+re,H=G*ue;f[N++]=O[H+K],f[N++]=-j}var U=N>>>1;n(f,U);for(var $=0,ue=0;ue<U;++ue){var ne=f[2*ue+1]|0;if(ne<0){var j=-ne,X=!1;if(j>=r?(X=!T,j-=r):(X=!!T,j-=1),X)m(h,s,$++,j);else{var Q=F[j],ie=G*j,se=O[ie+u+1],ae=O[ie+u+1+b];e:for(var oe=0;oe<$;++oe){var be=h[oe],ce=G*be;if(!(ae<z[ce+u+1]||z[ce+u+1+b]<se)){for(var de=u+2;de<b;++de)if(O[ie+de+b]<z[ce+de]||z[ce+de+b]<O[ie+de])continue e;var ye=I[be],ge;if(T?ge=L(Q,ye):ge=L(ye,Q),ge!==void 0)return ge}}}}else o(h,s,$--,ne-Y)}}function c(b,u,L,T,k,P,z,I,D,R,O){for(var F=0,N=2*b,G=u,K=u+b,W=T;W<k;++W){var Y=W+r,re=N*W;f[F++]=P[re+G],f[F++]=-Y,f[F++]=P[re+K],f[F++]=Y}for(var W=I;W<D;++W){var Y=W+1,ue=N*W;f[F++]=R[ue+G],f[F++]=-Y}var j=F>>>1;n(f,j);for(var q=0,W=0;W<j;++W){var H=f[2*W+1]|0;if(H<0){var Y=-H;if(Y>=r)h[q++]=Y-r;else{Y-=1;var U=O[Y],$=N*Y,ne=R[$+u+1],X=R[$+u+1+b];e:for(var Q=0;Q<q;++Q){var ie=h[Q],se=z[ie];if(se===U)break;var ae=N*ie;if(!(X<P[ae+u+1]||P[ae+u+1+b]<ne)){for(var oe=u+2;oe<b;++oe)if(R[$+oe+b]<P[ae+oe]||P[ae+oe+b]<R[$+oe])continue e;var be=L(se,U);if(be!==void 0)return be}}}}else{for(var Y=H-r,Q=q-1;Q>=0;--Q)if(h[Q]===Y){for(var oe=Q+1;oe<q;++oe)h[oe-1]=h[oe];break}--q}}}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(g,S,M){var e=g("./lib/monotone"),a=g("./lib/triangulation"),n=g("./lib/delaunay"),r=g("./lib/filter");S.exports=x;function t(p){return[Math.min(p[0],p[1]),Math.max(p[0],p[1])]}function h(p,v){return p[0]-v[0]||p[1]-v[1]}function s(p){return p.map(t).sort(h)}function i(p,v,f){return v in p?p[v]:f}function x(p,v,f){Array.isArray(v)?(f=f||{},v=v||[]):(f=v||{},v=[]);var d=!!i(f,"delaunay",!0),o=!!i(f,"interior",!0),m=!!i(f,"exterior",!0),l=!!i(f,"infinity",!1);if(!o&&!m||p.length===0)return[];var w=e(p,v);if(d||o!==m||l){for(var _=a(p.length,s(v)),c=0;c<w.length;++c){var b=w[c];_.addTriangle(b[0],b[1],b[2])}return d&&n(p,_),m?o?l?r(_,0,l):_.cells():r(_,1,l):r(_,-1)}else return w}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(g,S,M){var e=g("robust-in-sphere")[4];g("binary-search-bounds"),S.exports=n;function a(r,t,h,s,i,x){var p=t.opposite(s,i);if(!(p<0)){if(i<s){var v=s;s=i,i=v,v=x,x=p,p=v}t.isConstraint(s,i)||e(r[s],r[i],r[x],r[p])<0&&h.push(s,i)}}function n(r,t){for(var h=[],s=r.length,i=t.stars,x=0;x<s;++x)for(var p=i[x],v=1;v<p.length;v+=2){var f=p[v];if(!(f<x)&&!t.isConstraint(x,f)){for(var d=p[v-1],o=-1,m=1;m<p.length;m+=2)if(p[m-1]===f){o=p[m];break}o<0||e(r[x],r[f],r[d],r[o])<0&&h.push(x,f)}}for(;h.length>0;){for(var f=h.pop(),x=h.pop(),d=-1,o=-1,p=i[x],l=1;l<p.length;l+=2){var w=p[l-1],_=p[l];w===f?o=_:_===f&&(d=w)}d<0||o<0||e(r[x],r[f],r[d],r[o])>=0||(t.flip(x,f),a(r,t,h,d,x,o),a(r,t,h,x,o,d),a(r,t,h,o,f,d),a(r,t,h,f,d,o))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(g,S,M){var e=g("binary-search-bounds");S.exports=s;function a(i,x,p,v,f,d,o){this.cells=i,this.neighbor=x,this.flags=v,this.constraint=p,this.active=f,this.next=d,this.boundary=o}var n=a.prototype;function r(i,x){return i[0]-x[0]||i[1]-x[1]||i[2]-x[2]}n.locate=function(){var i=[0,0,0];return function(x,p,v){var f=x,d=p,o=v;return p<v?p<x&&(f=p,d=v,o=x):v<x&&(f=v,d=x,o=p),f<0?-1:(i[0]=f,i[1]=d,i[2]=o,e.eq(this.cells,i,r))}}();function t(i,x){for(var p=i.cells(),v=p.length,f=0;f<v;++f){var d=p[f],o=d[0],m=d[1],l=d[2];m<l?m<o&&(d[0]=m,d[1]=l,d[2]=o):l<o&&(d[0]=l,d[1]=o,d[2]=m)}p.sort(r);for(var w=new Array(v),f=0;f<w.length;++f)w[f]=0;var _=[],c=[],b=new Array(3*v),u=new Array(3*v),L=null;x&&(L=[]);for(var T=new a(p,b,u,w,_,c,L),f=0;f<v;++f)for(var d=p[f],k=0;k<3;++k){var o=d[k],m=d[(k+1)%3],P=b[3*f+k]=T.locate(m,o,i.opposite(m,o)),z=u[3*f+k]=i.isConstraint(o,m);P<0&&(z?c.push(f):(_.push(f),w[f]=1),x&&L.push([m,o,-1]))}return T}function h(i,x,p){for(var v=0,f=0;f<i.length;++f)x[f]===p&&(i[v++]=i[f]);return i.length=v,i}function s(i,x,p){var v=t(i,p);if(x===0)return p?v.cells.concat(v.boundary):v.cells;for(var f=1,d=v.active,o=v.next,m=v.flags,l=v.cells,w=v.constraint,_=v.neighbor;d.length>0||o.length>0;){for(;d.length>0;){var c=d.pop();if(m[c]!==-f){m[c]=f,l[c];for(var b=0;b<3;++b){var u=_[3*c+b];u>=0&&m[u]===0&&(w[3*c+b]?o.push(u):(d.push(u),m[u]=f))}}}var L=o;o=d,d=L,o.length=0,f=-f}var T=h(l,m,x);return p?T.concat(v.boundary):T}},{"binary-search-bounds":31}],45:[function(g,S,M){var e=g("binary-search-bounds"),a=g("robust-orientation")[3],n=0,r=1,t=2;S.exports=o;function h(m,l,w,_,c){this.a=m,this.b=l,this.idx=w,this.lowerIds=_,this.upperIds=c}function s(m,l,w,_){this.a=m,this.b=l,this.type=w,this.idx=_}function i(m,l){var w=m.a[0]-l.a[0]||m.a[1]-l.a[1]||m.type-l.type;return w||m.type!==n&&(w=a(m.a,m.b,l.b),w)?w:m.idx-l.idx}function x(m,l){return a(m.a,m.b,l)}function p(m,l,w,_,c){for(var b=e.lt(l,_,x),u=e.gt(l,_,x),L=b;L<u;++L){for(var T=l[L],k=T.lowerIds,z=k.length;z>1&&a(w[k[z-2]],w[k[z-1]],_)>0;)m.push([k[z-1],k[z-2],c]),z-=1;k.length=z,k.push(c);for(var P=T.upperIds,z=P.length;z>1&&a(w[P[z-2]],w[P[z-1]],_)<0;)m.push([P[z-2],P[z-1],c]),z-=1;P.length=z,P.push(c)}}function v(m,l){var w;return m.a[0]<l.a[0]?w=a(m.a,m.b,l.a):w=a(l.b,l.a,m.a),w||(l.b[0]<m.b[0]?w=a(m.a,m.b,l.b):w=a(l.b,l.a,m.b),w||m.idx-l.idx)}function f(m,l,w){var _=e.le(m,w,v),c=m[_],b=c.upperIds,u=b[b.length-1];c.upperIds=[u],m.splice(_+1,0,new h(w.a,w.b,w.idx,[u],b))}function d(m,l,w){var _=w.a;w.a=w.b,w.b=_;var c=e.eq(m,w,v),b=m[c],u=m[c-1];u.upperIds=b.upperIds,m.splice(c,1)}function o(m,l){for(var w=m.length,_=l.length,c=[],b=0;b<w;++b)c.push(new s(m[b],null,n,b));for(var b=0;b<_;++b){var u=l[b],L=m[u[0]],T=m[u[1]];L[0]<T[0]?c.push(new s(L,T,t,b),new s(T,L,r,b)):L[0]>T[0]&&c.push(new s(T,L,t,b),new s(L,T,r,b))}c.sort(i);for(var k=c[0].a[0]-(1+Math.abs(c[0].a[0]))*Math.pow(2,-52),P=[new h([k,1],[k,0],-1,[],[])],z=[],b=0,I=c.length;b<I;++b){var D=c[b],R=D.type;R===n?p(z,P,m,D.a,D.idx):R===t?f(P,m,D):d(P,m,D)}return z}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(g,S,M){var e=g("binary-search-bounds");S.exports=t;function a(h,s){this.stars=h,this.edges=s}var n=a.prototype;function r(h,s,i){for(var x=1,p=h.length;x<p;x+=2)if(h[x-1]===s&&h[x]===i){h[x-1]=h[p-2],h[x]=h[p-1],h.length=p-2;return}}n.isConstraint=function(){var h=[0,0];function s(i,x){return i[0]-x[0]||i[1]-x[1]}return function(i,x){return h[0]=Math.min(i,x),h[1]=Math.max(i,x),e.eq(this.edges,h,s)>=0}}(),n.removeTriangle=function(h,s,i){var x=this.stars;r(x[h],s,i),r(x[s],i,h),r(x[i],h,s)},n.addTriangle=function(h,s,i){var x=this.stars;x[h].push(s,i),x[s].push(i,h),x[i].push(h,s)},n.opposite=function(h,s){for(var i=this.stars[s],x=1,p=i.length;x<p;x+=2)if(i[x]===h)return i[x-1];return-1},n.flip=function(h,s){var i=this.opposite(h,s),x=this.opposite(s,h);this.removeTriangle(h,s,i),this.removeTriangle(s,h,x),this.addTriangle(h,x,i),this.addTriangle(s,i,x)},n.edges=function(){for(var h=this.stars,s=[],i=0,x=h.length;i<x;++i)for(var p=h[i],v=0,f=p.length;v<f;v+=2)s.push([p[v],p[v+1]]);return s},n.cells=function(){for(var h=this.stars,s=[],i=0,x=h.length;i<x;++i)for(var p=h[i],v=0,f=p.length;v<f;v+=2){var d=p[v],o=p[v+1];i<Math.min(d,o)&&s.push([i,d,o])}return s};function t(h,s){for(var i=new Array(h),x=0;x<h;++x)i[x]=[];return new a(i,s)}},{"binary-search-bounds":31}],47:[function(g,S,M){S.exports=e;function e(a){for(var n=1,r=1;r<a.length;++r)for(var t=0;t<r;++t)if(a[r]<a[t])n=-n;else if(a[t]===a[r])return 0;return n}},{}],48:[function(g,S,M){var e=g("dup"),a=g("robust-linear-solve");function n(h,s){for(var i=0,x=h.length,p=0;p<x;++p)i+=h[p]*s[p];return i}function r(h){var s=h.length;if(s===0)return[];h[0].length;var i=e([h.length+1,h.length+1],1),x=e([h.length+1],1);i[s][s]=0;for(var p=0;p<s;++p){for(var v=0;v<=p;++v)i[v][p]=i[p][v]=2*n(h[p],h[v]);x[p]=n(h[p],h[p])}for(var f=a(i,x),d=0,o=f[s+1],p=0;p<o.length;++p)d+=o[p];for(var m=new Array(s),p=0;p<s;++p){for(var o=f[p],l=0,v=0;v<o.length;++v)l+=o[v];m[p]=l/d}return m}function t(h){if(h.length===0)return[];for(var s=h[0].length,i=e([s]),x=r(h),p=0;p<h.length;++p)for(var v=0;v<s;++v)i[v]+=h[p][v]*x[p];return i}t.barycenetric=r,S.exports=t},{dup:65,"robust-linear-solve":283}],49:[function(g,S,M){S.exports=a;var e=g("circumcenter");function a(n){for(var r=e(n),t=0,h=0;h<n.length;++h)for(var s=n[h],i=0;i<r.length;++i)t+=Math.pow(s[i]-r[i],2);return Math.sqrt(t/n.length)}},{circumcenter:48}],50:[function(g,S,M){S.exports=L;var e=g("union-find"),a=g("box-intersect"),n=g("robust-segment-intersect"),r=g("big-rat"),t=g("big-rat/cmp"),h=g("big-rat/to-float"),s=g("rat-vec"),i=g("nextafter"),x=g("./lib/rat-seg-intersect");function p(T){var k=h(T);return[i(k,-1/0),i(k,1/0)]}function v(T,k){for(var P=new Array(k.length),z=0;z<k.length;++z){var I=k[z],D=T[I[0]],R=T[I[1]];P[z]=[i(Math.min(D[0],R[0]),-1/0),i(Math.min(D[1],R[1]),-1/0),i(Math.max(D[0],R[0]),1/0),i(Math.max(D[1],R[1]),1/0)]}return P}function f(T){for(var k=new Array(T.length),P=0;P<T.length;++P){var z=T[P];k[P]=[i(z[0],-1/0),i(z[1],-1/0),i(z[0],1/0),i(z[1],1/0)]}return k}function d(T,k,P){var z=[];return a(P,function(I,D){var R=k[I],O=k[D];if(!(R[0]===O[0]||R[0]===O[1]||R[1]===O[0]||R[1]===O[1])){var F=T[R[0]],N=T[R[1]],G=T[O[0]],K=T[O[1]];n(F,N,G,K)&&z.push([I,D])}}),z}function o(T,k,P,z){var I=[];return a(P,z,function(D,R){var O=k[D];if(!(O[0]===R||O[1]===R)){var F=T[R],N=T[O[0]],G=T[O[1]];n(N,G,F,F)&&I.push([D,R])}}),I}function m(T,k,P,z,I){var D,R,O=T.map(function(ie){return[r(ie[0]),r(ie[1])]});for(D=0;D<P.length;++D){var F=P[D];R=F[0];var N=F[1],G=k[R],K=k[N],W=x(s(T[G[0]]),s(T[G[1]]),s(T[K[0]]),s(T[K[1]]));if(W){var Y=T.length;T.push([h(W[0]),h(W[1])]),O.push(W),z.push([R,Y],[N,Y])}}for(z.sort(function(ie,se){if(ie[0]!==se[0])return ie[0]-se[0];var ae=O[ie[1]],oe=O[se[1]];return t(ae[0],oe[0])||t(ae[1],oe[1])}),D=z.length-1;D>=0;--D){var re=z[D];R=re[0];var ue=k[R],j=ue[0],q=ue[1],H=T[j],U=T[q];if((H[0]-U[0]||H[1]-U[1])<0){var $=j;j=q,q=$}ue[0]=j;var ne=ue[1]=re[1],X;for(I&&(X=ue[2]);D>0&&z[D-1][0]===R;){var re=z[--D],Q=re[1];I?k.push([ne,Q,X]):k.push([ne,Q]),ne=Q}I?k.push([ne,q,X]):k.push([ne,q])}return O}function l(T,k,P){for(var z=k.length,I=new e(z),D=[],R=0;R<k.length;++R){var O=k[R],F=p(O[0]),N=p(O[1]);D.push([i(F[0],-1/0),i(N[0],-1/0),i(F[1],1/0),i(N[1],1/0)])}a(D,function(re,ue){I.link(re,ue)});for(var G=!0,K=new Array(z),R=0;R<z;++R){var W=I.find(R);W!==R&&(G=!1,T[W]=[Math.min(T[R][0],T[W][0]),Math.min(T[R][1],T[W][1])])}if(G)return null;for(var Y=0,R=0;R<z;++R){var W=I.find(R);W===R?(K[R]=Y,T[Y++]=T[R]):K[R]=-1}T.length=Y;for(var R=0;R<z;++R)K[R]<0&&(K[R]=K[I.find(R)]);return K}function w(T,k){return T[0]-k[0]||T[1]-k[1]}function _(T,k){var P=T[0]-k[0]||T[1]-k[1];return P||(T[2]<k[2]?-1:T[2]>k[2]?1:0)}function c(T,k,P){if(T.length!==0){if(k)for(var z=0;z<T.length;++z){var I=T[z],D=k[I[0]],R=k[I[1]];I[0]=Math.min(D,R),I[1]=Math.max(D,R)}else for(var z=0;z<T.length;++z){var I=T[z],D=I[0],R=I[1];I[0]=Math.min(D,R),I[1]=Math.max(D,R)}P?T.sort(_):T.sort(w);for(var O=1,z=1;z<T.length;++z){var F=T[z-1],N=T[z];N[0]===F[0]&&N[1]===F[1]&&(!P||N[2]===F[2])||(T[O++]=N)}T.length=O}}function b(T,k,P){var z=l(T,[],f(T));return c(k,z,P),!!z}function u(T,k,P){var z=v(T,k),I=d(T,k,z),D=f(T),R=o(T,k,z,D),O=m(T,k,I,R,P),F=l(T,O);return c(k,F,P),F?!0:I.length>0||R.length>0}function L(T,k,P){var z;if(P){z=k;for(var I=new Array(k.length),D=0;D<k.length;++D){var R=k[D];I[D]=[R[0],R[1],P[D]]}k=I}for(var O=b(T,k,!!P);u(T,k,!!P);)O=!0;if(P&&O){z.length=0,P.length=0;for(var D=0;D<k.length;++D){var R=k[D];z.push([R[0],R[1]]),P.push(R[2])}}return O}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(g,S,M){S.exports=x;var e=g("big-rat/mul"),a=g("big-rat/div"),n=g("big-rat/sub"),r=g("big-rat/sign"),t=g("rat-vec/sub"),h=g("rat-vec/add"),s=g("rat-vec/muls");function i(p,v){return n(e(p[0],v[1]),e(p[1],v[0]))}function x(p,v,f,d){var o=t(v,p),m=t(d,f),l=i(o,m);if(r(l)===0)return null;var w=t(p,f),_=i(m,w),c=a(_,l),b=s(o,c),u=h(p,b);return u}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(g,S,M){S.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(g,S,M){var e=g("./colorScale"),a=g("lerp");S.exports=n;function n(s){var i,x,p,v,f,d,o,m,c,l,w;if(s||(s={}),m=(s.nshades||72)-1,o=s.format||"hex",d=s.colormap,d||(d="jet"),typeof d=="string"){if(d=d.toLowerCase(),!e[d])throw Error(d+" not a supported colorscale");f=e[d]}else if(Array.isArray(d))f=d.slice();else throw Error("unsupported colormap option",d);if(f.length>m+1)throw new Error(d+" map requires nshades to be at least size "+f.length);Array.isArray(s.alpha)?s.alpha.length!==2?l=[1,1]:l=s.alpha.slice():typeof s.alpha=="number"?l=[s.alpha,s.alpha]:l=[1,1],i=f.map(function(L){return Math.round(L.index*m)}),l[0]=Math.min(Math.max(l[0],0),1),l[1]=Math.min(Math.max(l[1],0),1);var _=f.map(function(L,T){var k=f[T].index,P=f[T].rgb.slice();return P.length===4&&P[3]>=0&&P[3]<=1||(P[3]=l[0]+(l[1]-l[0])*k),P}),c=[];for(w=0;w<i.length-1;++w){v=i[w+1]-i[w],x=_[w],p=_[w+1];for(var b=0;b<v;b++){var u=b/v;c.push([Math.round(a(x[0],p[0],u)),Math.round(a(x[1],p[1],u)),Math.round(a(x[2],p[2],u)),a(x[3],p[3],u)])}}return c.push(f[f.length-1].rgb.concat(l[1])),o==="hex"?c=c.map(t):o==="rgbaString"?c=c.map(h):o==="float"&&(c=c.map(r)),c}function r(s){return[s[0]/255,s[1]/255,s[2]/255,s[3]]}function t(s){for(var i,x="#",p=0;p<3;++p)i=s[p],i=i.toString(16),x+=("00"+i).substr(i.length);return x}function h(s){return"rgba("+s.join(",")+")"}},{"./colorScale":52,lerp:240}],54:[function(g,S,M){S.exports=s;var e=g("robust-orientation"),a=g("signum"),n=g("two-sum"),r=g("robust-product"),t=g("robust-sum");function h(i,x,p){var v=n(i[0],-x[0]),f=n(i[1],-x[1]),d=n(p[0],-x[0]),o=n(p[1],-x[1]),m=t(r(v,d),r(f,o));return m[m.length-1]>=0}function s(i,x,p,v){var f=e(x,p,v);if(f===0){var d=a(e(i,x,p)),o=a(e(i,x,v));if(d===o){if(d===0){var m=h(i,x,p),l=h(i,x,v);return m===l?0:m?1:-1}return 0}else{if(o===0)return d>0||h(i,x,v)?-1:1;if(d===0)return o>0||h(i,x,p)?1:-1}return a(o-d)}var w=e(i,x,p);if(w>0)return f>0&&e(i,x,v)>0?1:-1;if(w<0)return f>0||e(i,x,v)>0?1:-1;var _=e(i,x,v);return _>0||h(i,x,p)?1:-1}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(g,S,M){S.exports=function(a){return a<0?-1:a>0?1:0}},{}],56:[function(g,S,M){S.exports=n;var e=Math.min;function a(r,t){return r-t}function n(r,t){var h=r.length,s=r.length-t.length;if(s)return s;switch(h){case 0:return 0;case 1:return r[0]-t[0];case 2:return r[0]+r[1]-t[0]-t[1]||e(r[0],r[1])-e(t[0],t[1]);case 3:var i=r[0]+r[1],x=t[0]+t[1];if(s=i+r[2]-(x+t[2]),s)return s;var p=e(r[0],r[1]),v=e(t[0],t[1]);return e(p,r[2])-e(v,t[2])||e(p+r[2],i)-e(v+t[2],x);case 4:var f=r[0],d=r[1],o=r[2],m=r[3],l=t[0],w=t[1],_=t[2],c=t[3];return f+d+o+m-(l+w+_+c)||e(f,d,o,m)-e(l,w,_,c,l)||e(f+d,f+o,f+m,d+o,d+m,o+m)-e(l+w,l+_,l+c,w+_,w+c,_+c)||e(f+d+o,f+d+m,f+o+m,d+o+m)-e(l+w+_,l+w+c,l+_+c,w+_+c);default:for(var b=r.slice().sort(a),u=t.slice().sort(a),L=0;L<h;++L)if(s=b[L]-u[L],s)return s;return 0}}},{}],57:[function(g,S,M){var e=g("compare-cell"),a=g("cell-orientation");S.exports=n;function n(r,t){return e(r,t)||a(r)-a(t)}},{"cell-orientation":47,"compare-cell":56}],58:[function(g,S,M){var e=g("./lib/ch1d"),a=g("./lib/ch2d"),n=g("./lib/chnd");S.exports=r;function r(t){var h=t.length;if(h===0)return[];if(h===1)return[[0]];var s=t[0].length;return s===0?[]:s===1?e(t):s===2?a(t):n(t,s)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(g,S,M){S.exports=e;function e(a){for(var n=0,r=0,t=1;t<a.length;++t)a[t][0]<a[n][0]&&(n=t),a[t][0]>a[r][0]&&(r=t);return n<r?[[n],[r]]:n>r?[[r],[n]]:[[n]]}},{}],60:[function(g,S,M){S.exports=a;var e=g("monotone-convex-hull-2d");function a(n){var r=e(n),t=r.length;if(t<=2)return[];for(var h=new Array(t),s=r[t-1],i=0;i<t;++i){var x=r[i];h[i]=[s,x],s=x}return h}},{"monotone-convex-hull-2d":246}],61:[function(g,S,M){S.exports=t;var e=g("incremental-convex-hull"),a=g("affine-hull");function n(h,s){for(var i=h.length,x=new Array(i),p=0;p<s.length;++p)x[p]=h[s[p]];for(var v=s.length,p=0;p<i;++p)s.indexOf(p)<0&&(x[v++]=h[p]);return x}function r(h,s){for(var i=h.length,x=s.length,p=0;p<i;++p)for(var v=h[p],f=0;f<v.length;++f){var d=v[f];if(d<x)v[f]=s[d];else{d=d-x;for(var o=0;o<x;++o)d>=s[o]&&(d+=1);v[f]=d}}return h}function t(h,s){try{return e(h,!0)}catch{var i=a(h);if(i.length<=s)return[];var x=n(h,i),p=e(x,!0);return r(p,i)}}},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(g,S,M){function e(n,r,t,h,s,i){var x=6*s*s-6*s,p=3*s*s-4*s+1,v=-6*s*s+6*s,f=3*s*s-2*s;if(n.length){i||(i=new Array(n.length));for(var d=n.length-1;d>=0;--d)i[d]=x*n[d]+p*r[d]+v*t[d]+f*h[d];return i}return x*n+p*r+v*t[d]+f*h}function a(n,r,t,h,s,i){var x=s-1,p=s*s,v=x*x,f=(1+2*s)*v,d=s*v,o=p*(3-2*s),m=p*x;if(n.length){i||(i=new Array(n.length));for(var l=n.length-1;l>=0;--l)i[l]=f*n[l]+d*r[l]+o*t[l]+m*h[l];return i}return f*n+d*r+o*t+m*h}S.exports=a,S.exports.derivative=e},{}],63:[function(g,S,M){var e=g("incremental-convex-hull"),a=g("uniq");S.exports=h;function n(s,i){this.point=s,this.index=i}function r(s,i){for(var x=s.point,p=i.point,v=x.length,f=0;f<v;++f){var d=p[f]-x[f];if(d)return d}return 0}function t(s,i,x){if(s===1)return x?[[-1,0]]:[];var p=i.map(function(m,l){return[m[0],l]});p.sort(function(m,l){return m[0]-l[0]});for(var v=new Array(s-1),f=1;f<s;++f){var d=p[f-1],o=p[f];v[f-1]=[d[1],o[1]]}return x&&v.push([-1,v[0][1]],[v[s-1][1],-1]),v}function h(s,i){var x=s.length;if(x===0)return[];var p=s[0].length;if(p<1)return[];if(p===1)return t(x,s,i);for(var v=new Array(x),f=1,d=0;d<x;++d){for(var o=s[d],m=new Array(p+1),l=0,w=0;w<p;++w){var _=o[w];m[w]=_,l+=_*_}m[p]=l,v[d]=new n(m,d),f=Math.max(l,f)}a(v,r),x=v.length;for(var c=new Array(x+p+1),b=new Array(x+p+1),u=(p+1)*(p+1)*f,L=new Array(p+1),d=0;d<=p;++d)L[d]=0;L[p]=u,c[0]=L.slice(),b[0]=-1;for(var d=0;d<=p;++d){var m=L.slice();m[d]=1,c[d+1]=m,b[d+1]=-1}for(var d=0;d<x;++d){var T=v[d];c[d+p+1]=T.point,b[d+p+1]=T.index}var k=e(c,!1);if(i?k=k.filter(function(P){for(var z=0,I=0;I<=p;++I){var D=b[P[I]];if(D<0&&++z>=2)return!1;P[I]=D}return!0}):k=k.filter(function(P){for(var z=0;z<=p;++z){var I=b[P[z]];if(I<0)return!1;P[z]=I}return!0}),p&1)for(var d=0;d<k.length;++d){var T=k[d],m=T[0];T[0]=T[1],T[1]=m}return k}},{"incremental-convex-hull":233,uniq:310}],64:[function(g,S,M){(function(e){(function(){var a=!1;if(typeof Float64Array<"u"){var n=new Float64Array(1),r=new Uint32Array(n.buffer);if(n[0]=1,a=!0,r[1]===1072693248){let h=function(x,p){return r[0]=x,r[1]=p,n[0]},s=function(x){return n[0]=x,r[0]},i=function(x){return n[0]=x,r[1]};S.exports=function(p){return n[0]=p,[r[0],r[1]]},S.exports.pack=h,S.exports.lo=s,S.exports.hi=i}else if(r[0]===1072693248){let h=function(x,p){return r[1]=x,r[0]=p,n[0]},s=function(x){return n[0]=x,r[1]},i=function(x){return n[0]=x,r[0]};S.exports=function(p){return n[0]=p,[r[1],r[0]]},S.exports.pack=h,S.exports.lo=s,S.exports.hi=i}else a=!1}if(!a){let h=function(x,p){return t.writeUInt32LE(x,0,!0),t.writeUInt32LE(p,4,!0),t.readDoubleLE(0,!0)},s=function(x){return t.writeDoubleLE(x,0,!0),t.readUInt32LE(0,!0)},i=function(x){return t.writeDoubleLE(x,0,!0),t.readUInt32LE(4,!0)};var t=new e(8);S.exports=function(p){return t.writeDoubleLE(p,0,!0),[t.readUInt32LE(0,!0),t.readUInt32LE(4,!0)]},S.exports.pack=h,S.exports.lo=s,S.exports.hi=i}S.exports.sign=function(h){return S.exports.hi(h)>>>31},S.exports.exponent=function(h){var s=S.exports.hi(h);return(s<<1>>>21)-1023},S.exports.fraction=function(h){var s=S.exports.lo(h),i=S.exports.hi(h),x=i&(1<<20)-1;return i&2146435072&&(x+=1<<20),[s,x]},S.exports.denormalized=function(h){var s=S.exports.hi(h);return!(s&2146435072)}}).call(this)}).call(this,g("buffer").Buffer)},{buffer:3}],65:[function(g,S,M){function e(r,t,h){var s=r[h]|0;if(s<=0)return[];var i=new Array(s),x;if(h===r.length-1)for(x=0;x<s;++x)i[x]=t;else for(x=0;x<s;++x)i[x]=e(r,t,h+1);return i}function a(r,t){var h,s;for(h=new Array(r),s=0;s<r;++s)h[s]=t;return h}function n(r,t){switch(typeof t>"u"&&(t=0),typeof r){case"number":if(r>0)return a(r|0,t);break;case"object":if(typeof r.length=="number")return e(r,t,0);break}return[]}S.exports=n},{}],66:[function(g,S,M){S.exports=a;var e=g("uniq");function a(n,r){var t=n.length;if(typeof r!="number"){r=0;for(var h=0;h<t;++h){var s=n[h];r=Math.max(r,s[0],s[1])}r=(r|0)+1}r=r|0;for(var i=new Array(r),h=0;h<r;++h)i[h]=[];for(var h=0;h<t;++h){var s=n[h];i[s[0]].push(s[1]),i[s[1]].push(s[0])}for(var x=0;x<r;++x)e(i[x],function(p,v){return p-v});return i}},{uniq:310}],67:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n||0,h=r||1;return[[a[12]+a[0],a[13]+a[1],a[14]+a[2],a[15]+a[3]],[a[12]-a[0],a[13]-a[1],a[14]-a[2],a[15]-a[3]],[a[12]+a[4],a[13]+a[5],a[14]+a[6],a[15]+a[7]],[a[12]-a[4],a[13]-a[5],a[14]-a[6],a[15]-a[7]],[t*a[12]+a[8],t*a[13]+a[9],t*a[14]+a[10],t*a[15]+a[11]],[h*a[12]-a[8],h*a[13]-a[9],h*a[14]-a[10],h*a[15]-a[11]]]}},{}],68:[function(g,S,M){S.exports=s;var e=g("cubic-hermite"),a=g("binary-search-bounds");function n(i,x,p){return Math.min(x,Math.max(i,p))}function r(i,x,p){this.dimension=i.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var v=0;v<this.dimension;++v)this.bounds[0][v]=-1/0,this.bounds[1][v]=1/0;this._state=i.slice().reverse(),this._velocity=x.slice().reverse(),this._time=[p],this._scratch=[i.slice(),i.slice(),i.slice(),i.slice(),i.slice()]}var t=r.prototype;t.flush=function(i){var x=a.gt(this._time,i)-1;x<=0||(this._time.splice(0,x),this._state.splice(0,x*this.dimension),this._velocity.splice(0,x*this.dimension))},t.curve=function(i){var x=this._time,p=x.length,v=a.le(x,i),f=this._scratch[0],d=this._state,o=this._velocity,m=this.dimension,l=this.bounds;if(v<0)for(var w=m-1,_=0;_<m;++_,--w)f[_]=d[w];else if(v>=p-1)for(var w=d.length-1,c=i-x[p-1],_=0;_<m;++_,--w)f[_]=d[w]+c*o[w];else{for(var w=m*(v+1)-1,b=x[v],u=x[v+1],L=u-b||1,T=this._scratch[1],k=this._scratch[2],P=this._scratch[3],z=this._scratch[4],I=!0,_=0;_<m;++_,--w)T[_]=d[w],P[_]=o[w]*L,k[_]=d[w+m],z[_]=o[w+m]*L,I=I&&T[_]===k[_]&&P[_]===z[_]&&P[_]===0;if(I)for(var _=0;_<m;++_)f[_]=T[_];else e(T,P,k,z,(i-b)/L,f)}for(var D=l[0],R=l[1],_=0;_<m;++_)f[_]=n(D[_],R[_],f[_]);return f},t.dcurve=function(i){var x=this._time,p=x.length,v=a.le(x,i),f=this._scratch[0],d=this._state,o=this._velocity,m=this.dimension;if(v>=p-1){var l=d.length-1;i-x[p-1];for(var w=0;w<m;++w,--l)f[w]=o[l]}else{for(var l=m*(v+1)-1,_=x[v],c=x[v+1],b=c-_||1,u=this._scratch[1],L=this._scratch[2],T=this._scratch[3],k=this._scratch[4],P=!0,w=0;w<m;++w,--l)u[w]=d[l],T[w]=o[l]*b,L[w]=d[l+m],k[w]=o[l+m]*b,P=P&&u[w]===L[w]&&T[w]===k[w]&&T[w]===0;if(P)for(var w=0;w<m;++w)f[w]=0;else{e.derivative(u,T,L,k,(i-_)/b,f);for(var w=0;w<m;++w)f[w]/=b}}return f},t.lastT=function(){var i=this._time;return i[i.length-1]},t.stable=function(){for(var i=this._velocity,x=i.length,p=this.dimension-1;p>=0;--p)if(i[--x])return!1;return!0},t.jump=function(i){var x=this.lastT(),p=this.dimension;if(!(i<x||arguments.length!==p+1)){var v=this._state,f=this._velocity,d=v.length-this.dimension,o=this.bounds,m=o[0],l=o[1];this._time.push(x,i);for(var w=0;w<2;++w)for(var _=0;_<p;++_)v.push(v[d++]),f.push(0);this._time.push(i);for(var _=p;_>0;--_)v.push(n(m[_-1],l[_-1],arguments[_])),f.push(0)}},t.push=function(i){var x=this.lastT(),p=this.dimension;if(!(i<x||arguments.length!==p+1)){var v=this._state,f=this._velocity,d=v.length-this.dimension,o=i-x,m=this.bounds,l=m[0],w=m[1],_=o>1e-6?1/o:0;this._time.push(i);for(var c=p;c>0;--c){var b=n(l[c-1],w[c-1],arguments[c]);v.push(b),f.push((b-v[d++])*_)}}},t.set=function(i){var x=this.dimension;if(!(i<this.lastT()||arguments.length!==x+1)){var p=this._state,v=this._velocity,f=this.bounds,d=f[0],o=f[1];this._time.push(i);for(var m=x;m>0;--m)p.push(n(d[m-1],o[m-1],arguments[m])),v.push(0)}},t.move=function(i){var x=this.lastT(),p=this.dimension;if(!(i<=x||arguments.length!==p+1)){var v=this._state,f=this._velocity,d=v.length-this.dimension,o=this.bounds,m=o[0],l=o[1],w=i-x,_=w>1e-6?1/w:0;this._time.push(i);for(var c=p;c>0;--c){var b=arguments[c];v.push(n(m[c-1],l[c-1],v[d++]+b)),f.push(b*_)}}},t.idle=function(i){var x=this.lastT();if(!(i<x)){var p=this.dimension,v=this._state,f=this._velocity,d=v.length-p,o=this.bounds,m=o[0],l=o[1],w=i-x;this._time.push(i);for(var _=p-1;_>=0;--_)v.push(n(m[_],l[_],v[d]+w*f[d])),f.push(0),d+=1}};function h(i){for(var x=new Array(i),p=0;p<i;++p)x[p]=0;return x}function s(i,x,p){switch(arguments.length){case 0:return new r([0],[0],0);case 1:if(typeof i=="number"){var v=h(i);return new r(v,v,0)}else return new r(i,h(i.length),0);case 2:if(typeof x=="number"){var v=h(i.length);return new r(i,v,+x)}else p=0;case 3:if(i.length!==x.length)throw new Error("state and velocity lengths must match");return new r(i,x,p)}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(g,S,M){S.exports=w;var e=0,a=1;function n(_,c,b,u,L,T){this._color=_,this.key=c,this.value=b,this.left=u,this.right=L,this._count=T}function r(_){return new n(_._color,_.key,_.value,_.left,_.right,_._count)}function t(_,c){return new n(_,c.key,c.value,c.left,c.right,c._count)}function h(_){_._count=1+(_.left?_.left._count:0)+(_.right?_.right._count:0)}function s(_,c){this._compare=_,this.root=c}var i=s.prototype;Object.defineProperty(i,"keys",{get:function(){var _=[];return this.forEach(function(c,b){_.push(c)}),_}}),Object.defineProperty(i,"values",{get:function(){var _=[];return this.forEach(function(c,b){_.push(b)}),_}}),Object.defineProperty(i,"length",{get:function(){return this.root?this.root._count:0}}),i.insert=function(_,c){for(var b=this._compare,u=this.root,L=[],T=[];u;){var k=b(_,u.key);L.push(u),T.push(k),k<=0?u=u.left:u=u.right}L.push(new n(e,_,c,null,null,1));for(var P=L.length-2;P>=0;--P){var u=L[P];T[P]<=0?L[P]=new n(u._color,u.key,u.value,L[P+1],u.right,u._count+1):L[P]=new n(u._color,u.key,u.value,u.left,L[P+1],u._count+1)}for(var P=L.length-1;P>1;--P){var z=L[P-1],u=L[P];if(z._color===a||u._color===a)break;var I=L[P-2];if(I.left===z)if(z.left===u){var D=I.right;if(D&&D._color===e)z._color=a,I.right=t(a,D),I._color=e,P-=1;else{if(I._color=e,I.left=z.right,z._color=a,z.right=I,L[P-2]=z,L[P-1]=u,h(I),h(z),P>=3){var R=L[P-3];R.left===I?R.left=z:R.right=z}break}}else{var D=I.right;if(D&&D._color===e)z._color=a,I.right=t(a,D),I._color=e,P-=1;else{if(z.right=u.left,I._color=e,I.left=u.right,u._color=a,u.left=z,u.right=I,L[P-2]=u,L[P-1]=z,h(I),h(z),h(u),P>=3){var R=L[P-3];R.left===I?R.left=u:R.right=u}break}}else if(z.right===u){var D=I.left;if(D&&D._color===e)z._color=a,I.left=t(a,D),I._color=e,P-=1;else{if(I._color=e,I.right=z.left,z._color=a,z.left=I,L[P-2]=z,L[P-1]=u,h(I),h(z),P>=3){var R=L[P-3];R.right===I?R.right=z:R.left=z}break}}else{var D=I.left;if(D&&D._color===e)z._color=a,I.left=t(a,D),I._color=e,P-=1;else{if(z.left=u.right,I._color=e,I.right=u.left,u._color=a,u.right=z,u.left=I,L[P-2]=u,L[P-1]=z,h(I),h(z),h(u),P>=3){var R=L[P-3];R.right===I?R.right=u:R.left=u}break}}}return L[0]._color=a,new s(b,L[0])};function x(_,c){if(c.left){var b=x(_,c.left);if(b)return b}var b=_(c.key,c.value);if(b)return b;if(c.right)return x(_,c.right)}function p(_,c,b,u){var L=c(_,u.key);if(L<=0){if(u.left){var T=p(_,c,b,u.left);if(T)return T}var T=b(u.key,u.value);if(T)return T}if(u.right)return p(_,c,b,u.right)}function v(_,c,b,u,L){var T=b(_,L.key),k=b(c,L.key),P;if(T<=0&&(L.left&&(P=v(_,c,b,u,L.left),P)||k>0&&(P=u(L.key,L.value),P)))return P;if(k>0&&L.right)return v(_,c,b,u,L.right)}i.forEach=function(c,b,u){if(this.root)switch(arguments.length){case 1:return x(c,this.root);case 2:return p(b,this._compare,c,this.root);case 3:return this._compare(b,u)>=0?void 0:v(b,u,this._compare,c,this.root)}},Object.defineProperty(i,"begin",{get:function(){for(var _=[],c=this.root;c;)_.push(c),c=c.left;return new f(this,_)}}),Object.defineProperty(i,"end",{get:function(){for(var _=[],c=this.root;c;)_.push(c),c=c.right;return new f(this,_)}}),i.at=function(_){if(_<0)return new f(this,[]);for(var c=this.root,b=[];;){if(b.push(c),c.left){if(_<c.left._count){c=c.left;continue}_-=c.left._count}if(!_)return new f(this,b);if(_-=1,c.right){if(_>=c.right._count)break;c=c.right}else break}return new f(this,[])},i.ge=function(_){for(var c=this._compare,b=this.root,u=[],L=0;b;){var T=c(_,b.key);u.push(b),T<=0&&(L=u.length),T<=0?b=b.left:b=b.right}return u.length=L,new f(this,u)},i.gt=function(_){for(var c=this._compare,b=this.root,u=[],L=0;b;){var T=c(_,b.key);u.push(b),T<0&&(L=u.length),T<0?b=b.left:b=b.right}return u.length=L,new f(this,u)},i.lt=function(_){for(var c=this._compare,b=this.root,u=[],L=0;b;){var T=c(_,b.key);u.push(b),T>0&&(L=u.length),T<=0?b=b.left:b=b.right}return u.length=L,new f(this,u)},i.le=function(_){for(var c=this._compare,b=this.root,u=[],L=0;b;){var T=c(_,b.key);u.push(b),T>=0&&(L=u.length),T<0?b=b.left:b=b.right}return u.length=L,new f(this,u)},i.find=function(_){for(var c=this._compare,b=this.root,u=[];b;){var L=c(_,b.key);if(u.push(b),L===0)return new f(this,u);L<=0?b=b.left:b=b.right}return new f(this,[])},i.remove=function(_){var c=this.find(_);return c?c.remove():this},i.get=function(_){for(var c=this._compare,b=this.root;b;){var u=c(_,b.key);if(u===0)return b.value;u<=0?b=b.left:b=b.right}};function f(_,c){this.tree=_,this._stack=c}var d=f.prototype;Object.defineProperty(d,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(d,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),d.clone=function(){return new f(this.tree,this._stack.slice())};function o(_,c){_.key=c.key,_.value=c.value,_.left=c.left,_.right=c.right,_._color=c._color,_._count=c._count}function m(_){for(var c,b,u,L,T=_.length-1;T>=0;--T){if(c=_[T],T===0){c._color=a;return}if(b=_[T-1],b.left===c){if(u=b.right,u.right&&u.right._color===e){if(u=b.right=r(u),L=u.right=r(u.right),b.right=u.left,u.left=b,u.right=L,u._color=b._color,c._color=a,b._color=a,L._color=a,h(b),h(u),T>1){var k=_[T-2];k.left===b?k.left=u:k.right=u}_[T-1]=u;return}else if(u.left&&u.left._color===e){if(u=b.right=r(u),L=u.left=r(u.left),b.right=L.left,u.left=L.right,L.left=b,L.right=u,L._color=b._color,b._color=a,u._color=a,c._color=a,h(b),h(u),h(L),T>1){var k=_[T-2];k.left===b?k.left=L:k.right=L}_[T-1]=L;return}if(u._color===a)if(b._color===e){b._color=a,b.right=t(e,u);return}else{b.right=t(e,u);continue}else{if(u=r(u),b.right=u.left,u.left=b,u._color=b._color,b._color=e,h(b),h(u),T>1){var k=_[T-2];k.left===b?k.left=u:k.right=u}_[T-1]=u,_[T]=b,T+1<_.length?_[T+1]=c:_.push(c),T=T+2}}else{if(u=b.left,u.left&&u.left._color===e){if(u=b.left=r(u),L=u.left=r(u.left),b.left=u.right,u.right=b,u.left=L,u._color=b._color,c._color=a,b._color=a,L._color=a,h(b),h(u),T>1){var k=_[T-2];k.right===b?k.right=u:k.left=u}_[T-1]=u;return}else if(u.right&&u.right._color===e){if(u=b.left=r(u),L=u.right=r(u.right),b.left=L.right,u.right=L.left,L.right=b,L.left=u,L._color=b._color,b._color=a,u._color=a,c._color=a,h(b),h(u),h(L),T>1){var k=_[T-2];k.right===b?k.right=L:k.left=L}_[T-1]=L;return}if(u._color===a)if(b._color===e){b._color=a,b.left=t(e,u);return}else{b.left=t(e,u);continue}else{if(u=r(u),b.left=u.right,u.right=b,u._color=b._color,b._color=e,h(b),h(u),T>1){var k=_[T-2];k.right===b?k.right=u:k.left=u}_[T-1]=u,_[T]=b,T+1<_.length?_[T+1]=c:_.push(c),T=T+2}}}}d.remove=function(){var _=this._stack;if(_.length===0)return this.tree;var c=new Array(_.length),b=_[_.length-1];c[c.length-1]=new n(b._color,b.key,b.value,b.left,b.right,b._count);for(var u=_.length-2;u>=0;--u){var b=_[u];b.left===_[u+1]?c[u]=new n(b._color,b.key,b.value,c[u+1],b.right,b._count):c[u]=new n(b._color,b.key,b.value,b.left,c[u+1],b._count)}if(b=c[c.length-1],b.left&&b.right){var L=c.length;for(b=b.left;b.right;)c.push(b),b=b.right;var T=c[L-1];c.push(new n(b._color,T.key,T.value,b.left,b.right,b._count)),c[L-1].key=b.key,c[L-1].value=b.value;for(var u=c.length-2;u>=L;--u)b=c[u],c[u]=new n(b._color,b.key,b.value,b.left,c[u+1],b._count);c[L-1].left=c[L]}if(b=c[c.length-1],b._color===e){var k=c[c.length-2];k.left===b?k.left=null:k.right===b&&(k.right=null),c.pop();for(var u=0;u<c.length;++u)c[u]._count--;return new s(this.tree._compare,c[0])}else if(b.left||b.right){b.left?o(b,b.left):b.right&&o(b,b.right),b._color=a;for(var u=0;u<c.length-1;++u)c[u]._count--;return new s(this.tree._compare,c[0])}else{if(c.length===1)return new s(this.tree._compare,null);for(var u=0;u<c.length;++u)c[u]._count--;var P=c[c.length-2];m(c),P.left===b?P.left=null:P.right=null}return new s(this.tree._compare,c[0])},Object.defineProperty(d,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(d,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(d,"index",{get:function(){var _=0,c=this._stack;if(c.length===0){var b=this.tree.root;return b?b._count:0}else c[c.length-1].left&&(_=c[c.length-1].left._count);for(var u=c.length-2;u>=0;--u)c[u+1]===c[u].right&&(++_,c[u].left&&(_+=c[u].left._count));return _},enumerable:!0}),d.next=function(){var _=this._stack;if(_.length!==0){var c=_[_.length-1];if(c.right)for(c=c.right;c;)_.push(c),c=c.left;else for(_.pop();_.length>0&&_[_.length-1].right===c;)c=_[_.length-1],_.pop()}},Object.defineProperty(d,"hasNext",{get:function(){var _=this._stack;if(_.length===0)return!1;if(_[_.length-1].right)return!0;for(var c=_.length-1;c>0;--c)if(_[c-1].left===_[c])return!0;return!1}}),d.update=function(_){var c=this._stack;if(c.length===0)throw new Error("Can't update empty node!");var b=new Array(c.length),u=c[c.length-1];b[b.length-1]=new n(u._color,u.key,_,u.left,u.right,u._count);for(var L=c.length-2;L>=0;--L)u=c[L],u.left===c[L+1]?b[L]=new n(u._color,u.key,u.value,b[L+1],u.right,u._count):b[L]=new n(u._color,u.key,u.value,u.left,b[L+1],u._count);return new s(this.tree._compare,b[0])},d.prev=function(){var _=this._stack;if(_.length!==0){var c=_[_.length-1];if(c.left)for(c=c.left;c;)_.push(c),c=c.right;else for(_.pop();_.length>0&&_[_.length-1].left===c;)c=_[_.length-1],_.pop()}},Object.defineProperty(d,"hasPrev",{get:function(){var _=this._stack;if(_.length===0)return!1;if(_[_.length-1].left)return!0;for(var c=_.length-1;c>0;--c)if(_[c-1].right===_[c])return!0;return!1}});function l(_,c){return _<c?-1:_>c?1:0}function w(_){return new s(_||l,null)}},{}],70:[function(g,S,M){S.exports=c;var e=g("./lib/text.js"),a=g("./lib/lines.js"),n=g("./lib/background.js"),r=g("./lib/cube.js"),t=g("./lib/ticks.js"),h=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function s(b,u){return b[0]=u[0],b[1]=u[1],b[2]=u[2],b}function i(b){this.gl=b,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=n(b)}var x=i.prototype;x.update=function(b){b=b||{};function u(G,K,W){if(W in b){var Y=b[W],re=this[W],ue;(G?Array.isArray(Y)&&Array.isArray(Y[0]):Array.isArray(Y))?this[W]=ue=[K(Y[0]),K(Y[1]),K(Y[2])]:this[W]=ue=[K(Y),K(Y),K(Y)];for(var j=0;j<3;++j)if(ue[j]!==re[j])return!0}return!1}var L=u.bind(this,!1,Number),T=u.bind(this,!1,Boolean),k=u.bind(this,!1,String),P=u.bind(this,!0,function(G){if(Array.isArray(G)){if(G.length===3)return[+G[0],+G[1],+G[2],1];if(G.length===4)return[+G[0],+G[1],+G[2],+G[3]]}return[0,0,0,1]}),z,I=!1,D=!1;if("bounds"in b)for(var R=b.bounds,O=0;O<2;++O)for(var F=0;F<3;++F)R[O][F]!==this.bounds[O][F]&&(D=!0),this.bounds[O][F]=R[O][F];if("ticks"in b){z=b.ticks,I=!0,this.autoTicks=!1;for(var O=0;O<3;++O)this.tickSpacing[O]=0}else L("tickSpacing")&&(this.autoTicks=!0,D=!0);if(this._firstInit&&("ticks"in b||"tickSpacing"in b||(this.autoTicks=!0),D=!0,I=!0,this._firstInit=!1),D&&this.autoTicks&&(z=t.create(this.bounds,this.tickSpacing),I=!0),I){for(var O=0;O<3;++O)z[O].sort(function(K,W){return K.x-W.x});t.equal(z,this.ticks)?I=!1:this.ticks=z}T("tickEnable"),k("tickFont")&&(I=!0),L("tickSize"),L("tickAngle"),L("tickPad"),P("tickColor");var N=k("labels");k("labelFont")&&(N=!0),T("labelEnable"),L("labelSize"),L("labelPad"),P("labelColor"),T("lineEnable"),T("lineMirror"),L("lineWidth"),P("lineColor"),T("lineTickEnable"),T("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),P("lineTickColor"),T("gridEnable"),L("gridWidth"),P("gridColor"),T("zeroEnable"),P("zeroLineColor"),L("zeroLineWidth"),T("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(N||I)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&I&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=a(this.gl,this.bounds,this.ticks))};function p(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}var v=[new p,new p,new p];function f(b,u,L,T,k){for(var P=b.primalOffset,z=b.primalMinor,I=b.mirrorOffset,D=b.mirrorMinor,R=T[u],O=0;O<3;++O)if(u!==O){var F=P,N=I,G=z,K=D;R&1<<O&&(F=I,N=P,G=D,K=z),F[O]=L[0][O],N[O]=L[1][O],k[O]>0?(G[O]=-1,K[O]=0):(G[O]=0,K[O]=1)}}var d=[0,0,0],o={model:h,view:h,projection:h,_ortho:!1};x.isOpaque=function(){return!0},x.isTransparent=function(){return!1},x.drawTransparent=function(b){};var m=0,l=[0,0,0],w=[0,0,0],_=[0,0,0];x.draw=function(b){b=b||o;for(var re=this.gl,u=b.model||h,L=b.view||h,T=b.projection||h,k=this.bounds,P=b._ortho||!1,z=r(u,L,T,k,P),I=z.cubeEdges,D=z.axis,R=L[12],O=L[13],F=L[14],N=L[15],G=P?2:1,K=G*this.pixelRatio*(T[3]*R+T[7]*O+T[11]*F+T[15]*N)/re.drawingBufferHeight,W=0;W<3;++W)this.lastCubeProps.cubeEdges[W]=I[W],this.lastCubeProps.axis[W]=D[W];for(var Y=v,W=0;W<3;++W)f(v[W],W,this.bounds,I,D);for(var re=this.gl,ue=d,W=0;W<3;++W)this.backgroundEnable[W]?ue[W]=D[W]:ue[W]=0;this._background.draw(u,L,T,k,ue,this.backgroundColor),this._lines.bind(u,L,T,this);for(var W=0;W<3;++W){var j=[0,0,0];D[W]>0?j[W]=k[1][W]:j[W]=k[0][W];for(var q=0;q<2;++q){var H=(W+1+q)%3,U=(W+1+(q^1))%3;this.gridEnable[H]&&this._lines.drawGrid(H,U,this.bounds,j,this.gridColor[H],this.gridWidth[H]*this.pixelRatio)}for(var q=0;q<2;++q){var H=(W+1+q)%3,U=(W+1+(q^1))%3;this.zeroEnable[U]&&Math.min(k[0][U],k[1][U])<=0&&Math.max(k[0][U],k[1][U])>=0&&this._lines.drawZero(H,U,this.bounds,j,this.zeroLineColor[U],this.zeroLineWidth[U]*this.pixelRatio)}}for(var W=0;W<3;++W){this.lineEnable[W]&&this._lines.drawAxisLine(W,this.bounds,Y[W].primalOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio),this.lineMirror[W]&&this._lines.drawAxisLine(W,this.bounds,Y[W].mirrorOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio);for(var $=s(l,Y[W].primalMinor),ne=s(w,Y[W].mirrorMinor),X=this.lineTickLength,q=0;q<3;++q){var Q=K/u[5*q];$[q]*=X[q]*Q,ne[q]*=X[q]*Q}this.lineTickEnable[W]&&this._lines.drawAxisTicks(W,Y[W].primalOffset,$,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio),this.lineTickMirror[W]&&this._lines.drawAxisTicks(W,Y[W].mirrorOffset,ne,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio)}this._lines.unbind(),this._text.bind(u,L,T,this.pixelRatio);var ie,se=.5,ae,oe;function be(Ee){oe=[0,0,0],oe[Ee]=1}function ce(Ee,Pe,Ue){var we=(Ee+1)%3,ke=(Ee+2)%3,Xe=Pe[we],Ve=Pe[ke],Ie=Ue[we],De=Ue[ke];if(Xe>0&&De>0){be(we);return}else if(Xe>0&&De<0){be(we);return}else if(Xe<0&&De>0){be(we);return}else if(Xe<0&&De<0){be(we);return}else if(Ve>0&&Ie>0){be(ke);return}else if(Ve>0&&Ie<0){be(ke);return}else if(Ve<0&&Ie>0){be(ke);return}else if(Ve<0&&Ie<0){be(ke);return}}for(var W=0;W<3;++W){for(var de=Y[W].primalMinor,ye=Y[W].mirrorMinor,ge=s(_,Y[W].primalOffset),q=0;q<3;++q)this.lineTickEnable[W]&&(ge[q]+=K*de[q]*Math.max(this.lineTickLength[q],0)/u[5*q]);var me=[0,0,0];if(me[W]=1,this.tickEnable[W]){this.tickAngle[W]===-3600?(this.tickAngle[W]=0,this.tickAlign[W]="auto"):this.tickAlign[W]=-1,ae=1,ie=[this.tickAlign[W],se,ae],ie[0]==="auto"?ie[0]=m:ie[0]=parseInt(""+ie[0]),oe=[0,0,0],ce(W,de,ye);for(var q=0;q<3;++q)ge[q]+=K*de[q]*this.tickPad[q]/u[5*q];this._text.drawTicks(W,this.tickSize[W],this.tickAngle[W],ge,this.tickColor[W],me,oe,ie)}if(this.labelEnable[W]){ae=0,oe=[0,0,0],this.labels[W].length>4&&(be(W),ae=1),ie=[this.labelAlign[W],se,ae],ie[0]==="auto"?ie[0]=m:ie[0]=parseInt(""+ie[0]);for(var q=0;q<3;++q)ge[q]+=K*de[q]*this.labelPad[q]/u[5*q];ge[W]+=.5*(k[0][W]+k[1][W]),this._text.drawLabel(W,this.labelSize[W],this.labelAngle[W],ge,this.labelColor[W],[0,0,0],oe,ie)}}this._text.unbind()},x.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null};function c(b,u){var L=new i(b);return L.update(u),L}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(g,S,M){S.exports=h;var e=g("gl-buffer"),a=g("gl-vao"),n=g("./shaders").bg;function r(s,i,x,p){this.gl=s,this.buffer=i,this.vao=x,this.shader=p}var t=r.prototype;t.draw=function(s,i,x,p,v,f){for(var d=!1,o=0;o<3;++o)d=d||v[o];if(d){var m=this.gl;m.enable(m.POLYGON_OFFSET_FILL),m.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:s,view:i,projection:x,bounds:p,enable:v,colors:f},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),m.disable(m.POLYGON_OFFSET_FILL)}},t.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function h(s){for(var i=[],x=[],p=0,v=0;v<3;++v)for(var f=(v+1)%3,d=(v+2)%3,o=[0,0,0],m=[0,0,0],l=-1;l<=1;l+=2){x.push(p,p+2,p+1,p+1,p+2,p+3),o[v]=l,m[v]=l;for(var w=-1;w<=1;w+=2){o[f]=w;for(var _=-1;_<=1;_+=2)o[d]=_,i.push(o[0],o[1],o[2],m[0],m[1],m[2]),p+=1}var c=f;f=d,d=c}var b=e(s,new Float32Array(i)),u=e(s,new Uint16Array(x),s.ELEMENT_ARRAY_BUFFER),L=a(s,[{buffer:b,type:s.FLOAT,size:3,offset:0,stride:24},{buffer:b,type:s.FLOAT,size:3,offset:12,stride:24}],u),T=n(s);return T.attributes.position.location=0,T.attributes.normal.location=1,new r(s,b,L,T)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(g,S,M){S.exports=l;var e=g("bit-twiddle"),a=g("gl-mat4/multiply"),n=g("split-polygon"),r=g("robust-orientation"),t=new Array(16),h=new Array(8),s=new Array(8),i=new Array(3),x=[0,0,0];(function(){for(var w=0;w<8;++w)h[w]=[1,1,1,1],s[w]=[1,1,1]})();function p(w,_,c){for(var b=0;b<4;++b){w[b]=c[12+b];for(var u=0;u<3;++u)w[b]+=_[u]*c[4*u+b]}}var v=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function f(w){for(var _=0;_<v.length;++_)if(w=n.positive(w,v[_]),w.length<3)return 0;for(var c=w[0],b=c[0]/c[3],u=c[1]/c[3],L=0,_=1;_+1<w.length;++_){var T=w[_],k=w[_+1],P=T[0]/T[3],z=T[1]/T[3],I=k[0]/k[3],D=k[1]/k[3],R=P-b,O=z-u,F=I-b,N=D-u;L+=Math.abs(R*N-O*F)}return L}var d=[1,1,1],o=[0,0,0],m={cubeEdges:d,axis:o};function l(w,_,c,b,u){a(t,_,w),a(t,c,t);for(var L=0,T=0;T<2;++T){i[2]=b[T][2];for(var k=0;k<2;++k){i[1]=b[k][1];for(var P=0;P<2;++P)i[0]=b[P][0],p(h[L],i,t),L+=1}}for(var z=-1,T=0;T<8;++T){for(var I=h[T][3],D=0;D<3;++D)s[T][D]=h[T][D]/I;u&&(s[T][2]*=-1),I<0&&(z<0||s[T][2]<s[z][2])&&(z=T)}if(z<0){z=0;for(var R=0;R<3;++R){for(var O=(R+2)%3,F=(R+1)%3,N=-1,G=-1,K=0;K<2;++K){var W=K<<R,Y=W+(K<<O)+(1-K<<F),re=W+(1-K<<O)+(K<<F);r(s[W],s[Y],s[re],x)<0||(K?N=1:G=1)}if(N<0||G<0){G>N&&(z|=1<<R);continue}for(var K=0;K<2;++K){var W=K<<R,Y=W+(K<<O)+(1-K<<F),re=W+(1-K<<O)+(K<<F),ue=f([h[W],h[Y],h[re],h[W+(1<<O)+(1<<F)]]);K?N=ue:G=ue}if(G>N){z|=1<<R;continue}}}for(var j=7^z,q=-1,T=0;T<8;++T)T===z||T===j||(q<0||s[q][1]>s[T][1])&&(q=T);for(var H=-1,T=0;T<3;++T){var U=q^1<<T;if(!(U===z||U===j)){H<0&&(H=U);var F=s[U];F[0]<s[H][0]&&(H=U)}}for(var $=-1,T=0;T<3;++T){var U=q^1<<T;if(!(U===z||U===j||U===H)){$<0&&($=U);var F=s[U];F[0]>s[$][0]&&($=U)}}var ne=d;ne[0]=ne[1]=ne[2]=0,ne[e.log2(H^q)]=q&H,ne[e.log2(q^$)]=q&$;var X=$^7;X===z||X===j?(X=H^7,ne[e.log2($^X)]=X&$):ne[e.log2(H^X)]=X&H;for(var Q=o,ie=z,R=0;R<3;++R)ie&1<<R?Q[R]=-1:Q[R]=1;return m}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(g,S,M){S.exports=d;var e=g("gl-buffer"),a=g("gl-vao"),n=g("./shaders").line,r=[0,0,0],t=[0,0,0],h=[0,0,0],s=[0,0,0],i=[1,1];function x(o){return o[0]=o[1]=o[2]=0,o}function p(o,m){return o[0]=m[0],o[1]=m[1],o[2]=m[2],o}function v(o,m,l,w,_,c,b,u){this.gl=o,this.vertBuffer=m,this.vao=l,this.shader=w,this.tickCount=_,this.tickOffset=c,this.gridCount=b,this.gridOffset=u}var f=v.prototype;f.bind=function(o,m,l){this.shader.bind(),this.shader.uniforms.model=o,this.shader.uniforms.view=m,this.shader.uniforms.projection=l,i[0]=this.gl.drawingBufferWidth,i[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=i,this.vao.bind()},f.unbind=function(){this.vao.unbind()},f.drawAxisLine=function(o,m,l,w,_){var c=x(t);this.shader.uniforms.majorAxis=t,c[o]=m[1][o]-m[0][o],this.shader.uniforms.minorAxis=c;var b=p(s,l);b[o]+=m[0][o],this.shader.uniforms.offset=b,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=w;var u=x(h);u[(o+2)%3]=1,this.shader.uniforms.screenAxis=u,this.vao.draw(this.gl.TRIANGLES,6);var u=x(h);u[(o+1)%3]=1,this.shader.uniforms.screenAxis=u,this.vao.draw(this.gl.TRIANGLES,6)},f.drawAxisTicks=function(o,m,l,w,_){if(this.tickCount[o]){var c=x(r);c[o]=1,this.shader.uniforms.majorAxis=c,this.shader.uniforms.offset=m,this.shader.uniforms.minorAxis=l,this.shader.uniforms.color=w,this.shader.uniforms.lineWidth=_;var b=x(h);b[o]=1,this.shader.uniforms.screenAxis=b,this.vao.draw(this.gl.TRIANGLES,this.tickCount[o],this.tickOffset[o])}},f.drawGrid=function(o,m,l,w,_,c){if(this.gridCount[o]){var b=x(t);b[m]=l[1][m]-l[0][m],this.shader.uniforms.minorAxis=b;var u=p(s,w);u[m]+=l[0][m],this.shader.uniforms.offset=u;var L=x(r);L[o]=1,this.shader.uniforms.majorAxis=L;var T=x(h);T[o]=1,this.shader.uniforms.screenAxis=T,this.shader.uniforms.lineWidth=c,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,this.gridCount[o],this.gridOffset[o])}},f.drawZero=function(o,m,l,w,_,c){var b=x(t);this.shader.uniforms.majorAxis=b,b[o]=l[1][o]-l[0][o],this.shader.uniforms.minorAxis=b;var u=p(s,w);u[o]+=l[0][o],this.shader.uniforms.offset=u;var L=x(h);L[m]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=c,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,6)},f.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()};function d(o,m,l){var w=[],_=[0,0,0],c=[0,0,0],b=[0,0,0],u=[0,0,0];w.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var P=w.length/3|0,T=0;T<l[L].length;++T){var k=+l[L][T].x;w.push(k,0,1,k,1,1,k,0,-1,k,0,-1,k,1,1,k,1,-1)}var I=w.length/3|0;_[L]=P,c[L]=I-P;for(var P=w.length/3|0,z=0;z<l[L].length;++z){var k=+l[L][z].x;w.push(k,0,1,k,1,1,k,0,-1,k,0,-1,k,1,1,k,1,-1)}var I=w.length/3|0;b[L]=P,u[L]=I-P}var D=e(o,new Float32Array(w)),R=a(o,[{buffer:D,type:o.FLOAT,size:3,stride:0,offset:0}]),O=n(o);return O.attributes.position.location=0,new v(o,D,R,O,c,_,u,b)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);M.line=function(x){return a(x,n,r,null,[{name:"position",type:"vec3"}])};var t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),h=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);M.text=function(x){return a(x,t,h,null,[{name:"position",type:"vec3"}])};var s=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),i=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);M.bg=function(x){return a(x,s,i,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(g,S,M){(function(e){(function(){S.exports=d;var a=g("gl-buffer"),n=g("gl-vao"),r=g("vectorize-text"),t=g("./shaders").text,h=window||e.global||{},s=h.__TEXT_CACHE||{};h.__TEXT_CACHE={};var i=3;function x(o,m,l,w){this.gl=o,this.shader=m,this.buffer=l,this.vao=w,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var p=x.prototype,v=[0,0];p.bind=function(o,m,l,w){this.vao.bind(),this.shader.bind();var _=this.shader.uniforms;_.model=o,_.view=m,_.projection=l,_.pixelScale=w,v[0]=this.gl.drawingBufferWidth,v[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=v},p.unbind=function(){this.vao.unbind()},p.update=function(o,m,l,w,_){var c=[];function b(R,O,F,N,G,K){var W=s[F];W||(W=s[F]={});var Y=W[O];Y||(Y=W[O]=f(O,{triangles:!0,font:F,textAlign:"center",textBaseline:"middle",lineSpacing:G,styletags:K}));for(var re=(N||12)/12,ue=Y.positions,j=Y.cells,q=0,H=j.length;q<H;++q)for(var U=j[q],$=2;$>=0;--$){var ne=ue[U[$]];c.push(re*ne[0],-re*ne[1],R)}}for(var u=[0,0,0],L=[0,0,0],T=[0,0,0],k=[0,0,0],P=1.25,z={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){T[I]=c.length/i|0,b(.5*(o[0][I]+o[1][I]),m[I],l[I],12,P,z),k[I]=(c.length/i|0)-T[I],u[I]=c.length/i|0;for(var D=0;D<w[I].length;++D)w[I][D].text&&b(w[I][D].x,w[I][D].text,w[I][D].font||_,w[I][D].fontSize||12,P,z);L[I]=(c.length/i|0)-u[I]}this.buffer.update(c),this.tickOffset=u,this.tickCount=L,this.labelOffset=T,this.labelCount=k},p.drawTicks=function(o,m,l,w,_,c,b,u){this.tickCount[o]&&(this.shader.uniforms.axis=c,this.shader.uniforms.color=_,this.shader.uniforms.angle=l,this.shader.uniforms.scale=m,this.shader.uniforms.offset=w,this.shader.uniforms.alignDir=b,this.shader.uniforms.alignOpt=u,this.vao.draw(this.gl.TRIANGLES,this.tickCount[o],this.tickOffset[o]))},p.drawLabel=function(o,m,l,w,_,c,b,u){this.labelCount[o]&&(this.shader.uniforms.axis=c,this.shader.uniforms.color=_,this.shader.uniforms.angle=l,this.shader.uniforms.scale=m,this.shader.uniforms.offset=w,this.shader.uniforms.alignDir=b,this.shader.uniforms.alignOpt=u,this.vao.draw(this.gl.TRIANGLES,this.labelCount[o],this.labelOffset[o]))},p.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()};function f(o,m){try{return r(o,m)}catch(l){return console.warn('error vectorizing text:"'+o+'" error:',l),{cells:[],positions:[]}}}function d(o,m,l,w,_,c){var b=a(o),u=n(o,[{buffer:b,size:3}]),L=t(o);L.attributes.position.location=0;var T=new x(o,L,b,u);return T.update(m,l,w,_,c),T}}).call(this)}).call(this,g("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(g,S,M){M.create=a,M.equal=n;function e(r,t){var h=r+"",s=h.indexOf("."),i=0;s>=0&&(i=h.length-s-1);var x=Math.pow(10,i),p=Math.round(r*t*x),v=p+"";if(v.indexOf("e")>=0)return v;var f=p/x,d=p%x;p<0?(f=-Math.ceil(f)|0,d=-d|0):(f=Math.floor(f)|0,d=d|0);var o=""+f;if(p<0&&(o="-"+o),i){for(var m=""+d;m.length<i;)m="0"+m;return o+"."+m}else return o}function a(r,t){for(var h=[],s=0;s<3;++s){var i=[];.5*(r[0][s]+r[1][s]);for(var x=0;x*t[s]<=r[1][s];++x)i.push({x:x*t[s],text:e(t[s],x)});for(var x=-1;x*t[s]>=r[0][s];--x)i.push({x:x*t[s],text:e(t[s],x)});h.push(i)}return h}function n(r,t){for(var h=0;h<3;++h){if(r[h].length!==t[h].length)return!1;for(var s=0;s<r[h].length;++s){var i=r[h][s],x=t[h][s];if(i.x!==x.x||i.text!==x.text||i.font!==x.font||i.fontColor!==x.fontColor||i.fontSize!==x.fontSize||i.dx!==x.dx||i.dy!==x.dy)return!1}}return!0}},{}],77:[function(g,S,M){S.exports=m;var e=g("extract-frustum-planes"),a=g("split-polygon"),n=g("./lib/cube.js"),r=g("gl-mat4/multiply"),t=g("gl-mat4/transpose"),h=g("gl-vec4/transformMat4"),s=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);function x(l,w,_){this.lo=l,this.hi=w,this.pixelsPerDataUnit=_}var p=[0,0,0,1],v=[0,0,0,1];function f(l,w,_,c,b){for(var u=0;u<3;++u){for(var L=p,T=v,k=0;k<3;++k)T[k]=L[k]=_[k];T[3]=L[3]=1,T[u]+=1,h(T,T,w),T[3]<0&&(l[u]=1/0),L[u]-=1,h(L,L,w),L[3]<0&&(l[u]=1/0);var P=(L[0]/L[3]-T[0]/T[3])*c,z=(L[1]/L[3]-T[1]/T[3])*b;l[u]=.25*Math.sqrt(P*P+z*z)}return l}var d=[new x(1/0,-1/0,1/0),new x(1/0,-1/0,1/0),new x(1/0,-1/0,1/0)],o=[0,0,0];function m(l,w,_,c,z){var u=w.model||s,L=w.view||s,T=w.projection||s,k=w._ortho||!1,P=l.bounds,z=z||n(u,L,T,P,k),I=z.axis;r(i,L,u),r(i,T,i);for(var D=d,R=0;R<3;++R)D[R].lo=1/0,D[R].hi=-1/0,D[R].pixelsPerDataUnit=1/0;var O=e(t(i,i));t(i,i);for(var F=0;F<3;++F){var N=(F+1)%3,G=(F+2)%3,K=o;e:for(var R=0;R<2;++R){var W=[];if(I[F]<0!=!!R){K[F]=P[R][F];for(var Y=0;Y<2;++Y){K[N]=P[Y^R][N];for(var re=0;re<2;++re)K[G]=P[re^Y^R][G],W.push(K.slice())}for(var ue=k?5:4,Y=ue;Y===ue;++Y){if(W.length===0)continue e;W=a.positive(W,O[Y])}for(var Y=0;Y<W.length;++Y)for(var G=W[Y],j=f(o,i,G,_,c),re=0;re<3;++re)D[re].lo=Math.min(D[re].lo,G[re]),D[re].hi=Math.max(D[re].hi,G[re]),re!==F&&(D[re].pixelsPerDataUnit=Math.min(D[re].pixelsPerDataUnit,Math.abs(j[re])))}}}return D}},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(g,S,M){var e=g("typedarray-pool"),a=g("ndarray-ops"),n=g("ndarray"),r=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function t(v,f,d,o,m){this.gl=v,this.type=f,this.handle=d,this.length=o,this.usage=m}var h=t.prototype;h.bind=function(){this.gl.bindBuffer(this.type,this.handle)},h.unbind=function(){this.gl.bindBuffer(this.type,null)},h.dispose=function(){this.gl.deleteBuffer(this.handle)};function s(v,f,d,o,m,l){var w=m.length*m.BYTES_PER_ELEMENT;if(l<0)return v.bufferData(f,m,o),w;if(w+l>d)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return v.bufferSubData(f,l,m),d}function i(v,f){for(var d=e.malloc(v.length,f),o=v.length,m=0;m<o;++m)d[m]=v[m];return d}function x(v,f){for(var d=1,o=f.length-1;o>=0;--o){if(f[o]!==d)return!1;d*=v[o]}return!0}h.update=function(v,f){if(typeof f!="number"&&(f=-1),this.bind(),typeof v=="object"&&typeof v.shape<"u"){var d=v.dtype;if(r.indexOf(d)<0&&(d="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var o=gl.getExtension("OES_element_index_uint");o&&d!=="uint16"?d="uint32":d="uint16"}if(d===v.dtype&&x(v.shape,v.stride))v.offset===0&&v.data.length===v.shape[0]?this.length=s(this.gl,this.type,this.length,this.usage,v.data,f):this.length=s(this.gl,this.type,this.length,this.usage,v.data.subarray(v.offset,v.shape[0]),f);else{var m=e.malloc(v.size,d),l=n(m,v.shape);a.assign(l,v),f<0?this.length=s(this.gl,this.type,this.length,this.usage,m,f):this.length=s(this.gl,this.type,this.length,this.usage,m.subarray(0,v.size),f),e.free(m)}}else if(Array.isArray(v)){var w;this.type===this.gl.ELEMENT_ARRAY_BUFFER?w=i(v,"uint16"):w=i(v,"float32"),f<0?this.length=s(this.gl,this.type,this.length,this.usage,w,f):this.length=s(this.gl,this.type,this.length,this.usage,w.subarray(0,v.length),f),e.free(w)}else if(typeof v=="object"&&typeof v.length=="number")this.length=s(this.gl,this.type,this.length,this.usage,v,f);else if(typeof v=="number"||v===void 0){if(f>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");v=v|0,v<=0&&(v=1),this.gl.bufferData(this.type,v|0,this.usage),this.length=v}else throw new Error("gl-buffer: Invalid data type")};function p(v,f,d,o){if(d=d||v.ARRAY_BUFFER,o=o||v.DYNAMIC_DRAW,d!==v.ARRAY_BUFFER&&d!==v.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(o!==v.DYNAMIC_DRAW&&o!==v.STATIC_DRAW&&o!==v.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var m=v.createBuffer(),l=new t(v,d,m,0,o);return l.update(f),l}S.exports=p},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(g,S,M){var e=g("gl-vec3");S.exports=function(n,r){var t=n.positions,h=n.vectors,s={positions:[],vertexIntensity:[],vertexIntensityBounds:n.vertexIntensityBounds,vectors:[],cells:[],coneOffset:n.coneOffset,colormap:n.colormap};if(n.positions.length===0)return r&&(r[0]=[0,0,0],r[1]=[0,0,0]),s;for(var i=0,x=1/0,p=-1/0,v=1/0,f=-1/0,d=1/0,o=-1/0,m=null,l=null,w=[],_=1/0,c=!1,b=0;b<t.length;b++){var u=t[b];x=Math.min(u[0],x),p=Math.max(u[0],p),v=Math.min(u[1],v),f=Math.max(u[1],f),d=Math.min(u[2],d),o=Math.max(u[2],o);var L=h[b];if(e.length(L)>i&&(i=e.length(L)),b){var T=2*e.distance(m,u)/(e.length(l)+e.length(L));T?(_=Math.min(_,T),c=!1):c=!0}c||(m=u,l=L),w.push(L)}var k=[x,v,d],P=[p,f,o];r&&(r[0]=k,r[1]=P),i===0&&(i=1);var z=1/i;isFinite(_)||(_=1),s.vectorScale=_;var I=n.coneSize||.5;n.absoluteConeSize&&(I=n.absoluteConeSize*z),s.coneScale=I;for(var b=0,D=0;b<t.length;b++)for(var u=t[b],R=u[0],O=u[1],F=u[2],N=w[b],G=e.length(N)*z,K=0,W=8;K<W;K++){s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.positions.push([R,O,F,D++]),s.vectors.push(N),s.vectors.push(N),s.vectors.push(N),s.vectors.push(N),s.vectors.push(N),s.vectors.push(N),s.vertexIntensity.push(G,G,G),s.vertexIntensity.push(G,G,G);var Y=s.positions.length;s.cells.push([Y-6,Y-5,Y-4],[Y-3,Y-2,Y-1])}return s};var a=g("./lib/shaders");S.exports.createMesh=g("./create_mesh"),S.exports.createConeMesh=function(n,r){return S.exports.createMesh(n,r,{shaders:a,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(g,S,M){var e=g("gl-shader"),a=g("gl-buffer"),n=g("gl-vao"),r=g("gl-texture2d"),t=g("gl-mat4/multiply"),h=g("gl-mat4/invert"),s=g("ndarray"),i=g("colormap"),x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function p(w,_,c,b,u,L,T,k,P,z,I){this.gl=w,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=_,this.dirty=!0,this.triShader=c,this.pickShader=b,this.trianglePositions=u,this.triangleVectors=L,this.triangleColors=k,this.triangleUVs=P,this.triangleIds=T,this.triangleVAO=z,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=I,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=x,this._view=x,this._projection=x,this._resolution=[1,1]}var v=p.prototype;v.isOpaque=function(){return this.opacity>=1},v.isTransparent=function(){return this.opacity<1},v.pickSlots=1,v.setPickBase=function(w){this.pickId=w};function f(w){for(var _=i({colormap:w,nshades:256,format:"rgba"}),c=new Uint8Array(256*4),b=0;b<256;++b){for(var u=_[b],L=0;L<3;++L)c[4*b+L]=u[L];c[4*b+3]=u[3]*255}return s(c,[256,256,4],[4,0,1])}function d(w){for(var _=w.length,c=new Array(_),b=0;b<_;++b)c[b]=w[b][2];return c}v.update=function(w){w=w||{};var _=this.gl;this.dirty=!0,"lightPosition"in w&&(this.lightPosition=w.lightPosition),"opacity"in w&&(this.opacity=w.opacity),"ambient"in w&&(this.ambientLight=w.ambient),"diffuse"in w&&(this.diffuseLight=w.diffuse),"specular"in w&&(this.specularLight=w.specular),"roughness"in w&&(this.roughness=w.roughness),"fresnel"in w&&(this.fresnel=w.fresnel),w.tubeScale!==void 0&&(this.tubeScale=w.tubeScale),w.vectorScale!==void 0&&(this.vectorScale=w.vectorScale),w.coneScale!==void 0&&(this.coneScale=w.coneScale),w.coneOffset!==void 0&&(this.coneOffset=w.coneOffset),w.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=_.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=_.LINEAR,this.texture.setPixels(f(w.colormap)),this.texture.generateMipmap());var c=w.cells,b=w.positions,u=w.vectors;if(!(!b||!c||!u)){var L=[],T=[],k=[],P=[],z=[];this.cells=c,this.positions=b,this.vectors=u;var I=w.meshColor||[1,1,1,1],D=w.vertexIntensity,R=1/0,O=-1/0;if(D)if(w.vertexIntensityBounds)R=+w.vertexIntensityBounds[0],O=+w.vertexIntensityBounds[1];else for(var F=0;F<D.length;++F){var N=D[F];R=Math.min(R,N),O=Math.max(O,N)}else for(var F=0;F<b.length;++F){var N=b[F][2];R=Math.min(R,N),O=Math.max(O,N)}D?this.intensity=D:this.intensity=d(b),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var F=0;F<b.length;++F)for(var G=b[F],K=0;K<3;++K)isNaN(G[K])||!isFinite(G[K])||(this.bounds[0][K]=Math.min(this.bounds[0][K],G[K]),this.bounds[1][K]=Math.max(this.bounds[1][K],G[K]));var W=0;e:for(var F=0;F<c.length;++F){var Y=c[F];switch(Y.length){case 3:for(var K=0;K<3;++K)for(var re=Y[K],G=b[re],ue=0;ue<3;++ue)if(isNaN(G[ue])||!isFinite(G[ue]))continue e;for(var K=0;K<3;++K){var re=Y[2-K],G=b[re];L.push(G[0],G[1],G[2],G[3]);var j=u[re];T.push(j[0],j[1],j[2],j[3]||0);var q=I;q.length===3?k.push(q[0],q[1],q[2],1):k.push(q[0],q[1],q[2],q[3]);var H;D?H=[(D[re]-R)/(O-R),0]:H=[(G[2]-R)/(O-R),0],P.push(H[0],H[1]),z.push(F)}W+=1;break}}this.triangleCount=W,this.trianglePositions.update(L),this.triangleVectors.update(T),this.triangleColors.update(k),this.triangleUVs.update(P),this.triangleIds.update(new Uint32Array(z))}},v.drawTransparent=v.draw=function(w){w=w||{};for(var _=this.gl,c=w.model||x,b=w.view||x,u=w.projection||x,L=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)L[0][T]=Math.max(L[0][T],this.clipBounds[0][T]),L[1][T]=Math.min(L[1][T],this.clipBounds[1][T]);var k={model:c,view:b,projection:u,inverseModel:x.slice(),clipBounds:L,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};k.inverseModel=h(k.inverseModel,k.model),_.disable(_.CULL_FACE),this.texture.bind(0);var P=new Array(16);t(P,k.view,k.model),t(P,k.projection,P),h(P,P);for(var T=0;T<3;++T)k.eyePosition[T]=P[12+T]/P[15];for(var z=P[15],T=0;T<3;++T)z+=this.lightPosition[T]*P[4*T+3];for(var T=0;T<3;++T){for(var I=P[12+T],D=0;D<3;++D)I+=P[4*D+T]*this.lightPosition[D];k.lightPosition[T]=I/z}if(this.triangleCount>0){var R=this.triShader;R.bind(),R.uniforms=k,this.triangleVAO.bind(),_.drawArrays(_.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}},v.drawPick=function(w){w=w||{};for(var _=this.gl,c=w.model||x,b=w.view||x,u=w.projection||x,L=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)L[0][T]=Math.max(L[0][T],this.clipBounds[0][T]),L[1][T]=Math.min(L[1][T],this.clipBounds[1][T]);this._model=[].slice.call(c),this._view=[].slice.call(b),this._projection=[].slice.call(u),this._resolution=[_.drawingBufferWidth,_.drawingBufferHeight];var k={model:c,view:b,projection:u,clipBounds:L,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},P=this.pickShader;P.bind(),P.uniforms=k,this.triangleCount>0&&(this.triangleVAO.bind(),_.drawArrays(_.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind())},v.pick=function(w){if(!w||w.id!==this.pickId)return null;var _=w.value[0]+256*w.value[1]+65536*w.value[2],c=this.cells[_],b=this.positions[c[1]].slice(0,3),u={position:b,dataCoordinate:b,index:Math.floor(c[1]/48)};return this.traceType==="cone"?u.index=Math.floor(c[1]/48):this.traceType==="streamtube"&&(u.intensity=this.intensity[c[1]],u.velocity=this.vectors[c[1]].slice(0,3),u.divergence=this.vectors[c[1]][3],u.index=_),u},v.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()};function o(w,_){var c=e(w,_.meshShader.vertex,_.meshShader.fragment,null,_.meshShader.attributes);return c.attributes.position.location=0,c.attributes.color.location=2,c.attributes.uv.location=3,c.attributes.vector.location=4,c}function m(w,_){var c=e(w,_.pickShader.vertex,_.pickShader.fragment,null,_.pickShader.attributes);return c.attributes.position.location=0,c.attributes.id.location=1,c.attributes.vector.location=4,c}function l(w,_,c){var b=c.shaders;arguments.length===1&&(_=w,w=_.gl);var u=o(w,b),L=m(w,b),T=r(w,s(new Uint8Array([255,255,255,255]),[1,1,4]));T.generateMipmap(),T.minFilter=w.LINEAR_MIPMAP_LINEAR,T.magFilter=w.LINEAR;var k=a(w),P=a(w),z=a(w),I=a(w),D=a(w),R=n(w,[{buffer:k,type:w.FLOAT,size:4},{buffer:D,type:w.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:z,type:w.FLOAT,size:4},{buffer:I,type:w.FLOAT,size:2},{buffer:P,type:w.FLOAT,size:4}]),O=new p(w,T,u,L,k,P,D,z,I,R,c.traceType||"cone");return O.update(_),O}S.exports=l},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(g,S,M){var e=g("glslify"),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),r=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},M.pickShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(g,S,M){S.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(g,S,M){var e=g("./1.0/numbers");S.exports=function(n){return e[n]}},{"./1.0/numbers":82}],84:[function(g,S,M){S.exports=p;var e=g("gl-buffer"),a=g("gl-vao"),n=g("./shaders/index"),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(v,f,d,o){this.gl=v,this.shader=o,this.buffer=f,this.vao=d,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var h=t.prototype;h.isOpaque=function(){return!this.hasAlpha},h.isTransparent=function(){return this.hasAlpha},h.drawTransparent=h.draw=function(v){var f=this.gl,d=this.shader.uniforms;this.shader.bind();var o=d.view=v.view||r,m=d.projection=v.projection||r;d.model=v.model||r,d.clipBounds=this.clipBounds,d.opacity=this.opacity;var l=o[12],w=o[13],_=o[14],c=o[15],b=v._ortho||!1,u=b?2:1,L=u*this.pixelRatio*(m[3]*l+m[7]*w+m[11]*_+m[15]*c)/f.drawingBufferHeight;this.vao.bind();for(var T=0;T<3;++T)f.lineWidth(this.lineWidth[T]*this.pixelRatio),d.capSize=this.capSize[T]*L,this.lineCount[T]&&f.drawArrays(f.LINES,this.lineOffset[T],this.lineCount[T]);this.vao.unbind()};function s(v,f){for(var d=0;d<3;++d)v[0][d]=Math.min(v[0][d],f[d]),v[1][d]=Math.max(v[1][d],f[d])}var i=function(){for(var v=new Array(3),f=0;f<3;++f){for(var d=[],o=1;o<=2;++o)for(var m=-1;m<=1;m+=2){var l=(o+f)%3,w=[0,0,0];w[l]=m,d.push(w)}v[f]=d}return v}();function x(v,f,d,o){for(var m=i[o],l=0;l<m.length;++l){var w=m[l];v.push(f[0],f[1],f[2],d[0],d[1],d[2],d[3],w[0],w[1],w[2])}return m.length}h.update=function(v){v=v||{},"lineWidth"in v&&(this.lineWidth=v.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in v&&(this.capSize=v.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in v&&(this.opacity=+v.opacity,this.opacity<1&&(this.hasAlpha=!0));var f=v.color||[[0,0,0],[0,0,0],[0,0,0]],d=v.position,o=v.error;if(Array.isArray(f[0])||(f=[f,f,f]),d&&o){var m=[],l=d.length,w=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var _=0;_<3;++_){this.lineOffset[_]=w;e:for(var c=0;c<l;++c){for(var b=d[c],u=0;u<3;++u)if(isNaN(b[u])||!isFinite(b[u]))continue e;var L=o[c],T=f[_];if(Array.isArray(T[0])&&(T=f[c]),T.length===3?T=[T[0],T[1],T[2],1]:T.length===4&&(T=[T[0],T[1],T[2],T[3]],!this.hasAlpha&&T[3]<1&&(this.hasAlpha=!0)),!(isNaN(L[0][_])||isNaN(L[1][_]))){if(L[0][_]<0){var k=b.slice();k[_]+=L[0][_],m.push(b[0],b[1],b[2],T[0],T[1],T[2],T[3],0,0,0,k[0],k[1],k[2],T[0],T[1],T[2],T[3],0,0,0),s(this.bounds,k),w+=2+x(m,k,T,_)}if(L[1][_]>0){var k=b.slice();k[_]+=L[1][_],m.push(b[0],b[1],b[2],T[0],T[1],T[2],T[3],0,0,0,k[0],k[1],k[2],T[0],T[1],T[2],T[3],0,0,0),s(this.bounds,k),w+=2+x(m,k,T,_)}}}this.lineCount[_]=w-this.lineOffset[_]}this.buffer.update(m)}},h.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()};function p(v){var f=v.gl,d=e(f),o=a(f,[{buffer:d,type:f.FLOAT,size:3,offset:0,stride:40},{buffer:d,type:f.FLOAT,size:4,offset:12,stride:40},{buffer:d,type:f.FLOAT,size:3,offset:28,stride:40}]),m=n(f);m.attributes.position.location=0,m.attributes.color.location=1,m.attributes.offset.location=2;var l=new t(f,d,o,m);return l.update(v),l}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(g,S,M){var e=g("gl-texture2d");S.exports=w;var a=null,n,r,t,h;function s(_){var c=_.getParameter(_.FRAMEBUFFER_BINDING),b=_.getParameter(_.RENDERBUFFER_BINDING),u=_.getParameter(_.TEXTURE_BINDING_2D);return[c,b,u]}function i(_,c){_.bindFramebuffer(_.FRAMEBUFFER,c[0]),_.bindRenderbuffer(_.RENDERBUFFER,c[1]),_.bindTexture(_.TEXTURE_2D,c[2])}function x(_,c){var b=_.getParameter(c.MAX_COLOR_ATTACHMENTS_WEBGL);a=new Array(b+1);for(var u=0;u<=b;++u){for(var L=new Array(b),T=0;T<u;++T)L[T]=_.COLOR_ATTACHMENT0+T;for(var T=u;T<b;++T)L[T]=_.NONE;a[u]=L}}function p(_){switch(_){case n:throw new Error("gl-fbo: Framebuffer unsupported");case r:throw new Error("gl-fbo: Framebuffer incomplete attachment");case t:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case h:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function v(_,c,b,u,L,T){if(!u)return null;var k=e(_,c,b,L,u);return k.magFilter=_.NEAREST,k.minFilter=_.NEAREST,k.mipSamples=1,k.bind(),_.framebufferTexture2D(_.FRAMEBUFFER,T,_.TEXTURE_2D,k.handle,0),k}function f(_,c,b,u,L){var T=_.createRenderbuffer();return _.bindRenderbuffer(_.RENDERBUFFER,T),_.renderbufferStorage(_.RENDERBUFFER,u,c,b),_.framebufferRenderbuffer(_.FRAMEBUFFER,L,_.RENDERBUFFER,T),T}function d(_){var c=s(_.gl),b=_.gl,u=_.handle=b.createFramebuffer(),L=_._shape[0],T=_._shape[1],k=_.color.length,P=_._ext,z=_._useStencil,I=_._useDepth,D=_._colorType;b.bindFramebuffer(b.FRAMEBUFFER,u);for(var R=0;R<k;++R)_.color[R]=v(b,L,T,D,b.RGBA,b.COLOR_ATTACHMENT0+R);k===0?(_._color_rb=f(b,L,T,b.RGBA4,b.COLOR_ATTACHMENT0),P&&P.drawBuffersWEBGL(a[0])):k>1&&P.drawBuffersWEBGL(a[k]);var O=b.getExtension("WEBGL_depth_texture");O?z?_.depth=v(b,L,T,O.UNSIGNED_INT_24_8_WEBGL,b.DEPTH_STENCIL,b.DEPTH_STENCIL_ATTACHMENT):I&&(_.depth=v(b,L,T,b.UNSIGNED_SHORT,b.DEPTH_COMPONENT,b.DEPTH_ATTACHMENT)):I&&z?_._depth_rb=f(b,L,T,b.DEPTH_STENCIL,b.DEPTH_STENCIL_ATTACHMENT):I?_._depth_rb=f(b,L,T,b.DEPTH_COMPONENT16,b.DEPTH_ATTACHMENT):z&&(_._depth_rb=f(b,L,T,b.STENCIL_INDEX,b.STENCIL_ATTACHMENT));var F=b.checkFramebufferStatus(b.FRAMEBUFFER);if(F!==b.FRAMEBUFFER_COMPLETE){_._destroyed=!0,b.bindFramebuffer(b.FRAMEBUFFER,null),b.deleteFramebuffer(_.handle),_.handle=null,_.depth&&(_.depth.dispose(),_.depth=null),_._depth_rb&&(b.deleteRenderbuffer(_._depth_rb),_._depth_rb=null);for(var R=0;R<_.color.length;++R)_.color[R].dispose(),_.color[R]=null;_._color_rb&&(b.deleteRenderbuffer(_._color_rb),_._color_rb=null),i(b,c),p(F)}i(b,c)}function o(_,c,b,u,L,T,k,P){this.gl=_,this._shape=[c|0,b|0],this._destroyed=!1,this._ext=P,this.color=new Array(L);for(var z=0;z<L;++z)this.color[z]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=u,this._useDepth=T,this._useStencil=k;var I=this,D=[c|0,b|0];Object.defineProperties(D,{0:{get:function(){return I._shape[0]},set:function(R){return I.width=R}},1:{get:function(){return I._shape[1]},set:function(R){return I.height=R}}}),this._shapeVector=D,d(this)}var m=o.prototype;function l(_,c,b){if(_._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(!(_._shape[0]===c&&_._shape[1]===b)){var u=_.gl,L=u.getParameter(u.MAX_RENDERBUFFER_SIZE);if(c<0||c>L||b<0||b>L)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");_._shape[0]=c,_._shape[1]=b;for(var T=s(u),k=0;k<_.color.length;++k)_.color[k].shape=_._shape;_._color_rb&&(u.bindRenderbuffer(u.RENDERBUFFER,_._color_rb),u.renderbufferStorage(u.RENDERBUFFER,u.RGBA4,_._shape[0],_._shape[1])),_.depth&&(_.depth.shape=_._shape),_._depth_rb&&(u.bindRenderbuffer(u.RENDERBUFFER,_._depth_rb),_._useDepth&&_._useStencil?u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_STENCIL,_._shape[0],_._shape[1]):_._useDepth?u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_COMPONENT16,_._shape[0],_._shape[1]):_._useStencil&&u.renderbufferStorage(u.RENDERBUFFER,u.STENCIL_INDEX,_._shape[0],_._shape[1])),u.bindFramebuffer(u.FRAMEBUFFER,_.handle);var P=u.checkFramebufferStatus(u.FRAMEBUFFER);P!==u.FRAMEBUFFER_COMPLETE&&(_.dispose(),i(u,T),p(P)),i(u,T)}}Object.defineProperties(m,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(_){if(Array.isArray(_)||(_=[_|0,_|0]),_.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var c=_[0]|0,b=_[1]|0;return l(this,c,b),[c,b]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(_){return _=_|0,l(this,_,this._shape[1]),_},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(_){return _=_|0,l(this,this._shape[0],_),_},enumerable:!1}}),m.bind=function(){if(!this._destroyed){var _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,this.handle),_.viewport(0,0,this._shape[0],this._shape[1])}},m.dispose=function(){if(!this._destroyed){this._destroyed=!0;var _=this.gl;_.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(_.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var c=0;c<this.color.length;++c)this.color[c].dispose(),this.color[c]=null;this._color_rb&&(_.deleteRenderbuffer(this._color_rb),this._color_rb=null)}};function w(_,c,b,u){n||(n=_.FRAMEBUFFER_UNSUPPORTED,r=_.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,t=_.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,h=_.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var L=_.getExtension("WEBGL_draw_buffers");if(!a&&L&&x(_,L),Array.isArray(c)&&(u=b,b=c[1]|0,c=c[0]|0),typeof c!="number")throw new Error("gl-fbo: Missing shape parameter");var T=_.getParameter(_.MAX_RENDERBUFFER_SIZE);if(c<0||c>T||b<0||b>T)throw new Error("gl-fbo: Parameters are too large for FBO");u=u||{};var k=1;if("color"in u){if(k=Math.max(u.color|0,0),k<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(k>1)if(L){if(k>_.getParameter(L.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+k+" draw buffers")}else throw new Error("gl-fbo: Multiple draw buffer extension not supported")}var P=_.UNSIGNED_BYTE,z=_.getExtension("OES_texture_float");if(u.float&&k>0){if(!z)throw new Error("gl-fbo: Context does not support floating point textures");P=_.FLOAT}else u.preferFloat&&k>0&&z&&(P=_.FLOAT);var I=!0;"depth"in u&&(I=!!u.depth);var D=!1;return"stencil"in u&&(D=!!u.stencil),new o(_,c,b,P,k,I,D,L)}},{"gl-texture2d":146}],87:[function(g,S,M){var e=g("sprintf-js").sprintf,a=g("gl-constants/lookup"),n=g("glsl-shader-name"),r=g("add-line-numbers");S.exports=t;function t(h,s,i){var x=n(s)||"of unknown name (see npm glsl-shader-name)",p="unknown type";i!==void 0&&(p=i===a.FRAGMENT_SHADER?"fragment":"vertex");for(var v=e(`Error compiling %s shader %s:
`,p,x),f=e("%s%s",v,h),d=h.split(`
`),o={},m=0;m<d.length;m++){var l=d[m];if(!(l===""||l==="\0")){var w=parseInt(l.split(":")[2]);if(isNaN(w))throw new Error(e("Could not parse error: %s",l));o[w]=l}}for(var _=r(s).split(`
`),m=0;m<_.length;m++)if(!(!o[m+3]&&!o[m+2]&&!o[m+1])){var c=_[m];if(v+=c+`
`,o[m+1]){var b=o[m+1];b=b.substr(b.split(":",3).join(":").length+1).trim(),v+=e(`^^^ %s

`,b)}}return{long:v.trim(),short:f.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(g,S,M){S.exports=p;var e=g("binary-search-bounds"),a=g("iota-array"),n=g("typedarray-pool"),r=g("gl-shader"),t=g("gl-buffer"),h=g("./lib/shaders");function s(v,f,d,o,m,l,w){this.plot=v,this.shader=f,this.pickShader=d,this.positionBuffer=o,this.weightBuffer=m,this.colorBuffer=l,this.idBuffer=w,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var i=s.prototype,x=[0,0,1,0,0,1,1,0,1,1,0,1];i.draw=function(){var v=[1,0,0,0,1,0,0,0,1];return function(){var f=this.plot,d=this.shader,o=this.bounds,m=this.numVertices;if(!(m<=0)){var l=f.gl,w=f.dataBox,_=o[2]-o[0],c=o[3]-o[1],b=w[2]-w[0],u=w[3]-w[1];v[0]=2*_/b,v[4]=2*c/u,v[6]=2*(o[0]-w[0])/b-1,v[7]=2*(o[1]-w[1])/u-1,d.bind();var L=d.uniforms;L.viewTransform=v,L.shape=this.shape;var T=d.attributes;this.positionBuffer.bind(),T.position.pointer(),this.weightBuffer.bind(),T.weight.pointer(l.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),T.color.pointer(l.UNSIGNED_BYTE,!0),l.drawArrays(l.TRIANGLES,0,m)}}}(),i.drawPick=function(){var v=[1,0,0,0,1,0,0,0,1],f=[0,0,0,0];return function(d){var o=this.plot,m=this.pickShader,l=this.bounds,w=this.numVertices;if(!(w<=0)){var _=o.gl,c=o.dataBox,b=l[2]-l[0],u=l[3]-l[1],L=c[2]-c[0],T=c[3]-c[1];v[0]=2*b/L,v[4]=2*u/T,v[6]=2*(l[0]-c[0])/L-1,v[7]=2*(l[1]-c[1])/T-1;for(var k=0;k<4;++k)f[k]=d>>k*8&255;this.pickOffset=d,m.bind();var P=m.uniforms;P.viewTransform=v,P.pickOffset=f,P.shape=this.shape;var z=m.attributes;return this.positionBuffer.bind(),z.position.pointer(),this.weightBuffer.bind(),z.weight.pointer(_.UNSIGNED_BYTE,!1),this.idBuffer.bind(),z.pickId.pointer(_.UNSIGNED_BYTE,!1),_.drawArrays(_.TRIANGLES,0,w),d+this.shape[0]*this.shape[1]}}}(),i.pick=function(v,f,d){var o=this.pickOffset,m=this.shape[0]*this.shape[1];if(d<o||d>=o+m)return null;var l=d-o,w=this.xData,_=this.yData;return{object:this,pointId:l,dataCoord:[w[l%this.shape[0]],_[l/this.shape[0]|0]]}},i.update=function(v){v=v||{};var f=v.shape||[0,0],d=v.x||a(f[0]),o=v.y||a(f[1]),m=v.z||new Float32Array(f[0]*f[1]),l=v.zsmooth!==!1;this.xData=d,this.yData=o;var w=v.colorLevels||[0],_=v.colorValues||[0,0,0,1],c=w.length,b=this.bounds,u,L,T,k;l?(u=b[0]=d[0],L=b[1]=o[0],T=b[2]=d[d.length-1],k=b[3]=o[o.length-1]):(u=b[0]=d[0]+(d[1]-d[0])/2,L=b[1]=o[0]+(o[1]-o[0])/2,T=b[2]=d[d.length-1]+(d[d.length-1]-d[d.length-2])/2,k=b[3]=o[o.length-1]+(o[o.length-1]-o[o.length-2])/2);var P=1/(T-u),z=1/(k-L),I=f[0],D=f[1];this.shape=[I,D];var R=(l?(I-1)*(D-1):I*D)*(x.length>>>1);this.numVertices=R;for(var O=n.mallocUint8(R*4),F=n.mallocFloat32(R*2),N=n.mallocUint8(R*2),G=n.mallocUint32(R),K=0,W=l?I-1:I,Y=l?D-1:D,re=0;re<Y;++re){var ue,j;l?(ue=z*(o[re]-L),j=z*(o[re+1]-L)):(ue=re<D-1?z*(o[re]-(o[re+1]-o[re])/2-L):z*(o[re]-(o[re]-o[re-1])/2-L),j=re<D-1?z*(o[re]+(o[re+1]-o[re])/2-L):z*(o[re]+(o[re]-o[re-1])/2-L));for(var q=0;q<W;++q){var H,U;l?(H=P*(d[q]-u),U=P*(d[q+1]-u)):(H=q<I-1?P*(d[q]-(d[q+1]-d[q])/2-u):P*(d[q]-(d[q]-d[q-1])/2-u),U=q<I-1?P*(d[q]+(d[q+1]-d[q])/2-u):P*(d[q]+(d[q]-d[q-1])/2-u));for(var $=0;$<x.length;$+=2){var ne=x[$],X=x[$+1],Q=l?(re+X)*I+(q+ne):re*I+q,ie=m[Q],se=e.le(w,ie),ae,oe,be,ce;if(se<0)ae=_[0],oe=_[1],be=_[2],ce=_[3];else if(se===c-1)ae=_[4*c-4],oe=_[4*c-3],be=_[4*c-2],ce=_[4*c-1];else{var de=(ie-w[se])/(w[se+1]-w[se]),ye=1-de,ge=4*se,me=4*(se+1);ae=ye*_[ge]+de*_[me],oe=ye*_[ge+1]+de*_[me+1],be=ye*_[ge+2]+de*_[me+2],ce=ye*_[ge+3]+de*_[me+3]}O[4*K]=255*ae,O[4*K+1]=255*oe,O[4*K+2]=255*be,O[4*K+3]=255*ce,F[2*K]=H*.5+U*.5,F[2*K+1]=ue*.5+j*.5,N[2*K]=ne,N[2*K+1]=X,G[K]=re*I+q,K+=1}}}this.positionBuffer.update(F),this.weightBuffer.update(N),this.colorBuffer.update(O),this.idBuffer.update(G),n.free(F),n.free(O),n.free(N),n.free(G)},i.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)};function p(v,f){var d=v.gl,o=r(d,h.vertex,h.fragment),m=r(d,h.pickVertex,h.pickFragment),l=t(d),w=t(d),_=t(d),c=t(d),b=new s(v,o,m,l,w,_,c);return b.update(f),v.addObject(b),b}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(g,S,M){var e=g("glslify");S.exports={fragment:e([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),h=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];M.createShader=function(s){return a(s,n,r,null,h)},M.createPickShader=function(s){return a(s,n,t,null,h)}},{"gl-shader":132,glslify:231}],91:[function(g,S,M){S.exports=_;var e=g("gl-buffer"),a=g("gl-vao"),n=g("gl-texture2d"),r=new Uint8Array(4),t=new Float32Array(r.buffer);function h(c,b,u,L){return r[0]=L,r[1]=u,r[2]=b,r[3]=c,t[0]}var s=g("binary-search-bounds"),i=g("ndarray"),x=g("./lib/shaders"),p=x.createShader,v=x.createPickShader,f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function d(c,b){for(var u=0,L=0;L<3;++L){var T=c[L]-b[L];u+=T*T}return Math.sqrt(u)}function o(c){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],u=0;u<3;++u)b[0][u]=Math.max(c[0][u],b[0][u]),b[1][u]=Math.min(c[1][u],b[1][u]);return b}function m(c,b,u,L){this.arcLength=c,this.position=b,this.index=u,this.dataCoordinate=L}function l(c,b,u,L,T,k){this.gl=c,this.shader=b,this.pickShader=u,this.buffer=L,this.vao=T,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=k,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var w=l.prototype;w.isTransparent=function(){return this.hasAlpha},w.isOpaque=function(){return!this.hasAlpha},w.pickSlots=1,w.setPickBase=function(c){this.pickId=c},w.drawTransparent=w.draw=function(c){if(this.vertexCount){var b=this.gl,u=this.shader,L=this.vao;u.bind(),u.uniforms={model:c.model||f,view:c.view||f,projection:c.projection||f,clipBounds:o(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},L.bind(),L.draw(b.TRIANGLE_STRIP,this.vertexCount),L.unbind()}},w.drawPick=function(c){if(this.vertexCount){var b=this.gl,u=this.pickShader,L=this.vao;u.bind(),u.uniforms={model:c.model||f,view:c.view||f,projection:c.projection||f,pickId:this.pickId,clipBounds:o(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},L.bind(),L.draw(b.TRIANGLE_STRIP,this.vertexCount),L.unbind()}},w.update=function(c){var b,u;this.dirty=!0;var L=!!c.connectGaps;"dashScale"in c&&(this.dashScale=c.dashScale),this.hasAlpha=!1,"opacity"in c&&(this.opacity=+c.opacity,this.opacity<1&&(this.hasAlpha=!0));var T=[],k=[],P=[],z=0,I=0,D=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],R=c.position||c.positions;if(R){var O=c.color||c.colors||[0,0,0,1],F=c.lineWidth||1,N=!1;e:for(b=1;b<R.length;++b){var G=R[b-1],K=R[b];for(k.push(z),P.push(G.slice()),u=0;u<3;++u){if(isNaN(G[u])||isNaN(K[u])||!isFinite(G[u])||!isFinite(K[u])){if(!L&&T.length>0){for(var W=0;W<24;++W)T.push(T[T.length-12]);I+=2,N=!0}continue e}D[0][u]=Math.min(D[0][u],G[u],K[u]),D[1][u]=Math.max(D[1][u],G[u],K[u])}var Y,re;Array.isArray(O[0])?(Y=O.length>b-1?O[b-1]:O.length>0?O[O.length-1]:[0,0,0,1],re=O.length>b?O[b]:O.length>0?O[O.length-1]:[0,0,0,1]):Y=re=O,Y.length===3&&(Y=[Y[0],Y[1],Y[2],1]),re.length===3&&(re=[re[0],re[1],re[2],1]),!this.hasAlpha&&Y[3]<1&&(this.hasAlpha=!0);var ue;Array.isArray(F)?ue=F.length>b-1?F[b-1]:F.length>0?F[F.length-1]:[0,0,0,1]:ue=F;var j=z;if(z+=d(G,K),N){for(u=0;u<2;++u)T.push(G[0],G[1],G[2],K[0],K[1],K[2],j,ue,Y[0],Y[1],Y[2],Y[3]);I+=2,N=!1}T.push(G[0],G[1],G[2],K[0],K[1],K[2],j,ue,Y[0],Y[1],Y[2],Y[3],G[0],G[1],G[2],K[0],K[1],K[2],j,-ue,Y[0],Y[1],Y[2],Y[3],K[0],K[1],K[2],G[0],G[1],G[2],z,-ue,re[0],re[1],re[2],re[3],K[0],K[1],K[2],G[0],G[1],G[2],z,ue,re[0],re[1],re[2],re[3]),I+=4}}if(this.buffer.update(T),k.push(z),P.push(R[R.length-1].slice()),this.bounds=D,this.vertexCount=I,this.points=P,this.arcLength=k,"dashes"in c){var q=c.dashes,H=q.slice();for(H.unshift(0),b=1;b<H.length;++b)H[b]=H[b-1]+H[b];var U=i(new Array(256*4),[256,1,4]);for(b=0;b<256;++b){for(u=0;u<4;++u)U.set(b,0,u,0);s.le(H,H[H.length-1]*b/255)&1?U.set(b,0,0,0):U.set(b,0,0,255)}this.texture.setPixels(U)}},w.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},w.pick=function(c){if(!c||c.id!==this.pickId)return null;var b=h(c.value[0],c.value[1],c.value[2],0),u=s.le(this.arcLength,b);if(u<0)return null;if(u===this.arcLength.length-1)return new m(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),u);for(var L=this.points[u],T=this.points[Math.min(u+1,this.points.length-1)],k=(b-this.arcLength[u])/(this.arcLength[u+1]-this.arcLength[u]),P=1-k,z=[0,0,0],I=0;I<3;++I)z[I]=P*L[I]+k*T[I];var D=Math.min(k<.5?u:u+1,this.points.length-1);return new m(b,z,D,this.points[D])};function _(c){var b=c.gl||c.scene&&c.scene.gl,u=p(b);u.attributes.position.location=0,u.attributes.nextPosition.location=1,u.attributes.arcLength.location=2,u.attributes.lineWidth.location=3,u.attributes.color.location=4;var L=v(b);L.attributes.position.location=0,L.attributes.nextPosition.location=1,L.attributes.arcLength.location=2,L.attributes.lineWidth.location=3,L.attributes.color.location=4;for(var T=e(b),k=a(b,[{buffer:T,size:3,offset:0,stride:48},{buffer:T,size:3,offset:12,stride:48},{buffer:T,size:1,offset:24,stride:48},{buffer:T,size:1,offset:28,stride:48},{buffer:T,size:4,offset:32,stride:48}]),P=i(new Array(256*4),[256,1,4]),z=0;z<256*4;++z)P.data[z]=255;var I=n(b,P);I.wrap=b.REPEAT;var D=new l(b,u,L,T,k,I);return D.update(c),D}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(g,S,M){S.exports=e;function e(a){var n=new Float32Array(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n}},{}],93:[function(g,S,M){S.exports=e;function e(){var a=new Float32Array(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],94:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],h=a[3],s=a[4],i=a[5],x=a[6],p=a[7],v=a[8],f=a[9],d=a[10],o=a[11],m=a[12],l=a[13],w=a[14],_=a[15],c=n*i-r*s,b=n*x-t*s,u=n*p-h*s,L=r*x-t*i,T=r*p-h*i,k=t*p-h*x,P=v*l-f*m,z=v*w-d*m,I=v*_-o*m,D=f*w-d*l,R=f*_-o*l,O=d*_-o*w;return c*O-b*R+u*D+L*I-T*z+k*P}},{}],95:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],h=n[2],s=n[3],i=r+r,x=t+t,p=h+h,v=r*i,f=t*i,d=t*x,o=h*i,m=h*x,l=h*p,w=s*i,_=s*x,c=s*p;return a[0]=1-d-l,a[1]=f+c,a[2]=o-_,a[3]=0,a[4]=f-c,a[5]=1-v-l,a[6]=m+w,a[7]=0,a[8]=o+_,a[9]=m-w,a[10]=1-v-d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],96:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],h=n[1],s=n[2],i=n[3],x=t+t,p=h+h,v=s+s,f=t*x,d=t*p,o=t*v,m=h*p,l=h*v,w=s*v,_=i*x,c=i*p,b=i*v;return a[0]=1-(m+w),a[1]=d+b,a[2]=o-c,a[3]=0,a[4]=d-b,a[5]=1-(f+w),a[6]=l+_,a[7]=0,a[8]=o+c,a[9]=l-_,a[10]=1-(f+m),a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a}},{}],97:[function(g,S,M){S.exports=e;function e(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],98:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],h=n[2],s=n[3],i=n[4],x=n[5],p=n[6],v=n[7],f=n[8],d=n[9],o=n[10],m=n[11],l=n[12],w=n[13],_=n[14],c=n[15],b=r*x-t*i,u=r*p-h*i,L=r*v-s*i,T=t*p-h*x,k=t*v-s*x,P=h*v-s*p,z=f*w-d*l,I=f*_-o*l,D=f*c-m*l,R=d*_-o*w,O=d*c-m*w,F=o*c-m*_,N=b*F-u*O+L*R+T*D-k*I+P*z;return N?(N=1/N,a[0]=(x*F-p*O+v*R)*N,a[1]=(h*O-t*F-s*R)*N,a[2]=(w*P-_*k+c*T)*N,a[3]=(o*k-d*P-m*T)*N,a[4]=(p*D-i*F-v*I)*N,a[5]=(r*F-h*D+s*I)*N,a[6]=(_*L-l*P-c*u)*N,a[7]=(f*P-o*L+m*u)*N,a[8]=(i*O-x*D+v*z)*N,a[9]=(t*D-r*O-s*z)*N,a[10]=(l*k-w*L+c*b)*N,a[11]=(d*L-f*k-m*b)*N,a[12]=(x*I-i*R-p*z)*N,a[13]=(r*R-t*I+h*z)*N,a[14]=(w*u-l*T-_*b)*N,a[15]=(f*T-d*u+o*b)*N,a):null}},{}],99:[function(g,S,M){var e=g("./identity");S.exports=a;function a(n,r,t,h){var s,i,x,p,v,f,d,o,m,l,w=r[0],_=r[1],c=r[2],b=h[0],u=h[1],L=h[2],T=t[0],k=t[1],P=t[2];return Math.abs(w-T)<1e-6&&Math.abs(_-k)<1e-6&&Math.abs(c-P)<1e-6?e(n):(d=w-T,o=_-k,m=c-P,l=1/Math.sqrt(d*d+o*o+m*m),d*=l,o*=l,m*=l,s=u*m-L*o,i=L*d-b*m,x=b*o-u*d,l=Math.sqrt(s*s+i*i+x*x),l?(l=1/l,s*=l,i*=l,x*=l):(s=0,i=0,x=0),p=o*x-m*i,v=m*s-d*x,f=d*i-o*s,l=Math.sqrt(p*p+v*v+f*f),l?(l=1/l,p*=l,v*=l,f*=l):(p=0,v=0,f=0),n[0]=s,n[1]=p,n[2]=d,n[3]=0,n[4]=i,n[5]=v,n[6]=o,n[7]=0,n[8]=x,n[9]=f,n[10]=m,n[11]=0,n[12]=-(s*w+i*_+x*c),n[13]=-(p*w+v*_+f*c),n[14]=-(d*w+o*_+m*c),n[15]=1,n)}},{"./identity":97}],100:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],h=n[1],s=n[2],i=n[3],x=n[4],p=n[5],v=n[6],f=n[7],d=n[8],o=n[9],m=n[10],l=n[11],w=n[12],_=n[13],c=n[14],b=n[15],u=r[0],L=r[1],T=r[2],k=r[3];return a[0]=u*t+L*x+T*d+k*w,a[1]=u*h+L*p+T*o+k*_,a[2]=u*s+L*v+T*m+k*c,a[3]=u*i+L*f+T*l+k*b,u=r[4],L=r[5],T=r[6],k=r[7],a[4]=u*t+L*x+T*d+k*w,a[5]=u*h+L*p+T*o+k*_,a[6]=u*s+L*v+T*m+k*c,a[7]=u*i+L*f+T*l+k*b,u=r[8],L=r[9],T=r[10],k=r[11],a[8]=u*t+L*x+T*d+k*w,a[9]=u*h+L*p+T*o+k*_,a[10]=u*s+L*v+T*m+k*c,a[11]=u*i+L*f+T*l+k*b,u=r[12],L=r[13],T=r[14],k=r[15],a[12]=u*t+L*x+T*d+k*w,a[13]=u*h+L*p+T*o+k*_,a[14]=u*s+L*v+T*m+k*c,a[15]=u*i+L*f+T*l+k*b,a}},{}],101:[function(g,S,M){S.exports=e;function e(a,n,r,t,h,s,i){var x=1/(n-r),p=1/(t-h),v=1/(s-i);return a[0]=-2*x,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*p,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*v,a[11]=0,a[12]=(n+r)*x,a[13]=(h+t)*p,a[14]=(i+s)*v,a[15]=1,a}},{}],102:[function(g,S,M){S.exports=e;function e(a,n,r,t,h){var s=1/Math.tan(n/2),i=1/(t-h);return a[0]=s/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(h+t)*i,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*h*t*i,a[15]=0,a}},{}],103:[function(g,S,M){S.exports=e;function e(a,n,r,t){var h=t[0],s=t[1],i=t[2],x=Math.sqrt(h*h+s*s+i*i),p,v,f,d,o,m,l,w,_,c,b,u,L,T,k,P,z,I,D,R,O,F,N,G;return Math.abs(x)<1e-6?null:(x=1/x,h*=x,s*=x,i*=x,p=Math.sin(r),v=Math.cos(r),f=1-v,d=n[0],o=n[1],m=n[2],l=n[3],w=n[4],_=n[5],c=n[6],b=n[7],u=n[8],L=n[9],T=n[10],k=n[11],P=h*h*f+v,z=s*h*f+i*p,I=i*h*f-s*p,D=h*s*f-i*p,R=s*s*f+v,O=i*s*f+h*p,F=h*i*f+s*p,N=s*i*f-h*p,G=i*i*f+v,a[0]=d*P+w*z+u*I,a[1]=o*P+_*z+L*I,a[2]=m*P+c*z+T*I,a[3]=l*P+b*z+k*I,a[4]=d*D+w*R+u*O,a[5]=o*D+_*R+L*O,a[6]=m*D+c*R+T*O,a[7]=l*D+b*R+k*O,a[8]=d*F+w*N+u*G,a[9]=o*F+_*N+L*G,a[10]=m*F+c*N+T*G,a[11]=l*F+b*N+k*G,n!==a&&(a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a)}},{}],104:[function(g,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),h=Math.cos(r),s=n[4],i=n[5],x=n[6],p=n[7],v=n[8],f=n[9],d=n[10],o=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=s*h+v*t,a[5]=i*h+f*t,a[6]=x*h+d*t,a[7]=p*h+o*t,a[8]=v*h-s*t,a[9]=f*h-i*t,a[10]=d*h-x*t,a[11]=o*h-p*t,a}},{}],105:[function(g,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),h=Math.cos(r),s=n[0],i=n[1],x=n[2],p=n[3],v=n[8],f=n[9],d=n[10],o=n[11];return n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=s*h-v*t,a[1]=i*h-f*t,a[2]=x*h-d*t,a[3]=p*h-o*t,a[8]=s*t+v*h,a[9]=i*t+f*h,a[10]=x*t+d*h,a[11]=p*t+o*h,a}},{}],106:[function(g,S,M){S.exports=e;function e(a,n,r){var t=Math.sin(r),h=Math.cos(r),s=n[0],i=n[1],x=n[2],p=n[3],v=n[4],f=n[5],d=n[6],o=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=s*h+v*t,a[1]=i*h+f*t,a[2]=x*h+d*t,a[3]=p*h+o*t,a[4]=v*h-s*t,a[5]=f*h-i*t,a[6]=d*h-x*t,a[7]=o*h-p*t,a}},{}],107:[function(g,S,M){S.exports=e;function e(a,n,r){var t=r[0],h=r[1],s=r[2];return a[0]=n[0]*t,a[1]=n[1]*t,a[2]=n[2]*t,a[3]=n[3]*t,a[4]=n[4]*h,a[5]=n[5]*h,a[6]=n[6]*h,a[7]=n[7]*h,a[8]=n[8]*s,a[9]=n[9]*s,a[10]=n[10]*s,a[11]=n[11]*s,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a}},{}],108:[function(g,S,M){S.exports=e;function e(a,n,r){var t=r[0],h=r[1],s=r[2],i,x,p,v,f,d,o,m,l,w,_,c;return n===a?(a[12]=n[0]*t+n[4]*h+n[8]*s+n[12],a[13]=n[1]*t+n[5]*h+n[9]*s+n[13],a[14]=n[2]*t+n[6]*h+n[10]*s+n[14],a[15]=n[3]*t+n[7]*h+n[11]*s+n[15]):(i=n[0],x=n[1],p=n[2],v=n[3],f=n[4],d=n[5],o=n[6],m=n[7],l=n[8],w=n[9],_=n[10],c=n[11],a[0]=i,a[1]=x,a[2]=p,a[3]=v,a[4]=f,a[5]=d,a[6]=o,a[7]=m,a[8]=l,a[9]=w,a[10]=_,a[11]=c,a[12]=i*t+f*h+l*s+n[12],a[13]=x*t+d*h+w*s+n[13],a[14]=p*t+o*h+_*s+n[14],a[15]=v*t+m*h+c*s+n[15]),a}},{}],109:[function(g,S,M){S.exports=e;function e(a,n){if(a===n){var r=n[1],t=n[2],h=n[3],s=n[6],i=n[7],x=n[11];a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=r,a[6]=n[9],a[7]=n[13],a[8]=t,a[9]=s,a[11]=n[14],a[12]=h,a[13]=i,a[14]=x}else a[0]=n[0],a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=n[1],a[5]=n[5],a[6]=n[9],a[7]=n[13],a[8]=n[2],a[9]=n[6],a[10]=n[10],a[11]=n[14],a[12]=n[3],a[13]=n[7],a[14]=n[11],a[15]=n[15];return a}},{}],110:[function(g,S,M){var e=g("barycentric"),a=g("polytope-closest-point/lib/closest_point_2d.js");S.exports=s;function n(i,x){for(var p=[0,0,0,0],v=0;v<4;++v)for(var f=0;f<4;++f)p[f]+=i[4*v+f]*x[v];return p}function r(i,x,p,v,f){for(var d=n(v,n(p,n(x,[i[0],i[1],i[2],1]))),o=0;o<3;++o)d[o]/=d[3];return[.5*f[0]*(1+d[0]),.5*f[1]*(1-d[1])]}function t(i,x){if(i.length===2){for(var p=0,v=0,f=0;f<2;++f)p+=Math.pow(x[f]-i[0][f],2),v+=Math.pow(x[f]-i[1][f],2);return p=Math.sqrt(p),v=Math.sqrt(v),p+v<1e-6?[1,0]:[v/(p+v),p/(v+p)]}else if(i.length===3){var d=[0,0];return a(i[0],i[1],i[2],x,d),e(i,d)}return[]}function h(i,x){for(var p=[0,0,0],v=0;v<i.length;++v)for(var f=i[v],d=x[v],o=0;o<3;++o)p[o]+=d*f[o];return p}function s(i,x,p,v,f,d){if(i.length===1)return[0,i[0].slice()];for(var o=new Array(i.length),m=0;m<i.length;++m)o[m]=r(i[m],p,v,f,d);for(var l=0,w=1/0,m=0;m<o.length;++m){for(var _=0,c=0;c<2;++c)_+=Math.pow(o[m][c]-x[c],2);_<w&&(w=_,l=m)}for(var b=t(o,x),u=0,m=0;m<3;++m){if(b[m]<-.001||b[m]>1.0001)return null;u+=b[m]}return Math.abs(u-1)>.001?null:[l,h(i,b),b]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(g,S,M){var e=g("glslify"),a=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),h=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),s=e([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),i=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),x=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),p=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),v=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),f=e([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},M.wireShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},M.pointShader={vertex:h,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},M.pickShader={vertex:i,fragment:x,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},M.pointPickShader={vertex:p,fragment:x,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},M.contourShader={vertex:v,fragment:f,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(g,S,M){var e=1e-6,a=1e-6,n=g("gl-shader"),r=g("gl-buffer"),t=g("gl-vao"),h=g("gl-texture2d"),s=g("normals"),i=g("gl-mat4/multiply"),x=g("gl-mat4/invert"),p=g("ndarray"),v=g("colormap"),f=g("simplicial-complex-contour"),d=g("typedarray-pool"),o=g("./lib/shaders"),m=g("./lib/closest-point"),l=o.meshShader,w=o.wireShader,_=o.pointShader,c=o.pickShader,b=o.pointPickShader,u=o.contourShader,L=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function T(W,Y,re,ue,j,q,H,U,$,ne,X,Q,ie,se,ae,oe,be,ce,de,ye,ge,me,Ee,Pe,Ue,we,ke){this.gl=W,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Y,this.dirty=!0,this.triShader=re,this.lineShader=ue,this.pointShader=j,this.pickShader=q,this.pointPickShader=H,this.contourShader=U,this.trianglePositions=$,this.triangleColors=X,this.triangleNormals=ie,this.triangleUVs=Q,this.triangleIds=ne,this.triangleVAO=se,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ae,this.edgeColors=be,this.edgeUVs=ce,this.edgeIds=oe,this.edgeVAO=de,this.edgeCount=0,this.pointPositions=ye,this.pointColors=me,this.pointUVs=Ee,this.pointSizes=Pe,this.pointIds=ge,this.pointVAO=Ue,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=we,this.contourVAO=ke,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=L,this._view=L,this._projection=L,this._resolution=[1,1]}var k=T.prototype;k.isOpaque=function(){return!this.hasAlpha},k.isTransparent=function(){return this.hasAlpha},k.pickSlots=1,k.setPickBase=function(W){this.pickId=W};function P(W,Y){if(!Y||!Y.length)return 1;for(var re=0;re<Y.length;++re){if(Y.length<2)return 1;if(Y[re][0]===W)return Y[re][1];if(Y[re][0]>W&&re>0){var ue=(Y[re][0]-W)/(Y[re][0]-Y[re-1][0]);return Y[re][1]*(1-ue)+ue*Y[re-1][1]}}return 1}function z(W,Y){for(var re=v({colormap:W,nshades:256,format:"rgba"}),ue=new Uint8Array(256*4),j=0;j<256;++j){for(var q=re[j],H=0;H<3;++H)ue[4*j+H]=q[H];Y?ue[4*j+3]=255*P(j/255,Y):ue[4*j+3]=255*q[3]}return p(ue,[256,256,4],[4,0,1])}function I(W){for(var Y=W.length,re=new Array(Y),ue=0;ue<Y;++ue)re[ue]=W[ue][2];return re}k.highlight=function(W){if(!W||!this.contourEnable){this.contourCount=0;return}for(var Y=f(this.cells,this.intensity,W.intensity),re=Y.cells,ue=Y.vertexIds,j=Y.vertexWeights,q=re.length,H=d.mallocFloat32(2*3*q),U=0,$=0;$<q;++$)for(var ne=re[$],X=0;X<2;++X){var Q=ne[0];ne.length===2&&(Q=ne[X]);for(var ie=ue[Q][0],se=ue[Q][1],ae=j[Q],oe=1-ae,be=this.positions[ie],ce=this.positions[se],de=0;de<3;++de)H[U++]=ae*be[de]+oe*ce[de]}this.contourCount=U/3|0,this.contourPositions.update(H.subarray(0,U)),d.free(H)},k.update=function(W){W=W||{};var Y=this.gl;this.dirty=!0,"contourEnable"in W&&(this.contourEnable=W.contourEnable),"contourColor"in W&&(this.contourColor=W.contourColor),"lineWidth"in W&&(this.lineWidth=W.lineWidth),"lightPosition"in W&&(this.lightPosition=W.lightPosition),this.hasAlpha=!1,"opacity"in W&&(this.opacity=W.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in W&&(this.opacityscale=W.opacityscale,this.hasAlpha=!0),"ambient"in W&&(this.ambientLight=W.ambient),"diffuse"in W&&(this.diffuseLight=W.diffuse),"specular"in W&&(this.specularLight=W.specular),"roughness"in W&&(this.roughness=W.roughness),"fresnel"in W&&(this.fresnel=W.fresnel),W.texture?(this.texture.dispose(),this.texture=h(Y,W.texture)):W.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Y.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Y.LINEAR,this.texture.setPixels(z(W.colormap,this.opacityscale)),this.texture.generateMipmap());var re=W.cells,ue=W.positions;if(!(!ue||!re)){var j=[],q=[],H=[],U=[],$=[],ne=[],X=[],Q=[],ie=[],se=[],ae=[],oe=[],be=[],ce=[];this.cells=re,this.positions=ue;var de=W.vertexNormals,ye=W.cellNormals,ge=W.vertexNormalsEpsilon===void 0?e:W.vertexNormalsEpsilon,me=W.faceNormalsEpsilon===void 0?a:W.faceNormalsEpsilon;W.useFacetNormals&&!ye&&(ye=s.faceNormals(re,ue,me)),!ye&&!de&&(de=s.vertexNormals(re,ue,ge));var Ee=W.vertexColors,Pe=W.cellColors,Ue=W.meshColor||[1,1,1,1],we=W.vertexUVs,ke=W.vertexIntensity,Xe=W.cellUVs,Ve=W.cellIntensity,Ie=1/0,De=-1/0;if(!we&&!Xe)if(ke)if(W.vertexIntensityBounds)Ie=+W.vertexIntensityBounds[0],De=+W.vertexIntensityBounds[1];else for(var Ye=0;Ye<ke.length;++Ye){var vt=ke[Ye];Ie=Math.min(Ie,vt),De=Math.max(De,vt)}else if(Ve)if(W.cellIntensityBounds)Ie=+W.cellIntensityBounds[0],De=+W.cellIntensityBounds[1];else for(var Ye=0;Ye<Ve.length;++Ye){var vt=Ve[Ye];Ie=Math.min(Ie,vt),De=Math.max(De,vt)}else for(var Ye=0;Ye<ue.length;++Ye){var vt=ue[Ye][2];Ie=Math.min(Ie,vt),De=Math.max(De,vt)}ke?this.intensity=ke:Ve?this.intensity=Ve:this.intensity=I(ue),this.pickVertex=!(Ve||Pe);var Dt=W.pointSizes,Kt=W.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var Ye=0;Ye<ue.length;++Ye)for(var Ft=ue[Ye],Mt=0;Mt<3;++Mt)isNaN(Ft[Mt])||!isFinite(Ft[Mt])||(this.bounds[0][Mt]=Math.min(this.bounds[0][Mt],Ft[Mt]),this.bounds[1][Mt]=Math.max(this.bounds[1][Mt],Ft[Mt]));var Xt=0,It=0,At=0;e:for(var Ye=0;Ye<re.length;++Ye){var Ge=re[Ye];switch(Ge.length){case 1:for(var tt=Ge[0],Ft=ue[tt],Mt=0;Mt<3;++Mt)if(isNaN(Ft[Mt])||!isFinite(Ft[Mt]))continue e;se.push(Ft[0],Ft[1],Ft[2]);var He;Ee?He=Ee[tt]:Pe?He=Pe[Ye]:He=Ue,this.opacityscale&&ke?q.push(He[0],He[1],He[2],this.opacity*P((ke[tt]-Ie)/(De-Ie),this.opacityscale)):He.length===3?ae.push(He[0],He[1],He[2],this.opacity):(ae.push(He[0],He[1],He[2],He[3]*this.opacity),He[3]<1&&(this.hasAlpha=!0));var Ae;we?Ae=we[tt]:ke?Ae=[(ke[tt]-Ie)/(De-Ie),0]:Xe?Ae=Xe[Ye]:Ve?Ae=[(Ve[Ye]-Ie)/(De-Ie),0]:Ae=[(Ft[2]-Ie)/(De-Ie),0],oe.push(Ae[0],Ae[1]),Dt?be.push(Dt[tt]):be.push(Kt),ce.push(Ye),At+=1;break;case 2:for(var Mt=0;Mt<2;++Mt)for(var tt=Ge[Mt],Ft=ue[tt],Ne=0;Ne<3;++Ne)if(isNaN(Ft[Ne])||!isFinite(Ft[Ne]))continue e;for(var Mt=0;Mt<2;++Mt){var tt=Ge[Mt],Ft=ue[tt];ne.push(Ft[0],Ft[1],Ft[2]);var He;Ee?He=Ee[tt]:Pe?He=Pe[Ye]:He=Ue,this.opacityscale&&ke?q.push(He[0],He[1],He[2],this.opacity*P((ke[tt]-Ie)/(De-Ie),this.opacityscale)):He.length===3?X.push(He[0],He[1],He[2],this.opacity):(X.push(He[0],He[1],He[2],He[3]*this.opacity),He[3]<1&&(this.hasAlpha=!0));var Ae;we?Ae=we[tt]:ke?Ae=[(ke[tt]-Ie)/(De-Ie),0]:Xe?Ae=Xe[Ye]:Ve?Ae=[(Ve[Ye]-Ie)/(De-Ie),0]:Ae=[(Ft[2]-Ie)/(De-Ie),0],Q.push(Ae[0],Ae[1]),ie.push(Ye)}It+=1;break;case 3:for(var Mt=0;Mt<3;++Mt)for(var tt=Ge[Mt],Ft=ue[tt],Ne=0;Ne<3;++Ne)if(isNaN(Ft[Ne])||!isFinite(Ft[Ne]))continue e;for(var Mt=0;Mt<3;++Mt){var tt=Ge[2-Mt],Ft=ue[tt];j.push(Ft[0],Ft[1],Ft[2]);var He;Ee?He=Ee[tt]:Pe?He=Pe[Ye]:He=Ue,He?this.opacityscale&&ke?q.push(He[0],He[1],He[2],this.opacity*P((ke[tt]-Ie)/(De-Ie),this.opacityscale)):He.length===3?q.push(He[0],He[1],He[2],this.opacity):(q.push(He[0],He[1],He[2],He[3]*this.opacity),He[3]<1&&(this.hasAlpha=!0)):q.push(.5,.5,.5,1);var Ae;we?Ae=we[tt]:ke?Ae=[(ke[tt]-Ie)/(De-Ie),0]:Xe?Ae=Xe[Ye]:Ve?Ae=[(Ve[Ye]-Ie)/(De-Ie),0]:Ae=[(Ft[2]-Ie)/(De-Ie),0],U.push(Ae[0],Ae[1]);var Ze;de?Ze=de[tt]:Ze=ye[Ye],H.push(Ze[0],Ze[1],Ze[2]),$.push(Ye)}Xt+=1;break}}this.pointCount=At,this.edgeCount=It,this.triangleCount=Xt,this.pointPositions.update(se),this.pointColors.update(ae),this.pointUVs.update(oe),this.pointSizes.update(be),this.pointIds.update(new Uint32Array(ce)),this.edgePositions.update(ne),this.edgeColors.update(X),this.edgeUVs.update(Q),this.edgeIds.update(new Uint32Array(ie)),this.trianglePositions.update(j),this.triangleColors.update(q),this.triangleUVs.update(U),this.triangleNormals.update(H),this.triangleIds.update(new Uint32Array($))}},k.drawTransparent=k.draw=function(W){W=W||{};for(var Y=this.gl,re=W.model||L,ue=W.view||L,j=W.projection||L,q=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],H=0;H<3;++H)q[0][H]=Math.max(q[0][H],this.clipBounds[0][H]),q[1][H]=Math.min(q[1][H],this.clipBounds[1][H]);var U={model:re,view:ue,projection:j,inverseModel:L.slice(),clipBounds:q,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};U.inverseModel=x(U.inverseModel,U.model),Y.disable(Y.CULL_FACE),this.texture.bind(0);var $=new Array(16);i($,U.view,U.model),i($,U.projection,$),x($,$);for(var H=0;H<3;++H)U.eyePosition[H]=$[12+H]/$[15];for(var ne=$[15],H=0;H<3;++H)ne+=this.lightPosition[H]*$[4*H+3];for(var H=0;H<3;++H){for(var X=$[12+H],Q=0;Q<3;++Q)X+=$[4*Q+H]*this.lightPosition[Q];U.lightPosition[H]=X/ne}if(this.triangleCount>0){var ie=this.triShader;ie.bind(),ie.uniforms=U,this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var ie=this.lineShader;ie.bind(),ie.uniforms=U,this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()}if(this.pointCount>0){var ie=this.pointShader;ie.bind(),ie.uniforms=U,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var ie=this.contourShader;ie.bind(),ie.uniforms=U,this.contourVAO.bind(),Y.drawArrays(Y.LINES,0,this.contourCount),this.contourVAO.unbind()}},k.drawPick=function(W){W=W||{};for(var Y=this.gl,re=W.model||L,ue=W.view||L,j=W.projection||L,q=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],H=0;H<3;++H)q[0][H]=Math.max(q[0][H],this.clipBounds[0][H]),q[1][H]=Math.min(q[1][H],this.clipBounds[1][H]);this._model=[].slice.call(re),this._view=[].slice.call(ue),this._projection=[].slice.call(j),this._resolution=[Y.drawingBufferWidth,Y.drawingBufferHeight];var U={model:re,view:ue,projection:j,clipBounds:q,pickId:this.pickId/255},$=this.pickShader;if($.bind(),$.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()),this.pointCount>0){var $=this.pointPickShader;$.bind(),$.uniforms=U,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()}},k.pick=function(W){if(!W||W.id!==this.pickId)return null;for(var Y=W.value[0]+256*W.value[1]+65536*W.value[2],re=this.cells[Y],ue=this.positions,j=new Array(re.length),q=0;q<re.length;++q)j[q]=ue[re[q]];var H=W.coord[0],U=W.coord[1];if(!this.pickVertex){var $=this.positions[re[0]],ne=this.positions[re[1]],X=this.positions[re[2]],Q=[($[0]+ne[0]+X[0])/3,($[1]+ne[1]+X[1])/3,($[2]+ne[2]+X[2])/3];return{_cellCenter:!0,position:[H,U],index:Y,cell:re,cellId:Y,intensity:this.intensity[Y],dataCoordinate:Q}}var ie=m(j,[H*this.pixelRatio,this._resolution[1]-U*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!ie)return null;for(var se=ie[2],ae=0,q=0;q<re.length;++q)ae+=se[q]*this.intensity[re[q]];return{position:ie[1],index:re[ie[0]],cell:re,cellId:Y,intensity:ae,dataCoordinate:this.positions[re[ie[0]]]}},k.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()};function D(W){var Y=n(W,l.vertex,l.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.normal.location=4,Y}function R(W){var Y=n(W,w.vertex,w.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y}function O(W){var Y=n(W,_.vertex,_.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.pointSize.location=4,Y}function F(W){var Y=n(W,c.vertex,c.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y}function N(W){var Y=n(W,b.vertex,b.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y.attributes.pointSize.location=4,Y}function G(W){var Y=n(W,u.vertex,u.fragment);return Y.attributes.position.location=0,Y}function K(W,Y){arguments.length===1&&(Y=W,W=Y.gl);var re=W.getExtension("OES_standard_derivatives")||W.getExtension("MOZ_OES_standard_derivatives")||W.getExtension("WEBKIT_OES_standard_derivatives");if(!re)throw new Error("derivatives not supported");var ue=D(W),j=R(W),q=O(W),H=F(W),U=N(W),$=G(W),ne=h(W,p(new Uint8Array([255,255,255,255]),[1,1,4]));ne.generateMipmap(),ne.minFilter=W.LINEAR_MIPMAP_LINEAR,ne.magFilter=W.LINEAR;var X=r(W),Q=r(W),ie=r(W),se=r(W),ae=r(W),oe=t(W,[{buffer:X,type:W.FLOAT,size:3},{buffer:ae,type:W.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Q,type:W.FLOAT,size:4},{buffer:ie,type:W.FLOAT,size:2},{buffer:se,type:W.FLOAT,size:3}]),be=r(W),ce=r(W),de=r(W),ye=r(W),ge=t(W,[{buffer:be,type:W.FLOAT,size:3},{buffer:ye,type:W.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ce,type:W.FLOAT,size:4},{buffer:de,type:W.FLOAT,size:2}]),me=r(W),Ee=r(W),Pe=r(W),Ue=r(W),we=r(W),ke=t(W,[{buffer:me,type:W.FLOAT,size:3},{buffer:we,type:W.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Ee,type:W.FLOAT,size:4},{buffer:Pe,type:W.FLOAT,size:2},{buffer:Ue,type:W.FLOAT,size:1}]),Xe=r(W),Ve=t(W,[{buffer:Xe,type:W.FLOAT,size:3}]),Ie=new T(W,ne,ue,j,q,H,U,$,X,ae,Q,ie,se,oe,be,ye,ce,de,ge,me,we,Ee,Pe,Ue,ke,Xe,Ve);return Ie.update(Y),Ie}S.exports=K},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(g,S,M){S.exports=h;var e=g("gl-buffer"),a=g("gl-shader"),n=g("./shaders");function r(s,i,x){this.plot=s,this.vbo=i,this.shader=x}var t=r.prototype;t.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},t.drawBox=function(){var s=[0,0],i=[0,0];return function(x,p,v,f,d){var o=this.plot,m=this.shader,l=o.gl;s[0]=x,s[1]=p,i[0]=v,i[1]=f,m.uniforms.lo=s,m.uniforms.hi=i,m.uniforms.color=d,l.drawArrays(l.TRIANGLE_STRIP,0,4)}}(),t.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function h(s){var i=s.gl,x=e(i,[0,0,0,1,1,0,1,1]),p=a(i,n.boxVert,n.lineFrag);return new r(s,x,p)}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(g,S,M){S.exports=i;var e=g("gl-buffer"),a=g("gl-shader"),n=g("binary-search-bounds"),r=g("./shaders");function t(x,p,v,f){this.plot=x,this.vbo=p,this.shader=v,this.tickShader=f,this.ticks=[[],[]]}function h(x,p){return x-p}var s=t.prototype;s.draw=function(){var x=[0,0],p=[0,0],v=[0,0];return function(){for(var f=this.plot,d=this.vbo,o=this.shader,m=this.ticks,l=f.gl,w=f._tickBounds,_=f.dataBox,c=f.viewBox,b=f.gridLineWidth,u=f.gridLineColor,L=f.gridLineEnable,T=f.pixelRatio,k=0;k<2;++k){var P=w[k],z=w[k+2],I=z-P,D=.5*(_[k+2]+_[k]),R=_[k+2]-_[k];p[k]=2*I/R,x[k]=2*(P-D)/R}o.bind(),d.bind(),o.attributes.dataCoord.pointer(),o.uniforms.dataShift=x,o.uniforms.dataScale=p;for(var O=0,k=0;k<2;++k){v[0]=v[1]=0,v[k]=1,o.uniforms.dataAxis=v,o.uniforms.lineWidth=b[k]/(c[k+2]-c[k])*T,o.uniforms.color=u[k];var F=m[k].length*6;L[k]&&F&&l.drawArrays(l.TRIANGLES,O,F),O+=F}}}(),s.drawTickMarks=function(){var x=[0,0],p=[0,0],v=[1,0],f=[0,1],d=[0,0],o=[0,0];return function(){for(var m=this.plot,l=this.vbo,w=this.tickShader,_=this.ticks,c=m.gl,b=m._tickBounds,u=m.dataBox,L=m.viewBox,T=m.pixelRatio,k=m.screenBox,P=k[2]-k[0],z=k[3]-k[1],I=L[2]-L[0],D=L[3]-L[1],R=0;R<2;++R){var O=b[R],F=b[R+2],N=F-O,G=.5*(u[R+2]+u[R]),K=u[R+2]-u[R];p[R]=2*N/K,x[R]=2*(O-G)/K}p[0]*=I/P,x[0]*=I/P,p[1]*=D/z,x[1]*=D/z,w.bind(),l.bind(),w.attributes.dataCoord.pointer();var W=w.uniforms;W.dataShift=x,W.dataScale=p;var Y=m.tickMarkLength,re=m.tickMarkWidth,ue=m.tickMarkColor,j=0,q=_[0].length*6,H=Math.min(n.ge(_[0],(u[0]-b[0])/(b[2]-b[0]),h),_[0].length),U=Math.min(n.gt(_[0],(u[2]-b[0])/(b[2]-b[0]),h),_[0].length),$=j+6*H,ne=6*Math.max(0,U-H),X=Math.min(n.ge(_[1],(u[1]-b[1])/(b[3]-b[1]),h),_[1].length),Q=Math.min(n.gt(_[1],(u[3]-b[1])/(b[3]-b[1]),h),_[1].length),ie=q+6*X,se=6*Math.max(0,Q-X);d[0]=2*(L[0]-Y[1])/P-1,d[1]=(L[3]+L[1])/z-1,o[0]=Y[1]*T/P,o[1]=re[1]*T/z,se&&(W.color=ue[1],W.tickScale=o,W.dataAxis=f,W.screenOffset=d,c.drawArrays(c.TRIANGLES,ie,se)),d[0]=(L[2]+L[0])/P-1,d[1]=2*(L[1]-Y[0])/z-1,o[0]=re[0]*T/P,o[1]=Y[0]*T/z,ne&&(W.color=ue[0],W.tickScale=o,W.dataAxis=v,W.screenOffset=d,c.drawArrays(c.TRIANGLES,$,ne)),d[0]=2*(L[2]+Y[3])/P-1,d[1]=(L[3]+L[1])/z-1,o[0]=Y[3]*T/P,o[1]=re[3]*T/z,se&&(W.color=ue[3],W.tickScale=o,W.dataAxis=f,W.screenOffset=d,c.drawArrays(c.TRIANGLES,ie,se)),d[0]=(L[2]+L[0])/P-1,d[1]=2*(L[3]+Y[2])/z-1,o[0]=re[2]*T/P,o[1]=Y[2]*T/z,ne&&(W.color=ue[2],W.tickScale=o,W.dataAxis=v,W.screenOffset=d,c.drawArrays(c.TRIANGLES,$,ne))}}(),s.update=function(){var x=[1,1,-1,-1,1,-1],p=[1,-1,1,1,-1,-1];return function(v){var f=v.ticks,d=v.bounds,o=new Float32Array(6*3*(f[0].length+f[1].length));this.plot.zeroLineEnable;for(var m=0,l=[[],[]],w=0;w<2;++w)for(var _=l[w],c=f[w],b=d[w],u=d[w+2],L=0;L<c.length;++L){var T=(c[L].x-b)/(u-b);_.push(T);for(var k=0;k<6;++k)o[m++]=T,o[m++]=x[k],o[m++]=p[k]}this.ticks=l,this.vbo.update(o)}}(),s.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()};function i(x){var p=x.gl,v=e(p),f=a(p,r.gridVert,r.gridFrag),d=a(p,r.tickVert,r.gridFrag),o=new t(x,v,f,d);return o}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(g,S,M){S.exports=h;var e=g("gl-buffer"),a=g("gl-shader"),n=g("./shaders");function r(s,i,x){this.plot=s,this.vbo=i,this.shader=x}var t=r.prototype;t.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},t.drawLine=function(){var s=[0,0],i=[0,0];return function(x,p,v,f,d,o){var m=this.plot,l=this.shader,w=m.gl;s[0]=x,s[1]=p,i[0]=v,i[1]=f,l.uniforms.start=s,l.uniforms.end=i,l.uniforms.width=d*m.pixelRatio,l.uniforms.color=o,w.drawArrays(w.TRIANGLE_STRIP,0,4)}}(),t.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function h(s){var i=s.gl,x=e(i,[-1,-1,-1,1,1,-1,1,1]),p=a(i,n.lineVert,n.lineFrag),v=new r(s,x,p);return v}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(g,S,M){var e=g("glslify"),a=e([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);S.exports={lineVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:a,textVert:e([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:a,gridVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:a,boxVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(g,S,M){S.exports=i;var e=g("gl-buffer"),a=g("gl-shader"),n=g("text-cache"),r=g("binary-search-bounds"),t=g("./shaders");function h(x,p,v){this.plot=x,this.vbo=p,this.shader=v,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var s=h.prototype;s.drawTicks=function(){var x=[0,0],p=[0,0],v=[0,0];return function(f){var d=this.plot,o=this.shader,m=this.tickX[f],l=this.tickOffset[f],w=d.gl,_=d.viewBox,c=d.dataBox,b=d.screenBox,u=d.pixelRatio,L=d.tickEnable,T=d.tickPad,k=d.tickColor,P=d.tickAngle,z=d.labelEnable,I=d.labelPad,D=d.labelColor,R=d.labelAngle,O=this.labelOffset[f],F=this.labelCount[f],N=r.lt(m,c[f]),G=r.le(m,c[f+2]);x[0]=x[1]=0,x[f]=1,p[f]=(_[2+f]+_[f])/(b[2+f]-b[f])-1;var K=2/b[2+(f^1)]-b[f^1];p[f^1]=K*_[f^1]-1,L[f]&&(p[f^1]-=K*u*T[f],N<G&&l[G]>l[N]&&(o.uniforms.dataAxis=x,o.uniforms.screenOffset=p,o.uniforms.color=k[f],o.uniforms.angle=P[f],w.drawArrays(w.TRIANGLES,l[N],l[G]-l[N]))),z[f]&&F&&(p[f^1]-=K*u*I[f],o.uniforms.dataAxis=v,o.uniforms.screenOffset=p,o.uniforms.color=D[f],o.uniforms.angle=R[f],w.drawArrays(w.TRIANGLES,O,F)),p[f^1]=K*_[2+(f^1)]-1,L[f+2]&&(p[f^1]+=K*u*T[f+2],N<G&&l[G]>l[N]&&(o.uniforms.dataAxis=x,o.uniforms.screenOffset=p,o.uniforms.color=k[f+2],o.uniforms.angle=P[f+2],w.drawArrays(w.TRIANGLES,l[N],l[G]-l[N]))),z[f+2]&&F&&(p[f^1]+=K*u*I[f+2],o.uniforms.dataAxis=v,o.uniforms.screenOffset=p,o.uniforms.color=D[f+2],o.uniforms.angle=R[f+2],w.drawArrays(w.TRIANGLES,O,F))}}(),s.drawTitle=function(){var x=[0,0],p=[0,0];return function(){var v=this.plot,f=this.shader,d=v.gl,o=v.screenBox,m=v.titleCenter,l=v.titleAngle,w=v.titleColor,_=v.pixelRatio;if(this.titleCount){for(var c=0;c<2;++c)p[c]=2*(m[c]*_-o[c])/(o[2+c]-o[c])-1;f.bind(),f.uniforms.dataAxis=x,f.uniforms.screenOffset=p,f.uniforms.angle=l,f.uniforms.color=w,d.drawArrays(d.TRIANGLES,this.titleOffset,this.titleCount)}}}(),s.bind=function(){var x=[0,0],p=[0,0],v=[0,0];return function(){var f=this.plot,d=this.shader,o=f._tickBounds,m=f.dataBox,l=f.screenBox,w=f.viewBox;d.bind();for(var _=0;_<2;++_){var c=o[_],b=o[_+2],u=b-c,L=.5*(m[_+2]+m[_]),T=m[_+2]-m[_],k=w[_],P=w[_+2],z=P-k,I=l[_],D=l[_+2],R=D-I;p[_]=2*u/T*z/R,x[_]=2*(c-L)/T*z/R}v[1]=2*f.pixelRatio/(l[3]-l[1]),v[0]=v[1]*(l[3]-l[1])/(l[2]-l[0]),d.uniforms.dataScale=p,d.uniforms.dataShift=x,d.uniforms.textScale=v,this.vbo.bind(),d.attributes.textCoordinate.pointer()}}(),s.update=function(x){var p=[],v=x.ticks,f=x.bounds,d,o,m,l,w;for(w=0;w<2;++w){var _=[Math.floor(p.length/3)],c=[-1/0],b=v[w];for(d=0;d<b.length;++d){var u=b[d],L=u.x,T=u.text,k=u.font||"sans-serif";l=u.fontSize||12;for(var P=1/(f[w+2]-f[w]),z=f[w],I=T.split(`
`),D=0;D<I.length;D++)for(m=n(k,I[D]).data,o=0;o<m.length;o+=2)p.push(m[o]*l,-m[o+1]*l-D*l*1.2,(L-z)*P);_.push(Math.floor(p.length/3)),c.push(L)}this.tickOffset[w]=_,this.tickX[w]=c}for(w=0;w<2;++w){for(this.labelOffset[w]=Math.floor(p.length/3),m=n(x.labelFont[w],x.labels[w],{textAlign:"center"}).data,l=x.labelSize[w],d=0;d<m.length;d+=2)p.push(m[d]*l,-m[d+1]*l,0);this.labelCount[w]=Math.floor(p.length/3)-this.labelOffset[w]}for(this.titleOffset=Math.floor(p.length/3),m=n(x.titleFont,x.title).data,l=x.titleSize,d=0;d<m.length;d+=2)p.push(m[d]*l,-m[d+1]*l,0);this.titleCount=Math.floor(p.length/3)-this.titleOffset,this.vbo.update(p)},s.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function i(x){var p=x.gl,v=e(p),f=a(p,t.textVert,t.textFrag),d=new h(x,v,f);return d}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(g,S,M){S.exports=p;var e=g("gl-select-static"),a=g("./lib/grid"),n=g("./lib/text"),r=g("./lib/line"),t=g("./lib/box");function h(v,f){this.gl=v,this.pickBuffer=f,this.screenBox=[0,0,v.drawingBufferWidth,v.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var s=h.prototype;s.setDirty=function(){this.dirty=this.pickDirty=!0},s.setOverlayDirty=function(){this.dirty=!0},s.nextDepthValue=function(){return this._depthCounter++/65536},s.draw=function(){return function(){var v=this.gl,f=this.screenBox,d=this.viewBox,o=this.dataBox,m=this.pixelRatio,l=this.grid,w=this.line,_=this.text,c=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,v.bindFramebuffer(v.FRAMEBUFFER,null),v.enable(v.SCISSOR_TEST),v.disable(v.DEPTH_TEST),v.depthFunc(v.LESS),v.depthMask(!1),v.enable(v.BLEND),v.blendEquation(v.FUNC_ADD,v.FUNC_ADD),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),this.borderColor){v.scissor(f[0],f[1],f[2]-f[0],f[3]-f[1]);var b=this.borderColor;v.clearColor(b[0]*b[3],b[1]*b[3],b[2]*b[3],b[3]),v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT)}v.scissor(d[0],d[1],d[2]-d[0],d[3]-d[1]),v.viewport(d[0],d[1],d[2]-d[0],d[3]-d[1]);var u=this.backgroundColor;v.clearColor(u[0]*u[3],u[1]*u[3],u[2]*u[3],u[3]),v.clear(v.COLOR_BUFFER_BIT),l.draw();var L=this.zeroLineEnable,T=this.zeroLineColor,k=this.zeroLineWidth;if(L[0]||L[1]){w.bind();for(var P=0;P<2;++P)if(!(!L[P]||!(o[P]<=0&&o[P+2]>=0))){var z=f[P]-o[P]*(f[P+2]-f[P])/(o[P+2]-o[P]);P===0?w.drawLine(z,f[1],z,f[3],k[P],T[P]):w.drawLine(f[0],z,f[2],z,k[P],T[P])}}for(var P=0;P<c.length;++P)c[P].draw();v.viewport(f[0],f[1],f[2]-f[0],f[3]-f[1]),v.scissor(f[0],f[1],f[2]-f[0],f[3]-f[1]),this.grid.drawTickMarks(),w.bind();var I=this.borderLineEnable,D=this.borderLineWidth,R=this.borderLineColor;I[1]&&w.drawLine(d[0],d[1]-.5*D[1]*m,d[0],d[3]+.5*D[3]*m,D[1],R[1]),I[0]&&w.drawLine(d[0]-.5*D[0]*m,d[1],d[2]+.5*D[2]*m,d[1],D[0],R[0]),I[3]&&w.drawLine(d[2],d[1]-.5*D[1]*m,d[2],d[3]+.5*D[3]*m,D[3],R[3]),I[2]&&w.drawLine(d[0]-.5*D[0]*m,d[3],d[2]+.5*D[2]*m,d[3],D[2],R[2]),_.bind();for(var P=0;P<2;++P)_.drawTicks(P);this.titleEnable&&_.drawTitle();for(var O=this.overlays,P=0;P<O.length;++P)O[P].draw();v.disable(v.SCISSOR_TEST),v.disable(v.BLEND),v.depthMask(!0)}}}(),s.drawPick=function(){return function(){if(!this.static){var v=this.pickBuffer;this.gl,this._pickTimeout=null,v.begin();for(var f=1,d=this.objects,o=0;o<d.length;++o)f=d[o].drawPick(f);v.end()}}}(),s.pick=function(){return function(v,f){if(!this.static){var d=this.pixelRatio,o=this.pickPixelRatio,m=this.viewBox,l=Math.round((v-m[0]/d)*o)|0,w=Math.round((f-m[1]/d)*o)|0,_=this.pickBuffer.query(l,w,this.pickRadius);if(!_)return null;for(var c=_.id+(_.value[0]<<8)+(_.value[1]<<16)+(_.value[2]<<24),b=this.objects,u=0;u<b.length;++u){var L=b[u].pick(l,w,c);if(L)return L}return null}}}();function i(v){for(var f=v.slice(),d=0;d<f.length;++d)f[d]=f[d].slice();return f}function x(v,f){return v.x-f.x}s.setScreenBox=function(v){var f=this.screenBox,d=this.pixelRatio;f[0]=Math.round(v[0]*d)|0,f[1]=Math.round(v[1]*d)|0,f[2]=Math.round(v[2]*d)|0,f[3]=Math.round(v[3]*d)|0,this.setDirty()},s.setDataBox=function(v){var f=this.dataBox,d=f[0]!==v[0]||f[1]!==v[1]||f[2]!==v[2]||f[3]!==v[3];d&&(f[0]=v[0],f[1]=v[1],f[2]=v[2],f[3]=v[3],this.setDirty())},s.setViewBox=function(v){var f=this.pixelRatio,d=this.viewBox;d[0]=Math.round(v[0]*f)|0,d[1]=Math.round(v[1]*f)|0,d[2]=Math.round(v[2]*f)|0,d[3]=Math.round(v[3]*f)|0;var o=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((v[2]-v[0])*o)|0,Math.round((v[3]-v[1])*o)|0],this.setDirty()},s.update=function(v){v=v||{};var f=this.gl;this.pixelRatio=v.pixelRatio||1;var d=this.pixelRatio;this.pickPixelRatio=Math.max(d,1),this.setScreenBox(v.screenBox||[0,0,f.drawingBufferWidth/d,f.drawingBufferHeight/d]),this.screenBox,this.setViewBox(v.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/d,.125*(this.screenBox[3]-this.screenBox[1])/d,.875*(this.screenBox[2]-this.screenBox[0])/d,.875*(this.screenBox[3]-this.screenBox[1])/d]);var o=this.viewBox,m=(o[2]-o[0])/(o[3]-o[1]);this.setDataBox(v.dataBox||[-10,-10/m,10,10/m]),this.borderColor=v.borderColor!==!1?(v.borderColor||[0,0,0,0]).slice():!1,this.backgroundColor=(v.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(v.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(v.gridLineWidth||[1,1]).slice(),this.gridLineColor=i(v.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(v.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(v.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=i(v.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(v.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(v.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=i(v.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(v.titleCenter||[.5*(o[0]+o[2])/d,(o[3]+120)/d]).slice(),this.titleEnable=!("titleEnable"in v)||!!v.titleEnable,this.titleAngle=v.titleAngle||0,this.titleColor=(v.titleColor||[0,0,0,1]).slice(),this.labelPad=(v.labelPad||[15,15,15,15]).slice(),this.labelAngle=(v.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(v.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=i(v.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(v.tickPad||[15,15,15,15]).slice(),this.tickAngle=(v.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(v.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=i(v.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(v.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(v.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=i(v.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var l=v.ticks||[[],[]],w=this._tickBounds;w[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(var _=0;_<2;++_){var c=l[_].slice(0);c.length!==0&&(c.sort(x),w[_]=Math.min(w[_],c[0].x),w[_+2]=Math.max(w[_+2],c[c.length-1].x))}this.grid.update({bounds:w,ticks:l}),this.text.update({bounds:w,ticks:l,labels:v.labels||["x","y"],labelSize:v.labelSize||[12,12],labelFont:v.labelFont||["sans-serif","sans-serif"],title:v.title||"",titleSize:v.titleSize||18,titleFont:v.titleFont||"sans-serif"}),this.static=!!v.static,this.setDirty()},s.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var v=this.objects.length-1;v>=0;--v)this.objects[v].dispose();this.objects.length=0;for(var v=this.overlays.length-1;v>=0;--v)this.overlays[v].dispose();this.overlays.length=0,this.gl=null},s.addObject=function(v){this.objects.indexOf(v)<0&&(this.objects.push(v),this.setDirty())},s.removeObject=function(v){for(var f=this.objects,d=0;d<f.length;++d)if(f[d]===v){f.splice(d,1),this.setDirty();break}},s.addOverlay=function(v){this.overlays.indexOf(v)<0&&(this.overlays.push(v),this.setOverlayDirty())},s.removeOverlay=function(v){for(var f=this.overlays,d=0;d<f.length;++d)if(f[d]===v){f.splice(d,1),this.setOverlayDirty();break}};function p(v){var f=v.gl,d=e(f,[f.drawingBufferWidth,f.drawingBufferHeight]),o=new h(f,d);return o.grid=a(o),o.text=n(o),o.line=r(o),o.box=t(o),o.update(v),o}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(g,S,M){S.exports=s;var e=g("right-now"),a=g("3d-view"),n=g("mouse-change"),r=g("mouse-wheel"),t=g("mouse-event-offset"),h=g("has-passive-events");function s(i,x){i=i||document.body,x=x||{};var p=[.01,1/0];"distanceLimits"in x&&(p[0]=x.distanceLimits[0],p[1]=x.distanceLimits[1]),"zoomMin"in x&&(p[0]=x.zoomMin),"zoomMax"in x&&(p[1]=x.zoomMax);var v=a({center:x.center||[0,0,0],up:x.up||[0,1,0],eye:x.eye||[0,0,10],mode:x.mode||"orbit",distanceLimits:p}),f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=0,o=i.clientWidth,m=i.clientHeight,l={keyBindingMode:"rotate",enableWheel:!0,view:v,element:i,delay:x.delay||16,rotateSpeed:x.rotateSpeed||1,zoomSpeed:x.zoomSpeed||1,translateSpeed:x.translateSpeed||1,flipX:!!x.flipX,flipY:!!x.flipY,modes:v.modes,_ortho:x._ortho||x.projection&&x.projection.type==="orthographic"||!1,tick:function(){var w=e(),_=this.delay,c=w-2*_;v.idle(w-_),v.recalcMatrix(c),v.flush(w-(100+_*2));for(var b=!0,u=v.computedMatrix,L=0;L<16;++L)b=b&&f[L]===u[L],f[L]=u[L];var T=i.clientWidth===o&&i.clientHeight===m;return o=i.clientWidth,m=i.clientHeight,b?!T:(d=Math.exp(v.computedRadius[0]),!0)},lookAt:function(w,_,c){v.lookAt(v.lastT(),w,_,c)},rotate:function(w,_,c){v.rotate(v.lastT(),w,_,c)},pan:function(w,_,c){v.pan(v.lastT(),w,_,c)},translate:function(w,_,c){v.translate(v.lastT(),w,_,c)}};return Object.defineProperties(l,{matrix:{get:function(){return v.computedMatrix},set:function(w){return v.setMatrix(v.lastT(),w),v.computedMatrix},enumerable:!0},mode:{get:function(){return v.getMode()},set:function(w){var _=v.computedUp.slice(),c=v.computedEye.slice(),b=v.computedCenter.slice();if(v.setMode(w),w==="turntable"){var u=e();v._active.lookAt(u,c,b,_),v._active.lookAt(u+500,c,b,[0,0,1]),v._active.flush(u)}return v.getMode()},enumerable:!0},center:{get:function(){return v.computedCenter},set:function(w){return v.lookAt(v.lastT(),null,w),v.computedCenter},enumerable:!0},eye:{get:function(){return v.computedEye},set:function(w){return v.lookAt(v.lastT(),w),v.computedEye},enumerable:!0},up:{get:function(){return v.computedUp},set:function(w){return v.lookAt(v.lastT(),null,null,w),v.computedUp},enumerable:!0},distance:{get:function(){return d},set:function(w){return v.setDistance(v.lastT(),w),w},enumerable:!0},distanceLimits:{get:function(){return v.getDistanceLimits(p)},set:function(w){return v.setDistanceLimits(w),w},enumerable:!0}}),i.addEventListener("contextmenu",function(w){return w.preventDefault(),!1}),l._lastX=-1,l._lastY=-1,l._lastMods={shift:!1,control:!1,alt:!1,meta:!1},l.enableMouseListeners=function(){l.mouseListener=n(i,w),i.addEventListener("touchstart",function(_){var c=t(_.changedTouches[0],i);w(0,c[0],c[1],l._lastMods),w(1,c[0],c[1],l._lastMods)},h?{passive:!0}:!1),i.addEventListener("touchmove",function(_){var c=t(_.changedTouches[0],i);w(1,c[0],c[1],l._lastMods),_.preventDefault()},h?{passive:!1}:!1),i.addEventListener("touchend",function(_){w(0,l._lastX,l._lastY,l._lastMods)},h?{passive:!0}:!1);function w(_,c,b,u){var L=l.keyBindingMode;if(L!==!1){var T=L==="rotate",k=L==="pan",P=L==="zoom",z=!!u.control,I=!!u.alt,D=!!u.shift,R=!!(_&1),O=!!(_&2),F=!!(_&4),N=1/i.clientHeight,G=N*(c-l._lastX),K=N*(b-l._lastY),W=l.flipX?1:-1,Y=l.flipY?1:-1,re=Math.PI*l.rotateSpeed,ue=e();if(l._lastX!==-1&&l._lastY!==-1&&((T&&R&&!z&&!I&&!D||R&&!z&&!I&&D)&&v.rotate(ue,W*re*G,-Y*re*K,0),(k&&R&&!z&&!I&&!D||O||R&&z&&!I&&!D)&&v.pan(ue,-l.translateSpeed*G*d,l.translateSpeed*K*d,0),P&&R&&!z&&!I&&!D||F||R&&!z&&I&&!D)){var j=-l.zoomSpeed*K/window.innerHeight*(ue-v.lastT())*100;v.pan(ue,0,0,d*(Math.exp(j)-1))}return l._lastX=c,l._lastY=b,l._lastMods=u,!0}}l.wheelListener=r(i,function(_,c){if(l.keyBindingMode!==!1&&l.enableWheel){var b=l.flipX?1:-1,u=l.flipY?1:-1,L=e();if(Math.abs(_)>Math.abs(c))v.rotate(L,0,0,-_*b*Math.PI*l.rotateSpeed/window.innerWidth);else if(!l._ortho){var T=-l.zoomSpeed*u*c/window.innerHeight*(L-v.lastT())/20;v.pan(L,0,0,d*(Math.exp(T)-1))}}},!0)},l.enableMouseListeners(),l}},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),r=e([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(g,S,M){var e=g("./camera.js"),a=g("gl-axes3d"),n=g("gl-axes3d/properties"),r=g("gl-spikes3d"),t=g("gl-select-static"),h=g("gl-fbo"),s=g("a-big-triangle"),i=g("mouse-change"),x=g("gl-mat4/perspective"),p=g("gl-mat4/ortho"),v=g("./lib/shader"),f=g("is-mobile")({tablet:!0,featureDetect:!0});S.exports={createScene:w,createCamera:e};function d(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function o(c,b){var u=null;try{u=c.getContext("webgl",b),u||(u=c.getContext("experimental-webgl",b))}catch{return null}return u}function m(c){var b=Math.round(Math.log(Math.abs(c))/Math.log(10));if(b<0){var u=Math.round(Math.pow(10,-b));return Math.ceil(c*u)/u}else if(b>0){var u=Math.round(Math.pow(10,b));return Math.ceil(c/u)*u}return Math.ceil(c)}function l(c){return typeof c=="boolean"?c:!0}function w(c){c=c||{},c.camera=c.camera||{};var b=c.canvas;if(!b)if(b=document.createElement("canvas"),c.container){var u=c.container;u.appendChild(b)}else document.body.appendChild(b);var L=c.gl;if(L||(c.glOptions&&(f=!!c.glOptions.preserveDrawingBuffer),L=o(b,c.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:f})),!L)throw new Error("webgl not supported");var T=c.bounds||[[-10,-10,-10],[10,10,10]],k=new d,P=h(L,L.drawingBufferWidth,L.drawingBufferHeight,{preferFloat:!f}),z=v(L),I=c.cameraObject&&c.cameraObject._ortho===!0||c.camera.projection&&c.camera.projection.type==="orthographic"||!1,D={eye:c.camera.eye||[2,0,0],center:c.camera.center||[0,0,0],up:c.camera.up||[0,1,0],zoomMin:c.camera.zoomMax||.1,zoomMax:c.camera.zoomMin||100,mode:c.camera.mode||"turntable",_ortho:I},R=c.axes||{},O=a(L,R);O.enable=!R.disable;var F=c.spikes||{},N=r(L,F),G=[],K=[],W=[],Y=[],re=!0,H=!0,ue=new Array(16),j=new Array(16),q={view:null,projection:ue,model:j,_ortho:!1},H=!0,U=[L.drawingBufferWidth,L.drawingBufferHeight],$=c.cameraObject||e(b,D),ne={gl:L,contextLost:!1,pixelRatio:c.pixelRatio||1,canvas:b,selection:k,camera:$,axes:O,axesPixels:null,spikes:N,bounds:T,objects:G,shape:U,aspect:c.aspectRatio||[1,1,1],pickRadius:c.pickRadius||10,zNear:c.zNear||.01,zFar:c.zFar||1e3,fovy:c.fovy||Math.PI/4,clearColor:c.clearColor||[0,0,0,0],autoResize:l(c.autoResize),autoBounds:l(c.autoBounds),autoScale:!!c.autoScale,autoCenter:l(c.autoCenter),clipToBounds:l(c.clipToBounds),snapToData:!!c.snapToData,onselect:c.onselect||null,onrender:c.onrender||null,onclick:c.onclick||null,cameraParams:q,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ye){this.aspect[0]=ye.x,this.aspect[1]=ye.y,this.aspect[2]=ye.z,H=!0},setBounds:function(ye,ge){this.bounds[0][ye]=ge.min,this.bounds[1][ye]=ge.max},setClearColor:function(ye){this.clearColor=ye},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},X=[L.drawingBufferWidth/ne.pixelRatio|0,L.drawingBufferHeight/ne.pixelRatio|0];function Q(){if(!ne._stopped&&ne.autoResize){var ye=b.parentNode,ge=1,me=1;ye&&ye!==document.body?(ge=ye.clientWidth,me=ye.clientHeight):(ge=window.innerWidth,me=window.innerHeight);var Ee=Math.ceil(ge*ne.pixelRatio)|0,Pe=Math.ceil(me*ne.pixelRatio)|0;if(Ee!==b.width||Pe!==b.height){b.width=Ee,b.height=Pe;var Ue=b.style;Ue.position=Ue.position||"absolute",Ue.left="0px",Ue.top="0px",Ue.width=ge+"px",Ue.height=me+"px",re=!0}}}ne.autoResize&&Q(),window.addEventListener("resize",Q);function ie(){for(var ye=G.length,ge=Y.length,me=0;me<ge;++me)W[me]=0;e:for(var me=0;me<ye;++me){var Ee=G[me],Pe=Ee.pickSlots;if(!Pe){K[me]=-1;continue}for(var Ue=0;Ue<ge;++Ue)if(W[Ue]+Pe<255){K[me]=Ue,Ee.setPickBase(W[Ue]+1),W[Ue]+=Pe;continue e}var we=t(L,U);K[me]=ge,Y.push(we),W.push(Pe),Ee.setPickBase(1),ge+=1}for(;ge>0&&W[ge-1]===0;)W.pop(),Y.pop().dispose()}ne.update=function(ye){ne._stopped||(re=!0,H=!0)},ne.add=function(ye){ne._stopped||(ye.axes=O,G.push(ye),K.push(-1),re=!0,H=!0,ie())},ne.remove=function(ye){if(!ne._stopped){var ge=G.indexOf(ye);ge<0||(G.splice(ge,1),K.pop(),re=!0,H=!0,ie())}},ne.dispose=function(){if(!ne._stopped&&(ne._stopped=!0,window.removeEventListener("resize",Q),b.removeEventListener("webglcontextlost",se),ne.mouseListener.enabled=!1,!ne.contextLost)){O.dispose(),N.dispose();for(var ye=0;ye<G.length;++ye)G[ye].dispose();P.dispose();for(var ye=0;ye<Y.length;++ye)Y[ye].dispose();z.dispose(),L=null,O=null,N=null,G=[]}},ne._mouseRotating=!1,ne._prevButtons=0,ne.enableMouseListeners=function(){ne.mouseListener=i(b,function(ye,ge,me){if(!ne._stopped){var Ee=Y.length,Pe=G.length,Ue=k.object;k.distance=1/0,k.mouse[0]=ge,k.mouse[1]=me,k.object=null,k.screen=null,k.dataCoordinate=k.dataPosition=null;var we=!1;if(ye&&ne._prevButtons)ne._mouseRotating=!0;else{ne._mouseRotating&&(H=!0),ne._mouseRotating=!1;for(var ke=0;ke<Ee;++ke){var Xe=Y[ke].query(ge,X[1]-me-1,ne.pickRadius);if(Xe){if(Xe.distance>k.distance)continue;for(var Ve=0;Ve<Pe;++Ve){var Ie=G[Ve];if(K[Ve]===ke){var De=Ie.pick(Xe);De&&(k.buttons=ye,k.screen=Xe.coord,k.distance=Xe.distance,k.object=Ie,k.index=De.distance,k.dataPosition=De.position,k.dataCoordinate=De.dataCoordinate,k.data=De,we=!0)}}}}}Ue&&Ue!==k.object&&(Ue.highlight&&Ue.highlight(null),re=!0),k.object&&(k.object.highlight&&k.object.highlight(k.data),re=!0),we=we||k.object!==Ue,we&&ne.onselect&&ne.onselect(k),ye&1&&!(ne._prevButtons&1)&&ne.onclick&&ne.onclick(k),ne._prevButtons=ye}})};function se(){if(ne.contextLost)return!0;L.isContextLost()&&(ne.contextLost=!0,ne.mouseListener.enabled=!1,ne.selection.object=null,ne.oncontextloss&&ne.oncontextloss())}b.addEventListener("webglcontextlost",se);function ae(){if(!se()){L.colorMask(!0,!0,!0,!0),L.depthMask(!0),L.disable(L.BLEND),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL);for(var ye=G.length,ge=Y.length,me=0;me<ge;++me){var Ee=Y[me];Ee.shape=X,Ee.begin();for(var Pe=0;Pe<ye;++Pe)if(K[Pe]===me){var Ue=G[Pe];Ue.drawPick&&(Ue.pixelRatio=1,Ue.drawPick(q))}Ee.end()}}}var oe=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],be=[oe[0].slice(),oe[1].slice()];function ce(){if(!se()){Q();var ye=ne.camera.tick();q.view=ne.camera.matrix,re=re||ye,H=H||ye,O.pixelRatio=ne.pixelRatio,N.pixelRatio=ne.pixelRatio;var ge=G.length,me=oe[0],Ee=oe[1];me[0]=me[1]=me[2]=1/0,Ee[0]=Ee[1]=Ee[2]=-1/0;for(var Pe=0;Pe<ge;++Pe){var Ue=G[Pe];Ue.pixelRatio=ne.pixelRatio,Ue.axes=ne.axes,re=re||!!Ue.dirty,H=H||!!Ue.dirty;var we=Ue.bounds;if(we)for(var ke=we[0],Xe=we[1],Ve=0;Ve<3;++Ve)me[Ve]=Math.min(me[Ve],ke[Ve]),Ee[Ve]=Math.max(Ee[Ve],Xe[Ve])}var Ie=ne.bounds;if(ne.autoBounds)for(var Ve=0;Ve<3;++Ve){if(Ee[Ve]<me[Ve])me[Ve]=-1,Ee[Ve]=1;else{me[Ve]===Ee[Ve]&&(me[Ve]-=1,Ee[Ve]+=1);var De=.05*(Ee[Ve]-me[Ve]);me[Ve]=me[Ve]-De,Ee[Ve]=Ee[Ve]+De}Ie[0][Ve]=me[Ve],Ie[1][Ve]=Ee[Ve]}for(var Ye=!1,Ve=0;Ve<3;++Ve)Ye=Ye||be[0][Ve]!==Ie[0][Ve]||be[1][Ve]!==Ie[1][Ve],be[0][Ve]=Ie[0][Ve],be[1][Ve]=Ie[1][Ve];if(H=H||Ye,re=re||Ye,!!re){if(Ye){for(var vt=[0,0,0],Pe=0;Pe<3;++Pe)vt[Pe]=m((Ie[1][Pe]-Ie[0][Pe])/10);O.autoTicks?O.update({bounds:Ie,tickSpacing:vt}):O.update({bounds:Ie})}var Dt=L.drawingBufferWidth,Kt=L.drawingBufferHeight;U[0]=Dt,U[1]=Kt,X[0]=Math.max(Dt/ne.pixelRatio,1)|0,X[1]=Math.max(Kt/ne.pixelRatio,1)|0,_(ne,I);for(var Pe=0;Pe<ge;++Pe){var Ue=G[Pe];Ue.axesBounds=Ie,ne.clipToBounds&&(Ue.clipBounds=Ie)}k.object&&(ne.snapToData?N.position=k.dataCoordinate:N.position=k.dataPosition,N.bounds=Ie),H&&(H=!1,ae()),ne.axesPixels=n(ne.axes,q,Dt,Kt),ne.onrender&&ne.onrender(),L.bindFramebuffer(L.FRAMEBUFFER,null),L.viewport(0,0,Dt,Kt),ne.clearRGBA(),L.depthMask(!0),L.colorMask(!0,!0,!0,!0),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL),L.disable(L.BLEND),L.disable(L.CULL_FACE);var Ft=!1;O.enable&&(Ft=Ft||O.isTransparent(),O.draw(q)),N.axes=O,k.object&&N.draw(q),L.disable(L.CULL_FACE);for(var Pe=0;Pe<ge;++Pe){var Ue=G[Pe];Ue.axes=O,Ue.pixelRatio=ne.pixelRatio,Ue.isOpaque&&Ue.isOpaque()&&Ue.draw(q),Ue.isTransparent&&Ue.isTransparent()&&(Ft=!0)}if(Ft){P.shape=U,P.bind(),L.clear(L.DEPTH_BUFFER_BIT),L.colorMask(!1,!1,!1,!1),L.depthMask(!0),L.depthFunc(L.LESS),O.enable&&O.isTransparent()&&O.drawTransparent(q);for(var Pe=0;Pe<ge;++Pe){var Ue=G[Pe];Ue.isOpaque&&Ue.isOpaque()&&Ue.draw(q)}L.enable(L.BLEND),L.blendEquation(L.FUNC_ADD),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.colorMask(!0,!0,!0,!0),L.depthMask(!1),L.clearColor(0,0,0,0),L.clear(L.COLOR_BUFFER_BIT),O.isTransparent()&&O.drawTransparent(q);for(var Pe=0;Pe<ge;++Pe){var Ue=G[Pe];Ue.isTransparent&&Ue.isTransparent()&&Ue.drawTransparent(q)}L.bindFramebuffer(L.FRAMEBUFFER,null),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.disable(L.DEPTH_TEST),z.bind(),P.color[0].bind(0),z.uniforms.accumBuffer=0,s(L),L.disable(L.BLEND)}re=!1;for(var Pe=0;Pe<ge;++Pe)G[Pe].dirty=!1}}}function de(){ne._stopped||ne.contextLost||(ce(),requestAnimationFrame(de))}return ne.enableMouseListeners(),de(),ne.redraw=function(){ne._stopped||(re=!0,ce())},ne}function _(c,b){var u=c.bounds,L=c.cameraParams,T=L.projection,k=L.model,P=c.gl.drawingBufferWidth,z=c.gl.drawingBufferHeight,I=c.zNear,D=c.zFar,R=c.fovy,O=P/z;b?(p(T,-O,O,-1,1,I,D),L._ortho=!0):(x(T,R,O,I,D),L._ortho=!1);for(var F=0;F<16;++F)k[F]=0;k[15]=1;for(var N=0,F=0;F<3;++F)N=Math.max(N,u[1][F]-u[0][F]);for(var F=0;F<3;++F)c.autoScale?k[5*F]=c.aspect[F]/(u[1][F]-u[0][F]):k[5*F]=1/N,c.autoCenter&&(k[12+F]=-k[5*F]*.5*(u[0][F]+u[1][F]))}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(g,S,M){var e=g("glslify");M.pointVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),M.pointFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),M.pickVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),M.pickFragment=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(g,S,M){var e=g("gl-shader"),a=g("gl-buffer"),n=g("typedarray-pool"),r=g("./lib/shader");S.exports=i;function t(x,p,v,f,d){this.plot=x,this.offsetBuffer=p,this.pickBuffer=v,this.shader=f,this.pickShader=d,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}var h=t.prototype;h.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},h.update=function(x){var p;x=x||{};function v(_,c){return _ in x?x[_]:c}this.sizeMin=v("sizeMin",.5),this.sizeMax=v("sizeMax",20),this.color=v("color",[1,0,0,1]).slice(),this.areaRatio=v("areaRatio",1),this.borderColor=v("borderColor",[0,0,0,1]).slice(),this.blend=v("blend",!1);var f=x.positions.length>>>1,d=x.positions instanceof Float32Array,o=x.idToIndex instanceof Int32Array&&x.idToIndex.length>=f,m=x.positions,l=d?m:n.mallocFloat32(m.length),w=o?x.idToIndex:n.mallocInt32(f);if(d||l.set(m),!o)for(l.set(m),p=0;p<f;p++)w[p]=p;this.points=m,this.offsetBuffer.update(l),this.pickBuffer.update(w),d||n.free(l),o||n.free(w),this.pointCount=f,this.pickOffset=0};function s(x,p){var v=0,f=x.length>>>1,d;for(d=0;d<f;d++){var o=x[d*2],m=x[d*2+1];o>=p[0]&&o<=p[2]&&m>=p[1]&&m<=p[3]&&v++}return v}h.unifiedDraw=function(){var x=[1,0,0,0,1,0,0,0,1],p=[0,0,0,0];return function(v){var f=v!==void 0,d=f?this.pickShader:this.shader,o=this.plot.gl,m=this.plot.dataBox;if(this.pointCount===0)return v;var l=m[2]-m[0],w=m[3]-m[1],_=s(this.points,m),c=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(_,.33333)));x[0]=2/l,x[4]=2/w,x[6]=-2*m[0]/l-1,x[7]=-2*m[1]/w-1,this.offsetBuffer.bind(),d.bind(),d.attributes.position.pointer(),d.uniforms.matrix=x,d.uniforms.color=this.color,d.uniforms.borderColor=this.borderColor,d.uniforms.pointCloud=c<5,d.uniforms.pointSize=c,d.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),f&&(p[0]=v&255,p[1]=v>>8&255,p[2]=v>>16&255,p[3]=v>>24&255,this.pickBuffer.bind(),d.attributes.pickId.pointer(o.UNSIGNED_BYTE),d.uniforms.pickOffset=p,this.pickOffset=v);var b=o.getParameter(o.BLEND),u=o.getParameter(o.DITHER);return b&&!this.blend&&o.disable(o.BLEND),u&&o.disable(o.DITHER),o.drawArrays(o.POINTS,0,this.pointCount),b&&!this.blend&&o.enable(o.BLEND),u&&o.enable(o.DITHER),v+this.pointCount}}(),h.draw=h.unifiedDraw,h.drawPick=h.unifiedDraw,h.pick=function(x,p,v){var f=this.pickOffset,d=this.pointCount;if(v<f||v>=f+d)return null;var o=v-f,m=this.points;return{object:this,pointId:o,dataCoord:[m[2*o],m[2*o+1]]}};function i(x,p){var v=x.gl,f=a(v),d=a(v),o=e(v,r.pointVertex,r.pointFragment),m=e(v,r.pickVertex,r.pickFragment),l=new t(x,f,d,o,m);return l.update(p),x.addObject(l),l}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(g,S,M){S.exports=e;function e(a,n,r,t){var h=n[0],s=n[1],i=n[2],x=n[3],p=r[0],v=r[1],f=r[2],d=r[3],o,m,l,w,_;return m=h*p+s*v+i*f+x*d,m<0&&(m=-m,p=-p,v=-v,f=-f,d=-d),1-m>1e-6?(o=Math.acos(m),l=Math.sin(o),w=Math.sin((1-t)*o)/l,_=Math.sin(t*o)/l):(w=1-t,_=t),a[0]=w*h+_*p,a[1]=w*s+_*v,a[2]=w*i+_*f,a[3]=w*x+_*d,a}},{}],125:[function(g,S,M){S.exports=function(e){return!e&&e!==0?"":e.toString()}},{}],126:[function(g,S,M){var e=g("vectorize-text");S.exports=n;var a={};function n(r,t,h){var s=a[t];if(s||(s=a[t]={}),r in s)return s[r];var i={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}};i.triangles=!0;var x=e(r,i);i.triangles=!1;var p=e(r,i),v,f;if(h&&h!==1){for(v=0;v<x.positions.length;++v)for(f=0;f<x.positions[v].length;++f)x.positions[v][f]/=h;for(v=0;v<p.positions.length;++v)for(f=0;f<p.positions[v].length;++f)p.positions[v][f]/=h}var d=[[1/0,1/0],[-1/0,-1/0]],o=p.positions.length;for(v=0;v<o;++v){var m=p.positions[v];for(f=0;f<2;++f)d[0][f]=Math.min(d[0][f],m[f]),d[1][f]=Math.max(d[1][f],m[f])}return s[r]=[x,p,d]}},{"vectorize-text":311}],127:[function(g,S,M){var e=g("gl-shader"),a=g("glslify"),n=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),t=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),h=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),s=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),i=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],x={vertex:n,fragment:h,attributes:i},p={vertex:r,fragment:h,attributes:i},v={vertex:t,fragment:h,attributes:i},f={vertex:n,fragment:s,attributes:i},d={vertex:r,fragment:s,attributes:i},o={vertex:t,fragment:s,attributes:i};function m(l,w){var _=e(l,w),c=_.attributes;return c.position.location=0,c.color.location=1,c.glyph.location=2,c.id.location=3,_}M.createPerspective=function(l){return m(l,x)},M.createOrtho=function(l){return m(l,p)},M.createProject=function(l){return m(l,v)},M.createPickPerspective=function(l){return m(l,f)},M.createPickOrtho=function(l){return m(l,d)},M.createPickProject=function(l){return m(l,o)}},{"gl-shader":132,glslify:231}],128:[function(g,S,M){var e=g("is-string-blank"),a=g("gl-buffer"),n=g("gl-vao"),r=g("typedarray-pool"),t=g("gl-mat4/multiply"),h=g("./lib/shaders"),s=g("./lib/glyphs"),i=g("./lib/get-simple-string"),x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];S.exports=K;function p(W,Y){var re=W[0],ue=W[1],j=W[2],q=W[3];return W[0]=Y[0]*re+Y[4]*ue+Y[8]*j+Y[12]*q,W[1]=Y[1]*re+Y[5]*ue+Y[9]*j+Y[13]*q,W[2]=Y[2]*re+Y[6]*ue+Y[10]*j+Y[14]*q,W[3]=Y[3]*re+Y[7]*ue+Y[11]*j+Y[15]*q,W}function v(W,Y,re,ue){return p(ue,ue),p(ue,ue),p(ue,ue)}function f(W,Y){this.index=W,this.dataCoordinate=this.position=Y}function d(W){return W===!0||W>1?1:W}function o(W,Y,re,ue,j,q,H,U,$,ne,X,Q){this.gl=W,this.pixelRatio=1,this.shader=Y,this.orthoShader=re,this.projectShader=ue,this.pointBuffer=j,this.colorBuffer=q,this.glyphBuffer=H,this.idBuffer=U,this.vao=$,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=ne,this.pickOrthoShader=X,this.pickProjectShader=Q,this.points=[],this._selectResult=new f(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}var m=o.prototype;m.pickSlots=1,m.setPickBase=function(W){this.pickId=W},m.isTransparent=function(){if(this.hasAlpha)return!0;for(var W=0;W<3;++W)if(this.axesProject[W]&&this.projectHasAlpha)return!0;return!1},m.isOpaque=function(){if(!this.hasAlpha)return!0;for(var W=0;W<3;++W)if(this.axesProject[W]&&!this.projectHasAlpha)return!0;return!1};var l=[0,0],w=[0,0,0],_=[0,0,0],c=[0,0,0,1],b=[0,0,0,1],u=x.slice(),L=[0,0,0],T=[[0,0,0],[0,0,0]];function k(W){return W[0]=W[1]=W[2]=0,W}function P(W,Y){return W[0]=Y[0],W[1]=Y[1],W[2]=Y[2],W[3]=1,W}function z(W,Y,re,ue){return W[0]=Y[0],W[1]=Y[1],W[2]=Y[2],W[re]=ue,W}function I(W){for(var Y=T,re=0;re<2;++re)for(var ue=0;ue<3;++ue)Y[re][ue]=Math.max(Math.min(W[re][ue],1e8),-1e8);return Y}function D(W,Y,re,ue){var j=Y.axesProject,q=Y.gl,H=W.uniforms,U=re.model||x,$=re.view||x,ne=re.projection||x,X=Y.axesBounds,Q=I(Y.clipBounds),ie;Y.axes&&Y.axes.lastCubeProps?ie=Y.axes.lastCubeProps.axis:ie=[1,1,1],l[0]=2/q.drawingBufferWidth,l[1]=2/q.drawingBufferHeight,W.bind(),H.view=$,H.projection=ne,H.screenSize=l,H.highlightId=Y.highlightId,H.highlightScale=Y.highlightScale,H.clipBounds=Q,H.pickGroup=Y.pickId/255,H.pixelRatio=ue;for(var se=0;se<3;++se)if(j[se]){H.scale=Y.projectScale[se],H.opacity=Y.projectOpacity[se];for(var ae=u,oe=0;oe<16;++oe)ae[oe]=0;for(var oe=0;oe<4;++oe)ae[5*oe]=1;ae[5*se]=0,ie[se]<0?ae[12+se]=X[0][se]:ae[12+se]=X[1][se],t(ae,U,ae),H.model=ae;var be=(se+1)%3,ce=(se+2)%3,de=k(w),ye=k(_);de[be]=1,ye[ce]=1;var ge=v(ne,$,U,P(c,de)),me=v(ne,$,U,P(b,ye));if(Math.abs(ge[1])>Math.abs(me[1])){var Ee=ge;ge=me,me=Ee,Ee=de,de=ye,ye=Ee;var Pe=be;be=ce,ce=Pe}ge[0]<0&&(de[be]=-1),me[1]>0&&(ye[ce]=-1);for(var Ue=0,we=0,oe=0;oe<4;++oe)Ue+=Math.pow(U[4*be+oe],2),we+=Math.pow(U[4*ce+oe],2);de[be]/=Math.sqrt(Ue),ye[ce]/=Math.sqrt(we),H.axes[0]=de,H.axes[1]=ye,H.fragClipBounds[0]=z(L,Q[0],se,-1e8),H.fragClipBounds[1]=z(L,Q[1],se,1e8),Y.vao.bind(),Y.vao.draw(q.TRIANGLES,Y.vertexCount),Y.lineWidth>0&&(q.lineWidth(Y.lineWidth*ue),Y.vao.draw(q.LINES,Y.lineVertexCount,Y.vertexCount)),Y.vao.unbind()}}var R=[-1e8,-1e8,-1e8],O=[1e8,1e8,1e8],F=[R,O];function N(W,Y,re,ue,j,q,H){var U=re.gl;if((q===re.projectHasAlpha||H)&&D(Y,re,ue,j),q===re.hasAlpha||H){W.bind();var $=W.uniforms;$.model=ue.model||x,$.view=ue.view||x,$.projection=ue.projection||x,l[0]=2/U.drawingBufferWidth,l[1]=2/U.drawingBufferHeight,$.screenSize=l,$.highlightId=re.highlightId,$.highlightScale=re.highlightScale,$.fragClipBounds=F,$.clipBounds=re.axes.bounds,$.opacity=re.opacity,$.pickGroup=re.pickId/255,$.pixelRatio=j,re.vao.bind(),re.vao.draw(U.TRIANGLES,re.vertexCount),re.lineWidth>0&&(U.lineWidth(re.lineWidth*j),re.vao.draw(U.LINES,re.lineVertexCount,re.vertexCount)),re.vao.unbind()}}m.draw=function(W){var Y=this.useOrtho?this.orthoShader:this.shader;N(Y,this.projectShader,this,W,this.pixelRatio,!1,!1)},m.drawTransparent=function(W){var Y=this.useOrtho?this.orthoShader:this.shader;N(Y,this.projectShader,this,W,this.pixelRatio,!0,!1)},m.drawPick=function(W){var Y=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;N(Y,this.pickProjectShader,this,W,1,!0,!0)},m.pick=function(W){if(!W||W.id!==this.pickId)return null;var Y=W.value[2]+(W.value[1]<<8)+(W.value[0]<<16);if(Y>=this.pointCount||Y<0)return null;var re=this.points[Y],ue=this._selectResult;ue.index=Y;for(var j=0;j<3;++j)ue.position[j]=ue.dataCoordinate[j]=re[j];return ue},m.highlight=function(W){if(!W)this.highlightId=[1,1,1,1];else{var Y=W.index,re=Y&255,ue=Y>>8&255,j=Y>>16&255;this.highlightId=[re/255,ue/255,j/255,0]}};function G(W,Y,re,ue){var j;Array.isArray(W)?Y<W.length?j=W[Y]:j=void 0:j=W,j=i(j);var q=!0;e(j)&&(j="",q=!1);var H=s(j,re,ue);return{mesh:H[0],lines:H[1],bounds:H[2],visible:q}}m.update=function(W){if(W=W||{},"perspective"in W&&(this.useOrtho=!W.perspective),"orthographic"in W&&(this.useOrtho=!!W.orthographic),"lineWidth"in W&&(this.lineWidth=W.lineWidth),"project"in W)if(Array.isArray(W.project))this.axesProject=W.project;else{var Y=!!W.project;this.axesProject=[Y,Y,Y]}if("projectScale"in W)if(Array.isArray(W.projectScale))this.projectScale=W.projectScale.slice();else{var re=+W.projectScale;this.projectScale=[re,re,re]}if(this.projectHasAlpha=!1,"projectOpacity"in W){if(Array.isArray(W.projectOpacity))this.projectOpacity=W.projectOpacity.slice();else{var re=+W.projectOpacity;this.projectOpacity=[re,re,re]}for(var ue=0;ue<3;++ue)this.projectOpacity[ue]=d(this.projectOpacity[ue]),this.projectOpacity[ue]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in W&&(this.opacity=d(W.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var j=W.position,q=W.font||"normal",H=W.alignment||[0,0],U,$;if(H.length===2)U=H[0],$=H[1];else{U=[],$=[];for(var ue=0;ue<H.length;++ue)U[ue]=H[ue][0],$[ue]=H[ue][1]}var ne=[1/0,1/0,1/0],X=[-1/0,-1/0,-1/0],Q=W.glyph,ie=W.color,se=W.size,ae=W.angle,oe=W.lineColor,be=-1,ce=0,de=0,ye=0;if(j.length){ye=j.length;e:for(var ue=0;ue<ye;++ue){for(var ge=j[ue],me=0;me<3;++me)if(isNaN(ge[me])||!isFinite(ge[me]))continue e;var Ee=G(Q,ue,q,this.pixelRatio),Pe=Ee.mesh,Ue=Ee.lines,we=Ee.bounds;ce+=Pe.cells.length*3,de+=Ue.edges.length*2}}var ke=ce+de,Xe=r.mallocFloat(3*ke),Ve=r.mallocFloat(4*ke),Ie=r.mallocFloat(2*ke),De=r.mallocUint32(ke);if(ke>0){var Ye=0,vt=ce,Dt=[0,0,0,1],Kt=[0,0,0,1],Ft=Array.isArray(ie)&&Array.isArray(ie[0]),Mt=Array.isArray(oe)&&Array.isArray(oe[0]);e:for(var ue=0;ue<ye;++ue){be+=1;for(var ge=j[ue],me=0;me<3;++me){if(isNaN(ge[me])||!isFinite(ge[me]))continue e;X[me]=Math.max(X[me],ge[me]),ne[me]=Math.min(ne[me],ge[me])}var Ee=G(Q,ue,q,this.pixelRatio),Pe=Ee.mesh,Ue=Ee.lines,we=Ee.bounds,Xt=Ee.visible;if(!Xt)Dt=[1,1,1,0];else if(Array.isArray(ie)){var It;if(Ft?ue<ie.length?It=ie[ue]:It=[0,0,0,0]:It=ie,It.length===3){for(var me=0;me<3;++me)Dt[me]=It[me];Dt[3]=1}else if(It.length===4){for(var me=0;me<4;++me)Dt[me]=It[me];!this.hasAlpha&&It[3]<1&&(this.hasAlpha=!0)}}else Dt[0]=Dt[1]=Dt[2]=0,Dt[3]=1;if(!Xt)Kt=[1,1,1,0];else if(Array.isArray(oe)){var It;if(Mt?ue<oe.length?It=oe[ue]:It=[0,0,0,0]:It=oe,It.length===3){for(var me=0;me<3;++me)Kt[me]=It[me];Kt[me]=1}else if(It.length===4){for(var me=0;me<4;++me)Kt[me]=It[me];!this.hasAlpha&&It[3]<1&&(this.hasAlpha=!0)}}else Kt[0]=Kt[1]=Kt[2]=0,Kt[3]=1;var At=.5;Xt?Array.isArray(se)?ue<se.length?At=+se[ue]:At=12:se?At=+se:this.useOrtho&&(At=12):At=0;var Ge=0;Array.isArray(ae)?ue<ae.length?Ge=+ae[ue]:Ge=0:ae&&(Ge=+ae);for(var tt=Math.cos(Ge),He=Math.sin(Ge),ge=j[ue],me=0;me<3;++me)X[me]=Math.max(X[me],ge[me]),ne[me]=Math.min(ne[me],ge[me]);var Ae=U,Ne=$,Ae=0;Array.isArray(U)?ue<U.length?Ae=U[ue]:Ae=0:U&&(Ae=U);var Ne=0;Array.isArray($)?ue<$.length?Ne=$[ue]:Ne=0:$&&(Ne=$),Ae*=Ae>0?1-we[0][0]:Ae<0?1+we[1][0]:1,Ne*=Ne>0?1-we[0][1]:Ne<0?1+we[1][1]:1;for(var Ze=[Ae,Ne],Ut=Pe.cells||[],Rt=Pe.positions||[],me=0;me<Ut.length;++me)for(var Qe=Ut[me],bt=0;bt<3;++bt){for(var dt=0;dt<3;++dt)Xe[3*Ye+dt]=ge[dt];for(var dt=0;dt<4;++dt)Ve[4*Ye+dt]=Dt[dt];De[Ye]=be;var wt=Rt[Qe[bt]];Ie[2*Ye]=At*(tt*wt[0]-He*wt[1]+Ze[0]),Ie[2*Ye+1]=At*(He*wt[0]+tt*wt[1]+Ze[1]),Ye+=1}for(var Ut=Ue.edges,Rt=Ue.positions,me=0;me<Ut.length;++me)for(var Qe=Ut[me],bt=0;bt<2;++bt){for(var dt=0;dt<3;++dt)Xe[3*vt+dt]=ge[dt];for(var dt=0;dt<4;++dt)Ve[4*vt+dt]=Kt[dt];De[vt]=be;var wt=Rt[Qe[bt]];Ie[2*vt]=At*(tt*wt[0]-He*wt[1]+Ze[0]),Ie[2*vt+1]=At*(He*wt[0]+tt*wt[1]+Ze[1]),vt+=1}}}this.bounds=[ne,X],this.points=j,this.pointCount=j.length,this.vertexCount=ce,this.lineVertexCount=de,this.pointBuffer.update(Xe),this.colorBuffer.update(Ve),this.glyphBuffer.update(Ie),this.idBuffer.update(De),r.free(Xe),r.free(Ve),r.free(Ie),r.free(De)},m.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()};function K(W){var Y=W.gl,re=h.createPerspective(Y),ue=h.createOrtho(Y),j=h.createProject(Y),q=h.createPickPerspective(Y),H=h.createPickOrtho(Y),U=h.createPickProject(Y),$=a(Y),ne=a(Y),X=a(Y),Q=a(Y),ie=n(Y,[{buffer:$,size:3,type:Y.FLOAT},{buffer:ne,size:4,type:Y.FLOAT},{buffer:X,size:2,type:Y.FLOAT},{buffer:Q,size:4,type:Y.UNSIGNED_BYTE,normalized:!0}]),se=new o(Y,re,ue,j,$,ne,X,Q,ie,q,H,U);return se.update(W),se}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(g,S,M){var e=g("glslify");M.boxVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),M.boxFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(g,S,M){var e=g("gl-shader"),a=g("gl-buffer"),n=g("./lib/shaders");S.exports=h;function r(s,i,x){this.plot=s,this.boxBuffer=i,this.boxShader=x,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var t=r.prototype;t.draw=function(){if(this.enabled){var s=this.plot,i=this.selectBox,x=this.borderWidth;this.innerFill;var p=this.innerColor;this.outerFill;var v=this.outerColor,f=this.borderColor,d=s.box,o=s.screenBox,m=s.dataBox,l=s.viewBox,w=s.pixelRatio,_=(i[0]-m[0])*(l[2]-l[0])/(m[2]-m[0])+l[0],c=(i[1]-m[1])*(l[3]-l[1])/(m[3]-m[1])+l[1],b=(i[2]-m[0])*(l[2]-l[0])/(m[2]-m[0])+l[0],u=(i[3]-m[1])*(l[3]-l[1])/(m[3]-m[1])+l[1];if(_=Math.max(_,l[0]),c=Math.max(c,l[1]),b=Math.min(b,l[2]),u=Math.min(u,l[3]),!(b<_||u<c)){d.bind();var L=o[2]-o[0],T=o[3]-o[1];if(this.outerFill&&(d.drawBox(0,0,L,c,v),d.drawBox(0,c,_,u,v),d.drawBox(0,u,L,T,v),d.drawBox(b,c,L,u,v)),this.innerFill&&d.drawBox(_,c,b,u,p),x>0){var k=x*w;d.drawBox(_-k,c-k,b+k,c+k,f),d.drawBox(_-k,u-k,b+k,u+k,f),d.drawBox(_-k,c-k,_+k,u+k,f),d.drawBox(b-k,c-k,b+k,u+k,f)}}}},t.update=function(s){s=s||{},this.innerFill=!!s.innerFill,this.outerFill=!!s.outerFill,this.innerColor=(s.innerColor||[0,0,0,.5]).slice(),this.outerColor=(s.outerColor||[0,0,0,.5]).slice(),this.borderColor=(s.borderColor||[0,0,0,1]).slice(),this.borderWidth=s.borderWidth||0,this.selectBox=(s.selectBox||this.selectBox).slice()},t.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)};function h(s,i){var x=s.gl,p=a(x,[0,0,0,1,1,0,1,1]),v=e(x,n.boxVertex,n.boxFragment),f=new r(s,p,v);return f.update(i),s.addOverlay(f),f}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(g,S,M){S.exports=x;var e=g("gl-fbo"),a=g("typedarray-pool"),n=g("ndarray"),r=g("bit-twiddle").nextPow2,t=function(p,v,f){for(var d=1e8,o=-1,m=-1,l=p.shape[0],w=p.shape[1],_=0;_<l;_++)for(var c=0;c<w;c++){var b=p.get(_,c,0),u=p.get(_,c,1),L=p.get(_,c,2),T=p.get(_,c,3);if(b<255||u<255||L<255||T<255){var k=v-_,P=f-c,z=k*k+P*P;z<d&&(d=z,o=_,m=c)}}return[o,m,d]};function h(p,v,f,d,o){this.coord=[p,v],this.id=f,this.value=d,this.distance=o}function s(p,v,f){this.gl=p,this.fbo=v,this.buffer=f,this._readTimeout=null;var d=this;this._readCallback=function(){d.gl&&(v.bind(),p.readPixels(0,0,v.shape[0],v.shape[1],p.RGBA,p.UNSIGNED_BYTE,d.buffer),d._readTimeout=null)}}var i=s.prototype;Object.defineProperty(i,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(p){if(this.gl){this.fbo.shape=p;var v=this.fbo.shape[0],f=this.fbo.shape[1];if(f*v*4>this.buffer.length){a.free(this.buffer);for(var d=this.buffer=a.mallocUint8(r(f*v*4)),o=0;o<f*v*4;++o)d[o]=255}return p}}}),i.begin=function(){var p=this.gl;this.shape,p&&(this.fbo.bind(),p.clearColor(1,1,1,1),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT))},i.end=function(){var p=this.gl;p&&(p.bindFramebuffer(p.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},i.query=function(p,v,f){if(!this.gl)return null;var d=this.fbo.shape.slice();p=p|0,v=v|0,typeof f!="number"&&(f=1);var o=Math.min(Math.max(p-f,0),d[0])|0,m=Math.min(Math.max(p+f,0),d[0])|0,l=Math.min(Math.max(v-f,0),d[1])|0,w=Math.min(Math.max(v+f,0),d[1])|0;if(m<=o||w<=l)return null;var _=[m-o,w-l],c=n(this.buffer,[_[0],_[1],4],[4,d[0]*4,1],4*(o+d[0]*l)),b=t(c.hi(_[0],_[1],1),f,f),u=b[0],L=b[1];if(u<0||Math.pow(this.radius,2)<b[2])return null;var T=c.get(u,L,0),k=c.get(u,L,1),P=c.get(u,L,2),z=c.get(u,L,3);return new h(u+o|0,L+l|0,T,[k,P,z],Math.sqrt(b[2]))},i.dispose=function(){this.gl&&(this.fbo.dispose(),a.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))};function x(p,v){var f=v[0],d=v[1],o={},m=e(p,f,d,o),l=a.mallocUint8(f*d*4);return new s(p,m,l)}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(g,S,M){var e=g("./lib/create-uniforms"),a=g("./lib/create-attributes"),n=g("./lib/reflect"),r=g("./lib/shader-cache"),t=g("./lib/runtime-reflect"),h=g("./lib/GLError");function s(v){this.gl=v,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var i=s.prototype;i.bind=function(){this.program||this._relink();var v,f=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),d=this.gl.lastAttribCount;if(f>d)for(v=d;v<f;v++)this.gl.enableVertexAttribArray(v);else if(d>f)for(v=f;v<d;v++)this.gl.disableVertexAttribArray(v);this.gl.lastAttribCount=f,this.gl.useProgram(this.program)},i.dispose=function(){for(var v=this.gl.lastAttribCount,f=0;f<v;f++)this.gl.disableVertexAttribArray(f);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function x(v,f){return v.name<f.name?-1:1}i.update=function(v,f,d,o){if(!f||arguments.length===1){var m=v;v=m.vertex,f=m.fragment,d=m.uniforms,o=m.attributes}var l=this,w=l.gl,_=l._vref;l._vref=r.shader(w,w.VERTEX_SHADER,v),_&&_.dispose(),l.vertShader=l._vref.shader;var c=this._fref;if(l._fref=r.shader(w,w.FRAGMENT_SHADER,f),c&&c.dispose(),l.fragShader=l._fref.shader,!d||!o){var b=w.createProgram();if(w.attachShader(b,l.fragShader),w.attachShader(b,l.vertShader),w.linkProgram(b),!w.getProgramParameter(b,w.LINK_STATUS)){var u=w.getProgramInfoLog(b);throw new h(u,"Error linking program:"+u)}d=d||t.uniforms(w,b),o=o||t.attributes(w,b),w.deleteProgram(b)}o=o.slice(),o.sort(x);var L=[],T=[],k=[],P;for(P=0;P<o.length;++P){var z=o[P];if(z.type.indexOf("mat")>=0){for(var I=z.type.charAt(z.type.length-1)|0,D=new Array(I),R=0;R<I;++R)D[R]=k.length,T.push(z.name+"["+R+"]"),typeof z.location=="number"?k.push(z.location+R):Array.isArray(z.location)&&z.location.length===I&&typeof z.location[R]=="number"?k.push(z.location[R]|0):k.push(-1);L.push({name:z.name,type:z.type,locations:D})}else L.push({name:z.name,type:z.type,locations:[k.length]}),T.push(z.name),typeof z.location=="number"?k.push(z.location|0):k.push(-1)}var O=0;for(P=0;P<k.length;++P)if(k[P]<0){for(;k.indexOf(O)>=0;)O+=1;k[P]=O}var F=new Array(d.length);function N(){l.program=r.program(w,l._vref,l._fref,T,k);for(var G=0;G<d.length;++G)F[G]=w.getUniformLocation(l.program,d[G].name)}N(),l._relink=N,l.types={uniforms:n(d),attributes:n(o)},l.attributes=a(w,l,L,k),Object.defineProperty(l,"uniforms",e(w,l,d,F))};function p(v,f,d,o,m){var l=new s(v);return l.update(f,d,o,m),l}S.exports=p},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(g,S,M){function e(a,n,r){this.shortMessage=n||"",this.longMessage=r||"",this.rawError=a||"",this.message="gl-shader: "+(n||a||"")+(r?`
`+r:""),this.stack=new Error().stack}e.prototype=new Error,e.prototype.name="GLError",e.prototype.constructor=e,S.exports=e},{}],134:[function(g,S,M){S.exports=s;var e=g("./GLError");function a(i,x,p,v,f,d){this._gl=i,this._wrapper=x,this._index=p,this._locations=v,this._dimension=f,this._constFunc=d}var n=a.prototype;n.pointer=function(x,p,v,f){var d=this,o=d._gl,m=d._locations[d._index];o.vertexAttribPointer(m,d._dimension,x||o.FLOAT,!!p,v||0,f||0),o.enableVertexAttribArray(m)},n.set=function(i,x,p,v){return this._constFunc(this._locations[this._index],i,x,p,v)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(i){return i!==this._locations[this._index]&&(this._locations[this._index]=i|0,this._wrapper.program=null),i|0}});var r=[function(i,x,p){return p.length===void 0?i.vertexAttrib1f(x,p):i.vertexAttrib1fv(x,p)},function(i,x,p,v){return p.length===void 0?i.vertexAttrib2f(x,p,v):i.vertexAttrib2fv(x,p)},function(i,x,p,v,f){return p.length===void 0?i.vertexAttrib3f(x,p,v,f):i.vertexAttrib3fv(x,p)},function(i,x,p,v,f,d){return p.length===void 0?i.vertexAttrib4f(x,p,v,f,d):i.vertexAttrib4fv(x,p)}];function t(i,x,p,v,f,d,o){var m=r[f],l=new a(i,x,p,v,f,m);Object.defineProperty(d,o,{set:function(w){return i.disableVertexAttribArray(v[p]),m(i,v[p],w),w},get:function(){return l},enumerable:!0})}function h(i,x,p,v,f,d,o){for(var m=new Array(f),l=new Array(f),w=0;w<f;++w)t(i,x,p[w],v,f,m,w),l[w]=m[w];Object.defineProperty(m,"location",{set:function(b){if(Array.isArray(b))for(var u=0;u<f;++u)l[u].location=b[u];else for(var u=0;u<f;++u)l[u].location=b+u;return b},get:function(){for(var b=new Array(f),u=0;u<f;++u)b[u]=v[p[u]];return b},enumerable:!0}),m.pointer=function(b,u,L,T){b=b||i.FLOAT,u=!!u,L=L||f*f,T=T||0;for(var k=0;k<f;++k){var P=v[p[k]];i.vertexAttribPointer(P,f,b,u,L,T+k*f),i.enableVertexAttribArray(P)}};var _=new Array(f),c=i["vertexAttrib"+f+"fv"];Object.defineProperty(d,o,{set:function(b){for(var u=0;u<f;++u){var L=v[p[u]];if(i.disableVertexAttribArray(L),Array.isArray(b[0]))c.call(i,L,b[u]);else{for(var T=0;T<f;++T)_[T]=b[f*u+T];c.call(i,L,_)}}return b},get:function(){return m},enumerable:!0})}function s(i,x,p,v){for(var f={},d=0,o=p.length;d<o;++d){var m=p[d],l=m.name,w=m.type,_=m.locations;switch(w){case"bool":case"int":case"float":t(i,x,_[0],v,1,f,l);break;default:if(w.indexOf("vec")>=0){var c=w.charCodeAt(w.length-1)-48;if(c<2||c>4)throw new e("","Invalid data type for attribute "+l+": "+w);t(i,x,_[0],v,c,f,l)}else if(w.indexOf("mat")>=0){var c=w.charCodeAt(w.length-1)-48;if(c<2||c>4)throw new e("","Invalid data type for attribute "+l+": "+w);h(i,x,_,v,c,f,l)}else throw new e("","Unknown data type for attribute "+l+": "+w);break}}return f}},{"./GLError":133}],135:[function(g,S,M){var e=g("./reflect"),a=g("./GLError");S.exports=t;function n(h){return function(){return h}}function r(h,s){for(var i=new Array(h),x=0;x<h;++x)i[x]=s;return i}function t(h,s,i,x){function p(w){return function(_,c,b){return _.getUniform(c.program,b[w])}}function v(w){return function(c){for(var b=f("",w),u=0;u<b.length;++u){var L=b[u],T=L[0],k=L[1];if(x[k]){var P=c;if(typeof T=="string"&&(T.indexOf(".")===0||T.indexOf("[")===0)){var z=T;if(T.indexOf(".")===0&&(z=T.slice(1)),z.indexOf("]")===z.length-1){var I=z.indexOf("["),D=z.slice(0,I),R=z.slice(I+1,z.length-1);P=D?c[D][R]:c[R]}else P=c[z]}var O=i[k].type,F;switch(O){case"bool":case"int":case"sampler2D":case"samplerCube":h.uniform1i(x[k],P);break;case"float":h.uniform1f(x[k],P);break;default:var N=O.indexOf("vec");if(0<=N&&N<=1&&O.length===4+N){if(F=O.charCodeAt(O.length-1)-48,F<2||F>4)throw new a("","Invalid data type");switch(O.charAt(0)){case"b":case"i":h["uniform"+F+"iv"](x[k],P);break;case"v":h["uniform"+F+"fv"](x[k],P);break;default:throw new a("","Unrecognized data type for vector "+name+": "+O)}}else if(O.indexOf("mat")===0&&O.length===4){if(F=O.charCodeAt(O.length-1)-48,F<2||F>4)throw new a("","Invalid uniform dimension type for matrix "+name+": "+O);h["uniformMatrix"+F+"fv"](x[k],!1,P);break}else throw new a("","Unknown uniform data type for "+name+": "+O)}}}}}function f(w,_){if(typeof _!="object")return[[w,_]];var c=[];for(var b in _){var u=_[b],L=w;parseInt(b)+""===b?L+="["+b+"]":L+="."+b,typeof u=="object"?c.push.apply(c,f(L,u)):c.push([L,u])}return c}function d(w){switch(w){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var _=w.indexOf("vec");if(0<=_&&_<=1&&w.length===4+_){var c=w.charCodeAt(w.length-1)-48;if(c<2||c>4)throw new a("","Invalid data type");return w.charAt(0)==="b"?r(c,!1):r(c,0)}else if(w.indexOf("mat")===0&&w.length===4){var c=w.charCodeAt(w.length-1)-48;if(c<2||c>4)throw new a("","Invalid uniform dimension type for matrix "+name+": "+w);return r(c*c,0)}else throw new a("","Unknown uniform data type for "+name+": "+w)}}function o(w,_,c){if(typeof c=="object"){var b=m(c);Object.defineProperty(w,_,{get:n(b),set:v(c),enumerable:!0,configurable:!1})}else x[c]?Object.defineProperty(w,_,{get:p(c),set:v(c),enumerable:!0,configurable:!1}):w[_]=d(i[c].type)}function m(w){var _;if(Array.isArray(w)){_=new Array(w.length);for(var c=0;c<w.length;++c)o(_,c,w[c])}else{_={};for(var b in w)o(_,b,w[b])}return _}var l=e(i,!0);return{get:n(m(l)),set:v(l),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(g,S,M){S.exports=e;function e(a,n){for(var r={},t=0;t<a.length;++t)for(var h=a[t].name,s=h.split("."),i=r,x=0;x<s.length;++x){var p=s[x].split("[");if(p.length>1){p[0]in i||(i[p[0]]=[]),i=i[p[0]];for(var v=1;v<p.length;++v){var f=parseInt(p[v]);v<p.length-1||x<s.length-1?(f in i||(v<p.length-1?i[f]=[]:i[f]={}),i=i[f]):n?i[f]=t:i[f]=a[t].type}}else x<s.length-1?(p[0]in i||(i[p[0]]={}),i=i[p[0]]):n?i[p[0]]=t:i[p[0]]=a[t].type}return r}},{}],137:[function(g,S,M){M.uniforms=r,M.attributes=t;var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},a=null;function n(h,s){if(!a){var i=Object.keys(e);a={};for(var x=0;x<i.length;++x){var p=i[x];a[h[p]]=e[p]}}return a[s]}function r(h,s){for(var i=h.getProgramParameter(s,h.ACTIVE_UNIFORMS),x=[],p=0;p<i;++p){var v=h.getActiveUniform(s,p);if(v){var f=n(h,v.type);if(v.size>1)for(var d=0;d<v.size;++d)x.push({name:v.name.replace("[0]","["+d+"]"),type:f});else x.push({name:v.name,type:f})}}return x}function t(h,s){for(var i=h.getProgramParameter(s,h.ACTIVE_ATTRIBUTES),x=[],p=0;p<i;++p){var v=h.getActiveAttrib(s,p);v&&x.push({name:v.name,type:n(h,v.type)})}return x}},{}],138:[function(g,S,M){M.shader=f,M.program=d;var e=g("./GLError"),a=g("gl-format-compiler-error"),n=typeof WeakMap>"u"?g("weakmap-shim"):WeakMap,r=new n,t=0;function h(o,m,l,w,_,c,b){this.id=o,this.src=m,this.type=l,this.shader=w,this.count=c,this.programs=[],this.cache=b}h.prototype.dispose=function(){if(--this.count===0){for(var o=this.cache,m=o.gl,l=this.programs,w=0,_=l.length;w<_;++w){var c=o.programs[l[w]];c&&(delete o.programs[w],m.deleteProgram(c))}m.deleteShader(this.shader),delete o.shaders[this.type===m.FRAGMENT_SHADER|0][this.src]}};function s(o){this.gl=o,this.shaders=[{},{}],this.programs={}}var i=s.prototype;function x(o,m,l){var w=o.createShader(m);if(o.shaderSource(w,l),o.compileShader(w),!o.getShaderParameter(w,o.COMPILE_STATUS)){var _=o.getShaderInfoLog(w);try{var c=a(_,l,m)}catch(b){throw console.warn("Failed to format compiler error: "+b),new e(_,`Error compiling shader:
`+_)}throw new e(_,c.short,c.long)}return w}i.getShaderReference=function(o,m){var l=this.gl,w=this.shaders[o===l.FRAGMENT_SHADER|0],_=w[m];if(!_||!l.isShader(_.shader)){var c=x(l,o,m);_=w[m]=new h(t++,m,o,c,[],1,this)}else _.count+=1;return _};function p(o,m,l,w,_){var c=o.createProgram();o.attachShader(c,m),o.attachShader(c,l);for(var b=0;b<w.length;++b)o.bindAttribLocation(c,_[b],w[b]);if(o.linkProgram(c),!o.getProgramParameter(c,o.LINK_STATUS)){var u=o.getProgramInfoLog(c);throw new e(u,"Error linking program: "+u)}return c}i.getProgram=function(o,m,l,w){var _=[o.id,m.id,l.join(":"),w.join(":")].join("@"),c=this.programs[_];return(!c||!this.gl.isProgram(c))&&(this.programs[_]=c=p(this.gl,o.shader,m.shader,l,w),o.programs.push(_),m.programs.push(_)),c};function v(o){var m=r.get(o);return m||(m=new s(o),r.set(o,m)),m}function f(o,m,l){return v(o).getShaderReference(m,l)}function d(o,m,l,w,_){return v(o).getProgram(m,l,w,_)}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(g,S,M){S.exports=n;function e(r){this.plot=r,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}var a=e.prototype;a.update=function(r){r=r||{},this.enable=(r.enable||[!0,!0,!1,!1]).slice(),this.width=(r.width||[1,1,1,1]).slice(),this.color=(r.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(t){return t.slice()}),this.center=(r.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},a.draw=function(){var r=this.enable,t=this.width,h=this.color,s=this.center,i=this.plot,x=i.line,p=i.dataBox,v=i.viewBox;if(x.bind(),p[0]<=s[0]&&s[0]<=p[2]&&p[1]<=s[1]&&s[1]<=p[3]){var f=v[0]+(s[0]-p[0])/(p[2]-p[0])*(v[2]-v[0]),d=v[1]+(s[1]-p[1])/(p[3]-p[1])*(v[3]-v[1]);r[0]&&x.drawLine(f,d,v[0],d,t[0],h[0]),r[1]&&x.drawLine(f,d,f,v[1],t[1],h[1]),r[2]&&x.drawLine(f,d,v[2],d,t[2],h[2]),r[3]&&x.drawLine(f,d,f,v[3],t[3],h[3])}},a.dispose=function(){this.plot.removeOverlay(this)};function n(r,t){var h=new e(r);return h.update(t),r.addOverlay(h),h}},{}],140:[function(g,S,M){var e=g("glslify"),a=g("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),r=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);S.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(g,S,M){var e=g("gl-buffer"),a=g("gl-vao"),n=g("./shaders/index");S.exports=p;var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(v,f,d,o){this.gl=v,this.buffer=f,this.vao=d,this.shader=o,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var h=t.prototype,s=[0,0,0],i=[0,0,0],x=[0,0];h.isTransparent=function(){return!1},h.drawTransparent=function(v){},h.draw=function(v){var f=this.gl,d=this.vao,o=this.shader;d.bind(),o.bind();var m=v.model||r,l=v.view||r,w=v.projection||r,_;this.axes&&(_=this.axes.lastCubeProps.axis);for(var c=s,b=i,u=0;u<3;++u)_&&_[u]<0?(c[u]=this.bounds[0][u],b[u]=this.bounds[1][u]):(c[u]=this.bounds[1][u],b[u]=this.bounds[0][u]);x[0]=f.drawingBufferWidth,x[1]=f.drawingBufferHeight,o.uniforms.model=m,o.uniforms.view=l,o.uniforms.projection=w,o.uniforms.coordinates=[this.position,c,b],o.uniforms.colors=this.colors,o.uniforms.screenShape=x;for(var u=0;u<3;++u)o.uniforms.lineWidth=this.lineWidth[u]*this.pixelRatio,this.enabled[u]&&(d.draw(f.TRIANGLES,6,6*u),this.drawSides[u]&&d.draw(f.TRIANGLES,12,18+12*u));d.unbind()},h.update=function(v){v&&("bounds"in v&&(this.bounds=v.bounds),"position"in v&&(this.position=v.position),"lineWidth"in v&&(this.lineWidth=v.lineWidth),"colors"in v&&(this.colors=v.colors),"enabled"in v&&(this.enabled=v.enabled),"drawSides"in v&&(this.drawSides=v.drawSides))},h.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function p(v,f){var d=[];function o(c,b,u,L,T,k){var P=[c,b,u,0,0,0,1];P[L+3]=1,P[L]=T,d.push.apply(d,P),P[6]=-1,d.push.apply(d,P),P[L]=k,d.push.apply(d,P),d.push.apply(d,P),P[6]=1,d.push.apply(d,P),P[L]=T,d.push.apply(d,P)}o(0,0,0,0,0,1),o(0,0,0,1,0,1),o(0,0,0,2,0,1),o(1,0,0,1,-1,1),o(1,0,0,2,-1,1),o(0,1,0,0,-1,1),o(0,1,0,2,-1,1),o(0,0,1,0,-1,1),o(0,0,1,1,-1,1);var m=e(v,d),l=a(v,[{type:v.FLOAT,buffer:m,size:3,offset:0,stride:28},{type:v.FLOAT,buffer:m,size:3,offset:12,stride:28},{type:v.FLOAT,buffer:m,size:1,offset:24,stride:28}]),w=n(v);w.attributes.position.location=0,w.attributes.color.location=1,w.attributes.weight.location=2;var _=new t(v,m,l,w);return _.update(f),_}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(g,S,M){var e=g("glslify"),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),r=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);M.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},M.pickShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(g,S,M){var e=g("gl-vec3"),a=g("gl-vec4"),n=["xyz","xzy","yxz","yzx","zxy","zyx"],r=function(d,o,m,l){for(var w=d.points,_=d.velocities,c=d.divergences,b=[],u=[],L=[],T=[],k=[],P=[],z=0,I=0,D=a.create(),R=a.create(),O=8,F=0;F<w.length;F++){var N=w[F],G=_[F],K=c[F];o===0&&(K=m*.05),I=e.length(G)/l,D=a.create(),e.copy(D,G),D[3]=K;for(var W=0;W<O;W++)k[W]=[N[0],N[1],N[2],W];if(T.length>0)for(var W=0;W<O;W++){var Y=(W+1)%O;b.push(T[W],k[W],k[Y],k[Y],T[Y],T[W]),L.push(R,D,D,D,R,R),P.push(z,I,I,I,z,z);var re=b.length;u.push([re-6,re-5,re-4],[re-3,re-2,re-1])}var ue=T;T=k,k=ue;var j=R;R=D,D=j;var q=z;z=I,I=q}return{positions:b,cells:u,vectors:L,vertexIntensity:P}},t=function(d,o,m,l){for(var w=0,_=0;_<d.length;_++)for(var c=d[_].velocities,b=0;b<c.length;b++)w=Math.max(w,e.length(c[b]));for(var u=d.map(function(F){return r(F,m,l,w)}),L=[],T=[],k=[],P=[],_=0;_<u.length;_++){var z=u[_],I=L.length;L=L.concat(z.positions),k=k.concat(z.vectors),P=P.concat(z.vertexIntensity);for(var b=0;b<z.cells.length;b++){var D=z.cells[b],R=[];T.push(R);for(var O=0;O<D.length;O++)R.push(D[O]+I)}}return{positions:L,cells:T,vectors:k,vertexIntensity:P,colormap:o}},h=function(d,o){var m=d.length,l;for(l=0;l<m;l++){var w=d[l];if(w===o)return l;if(w>o)return l-1}return l},s=function(d,o,m){return d<o?o:d>m?m:d},i=function(d,o,m){var l=o.vectors,w=o.meshgrid,_=d[0],c=d[1],b=d[2],u=w[0].length,L=w[1].length,T=w[2].length,k=h(w[0],_),P=h(w[1],c),z=h(w[2],b),I=k+1,D=P+1,R=z+1;if(k=s(k,0,u-1),I=s(I,0,u-1),P=s(P,0,L-1),D=s(D,0,L-1),z=s(z,0,T-1),R=s(R,0,T-1),k<0||P<0||z<0||I>u-1||D>L-1||R>T-1)return e.create();var O=w[0][k],F=w[0][I],N=w[1][P],G=w[1][D],K=w[2][z],W=w[2][R],Y=(_-O)/(F-O),re=(c-N)/(G-N),ue=(b-K)/(W-K);isFinite(Y)||(Y=.5),isFinite(re)||(re=.5),isFinite(ue)||(ue=.5);var j,q,H,U,$,ne;switch(m.reversedX&&(k=u-1-k,I=u-1-I),m.reversedY&&(P=L-1-P,D=L-1-D),m.reversedZ&&(z=T-1-z,R=T-1-R),m.filled){case 5:$=z,ne=R,H=P*T,U=D*T,j=k*T*L,q=I*T*L;break;case 4:$=z,ne=R,j=k*T,q=I*T,H=P*T*u,U=D*T*u;break;case 3:H=P,U=D,$=z*L,ne=R*L,j=k*L*T,q=I*L*T;break;case 2:H=P,U=D,j=k*L,q=I*L,$=z*L*u,ne=R*L*u;break;case 1:j=k,q=I,$=z*u,ne=R*u,H=P*u*T,U=D*u*T;break;default:j=k,q=I,H=P*u,U=D*u,$=z*u*L,ne=R*u*L;break}var X=l[j+H+$],Q=l[j+H+ne],ie=l[j+U+$],se=l[j+U+ne],ae=l[q+H+$],oe=l[q+H+ne],be=l[q+U+$],ce=l[q+U+ne],de=e.create(),ye=e.create(),ge=e.create(),me=e.create();e.lerp(de,X,ae,Y),e.lerp(ye,Q,oe,Y),e.lerp(ge,ie,be,Y),e.lerp(me,se,ce,Y);var Ee=e.create(),Pe=e.create();e.lerp(Ee,de,ge,re),e.lerp(Pe,ye,me,re);var Ue=e.create();return e.lerp(Ue,Ee,Pe,ue),Ue},x=function(d){var o=1/0;d.sort(function(_,c){return _-c});for(var m=d.length,l=1;l<m;l++){var w=Math.abs(d[l]-d[l-1]);w<o&&(o=w)}return o},p=function(d){for(var o=[],m=[],l=[],w={},_={},c={},b=d.length,u=0;u<b;u++){var L=d[u],T=L[0],k=L[1],P=L[2];w[T]||(o.push(T),w[T]=!0),_[k]||(m.push(k),_[k]=!0),c[P]||(l.push(P),c[P]=!0)}var z=x(o),I=x(m),D=x(l),R=Math.min(z,I,D);return isFinite(R)?R:1};S.exports=function(d,o){var m=d.startingPositions,l=d.maxLength||1e3,w=d.tubeSize||1,_=d.absoluteTubeSize,c=d.gridFill||"+x+y+z",b={};c.indexOf("-x")!==-1&&(b.reversedX=!0),c.indexOf("-y")!==-1&&(b.reversedY=!0),c.indexOf("-z")!==-1&&(b.reversedZ=!0),b.filled=n.indexOf(c.replace(/-/g,"").replace(/\+/g,""));var u=d.getVelocity||function(oe){return i(oe,d,b)},L=d.getDivergence||function(oe,be){var ce=e.create(),de=1e-4;e.add(ce,oe,[de,0,0]);var ye=u(ce);e.subtract(ye,ye,be),e.scale(ye,ye,1/de),e.add(ce,oe,[0,de,0]);var ge=u(ce);e.subtract(ge,ge,be),e.scale(ge,ge,1/de),e.add(ce,oe,[0,0,de]);var me=u(ce);return e.subtract(me,me,be),e.scale(me,me,1/de),e.add(ce,ye,ge),e.add(ce,ce,me),ce},T=[],k=o[0][0],P=o[0][1],z=o[0][2],I=o[1][0],D=o[1][1],R=o[1][2],O=function(oe){var be=oe[0],ce=oe[1],de=oe[2];return!(be<k||be>I||ce<P||ce>D||de<z||de>R)},F=e.distance(o[0],o[1]),N=10*F/l,G=N*N,K=1,W=0,Y=m.length;Y>1&&(K=p(m));for(var re=0;re<Y;re++){var ue=e.create();e.copy(ue,m[re]);var j=[ue],q=[],H=u(ue),U=ue;q.push(H);var $=[],ne=L(ue,H),X=e.length(ne);isFinite(X)&&X>W&&(W=X),$.push(X),T.push({points:j,velocities:q,divergences:$});for(var Q=0;Q<l*100&&j.length<l&&O(ue);){Q++;var ie=e.clone(H),se=e.squaredLength(ie);if(se===0)break;if(se>G&&e.scale(ie,ie,N/Math.sqrt(se)),e.add(ie,ie,ue),H=u(ie),e.squaredDistance(U,ie)-G>-1e-4*G){j.push(ie),U=ie,q.push(H);var ne=L(ie,H),X=e.length(ne);isFinite(X)&&X>W&&(W=X),$.push(X)}ue=ie}}var ae=t(T,d.colormap,W,K);return _?ae.tubeScale=_:(W===0&&(W=1),ae.tubeScale=w*.5*K/W),ae};var v=g("./lib/shaders"),f=g("gl-cone3d").createMesh;S.exports.createTubeMesh=function(d,o){return f(d,o,{shaders:v,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(g,S,M){var e=g("gl-shader"),a=g("glslify"),n=a([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),r=a([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color  in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),t=a([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),h=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);M.createShader=function(s){var i=e(s,n,r,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},M.createPickShader=function(s){var i=e(s,n,h,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},M.createContourShader=function(s){var i=e(s,t,r,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},M.createPickContourShader=function(s){var i=e(s,t,h,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},{"gl-shader":132,glslify:231}],145:[function(g,S,M){S.exports=q;var e=g("bit-twiddle"),a=g("gl-buffer"),n=g("gl-vao"),r=g("gl-texture2d"),t=g("typedarray-pool"),h=g("colormap"),s=g("ndarray-ops"),i=g("ndarray-pack"),x=g("ndarray"),p=g("surface-nets"),v=g("gl-mat4/multiply"),f=g("gl-mat4/invert"),d=g("binary-search-bounds"),o=g("ndarray-gradient"),m=g("./lib/shaders"),l=m.createShader,w=m.createContourShader,_=m.createPickShader,c=m.createPickContourShader,b=4*(4+3+3),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],T=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var H=0;H<3;++H){var U=T[H],$=(H+1)%3,ne=(H+2)%3;U[$+0]=1,U[ne+3]=1,U[H+6]=1}})();function k(H,U,$,ne,X){this.position=H,this.index=U,this.uv=$,this.level=ne,this.dataCoordinate=X}var P=256;function z(H,U,$,ne,X,Q,ie,se,ae,oe,be,ce,de,ye,ge){this.gl=H,this.shape=U,this.bounds=$,this.objectOffset=ge,this.intensityBounds=[],this._shader=ne,this._pickShader=X,this._coordinateBuffer=Q,this._vao=ie,this._colorMap=se,this._contourShader=ae,this._contourPickShader=oe,this._contourBuffer=be,this._contourVAO=ce,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new k([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=de,this._dynamicVAO=ye,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[x(t.mallocFloat(1024),[0,0]),x(t.mallocFloat(1024),[0,0]),x(t.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var I=z.prototype;I.genColormap=function(H,U){var $=!1,ne=i([h({colormap:H,nshades:P,format:"rgba"}).map(function(X,Q){var ie=U?D(Q/255,U):X[3];return ie<1&&($=!0),[X[0],X[1],X[2],255*ie]})]);return s.divseq(ne,255),this.hasAlphaScale=$,ne},I.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},I.isOpaque=function(){return!this.isTransparent()},I.pickSlots=1,I.setPickBase=function(H){this.pickId=H};function D(H,U){if(!U||!U.length)return 1;for(var $=0;$<U.length;++$){if(U.length<2)return 1;if(U[$][0]===H)return U[$][1];if(U[$][0]>H&&$>0){var ne=(U[$][0]-H)/(U[$][0]-U[$-1][0]);return U[$][1]*(1-ne)+ne*U[$-1][1]}}return 1}var R=[0,0,0],O={showSurface:!1,showContour:!1,projections:[u.slice(),u.slice(),u.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function F(H,U){var $,ne,X,Q=U.axes&&U.axes.lastCubeProps.axis||R,ie=U.showSurface,se=U.showContour;for($=0;$<3;++$)for(ie=ie||U.surfaceProject[$],ne=0;ne<3;++ne)se=se||U.contourProject[$][ne];for($=0;$<3;++$){var ae=O.projections[$];for(ne=0;ne<16;++ne)ae[ne]=0;for(ne=0;ne<4;++ne)ae[5*ne]=1;ae[5*$]=0,ae[12+$]=U.axesBounds[+(Q[$]>0)][$],v(ae,H.model,ae);var oe=O.clipBounds[$];for(X=0;X<2;++X)for(ne=0;ne<3;++ne)oe[X][ne]=H.clipBounds[X][ne];oe[0][$]=-1e8,oe[1][$]=1e8}return O.showSurface=ie,O.showContour=se,O}var N={model:u,view:u,projection:u,inverseModel:u.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},G=u.slice(),K=[1,0,0,0,1,0,0,0,1];function W(H,U){H=H||{};var $=this.gl;$.disable($.CULL_FACE),this._colorMap.bind(0);var ne=N;ne.model=H.model||u,ne.view=H.view||u,ne.projection=H.projection||u,ne.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],ne.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],ne.objectOffset=this.objectOffset,ne.contourColor=this.contourColor[0],ne.inverseModel=f(ne.inverseModel,ne.model);for(var X=0;X<2;++X)for(var Q=ne.clipBounds[X],ie=0;ie<3;++ie)Q[ie]=Math.min(Math.max(this.clipBounds[X][ie],-1e8),1e8);ne.kambient=this.ambientLight,ne.kdiffuse=this.diffuseLight,ne.kspecular=this.specularLight,ne.roughness=this.roughness,ne.fresnel=this.fresnel,ne.opacity=this.opacity,ne.height=0,ne.permutation=K,ne.vertexColor=this.vertexColor;var se=G;for(v(se,ne.view,ne.model),v(se,ne.projection,se),f(se,se),X=0;X<3;++X)ne.eyePosition[X]=se[12+X]/se[15];var ae=se[15];for(X=0;X<3;++X)ae+=this.lightPosition[X]*se[4*X+3];for(X=0;X<3;++X){var oe=se[12+X];for(ie=0;ie<3;++ie)oe+=se[4*ie+X]*this.lightPosition[ie];ne.lightPosition[X]=oe/ae}var be=F(ne,this);if(be.showSurface){for(this._shader.bind(),this._shader.uniforms=ne,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw($.TRIANGLES,this._vertexCount),X=0;X<3;++X)!this.surfaceProject[X]||!this.vertexCount||(this._shader.uniforms.model=be.projections[X],this._shader.uniforms.clipBounds=be.clipBounds[X],this._vao.draw($.TRIANGLES,this._vertexCount));this._vao.unbind()}if(be.showContour){var ce=this._contourShader;ne.kambient=1,ne.kdiffuse=0,ne.kspecular=0,ne.opacity=1,ce.bind(),ce.uniforms=ne;var de=this._contourVAO;for(de.bind(),X=0;X<3;++X)for(ce.uniforms.permutation=T[X],$.lineWidth(this.contourWidth[X]*this.pixelRatio),ie=0;ie<this.contourLevels[X].length;++ie)ie===this.highlightLevel[X]?(ce.uniforms.contourColor=this.highlightColor[X],ce.uniforms.contourTint=this.highlightTint[X]):(ie===0||ie-1===this.highlightLevel[X])&&(ce.uniforms.contourColor=this.contourColor[X],ce.uniforms.contourTint=this.contourTint[X]),this._contourCounts[X][ie]&&(ce.uniforms.height=this.contourLevels[X][ie],de.draw($.LINES,this._contourCounts[X][ie],this._contourOffsets[X][ie]));for(X=0;X<3;++X)for(ce.uniforms.model=be.projections[X],ce.uniforms.clipBounds=be.clipBounds[X],ie=0;ie<3;++ie)if(this.contourProject[X][ie]){ce.uniforms.permutation=T[ie],$.lineWidth(this.contourWidth[ie]*this.pixelRatio);for(var ye=0;ye<this.contourLevels[ie].length;++ye)ye===this.highlightLevel[ie]?(ce.uniforms.contourColor=this.highlightColor[ie],ce.uniforms.contourTint=this.highlightTint[ie]):(ye===0||ye-1===this.highlightLevel[ie])&&(ce.uniforms.contourColor=this.contourColor[ie],ce.uniforms.contourTint=this.contourTint[ie]),this._contourCounts[ie][ye]&&(ce.uniforms.height=this.contourLevels[ie][ye],de.draw($.LINES,this._contourCounts[ie][ye],this._contourOffsets[ie][ye]))}for(de.unbind(),de=this._dynamicVAO,de.bind(),X=0;X<3;++X)if(this._dynamicCounts[X]!==0)for(ce.uniforms.model=ne.model,ce.uniforms.clipBounds=ne.clipBounds,ce.uniforms.permutation=T[X],$.lineWidth(this.dynamicWidth[X]*this.pixelRatio),ce.uniforms.contourColor=this.dynamicColor[X],ce.uniforms.contourTint=this.dynamicTint[X],ce.uniforms.height=this.dynamicLevel[X],de.draw($.LINES,this._dynamicCounts[X],this._dynamicOffsets[X]),ie=0;ie<3;++ie)this.contourProject[ie][X]&&(ce.uniforms.model=be.projections[ie],ce.uniforms.clipBounds=be.clipBounds[ie],de.draw($.LINES,this._dynamicCounts[X],this._dynamicOffsets[X]));de.unbind()}}I.draw=function(H){return W.call(this,H,!1)},I.drawTransparent=function(H){return W.call(this,H,!0)};var Y={model:u,view:u,projection:u,inverseModel:u,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};I.drawPick=function(H){H=H||{};var U=this.gl;U.disable(U.CULL_FACE);var $=Y;$.model=H.model||u,$.view=H.view||u,$.projection=H.projection||u,$.shape=this._field[2].shape,$.pickId=this.pickId/255,$.lowerBound=this.bounds[0],$.upperBound=this.bounds[1],$.objectOffset=this.objectOffset,$.permutation=K;for(var ne=0;ne<2;++ne)for(var X=$.clipBounds[ne],Q=0;Q<3;++Q)X[Q]=Math.min(Math.max(this.clipBounds[ne][Q],-1e8),1e8);var ie=F($,this);if(ie.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=$,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),ne=0;ne<3;++ne)this.surfaceProject[ne]&&(this._pickShader.uniforms.model=ie.projections[ne],this._pickShader.uniforms.clipBounds=ie.clipBounds[ne],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ie.showContour){var se=this._contourPickShader;se.bind(),se.uniforms=$;var ae=this._contourVAO;for(ae.bind(),Q=0;Q<3;++Q)for(U.lineWidth(this.contourWidth[Q]*this.pixelRatio),se.uniforms.permutation=T[Q],ne=0;ne<this.contourLevels[Q].length;++ne)this._contourCounts[Q][ne]&&(se.uniforms.height=this.contourLevels[Q][ne],ae.draw(U.LINES,this._contourCounts[Q][ne],this._contourOffsets[Q][ne]));for(ne=0;ne<3;++ne)for(se.uniforms.model=ie.projections[ne],se.uniforms.clipBounds=ie.clipBounds[ne],Q=0;Q<3;++Q)if(this.contourProject[ne][Q]){se.uniforms.permutation=T[Q],U.lineWidth(this.contourWidth[Q]*this.pixelRatio);for(var oe=0;oe<this.contourLevels[Q].length;++oe)this._contourCounts[Q][oe]&&(se.uniforms.height=this.contourLevels[Q][oe],ae.draw(U.LINES,this._contourCounts[Q][oe],this._contourOffsets[Q][oe]))}ae.unbind()}},I.pick=function(H){if(!H||H.id!==this.pickId)return null;var U=this._field[2].shape,$=this._pickResult,ne=U[0]*(H.value[0]+(H.value[2]>>4)/16)/255,X=Math.floor(ne),Q=ne-X,ie=U[1]*(H.value[1]+(H.value[2]&15)/16)/255,se=Math.floor(ie),ae=ie-se;X+=1,se+=1;var oe=$.position;oe[0]=oe[1]=oe[2]=0;for(var be=0;be<2;++be)for(var ce=be?Q:1-Q,de=0;de<2;++de)for(var ye=de?ae:1-ae,ge=X+be,me=se+de,Ee=ce*ye,Pe=0;Pe<3;++Pe)oe[Pe]+=this._field[Pe].get(ge,me)*Ee;for(var Ue=this._pickResult.level,we=0;we<3;++we)if(Ue[we]=d.le(this.contourLevels[we],oe[we]),Ue[we]<0)this.contourLevels[we].length>0&&(Ue[we]=0);else if(Ue[we]<this.contourLevels[we].length-1){var ke=this.contourLevels[we][Ue[we]],Xe=this.contourLevels[we][Ue[we]+1];Math.abs(ke-oe[we])>Math.abs(Xe-oe[we])&&(Ue[we]+=1)}for($.index[0]=Q<.5?X:X+1,$.index[1]=ae<.5?se:se+1,$.uv[0]=ne/U[0],$.uv[1]=ie/U[1],Pe=0;Pe<3;++Pe)$.dataCoordinate[Pe]=this._field[Pe].get($.index[0],$.index[1]);return $},I.padField=function(H,U){var $=U.shape.slice(),ne=H.shape.slice();s.assign(H.lo(1,1).hi($[0],$[1]),U),s.assign(H.lo(1).hi($[0],1),U.hi($[0],1)),s.assign(H.lo(1,ne[1]-1).hi($[0],1),U.lo(0,$[1]-1).hi($[0],1)),s.assign(H.lo(0,1).hi(1,$[1]),U.hi(1)),s.assign(H.lo(ne[0]-1,1).hi(1,$[1]),U.lo($[0]-1)),H.set(0,0,U.get(0,0)),H.set(0,ne[1]-1,U.get(0,$[1]-1)),H.set(ne[0]-1,0,U.get($[0]-1,0)),H.set(ne[0]-1,ne[1]-1,U.get($[0]-1,$[1]-1))};function re(H,U){return Array.isArray(H)?[U(H[0]),U(H[1]),U(H[2])]:[U(H),U(H),U(H)]}function ue(H){return Array.isArray(H)?H.length===3?[H[0],H[1],H[2],1]:[H[0],H[1],H[2],H[3]]:[0,0,0,1]}function j(H){if(Array.isArray(H)){if(Array.isArray(H))return[ue(H[0]),ue(H[1]),ue(H[2])];var U=ue(H);return[U.slice(),U.slice(),U.slice()]}}I.update=function(H){H=H||{},this.objectOffset=H.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in H&&(this.contourWidth=re(H.contourWidth,Number)),"showContour"in H&&(this.showContour=re(H.showContour,Boolean)),"showSurface"in H&&(this.showSurface=!!H.showSurface),"contourTint"in H&&(this.contourTint=re(H.contourTint,Boolean)),"contourColor"in H&&(this.contourColor=j(H.contourColor)),"contourProject"in H&&(this.contourProject=re(H.contourProject,function(it){return re(it,Boolean)})),"surfaceProject"in H&&(this.surfaceProject=H.surfaceProject),"dynamicColor"in H&&(this.dynamicColor=j(H.dynamicColor)),"dynamicTint"in H&&(this.dynamicTint=re(H.dynamicTint,Number)),"dynamicWidth"in H&&(this.dynamicWidth=re(H.dynamicWidth,Number)),"opacity"in H&&(this.opacity=H.opacity),"opacityscale"in H&&(this.opacityscale=H.opacityscale),"colorBounds"in H&&(this.colorBounds=H.colorBounds),"vertexColor"in H&&(this.vertexColor=H.vertexColor?1:0),"colormap"in H&&this._colorMap.setPixels(this.genColormap(H.colormap,this.opacityscale));var U=H.field||H.coords&&H.coords[2]||null,$=!1;if(U||(this._field[2].shape[0]||this._field[2].shape[2]?U=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):U=this._field[2].hi(0,0)),"field"in H||"coords"in H){var ne=(U.shape[0]+2)*(U.shape[1]+2);ne>this._field[2].data.length&&(t.freeFloat(this._field[2].data),this._field[2].data=t.mallocFloat(e.nextPow2(ne))),this._field[2]=x(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var X=this.shape,Q=0;Q<2;++Q)this._field[2].size>this._field[Q].data.length&&(t.freeFloat(this._field[Q].data),this._field[Q].data=t.mallocFloat(this._field[2].size)),this._field[Q]=x(this._field[Q].data,[X[0]+2,X[1]+2]);if(H.coords){var ie=H.coords;if(!Array.isArray(ie)||ie.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(Q=0;Q<2;++Q){var se=ie[Q];for(de=0;de<2;++de)if(se.shape[de]!==X[de])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[Q],se)}}else if(H.ticks){var ae=H.ticks;if(!Array.isArray(ae)||ae.length!==2)throw new Error("gl-surface: invalid ticks");for(Q=0;Q<2;++Q){var oe=ae[Q];if((Array.isArray(oe)||oe.length)&&(oe=x(oe)),oe.shape[0]!==X[Q])throw new Error("gl-surface: invalid tick length");var be=x(oe.data,X);be.stride[Q]=oe.stride[0],be.stride[Q^1]=0,this.padField(this._field[Q],be)}}else{for(Q=0;Q<2;++Q){var ce=[0,0];ce[Q]=1,this._field[Q]=x(this._field[Q].data,[X[0]+2,X[1]+2],ce,0)}this._field[0].set(0,0,0);for(var de=0;de<X[0];++de)this._field[0].set(de+1,0,de);for(this._field[0].set(X[0]+1,0,X[0]-1),this._field[1].set(0,0,0),de=0;de<X[1];++de)this._field[1].set(0,de+1,de);this._field[1].set(0,X[1]+1,X[1]-1)}var ye=this._field,ge=x(t.mallocFloat(ye[2].size*3*2),[3,X[0]+2,X[1]+2,2]);for(Q=0;Q<3;++Q)o(ge.pick(Q),ye[Q],"mirror");var me=x(t.mallocFloat(ye[2].size*3),[X[0]+2,X[1]+2,3]);for(Q=0;Q<X[0]+2;++Q)for(de=0;de<X[1]+2;++de){var Ee=ge.get(0,Q,de,0),Pe=ge.get(0,Q,de,1),Ue=ge.get(1,Q,de,0),we=ge.get(1,Q,de,1),ke=ge.get(2,Q,de,0),Xe=ge.get(2,Q,de,1),Ve=Ue*Xe-we*ke,Ie=ke*Pe-Xe*Ee,De=Ee*we-Pe*Ue,Ye=Math.sqrt(Ve*Ve+Ie*Ie+De*De);Ye<1e-8?(Ye=Math.max(Math.abs(Ve),Math.abs(Ie),Math.abs(De)),Ye<1e-8?(De=1,Ie=Ve=0,Ye=1):Ye=1/Ye):Ye=1/Math.sqrt(Ye),me.set(Q,de,0,Ve*Ye),me.set(Q,de,1,Ie*Ye),me.set(Q,de,2,De*Ye)}t.free(ge.data);var vt=[1/0,1/0,1/0],Dt=[-1/0,-1/0,-1/0],Kt=1/0,Ft=-1/0,Mt=(X[0]-1)*(X[1]-1)*6,Xt=t.mallocFloat(e.nextPow2(10*Mt)),It=0,At=0;for(Q=0;Q<X[0]-1;++Q)e:for(de=0;de<X[1]-1;++de){for(var Ge=0;Ge<2;++Ge)for(var tt=0;tt<2;++tt)for(var He=0;He<3;++He){var Ae=this._field[He].get(1+Q+Ge,1+de+tt);if(isNaN(Ae)||!isFinite(Ae))continue e}for(He=0;He<6;++He){var Ne=Q+L[He][0],Ze=de+L[He][1],Qe=this._field[0].get(Ne+1,Ze+1),bt=this._field[1].get(Ne+1,Ze+1);Ae=this._field[2].get(Ne+1,Ze+1),Ve=me.get(Ne+1,Ze+1,0),Ie=me.get(Ne+1,Ze+1,1),De=me.get(Ne+1,Ze+1,2),H.intensity&&(dt=H.intensity.get(Ne,Ze));var dt=H.intensity?H.intensity.get(Ne,Ze):Ae+this.objectOffset[2];Xt[It++]=Ne,Xt[It++]=Ze,Xt[It++]=Qe,Xt[It++]=bt,Xt[It++]=Ae,Xt[It++]=0,Xt[It++]=dt,Xt[It++]=Ve,Xt[It++]=Ie,Xt[It++]=De,vt[0]=Math.min(vt[0],Qe+this.objectOffset[0]),vt[1]=Math.min(vt[1],bt+this.objectOffset[1]),vt[2]=Math.min(vt[2],Ae+this.objectOffset[2]),Kt=Math.min(Kt,dt),Dt[0]=Math.max(Dt[0],Qe+this.objectOffset[0]),Dt[1]=Math.max(Dt[1],bt+this.objectOffset[1]),Dt[2]=Math.max(Dt[2],Ae+this.objectOffset[2]),Ft=Math.max(Ft,dt),At+=1}}for(H.intensityBounds&&(Kt=+H.intensityBounds[0],Ft=+H.intensityBounds[1]),Q=6;Q<It;Q+=10)Xt[Q]=(Xt[Q]-Kt)/(Ft-Kt);this._vertexCount=At,this._coordinateBuffer.update(Xt.subarray(0,It)),t.freeFloat(Xt),t.free(me.data),this.bounds=[vt,Dt],this.intensity=H.intensity||this._field[2],(this.intensityBounds[0]!==Kt||this.intensityBounds[1]!==Ft)&&($=!0),this.intensityBounds=[Kt,Ft]}if("levels"in H){var wt=H.levels;for(Array.isArray(wt[0])?wt=wt.slice():wt=[[],[],wt],Q=0;Q<3;++Q)wt[Q]=wt[Q].slice(),wt[Q].sort(function(it,ct){return it-ct});for(Q=0;Q<3;++Q)for(de=0;de<wt[Q].length;++de)wt[Q][de]-=this.objectOffset[Q];e:for(Q=0;Q<3;++Q){if(wt[Q].length!==this.contourLevels[Q].length){$=!0;break}for(de=0;de<wt[Q].length;++de)if(wt[Q][de]!==this.contourLevels[Q][de]){$=!0;break e}}this.contourLevels=wt}if($){ye=this._field,X=this.shape;for(var Ut=[],Rt=0;Rt<3;++Rt){var Nt=this.contourLevels[Rt],Wt=[],Vt=[],ir=[0,0,0];for(Q=0;Q<Nt.length;++Q){var Hr=p(this._field[Rt],Nt[Q]);Wt.push(Ut.length/5|0),At=0;e:for(de=0;de<Hr.cells.length;++de){var sn=Hr.cells[de];for(He=0;He<2;++He){var jr=Hr.positions[sn[He]],at=jr[0],$t=Math.floor(at)|0,Jt=at-$t,Gt=jr[1],_r=Math.floor(Gt)|0,rt=Gt-_r,Je=!1;t:for(var st=0;st<3;++st){ir[st]=0;var lt=(Rt+st+1)%3;for(Ge=0;Ge<2;++Ge){var Tt=Ge?Jt:1-Jt;for(Ne=Math.min(Math.max($t+Ge,0),X[0])|0,tt=0;tt<2;++tt){var zt=tt?rt:1-rt;if(Ze=Math.min(Math.max(_r+tt,0),X[1])|0,st<2?Ae=this._field[lt].get(Ne,Ze):Ae=(this.intensity.get(Ne,Ze)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Ae)||isNaN(Ae)){Je=!0;break t}var Ce=Tt*zt;ir[st]+=Ce*Ae}}}if(!Je)Ut.push(ir[0],ir[1],jr[0],jr[1],ir[2]),At+=1;else{if(He>0){for(var Se=0;Se<5;++Se)Ut.pop();At-=1}continue e}}}Vt.push(At)}this._contourOffsets[Rt]=Wt,this._contourCounts[Rt]=Vt}var nt=t.mallocFloat(Ut.length);for(Q=0;Q<Ut.length;++Q)nt[Q]=Ut[Q];this._contourBuffer.update(nt),t.freeFloat(nt)}},I.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var H=0;H<3;++H)t.freeFloat(this._field[H].data)},I.highlight=function(H){var U;if(!H){this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],this.highlightLevel=[-1,-1,-1];return}for(U=0;U<3;++U)this.enableHighlight[U]?this.highlightLevel[U]=H.level[U]:this.highlightLevel[U]=-1;var $;for(this.snapToData?$=H.dataCoordinate:$=H.position,U=0;U<3;++U)$[U]-=this.objectOffset[U];if(!((!this.enableDynamic[0]||$[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||$[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||$[2]===this.dynamicLevel[2]))){for(var ne=0,X=this.shape,Q=t.mallocFloat(12*X[0]*X[1]),ie=0;ie<3;++ie){if(!this.enableDynamic[ie]){this.dynamicLevel[ie]=NaN,this._dynamicCounts[ie]=0;continue}this.dynamicLevel[ie]=$[ie];var se=(ie+1)%3,ae=(ie+2)%3,oe=this._field[ie],be=this._field[se],ce=this._field[ae],de=p(oe,$[ie]),ye=de.cells,ge=de.positions;for(this._dynamicOffsets[ie]=ne,U=0;U<ye.length;++U)for(var me=ye[U],Ee=0;Ee<2;++Ee){var Pe=ge[me[Ee]],Ue=+Pe[0],we=Ue|0,ke=Math.min(we+1,X[0])|0,Xe=Ue-we,Ve=1-Xe,Ie=+Pe[1],De=Ie|0,Ye=Math.min(De+1,X[1])|0,vt=Ie-De,Dt=1-vt,Kt=Ve*Dt,Ft=Ve*vt,Mt=Xe*Dt,Xt=Xe*vt,It=Kt*be.get(we,De)+Ft*be.get(we,Ye)+Mt*be.get(ke,De)+Xt*be.get(ke,Ye),At=Kt*ce.get(we,De)+Ft*ce.get(we,Ye)+Mt*ce.get(ke,De)+Xt*ce.get(ke,Ye);if(isNaN(It)||isNaN(At)){Ee&&(ne-=1);break}Q[2*ne+0]=It,Q[2*ne+1]=At,ne+=1}this._dynamicCounts[ie]=ne-this._dynamicOffsets[ie]}this._dynamicBuffer.update(Q.subarray(0,2*ne)),t.freeFloat(Q)}};function q(H){var U=H.gl,$=l(U),ne=_(U),X=w(U),Q=c(U),ie=a(U),se=n(U,[{buffer:ie,size:4,stride:b,offset:0},{buffer:ie,size:3,stride:b,offset:16},{buffer:ie,size:3,stride:b,offset:28}]),ae=a(U),oe=n(U,[{buffer:ae,size:4,stride:20,offset:0},{buffer:ae,size:1,stride:20,offset:16}]),be=a(U),ce=n(U,[{buffer:be,size:2,type:U.FLOAT}]),de=r(U,1,P,U.RGBA,U.UNSIGNED_BYTE);de.minFilter=U.LINEAR,de.magFilter=U.LINEAR;var ye=new z(U,[0,0],[[0,0,0],[0,0,0]],$,ne,ie,se,de,X,Q,ae,oe,be,ce,[0,0,0]),ge={levels:[[],[],[]]};for(var me in H)ge[me]=H[me];return ge.colormap=ge.colormap||"jet",ye.update(ge),ye}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(g,S,M){var e=g("ndarray"),a=g("ndarray-ops"),n=g("typedarray-pool");S.exports=c;var r=null,t=null,h=null;function s(b){r=[b.LINEAR,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_NEAREST],t=[b.NEAREST,b.LINEAR,b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR],h=[b.REPEAT,b.CLAMP_TO_EDGE,b.MIRRORED_REPEAT]}function i(b){return typeof HTMLCanvasElement<"u"&&b instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&b instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&b instanceof HTMLVideoElement||typeof ImageData<"u"&&b instanceof ImageData}var x=function(b,u){a.muls(b,u,255)};function p(b,u,L){var T=b.gl,k=T.getParameter(T.MAX_TEXTURE_SIZE);if(u<0||u>k||L<0||L>k)throw new Error("gl-texture2d: Invalid texture size");return b._shape=[u,L],b.bind(),T.texImage2D(T.TEXTURE_2D,0,b.format,u,L,0,b.format,b.type,null),b._mipLevels=[0],b}function v(b,u,L,T,k,P){this.gl=b,this.handle=u,this.format=k,this.type=P,this._shape=[L,T],this._mipLevels=[0],this._magFilter=b.NEAREST,this._minFilter=b.NEAREST,this._wrapS=b.CLAMP_TO_EDGE,this._wrapT=b.CLAMP_TO_EDGE,this._anisoSamples=1;var z=this,I=[this._wrapS,this._wrapT];Object.defineProperties(I,[{get:function(){return z._wrapS},set:function(R){return z.wrapS=R}},{get:function(){return z._wrapT},set:function(R){return z.wrapT=R}}]),this._wrapVector=I;var D=[this._shape[0],this._shape[1]];Object.defineProperties(D,[{get:function(){return z._shape[0]},set:function(R){return z.width=R}},{get:function(){return z._shape[1]},set:function(R){return z.height=R}}]),this._shapeVector=D}var f=v.prototype;Object.defineProperties(f,{minFilter:{get:function(){return this._minFilter},set:function(b){this.bind();var u=this.gl;if(this.type===u.FLOAT&&r.indexOf(b)>=0&&(u.getExtension("OES_texture_float_linear")||(b=u.NEAREST)),t.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,b),this._minFilter=b}},magFilter:{get:function(){return this._magFilter},set:function(b){this.bind();var u=this.gl;if(this.type===u.FLOAT&&r.indexOf(b)>=0&&(u.getExtension("OES_texture_float_linear")||(b=u.NEAREST)),t.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,b),this._magFilter=b}},mipSamples:{get:function(){return this._anisoSamples},set:function(b){var u=this._anisoSamples;if(this._anisoSamples=Math.max(b,1)|0,u!==this._anisoSamples){var L=this.gl.getExtension("EXT_texture_filter_anisotropic");L&&this.gl.texParameterf(this.gl.TEXTURE_2D,L.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(b){if(this.bind(),h.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,b),this._wrapS=b}},wrapT:{get:function(){return this._wrapT},set:function(b){if(this.bind(),h.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,b),this._wrapT=b}},wrap:{get:function(){return this._wrapVector},set:function(b){if(Array.isArray(b)||(b=[b,b]),b.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var u=0;u<2;++u)if(h.indexOf(b[u])<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);this._wrapS=b[0],this._wrapT=b[1];var L=this.gl;return this.bind(),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,this._wrapS),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,this._wrapT),b}},shape:{get:function(){return this._shapeVector},set:function(b){if(!Array.isArray(b))b=[b|0,b|0];else if(b.length!==2)throw new Error("gl-texture2d: Invalid texture shape");return p(this,b[0]|0,b[1]|0),[b[0]|0,b[1]|0]}},width:{get:function(){return this._shape[0]},set:function(b){return b=b|0,p(this,b,this._shape[1]),b}},height:{get:function(){return this._shape[1]},set:function(b){return b=b|0,p(this,this._shape[0],b),b}}}),f.bind=function(b){var u=this.gl;return b!==void 0&&u.activeTexture(u.TEXTURE0+(b|0)),u.bindTexture(u.TEXTURE_2D,this.handle),b!==void 0?b|0:u.getParameter(u.ACTIVE_TEXTURE)-u.TEXTURE0},f.dispose=function(){this.gl.deleteTexture(this.handle)},f.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var b=Math.min(this._shape[0],this._shape[1]),u=0;b>0;++u,b>>>=1)this._mipLevels.indexOf(u)<0&&this._mipLevels.push(u)},f.setPixels=function(b,u,L,T){var k=this.gl;this.bind(),Array.isArray(u)?(T=L,L=u[1]|0,u=u[0]|0):(u=u||0,L=L||0),T=T||0;var P=i(b)?b:b.raw;if(P){var z=this._mipLevels.indexOf(T)<0;z?(k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,this.type,P),this._mipLevels.push(T)):k.texSubImage2D(k.TEXTURE_2D,T,u,L,this.format,this.type,P)}else if(b.shape&&b.stride&&b.data){if(b.shape.length<2||u+b.shape[1]>this._shape[1]>>>T||L+b.shape[0]>this._shape[0]>>>T||u<0||L<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");o(k,u,L,T,this.format,this.type,this._mipLevels,b)}else throw new Error("gl-texture2d: Unsupported data type")};function d(b,u){return b.length===3?u[2]===1&&u[1]===b[0]*b[2]&&u[0]===b[2]:u[0]===1&&u[1]===b[0]}function o(b,u,L,T,k,P,z,I){var D=I.dtype,R=I.shape.slice();if(R.length<2||R.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var O=0,F=0,N=d(R,I.stride.slice());if(D==="float32"?O=b.FLOAT:D==="float64"?(O=b.FLOAT,N=!1,D="float32"):D==="uint8"?O=b.UNSIGNED_BYTE:(O=b.UNSIGNED_BYTE,N=!1,D="uint8"),R.length===2)F=b.LUMINANCE,R=[R[0],R[1],1],I=e(I.data,R,[I.stride[0],I.stride[1],1],I.offset);else if(R.length===3){if(R[2]===1)F=b.ALPHA;else if(R[2]===2)F=b.LUMINANCE_ALPHA;else if(R[2]===3)F=b.RGB;else if(R[2]===4)F=b.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");R[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((F===b.LUMINANCE||F===b.ALPHA)&&(k===b.LUMINANCE||k===b.ALPHA)&&(F=k),F!==k)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var G=I.size,K=z.indexOf(T)<0;if(K&&z.push(T),O===P&&N)I.offset===0&&I.data.length===G?K?b.texImage2D(b.TEXTURE_2D,T,k,R[0],R[1],0,k,P,I.data):b.texSubImage2D(b.TEXTURE_2D,T,u,L,R[0],R[1],k,P,I.data):K?b.texImage2D(b.TEXTURE_2D,T,k,R[0],R[1],0,k,P,I.data.subarray(I.offset,I.offset+G)):b.texSubImage2D(b.TEXTURE_2D,T,u,L,R[0],R[1],k,P,I.data.subarray(I.offset,I.offset+G));else{var W;P===b.FLOAT?W=n.mallocFloat32(G):W=n.mallocUint8(G);var Y=e(W,R,[R[2],R[2]*R[0],1]);O===b.FLOAT&&P===b.UNSIGNED_BYTE?x(Y,I):a.assign(Y,I),K?b.texImage2D(b.TEXTURE_2D,T,k,R[0],R[1],0,k,P,W.subarray(0,G)):b.texSubImage2D(b.TEXTURE_2D,T,u,L,R[0],R[1],k,P,W.subarray(0,G)),P===b.FLOAT?n.freeFloat32(W):n.freeUint8(W)}}function m(b){var u=b.createTexture();return b.bindTexture(b.TEXTURE_2D,u),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),u}function l(b,u,L,T,k){var P=b.getParameter(b.MAX_TEXTURE_SIZE);if(u<0||u>P||L<0||L>P)throw new Error("gl-texture2d: Invalid texture shape");if(k===b.FLOAT&&!b.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var z=m(b);return b.texImage2D(b.TEXTURE_2D,0,T,u,L,0,T,k,null),new v(b,z,u,L,T,k)}function w(b,u,L,T,k,P){var z=m(b);return b.texImage2D(b.TEXTURE_2D,0,k,k,P,u),new v(b,z,L,T,k,P)}function _(b,u){var L=u.dtype,T=u.shape.slice(),k=b.getParameter(b.MAX_TEXTURE_SIZE);if(T[0]<0||T[0]>k||T[1]<0||T[1]>k)throw new Error("gl-texture2d: Invalid texture size");var P=d(T,u.stride.slice()),z=0;L==="float32"?z=b.FLOAT:L==="float64"?(z=b.FLOAT,P=!1,L="float32"):L==="uint8"?z=b.UNSIGNED_BYTE:(z=b.UNSIGNED_BYTE,P=!1,L="uint8");var I=0;if(T.length===2)I=b.LUMINANCE,T=[T[0],T[1],1],u=e(u.data,T,[u.stride[0],u.stride[1],1],u.offset);else if(T.length===3)if(T[2]===1)I=b.ALPHA;else if(T[2]===2)I=b.LUMINANCE_ALPHA;else if(T[2]===3)I=b.RGB;else if(T[2]===4)I=b.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");z===b.FLOAT&&!b.getExtension("OES_texture_float")&&(z=b.UNSIGNED_BYTE,P=!1);var D,R,O=u.size;if(P)u.offset===0&&u.data.length===O?D=u.data:D=u.data.subarray(u.offset,u.offset+O);else{var F=[T[2],T[2]*T[0],1];R=n.malloc(O,L);var N=e(R,T,F,0);(L==="float32"||L==="float64")&&z===b.UNSIGNED_BYTE?x(N,u):a.assign(N,u),D=R.subarray(0,O)}var G=m(b);return b.texImage2D(b.TEXTURE_2D,0,I,T[0],T[1],0,I,z,D),P||n.free(R),new v(b,G,T[0],T[1],I,z)}function c(b){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(r||s(b),typeof arguments[1]=="number")return l(b,arguments[1],arguments[2],arguments[3]||b.RGBA,arguments[4]||b.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return l(b,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var u=arguments[1],L=i(u)?u:u.raw;if(L)return w(b,L,u.width|0,u.height|0,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(u.shape&&u.data&&u.stride)return _(b,u)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(g,S,M){function e(a,n,r){n?n.bind():a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);var t=a.getParameter(a.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>t)throw new Error("gl-vao: Too many vertex attributes");for(var h=0;h<r.length;++h){var s=r[h];if(s.buffer){var i=s.buffer,x=s.size||4,p=s.type||a.FLOAT,v=!!s.normalized,f=s.stride||0,d=s.offset||0;i.bind(),a.enableVertexAttribArray(h),a.vertexAttribPointer(h,x,p,v,f,d)}else{if(typeof s=="number")a.vertexAttrib1f(h,s);else if(s.length===1)a.vertexAttrib1f(h,s[0]);else if(s.length===2)a.vertexAttrib2f(h,s[0],s[1]);else if(s.length===3)a.vertexAttrib3f(h,s[0],s[1],s[2]);else if(s.length===4)a.vertexAttrib4f(h,s[0],s[1],s[2],s[3]);else throw new Error("gl-vao: Invalid vertex attribute");a.disableVertexAttribArray(h)}}for(;h<t;++h)a.disableVertexAttribArray(h)}else{a.bindBuffer(a.ARRAY_BUFFER,null);for(var h=0;h<t;++h)a.disableVertexAttribArray(h)}}S.exports=e},{}],148:[function(g,S,M){var e=g("./do-bind.js");function a(r){this.gl=r,this._elements=null,this._attributes=null,this._elementsType=r.UNSIGNED_SHORT}a.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},a.prototype.update=function(r,t,h){this._elements=t,this._attributes=r,this._elementsType=h||this.gl.UNSIGNED_SHORT},a.prototype.dispose=function(){},a.prototype.unbind=function(){},a.prototype.draw=function(r,t,h){h=h||0;var s=this.gl;this._elements?s.drawElements(r,t,this._elementsType,h):s.drawArrays(r,h,t)};function n(r){return new a(r)}S.exports=n},{"./do-bind.js":147}],149:[function(g,S,M){var e=g("./do-bind.js");function a(t,h,s,i,x,p){this.location=t,this.dimension=h,this.a=s,this.b=i,this.c=x,this.d=p}a.prototype.bind=function(t){switch(this.dimension){case 1:t.vertexAttrib1f(this.location,this.a);break;case 2:t.vertexAttrib2f(this.location,this.a,this.b);break;case 3:t.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:t.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function n(t,h,s){this.gl=t,this._ext=h,this.handle=s,this._attribs=[],this._useElements=!1,this._elementsType=t.UNSIGNED_SHORT}n.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var t=0;t<this._attribs.length;++t)this._attribs[t].bind(this.gl)},n.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},n.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},n.prototype.update=function(t,h,s){if(this.bind(),e(this.gl,h,t),this.unbind(),this._attribs.length=0,t)for(var i=0;i<t.length;++i){var x=t[i];typeof x=="number"?this._attribs.push(new a(i,1,x)):Array.isArray(x)&&this._attribs.push(new a(i,x.length,x[0],x[1],x[2],x[3]))}this._useElements=!!h,this._elementsType=s||this.gl.UNSIGNED_SHORT},n.prototype.draw=function(t,h,s){s=s||0;var i=this.gl;this._useElements?i.drawElements(t,h,this._elementsType,s):i.drawArrays(t,s,h)};function r(t,h){return new n(t,h,h.createVertexArrayOES())}S.exports=r},{"./do-bind.js":147}],150:[function(g,S,M){var e=g("./lib/vao-native.js"),a=g("./lib/vao-emulated.js");function n(t){this.bindVertexArrayOES=t.bindVertexArray.bind(t),this.createVertexArrayOES=t.createVertexArray.bind(t),this.deleteVertexArrayOES=t.deleteVertexArray.bind(t)}function r(t,h,s,i){var x=t.createVertexArray?new n(t):t.getExtension("OES_vertex_array_object"),p;return x?p=e(t,x):p=a(t),p.update(h,s,i),p}S.exports=r},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a}},{}],152:[function(g,S,M){S.exports=r;var e=g("./fromValues"),a=g("./normalize"),n=g("./dot");function r(t,h){var s=e(t[0],t[1],t[2]),i=e(h[0],h[1],h[2]);a(s,s),a(i,i);var x=n(s,i);return x>1?0:Math.acos(x)}},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=Math.ceil(n[0]),a[1]=Math.ceil(n[1]),a[2]=Math.ceil(n[2]),a}},{}],154:[function(g,S,M){S.exports=e;function e(a){var n=new Float32Array(3);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}},{}],155:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a}},{}],156:[function(g,S,M){S.exports=e;function e(){var a=new Float32Array(3);return a[0]=0,a[1]=0,a[2]=0,a}},{}],157:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],h=n[1],s=n[2],i=r[0],x=r[1],p=r[2];return a[0]=h*p-s*x,a[1]=s*i-t*p,a[2]=t*x-h*i,a}},{}],158:[function(g,S,M){S.exports=g("./distance")},{"./distance":159}],159:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],h=n[2]-a[2];return Math.sqrt(r*r+t*t+h*h)}},{}],160:[function(g,S,M){S.exports=g("./divide")},{"./divide":161}],161:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a}},{}],162:[function(g,S,M){S.exports=e;function e(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]}},{}],163:[function(g,S,M){S.exports=1e-6},{}],164:[function(g,S,M){S.exports=a;var e=g("./epsilon");function a(n,r){var t=n[0],h=n[1],s=n[2],i=r[0],x=r[1],p=r[2];return Math.abs(t-i)<=e*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(h-x)<=e*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(s-p)<=e*Math.max(1,Math.abs(s),Math.abs(p))}},{"./epsilon":163}],165:[function(g,S,M){S.exports=e;function e(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]}},{}],166:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=Math.floor(n[0]),a[1]=Math.floor(n[1]),a[2]=Math.floor(n[2]),a}},{}],167:[function(g,S,M){S.exports=a;var e=g("./create")();function a(n,r,t,h,s,i){var x,p;for(r||(r=3),t||(t=0),h?p=Math.min(h*r+t,n.length):p=n.length,x=t;x<p;x+=r)e[0]=n[x],e[1]=n[x+1],e[2]=n[x+2],s(e,e,i),n[x]=e[0],n[x+1]=e[1],n[x+2]=e[2];return n}},{"./create":156}],168:[function(g,S,M){S.exports=e;function e(a,n,r){var t=new Float32Array(3);return t[0]=a,t[1]=n,t[2]=r,t}},{}],169:[function(g,S,M){S.exports={EPSILON:g("./epsilon"),create:g("./create"),clone:g("./clone"),angle:g("./angle"),fromValues:g("./fromValues"),copy:g("./copy"),set:g("./set"),equals:g("./equals"),exactEquals:g("./exactEquals"),add:g("./add"),subtract:g("./subtract"),sub:g("./sub"),multiply:g("./multiply"),mul:g("./mul"),divide:g("./divide"),div:g("./div"),min:g("./min"),max:g("./max"),floor:g("./floor"),ceil:g("./ceil"),round:g("./round"),scale:g("./scale"),scaleAndAdd:g("./scaleAndAdd"),distance:g("./distance"),dist:g("./dist"),squaredDistance:g("./squaredDistance"),sqrDist:g("./sqrDist"),length:g("./length"),len:g("./len"),squaredLength:g("./squaredLength"),sqrLen:g("./sqrLen"),negate:g("./negate"),inverse:g("./inverse"),normalize:g("./normalize"),dot:g("./dot"),cross:g("./cross"),lerp:g("./lerp"),random:g("./random"),transformMat4:g("./transformMat4"),transformMat3:g("./transformMat3"),transformQuat:g("./transformQuat"),rotateX:g("./rotateX"),rotateY:g("./rotateY"),rotateZ:g("./rotateZ"),forEach:g("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a}},{}],171:[function(g,S,M){S.exports=g("./length")},{"./length":172}],172:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2];return Math.sqrt(n*n+r*r+t*t)}},{}],173:[function(g,S,M){S.exports=e;function e(a,n,r,t){var h=n[0],s=n[1],i=n[2];return a[0]=h+t*(r[0]-h),a[1]=s+t*(r[1]-s),a[2]=i+t*(r[2]-i),a}},{}],174:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a}},{}],175:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a}},{}],176:[function(g,S,M){S.exports=g("./multiply")},{"./multiply":177}],177:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a}},{}],178:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a}},{}],179:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],h=n[2],s=r*r+t*t+h*h;return s>0&&(s=1/Math.sqrt(s),a[0]=n[0]*s,a[1]=n[1]*s,a[2]=n[2]*s),a}},{}],180:[function(g,S,M){S.exports=e;function e(a,n){n=n||1;var r=Math.random()*2*Math.PI,t=Math.random()*2-1,h=Math.sqrt(1-t*t)*n;return a[0]=Math.cos(r)*h,a[1]=Math.sin(r)*h,a[2]=t*n,a}},{}],181:[function(g,S,M){S.exports=e;function e(a,n,r,t){var h=r[1],s=r[2],i=n[1]-h,x=n[2]-s,p=Math.sin(t),v=Math.cos(t);return a[0]=n[0],a[1]=h+i*v-x*p,a[2]=s+i*p+x*v,a}},{}],182:[function(g,S,M){S.exports=e;function e(a,n,r,t){var h=r[0],s=r[2],i=n[0]-h,x=n[2]-s,p=Math.sin(t),v=Math.cos(t);return a[0]=h+x*p+i*v,a[1]=n[1],a[2]=s+x*v-i*p,a}},{}],183:[function(g,S,M){S.exports=e;function e(a,n,r,t){var h=r[0],s=r[1],i=n[0]-h,x=n[1]-s,p=Math.sin(t),v=Math.cos(t);return a[0]=h+i*v-x*p,a[1]=s+i*p+x*v,a[2]=n[2],a}},{}],184:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=Math.round(n[0]),a[1]=Math.round(n[1]),a[2]=Math.round(n[2]),a}},{}],185:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a}},{}],186:[function(g,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n[0]+r[0]*t,a[1]=n[1]+r[1]*t,a[2]=n[2]+r[2]*t,a}},{}],187:[function(g,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n,a[1]=r,a[2]=t,a}},{}],188:[function(g,S,M){S.exports=g("./squaredDistance")},{"./squaredDistance":190}],189:[function(g,S,M){S.exports=g("./squaredLength")},{"./squaredLength":191}],190:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],h=n[2]-a[2];return r*r+t*t+h*h}},{}],191:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2];return n*n+r*r+t*t}},{}],192:[function(g,S,M){S.exports=g("./subtract")},{"./subtract":193}],193:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a}},{}],194:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],h=n[1],s=n[2];return a[0]=t*r[0]+h*r[3]+s*r[6],a[1]=t*r[1]+h*r[4]+s*r[7],a[2]=t*r[2]+h*r[5]+s*r[8],a}},{}],195:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],h=n[1],s=n[2],i=r[3]*t+r[7]*h+r[11]*s+r[15];return i=i||1,a[0]=(r[0]*t+r[4]*h+r[8]*s+r[12])/i,a[1]=(r[1]*t+r[5]*h+r[9]*s+r[13])/i,a[2]=(r[2]*t+r[6]*h+r[10]*s+r[14])/i,a}},{}],196:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],h=n[1],s=n[2],i=r[0],x=r[1],p=r[2],v=r[3],f=v*t+x*s-p*h,d=v*h+p*t-i*s,o=v*s+i*h-x*t,m=-i*t-x*h-p*s;return a[0]=f*v+m*-i+d*-p-o*-x,a[1]=d*v+m*-x+o*-i-f*-p,a[2]=o*v+m*-p+f*-x-d*-i,a}},{}],197:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a[3]=n[3]+r[3],a}},{}],198:[function(g,S,M){S.exports=e;function e(a){var n=new Float32Array(4);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n}},{}],199:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a}},{}],200:[function(g,S,M){S.exports=e;function e(){var a=new Float32Array(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a}},{}],201:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],h=n[2]-a[2],s=n[3]-a[3];return Math.sqrt(r*r+t*t+h*h+s*s)}},{}],202:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a[3]=n[3]/r[3],a}},{}],203:[function(g,S,M){S.exports=e;function e(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]*n[3]}},{}],204:[function(g,S,M){S.exports=e;function e(a,n,r,t){var h=new Float32Array(4);return h[0]=a,h[1]=n,h[2]=r,h[3]=t,h}},{}],205:[function(g,S,M){S.exports={create:g("./create"),clone:g("./clone"),fromValues:g("./fromValues"),copy:g("./copy"),set:g("./set"),add:g("./add"),subtract:g("./subtract"),multiply:g("./multiply"),divide:g("./divide"),min:g("./min"),max:g("./max"),scale:g("./scale"),scaleAndAdd:g("./scaleAndAdd"),distance:g("./distance"),squaredDistance:g("./squaredDistance"),length:g("./length"),squaredLength:g("./squaredLength"),negate:g("./negate"),inverse:g("./inverse"),normalize:g("./normalize"),dot:g("./dot"),lerp:g("./lerp"),random:g("./random"),transformMat4:g("./transformMat4"),transformQuat:g("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a[3]=1/n[3],a}},{}],207:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],h=a[3];return Math.sqrt(n*n+r*r+t*t+h*h)}},{}],208:[function(g,S,M){S.exports=e;function e(a,n,r,t){var h=n[0],s=n[1],i=n[2],x=n[3];return a[0]=h+t*(r[0]-h),a[1]=s+t*(r[1]-s),a[2]=i+t*(r[2]-i),a[3]=x+t*(r[3]-x),a}},{}],209:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a[3]=Math.max(n[3],r[3]),a}},{}],210:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a[3]=Math.min(n[3],r[3]),a}},{}],211:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a[3]=n[3]*r[3],a}},{}],212:[function(g,S,M){S.exports=e;function e(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a[3]=-n[3],a}},{}],213:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0],t=n[1],h=n[2],s=n[3],i=r*r+t*t+h*h+s*s;return i>0&&(i=1/Math.sqrt(i),a[0]=r*i,a[1]=t*i,a[2]=h*i,a[3]=s*i),a}},{}],214:[function(g,S,M){var e=g("./normalize"),a=g("./scale");S.exports=n;function n(r,t){return t=t||1,r[0]=Math.random(),r[1]=Math.random(),r[2]=Math.random(),r[3]=Math.random(),e(r,r),a(r,r,t),r}},{"./normalize":213,"./scale":215}],215:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a[3]=n[3]*r,a}},{}],216:[function(g,S,M){S.exports=e;function e(a,n,r,t){return a[0]=n[0]+r[0]*t,a[1]=n[1]+r[1]*t,a[2]=n[2]+r[2]*t,a[3]=n[3]+r[3]*t,a}},{}],217:[function(g,S,M){S.exports=e;function e(a,n,r,t,h){return a[0]=n,a[1]=r,a[2]=t,a[3]=h,a}},{}],218:[function(g,S,M){S.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],h=n[2]-a[2],s=n[3]-a[3];return r*r+t*t+h*h+s*s}},{}],219:[function(g,S,M){S.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],h=a[3];return n*n+r*r+t*t+h*h}},{}],220:[function(g,S,M){S.exports=e;function e(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a[3]=n[3]-r[3],a}},{}],221:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],h=n[1],s=n[2],i=n[3];return a[0]=r[0]*t+r[4]*h+r[8]*s+r[12]*i,a[1]=r[1]*t+r[5]*h+r[9]*s+r[13]*i,a[2]=r[2]*t+r[6]*h+r[10]*s+r[14]*i,a[3]=r[3]*t+r[7]*h+r[11]*s+r[15]*i,a}},{}],222:[function(g,S,M){S.exports=e;function e(a,n,r){var t=n[0],h=n[1],s=n[2],i=r[0],x=r[1],p=r[2],v=r[3],f=v*t+x*s-p*h,d=v*h+p*t-i*s,o=v*s+i*h-x*t,m=-i*t-x*h-p*s;return a[0]=f*v+m*-i+d*-p-o*-x,a[1]=d*v+m*-x+o*-i-f*-p,a[2]=o*v+m*-p+f*-x-d*-i,a[3]=n[3],a}},{}],223:[function(g,S,M){var e=g("glsl-tokenizer"),a=g("atob-lite");S.exports=n;function n(r){for(var t=Array.isArray(r)?r:e(r),h=0;h<t.length;h++){var s=t[h];if(s.type==="preprocessor"){var i=s.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(i&&i[2]){var x=i[1],p=i[2];return(x?a(p):p).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(g,S,M){S.exports=u;var e=g("./lib/literals"),a=g("./lib/operators"),n=g("./lib/builtins"),r=g("./lib/literals-300es"),t=g("./lib/builtins-300es"),h=999,s=9999,i=0,x=1,p=2,v=3,f=4,d=5,o=6,m=7,l=8,w=9,_=10,c=11,b=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function u(L){var T=0,k=0,P=h,z,I,D=[],R=[],O=1,F=0,N=0,G=!1,K=!1,W="",Y;L=L||{};var re=n,ue=e;L.version==="300 es"&&(re=t,ue=r);for(var j={},q={},T=0;T<re.length;T++)j[re[T]]=!0;for(var T=0;T<ue.length;T++)q[ue[T]]=!0;return function(ge){return R=[],ge!==null?U(ge):$()};function H(ge){ge.length&&R.push({type:b[P],data:ge,position:N,line:O,column:F})}function U(ge){T=0,ge.toString&&(ge=ge.toString()),W+=ge.replace(/\r\n/g,`
`),Y=W.length;for(var me;z=W[T],T<Y;){switch(me=T,P){case i:T=se();break;case x:T=ie();break;case p:T=Q();break;case v:T=ae();break;case f:T=ce();break;case c:T=be();break;case d:T=de();break;case s:T=ye();break;case w:T=X();break;case h:T=ne();break}if(me!==T)switch(W[me]){case`
`:F=0,++O;break;default:++F;break}}return k+=T,W=W.slice(T),R}function $(ge){return D.length&&H(D.join("")),P=_,H("(eof)"),R}function ne(){return D=D.length?[]:D,I==="/"&&z==="*"?(N=k+T-1,P=i,I=z,T+1):I==="/"&&z==="/"?(N=k+T-1,P=x,I=z,T+1):z==="#"?(P=p,N=k+T,T):/\s/.test(z)?(P=w,N=k+T,T):(G=/\d/.test(z),K=/[^\w_]/.test(z),N=k+T,P=G?f:K?v:s,T)}function X(){return/[^\s]/g.test(z)?(H(D.join("")),P=h,T):(D.push(z),I=z,T+1)}function Q(){return(z==="\r"||z===`
`)&&I!=="\\"?(H(D.join("")),P=h,T):(D.push(z),I=z,T+1)}function ie(){return Q()}function se(){return z==="/"&&I==="*"?(D.push(z),H(D.join("")),P=h,T+1):(D.push(z),I=z,T+1)}function ae(){if(I==="."&&/\d/.test(z))return P=d,T;if(I==="/"&&z==="*")return P=i,T;if(I==="/"&&z==="/")return P=x,T;if(z==="."&&D.length){for(;oe(D););return P=d,T}if(z===";"||z===")"||z==="("){if(D.length)for(;oe(D););return H(z),P=h,T+1}var ge=D.length===2&&z!=="=";if(/[\w_\d\s]/.test(z)||ge){for(;oe(D););return P=h,T}return D.push(z),I=z,T+1}function oe(ge){var me=0,Ee,Pe;do{if(Ee=a.indexOf(ge.slice(0,ge.length+me).join("")),Pe=a[Ee],Ee===-1){if(me--+ge.length>0)continue;Pe=ge.slice(0,1).join("")}return H(Pe),N+=Pe.length,D=D.slice(Pe.length),D.length}while(1)}function be(){return/[^a-fA-F0-9]/.test(z)?(H(D.join("")),P=h,T):(D.push(z),I=z,T+1)}function ce(){return z==="."||/[eE]/.test(z)?(D.push(z),P=d,I=z,T+1):z==="x"&&D.length===1&&D[0]==="0"?(P=c,D.push(z),I=z,T+1):/[^\d]/.test(z)?(H(D.join("")),P=h,T):(D.push(z),I=z,T+1)}function de(){return z==="f"&&(D.push(z),I=z,T+=1),/[eE]/.test(z)||(z==="-"||z==="+")&&/[eE]/.test(I)?(D.push(z),I=z,T+1):/[^\d]/.test(z)?(H(D.join("")),P=h,T):(D.push(z),I=z,T+1)}function ye(){if(/[^\d\w_]/.test(z)){var ge=D.join("");return q[ge]?P=l:j[ge]?P=m:P=o,H(D.join("")),P=h,T}return D.push(z),I=z,T+1}}},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(g,S,M){var e=g("./builtins");e=e.slice().filter(function(a){return!/^(gl\_|texture)/.test(a)}),S.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(g,S,M){S.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(g,S,M){var e=g("./literals");S.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(g,S,M){S.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(g,S,M){S.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(g,S,M){var e=g("./index");S.exports=a;function a(n,r){var t=e(r),h=[];return h=h.concat(t(n)),h=h.concat(t(null)),h}},{"./index":224}],231:[function(g,S,M){S.exports=function(e){typeof e=="string"&&(e=[e]);for(var a=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],a[r]||"");return n.push(e[r]),n.join("")}},{}],232:[function(g,S,M){var e=g("is-browser");function a(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,r),window.removeEventListener("test",null,r)}catch{n=!1}return n}S.exports=e&&a()},{"is-browser":236}],233:[function(g,S,M){S.exports=v;var e=g("robust-orientation"),a=g("simplicial-complex").compareCells;function n(f,d,o){this.vertices=f,this.adjacent=d,this.boundary=o,this.lastVisited=-1}n.prototype.flip=function(){var f=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=f;var d=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=d};function r(f,d,o){this.vertices=f,this.cell=d,this.index=o}function t(f,d){return a(f.vertices,d.vertices)}function h(f){return function(){var d=this.tuple;return f.apply(this,d)}}function s(f){var d=e[f+1];return d||(d=e),h(d)}var i=[];function x(f,d,o){this.dimension=f,this.vertices=d,this.simplices=o,this.interior=o.filter(function(w){return!w.boundary}),this.tuple=new Array(f+1);for(var m=0;m<=f;++m)this.tuple[m]=this.vertices[m];var l=i[f];l||(l=i[f]=s(f)),this.orient=l}var p=x.prototype;p.handleBoundaryDegeneracy=function(f,d){var o=this.dimension,m=this.vertices.length-1,l=this.tuple,w=this.vertices,_=[f];for(f.lastVisited=-m;_.length>0;){f=_.pop();for(var c=f.adjacent,b=0;b<=o;++b){var u=c[b];if(!(!u.boundary||u.lastVisited<=-m)){for(var L=u.vertices,T=0;T<=o;++T){var k=L[T];k<0?l[T]=d:l[T]=w[k]}var P=this.orient();if(P>0)return u;u.lastVisited=-m,P===0&&_.push(u)}}}return null},p.walk=function(f,d){var o=this.vertices.length-1,m=this.dimension,l=this.vertices,w=this.tuple,_=d?this.interior.length*Math.random()|0:this.interior.length-1,c=this.interior[_];e:for(;!c.boundary;){for(var b=c.vertices,u=c.adjacent,L=0;L<=m;++L)w[L]=l[b[L]];c.lastVisited=o;for(var L=0;L<=m;++L){var T=u[L];if(!(T.lastVisited>=o)){var k=w[L];w[L]=f;var P=this.orient();if(w[L]=k,P<0){c=T;continue e}else T.boundary?T.lastVisited=-o:T.lastVisited=o}}return}return c},p.addPeaks=function(f,d){var o=this.vertices.length-1,m=this.dimension,l=this.vertices,w=this.tuple,_=this.interior,c=this.simplices,b=[d];d.lastVisited=o,d.vertices[d.vertices.indexOf(-1)]=o,d.boundary=!1,_.push(d);for(var u=[];b.length>0;){var d=b.pop(),L=d.vertices,T=d.adjacent,k=L.indexOf(o);if(!(k<0)){for(var P=0;P<=m;++P)if(P!==k){var z=T[P];if(!(!z.boundary||z.lastVisited>=o)){var I=z.vertices;if(z.lastVisited!==-o){for(var D=0,R=0;R<=m;++R)I[R]<0?(D=R,w[R]=f):w[R]=l[I[R]];var O=this.orient();if(O>0){I[D]=o,z.boundary=!1,_.push(z),b.push(z),z.lastVisited=o;continue}else z.lastVisited=-o}var F=z.adjacent,N=L.slice(),G=T.slice(),K=new n(N,G,!0);c.push(K);var W=F.indexOf(d);if(!(W<0)){F[W]=K,G[k]=z,N[P]=-1,G[P]=d,T[P]=K,K.flip();for(var R=0;R<=m;++R){var Y=N[R];if(!(Y<0||Y===o)){for(var re=new Array(m-1),ue=0,j=0;j<=m;++j){var q=N[j];q<0||j===R||(re[ue++]=q)}u.push(new r(re,K,R))}}}}}}}u.sort(t);for(var P=0;P+1<u.length;P+=2){var H=u[P],U=u[P+1],$=H.index,ne=U.index;$<0||ne<0||(H.cell.adjacent[H.index]=U.cell,U.cell.adjacent[U.index]=H.cell)}},p.insert=function(f,d){var o=this.vertices;o.push(f);var m=this.walk(f,d);if(m){for(var l=this.dimension,w=this.tuple,_=0;_<=l;++_){var c=m.vertices[_];c<0?w[_]=f:w[_]=o[c]}var b=this.orient(w);b<0||b===0&&(m=this.handleBoundaryDegeneracy(m,f),!m)||this.addPeaks(f,m)}},p.boundary=function(){for(var f=this.dimension,d=[],o=this.simplices,m=o.length,l=0;l<m;++l){var w=o[l];if(w.boundary){for(var _=new Array(f),c=w.vertices,b=0,u=0,L=0;L<=f;++L)c[L]>=0?_[b++]=c[L]:u=L&1;if(u===(f&1)){var T=_[0];_[0]=_[1],_[1]=T}d.push(_)}}return d};function v(f,d){var o=f.length;if(o===0)throw new Error("Must have at least d+1 points");var m=f[0].length;if(o<=m)throw new Error("Must input at least d+1 points");var l=f.slice(0,m+1),w=e.apply(void 0,l);if(w===0)throw new Error("Input not in general position");for(var _=new Array(m+1),c=0;c<=m;++c)_[c]=c;w<0&&(_[0]=1,_[1]=0);for(var b=new n(_,new Array(m+1),!1),u=b.adjacent,L=new Array(m+2),c=0;c<=m;++c){for(var T=_.slice(),k=0;k<=m;++k)k===c&&(T[k]=-1);var P=T[0];T[0]=T[1],T[1]=P;var z=new n(T,new Array(m+1),!0);u[c]=z,L[c]=z}L[m+1]=b;for(var c=0;c<=m;++c)for(var T=u[c].vertices,I=u[c].adjacent,k=0;k<=m;++k){var D=T[k];if(D<0){I[k]=b;continue}for(var R=0;R<=m;++R)u[R].vertices.indexOf(D)<0&&(I[k]=u[R])}for(var O=new x(m,l,L),F=!!d,c=m+1;c<o;++c)O.insert(f[c],F);return O.boundary()}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(g,S,M){var e=g("binary-search-bounds"),a=0,n=1,r=2;S.exports=b;function t(u,L,T,k,P){this.mid=u,this.left=L,this.right=T,this.leftPoints=k,this.rightPoints=P,this.count=(L?L.count:0)+(T?T.count:0)+k.length}var h=t.prototype;function s(u,L){u.mid=L.mid,u.left=L.left,u.right=L.right,u.leftPoints=L.leftPoints,u.rightPoints=L.rightPoints,u.count=L.count}function i(u,L){var T=w(L);u.mid=T.mid,u.left=T.left,u.right=T.right,u.leftPoints=T.leftPoints,u.rightPoints=T.rightPoints,u.count=T.count}function x(u,L){var T=u.intervals([]);T.push(L),i(u,T)}function p(u,L){var T=u.intervals([]),k=T.indexOf(L);return k<0?a:(T.splice(k,1),i(u,T),n)}h.intervals=function(u){return u.push.apply(u,this.leftPoints),this.left&&this.left.intervals(u),this.right&&this.right.intervals(u),u},h.insert=function(u){var L=this.count-this.leftPoints.length;if(this.count+=1,u[1]<this.mid)this.left?4*(this.left.count+1)>3*(L+1)?x(this,u):this.left.insert(u):this.left=w([u]);else if(u[0]>this.mid)this.right?4*(this.right.count+1)>3*(L+1)?x(this,u):this.right.insert(u):this.right=w([u]);else{var T=e.ge(this.leftPoints,u,m),k=e.ge(this.rightPoints,u,l);this.leftPoints.splice(T,0,u),this.rightPoints.splice(k,0,u)}},h.remove=function(u){var L=this.count-this.leftPoints;if(u[1]<this.mid){if(!this.left)return a;var T=this.right?this.right.count:0;if(4*T>3*(L-1))return p(this,u);var k=this.left.remove(u);return k===r?(this.left=null,this.count-=1,n):(k===n&&(this.count-=1),k)}else if(u[0]>this.mid){if(!this.right)return a;var P=this.left?this.left.count:0;if(4*P>3*(L-1))return p(this,u);var k=this.right.remove(u);return k===r?(this.right=null,this.count-=1,n):(k===n&&(this.count-=1),k)}else{if(this.count===1)return this.leftPoints[0]===u?r:a;if(this.leftPoints.length===1&&this.leftPoints[0]===u){if(this.left&&this.right){for(var z=this,I=this.left;I.right;)z=I,I=I.right;if(z===this)I.right=this.right;else{var D=this.left,k=this.right;z.count-=I.count,z.right=I.left,I.left=D,I.right=k}s(this,I),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?s(this,this.left):s(this,this.right);return n}for(var D=e.ge(this.leftPoints,u,m);D<this.leftPoints.length&&this.leftPoints[D][0]===u[0];++D)if(this.leftPoints[D]===u){this.count-=1,this.leftPoints.splice(D,1);for(var k=e.ge(this.rightPoints,u,l);k<this.rightPoints.length&&this.rightPoints[k][1]===u[1];++k)if(this.rightPoints[k]===u)return this.rightPoints.splice(k,1),n}return a}};function v(u,L,T){for(var k=0;k<u.length&&u[k][0]<=L;++k){var P=T(u[k]);if(P)return P}}function f(u,L,T){for(var k=u.length-1;k>=0&&u[k][1]>=L;--k){var P=T(u[k]);if(P)return P}}function d(u,L){for(var T=0;T<u.length;++T){var k=L(u[T]);if(k)return k}}h.queryPoint=function(u,L){if(u<this.mid){if(this.left){var T=this.left.queryPoint(u,L);if(T)return T}return v(this.leftPoints,u,L)}else if(u>this.mid){if(this.right){var T=this.right.queryPoint(u,L);if(T)return T}return f(this.rightPoints,u,L)}else return d(this.leftPoints,L)},h.queryInterval=function(u,L,T){if(u<this.mid&&this.left){var k=this.left.queryInterval(u,L,T);if(k)return k}if(L>this.mid&&this.right){var k=this.right.queryInterval(u,L,T);if(k)return k}return L<this.mid?v(this.leftPoints,L,T):u>this.mid?f(this.rightPoints,u,T):d(this.leftPoints,T)};function o(u,L){return u-L}function m(u,L){var T=u[0]-L[0];return T||u[1]-L[1]}function l(u,L){var T=u[1]-L[1];return T||u[0]-L[0]}function w(u){if(u.length===0)return null;for(var L=[],T=0;T<u.length;++T)L.push(u[T][0],u[T][1]);L.sort(o);for(var k=L[L.length>>1],P=[],z=[],I=[],T=0;T<u.length;++T){var D=u[T];D[1]<k?P.push(D):k<D[0]?z.push(D):I.push(D)}var R=I,O=I.slice();return R.sort(m),O.sort(l),new t(k,w(P),w(z),R,O)}function _(u){this.root=u}var c=_.prototype;c.insert=function(u){this.root?this.root.insert(u):this.root=new t(u[0],null,null,[u],[u])},c.remove=function(u){if(this.root){var L=this.root.remove(u);return L===r&&(this.root=null),L!==a}return!1},c.queryPoint=function(u,L){if(this.root)return this.root.queryPoint(u,L)},c.queryInterval=function(u,L,T){if(u<=L&&this.root)return this.root.queryInterval(u,L,T)},Object.defineProperty(c,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(c,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function b(u){return!u||u.length===0?new _(null):new _(w(u))}},{"binary-search-bounds":31}],235:[function(g,S,M){function e(a){for(var n=new Array(a),r=0;r<a;++r)n[r]=r;return n}S.exports=e},{}],236:[function(g,S,M){S.exports=!0},{}],237:[function(g,S,M){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */S.exports=function(n){return n!=null&&(e(n)||a(n)||!!n._isBuffer)};function e(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function a(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&e(n.slice(0,0))}},{}],238:[function(g,S,M){S.exports=n,S.exports.isMobile=n,S.exports.default=n;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function n(r){r||(r={});var t=r.ua;if(!t&&typeof navigator<"u"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;var h=r.tablet?a.test(t):e.test(t);return!h&&r.tablet&&r.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(h=!0),h}},{}],239:[function(g,S,M){S.exports=function(e){for(var a=e.length,n,r=0;r<a;r++)if(n=e.charCodeAt(r),(n<9||n>13)&&n!==32&&n!==133&&n!==160&&n!==5760&&n!==6158&&(n<8192||n>8205)&&n!==8232&&n!==8233&&n!==8239&&n!==8287&&n!==8288&&n!==12288&&n!==65279)return!1;return!0}},{}],240:[function(g,S,M){function e(a,n,r){return a*(1-r)+n*r}S.exports=e},{}],241:[function(g,S,M){var e=g("./normalize"),a=g("gl-mat4/create"),n=g("gl-mat4/clone"),r=g("gl-mat4/determinant"),t=g("gl-mat4/invert"),h=g("gl-mat4/transpose"),s={length:g("gl-vec3/length"),normalize:g("gl-vec3/normalize"),dot:g("gl-vec3/dot"),cross:g("gl-vec3/cross")},i=a(),x=a(),p=[0,0,0,0],v=[[0,0,0],[0,0,0],[0,0,0]],f=[0,0,0];S.exports=function(w,_,c,b,u,L){if(_||(_=[0,0,0]),c||(c=[0,0,0]),b||(b=[0,0,0]),u||(u=[0,0,0,1]),L||(L=[0,0,0,1]),!e(i,w)||(n(x,i),x[3]=0,x[7]=0,x[11]=0,x[15]=1,Math.abs(r(x)<1e-8)))return!1;var T=i[3],k=i[7],P=i[11],z=i[12],I=i[13],D=i[14],R=i[15];if(T!==0||k!==0||P!==0){p[0]=T,p[1]=k,p[2]=P,p[3]=R;var O=t(x,x);if(!O)return!1;h(x,x),d(u,p,x)}else u[0]=u[1]=u[2]=0,u[3]=1;if(_[0]=z,_[1]=I,_[2]=D,o(v,i),c[0]=s.length(v[0]),s.normalize(v[0],v[0]),b[0]=s.dot(v[0],v[1]),m(v[1],v[1],v[0],1,-b[0]),c[1]=s.length(v[1]),s.normalize(v[1],v[1]),b[0]/=c[1],b[1]=s.dot(v[0],v[2]),m(v[2],v[2],v[0],1,-b[1]),b[2]=s.dot(v[1],v[2]),m(v[2],v[2],v[1],1,-b[2]),c[2]=s.length(v[2]),s.normalize(v[2],v[2]),b[1]/=c[2],b[2]/=c[2],s.cross(f,v[1],v[2]),s.dot(v[0],f)<0)for(var F=0;F<3;F++)c[F]*=-1,v[F][0]*=-1,v[F][1]*=-1,v[F][2]*=-1;return L[0]=.5*Math.sqrt(Math.max(1+v[0][0]-v[1][1]-v[2][2],0)),L[1]=.5*Math.sqrt(Math.max(1-v[0][0]+v[1][1]-v[2][2],0)),L[2]=.5*Math.sqrt(Math.max(1-v[0][0]-v[1][1]+v[2][2],0)),L[3]=.5*Math.sqrt(Math.max(1+v[0][0]+v[1][1]+v[2][2],0)),v[2][1]>v[1][2]&&(L[0]=-L[0]),v[0][2]>v[2][0]&&(L[1]=-L[1]),v[1][0]>v[0][1]&&(L[2]=-L[2]),!0};function d(l,w,_){var c=w[0],b=w[1],u=w[2],L=w[3];return l[0]=_[0]*c+_[4]*b+_[8]*u+_[12]*L,l[1]=_[1]*c+_[5]*b+_[9]*u+_[13]*L,l[2]=_[2]*c+_[6]*b+_[10]*u+_[14]*L,l[3]=_[3]*c+_[7]*b+_[11]*u+_[15]*L,l}function o(l,w){l[0][0]=w[0],l[0][1]=w[1],l[0][2]=w[2],l[1][0]=w[4],l[1][1]=w[5],l[1][2]=w[6],l[2][0]=w[8],l[2][1]=w[9],l[2][2]=w[10]}function m(l,w,_,c,b){l[0]=w[0]*c+_[0]*b,l[1]=w[1]*c+_[1]*b,l[2]=w[2]*c+_[2]*b}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(g,S,M){S.exports=function(a,n){var r=n[15];if(r===0)return!1;for(var t=1/r,h=0;h<16;h++)a[h]=n[h]*t;return!0}},{}],243:[function(g,S,M){var e=g("gl-vec3/lerp"),a=g("mat4-recompose"),n=g("mat4-decompose"),r=g("gl-mat4/determinant"),t=g("quat-slerp"),h=p(),s=p(),i=p();S.exports=x;function x(d,o,m,l){if(r(o)===0||r(m)===0)return!1;var w=n(o,h.translate,h.scale,h.skew,h.perspective,h.quaternion),_=n(m,s.translate,s.scale,s.skew,s.perspective,s.quaternion);return!w||!_?!1:(e(i.translate,h.translate,s.translate,l),e(i.skew,h.skew,s.skew,l),e(i.scale,h.scale,s.scale,l),e(i.perspective,h.perspective,s.perspective,l),t(i.quaternion,h.quaternion,s.quaternion,l),a(d,i.translate,i.scale,i.skew,i.perspective,i.quaternion),!0)}function p(){return{translate:v(),scale:v(1),skew:v(),perspective:f(),quaternion:f()}}function v(d){return[d||0,d||0,d||0]}function f(){return[0,0,0,1]}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(g,S,M){var e={identity:g("gl-mat4/identity"),translate:g("gl-mat4/translate"),multiply:g("gl-mat4/multiply"),create:g("gl-mat4/create"),scale:g("gl-mat4/scale"),fromRotationTranslation:g("gl-mat4/fromRotationTranslation")};e.create();var a=e.create();S.exports=function(r,t,h,s,i,x){return e.identity(r),e.fromRotationTranslation(r,x,t),r[3]=i[0],r[7]=i[1],r[11]=i[2],r[15]=i[3],e.identity(a),s[2]!==0&&(a[9]=s[2],e.multiply(r,r,a)),s[1]!==0&&(a[9]=0,a[8]=s[1],e.multiply(r,r,a)),s[0]!==0&&(a[8]=0,a[4]=s[0],e.multiply(r,r,a)),e.scale(r,r,h),r}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(g,S,M){var e=g("binary-search-bounds"),a=g("mat4-interpolate"),n=g("gl-mat4/invert"),r=g("gl-mat4/rotateX"),t=g("gl-mat4/rotateY"),h=g("gl-mat4/rotateZ"),s=g("gl-mat4/lookAt"),i=g("gl-mat4/translate");g("gl-mat4/scale");var x=g("gl-vec3/normalize"),p=[0,0,0];S.exports=o;function v(m){this._components=m.slice(),this._time=[0],this.prevMatrix=m.slice(),this.nextMatrix=m.slice(),this.computedMatrix=m.slice(),this.computedInverse=m.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}var f=v.prototype;f.recalcMatrix=function(m){var l=this._time,w=e.le(l,m),_=this.computedMatrix;if(!(w<0)){var c=this._components;if(w===l.length-1)for(var b=16*w,u=0;u<16;++u)_[u]=c[b++];else{for(var L=l[w+1]-l[w],b=16*w,T=this.prevMatrix,k=!0,u=0;u<16;++u)T[u]=c[b++];for(var P=this.nextMatrix,u=0;u<16;++u)P[u]=c[b++],k=k&&T[u]===P[u];if(L<1e-6||k)for(var u=0;u<16;++u)_[u]=T[u];else a(_,T,P,(m-l[w])/L)}var z=this.computedUp;z[0]=_[1],z[1]=_[5],z[2]=_[9],x(z,z);var I=this.computedInverse;n(I,_);var D=this.computedEye,R=I[15];D[0]=I[12]/R,D[1]=I[13]/R,D[2]=I[14]/R;for(var O=this.computedCenter,F=Math.exp(this.computedRadius[0]),u=0;u<3;++u)O[u]=D[u]-_[2+4*u]*F}},f.idle=function(m){if(!(m<this.lastT())){for(var l=this._components,w=l.length-16,_=0;_<16;++_)l.push(l[w++]);this._time.push(m)}},f.flush=function(m){var l=e.gt(this._time,m)-2;l<0||(this._time.splice(0,l),this._components.splice(0,16*l))},f.lastT=function(){return this._time[this._time.length-1]},f.lookAt=function(m,l,w,_){this.recalcMatrix(m),l=l||this.computedEye,w=w||p,_=_||this.computedUp,this.setMatrix(m,s(this.computedMatrix,l,w,_));for(var c=0,b=0;b<3;++b)c+=Math.pow(w[b]-l[b],2);c=Math.log(Math.sqrt(c)),this.computedRadius[0]=c},f.rotate=function(m,l,w,_){this.recalcMatrix(m);var c=this.computedInverse;l&&t(c,c,l),w&&r(c,c,w),_&&h(c,c,_),this.setMatrix(m,n(this.computedMatrix,c))};var d=[0,0,0];f.pan=function(m,l,w,_){d[0]=-(l||0),d[1]=-(w||0),d[2]=-(_||0),this.recalcMatrix(m);var c=this.computedInverse;i(c,c,d),this.setMatrix(m,n(c,c))},f.translate=function(m,l,w,_){d[0]=l||0,d[1]=w||0,d[2]=_||0,this.recalcMatrix(m);var c=this.computedMatrix;i(c,c,d),this.setMatrix(m,c)},f.setMatrix=function(m,l){if(!(m<this.lastT())){this._time.push(m);for(var w=0;w<16;++w)this._components.push(l[w])}},f.setDistance=function(m,l){this.computedRadius[0]=l},f.setDistanceLimits=function(m,l){var w=this._limits;w[0]=m,w[1]=l},f.getDistanceLimits=function(m){var l=this._limits;return m?(m[0]=l[0],m[1]=l[1],m):l};function o(m){m=m||{};var l=m.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new v(l)}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(g,S,M){S.exports=a;var e=g("robust-orientation")[3];function a(n){var r=n.length;if(r<3){for(var f=new Array(r),t=0;t<r;++t)f[t]=t;return r===2&&n[0][0]===n[1][0]&&n[0][1]===n[1][1]?[0]:f}for(var h=new Array(r),t=0;t<r;++t)h[t]=t;h.sort(function(l,w){var _=n[l][0]-n[w][0];return _||n[l][1]-n[w][1]});for(var s=[h[0],h[1]],i=[h[0],h[1]],t=2;t<r;++t){for(var x=h[t],p=n[x],v=s.length;v>1&&e(n[s[v-2]],n[s[v-1]],p)<=0;)v-=1,s.pop();for(s.push(x),v=i.length;v>1&&e(n[i[v-2]],n[i[v-1]],p)>=0;)v-=1,i.pop();i.push(x)}for(var f=new Array(i.length+s.length-2),d=0,t=0,o=s.length;t<o;++t)f[d++]=s[t];for(var m=i.length-2;m>0;--m)f[d++]=i[m];return f}},{"robust-orientation":284}],247:[function(g,S,M){S.exports=a;var e=g("mouse-event");function a(n,r){r||(r=n,n=window);var t=0,h=0,s=0,i={shift:!1,alt:!1,control:!1,meta:!1},x=!1;function p(u){var L=!1;return"altKey"in u&&(L=L||u.altKey!==i.alt,i.alt=!!u.altKey),"shiftKey"in u&&(L=L||u.shiftKey!==i.shift,i.shift=!!u.shiftKey),"ctrlKey"in u&&(L=L||u.ctrlKey!==i.control,i.control=!!u.ctrlKey),"metaKey"in u&&(L=L||u.metaKey!==i.meta,i.meta=!!u.metaKey),L}function v(u,L){var T=e.x(L),k=e.y(L);"buttons"in L&&(u=L.buttons|0),(u!==t||T!==h||k!==s||p(L))&&(t=u|0,h=T||0,s=k||0,r&&r(t,h,s,i))}function f(u){v(0,u)}function d(){(t||h||s||i.shift||i.alt||i.meta||i.control)&&(h=s=0,t=0,i.shift=i.alt=i.control=i.meta=!1,r&&r(0,0,0,i))}function o(u){p(u)&&r&&r(t,h,s,i)}function m(u){e.buttons(u)===0?v(0,u):v(t,u)}function l(u){v(t|e.buttons(u),u)}function w(u){v(t&~e.buttons(u),u)}function _(){x||(x=!0,n.addEventListener("mousemove",m),n.addEventListener("mousedown",l),n.addEventListener("mouseup",w),n.addEventListener("mouseleave",f),n.addEventListener("mouseenter",f),n.addEventListener("mouseout",f),n.addEventListener("mouseover",f),n.addEventListener("blur",d),n.addEventListener("keyup",o),n.addEventListener("keydown",o),n.addEventListener("keypress",o),n!==window&&(window.addEventListener("blur",d),window.addEventListener("keyup",o),window.addEventListener("keydown",o),window.addEventListener("keypress",o)))}function c(){x&&(x=!1,n.removeEventListener("mousemove",m),n.removeEventListener("mousedown",l),n.removeEventListener("mouseup",w),n.removeEventListener("mouseleave",f),n.removeEventListener("mouseenter",f),n.removeEventListener("mouseout",f),n.removeEventListener("mouseover",f),n.removeEventListener("blur",d),n.removeEventListener("keyup",o),n.removeEventListener("keydown",o),n.removeEventListener("keypress",o),n!==window&&(window.removeEventListener("blur",d),window.removeEventListener("keyup",o),window.removeEventListener("keydown",o),window.removeEventListener("keypress",o)))}_();var b={element:n};return Object.defineProperties(b,{enabled:{get:function(){return x},set:function(u){u?_():c()},enumerable:!0},buttons:{get:function(){return t},enumerable:!0},x:{get:function(){return h},enumerable:!0},y:{get:function(){return s},enumerable:!0},mods:{get:function(){return i},enumerable:!0}}),b}},{"mouse-event":249}],248:[function(g,S,M){var e={left:0,top:0};S.exports=a;function a(r,t,h){t=t||r.currentTarget||r.srcElement,Array.isArray(h)||(h=[0,0]);var s=r.clientX||0,i=r.clientY||0,x=n(t);return h[0]=s-x.left,h[1]=i-x.top,h}function n(r){return r===window||r===document||r===document.body?e:r.getBoundingClientRect()}},{}],249:[function(g,S,M){function e(t){if(typeof t=="object"){if("buttons"in t)return t.buttons;if("which"in t){var h=t.which;if(h===2)return 4;if(h===3)return 2;if(h>0)return 1<<h-1}else if("button"in t){var h=t.button;if(h===1)return 4;if(h===2)return 2;if(h>=0)return 1<<h}}return 0}M.buttons=e;function a(t){return t.target||t.srcElement||window}M.element=a;function n(t){if(typeof t=="object"){if("offsetX"in t)return t.offsetX;var h=a(t),s=h.getBoundingClientRect();return t.clientX-s.left}return 0}M.x=n;function r(t){if(typeof t=="object"){if("offsetY"in t)return t.offsetY;var h=a(t),s=h.getBoundingClientRect();return t.clientY-s.top}return 0}M.y=r},{}],250:[function(g,S,M){var e=g("to-px");S.exports=a;function a(n,r,t){typeof n=="function"&&(t=!!r,r=n,n=window);var h=e("ex",n),s=function(i){t&&i.preventDefault();var x=i.deltaX||0,p=i.deltaY||0,v=i.deltaZ||0,f=i.deltaMode,d=1;switch(f){case 1:d=h;break;case 2:d=window.innerHeight;break}if(x*=d,p*=d,v*=d,x||p||v)return r(x,p,v,i)};return n.addEventListener("wheel",s),s}},{"to-px":304}],251:[function(g,S,M){var e=g("typedarray-pool");S.exports=r;var a={"false,0,1":function(h,s,i,x,p){return function(f,d,o,m){var l=f.shape[0]|0,w=f.shape[1]|0,_=f.data,c=f.offset|0,b=f.stride[0]|0,u=f.stride[1]|0,L=c,T,k=-b|0,P=0,z=-u|0,I=0,D=-b-u|0,R=0,O=b|0,F=u-b*l|0,N=0,G=0,K=0,W=2*l|0,Y=x(W),re=x(W),ue=0,j=0,q=-1,H=-1,U=0,$=-l|0,ne=l|0,X=0,Q=-l-1|0,ie=l-1|0,se=0,ae=0,oe=0;for(N=0;N<l;++N)Y[ue++]=i(_[L],d,o,m),L+=O;if(L+=F,w>0){if(G=1,Y[ue++]=i(_[L],d,o,m),L+=O,l>0)for(N=1,T=_[L],j=Y[ue]=i(T,d,o,m),U=Y[ue+q],X=Y[ue+$],se=Y[ue+Q],(j!==U||j!==X||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],h(N,G,T,P,I,R,j,U,X,se,d,o,m),ae=re[ue]=K++),ue+=1,L+=O,N=2;N<l;++N)T=_[L],j=Y[ue]=i(T,d,o,m),U=Y[ue+q],X=Y[ue+$],se=Y[ue+Q],(j!==U||j!==X||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],h(N,G,T,P,I,R,j,U,X,se,d,o,m),ae=re[ue]=K++,se!==U&&s(re[ue+q],ae,R,P,se,U,d,o,m)),ue+=1,L+=O;for(L+=F,ue=0,oe=q,q=H,H=oe,oe=$,$=ne,ne=oe,oe=Q,Q=ie,ie=oe,G=2;G<w;++G){if(Y[ue++]=i(_[L],d,o,m),L+=O,l>0)for(N=1,T=_[L],j=Y[ue]=i(T,d,o,m),U=Y[ue+q],X=Y[ue+$],se=Y[ue+Q],(j!==U||j!==X||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],h(N,G,T,P,I,R,j,U,X,se,d,o,m),ae=re[ue]=K++,se!==X&&s(re[ue+$],ae,I,R,X,se,d,o,m)),ue+=1,L+=O,N=2;N<l;++N)T=_[L],j=Y[ue]=i(T,d,o,m),U=Y[ue+q],X=Y[ue+$],se=Y[ue+Q],(j!==U||j!==X||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],h(N,G,T,P,I,R,j,U,X,se,d,o,m),ae=re[ue]=K++,se!==X&&s(re[ue+$],ae,I,R,X,se,d,o,m),se!==U&&s(re[ue+q],ae,R,P,se,U,d,o,m)),ue+=1,L+=O;G&1&&(ue=0),oe=q,q=H,H=oe,oe=$,$=ne,ne=oe,oe=Q,Q=ie,ie=oe,L+=F}}p(re),p(Y)}},"false,1,0":function(h,s,i,x,p){return function(f,d,o,m){var l=f.shape[0]|0,w=f.shape[1]|0,_=f.data,c=f.offset|0,b=f.stride[0]|0,u=f.stride[1]|0,L=c,T,k=-b|0,P=0,z=-u|0,I=0,D=-b-u|0,R=0,O=u|0,F=b-u*w|0,N=0,G=0,K=0,W=2*w|0,Y=x(W),re=x(W),ue=0,j=0,q=-1,H=-1,U=0,$=-w|0,ne=w|0,X=0,Q=-w-1|0,ie=w-1|0,se=0,ae=0,oe=0;for(G=0;G<w;++G)Y[ue++]=i(_[L],d,o,m),L+=O;if(L+=F,l>0){if(N=1,Y[ue++]=i(_[L],d,o,m),L+=O,w>0)for(G=1,T=_[L],j=Y[ue]=i(T,d,o,m),X=Y[ue+$],U=Y[ue+q],se=Y[ue+Q],(j!==X||j!==U||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],h(N,G,T,P,I,R,j,X,U,se,d,o,m),ae=re[ue]=K++),ue+=1,L+=O,G=2;G<w;++G)T=_[L],j=Y[ue]=i(T,d,o,m),X=Y[ue+$],U=Y[ue+q],se=Y[ue+Q],(j!==X||j!==U||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],h(N,G,T,P,I,R,j,X,U,se,d,o,m),ae=re[ue]=K++,se!==U&&s(re[ue+q],ae,I,R,U,se,d,o,m)),ue+=1,L+=O;for(L+=F,ue=0,oe=$,$=ne,ne=oe,oe=q,q=H,H=oe,oe=Q,Q=ie,ie=oe,N=2;N<l;++N){if(Y[ue++]=i(_[L],d,o,m),L+=O,w>0)for(G=1,T=_[L],j=Y[ue]=i(T,d,o,m),X=Y[ue+$],U=Y[ue+q],se=Y[ue+Q],(j!==X||j!==U||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],h(N,G,T,P,I,R,j,X,U,se,d,o,m),ae=re[ue]=K++,se!==X&&s(re[ue+$],ae,R,P,se,X,d,o,m)),ue+=1,L+=O,G=2;G<w;++G)T=_[L],j=Y[ue]=i(T,d,o,m),X=Y[ue+$],U=Y[ue+q],se=Y[ue+Q],(j!==X||j!==U||j!==se)&&(P=_[L+k],I=_[L+z],R=_[L+D],h(N,G,T,P,I,R,j,X,U,se,d,o,m),ae=re[ue]=K++,se!==U&&s(re[ue+q],ae,I,R,U,se,d,o,m),se!==X&&s(re[ue+$],ae,R,P,se,X,d,o,m)),ue+=1,L+=O;N&1&&(ue=0),oe=$,$=ne,ne=oe,oe=q,q=H,H=oe,oe=Q,Q=ie,ie=oe,L+=F}}p(re),p(Y)}}};function n(t,h,s,i,x,p){var v=[p,x].join(","),f=a[v];return f(t,h,s,e.mallocUint32,e.freeUint32)}function r(t){function h(d){throw new Error("ndarray-extract-contour: "+d)}typeof t!="object"&&h("Must specify arguments");var s=t.order;Array.isArray(s)||h("Must specify order");var i=t.arrayArguments||1;i<1&&h("Must have at least one array argument");var x=t.scalarArguments||0;x<0&&h("Scalar arg count must be > 0"),typeof t.vertex!="function"&&h("Must specify vertex creation function"),typeof t.cell!="function"&&h("Must specify cell creation function"),typeof t.phase!="function"&&h("Must specify phase function");for(var p=t.getters||[],v=new Array(i),f=0;f<i;++f)p.indexOf(f)>=0?v[f]=!0:v[f]=!1;return n(t.vertex,t.cell,t.phase,x,s,v)}},{"typedarray-pool":308}],252:[function(g,S,M){var e=g("dup"),a={zero:function(o,m,l,w){var _=o[0],c=l[0];w|=0;var b=0,u=c;for(b=0;b<_;++b)m[w]=0,w+=u},fdTemplate1:function(o,m,l,w,_,c,b){var u=o[0],L=l[0],T=c[0],k=-1*L,P=L;w|=0,b|=0;var z=0,I=L,D=T;for(z=0;z<u;++z)_[b]=.5*(m[w+k]-m[w+P]),w+=I,b+=D},fdTemplate2:function(o,m,l,w,_,c,b,u,L,T){var k=o[0],P=o[1],z=l[0],I=l[1],D=c[0],R=c[1],O=L[0],F=L[1],N=-1*z,G=z,K=-1*I,W=I;w|=0,b|=0,T|=0;var Y=0,re=0,ue=I,j=z-P*I,q=R,H=D-P*R,U=F,$=O-P*F;for(re=0;re<k;++re){for(Y=0;Y<P;++Y)_[b]=.5*(m[w+N]-m[w+G]),u[T]=.5*(m[w+K]-m[w+W]),w+=ue,b+=q,T+=U;w+=j,b+=H,T+=$}}},n={cdiff:function(o){var m={};return function(w,_,c){var b=w.dtype,u=w.order,L=_.dtype,T=_.order,k=c.dtype,P=c.order,z=[b,u.join(),L,T.join(),k,P.join()].join(),I=m[z];return I||(m[z]=I=o([b,u,L,T,k,P])),I(w.shape.slice(0),w.data,w.stride,w.offset|0,_.data,_.stride,_.offset|0,c.data,c.stride,c.offset|0)}},zero:function(o){var m={};return function(w){var _=w.dtype,c=w.order,b=[_,c.join()].join(),u=m[b];return u||(m[b]=u=o([_,c])),u(w.shape.slice(0),w.data,w.stride,w.offset|0)}},fdTemplate1:function(o){var m={};return function(w,_){var c=w.dtype,b=w.order,u=_.dtype,L=_.order,T=[c,b.join(),u,L.join()].join(),k=m[T];return k||(m[T]=k=o([c,b,u,L])),k(w.shape.slice(0),w.data,w.stride,w.offset|0,_.data,_.stride,_.offset|0)}},fdTemplate2:function(o){var m={};return function(w,_,c){var b=w.dtype,u=w.order,L=_.dtype,T=_.order,k=c.dtype,P=c.order,z=[b,u.join(),L,T.join(),k,P.join()].join(),I=m[z];return I||(m[z]=I=o([b,u,L,T,k,P])),I(w.shape.slice(0),w.data,w.stride,w.offset|0,_.data,_.stride,_.offset|0,c.data,c.stride,c.offset|0)}}};function r(o){var m=n[o.funcName];return m(t.bind(void 0,o))}function t(o){return a[o.funcName]}function h(o){return r({funcName:o.funcName})}var s={},i={},x=h({funcName:"cdiff"}),p=h({funcName:"zero"});function v(o){return o in s?s[o]:s[o]=h({funcName:"fdTemplate"+o})}function f(o,m,l,w){return function(_,c){var b=c.shape.slice();return b[0]>2&&b[1]>2&&w(c.pick(-1,-1).lo(1,1).hi(b[0]-2,b[1]-2),_.pick(-1,-1,0).lo(1,1).hi(b[0]-2,b[1]-2),_.pick(-1,-1,1).lo(1,1).hi(b[0]-2,b[1]-2)),b[1]>2&&(l(c.pick(0,-1).lo(1).hi(b[1]-2),_.pick(0,-1,1).lo(1).hi(b[1]-2)),m(_.pick(0,-1,0).lo(1).hi(b[1]-2))),b[1]>2&&(l(c.pick(b[0]-1,-1).lo(1).hi(b[1]-2),_.pick(b[0]-1,-1,1).lo(1).hi(b[1]-2)),m(_.pick(b[0]-1,-1,0).lo(1).hi(b[1]-2))),b[0]>2&&(l(c.pick(-1,0).lo(1).hi(b[0]-2),_.pick(-1,0,0).lo(1).hi(b[0]-2)),m(_.pick(-1,0,1).lo(1).hi(b[0]-2))),b[0]>2&&(l(c.pick(-1,b[1]-1).lo(1).hi(b[0]-2),_.pick(-1,b[1]-1,0).lo(1).hi(b[0]-2)),m(_.pick(-1,b[1]-1,1).lo(1).hi(b[0]-2))),_.set(0,0,0,0),_.set(0,0,1,0),_.set(b[0]-1,0,0,0),_.set(b[0]-1,0,1,0),_.set(0,b[1]-1,0,0),_.set(0,b[1]-1,1,0),_.set(b[0]-1,b[1]-1,0,0),_.set(b[0]-1,b[1]-1,1,0),_}}function d(o){var m=o.join(),b=i[m];if(b)return b;for(var l=o.length,w=[x,p],_=1;_<=l;++_)w.push(v(_));var c=f,b=c.apply(void 0,w);return i[m]=b,b}S.exports=function(m,l,w){if(Array.isArray(w)||(typeof w=="string"?w=e(l.dimension,w):w=e(l.dimension,"clamp")),l.size===0)return m;if(l.dimension===0)return m.set(0),m;var _=d(w);return _(m,l)}},{dup:65}],253:[function(g,S,M){function e(h,s){var i=Math.floor(s),x=s-i,p=0<=i&&i<h.shape[0],v=0<=i+1&&i+1<h.shape[0],f=p?+h.get(i):0,d=v?+h.get(i+1):0;return(1-x)*f+x*d}function a(h,s,i){var x=Math.floor(s),p=s-x,v=0<=x&&x<h.shape[0],f=0<=x+1&&x+1<h.shape[0],d=Math.floor(i),o=i-d,m=0<=d&&d<h.shape[1],l=0<=d+1&&d+1<h.shape[1],w=v&&m?h.get(x,d):0,_=v&&l?h.get(x,d+1):0,c=f&&m?h.get(x+1,d):0,b=f&&l?h.get(x+1,d+1):0;return(1-o)*((1-p)*w+p*c)+o*((1-p)*_+p*b)}function n(h,s,i,x){var p=Math.floor(s),v=s-p,f=0<=p&&p<h.shape[0],d=0<=p+1&&p+1<h.shape[0],o=Math.floor(i),m=i-o,l=0<=o&&o<h.shape[1],w=0<=o+1&&o+1<h.shape[1],_=Math.floor(x),c=x-_,b=0<=_&&_<h.shape[2],u=0<=_+1&&_+1<h.shape[2],L=f&&l&&b?h.get(p,o,_):0,T=f&&w&&b?h.get(p,o+1,_):0,k=d&&l&&b?h.get(p+1,o,_):0,P=d&&w&&b?h.get(p+1,o+1,_):0,z=f&&l&&u?h.get(p,o,_+1):0,I=f&&w&&u?h.get(p,o+1,_+1):0,D=d&&l&&u?h.get(p+1,o,_+1):0,R=d&&w&&u?h.get(p+1,o+1,_+1):0;return(1-c)*((1-m)*((1-v)*L+v*k)+m*((1-v)*T+v*P))+c*((1-m)*((1-v)*z+v*D)+m*((1-v)*I+v*R))}function r(h){var s=h.shape.length|0,i=new Array(s),x=new Array(s),p=new Array(s),v=new Array(s),f,d;for(f=0;f<s;++f)d=+arguments[f+1],i[f]=Math.floor(d),x[f]=d-i[f],p[f]=0<=i[f]&&i[f]<h.shape[f],v[f]=0<=i[f]+1&&i[f]+1<h.shape[f];var o=0,m,l,w;e:for(f=0;f<1<<s;++f){for(l=1,w=h.offset,m=0;m<s;++m)if(f&1<<m){if(!v[m])continue e;l*=x[m],w+=h.stride[m]*(i[m]+1)}else{if(!p[m])continue e;l*=1-x[m],w+=h.stride[m]*i[m]}o+=l*h.data[w]}return o}function t(h,s,i,x){switch(h.shape.length){case 0:return 0;case 1:return e(h,s);case 2:return a(h,s,i);case 3:return n(h,s,i,x);default:return r.apply(void 0,arguments)}}S.exports=t,S.exports.d1=e,S.exports.d2=a,S.exports.d3=n},{}],254:[function(g,S,M){var e={"float64,2,1,0":function(){return function(x,p,v,f,d){var o=x[0],m=x[1],l=x[2],w=v[0],_=v[1],c=v[2];f|=0;var b=0,u=0,L=0,T=c,k=_-l*c,P=w-m*_;for(L=0;L<o;++L){for(u=0;u<m;++u){for(b=0;b<l;++b)p[f]/=d,f+=T;f+=k}f+=P}}},"uint8,2,0,1,float64,2,1,0":function(){return function(x,p,v,f,d,o,m,l){var w=x[0],_=x[1],c=x[2],b=v[0],u=v[1],L=v[2],T=o[0],k=o[1],P=o[2];f|=0,m|=0;for(var z=f,I=m,D=x[0]|0;D>0;){D<64?(w=D,D=0):(w=64,D-=64);for(var R=x[1]|0;R>0;){R<64?(_=R,R=0):(_=64,R-=64),f=z+D*b+R*u,m=I+D*T+R*k;var O=0,F=0,N=0,G=L,K=b-c*L,W=u-w*b,Y=P,re=T-c*P,ue=k-w*T;for(N=0;N<_;++N){for(F=0;F<w;++F){for(O=0;O<c;++O)p[f]=d[m]*l,f+=G,m+=Y;f+=K,m+=re}f+=W,m+=ue}}}}},"float32,1,0,float32,1,0":function(){return function(x,p,v,f,d,o,m){var l=x[0],w=x[1],_=v[0],c=v[1],b=o[0],u=o[1];f|=0,m|=0;var L=0,T=0,k=c,P=_-w*c,z=u,I=b-w*u;for(T=0;T<l;++T){for(L=0;L<w;++L)p[f]=d[m],f+=k,m+=z;f+=P,m+=I}}},"float32,1,0,float32,0,1":function(){return function(x,p,v,f,d,o,m){var l=x[0],w=x[1],_=v[0],c=v[1],b=o[0],u=o[1];f|=0,m|=0;for(var L=f,T=m,k=x[1]|0;k>0;){k<64?(w=k,k=0):(w=64,k-=64);for(var P=x[0]|0;P>0;){P<64?(l=P,P=0):(l=64,P-=64),f=L+k*c+P*_,m=T+k*u+P*b;var z=0,I=0,D=c,R=_-w*c,O=u,F=b-w*u;for(I=0;I<l;++I){for(z=0;z<w;++z)p[f]=d[m],f+=D,m+=O;f+=R,m+=F}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(x,p,v,f,d,o,m){var l=x[0],w=x[1],_=x[2],c=v[0],b=v[1],u=v[2],L=o[0],T=o[1],k=o[2];f|=0,m|=0;for(var P=f,z=m,I=x[2]|0;I>0;){I<64?(_=I,I=0):(_=64,I-=64);for(var D=x[0]|0;D>0;){D<64?(l=D,D=0):(l=64,D-=64);for(var R=x[1]|0;R>0;){R<64?(w=R,R=0):(w=64,R-=64),f=P+I*u+D*c+R*b,m=z+I*k+D*L+R*T;var O=0,F=0,N=0,G=u,K=c-_*u,W=b-l*c,Y=k,re=L-_*k,ue=T-l*L;for(N=0;N<w;++N){for(F=0;F<l;++F){for(O=0;O<_;++O)p[f]=d[m],f+=G,m+=Y;f+=K,m+=re}f+=W,m+=ue}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(x,p,v,f,d,o,m){var l=x[0],w=x[1],_=x[2],c=v[0],b=v[1],u=v[2],L=o[0],T=o[1],k=o[2];f|=0,m|=0;var P=0,z=0,I=0,D=u,R=c-_*u,O=b-l*c,F=k,N=L-_*k,G=T-l*L;for(I=0;I<w;++I){for(z=0;z<l;++z){for(P=0;P<_;++P)p[f]=d[m],f+=D,m+=F;f+=R,m+=N}f+=O,m+=G}}}};function a(i,x){var p=x.join(","),v=e[p];return v()}var n=a,r={mul:function(i){var x={};return function(v,f,d){var o=v.dtype,m=v.order,l=f.dtype,w=f.order,_=d.dtype,c=d.order,b=[o,m.join(),l,w.join(),_,c.join()].join(),u=x[b];return u||(x[b]=u=i([o,m,l,w,_,c])),u(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0,d.data,d.stride,d.offset|0)}},muls:function(i){var x={};return function(v,f,d){var o=v.dtype,m=v.order,l=f.dtype,w=f.order,_=[o,m.join(),l,w.join()].join(),c=x[_];return c||(x[_]=c=i([o,m,l,w])),c(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0,d)}},mulseq:function(i){var x={};return function(v,f){var d=v.dtype,o=v.order,m=[d,o.join()].join(),l=x[m];return l||(x[m]=l=i([d,o])),l(v.shape.slice(0),v.data,v.stride,v.offset|0,f)}},div:function(i){var x={};return function(v,f,d){var o=v.dtype,m=v.order,l=f.dtype,w=f.order,_=d.dtype,c=d.order,b=[o,m.join(),l,w.join(),_,c.join()].join(),u=x[b];return u||(x[b]=u=i([o,m,l,w,_,c])),u(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0,d.data,d.stride,d.offset|0)}},divs:function(i){var x={};return function(v,f,d){var o=v.dtype,m=v.order,l=f.dtype,w=f.order,_=[o,m.join(),l,w.join()].join(),c=x[_];return c||(x[_]=c=i([o,m,l,w])),c(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0,d)}},divseq:function(i){var x={};return function(v,f){var d=v.dtype,o=v.order,m=[d,o.join()].join(),l=x[m];return l||(x[m]=l=i([d,o])),l(v.shape.slice(0),v.data,v.stride,v.offset|0,f)}},assign:function(i){var x={};return function(v,f){var d=v.dtype,o=v.order,m=f.dtype,l=f.order,w=[d,o.join(),m,l.join()].join(),_=x[w];return _||(x[w]=_=i([d,o,m,l])),_(v.shape.slice(0),v.data,v.stride,v.offset|0,f.data,f.stride,f.offset|0)}}};function t(i){var x=r[i.funcName];return x(n.bind(void 0,i))}function h(i){return t({funcName:i.funcName})}var s={mul:"*",div:"/"};(function(){for(var i in s)M[i]=h({funcName:i}),M[i+"s"]=h({funcName:i+"s"}),M[i+"seq"]=h({funcName:i+"seq"})})(),M.assign=h({funcName:"assign"})},{}],255:[function(g,S,M){var e=g("ndarray"),a=g("./doConvert.js");S.exports=function(r,t){for(var h=[],s=r,i=1;Array.isArray(s);)h.push(s.length),i*=s.length,s=s[0];return h.length===0?e():(t||(t=e(new Float64Array(i),h)),a(t,r),t)}},{"./doConvert.js":256,ndarray:259}],256:[function(g,S,M){function e(){return function(s,i,x,p,v){var f=s[0],d=s[1],o=s[2],m=x[0],l=x[1],w=x[2],_=[0,0,0];p|=0;var c=0,b=0,u=0,L=w,T=l-o*w,k=m-d*l;for(u=0;u<f;++u){for(b=0;b<d;++b){for(c=0;c<o;++c){{var P=v,z;for(z=0;z<_.length-1;++z)P=P[_[z]];i[p]=P[_[_.length-1]]}p+=L,++_[2]}p+=T,_[2]-=o,++_[1]}p+=k,_[1]-=d,++_[0]}}}function a(){return e()}var n=a;function r(s){var i={};return function(p,v){var f=p.dtype,d=p.order,o=[f,d.join()].join(),m=i[o];return m||(i[o]=m=s([f,d])),m(p.shape.slice(0),p.data,p.stride,p.offset|0,v)}}function t(s){return r(n.bind(void 0,s))}function h(s){return t({funcName:s.funcName})}S.exports=h({funcName:"convert"})},{}],257:[function(g,S,M){var e=g("typedarray-pool");function a(x){switch(x){case"uint32":return[e.mallocUint32,e.freeUint32];default:return null}}var n={"uint32,1,0":function(x,p){return function(f,d,o,m,l,w,_,c,b,u,L){var T,k,P,z=f*l+m,I,D=x(c),R,O,F,N;for(T=f+1;T<=d;++T){for(k=T,z+=l,P=z,R=0,O=z,I=0;I<c;++I)D[R++]=o[O],O+=b;e:for(;k-- >f;){R=0,O=P-l;t:for(I=0;I<c;++I){if(F=o[O],N=D[R],F<N)break e;if(F>N)break t;O+=u,R+=L}for(R=P,O=P-l,I=0;I<c;++I)o[R]=o[O],R+=b,O+=b;P-=l}for(R=P,O=0,I=0;I<c;++I)o[R]=D[O++],R+=b}p(D)}}};function r(x,p){var v=a(p),f=[p,x].join(","),d=n[f];return v?d(v[0],v[1]):d()}var t={"uint32,1,0":function(x,p,v){return function f(d,o,m,l,w,_,c,b,u,L,T){var k=(o-d+1)/6|0,P=d+k,z=o-k,I=d+o>>1,D=I-k,R=I+k,O=P,F=D,N=I,G=R,K=z,W=d+1,Y=o-1,re=!0,ue,j,q,H,U,$,ne,X,Q,ie=0,se=0,ae=0,oe,be,ce,de,ye,ge,me,Ee,Pe,Ue,we,ke,Xe,Ve,Ie,De,Ye=b,vt=p(Ye),Dt=p(Ye);be=w*O,ce=w*F,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=O,O=F,F=j;break e}if(ae<0)break e;De+=L}be=w*G,ce=w*K,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=G,G=K,K=j;break e}if(ae<0)break e;De+=L}be=w*O,ce=w*N,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=O,O=N,N=j;break e}if(ae<0)break e;De+=L}be=w*F,ce=w*N,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=F,F=N,N=j;break e}if(ae<0)break e;De+=L}be=w*O,ce=w*G,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=O,O=G,G=j;break e}if(ae<0)break e;De+=L}be=w*N,ce=w*G,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=N,N=G,G=j;break e}if(ae<0)break e;De+=L}be=w*F,ce=w*K,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=F,F=K,K=j;break e}if(ae<0)break e;De+=L}be=w*F,ce=w*N,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=F,F=N,N=j;break e}if(ae<0)break e;De+=L}be=w*G,ce=w*K,De=l;e:for(oe=0;oe<b;++oe){if(ne=be+De,X=ce+De,ae=m[ne]-m[X],ae>0){j=G,G=K,K=j;break e}if(ae<0)break e;De+=L}for(be=w*O,ce=w*F,de=w*N,ye=w*G,ge=w*K,me=w*P,Ee=w*I,Pe=w*z,Ie=0,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,Q=de+De,Ue=ye+De,we=ge+De,ke=me+De,Xe=Ee+De,Ve=Pe+De,vt[Ie]=m[X],Dt[Ie]=m[Ue],re=re&&vt[Ie]===Dt[Ie],q=m[ne],H=m[Q],U=m[we],m[ke]=q,m[Xe]=H,m[Ve]=U,++Ie,De+=u;for(be=w*D,ce=w*d,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,m[ne]=m[X],De+=u;for(be=w*R,ce=w*o,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,m[ne]=m[X],De+=u;if(re)for($=W;$<=Y;++$){ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-vt[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae!==0)if(ae<0){if($!==W)for(be=w*$,ce=w*W,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;++W}else for(;;){ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-vt[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae>0)Y--;else if(ae<0){for(be=w*$,ce=w*W,de=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,Q=de+De,ue=m[ne],m[ne]=m[X],m[X]=m[Q],m[Q]=ue,De+=u;++W,--Y;break}else{for(be=w*$,ce=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;--Y;break}}}else for($=W;$<=Y;++$){ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ie=m[ne]-vt[Ie],ie!==0)break e;Ie+=T,ne+=L}if(ie<0){if($!==W)for(be=w*$,ce=w*W,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;++W}else{ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(se=m[ne]-Dt[Ie],se!==0)break e;Ie+=T,ne+=L}if(se>0)for(;;){ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-Dt[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae>0){if(--Y<$)break;continue}else{ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-vt[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae<0){for(be=w*$,ce=w*W,de=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,Q=de+De,ue=m[ne],m[ne]=m[X],m[X]=m[Q],m[Q]=ue,De+=u;++W,--Y}else{for(be=w*$,ce=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;--Y}break}}}}for(be=w*d,ce=w*(W-1),Ie=0,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,m[ne]=m[X],m[X]=vt[Ie],++Ie,De+=u;for(be=w*o,ce=w*(Y+1),Ie=0,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,m[ne]=m[X],m[X]=Dt[Ie],++Ie,De+=u;if(W-2-d<=32?x(d,W-2,m,l,w,_,c,b,u,L,T):f(d,W-2,m,l,w,_,c,b,u,L,T),o-(Y+2)<=32?x(Y+2,o,m,l,w,_,c,b,u,L,T):f(Y+2,o,m,l,w,_,c,b,u,L,T),re){v(vt),v(Dt);return}if(W<P&&Y>z){e:for(;;){for(ne=l+W*w,Ie=0,De=l,oe=0;oe<b;++oe){if(m[ne]!==vt[Ie])break e;++Ie,ne+=u}++W}e:for(;;){for(ne=l+Y*w,Ie=0,De=l,oe=0;oe<b;++oe){if(m[ne]!==Dt[Ie])break e;++Ie,ne+=u}--Y}for($=W;$<=Y;++$){ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ie=m[ne]-vt[Ie],ie!==0)break e;Ie+=T,ne+=L}if(ie===0){if($!==W)for(be=w*$,ce=w*W,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;++W}else{ne=l+$*w,Ie=0;e:for(oe=0;oe<b;++oe){if(se=m[ne]-Dt[Ie],se!==0)break e;Ie+=T,ne+=L}if(se===0)for(;;){ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-Dt[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae===0){if(--Y<$)break;continue}else{ne=l+Y*w,Ie=0;e:for(oe=0;oe<b;++oe){if(ae=m[ne]-vt[Ie],ae!==0)break e;Ie+=T,ne+=L}if(ae<0){for(be=w*$,ce=w*W,de=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,Q=de+De,ue=m[ne],m[ne]=m[X],m[X]=m[Q],m[Q]=ue,De+=u;++W,--Y}else{for(be=w*$,ce=w*Y,De=l,oe=0;oe<b;++oe)ne=be+De,X=ce+De,ue=m[ne],m[ne]=m[X],m[X]=ue,De+=u;--Y}break}}}}}v(vt),v(Dt),Y-W<=32?x(W,Y,m,l,w,_,c,b,u,L,T):f(W,Y,m,l,w,_,c,b,u,L,T)}}};function h(x,p,v){var f=a(p),d=[p,x].join(","),o=t[d];return x.length>1&&f?o(v,f[0],f[1]):o(v)}var s={"uint32,1,0":function(x,p){return function(v){var f=v.data,d=v.offset|0,o=v.shape,m=v.stride,l=m[0]|0,w=o[0]|0,_=m[1]|0,c=o[1]|0,b=_,u=_,L=1;w<=32?x(0,w-1,f,d,l,_,w,c,b,u,L):p(0,w-1,f,d,l,_,w,c,b,u,L)}}};function i(x,p){var v=[p,x].join(","),f=s[v],d=r(x,p),o=h(x,p,d);return f(d,o)}S.exports=i},{"typedarray-pool":308}],258:[function(g,S,M){var e=g("./lib/compile_sort.js"),a={};function n(r){var t=r.order,h=r.dtype,s=[t,h],i=s.join(":"),x=a[i];return x||(a[i]=x=e(t,h)),x(r),r}S.exports=n},{"./lib/compile_sort.js":257}],259:[function(g,S,M){var e=g("is-buffer"),a=typeof Float64Array<"u";function n(p,v){return p[0]-v[0]}function r(){var p=this.stride,v=new Array(p.length),f;for(f=0;f<v.length;++f)v[f]=[Math.abs(p[f]),f];v.sort(n);var d=new Array(v.length);for(f=0;f<d.length;++f)d[f]=v[f][1];return d}var t={T:function(p){function v(d){this.data=d}var f=v.prototype;return f.dtype=p,f.index=function(){return-1},f.size=0,f.dimension=-1,f.shape=f.stride=f.order=[],f.lo=f.hi=f.transpose=f.step=function(){return new v(this.data)},f.get=f.set=function(){},f.pick=function(){return null},function(o){return new v(o)}},0:function(p,v){function f(o,m){this.data=o,this.offset=m}var d=f.prototype;return d.dtype=p,d.index=function(){return this.offset},d.dimension=0,d.size=1,d.shape=d.stride=d.order=[],d.lo=d.hi=d.transpose=d.step=function(){return new f(this.data,this.offset)},d.pick=function(){return v(this.data)},d.valueOf=d.get=function(){return p==="generic"?this.data.get(this.offset):this.data[this.offset]},d.set=function(m){return p==="generic"?this.data.set(this.offset,m):this.data[this.offset]=m},function(m,l,w,_){return new f(m,_)}},1:function(p,v,f){function d(m,l,w,_){this.data=m,this.shape=[l],this.stride=[w],this.offset=_|0}var o=d.prototype;return o.dtype=p,o.dimension=1,Object.defineProperty(o,"size",{get:function(){return this.shape[0]}}),o.order=[0],o.set=function(l,w){return p==="generic"?this.data.set(this.offset+this.stride[0]*l,w):this.data[this.offset+this.stride[0]*l]=w},o.get=function(l){return p==="generic"?this.data.get(this.offset+this.stride[0]*l):this.data[this.offset+this.stride[0]*l]},o.index=function(l){return this.offset+this.stride[0]*l},o.hi=function(l){return new d(this.data,typeof l!="number"||l<0?this.shape[0]:l|0,this.stride[0],this.offset)},o.lo=function(l){var w=this.offset,_=0,c=this.shape[0],b=this.stride[0];return typeof l=="number"&&l>=0&&(_=l|0,w+=b*_,c-=_),new d(this.data,c,b,w)},o.step=function(l){var w=this.shape[0],_=this.stride[0],c=this.offset,b=0,u=Math.ceil;return typeof l=="number"&&(b=l|0,b<0?(c+=_*(w-1),w=u(-w/b)):w=u(w/b),_*=b),new d(this.data,w,_,c)},o.transpose=function(l){l=l===void 0?0:l|0;var w=this.shape,_=this.stride;return new d(this.data,w[l],_[l],this.offset)},o.pick=function(l){var w=[],_=[],c=this.offset;typeof l=="number"&&l>=0?c=c+this.stride[0]*l|0:(w.push(this.shape[0]),_.push(this.stride[0]));var b=v[w.length+1];return b(this.data,w,_,c)},function(l,w,_,c){return new d(l,w[0],_[0],c)}},2:function(p,v,f){function d(m,l,w,_,c,b){this.data=m,this.shape=[l,w],this.stride=[_,c],this.offset=b|0}var o=d.prototype;return o.dtype=p,o.dimension=2,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(o,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),o.set=function(l,w,_){return p==="generic"?this.data.set(this.offset+this.stride[0]*l+this.stride[1]*w,_):this.data[this.offset+this.stride[0]*l+this.stride[1]*w]=_},o.get=function(l,w){return p==="generic"?this.data.get(this.offset+this.stride[0]*l+this.stride[1]*w):this.data[this.offset+this.stride[0]*l+this.stride[1]*w]},o.index=function(l,w){return this.offset+this.stride[0]*l+this.stride[1]*w},o.hi=function(l,w){return new d(this.data,typeof l!="number"||l<0?this.shape[0]:l|0,typeof w!="number"||w<0?this.shape[1]:w|0,this.stride[0],this.stride[1],this.offset)},o.lo=function(l,w){var _=this.offset,c=0,b=this.shape[0],u=this.shape[1],L=this.stride[0],T=this.stride[1];return typeof l=="number"&&l>=0&&(c=l|0,_+=L*c,b-=c),typeof w=="number"&&w>=0&&(c=w|0,_+=T*c,u-=c),new d(this.data,b,u,L,T,_)},o.step=function(l,w){var _=this.shape[0],c=this.shape[1],b=this.stride[0],u=this.stride[1],L=this.offset,T=0,k=Math.ceil;return typeof l=="number"&&(T=l|0,T<0?(L+=b*(_-1),_=k(-_/T)):_=k(_/T),b*=T),typeof w=="number"&&(T=w|0,T<0?(L+=u*(c-1),c=k(-c/T)):c=k(c/T),u*=T),new d(this.data,_,c,b,u,L)},o.transpose=function(l,w){l=l===void 0?0:l|0,w=w===void 0?1:w|0;var _=this.shape,c=this.stride;return new d(this.data,_[l],_[w],c[l],c[w],this.offset)},o.pick=function(l,w){var _=[],c=[],b=this.offset;typeof l=="number"&&l>=0?b=b+this.stride[0]*l|0:(_.push(this.shape[0]),c.push(this.stride[0])),typeof w=="number"&&w>=0?b=b+this.stride[1]*w|0:(_.push(this.shape[1]),c.push(this.stride[1]));var u=v[_.length+1];return u(this.data,_,c,b)},function(l,w,_,c){return new d(l,w[0],w[1],_[0],_[1],c)}},3:function(p,v,f){function d(m,l,w,_,c,b,u,L){this.data=m,this.shape=[l,w,_],this.stride=[c,b,u],this.offset=L|0}var o=d.prototype;return o.dtype=p,o.dimension=3,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(o,"order",{get:function(){var l=Math.abs(this.stride[0]),w=Math.abs(this.stride[1]),_=Math.abs(this.stride[2]);return l>w?w>_?[2,1,0]:l>_?[1,2,0]:[1,0,2]:l>_?[2,0,1]:_>w?[0,1,2]:[0,2,1]}}),o.set=function(l,w,_,c){return p==="generic"?this.data.set(this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_,c):this.data[this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_]=c},o.get=function(l,w,_){return p==="generic"?this.data.get(this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_):this.data[this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_]},o.index=function(l,w,_){return this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_},o.hi=function(l,w,_){return new d(this.data,typeof l!="number"||l<0?this.shape[0]:l|0,typeof w!="number"||w<0?this.shape[1]:w|0,typeof _!="number"||_<0?this.shape[2]:_|0,this.stride[0],this.stride[1],this.stride[2],this.offset)},o.lo=function(l,w,_){var c=this.offset,b=0,u=this.shape[0],L=this.shape[1],T=this.shape[2],k=this.stride[0],P=this.stride[1],z=this.stride[2];return typeof l=="number"&&l>=0&&(b=l|0,c+=k*b,u-=b),typeof w=="number"&&w>=0&&(b=w|0,c+=P*b,L-=b),typeof _=="number"&&_>=0&&(b=_|0,c+=z*b,T-=b),new d(this.data,u,L,T,k,P,z,c)},o.step=function(l,w,_){var c=this.shape[0],b=this.shape[1],u=this.shape[2],L=this.stride[0],T=this.stride[1],k=this.stride[2],P=this.offset,z=0,I=Math.ceil;return typeof l=="number"&&(z=l|0,z<0?(P+=L*(c-1),c=I(-c/z)):c=I(c/z),L*=z),typeof w=="number"&&(z=w|0,z<0?(P+=T*(b-1),b=I(-b/z)):b=I(b/z),T*=z),typeof _=="number"&&(z=_|0,z<0?(P+=k*(u-1),u=I(-u/z)):u=I(u/z),k*=z),new d(this.data,c,b,u,L,T,k,P)},o.transpose=function(l,w,_){l=l===void 0?0:l|0,w=w===void 0?1:w|0,_=_===void 0?2:_|0;var c=this.shape,b=this.stride;return new d(this.data,c[l],c[w],c[_],b[l],b[w],b[_],this.offset)},o.pick=function(l,w,_){var c=[],b=[],u=this.offset;typeof l=="number"&&l>=0?u=u+this.stride[0]*l|0:(c.push(this.shape[0]),b.push(this.stride[0])),typeof w=="number"&&w>=0?u=u+this.stride[1]*w|0:(c.push(this.shape[1]),b.push(this.stride[1])),typeof _=="number"&&_>=0?u=u+this.stride[2]*_|0:(c.push(this.shape[2]),b.push(this.stride[2]));var L=v[c.length+1];return L(this.data,c,b,u)},function(l,w,_,c){return new d(l,w[0],w[1],w[2],_[0],_[1],_[2],c)}},4:function(p,v,f){function d(m,l,w,_,c,b,u,L,T,k){this.data=m,this.shape=[l,w,_,c],this.stride=[b,u,L,T],this.offset=k|0}var o=d.prototype;return o.dtype=p,o.dimension=4,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(o,"order",{get:f}),o.set=function(l,w,_,c,b){return p==="generic"?this.data.set(this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*c,b):this.data[this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*c]=b},o.get=function(l,w,_,c){return p==="generic"?this.data.get(this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*c):this.data[this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*c]},o.index=function(l,w,_,c){return this.offset+this.stride[0]*l+this.stride[1]*w+this.stride[2]*_+this.stride[3]*c},o.hi=function(l,w,_,c){return new d(this.data,typeof l!="number"||l<0?this.shape[0]:l|0,typeof w!="number"||w<0?this.shape[1]:w|0,typeof _!="number"||_<0?this.shape[2]:_|0,typeof c!="number"||c<0?this.shape[3]:c|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},o.lo=function(l,w,_,c){var b=this.offset,u=0,L=this.shape[0],T=this.shape[1],k=this.shape[2],P=this.shape[3],z=this.stride[0],I=this.stride[1],D=this.stride[2],R=this.stride[3];return typeof l=="number"&&l>=0&&(u=l|0,b+=z*u,L-=u),typeof w=="number"&&w>=0&&(u=w|0,b+=I*u,T-=u),typeof _=="number"&&_>=0&&(u=_|0,b+=D*u,k-=u),typeof c=="number"&&c>=0&&(u=c|0,b+=R*u,P-=u),new d(this.data,L,T,k,P,z,I,D,R,b)},o.step=function(l,w,_,c){var b=this.shape[0],u=this.shape[1],L=this.shape[2],T=this.shape[3],k=this.stride[0],P=this.stride[1],z=this.stride[2],I=this.stride[3],D=this.offset,R=0,O=Math.ceil;return typeof l=="number"&&(R=l|0,R<0?(D+=k*(b-1),b=O(-b/R)):b=O(b/R),k*=R),typeof w=="number"&&(R=w|0,R<0?(D+=P*(u-1),u=O(-u/R)):u=O(u/R),P*=R),typeof _=="number"&&(R=_|0,R<0?(D+=z*(L-1),L=O(-L/R)):L=O(L/R),z*=R),typeof c=="number"&&(R=c|0,R<0?(D+=I*(T-1),T=O(-T/R)):T=O(T/R),I*=R),new d(this.data,b,u,L,T,k,P,z,I,D)},o.transpose=function(l,w,_,c){l=l===void 0?0:l|0,w=w===void 0?1:w|0,_=_===void 0?2:_|0,c=c===void 0?3:c|0;var b=this.shape,u=this.stride;return new d(this.data,b[l],b[w],b[_],b[c],u[l],u[w],u[_],u[c],this.offset)},o.pick=function(l,w,_,c){var b=[],u=[],L=this.offset;typeof l=="number"&&l>=0?L=L+this.stride[0]*l|0:(b.push(this.shape[0]),u.push(this.stride[0])),typeof w=="number"&&w>=0?L=L+this.stride[1]*w|0:(b.push(this.shape[1]),u.push(this.stride[1])),typeof _=="number"&&_>=0?L=L+this.stride[2]*_|0:(b.push(this.shape[2]),u.push(this.stride[2])),typeof c=="number"&&c>=0?L=L+this.stride[3]*c|0:(b.push(this.shape[3]),u.push(this.stride[3]));var T=v[b.length+1];return T(this.data,b,u,L)},function(l,w,_,c){return new d(l,w[0],w[1],w[2],w[3],_[0],_[1],_[2],_[3],c)}},5:function(v,f,d){function o(l,w,_,c,b,u,L,T,k,P,z,I){this.data=l,this.shape=[w,_,c,b,u],this.stride=[L,T,k,P,z],this.offset=I|0}var m=o.prototype;return m.dtype=v,m.dimension=5,Object.defineProperty(m,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(m,"order",{get:d}),m.set=function(w,_,c,b,u,L){return v==="generic"?this.data.set(this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*c+this.stride[3]*b+this.stride[4]*u,L):this.data[this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*c+this.stride[3]*b+this.stride[4]*u]=L},m.get=function(w,_,c,b,u){return v==="generic"?this.data.get(this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*c+this.stride[3]*b+this.stride[4]*u):this.data[this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*c+this.stride[3]*b+this.stride[4]*u]},m.index=function(w,_,c,b,u){return this.offset+this.stride[0]*w+this.stride[1]*_+this.stride[2]*c+this.stride[3]*b+this.stride[4]*u},m.hi=function(w,_,c,b,u){return new o(this.data,typeof w!="number"||w<0?this.shape[0]:w|0,typeof _!="number"||_<0?this.shape[1]:_|0,typeof c!="number"||c<0?this.shape[2]:c|0,typeof b!="number"||b<0?this.shape[3]:b|0,typeof u!="number"||u<0?this.shape[4]:u|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},m.lo=function(w,_,c,b,u){var L=this.offset,T=0,k=this.shape[0],P=this.shape[1],z=this.shape[2],I=this.shape[3],D=this.shape[4],R=this.stride[0],O=this.stride[1],F=this.stride[2],N=this.stride[3],G=this.stride[4];return typeof w=="number"&&w>=0&&(T=w|0,L+=R*T,k-=T),typeof _=="number"&&_>=0&&(T=_|0,L+=O*T,P-=T),typeof c=="number"&&c>=0&&(T=c|0,L+=F*T,z-=T),typeof b=="number"&&b>=0&&(T=b|0,L+=N*T,I-=T),typeof u=="number"&&u>=0&&(T=u|0,L+=G*T,D-=T),new o(this.data,k,P,z,I,D,R,O,F,N,G,L)},m.step=function(w,_,c,b,u){var L=this.shape[0],T=this.shape[1],k=this.shape[2],P=this.shape[3],z=this.shape[4],I=this.stride[0],D=this.stride[1],R=this.stride[2],O=this.stride[3],F=this.stride[4],N=this.offset,G=0,K=Math.ceil;return typeof w=="number"&&(G=w|0,G<0?(N+=I*(L-1),L=K(-L/G)):L=K(L/G),I*=G),typeof _=="number"&&(G=_|0,G<0?(N+=D*(T-1),T=K(-T/G)):T=K(T/G),D*=G),typeof c=="number"&&(G=c|0,G<0?(N+=R*(k-1),k=K(-k/G)):k=K(k/G),R*=G),typeof b=="number"&&(G=b|0,G<0?(N+=O*(P-1),P=K(-P/G)):P=K(P/G),O*=G),typeof u=="number"&&(G=u|0,G<0?(N+=F*(z-1),z=K(-z/G)):z=K(z/G),F*=G),new o(this.data,L,T,k,P,z,I,D,R,O,F,N)},m.transpose=function(w,_,c,b,u){w=w===void 0?0:w|0,_=_===void 0?1:_|0,c=c===void 0?2:c|0,b=b===void 0?3:b|0,u=u===void 0?4:u|0;var L=this.shape,T=this.stride;return new o(this.data,L[w],L[_],L[c],L[b],L[u],T[w],T[_],T[c],T[b],T[u],this.offset)},m.pick=function(w,_,c,b,u){var L=[],T=[],k=this.offset;typeof w=="number"&&w>=0?k=k+this.stride[0]*w|0:(L.push(this.shape[0]),T.push(this.stride[0])),typeof _=="number"&&_>=0?k=k+this.stride[1]*_|0:(L.push(this.shape[1]),T.push(this.stride[1])),typeof c=="number"&&c>=0?k=k+this.stride[2]*c|0:(L.push(this.shape[2]),T.push(this.stride[2])),typeof b=="number"&&b>=0?k=k+this.stride[3]*b|0:(L.push(this.shape[3]),T.push(this.stride[3])),typeof u=="number"&&u>=0?k=k+this.stride[4]*u|0:(L.push(this.shape[4]),T.push(this.stride[4]));var P=f[L.length+1];return P(this.data,L,T,k)},function(w,_,c,b){return new o(w,_[0],_[1],_[2],_[3],_[4],c[0],c[1],c[2],c[3],c[4],b)}}};function h(p,v){var f=v===-1?"T":String(v),d=t[f];return v===-1?d(p):v===0?d(p,i[p][0]):d(p,i[p],r)}function s(p){if(e(p))return"buffer";if(a)switch(Object.prototype.toString.call(p)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(p)?"array":"generic"}var i={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};function x(p,v,f,d){if(p===void 0){var c=i.array[0];return c([])}else typeof p=="number"&&(p=[p]);v===void 0&&(v=[p.length]);var o=v.length;if(f===void 0){f=new Array(o);for(var m=o-1,l=1;m>=0;--m)f[m]=l,l*=v[m]}if(d===void 0){d=0;for(var m=0;m<o;++m)f[m]<0&&(d-=(v[m]-1)*f[m])}for(var w=s(p),_=i[w];_.length<=o+1;)_.push(h(w,_.length-1));var c=_[o+1];return c(p,v,f,d)}S.exports=x},{"is-buffer":237}],260:[function(g,S,M){var e=g("double-bits"),a=Math.pow(2,-1074),n=-1>>>0;S.exports=r;function r(t,h){if(isNaN(t)||isNaN(h))return NaN;if(t===h)return t;if(t===0)return h<0?-a:a;var s=e.hi(t),i=e.lo(t);return h>t==t>0?i===n?(s+=1,i=0):i+=1:i===0?(i=n,s-=1):i-=1,e.pack(i,s)}},{"double-bits":64}],261:[function(g,S,M){var e=1e-6,a=1e-6;M.vertexNormals=function(n,r,t){for(var h=r.length,s=new Array(h),i=t===void 0?e:t,x=0;x<h;++x)s[x]=[0,0,0];for(var x=0;x<n.length;++x)for(var p=n[x],v=0,f=p[p.length-1],d=p[0],o=0;o<p.length;++o){v=f,f=d,d=p[(o+1)%p.length];for(var m=r[v],l=r[f],w=r[d],_=new Array(3),c=0,b=new Array(3),u=0,L=0;L<3;++L)_[L]=m[L]-l[L],c+=_[L]*_[L],b[L]=w[L]-l[L],u+=b[L]*b[L];if(c*u>i)for(var T=s[f],k=1/Math.sqrt(c*u),L=0;L<3;++L){var P=(L+1)%3,z=(L+2)%3;T[L]+=k*(b[P]*_[z]-b[z]*_[P])}}for(var x=0;x<h;++x){for(var T=s[x],I=0,L=0;L<3;++L)I+=T[L]*T[L];if(I>i)for(var k=1/Math.sqrt(I),L=0;L<3;++L)T[L]*=k;else for(var L=0;L<3;++L)T[L]=0}return s},M.faceNormals=function(n,r,t){for(var h=n.length,s=new Array(h),i=t===void 0?a:t,x=0;x<h;++x){for(var p=n[x],v=new Array(3),f=0;f<3;++f)v[f]=r[p[f]];for(var d=new Array(3),o=new Array(3),f=0;f<3;++f)d[f]=v[1][f]-v[0][f],o[f]=v[2][f]-v[0][f];for(var m=new Array(3),l=0,f=0;f<3;++f){var w=(f+1)%3,_=(f+2)%3;m[f]=d[w]*o[_]-d[_]*o[w],l+=m[f]*m[f]}l>i?l=1/Math.sqrt(l):l=0;for(var f=0;f<3;++f)m[f]*=l;s[x]=m}return s}},{}],262:[function(g,S,M){S.exports=e;function e(a,n,r,t,h,s,i,x,p,v){var f=n+s+v;if(d>0){var d=Math.sqrt(f+1);a[0]=.5*(i-p)/d,a[1]=.5*(x-t)/d,a[2]=.5*(r-s)/d,a[3]=.5*d}else{var o=Math.max(n,s,v),d=Math.sqrt(2*o-f+1);n>=o?(a[0]=.5*d,a[1]=.5*(h+r)/d,a[2]=.5*(x+t)/d,a[3]=.5*(i-p)/d):s>=o?(a[0]=.5*(r+h)/d,a[1]=.5*d,a[2]=.5*(p+i)/d,a[3]=.5*(x-t)/d):(a[0]=.5*(t+x)/d,a[1]=.5*(i+p)/d,a[2]=.5*d,a[3]=.5*(r-h)/d)}return a}},{}],263:[function(g,S,M){S.exports=v;var e=g("filtered-vector"),a=g("gl-mat4/lookAt"),n=g("gl-mat4/fromQuat"),r=g("gl-mat4/invert"),t=g("./lib/quatFromFrame");function h(f,d,o){return Math.sqrt(Math.pow(f,2)+Math.pow(d,2)+Math.pow(o,2))}function s(f,d,o,m){return Math.sqrt(Math.pow(f,2)+Math.pow(d,2)+Math.pow(o,2)+Math.pow(m,2))}function i(f,d){var o=d[0],m=d[1],l=d[2],w=d[3],_=s(o,m,l,w);_>1e-6?(f[0]=o/_,f[1]=m/_,f[2]=l/_,f[3]=w/_):(f[0]=f[1]=f[2]=0,f[3]=1)}function x(f,d,o){this.radius=e([o]),this.center=e(d),this.rotation=e(f),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var p=x.prototype;p.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},p.recalcMatrix=function(f){this.radius.curve(f),this.center.curve(f),this.rotation.curve(f);var d=this.computedRotation;i(d,d);var o=this.computedMatrix;n(o,d);var m=this.computedCenter,l=this.computedEye,w=this.computedUp,_=Math.exp(this.computedRadius[0]);l[0]=m[0]+_*o[2],l[1]=m[1]+_*o[6],l[2]=m[2]+_*o[10],w[0]=o[1],w[1]=o[5],w[2]=o[9];for(var c=0;c<3;++c){for(var b=0,u=0;u<3;++u)b+=o[c+4*u]*l[u];o[12+c]=-b}},p.getMatrix=function(f,d){this.recalcMatrix(f);var o=this.computedMatrix;if(d){for(var m=0;m<16;++m)d[m]=o[m];return d}return o},p.idle=function(f){this.center.idle(f),this.radius.idle(f),this.rotation.idle(f)},p.flush=function(f){this.center.flush(f),this.radius.flush(f),this.rotation.flush(f)},p.pan=function(f,d,o,m){d=d||0,o=o||0,m=m||0,this.recalcMatrix(f);var l=this.computedMatrix,w=l[1],_=l[5],c=l[9],b=h(w,_,c);w/=b,_/=b,c/=b;var u=l[0],L=l[4],T=l[8],k=u*w+L*_+T*c;u-=w*k,L-=_*k,T-=c*k;var P=h(u,L,T);u/=P,L/=P,T/=P,l[2],l[6],l[10];var z=u*d+w*o,I=L*d+_*o,D=T*d+c*o;this.center.move(f,z,I,D);var R=Math.exp(this.computedRadius[0]);R=Math.max(1e-4,R+m),this.radius.set(f,Math.log(R))},p.rotate=function(f,d,o,m){this.recalcMatrix(f),d=d||0,o=o||0;var l=this.computedMatrix,w=l[0],_=l[4],c=l[8],b=l[1],u=l[5],L=l[9],T=l[2],k=l[6],P=l[10],z=d*w+o*b,I=d*_+o*u,D=d*c+o*L,R=-(k*D-P*I),O=-(P*z-T*D),F=-(T*I-k*z),N=Math.sqrt(Math.max(0,1-Math.pow(R,2)-Math.pow(O,2)-Math.pow(F,2))),G=s(R,O,F,N);G>1e-6?(R/=G,O/=G,F/=G,N/=G):(R=O=F=0,N=1);var K=this.computedRotation,W=K[0],Y=K[1],re=K[2],ue=K[3],j=W*N+ue*R+Y*F-re*O,q=Y*N+ue*O+re*R-W*F,H=re*N+ue*F+W*O-Y*R,U=ue*N-W*R-Y*O-re*F;if(m){R=T,O=k,F=P;var $=Math.sin(m)/h(R,O,F);R*=$,O*=$,F*=$,N=Math.cos(d),j=j*N+U*R+q*F-H*O,q=q*N+U*O+H*R-j*F,H=H*N+U*F+j*O-q*R,U=U*N-j*R-q*O-H*F}var ne=s(j,q,H,U);ne>1e-6?(j/=ne,q/=ne,H/=ne,U/=ne):(j=q=H=0,U=1),this.rotation.set(f,j,q,H,U)},p.lookAt=function(f,d,o,m){this.recalcMatrix(f),o=o||this.computedCenter,d=d||this.computedEye,m=m||this.computedUp;var l=this.computedMatrix;a(l,d,o,m);var w=this.computedRotation;t(w,l[0],l[1],l[2],l[4],l[5],l[6],l[8],l[9],l[10]),i(w,w),this.rotation.set(f,w[0],w[1],w[2],w[3]);for(var _=0,c=0;c<3;++c)_+=Math.pow(o[c]-d[c],2);this.radius.set(f,.5*Math.log(Math.max(_,1e-6))),this.center.set(f,o[0],o[1],o[2])},p.translate=function(f,d,o,m){this.center.move(f,d||0,o||0,m||0)},p.setMatrix=function(f,d){var o=this.computedRotation;t(o,d[0],d[1],d[2],d[4],d[5],d[6],d[8],d[9],d[10]),i(o,o),this.rotation.set(f,o[0],o[1],o[2],o[3]);var m=this.computedMatrix;r(m,d);var l=m[15];if(Math.abs(l)>1e-6){var w=m[12]/l,_=m[13]/l,c=m[14]/l;this.recalcMatrix(f);var b=Math.exp(this.computedRadius[0]);this.center.set(f,w-m[2]*b,_-m[6]*b,c-m[10]*b),this.radius.idle(f)}else this.center.idle(f),this.radius.idle(f)},p.setDistance=function(f,d){d>0&&this.radius.set(f,Math.log(d))},p.setDistanceLimits=function(f,d){f>0?f=Math.log(f):f=-1/0,d>0?d=Math.log(d):d=1/0,d=Math.max(d,f),this.radius.bounds[0][0]=f,this.radius.bounds[1][0]=d},p.getDistanceLimits=function(f){var d=this.radius.bounds;return f?(f[0]=Math.exp(d[0][0]),f[1]=Math.exp(d[1][0]),f):[Math.exp(d[0][0]),Math.exp(d[1][0])]},p.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},p.fromJSON=function(f){var d=this.lastT(),o=f.center;o&&this.center.set(d,o[0],o[1],o[2]);var m=f.rotation;m&&this.rotation.set(d,m[0],m[1],m[2],m[3]);var l=f.distance;l&&l>0&&this.radius.set(d,Math.log(l)),this.setDistanceLimits(f.zoomMin,f.zoomMax)};function v(f){f=f||{};var d=f.center||[0,0,0],o=f.rotation||[0,0,0,1],m=f.radius||1;d=[].slice.call(d,0,3),o=[].slice.call(o,0,4),i(o,o);var l=new x(o,d,Math.log(m));return l.setDistanceLimits(f.zoomMin,f.zoomMax),("eye"in f||"up"in f)&&l.lookAt(0,f.eye,f.center,f.up),l}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(g,S,M){var e=g("repeat-string");S.exports=function(n,r,t){return t=typeof t<"u"?t+"":" ",e(t,r)+n}},{"repeat-string":277}],265:[function(g,S,M){S.exports=function(a,n){n||(n=[0,""]),a=String(a);var r=parseFloat(a,10);return n[0]=r,n[1]=a.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],266:[function(g,S,M){S.exports=a;var e=g("compare-angle");function a(n,r){for(var t=r.length|0,h=n.length,s=[new Array(t),new Array(t)],i=0;i<t;++i)s[0][i]=[],s[1][i]=[];for(var i=0;i<h;++i){var x=n[i];s[0][x[0]].push(x),s[1][x[1]].push(x)}for(var p=[],i=0;i<t;++i)s[0][i].length+s[1][i].length===0&&p.push([i]);function v(_,c){var b=s[c][_[c]];b.splice(b.indexOf(_),1)}function f(_,c,b){for(var u,L,T,k=0;k<2;++k)if(s[k][c].length>0){u=s[k][c][0],T=k;break}L=u[T^1];for(var P=0;P<2;++P)for(var z=s[P][c],I=0;I<z.length;++I){var D=z[I],R=D[P^1],O=e(r[_],r[c],r[L],r[R]);O>0&&(u=D,L=R,T=P)}return b||u&&v(u,T),L}function d(_,c){var b=s[c][_][0],u=[_];v(b,c);for(var L=b[c^1];;){for(;L!==_;)u.push(L),L=f(u[u.length-2],L,!1);if(s[0][_].length+s[1][_].length===0)break;var T=u[u.length-1],k=_,P=u[1],z=f(T,k,!0);if(e(r[T],r[k],r[P],r[z])<0)break;u.push(_),L=f(T,k)}return u}function o(_,c){return c[1]===c[c.length-1]}for(var i=0;i<t;++i)for(var m=0;m<2;++m){for(var l=[];s[m][i].length>0;){s[0][i].length;var w=d(i,m);o(l,w)?l.push.apply(l,w):(l.length>0&&p.push(l),l=w)}l.length>0&&p.push(l)}return p}},{"compare-angle":54}],267:[function(g,S,M){S.exports=a;var e=g("edges-to-adjacency-list");function a(n,r){for(var t=e(n,r.length),h=new Array(r.length),s=new Array(r.length),i=[],x=0;x<r.length;++x){var p=t[x].length;s[x]=p,h[x]=!0,p<=1&&i.push(x)}for(;i.length>0;){var v=i.pop();h[v]=!1;for(var f=t[v],x=0;x<f.length;++x){var d=f[x];--s[d]===0&&i.push(d)}}for(var o=new Array(r.length),m=[],x=0;x<r.length;++x)if(h[x]){var v=m.length;o[x]=v,m.push(r[x])}else o[x]=-1;for(var l=[],x=0;x<n.length;++x){var w=n[x];h[w[0]]&&h[w[1]]&&l.push([o[w[0]],o[w[1]]])}return[l,m]}},{"edges-to-adjacency-list":66}],268:[function(g,S,M){S.exports=p;var e=g("edges-to-adjacency-list"),a=g("planar-dual"),n=g("point-in-big-polygon"),r=g("two-product"),t=g("robust-sum"),h=g("uniq"),s=g("./lib/trim-leaves");function i(v,f){for(var d=new Array(v),o=0;o<v;++o)d[o]=f;return d}function x(v){for(var f=new Array(v),d=0;d<v;++d)f[d]=[];return f}function p(v,f){var U=s(v,f);v=U[0],f=U[1];var d=f.length;v.length;for(var o=e(v,f.length),m=0;m<d;++m)if(o[m].length%2===1)throw new Error("planar-graph-to-polyline: graph must be manifold");var l=a(v,f);function w(ae){for(var oe=ae.length,be=[0],ce=0;ce<oe;++ce){var de=f[ae[ce]],ye=f[ae[(ce+1)%oe]],ge=r(-de[0],de[1]),me=r(-de[0],ye[1]),Ee=r(ye[0],de[1]),Pe=r(ye[0],ye[1]);be=t(be,t(t(ge,me),t(Ee,Pe)))}return be[be.length-1]>0}l=l.filter(w);for(var _=l.length,c=new Array(_),b=new Array(_),m=0;m<_;++m){c[m]=m;var u=new Array(_),L=l[m].map(function(oe){return f[oe]}),T=n([L]),k=0;e:for(var P=0;P<_;++P)if(u[P]=0,m!==P){for(var z=l[P],I=z.length,D=0;D<I;++D){var R=T(f[z[D]]);if(R!==0){R<0&&(u[P]=1,k+=1);continue e}}u[P]=1,k+=1}b[m]=[k,m,u]}b.sort(function(ae,oe){return oe[0]-ae[0]});for(var m=0;m<_;++m)for(var u=b[m],O=u[1],F=u[2],P=0;P<_;++P)F[P]&&(c[P]=O);for(var N=x(_),m=0;m<_;++m)N[m].push(c[m]),N[c[m]].push(m);for(var G={},K=i(d,!1),m=0;m<_;++m)for(var z=l[m],I=z.length,P=0;P<I;++P){var W=z[P],Y=z[(P+1)%I],re=Math.min(W,Y)+":"+Math.max(W,Y);if(re in G){var ue=G[re];N[ue].push(m),N[m].push(ue),K[W]=K[Y]=!0}else G[re]=m}function j(ae){for(var oe=ae.length,be=0;be<oe;++be)if(!K[ae[be]])return!1;return!0}for(var q=[],H=i(_,-1),m=0;m<_;++m)c[m]===m&&!j(l[m])?(q.push(m),H[m]=0):H[m]=-1;for(var U=[];q.length>0;){var $=q.pop(),ne=N[$];h(ne,function(ae,oe){return ae-oe});var X=ne.length,Q=H[$],ie;if(Q===0){var z=l[$];ie=[z]}for(var m=0;m<X;++m){var se=ne[m];if(!(H[se]>=0)&&(H[se]=Q^1,q.push(se),Q===0)){var z=l[se];j(z)||(z.reverse(),ie.push(z))}}Q===0&&U.push(ie)}return U}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(g,S,M){S.exports=f;var e=g("robust-orientation")[3],a=g("slab-decomposition"),n=g("interval-tree-1d"),r=g("binary-search-bounds");function t(){return!0}function h(d){return function(o,m){var l=d[o];return l?!!l.queryPoint(m,t):!1}}function s(d){for(var o={},m=0;m<d.length;++m){var l=d[m],w=l[0][0],_=l[0][1],c=l[1][1],b=[Math.min(_,c),Math.max(_,c)];w in o?o[w].push(b):o[w]=[b]}for(var u={},L=Object.keys(o),m=0;m<L.length;++m){var T=o[L[m]];u[L[m]]=n(T)}return h(u)}function i(d,o){return function(m){var l=r.le(o,m[0]);if(l<0)return 1;var w=d[l];if(!w)if(l>0&&o[l]===m[0])w=d[l-1];else return 1;for(var _=1;w;){var c=w.key,b=e(m,c[0],c[1]);if(c[0][0]<c[1][0])if(b<0)w=w.left;else if(b>0)_=-1,w=w.right;else return 0;else if(b>0)w=w.left;else if(b<0)_=1,w=w.right;else return 0}return _}}function x(d){return 1}function p(d){return function(m){return d(m[0],m[1])?0:1}}function v(d,o){return function(l){return d(l[0],l[1])?0:o(l)}}function f(d){for(var o=d.length,m=[],l=[],w=0;w<o;++w)for(var _=d[w],c=_.length,b=c-1,u=0;u<c;b=u++){var L=_[b],T=_[u];L[0]===T[0]?l.push([L,T]):m.push([L,T])}if(m.length===0)return l.length===0?x:p(s(l));var k=a(m),P=i(k.slabs,k.coordinates);return l.length===0?P:v(s(l),P)}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(g,S,M){var e=new Float64Array(4),a=new Float64Array(4),n=new Float64Array(4);function r(t,h,s,i,x){e.length<i.length&&(e=new Float64Array(i.length),a=new Float64Array(i.length),n=new Float64Array(i.length));for(var p=0;p<i.length;++p)e[p]=t[p]-i[p],a[p]=h[p]-t[p],n[p]=s[p]-t[p];for(var v=0,f=0,d=0,o=0,m=0,l=0,p=0;p<i.length;++p){var w=a[p],_=n[p],c=e[p];v+=w*w,f+=w*_,d+=_*_,o+=c*w,m+=c*_,l+=c*c}var b=Math.abs(v*d-f*f),u=f*m-d*o,L=f*o-v*m,T;if(u+L<=b)if(u<0)L<0&&o<0?(L=0,-o>=v?(u=1,T=v+2*o+l):(u=-o/v,T=o*u+l)):(u=0,m>=0?(L=0,T=l):-m>=d?(L=1,T=d+2*m+l):(L=-m/d,T=m*L+l));else if(L<0)L=0,o>=0?(u=0,T=l):-o>=v?(u=1,T=v+2*o+l):(u=-o/v,T=o*u+l);else{var k=1/b;u*=k,L*=k,T=u*(v*u+f*L+2*o)+L*(f*u+d*L+2*m)+l}else{var P,z,I,D;u<0?(P=f+o,z=d+m,z>P?(I=z-P,D=v-2*f+d,I>=D?(u=1,L=0,T=v+2*o+l):(u=I/D,L=1-u,T=u*(v*u+f*L+2*o)+L*(f*u+d*L+2*m)+l)):(u=0,z<=0?(L=1,T=d+2*m+l):m>=0?(L=0,T=l):(L=-m/d,T=m*L+l))):L<0?(P=f+m,z=v+o,z>P?(I=z-P,D=v-2*f+d,I>=D?(L=1,u=0,T=d+2*m+l):(L=I/D,u=1-L,T=u*(v*u+f*L+2*o)+L*(f*u+d*L+2*m)+l)):(L=0,z<=0?(u=1,T=v+2*o+l):o>=0?(u=0,T=l):(u=-o/v,T=o*u+l))):(I=d+m-f-o,I<=0?(u=0,L=1,T=d+2*m+l):(D=v-2*f+d,I>=D?(u=1,L=0,T=v+2*o+l):(u=I/D,L=1-u,T=u*(v*u+f*L+2*o)+L*(f*u+d*L+2*m)+l)))}for(var R=1-u-L,p=0;p<i.length;++p)x[p]=R*t[p]+u*h[p]+L*s[p];return T<0?0:T}S.exports=r},{}],271:[function(g,S,M){S.exports=g("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(g,S,M){var e=g("big-rat/add");S.exports=a;function a(n,r){for(var t=n.length,h=new Array(t),s=0;s<t;++s)h[s]=e(n[s],r[s]);return h}},{"big-rat/add":15}],273:[function(g,S,M){S.exports=a;var e=g("big-rat");function a(n){for(var r=new Array(n.length),t=0;t<n.length;++t)r[t]=e(n[t]);return r}},{"big-rat":18}],274:[function(g,S,M){var e=g("big-rat"),a=g("big-rat/mul");S.exports=n;function n(r,t){for(var h=e(t),s=r.length,i=new Array(s),x=0;x<s;++x)i[x]=a(r[x],h);return i}},{"big-rat":18,"big-rat/mul":27}],275:[function(g,S,M){var e=g("big-rat/sub");S.exports=a;function a(n,r){for(var t=n.length,h=new Array(t),s=0;s<t;++s)h[s]=e(n[s],r[s]);return h}},{"big-rat/sub":29}],276:[function(g,S,M){var e=g("compare-cell"),a=g("compare-oriented-cell"),n=g("cell-orientation");S.exports=r;function r(t){t.sort(a);for(var h=t.length,s=0,i=0;i<h;++i){var x=t[i],p=n(x);if(p!==0){if(s>0){var v=t[s-1];if(e(x,v)===0&&n(v)!==p){s-=1;continue}}t[s++]=x}}return t.length=s,t}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(g,S,M){var e="",a;S.exports=n;function n(r,t){if(typeof r!="string")throw new TypeError("expected a string");if(t===1)return r;if(t===2)return r+r;var h=r.length*t;if(a!==r||typeof a>"u")a=r,e="";else if(e.length>=h)return e.substr(0,h);for(;h>e.length&&t>1;)t&1&&(e+=r),t>>=1,r+=r;return e+=r,e=e.substr(0,h),e}},{}],278:[function(g,S,M){(function(e){(function(){S.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof A<"u"?A:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(g,S,M){S.exports=e;function e(a){for(var n=a.length,r=a[a.length-1],t=n,h=n-2;h>=0;--h){var s=r,i=a[h];r=s+i;var x=r-s,p=i-x;p&&(a[--t]=r,r=p)}for(var v=0,h=t;h<n;++h){var s=a[h],i=r;r=s+i;var x=r-s,p=i-x;p&&(a[v++]=p)}return a[v++]=r,a.length=v,a}},{}],280:[function(g,S,M){var e=g("two-product"),a=g("robust-sum"),n=g("robust-scale"),r=g("robust-compress"),t=6;function h(o,m,l,w){return function(c){return w(o(l(c[0][0],c[1][1]),l(-c[0][1],c[1][0])))}}function s(o,m,l,w){return function(c){return w(o(m(o(l(c[1][1],c[2][2]),l(-c[1][2],c[2][1])),c[0][0]),o(m(o(l(c[1][0],c[2][2]),l(-c[1][2],c[2][0])),-c[0][1]),m(o(l(c[1][0],c[2][1]),l(-c[1][1],c[2][0])),c[0][2]))))}}function i(o,m,l,w){return function(c){return w(o(o(m(o(m(o(l(c[2][2],c[3][3]),l(-c[2][3],c[3][2])),c[1][1]),o(m(o(l(c[2][1],c[3][3]),l(-c[2][3],c[3][1])),-c[1][2]),m(o(l(c[2][1],c[3][2]),l(-c[2][2],c[3][1])),c[1][3]))),c[0][0]),m(o(m(o(l(c[2][2],c[3][3]),l(-c[2][3],c[3][2])),c[1][0]),o(m(o(l(c[2][0],c[3][3]),l(-c[2][3],c[3][0])),-c[1][2]),m(o(l(c[2][0],c[3][2]),l(-c[2][2],c[3][0])),c[1][3]))),-c[0][1])),o(m(o(m(o(l(c[2][1],c[3][3]),l(-c[2][3],c[3][1])),c[1][0]),o(m(o(l(c[2][0],c[3][3]),l(-c[2][3],c[3][0])),-c[1][1]),m(o(l(c[2][0],c[3][1]),l(-c[2][1],c[3][0])),c[1][3]))),c[0][2]),m(o(m(o(l(c[2][1],c[3][2]),l(-c[2][2],c[3][1])),c[1][0]),o(m(o(l(c[2][0],c[3][2]),l(-c[2][2],c[3][0])),-c[1][1]),m(o(l(c[2][0],c[3][1]),l(-c[2][1],c[3][0])),c[1][2]))),-c[0][3]))))}}function x(o,m,l,w){return function(c){return w(o(o(m(o(o(m(o(m(o(l(c[3][3],c[4][4]),l(-c[3][4],c[4][3])),c[2][2]),o(m(o(l(c[3][2],c[4][4]),l(-c[3][4],c[4][2])),-c[2][3]),m(o(l(c[3][2],c[4][3]),l(-c[3][3],c[4][2])),c[2][4]))),c[1][1]),m(o(m(o(l(c[3][3],c[4][4]),l(-c[3][4],c[4][3])),c[2][1]),o(m(o(l(c[3][1],c[4][4]),l(-c[3][4],c[4][1])),-c[2][3]),m(o(l(c[3][1],c[4][3]),l(-c[3][3],c[4][1])),c[2][4]))),-c[1][2])),o(m(o(m(o(l(c[3][2],c[4][4]),l(-c[3][4],c[4][2])),c[2][1]),o(m(o(l(c[3][1],c[4][4]),l(-c[3][4],c[4][1])),-c[2][2]),m(o(l(c[3][1],c[4][2]),l(-c[3][2],c[4][1])),c[2][4]))),c[1][3]),m(o(m(o(l(c[3][2],c[4][3]),l(-c[3][3],c[4][2])),c[2][1]),o(m(o(l(c[3][1],c[4][3]),l(-c[3][3],c[4][1])),-c[2][2]),m(o(l(c[3][1],c[4][2]),l(-c[3][2],c[4][1])),c[2][3]))),-c[1][4]))),c[0][0]),m(o(o(m(o(m(o(l(c[3][3],c[4][4]),l(-c[3][4],c[4][3])),c[2][2]),o(m(o(l(c[3][2],c[4][4]),l(-c[3][4],c[4][2])),-c[2][3]),m(o(l(c[3][2],c[4][3]),l(-c[3][3],c[4][2])),c[2][4]))),c[1][0]),m(o(m(o(l(c[3][3],c[4][4]),l(-c[3][4],c[4][3])),c[2][0]),o(m(o(l(c[3][0],c[4][4]),l(-c[3][4],c[4][0])),-c[2][3]),m(o(l(c[3][0],c[4][3]),l(-c[3][3],c[4][0])),c[2][4]))),-c[1][2])),o(m(o(m(o(l(c[3][2],c[4][4]),l(-c[3][4],c[4][2])),c[2][0]),o(m(o(l(c[3][0],c[4][4]),l(-c[3][4],c[4][0])),-c[2][2]),m(o(l(c[3][0],c[4][2]),l(-c[3][2],c[4][0])),c[2][4]))),c[1][3]),m(o(m(o(l(c[3][2],c[4][3]),l(-c[3][3],c[4][2])),c[2][0]),o(m(o(l(c[3][0],c[4][3]),l(-c[3][3],c[4][0])),-c[2][2]),m(o(l(c[3][0],c[4][2]),l(-c[3][2],c[4][0])),c[2][3]))),-c[1][4]))),-c[0][1])),o(m(o(o(m(o(m(o(l(c[3][3],c[4][4]),l(-c[3][4],c[4][3])),c[2][1]),o(m(o(l(c[3][1],c[4][4]),l(-c[3][4],c[4][1])),-c[2][3]),m(o(l(c[3][1],c[4][3]),l(-c[3][3],c[4][1])),c[2][4]))),c[1][0]),m(o(m(o(l(c[3][3],c[4][4]),l(-c[3][4],c[4][3])),c[2][0]),o(m(o(l(c[3][0],c[4][4]),l(-c[3][4],c[4][0])),-c[2][3]),m(o(l(c[3][0],c[4][3]),l(-c[3][3],c[4][0])),c[2][4]))),-c[1][1])),o(m(o(m(o(l(c[3][1],c[4][4]),l(-c[3][4],c[4][1])),c[2][0]),o(m(o(l(c[3][0],c[4][4]),l(-c[3][4],c[4][0])),-c[2][1]),m(o(l(c[3][0],c[4][1]),l(-c[3][1],c[4][0])),c[2][4]))),c[1][3]),m(o(m(o(l(c[3][1],c[4][3]),l(-c[3][3],c[4][1])),c[2][0]),o(m(o(l(c[3][0],c[4][3]),l(-c[3][3],c[4][0])),-c[2][1]),m(o(l(c[3][0],c[4][1]),l(-c[3][1],c[4][0])),c[2][3]))),-c[1][4]))),c[0][2]),o(m(o(o(m(o(m(o(l(c[3][2],c[4][4]),l(-c[3][4],c[4][2])),c[2][1]),o(m(o(l(c[3][1],c[4][4]),l(-c[3][4],c[4][1])),-c[2][2]),m(o(l(c[3][1],c[4][2]),l(-c[3][2],c[4][1])),c[2][4]))),c[1][0]),m(o(m(o(l(c[3][2],c[4][4]),l(-c[3][4],c[4][2])),c[2][0]),o(m(o(l(c[3][0],c[4][4]),l(-c[3][4],c[4][0])),-c[2][2]),m(o(l(c[3][0],c[4][2]),l(-c[3][2],c[4][0])),c[2][4]))),-c[1][1])),o(m(o(m(o(l(c[3][1],c[4][4]),l(-c[3][4],c[4][1])),c[2][0]),o(m(o(l(c[3][0],c[4][4]),l(-c[3][4],c[4][0])),-c[2][1]),m(o(l(c[3][0],c[4][1]),l(-c[3][1],c[4][0])),c[2][4]))),c[1][2]),m(o(m(o(l(c[3][1],c[4][2]),l(-c[3][2],c[4][1])),c[2][0]),o(m(o(l(c[3][0],c[4][2]),l(-c[3][2],c[4][0])),-c[2][1]),m(o(l(c[3][0],c[4][1]),l(-c[3][1],c[4][0])),c[2][2]))),-c[1][4]))),-c[0][3]),m(o(o(m(o(m(o(l(c[3][2],c[4][3]),l(-c[3][3],c[4][2])),c[2][1]),o(m(o(l(c[3][1],c[4][3]),l(-c[3][3],c[4][1])),-c[2][2]),m(o(l(c[3][1],c[4][2]),l(-c[3][2],c[4][1])),c[2][3]))),c[1][0]),m(o(m(o(l(c[3][2],c[4][3]),l(-c[3][3],c[4][2])),c[2][0]),o(m(o(l(c[3][0],c[4][3]),l(-c[3][3],c[4][0])),-c[2][2]),m(o(l(c[3][0],c[4][2]),l(-c[3][2],c[4][0])),c[2][3]))),-c[1][1])),o(m(o(m(o(l(c[3][1],c[4][3]),l(-c[3][3],c[4][1])),c[2][0]),o(m(o(l(c[3][0],c[4][3]),l(-c[3][3],c[4][0])),-c[2][1]),m(o(l(c[3][0],c[4][1]),l(-c[3][1],c[4][0])),c[2][3]))),c[1][2]),m(o(m(o(l(c[3][1],c[4][2]),l(-c[3][2],c[4][1])),c[2][0]),o(m(o(l(c[3][0],c[4][2]),l(-c[3][2],c[4][0])),-c[2][1]),m(o(l(c[3][0],c[4][1]),l(-c[3][1],c[4][0])),c[2][2]))),-c[1][3]))),c[0][4])))))}}function p(o){var m=o===2?h:o===3?s:o===4?i:o===5?x:void 0;return m(a,n,e,r)}var v=[function(){return[0]},function(m){return[m[0][0]]}];function f(o,m,l,w,_,c,b,u){return function(T){switch(T.length){case 0:return o(T);case 1:return m(T);case 2:return l(T);case 3:return w(T);case 4:return _(T);case 5:return c(T)}var k=b[T.length];return k||(k=b[T.length]=u(T.length)),k(T)}}function d(){for(;v.length<t;)v.push(p(v.length));S.exports=f.apply(void 0,v.concat([v,p]));for(var o=0;o<v.length;++o)S.exports[o]=v[o]}d()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(g,S,M){var e=g("two-product"),a=g("robust-sum");S.exports=n;function n(r,t){for(var h=e(r[0],t[0]),s=1;s<r.length;++s)h=a(h,e(r[s],t[s]));return h}},{"robust-sum":289,"two-product":306}],282:[function(g,S,M){var e=g("two-product"),a=g("robust-sum"),n=g("robust-subtract"),r=g("robust-scale"),t=6;function h(_){var c=_===3?p:_===4?v:_===5?f:d;return c(a,n,e,r)}function s(){return 0}function i(){return 0}function x(){return 0}function p(_,c,b,u){function L(T,k,P){var z=b(T[0],T[0]),I=u(z,k[0]),D=u(z,P[0]),R=b(k[0],k[0]),O=u(R,T[0]),F=u(R,P[0]),N=b(P[0],P[0]),G=u(N,T[0]),K=u(N,k[0]),W=_(c(K,F),c(O,I)),Y=c(G,D),re=c(W,Y);return re[re.length-1]}return L}function v(_,c,b,u){function L(T,k,P,z){var I=_(b(T[0],T[0]),b(T[1],T[1])),D=u(I,k[0]),R=u(I,P[0]),O=u(I,z[0]),F=_(b(k[0],k[0]),b(k[1],k[1])),N=u(F,T[0]),G=u(F,P[0]),K=u(F,z[0]),W=_(b(P[0],P[0]),b(P[1],P[1])),Y=u(W,T[0]),re=u(W,k[0]),ue=u(W,z[0]),j=_(b(z[0],z[0]),b(z[1],z[1])),q=u(j,T[0]),H=u(j,k[0]),U=u(j,P[0]),$=_(_(u(c(U,ue),k[1]),_(u(c(H,K),-P[1]),u(c(re,G),z[1]))),_(u(c(H,K),T[1]),_(u(c(q,O),-k[1]),u(c(N,D),z[1])))),ne=_(_(u(c(U,ue),T[1]),_(u(c(q,O),-P[1]),u(c(Y,R),z[1]))),_(u(c(re,G),T[1]),_(u(c(Y,R),-k[1]),u(c(N,D),P[1])))),X=c($,ne);return X[X.length-1]}return L}function f(_,c,b,u){function L(T,k,P,z,I){var D=_(b(T[0],T[0]),_(b(T[1],T[1]),b(T[2],T[2]))),R=u(D,k[0]),O=u(D,P[0]),F=u(D,z[0]),N=u(D,I[0]),G=_(b(k[0],k[0]),_(b(k[1],k[1]),b(k[2],k[2]))),K=u(G,T[0]),W=u(G,P[0]),Y=u(G,z[0]),re=u(G,I[0]),ue=_(b(P[0],P[0]),_(b(P[1],P[1]),b(P[2],P[2]))),j=u(ue,T[0]),q=u(ue,k[0]),H=u(ue,z[0]),U=u(ue,I[0]),$=_(b(z[0],z[0]),_(b(z[1],z[1]),b(z[2],z[2]))),ne=u($,T[0]),X=u($,k[0]),Q=u($,P[0]),ie=u($,I[0]),se=_(b(I[0],I[0]),_(b(I[1],I[1]),b(I[2],I[2]))),ae=u(se,T[0]),oe=u(se,k[0]),be=u(se,P[0]),ce=u(se,z[0]),de=_(_(_(u(_(u(c(ce,ie),P[1]),_(u(c(be,U),-z[1]),u(c(Q,H),I[1]))),k[2]),_(u(_(u(c(ce,ie),k[1]),_(u(c(oe,re),-z[1]),u(c(X,Y),I[1]))),-P[2]),u(_(u(c(be,U),k[1]),_(u(c(oe,re),-P[1]),u(c(q,W),I[1]))),z[2]))),_(u(_(u(c(Q,H),k[1]),_(u(c(X,Y),-P[1]),u(c(q,W),z[1]))),-I[2]),_(u(_(u(c(ce,ie),k[1]),_(u(c(oe,re),-z[1]),u(c(X,Y),I[1]))),T[2]),u(_(u(c(ce,ie),T[1]),_(u(c(ae,N),-z[1]),u(c(ne,F),I[1]))),-k[2])))),_(_(u(_(u(c(oe,re),T[1]),_(u(c(ae,N),-k[1]),u(c(K,R),I[1]))),z[2]),_(u(_(u(c(X,Y),T[1]),_(u(c(ne,F),-k[1]),u(c(K,R),z[1]))),-I[2]),u(_(u(c(Q,H),k[1]),_(u(c(X,Y),-P[1]),u(c(q,W),z[1]))),T[2]))),_(u(_(u(c(Q,H),T[1]),_(u(c(ne,F),-P[1]),u(c(j,O),z[1]))),-k[2]),_(u(_(u(c(X,Y),T[1]),_(u(c(ne,F),-k[1]),u(c(K,R),z[1]))),P[2]),u(_(u(c(q,W),T[1]),_(u(c(j,O),-k[1]),u(c(K,R),P[1]))),-z[2]))))),ye=_(_(_(u(_(u(c(ce,ie),P[1]),_(u(c(be,U),-z[1]),u(c(Q,H),I[1]))),T[2]),u(_(u(c(ce,ie),T[1]),_(u(c(ae,N),-z[1]),u(c(ne,F),I[1]))),-P[2])),_(u(_(u(c(be,U),T[1]),_(u(c(ae,N),-P[1]),u(c(j,O),I[1]))),z[2]),u(_(u(c(Q,H),T[1]),_(u(c(ne,F),-P[1]),u(c(j,O),z[1]))),-I[2]))),_(_(u(_(u(c(be,U),k[1]),_(u(c(oe,re),-P[1]),u(c(q,W),I[1]))),T[2]),u(_(u(c(be,U),T[1]),_(u(c(ae,N),-P[1]),u(c(j,O),I[1]))),-k[2])),_(u(_(u(c(oe,re),T[1]),_(u(c(ae,N),-k[1]),u(c(K,R),I[1]))),P[2]),u(_(u(c(q,W),T[1]),_(u(c(j,O),-k[1]),u(c(K,R),P[1]))),-I[2])))),ge=c(de,ye);return ge[ge.length-1]}return L}function d(_,c,b,u){function L(T,k,P,z,I,D){var R=_(_(b(T[0],T[0]),b(T[1],T[1])),_(b(T[2],T[2]),b(T[3],T[3]))),O=u(R,k[0]),F=u(R,P[0]),N=u(R,z[0]),G=u(R,I[0]),K=u(R,D[0]),W=_(_(b(k[0],k[0]),b(k[1],k[1])),_(b(k[2],k[2]),b(k[3],k[3]))),Y=u(W,T[0]),re=u(W,P[0]),ue=u(W,z[0]),j=u(W,I[0]),q=u(W,D[0]),H=_(_(b(P[0],P[0]),b(P[1],P[1])),_(b(P[2],P[2]),b(P[3],P[3]))),U=u(H,T[0]),$=u(H,k[0]),ne=u(H,z[0]),X=u(H,I[0]),Q=u(H,D[0]),ie=_(_(b(z[0],z[0]),b(z[1],z[1])),_(b(z[2],z[2]),b(z[3],z[3]))),se=u(ie,T[0]),ae=u(ie,k[0]),oe=u(ie,P[0]),be=u(ie,I[0]),ce=u(ie,D[0]),de=_(_(b(I[0],I[0]),b(I[1],I[1])),_(b(I[2],I[2]),b(I[3],I[3]))),ye=u(de,T[0]),ge=u(de,k[0]),me=u(de,P[0]),Ee=u(de,z[0]),Pe=u(de,D[0]),Ue=_(_(b(D[0],D[0]),b(D[1],D[1])),_(b(D[2],D[2]),b(D[3],D[3]))),we=u(Ue,T[0]),ke=u(Ue,k[0]),Xe=u(Ue,P[0]),Ve=u(Ue,z[0]),Ie=u(Ue,I[0]),De=_(_(_(u(_(_(u(_(u(c(Ie,Pe),z[1]),_(u(c(Ve,ce),-I[1]),u(c(Ee,be),D[1]))),P[2]),u(_(u(c(Ie,Pe),P[1]),_(u(c(Xe,Q),-I[1]),u(c(me,X),D[1]))),-z[2])),_(u(_(u(c(Ve,ce),P[1]),_(u(c(Xe,Q),-z[1]),u(c(oe,ne),D[1]))),I[2]),u(_(u(c(Ee,be),P[1]),_(u(c(me,X),-z[1]),u(c(oe,ne),I[1]))),-D[2]))),k[3]),_(u(_(_(u(_(u(c(Ie,Pe),z[1]),_(u(c(Ve,ce),-I[1]),u(c(Ee,be),D[1]))),k[2]),u(_(u(c(Ie,Pe),k[1]),_(u(c(ke,q),-I[1]),u(c(ge,j),D[1]))),-z[2])),_(u(_(u(c(Ve,ce),k[1]),_(u(c(ke,q),-z[1]),u(c(ae,ue),D[1]))),I[2]),u(_(u(c(Ee,be),k[1]),_(u(c(ge,j),-z[1]),u(c(ae,ue),I[1]))),-D[2]))),-P[3]),u(_(_(u(_(u(c(Ie,Pe),P[1]),_(u(c(Xe,Q),-I[1]),u(c(me,X),D[1]))),k[2]),u(_(u(c(Ie,Pe),k[1]),_(u(c(ke,q),-I[1]),u(c(ge,j),D[1]))),-P[2])),_(u(_(u(c(Xe,Q),k[1]),_(u(c(ke,q),-P[1]),u(c($,re),D[1]))),I[2]),u(_(u(c(me,X),k[1]),_(u(c(ge,j),-P[1]),u(c($,re),I[1]))),-D[2]))),z[3]))),_(_(u(_(_(u(_(u(c(Ve,ce),P[1]),_(u(c(Xe,Q),-z[1]),u(c(oe,ne),D[1]))),k[2]),u(_(u(c(Ve,ce),k[1]),_(u(c(ke,q),-z[1]),u(c(ae,ue),D[1]))),-P[2])),_(u(_(u(c(Xe,Q),k[1]),_(u(c(ke,q),-P[1]),u(c($,re),D[1]))),z[2]),u(_(u(c(oe,ne),k[1]),_(u(c(ae,ue),-P[1]),u(c($,re),z[1]))),-D[2]))),-I[3]),u(_(_(u(_(u(c(Ee,be),P[1]),_(u(c(me,X),-z[1]),u(c(oe,ne),I[1]))),k[2]),u(_(u(c(Ee,be),k[1]),_(u(c(ge,j),-z[1]),u(c(ae,ue),I[1]))),-P[2])),_(u(_(u(c(me,X),k[1]),_(u(c(ge,j),-P[1]),u(c($,re),I[1]))),z[2]),u(_(u(c(oe,ne),k[1]),_(u(c(ae,ue),-P[1]),u(c($,re),z[1]))),-I[2]))),D[3])),_(u(_(_(u(_(u(c(Ie,Pe),z[1]),_(u(c(Ve,ce),-I[1]),u(c(Ee,be),D[1]))),k[2]),u(_(u(c(Ie,Pe),k[1]),_(u(c(ke,q),-I[1]),u(c(ge,j),D[1]))),-z[2])),_(u(_(u(c(Ve,ce),k[1]),_(u(c(ke,q),-z[1]),u(c(ae,ue),D[1]))),I[2]),u(_(u(c(Ee,be),k[1]),_(u(c(ge,j),-z[1]),u(c(ae,ue),I[1]))),-D[2]))),T[3]),u(_(_(u(_(u(c(Ie,Pe),z[1]),_(u(c(Ve,ce),-I[1]),u(c(Ee,be),D[1]))),T[2]),u(_(u(c(Ie,Pe),T[1]),_(u(c(we,K),-I[1]),u(c(ye,G),D[1]))),-z[2])),_(u(_(u(c(Ve,ce),T[1]),_(u(c(we,K),-z[1]),u(c(se,N),D[1]))),I[2]),u(_(u(c(Ee,be),T[1]),_(u(c(ye,G),-z[1]),u(c(se,N),I[1]))),-D[2]))),-k[3])))),_(_(_(u(_(_(u(_(u(c(Ie,Pe),k[1]),_(u(c(ke,q),-I[1]),u(c(ge,j),D[1]))),T[2]),u(_(u(c(Ie,Pe),T[1]),_(u(c(we,K),-I[1]),u(c(ye,G),D[1]))),-k[2])),_(u(_(u(c(ke,q),T[1]),_(u(c(we,K),-k[1]),u(c(Y,O),D[1]))),I[2]),u(_(u(c(ge,j),T[1]),_(u(c(ye,G),-k[1]),u(c(Y,O),I[1]))),-D[2]))),z[3]),u(_(_(u(_(u(c(Ve,ce),k[1]),_(u(c(ke,q),-z[1]),u(c(ae,ue),D[1]))),T[2]),u(_(u(c(Ve,ce),T[1]),_(u(c(we,K),-z[1]),u(c(se,N),D[1]))),-k[2])),_(u(_(u(c(ke,q),T[1]),_(u(c(we,K),-k[1]),u(c(Y,O),D[1]))),z[2]),u(_(u(c(ae,ue),T[1]),_(u(c(se,N),-k[1]),u(c(Y,O),z[1]))),-D[2]))),-I[3])),_(u(_(_(u(_(u(c(Ee,be),k[1]),_(u(c(ge,j),-z[1]),u(c(ae,ue),I[1]))),T[2]),u(_(u(c(Ee,be),T[1]),_(u(c(ye,G),-z[1]),u(c(se,N),I[1]))),-k[2])),_(u(_(u(c(ge,j),T[1]),_(u(c(ye,G),-k[1]),u(c(Y,O),I[1]))),z[2]),u(_(u(c(ae,ue),T[1]),_(u(c(se,N),-k[1]),u(c(Y,O),z[1]))),-I[2]))),D[3]),u(_(_(u(_(u(c(Ve,ce),P[1]),_(u(c(Xe,Q),-z[1]),u(c(oe,ne),D[1]))),k[2]),u(_(u(c(Ve,ce),k[1]),_(u(c(ke,q),-z[1]),u(c(ae,ue),D[1]))),-P[2])),_(u(_(u(c(Xe,Q),k[1]),_(u(c(ke,q),-P[1]),u(c($,re),D[1]))),z[2]),u(_(u(c(oe,ne),k[1]),_(u(c(ae,ue),-P[1]),u(c($,re),z[1]))),-D[2]))),T[3]))),_(_(u(_(_(u(_(u(c(Ve,ce),P[1]),_(u(c(Xe,Q),-z[1]),u(c(oe,ne),D[1]))),T[2]),u(_(u(c(Ve,ce),T[1]),_(u(c(we,K),-z[1]),u(c(se,N),D[1]))),-P[2])),_(u(_(u(c(Xe,Q),T[1]),_(u(c(we,K),-P[1]),u(c(U,F),D[1]))),z[2]),u(_(u(c(oe,ne),T[1]),_(u(c(se,N),-P[1]),u(c(U,F),z[1]))),-D[2]))),-k[3]),u(_(_(u(_(u(c(Ve,ce),k[1]),_(u(c(ke,q),-z[1]),u(c(ae,ue),D[1]))),T[2]),u(_(u(c(Ve,ce),T[1]),_(u(c(we,K),-z[1]),u(c(se,N),D[1]))),-k[2])),_(u(_(u(c(ke,q),T[1]),_(u(c(we,K),-k[1]),u(c(Y,O),D[1]))),z[2]),u(_(u(c(ae,ue),T[1]),_(u(c(se,N),-k[1]),u(c(Y,O),z[1]))),-D[2]))),P[3])),_(u(_(_(u(_(u(c(Xe,Q),k[1]),_(u(c(ke,q),-P[1]),u(c($,re),D[1]))),T[2]),u(_(u(c(Xe,Q),T[1]),_(u(c(we,K),-P[1]),u(c(U,F),D[1]))),-k[2])),_(u(_(u(c(ke,q),T[1]),_(u(c(we,K),-k[1]),u(c(Y,O),D[1]))),P[2]),u(_(u(c($,re),T[1]),_(u(c(U,F),-k[1]),u(c(Y,O),P[1]))),-D[2]))),-z[3]),u(_(_(u(_(u(c(oe,ne),k[1]),_(u(c(ae,ue),-P[1]),u(c($,re),z[1]))),T[2]),u(_(u(c(oe,ne),T[1]),_(u(c(se,N),-P[1]),u(c(U,F),z[1]))),-k[2])),_(u(_(u(c(ae,ue),T[1]),_(u(c(se,N),-k[1]),u(c(Y,O),z[1]))),P[2]),u(_(u(c($,re),T[1]),_(u(c(U,F),-k[1]),u(c(Y,O),P[1]))),-z[2]))),D[3]))))),Ye=_(_(_(u(_(_(u(_(u(c(Ie,Pe),z[1]),_(u(c(Ve,ce),-I[1]),u(c(Ee,be),D[1]))),P[2]),u(_(u(c(Ie,Pe),P[1]),_(u(c(Xe,Q),-I[1]),u(c(me,X),D[1]))),-z[2])),_(u(_(u(c(Ve,ce),P[1]),_(u(c(Xe,Q),-z[1]),u(c(oe,ne),D[1]))),I[2]),u(_(u(c(Ee,be),P[1]),_(u(c(me,X),-z[1]),u(c(oe,ne),I[1]))),-D[2]))),T[3]),_(u(_(_(u(_(u(c(Ie,Pe),z[1]),_(u(c(Ve,ce),-I[1]),u(c(Ee,be),D[1]))),T[2]),u(_(u(c(Ie,Pe),T[1]),_(u(c(we,K),-I[1]),u(c(ye,G),D[1]))),-z[2])),_(u(_(u(c(Ve,ce),T[1]),_(u(c(we,K),-z[1]),u(c(se,N),D[1]))),I[2]),u(_(u(c(Ee,be),T[1]),_(u(c(ye,G),-z[1]),u(c(se,N),I[1]))),-D[2]))),-P[3]),u(_(_(u(_(u(c(Ie,Pe),P[1]),_(u(c(Xe,Q),-I[1]),u(c(me,X),D[1]))),T[2]),u(_(u(c(Ie,Pe),T[1]),_(u(c(we,K),-I[1]),u(c(ye,G),D[1]))),-P[2])),_(u(_(u(c(Xe,Q),T[1]),_(u(c(we,K),-P[1]),u(c(U,F),D[1]))),I[2]),u(_(u(c(me,X),T[1]),_(u(c(ye,G),-P[1]),u(c(U,F),I[1]))),-D[2]))),z[3]))),_(_(u(_(_(u(_(u(c(Ve,ce),P[1]),_(u(c(Xe,Q),-z[1]),u(c(oe,ne),D[1]))),T[2]),u(_(u(c(Ve,ce),T[1]),_(u(c(we,K),-z[1]),u(c(se,N),D[1]))),-P[2])),_(u(_(u(c(Xe,Q),T[1]),_(u(c(we,K),-P[1]),u(c(U,F),D[1]))),z[2]),u(_(u(c(oe,ne),T[1]),_(u(c(se,N),-P[1]),u(c(U,F),z[1]))),-D[2]))),-I[3]),u(_(_(u(_(u(c(Ee,be),P[1]),_(u(c(me,X),-z[1]),u(c(oe,ne),I[1]))),T[2]),u(_(u(c(Ee,be),T[1]),_(u(c(ye,G),-z[1]),u(c(se,N),I[1]))),-P[2])),_(u(_(u(c(me,X),T[1]),_(u(c(ye,G),-P[1]),u(c(U,F),I[1]))),z[2]),u(_(u(c(oe,ne),T[1]),_(u(c(se,N),-P[1]),u(c(U,F),z[1]))),-I[2]))),D[3])),_(u(_(_(u(_(u(c(Ie,Pe),P[1]),_(u(c(Xe,Q),-I[1]),u(c(me,X),D[1]))),k[2]),u(_(u(c(Ie,Pe),k[1]),_(u(c(ke,q),-I[1]),u(c(ge,j),D[1]))),-P[2])),_(u(_(u(c(Xe,Q),k[1]),_(u(c(ke,q),-P[1]),u(c($,re),D[1]))),I[2]),u(_(u(c(me,X),k[1]),_(u(c(ge,j),-P[1]),u(c($,re),I[1]))),-D[2]))),T[3]),u(_(_(u(_(u(c(Ie,Pe),P[1]),_(u(c(Xe,Q),-I[1]),u(c(me,X),D[1]))),T[2]),u(_(u(c(Ie,Pe),T[1]),_(u(c(we,K),-I[1]),u(c(ye,G),D[1]))),-P[2])),_(u(_(u(c(Xe,Q),T[1]),_(u(c(we,K),-P[1]),u(c(U,F),D[1]))),I[2]),u(_(u(c(me,X),T[1]),_(u(c(ye,G),-P[1]),u(c(U,F),I[1]))),-D[2]))),-k[3])))),_(_(_(u(_(_(u(_(u(c(Ie,Pe),k[1]),_(u(c(ke,q),-I[1]),u(c(ge,j),D[1]))),T[2]),u(_(u(c(Ie,Pe),T[1]),_(u(c(we,K),-I[1]),u(c(ye,G),D[1]))),-k[2])),_(u(_(u(c(ke,q),T[1]),_(u(c(we,K),-k[1]),u(c(Y,O),D[1]))),I[2]),u(_(u(c(ge,j),T[1]),_(u(c(ye,G),-k[1]),u(c(Y,O),I[1]))),-D[2]))),P[3]),u(_(_(u(_(u(c(Xe,Q),k[1]),_(u(c(ke,q),-P[1]),u(c($,re),D[1]))),T[2]),u(_(u(c(Xe,Q),T[1]),_(u(c(we,K),-P[1]),u(c(U,F),D[1]))),-k[2])),_(u(_(u(c(ke,q),T[1]),_(u(c(we,K),-k[1]),u(c(Y,O),D[1]))),P[2]),u(_(u(c($,re),T[1]),_(u(c(U,F),-k[1]),u(c(Y,O),P[1]))),-D[2]))),-I[3])),_(u(_(_(u(_(u(c(me,X),k[1]),_(u(c(ge,j),-P[1]),u(c($,re),I[1]))),T[2]),u(_(u(c(me,X),T[1]),_(u(c(ye,G),-P[1]),u(c(U,F),I[1]))),-k[2])),_(u(_(u(c(ge,j),T[1]),_(u(c(ye,G),-k[1]),u(c(Y,O),I[1]))),P[2]),u(_(u(c($,re),T[1]),_(u(c(U,F),-k[1]),u(c(Y,O),P[1]))),-I[2]))),D[3]),u(_(_(u(_(u(c(Ee,be),P[1]),_(u(c(me,X),-z[1]),u(c(oe,ne),I[1]))),k[2]),u(_(u(c(Ee,be),k[1]),_(u(c(ge,j),-z[1]),u(c(ae,ue),I[1]))),-P[2])),_(u(_(u(c(me,X),k[1]),_(u(c(ge,j),-P[1]),u(c($,re),I[1]))),z[2]),u(_(u(c(oe,ne),k[1]),_(u(c(ae,ue),-P[1]),u(c($,re),z[1]))),-I[2]))),T[3]))),_(_(u(_(_(u(_(u(c(Ee,be),P[1]),_(u(c(me,X),-z[1]),u(c(oe,ne),I[1]))),T[2]),u(_(u(c(Ee,be),T[1]),_(u(c(ye,G),-z[1]),u(c(se,N),I[1]))),-P[2])),_(u(_(u(c(me,X),T[1]),_(u(c(ye,G),-P[1]),u(c(U,F),I[1]))),z[2]),u(_(u(c(oe,ne),T[1]),_(u(c(se,N),-P[1]),u(c(U,F),z[1]))),-I[2]))),-k[3]),u(_(_(u(_(u(c(Ee,be),k[1]),_(u(c(ge,j),-z[1]),u(c(ae,ue),I[1]))),T[2]),u(_(u(c(Ee,be),T[1]),_(u(c(ye,G),-z[1]),u(c(se,N),I[1]))),-k[2])),_(u(_(u(c(ge,j),T[1]),_(u(c(ye,G),-k[1]),u(c(Y,O),I[1]))),z[2]),u(_(u(c(ae,ue),T[1]),_(u(c(se,N),-k[1]),u(c(Y,O),z[1]))),-I[2]))),P[3])),_(u(_(_(u(_(u(c(me,X),k[1]),_(u(c(ge,j),-P[1]),u(c($,re),I[1]))),T[2]),u(_(u(c(me,X),T[1]),_(u(c(ye,G),-P[1]),u(c(U,F),I[1]))),-k[2])),_(u(_(u(c(ge,j),T[1]),_(u(c(ye,G),-k[1]),u(c(Y,O),I[1]))),P[2]),u(_(u(c($,re),T[1]),_(u(c(U,F),-k[1]),u(c(Y,O),P[1]))),-I[2]))),-z[3]),u(_(_(u(_(u(c(oe,ne),k[1]),_(u(c(ae,ue),-P[1]),u(c($,re),z[1]))),T[2]),u(_(u(c(oe,ne),T[1]),_(u(c(se,N),-P[1]),u(c(U,F),z[1]))),-k[2])),_(u(_(u(c(ae,ue),T[1]),_(u(c(se,N),-k[1]),u(c(Y,O),z[1]))),P[2]),u(_(u(c($,re),T[1]),_(u(c(U,F),-k[1]),u(c(Y,O),P[1]))),-z[2]))),I[3]))))),vt=c(De,Ye);return vt[vt.length-1]}return L}var o=[s,i,x];function m(_){var c=o[_.length];return c||(c=o[_.length]=h(_.length)),c.apply(void 0,_)}function l(_,c,b,u,L,T,k,P){function z(I,D,R,O,F,N){switch(arguments.length){case 0:case 1:return 0;case 2:return u(I,D);case 3:return L(I,D,R);case 4:return T(I,D,R,O);case 5:return k(I,D,R,O,F);case 6:return P(I,D,R,O,F,N)}for(var G=new Array(arguments.length),K=0;K<arguments.length;++K)G[K]=arguments[K];return _(G)}return z}function w(){for(;o.length<=t;)o.push(h(o.length));S.exports=l.apply(void 0,[m].concat(o));for(var _=0;_<=t;++_)S.exports[_]=o[_]}w()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(g,S,M){var e=g("robust-determinant"),a=6;function n(o){var m=o===2?h:o===3?s:o===4?i:o===5?x:p;return o<6?m(e[o]):m(e)}function r(){return[[0]]}function t(o,m){return[[m[0]],[o[0][0]]]}function h(o){return function(l,w){return[o([[+w[0],+l[0][1]],[+w[1],+l[1][1]]]),o([[+l[0][0],+w[0]],[+l[1][0],+w[1]]]),o(l)]}}function s(o){return function(l,w){return[o([[+w[0],+l[0][1],+l[0][2]],[+w[1],+l[1][1],+l[1][2]],[+w[2],+l[2][1],+l[2][2]]]),o([[+l[0][0],+w[0],+l[0][2]],[+l[1][0],+w[1],+l[1][2]],[+l[2][0],+w[2],+l[2][2]]]),o([[+l[0][0],+l[0][1],+w[0]],[+l[1][0],+l[1][1],+w[1]],[+l[2][0],+l[2][1],+w[2]]]),o(l)]}}function i(o){return function(l,w){return[o([[+w[0],+l[0][1],+l[0][2],+l[0][3]],[+w[1],+l[1][1],+l[1][2],+l[1][3]],[+w[2],+l[2][1],+l[2][2],+l[2][3]],[+w[3],+l[3][1],+l[3][2],+l[3][3]]]),o([[+l[0][0],+w[0],+l[0][2],+l[0][3]],[+l[1][0],+w[1],+l[1][2],+l[1][3]],[+l[2][0],+w[2],+l[2][2],+l[2][3]],[+l[3][0],+w[3],+l[3][2],+l[3][3]]]),o([[+l[0][0],+l[0][1],+w[0],+l[0][3]],[+l[1][0],+l[1][1],+w[1],+l[1][3]],[+l[2][0],+l[2][1],+w[2],+l[2][3]],[+l[3][0],+l[3][1],+w[3],+l[3][3]]]),o([[+l[0][0],+l[0][1],+l[0][2],+w[0]],[+l[1][0],+l[1][1],+l[1][2],+w[1]],[+l[2][0],+l[2][1],+l[2][2],+w[2]],[+l[3][0],+l[3][1],+l[3][2],+w[3]]]),o(l)]}}function x(o){return function(l,w){return[o([[+w[0],+l[0][1],+l[0][2],+l[0][3],+l[0][4]],[+w[1],+l[1][1],+l[1][2],+l[1][3],+l[1][4]],[+w[2],+l[2][1],+l[2][2],+l[2][3],+l[2][4]],[+w[3],+l[3][1],+l[3][2],+l[3][3],+l[3][4]],[+w[4],+l[4][1],+l[4][2],+l[4][3],+l[4][4]]]),o([[+l[0][0],+w[0],+l[0][2],+l[0][3],+l[0][4]],[+l[1][0],+w[1],+l[1][2],+l[1][3],+l[1][4]],[+l[2][0],+w[2],+l[2][2],+l[2][3],+l[2][4]],[+l[3][0],+w[3],+l[3][2],+l[3][3],+l[3][4]],[+l[4][0],+w[4],+l[4][2],+l[4][3],+l[4][4]]]),o([[+l[0][0],+l[0][1],+w[0],+l[0][3],+l[0][4]],[+l[1][0],+l[1][1],+w[1],+l[1][3],+l[1][4]],[+l[2][0],+l[2][1],+w[2],+l[2][3],+l[2][4]],[+l[3][0],+l[3][1],+w[3],+l[3][3],+l[3][4]],[+l[4][0],+l[4][1],+w[4],+l[4][3],+l[4][4]]]),o([[+l[0][0],+l[0][1],+l[0][2],+w[0],+l[0][4]],[+l[1][0],+l[1][1],+l[1][2],+w[1],+l[1][4]],[+l[2][0],+l[2][1],+l[2][2],+w[2],+l[2][4]],[+l[3][0],+l[3][1],+l[3][2],+w[3],+l[3][4]],[+l[4][0],+l[4][1],+l[4][2],+w[4],+l[4][4]]]),o([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+w[0]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+w[1]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+w[2]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+w[3]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+w[4]]]),o(l)]}}function p(o){return function(l,w){return[o([[+w[0],+l[0][1],+l[0][2],+l[0][3],+l[0][4],+l[0][5]],[+w[1],+l[1][1],+l[1][2],+l[1][3],+l[1][4],+l[1][5]],[+w[2],+l[2][1],+l[2][2],+l[2][3],+l[2][4],+l[2][5]],[+w[3],+l[3][1],+l[3][2],+l[3][3],+l[3][4],+l[3][5]],[+w[4],+l[4][1],+l[4][2],+l[4][3],+l[4][4],+l[4][5]],[+w[5],+l[5][1],+l[5][2],+l[5][3],+l[5][4],+l[5][5]]]),o([[+l[0][0],+w[0],+l[0][2],+l[0][3],+l[0][4],+l[0][5]],[+l[1][0],+w[1],+l[1][2],+l[1][3],+l[1][4],+l[1][5]],[+l[2][0],+w[2],+l[2][2],+l[2][3],+l[2][4],+l[2][5]],[+l[3][0],+w[3],+l[3][2],+l[3][3],+l[3][4],+l[3][5]],[+l[4][0],+w[4],+l[4][2],+l[4][3],+l[4][4],+l[4][5]],[+l[5][0],+w[5],+l[5][2],+l[5][3],+l[5][4],+l[5][5]]]),o([[+l[0][0],+l[0][1],+w[0],+l[0][3],+l[0][4],+l[0][5]],[+l[1][0],+l[1][1],+w[1],+l[1][3],+l[1][4],+l[1][5]],[+l[2][0],+l[2][1],+w[2],+l[2][3],+l[2][4],+l[2][5]],[+l[3][0],+l[3][1],+w[3],+l[3][3],+l[3][4],+l[3][5]],[+l[4][0],+l[4][1],+w[4],+l[4][3],+l[4][4],+l[4][5]],[+l[5][0],+l[5][1],+w[5],+l[5][3],+l[5][4],+l[5][5]]]),o([[+l[0][0],+l[0][1],+l[0][2],+w[0],+l[0][4],+l[0][5]],[+l[1][0],+l[1][1],+l[1][2],+w[1],+l[1][4],+l[1][5]],[+l[2][0],+l[2][1],+l[2][2],+w[2],+l[2][4],+l[2][5]],[+l[3][0],+l[3][1],+l[3][2],+w[3],+l[3][4],+l[3][5]],[+l[4][0],+l[4][1],+l[4][2],+w[4],+l[4][4],+l[4][5]],[+l[5][0],+l[5][1],+l[5][2],+w[5],+l[5][4],+l[5][5]]]),o([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+w[0],+l[0][5]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+w[1],+l[1][5]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+w[2],+l[2][5]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+w[3],+l[3][5]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+w[4],+l[4][5]],[+l[5][0],+l[5][1],+l[5][2],+l[5][3],+w[5],+l[5][5]]]),o([[+l[0][0],+l[0][1],+l[0][2],+l[0][3],+l[0][4],+w[0]],[+l[1][0],+l[1][1],+l[1][2],+l[1][3],+l[1][4],+w[1]],[+l[2][0],+l[2][1],+l[2][2],+l[2][3],+l[2][4],+w[2]],[+l[3][0],+l[3][1],+l[3][2],+l[3][3],+l[3][4],+w[3]],[+l[4][0],+l[4][1],+l[4][2],+l[4][3],+l[4][4],+w[4]],[+l[5][0],+l[5][1],+l[5][2],+l[5][3],+l[5][4],+w[5]]]),o(l)]}}var v=[r,t];function f(o,m,l,w,_,c,b,u){return function(T,k){switch(T.length){case 0:return o(T,k);case 1:return m(T,k);case 2:return l(T,k);case 3:return w(T,k);case 4:return _(T,k);case 5:return c(T,k)}var P=b[T.length];return P||(P=b[T.length]=u(T.length)),P(T,k)}}function d(){for(;v.length<a;)v.push(n(v.length));S.exports=f.apply(void 0,v.concat([v,n]));for(var o=0;o<a;++o)S.exports[o]=v[o]}d()},{"robust-determinant":280}],284:[function(g,S,M){var e=g("two-product"),a=g("robust-sum"),n=g("robust-scale"),r=g("robust-subtract"),t=5,h=11102230246251565e-32,s=(3+16*h)*h,i=(7+56*h)*h;function x(c,b,u,L){return function(k,P,z){var I=c(c(b(P[1],z[0]),b(-z[1],P[0])),c(b(k[1],P[0]),b(-P[1],k[0]))),D=c(b(k[1],z[0]),b(-z[1],k[0])),R=L(I,D);return R[R.length-1]}}function p(c,b,u,L){return function(k,P,z,I){var D=c(c(u(c(b(z[1],I[0]),b(-I[1],z[0])),P[2]),c(u(c(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),u(c(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),c(u(c(b(P[1],I[0]),b(-I[1],P[0])),k[2]),c(u(c(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),u(c(b(k[1],P[0]),b(-P[1],k[0])),I[2])))),R=c(c(u(c(b(z[1],I[0]),b(-I[1],z[0])),k[2]),c(u(c(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),u(c(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),c(u(c(b(P[1],z[0]),b(-z[1],P[0])),k[2]),c(u(c(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),u(c(b(k[1],P[0]),b(-P[1],k[0])),z[2])))),O=L(D,R);return O[O.length-1]}}function v(c,b,u,L){return function(k,P,z,I,D){var R=c(c(c(u(c(u(c(b(I[1],D[0]),b(-D[1],I[0])),z[2]),c(u(c(b(z[1],D[0]),b(-D[1],z[0])),-I[2]),u(c(b(z[1],I[0]),b(-I[1],z[0])),D[2]))),P[3]),c(u(c(u(c(b(I[1],D[0]),b(-D[1],I[0])),P[2]),c(u(c(b(P[1],D[0]),b(-D[1],P[0])),-I[2]),u(c(b(P[1],I[0]),b(-I[1],P[0])),D[2]))),-z[3]),u(c(u(c(b(z[1],D[0]),b(-D[1],z[0])),P[2]),c(u(c(b(P[1],D[0]),b(-D[1],P[0])),-z[2]),u(c(b(P[1],z[0]),b(-z[1],P[0])),D[2]))),I[3]))),c(u(c(u(c(b(z[1],I[0]),b(-I[1],z[0])),P[2]),c(u(c(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),u(c(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),-D[3]),c(u(c(u(c(b(I[1],D[0]),b(-D[1],I[0])),P[2]),c(u(c(b(P[1],D[0]),b(-D[1],P[0])),-I[2]),u(c(b(P[1],I[0]),b(-I[1],P[0])),D[2]))),k[3]),u(c(u(c(b(I[1],D[0]),b(-D[1],I[0])),k[2]),c(u(c(b(k[1],D[0]),b(-D[1],k[0])),-I[2]),u(c(b(k[1],I[0]),b(-I[1],k[0])),D[2]))),-P[3])))),c(c(u(c(u(c(b(P[1],D[0]),b(-D[1],P[0])),k[2]),c(u(c(b(k[1],D[0]),b(-D[1],k[0])),-P[2]),u(c(b(k[1],P[0]),b(-P[1],k[0])),D[2]))),I[3]),c(u(c(u(c(b(P[1],I[0]),b(-I[1],P[0])),k[2]),c(u(c(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),u(c(b(k[1],P[0]),b(-P[1],k[0])),I[2]))),-D[3]),u(c(u(c(b(z[1],I[0]),b(-I[1],z[0])),P[2]),c(u(c(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),u(c(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),k[3]))),c(u(c(u(c(b(z[1],I[0]),b(-I[1],z[0])),k[2]),c(u(c(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),u(c(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),-P[3]),c(u(c(u(c(b(P[1],I[0]),b(-I[1],P[0])),k[2]),c(u(c(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),u(c(b(k[1],P[0]),b(-P[1],k[0])),I[2]))),z[3]),u(c(u(c(b(P[1],z[0]),b(-z[1],P[0])),k[2]),c(u(c(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),u(c(b(k[1],P[0]),b(-P[1],k[0])),z[2]))),-I[3]))))),O=c(c(c(u(c(u(c(b(I[1],D[0]),b(-D[1],I[0])),z[2]),c(u(c(b(z[1],D[0]),b(-D[1],z[0])),-I[2]),u(c(b(z[1],I[0]),b(-I[1],z[0])),D[2]))),k[3]),u(c(u(c(b(I[1],D[0]),b(-D[1],I[0])),k[2]),c(u(c(b(k[1],D[0]),b(-D[1],k[0])),-I[2]),u(c(b(k[1],I[0]),b(-I[1],k[0])),D[2]))),-z[3])),c(u(c(u(c(b(z[1],D[0]),b(-D[1],z[0])),k[2]),c(u(c(b(k[1],D[0]),b(-D[1],k[0])),-z[2]),u(c(b(k[1],z[0]),b(-z[1],k[0])),D[2]))),I[3]),u(c(u(c(b(z[1],I[0]),b(-I[1],z[0])),k[2]),c(u(c(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),u(c(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),-D[3]))),c(c(u(c(u(c(b(z[1],D[0]),b(-D[1],z[0])),P[2]),c(u(c(b(P[1],D[0]),b(-D[1],P[0])),-z[2]),u(c(b(P[1],z[0]),b(-z[1],P[0])),D[2]))),k[3]),u(c(u(c(b(z[1],D[0]),b(-D[1],z[0])),k[2]),c(u(c(b(k[1],D[0]),b(-D[1],k[0])),-z[2]),u(c(b(k[1],z[0]),b(-z[1],k[0])),D[2]))),-P[3])),c(u(c(u(c(b(P[1],D[0]),b(-D[1],P[0])),k[2]),c(u(c(b(k[1],D[0]),b(-D[1],k[0])),-P[2]),u(c(b(k[1],P[0]),b(-P[1],k[0])),D[2]))),z[3]),u(c(u(c(b(P[1],z[0]),b(-z[1],P[0])),k[2]),c(u(c(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),u(c(b(k[1],P[0]),b(-P[1],k[0])),z[2]))),-D[3])))),F=L(R,O);return F[F.length-1]}}function f(c){var b=c===3?x:c===4?p:v;return b(a,e,n,r)}var d=f(3),o=f(4),m=[function(){return 0},function(){return 0},function(b,u){return u[0]-b[0]},function(b,u,L){var T=(b[1]-L[1])*(u[0]-L[0]),k=(b[0]-L[0])*(u[1]-L[1]),P=T-k,z;if(T>0){if(k<=0)return P;z=T+k}else if(T<0){if(k>=0)return P;z=-(T+k)}else return P;var I=s*z;return P>=I||P<=-I?P:d(b,u,L)},function(b,u,L,T){var k=b[0]-T[0],P=u[0]-T[0],z=L[0]-T[0],I=b[1]-T[1],D=u[1]-T[1],R=L[1]-T[1],O=b[2]-T[2],F=u[2]-T[2],N=L[2]-T[2],G=P*R,K=z*D,W=z*I,Y=k*R,re=k*D,ue=P*I,j=O*(G-K)+F*(W-Y)+N*(re-ue),q=(Math.abs(G)+Math.abs(K))*Math.abs(O)+(Math.abs(W)+Math.abs(Y))*Math.abs(F)+(Math.abs(re)+Math.abs(ue))*Math.abs(N),H=i*q;return j>H||-j>H?j:o(b,u,L,T)}];function l(c){var b=m[c.length];return b||(b=m[c.length]=f(c.length)),b.apply(void 0,c)}function w(c,b,u,L,T,k,P){return function(I,D,R,O,F){switch(arguments.length){case 0:case 1:return 0;case 2:return L(I,D);case 3:return T(I,D,R);case 4:return k(I,D,R,O);case 5:return P(I,D,R,O,F)}for(var N=new Array(arguments.length),G=0;G<arguments.length;++G)N[G]=arguments[G];return c(N)}}function _(){for(;m.length<=t;)m.push(f(m.length));S.exports=w.apply(void 0,[l].concat(m));for(var c=0;c<=t;++c)S.exports[c]=m[c]}_()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(g,S,M){var e=g("robust-sum"),a=g("robust-scale");S.exports=n;function n(r,t){if(r.length===1)return a(t,r[0]);if(t.length===1)return a(r,t[0]);if(r.length===0||t.length===0)return[0];var h=[0];if(r.length<t.length)for(var s=0;s<r.length;++s)h=e(h,a(t,r[s]));else for(var s=0;s<t.length;++s)h=e(h,a(r,t[s]));return h}},{"robust-scale":286,"robust-sum":289}],286:[function(g,S,M){var e=g("two-product"),a=g("two-sum");S.exports=n;function n(r,t){var h=r.length;if(h===1){var s=e(r[0],t);return s[0]?s:[s[1]]}var i=new Array(2*h),x=[.1,.1],p=[.1,.1],v=0;e(r[0],t,x),x[0]&&(i[v++]=x[0]);for(var f=1;f<h;++f){e(r[f],t,p);var d=x[1];a(d,p[0],x),x[0]&&(i[v++]=x[0]);var o=p[1],m=x[1],l=o+m,w=l-o,_=m-w;x[1]=l,_&&(i[v++]=_)}return x[1]&&(i[v++]=x[1]),v===0&&(i[v++]=0),i.length=v,i}},{"two-product":306,"two-sum":307}],287:[function(g,S,M){S.exports=n;var e=g("robust-orientation")[3];function a(r,t,h,s){for(var i=0;i<2;++i){var x=r[i],p=t[i],v=Math.min(x,p),f=Math.max(x,p),d=h[i],o=s[i],m=Math.min(d,o),l=Math.max(d,o);if(l<v||f<m)return!1}return!0}function n(r,t,h,s){var i=e(r,h,s),x=e(t,h,s);if(i>0&&x>0||i<0&&x<0)return!1;var p=e(h,r,t),v=e(s,r,t);return p>0&&v>0||p<0&&v<0?!1:i===0&&x===0&&p===0&&v===0?a(r,t,h,s):!0}},{"robust-orientation":284}],288:[function(g,S,M){S.exports=a;function e(n,r){var t=n+r,h=t-n,s=t-h,i=r-h,x=n-s,p=x+i;return p?[p,t]:[t]}function a(n,r){var t=n.length|0,h=r.length|0;if(t===1&&h===1)return e(n[0],-r[0]);var s=t+h,i=new Array(s),x=0,p=0,v=0,f=Math.abs,d=n[p],o=f(d),m=-r[v],l=f(m),w,_;o<l?(_=d,p+=1,p<t&&(d=n[p],o=f(d))):(_=m,v+=1,v<h&&(m=-r[v],l=f(m))),p<t&&o<l||v>=h?(w=d,p+=1,p<t&&(d=n[p],o=f(d))):(w=m,v+=1,v<h&&(m=-r[v],l=f(m)));for(var c=w+_,b=c-w,u=_-b,L=u,T=c,k,P,z,I,D;p<t&&v<h;)o<l?(w=d,p+=1,p<t&&(d=n[p],o=f(d))):(w=m,v+=1,v<h&&(m=-r[v],l=f(m))),_=L,c=w+_,b=c-w,u=_-b,u&&(i[x++]=u),k=T+c,P=k-T,z=k-P,I=c-P,D=T-z,L=D+I,T=k;for(;p<t;)w=d,_=L,c=w+_,b=c-w,u=_-b,u&&(i[x++]=u),k=T+c,P=k-T,z=k-P,I=c-P,D=T-z,L=D+I,T=k,p+=1,p<t&&(d=n[p]);for(;v<h;)w=m,_=L,c=w+_,b=c-w,u=_-b,u&&(i[x++]=u),k=T+c,P=k-T,z=k-P,I=c-P,D=T-z,L=D+I,T=k,v+=1,v<h&&(m=-r[v]);return L&&(i[x++]=L),T&&(i[x++]=T),x||(i[x++]=0),i.length=x,i}},{}],289:[function(g,S,M){S.exports=a;function e(n,r){var t=n+r,h=t-n,s=t-h,i=r-h,x=n-s,p=x+i;return p?[p,t]:[t]}function a(n,r){var t=n.length|0,h=r.length|0;if(t===1&&h===1)return e(n[0],r[0]);var s=t+h,i=new Array(s),x=0,p=0,v=0,f=Math.abs,d=n[p],o=f(d),m=r[v],l=f(m),w,_;o<l?(_=d,p+=1,p<t&&(d=n[p],o=f(d))):(_=m,v+=1,v<h&&(m=r[v],l=f(m))),p<t&&o<l||v>=h?(w=d,p+=1,p<t&&(d=n[p],o=f(d))):(w=m,v+=1,v<h&&(m=r[v],l=f(m)));for(var c=w+_,b=c-w,u=_-b,L=u,T=c,k,P,z,I,D;p<t&&v<h;)o<l?(w=d,p+=1,p<t&&(d=n[p],o=f(d))):(w=m,v+=1,v<h&&(m=r[v],l=f(m))),_=L,c=w+_,b=c-w,u=_-b,u&&(i[x++]=u),k=T+c,P=k-T,z=k-P,I=c-P,D=T-z,L=D+I,T=k;for(;p<t;)w=d,_=L,c=w+_,b=c-w,u=_-b,u&&(i[x++]=u),k=T+c,P=k-T,z=k-P,I=c-P,D=T-z,L=D+I,T=k,p+=1,p<t&&(d=n[p]);for(;v<h;)w=m,_=L,c=w+_,b=c-w,u=_-b,u&&(i[x++]=u),k=T+c,P=k-T,z=k-P,I=c-P,D=T-z,L=D+I,T=k,v+=1,v<h&&(m=r[v]);return L&&(i[x++]=L),T&&(i[x++]=T),x||(i[x++]=0),i.length=x,i}},{}],290:[function(g,S,M){S.exports=n;var e=g("boundary-cells"),a=g("reduce-simplicial-complex");function n(r){return a(e(r))}},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(g,S,M){S.exports=v;var e=g("ndarray"),a=g("typedarray-pool"),n=g("ndarray-sort"),r=g("./lib/codegen");function t(f){for(var d=f.length,o=0,m=0;m<d;++m)o=Math.max(o,f[m].length)|0;return o-1}function h(f,d){for(var o=f.length,m=a.mallocUint8(o),l=0;l<o;++l)m[l]=f[l]<d|0;return m}function s(f,d){for(var o=f.length,m=d*(d+1)/2*o|0,l=a.mallocUint32(m*2),w=0,_=0;_<o;++_)for(var c=f[_],d=c.length,b=0;b<d;++b)for(var u=0;u<b;++u){var L=c[u],T=c[b];l[w++]=Math.min(L,T)|0,l[w++]=Math.max(L,T)|0}var k=w/2|0;n(e(l,[k,2]));for(var P=2,_=2;_<w;_+=2)l[_-2]===l[_]&&l[_-1]===l[_+1]||(l[P++]=l[_],l[P++]=l[_+1]);return e(l,[P/2|0,2])}function i(f,d,o,m){for(var l=f.data,w=f.shape[0],_=a.mallocDouble(w),c=0,b=0;b<w;++b){var u=l[2*b],L=l[2*b+1];if(o[u]!==o[L]){var T=d[u],k=d[L];l[2*c]=u,l[2*c+1]=L,_[c++]=(k-m)/(k-T)}}return f.shape[0]=c,e(_,[c])}function x(f,d){var o=a.mallocInt32(d*2),m=f.shape[0],l=f.data;o[0]=0;for(var w=0,_=0;_<m;++_){var c=l[2*_];if(c!==w){for(o[2*w+1]=_;++w<c;)o[2*w]=_,o[2*w+1]=_;o[2*w]=_}}for(o[2*w+1]=m;++w<d;)o[2*w]=o[2*w+1]=m;return o}function p(f){for(var d=f.shape[0]|0,o=f.data,m=new Array(d),l=0;l<d;++l)m[l]=[o[2*l],o[2*l+1]];return m}function v(f,d,o,m){o=o||0,typeof m>"u"&&(m=t(f));var l=f.length;if(l===0||m<1)return{cells:[],vertexIds:[],vertexWeights:[]};var w=h(d,+o),_=s(f,m),c=i(_,d,w,+o),b=x(_,d.length|0),u=r(m)(f,_.data,b,w),L=p(_),T=[].slice.call(c.data,0,c.shape[0]);return a.free(w),a.free(_.data),a.free(c.data),a.free(b),{cells:u,vertexIds:L,vertexWeights:T}}},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(g,S,M){S.exports=a;var e=[function(){function r(t,h,s,i){for(var x=t.length,p=[],v=0;v<x;++v){var f=t[v];f.length}return p}return r},function(){function r(h,s,i,x){for(var p=Math.min(i,x)|0,v=Math.max(i,x)|0,f=h[2*p],d=h[2*p+1];f<d;){var o=f+d>>1,m=s[2*o+1];if(m===v)return o;v<m?d=o:f=o+1}return f}function t(h,s,i,x){for(var p=h.length,v=[],f=0;f<p;++f){var d=h[f],o=d.length;if(o===2){var m=(x[d[0]]<<0)+(x[d[1]]<<1);if(m===0||m===3)continue;switch(m){case 0:break;case 1:v.push([r(i,s,d[0],d[1])]);break;case 2:v.push([r(i,s,d[1],d[0])]);break}}}return v}return t},function(){function r(h,s,i,x){for(var p=Math.min(i,x)|0,v=Math.max(i,x)|0,f=h[2*p],d=h[2*p+1];f<d;){var o=f+d>>1,m=s[2*o+1];if(m===v)return o;v<m?d=o:f=o+1}return f}function t(h,s,i,x){for(var p=h.length,v=[],f=0;f<p;++f){var d=h[f],o=d.length;if(o===3){var m=(x[d[0]]<<0)+(x[d[1]]<<1)+(x[d[2]]<<2);if(m===0||m===7)continue;switch(m){case 0:break;case 1:v.push([r(i,s,d[0],d[2]),r(i,s,d[0],d[1])]);break;case 2:v.push([r(i,s,d[1],d[0]),r(i,s,d[1],d[2])]);break;case 3:v.push([r(i,s,d[0],d[2]),r(i,s,d[1],d[2])]);break;case 4:v.push([r(i,s,d[2],d[1]),r(i,s,d[2],d[0])]);break;case 5:v.push([r(i,s,d[2],d[1]),r(i,s,d[0],d[1])]);break;case 6:v.push([r(i,s,d[1],d[0]),r(i,s,d[2],d[0])]);break}}else if(o===2){var m=(x[d[0]]<<0)+(x[d[1]]<<1);if(m===0||m===3)continue;switch(m){case 0:break;case 1:v.push([r(i,s,d[0],d[1])]);break;case 2:v.push([r(i,s,d[1],d[0])]);break}}}return v}return t},function(){function r(h,s,i,x){for(var p=Math.min(i,x)|0,v=Math.max(i,x)|0,f=h[2*p],d=h[2*p+1];f<d;){var o=f+d>>1,m=s[2*o+1];if(m===v)return o;v<m?d=o:f=o+1}return f}function t(h,s,i,x){for(var p=h.length,v=[],f=0;f<p;++f){var d=h[f],o=d.length;if(o===4){var m=(x[d[0]]<<0)+(x[d[1]]<<1)+(x[d[2]]<<2)+(x[d[3]]<<3);if(m===0||m===15)continue;switch(m){case 0:break;case 1:v.push([r(i,s,d[0],d[1]),r(i,s,d[0],d[2]),r(i,s,d[0],d[3])]);break;case 2:v.push([r(i,s,d[1],d[2]),r(i,s,d[1],d[0]),r(i,s,d[1],d[3])]);break;case 3:v.push([r(i,s,d[1],d[2]),r(i,s,d[0],d[2]),r(i,s,d[0],d[3])],[r(i,s,d[1],d[3]),r(i,s,d[1],d[2]),r(i,s,d[0],d[3])]);break;case 4:v.push([r(i,s,d[2],d[0]),r(i,s,d[2],d[1]),r(i,s,d[2],d[3])]);break;case 5:v.push([r(i,s,d[0],d[1]),r(i,s,d[2],d[1]),r(i,s,d[0],d[3])],[r(i,s,d[2],d[1]),r(i,s,d[2],d[3]),r(i,s,d[0],d[3])]);break;case 6:v.push([r(i,s,d[2],d[0]),r(i,s,d[1],d[0]),r(i,s,d[1],d[3])],[r(i,s,d[2],d[3]),r(i,s,d[2],d[0]),r(i,s,d[1],d[3])]);break;case 7:v.push([r(i,s,d[0],d[3]),r(i,s,d[1],d[3]),r(i,s,d[2],d[3])]);break;case 8:v.push([r(i,s,d[3],d[1]),r(i,s,d[3],d[0]),r(i,s,d[3],d[2])]);break;case 9:v.push([r(i,s,d[3],d[1]),r(i,s,d[0],d[1]),r(i,s,d[0],d[2])],[r(i,s,d[3],d[2]),r(i,s,d[3],d[1]),r(i,s,d[0],d[2])]);break;case 10:v.push([r(i,s,d[1],d[0]),r(i,s,d[3],d[0]),r(i,s,d[1],d[2])],[r(i,s,d[3],d[0]),r(i,s,d[3],d[2]),r(i,s,d[1],d[2])]);break;case 11:v.push([r(i,s,d[1],d[2]),r(i,s,d[0],d[2]),r(i,s,d[3],d[2])]);break;case 12:v.push([r(i,s,d[3],d[0]),r(i,s,d[2],d[0]),r(i,s,d[2],d[1])],[r(i,s,d[3],d[1]),r(i,s,d[3],d[0]),r(i,s,d[2],d[1])]);break;case 13:v.push([r(i,s,d[0],d[1]),r(i,s,d[2],d[1]),r(i,s,d[3],d[1])]);break;case 14:v.push([r(i,s,d[2],d[0]),r(i,s,d[1],d[0]),r(i,s,d[3],d[0])]);break}}else if(o===3){var m=(x[d[0]]<<0)+(x[d[1]]<<1)+(x[d[2]]<<2);if(m===0||m===7)continue;switch(m){case 0:break;case 1:v.push([r(i,s,d[0],d[2]),r(i,s,d[0],d[1])]);break;case 2:v.push([r(i,s,d[1],d[0]),r(i,s,d[1],d[2])]);break;case 3:v.push([r(i,s,d[0],d[2]),r(i,s,d[1],d[2])]);break;case 4:v.push([r(i,s,d[2],d[1]),r(i,s,d[2],d[0])]);break;case 5:v.push([r(i,s,d[2],d[1]),r(i,s,d[0],d[1])]);break;case 6:v.push([r(i,s,d[1],d[0]),r(i,s,d[2],d[0])]);break}}else if(o===2){var m=(x[d[0]]<<0)+(x[d[1]]<<1);if(m===0||m===3)continue;switch(m){case 0:break;case 1:v.push([r(i,s,d[0],d[1])]);break;case 2:v.push([r(i,s,d[1],d[0])]);break}}}return v}return t}];function a(n){return e[n]()}},{}],293:[function(g,S,M){var e=g("bit-twiddle"),a=g("union-find");function n(c){for(var b=0,u=Math.max,L=0,T=c.length;L<T;++L)b=u(b,c[L].length);return b-1}M.dimension=n;function r(c){for(var b=-1,u=Math.max,L=0,T=c.length;L<T;++L)for(var k=c[L],P=0,z=k.length;P<z;++P)b=u(b,k[P]);return b+1}M.countVertices=r;function t(c){for(var b=new Array(c.length),u=0,L=c.length;u<L;++u)b[u]=c[u].slice(0);return b}M.cloneCells=t;function h(c,b){var u=c.length,L=c.length-b.length,T=Math.min;if(L)return L;switch(u){case 0:return 0;case 1:return c[0]-b[0];case 2:var D=c[0]+c[1]-b[0]-b[1];return D||T(c[0],c[1])-T(b[0],b[1]);case 3:var k=c[0]+c[1],P=b[0]+b[1];if(D=k+c[2]-(P+b[2]),D)return D;var z=T(c[0],c[1]),I=T(b[0],b[1]),D=T(z,c[2])-T(I,b[2]);return D||T(z+c[2],k)-T(I+b[2],P);default:var R=c.slice(0);R.sort();var O=b.slice(0);O.sort();for(var F=0;F<u;++F)if(L=R[F]-O[F],L)return L;return 0}}M.compareCells=h;function s(c,b){return h(c[0],b[0])}function i(c,b){if(b){for(var u=c.length,L=new Array(u),T=0;T<u;++T)L[T]=[c[T],b[T]];L.sort(s);for(var T=0;T<u;++T)c[T]=L[T][0],b[T]=L[T][1];return c}else return c.sort(h),c}M.normalize=i;function x(c){if(c.length===0)return[];for(var b=1,u=c.length,L=1;L<u;++L){var T=c[L];if(h(T,c[L-1])){if(L===b){b++;continue}c[b++]=T}}return c.length=b,c}M.unique=x;function p(c,b){for(var u=0,L=c.length-1,T=-1;u<=L;){var k=u+L>>1,P=h(c[k],b);P<=0?(P===0&&(T=k),u=k+1):P>0&&(L=k-1)}return T}M.findCell=p;function v(c,b){for(var u=new Array(c.length),L=0,T=u.length;L<T;++L)u[L]=[];for(var k=[],L=0,P=b.length;L<P;++L)for(var z=b[L],I=z.length,D=1,R=1<<I;D<R;++D){k.length=e.popCount(D);for(var O=0,F=0;F<I;++F)D&1<<F&&(k[O++]=z[F]);var N=p(c,k);if(!(N<0))for(;u[N++].push(L),!(N>=c.length||h(c[N],k)!==0););}return u}M.incidence=v;function f(c,b){if(!b)return v(x(o(c,0)),c);for(var u=new Array(b),L=0;L<b;++L)u[L]=[];for(var L=0,T=c.length;L<T;++L)for(var k=c[L],P=0,z=k.length;P<z;++P)u[k[P]].push(L);return u}M.dual=f;function d(c){for(var b=[],u=0,L=c.length;u<L;++u)for(var T=c[u],k=T.length|0,P=1,z=1<<k;P<z;++P){for(var I=[],D=0;D<k;++D)P>>>D&1&&I.push(T[D]);b.push(I)}return i(b)}M.explode=d;function o(c,b){if(b<0)return[];for(var u=[],L=(1<<b+1)-1,T=0;T<c.length;++T)for(var k=c[T],P=L;P<1<<k.length;P=e.nextCombination(P)){for(var z=new Array(b+1),I=0,D=0;D<k.length;++D)P&1<<D&&(z[I++]=k[D]);u.push(z)}return i(u)}M.skeleton=o;function m(c){for(var b=[],u=0,L=c.length;u<L;++u)for(var T=c[u],k=0,P=T.length;k<P;++k){for(var z=new Array(T.length-1),I=0,D=0;I<P;++I)I!==k&&(z[D++]=T[I]);b.push(z)}return i(b)}M.boundary=m;function l(c,b){for(var u=new a(b),L=0;L<c.length;++L)for(var T=c[L],k=0;k<T.length;++k)for(var P=k+1;P<T.length;++P)u.link(T[k],T[P]);for(var z=[],I=u.ranks,L=0;L<I.length;++L)I[L]=-1;for(var L=0;L<c.length;++L){var D=u.find(c[L][0]);I[D]<0?(I[D]=z.length,z.push([c[L].slice(0)])):z[I[D]].push(c[L].slice(0))}return z}function w(c){for(var b=x(i(o(c,0))),u=new a(b.length),L=0;L<c.length;++L)for(var T=c[L],k=0;k<T.length;++k)for(var P=p(b,[T[k]]),z=k+1;z<T.length;++z)u.link(P,p(b,[T[z]]));for(var I=[],D=u.ranks,L=0;L<D.length;++L)D[L]=-1;for(var L=0;L<c.length;++L){var R=u.find(p(b,[c[L][0]]));D[R]<0?(D[R]=I.length,I.push([c[L].slice(0)])):I[D[R]].push(c[L].slice(0))}return I}function _(c,b){return b?l(c,b):w(c)}M.connectedComponents=_},{"bit-twiddle":32,"union-find":309}],294:[function(g,S,M){arguments[4][32][0].apply(M,arguments)},{dup:32}],295:[function(g,S,M){arguments[4][293][0].apply(M,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(g,S,M){S.exports=e;function e(a){this.roots=new Array(a),this.ranks=new Array(a);for(var n=0;n<a;++n)this.roots[n]=n,this.ranks[n]=0}e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var a=this.roots.length;return this.roots.push(a),this.ranks.push(0),a},e.prototype.find=function(a){for(var n=this.roots;n[a]!==a;){var r=n[a];n[a]=n[r],a=r}return a},e.prototype.link=function(a,n){var r=this.find(a),t=this.find(n);if(r!==t){var h=this.ranks,s=this.roots,i=h[r],x=h[t];i<x?s[r]=t:x<i?s[t]=r:(s[t]=r,++h[r])}}},{}],297:[function(g,S,M){S.exports=r;var e=g("robust-orientation"),a=g("simplicial-complex");function n(t,h,s){var i=Math.abs(e(t,h,s)),x=Math.sqrt(Math.pow(h[0]-s[0],2)+Math.pow(h[1]-s[1],2));return i/x}function r(t,h,s){for(var i=h.length,x=t.length,p=new Array(i),v=new Array(i),f=new Array(i),d=new Array(i),o=0;o<i;++o)p[o]=v[o]=-1,f[o]=1/0,d[o]=!1;for(var o=0;o<x;++o){var m=t[o];if(m.length!==2)throw new Error("Input must be a graph");var l=m[1],w=m[0];v[w]!==-1?v[w]=-2:v[w]=l,p[l]!==-1?p[l]=-2:p[l]=w}function _(W){if(d[W])return 1/0;var Y=p[W],re=v[W];return Y<0||re<0?1/0:n(h[W],h[Y],h[re])}function c(W,Y){var re=I[W],ue=I[Y];I[W]=ue,I[Y]=re,D[re]=Y,D[ue]=W}function b(W){return f[I[W]]}function u(W){return W&1?W-1>>1:(W>>1)-1}function L(W){for(var Y=b(W);;){var re=Y,ue=2*W+1,j=2*(W+1),q=W;if(ue<O){var H=b(ue);H<re&&(q=ue,re=H)}if(j<O){var U=b(j);U<re&&(q=j)}if(q===W)return W;c(W,q),W=q}}function T(W){for(var Y=b(W);W>0;){var re=u(W);if(re>=0){var ue=b(re);if(Y<ue){c(W,re),W=re;continue}}return W}}function k(){if(O>0){var W=I[0];return c(0,O-1),O-=1,L(0),W}return-1}function P(W,Y){var re=I[W];return f[re]===Y?W:(f[re]=-1/0,T(W),k(),f[re]=Y,O+=1,T(O-1))}function z(W){if(!d[W]){d[W]=!0;var Y=p[W],re=v[W];p[re]>=0&&(p[re]=Y),v[Y]>=0&&(v[Y]=re),D[Y]>=0&&P(D[Y],_(Y)),D[re]>=0&&P(D[re],_(re))}}for(var I=[],D=new Array(i),o=0;o<i;++o){var R=f[o]=_(o);R<1/0?(D[o]=I.length,I.push(o)):D[o]=-1}for(var O=I.length,o=O>>1;o>=0;--o)L(o);for(;;){var F=k();if(F<0||f[F]>s)break;z(F)}for(var N=[],o=0;o<i;++o)d[o]||(D[o]=N.length,N.push(h[o].slice()));N.length;function G(W,Y){if(W[Y]<0)return Y;var re=Y,ue=Y;do{var j=W[ue];if(!d[ue]||j<0||j===ue||(ue=j,j=W[ue],!d[ue]||j<0||j===ue))break;ue=j,re=W[re]}while(re!==ue);for(var q=Y;q!==ue;q=W[q])W[q]=ue;return ue}var K=[];return t.forEach(function(W){var Y=G(p,W[0]),re=G(v,W[1]);if(Y>=0&&re>=0&&Y!==re){var ue=D[Y],j=D[re];ue!==j&&K.push([ue,j])}}),a.unique(a.normalize(K)),{positions:N,edges:K}}},{"robust-orientation":284,"simplicial-complex":295}],298:[function(g,S,M){S.exports=n;var e=g("robust-orientation");function a(r,t){var h,s;if(t[0][0]<t[1][0])h=t[0],s=t[1];else if(t[0][0]>t[1][0])h=t[1],s=t[0];else{var i=Math.min(r[0][1],r[1][1]),x=Math.max(r[0][1],r[1][1]),p=Math.min(t[0][1],t[1][1]),v=Math.max(t[0][1],t[1][1]);return x<p?x-p:i>v?i-v:x-v}var f,d;r[0][1]<r[1][1]?(f=r[0],d=r[1]):(f=r[1],d=r[0]);var o=e(s,h,f);return o||(o=e(s,h,d),o)?o:d-s}function n(r,t){var h,s;if(t[0][0]<t[1][0])h=t[0],s=t[1];else if(t[0][0]>t[1][0])h=t[1],s=t[0];else return a(t,r);var i,x;if(r[0][0]<r[1][0])i=r[0],x=r[1];else if(r[0][0]>r[1][0])i=r[1],x=r[0];else return-a(r,t);var p=e(h,s,x),v=e(h,s,i);if(p<0){if(v<=0)return p}else if(p>0){if(v>=0)return p}else if(v)return v;if(p=e(x,i,s),v=e(x,i,h),p<0){if(v<=0)return p}else if(p>0){if(v>=0)return p}else if(v)return v;return s[0]-x[0]}},{"robust-orientation":284}],299:[function(g,S,M){S.exports=v;var e=g("binary-search-bounds"),a=g("functional-red-black-tree"),n=g("robust-orientation"),r=g("./lib/order-segments");function t(f,d,o){this.slabs=f,this.coordinates=d,this.horizontal=o}var h=t.prototype;function s(f,d){return f.y-d}function i(f,d){for(var o=null;f;){var m=f.key,l,w;m[0][0]<m[1][0]?(l=m[0],w=m[1]):(l=m[1],w=m[0]);var _=n(l,w,d);if(_<0)f=f.left;else if(_>0)if(d[0]!==m[1][0])o=f,f=f.right;else{var c=i(f.right,d);if(c)return c;f=f.left}else{if(d[0]!==m[1][0])return f;var c=i(f.right,d);if(c)return c;f=f.left}}return o}h.castUp=function(f){var d=e.le(this.coordinates,f[0]);if(d<0)return-1;this.slabs[d];var o=i(this.slabs[d],f),m=-1;if(o&&(m=o.value),this.coordinates[d]===f[0]){var l=null;if(o&&(l=o.key),d>0){var w=i(this.slabs[d-1],f);w&&(l?r(w.key,l)>0&&(l=w.key,m=w.value):(m=w.value,l=w.key))}var _=this.horizontal[d];if(_.length>0){var c=e.ge(_,f[1],s);if(c<_.length){var b=_[c];if(f[1]===b.y){if(b.closed)return b.index;for(;c<_.length-1&&_[c+1].y===f[1];)if(c=c+1,b=_[c],b.closed)return b.index;if(b.y===f[1]&&!b.start){if(c=c+1,c>=_.length)return m;b=_[c]}}if(b.start)if(l){var u=n(l[0],l[1],[f[0],b.y]);l[0][0]>l[1][0]&&(u=-u),u>0&&(m=b.index)}else m=b.index;else b.y!==f[1]&&(m=b.index)}}}return m};function x(f,d,o,m){this.y=f,this.index=d,this.start=o,this.closed=m}function p(f,d,o,m){this.x=f,this.segment=d,this.create=o,this.index=m}function v(f){for(var d=f.length,o=2*d,m=new Array(o),l=0;l<d;++l){var w=f[l],_=w[0][0]<w[1][0];m[2*l]=new p(w[0][0],w,_,l),m[2*l+1]=new p(w[1][0],w,!_,l)}m.sort(function(z,I){var D=z.x-I.x;return D||(D=z.create-I.create,D)?D:Math.min(z.segment[0][1],z.segment[1][1])-Math.min(I.segment[0][1],I.segment[1][1])});for(var c=a(r),b=[],u=[],L=[],l=0;l<o;){for(var T=m[l].x,k=[];l<o;){var P=m[l];if(P.x!==T)break;l+=1,P.segment[0][0]===P.x&&P.segment[1][0]===P.x?P.create&&(P.segment[0][1]<P.segment[1][1]?(k.push(new x(P.segment[0][1],P.index,!0,!0)),k.push(new x(P.segment[1][1],P.index,!1,!1))):(k.push(new x(P.segment[1][1],P.index,!0,!1)),k.push(new x(P.segment[0][1],P.index,!1,!0)))):P.create?c=c.insert(P.segment,P.index):c=c.remove(P.segment)}b.push(c.root),u.push(T),L.push(k)}return new t(b,u,L)}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(g,S,M){var e=g("robust-dot-product"),a=g("robust-sum");S.exports=t,S.exports.positive=h,S.exports.negative=s;function n(i,x){var p=a(e(i,x),[x[x.length-1]]);return p[p.length-1]}function r(i,x,p,v){var f=v-x,d=-x/f;d<0?d=0:d>1&&(d=1);for(var o=1-d,m=i.length,l=new Array(m),w=0;w<m;++w)l[w]=d*i[w]+o*p[w];return l}function t(i,x){for(var p=[],v=[],f=n(i[i.length-1],x),d=i[i.length-1],o=i[0],m=0;m<i.length;++m,d=o){o=i[m];var l=n(o,x);if(f<0&&l>0||f>0&&l<0){var w=r(d,l,o,f);p.push(w),v.push(w.slice())}l<0?v.push(o.slice()):l>0?p.push(o.slice()):(p.push(o.slice()),v.push(o.slice())),f=l}return{positive:p,negative:v}}function h(i,x){for(var p=[],v=n(i[i.length-1],x),f=i[i.length-1],d=i[0],o=0;o<i.length;++o,f=d){d=i[o];var m=n(d,x);(v<0&&m>0||v>0&&m<0)&&p.push(r(f,m,d,v)),m>=0&&p.push(d.slice()),v=m}return p}function s(i,x){for(var p=[],v=n(i[i.length-1],x),f=i[i.length-1],d=i[0],o=0;o<i.length;++o,f=d){d=i[o];var m=n(d,x);(v<0&&m>0||v>0&&m<0)&&p.push(r(f,m,d,v)),m<=0&&p.push(d.slice()),v=m}return p}},{"robust-dot-product":281,"robust-sum":289}],301:[function(g,S,M){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function a(s){return r(h(s),arguments)}function n(s,i){return a.apply(null,[s].concat(i||[]))}function r(s,i){var x=1,p=s.length,v,f="",d,o,m,l,w,_,c,b;for(d=0;d<p;d++)if(typeof s[d]=="string")f+=s[d];else if(typeof s[d]=="object"){if(m=s[d],m.keys)for(v=i[x],o=0;o<m.keys.length;o++){if(v==null)throw new Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',m.keys[o],m.keys[o-1]));v=v[m.keys[o]]}else m.param_no?v=i[m.param_no]:v=i[x++];if(e.not_type.test(m.type)&&e.not_primitive.test(m.type)&&v instanceof Function&&(v=v()),e.numeric_arg.test(m.type)&&typeof v!="number"&&isNaN(v))throw new TypeError(a("[sprintf] expecting number but found %T",v));switch(e.number.test(m.type)&&(c=v>=0),m.type){case"b":v=parseInt(v,10).toString(2);break;case"c":v=String.fromCharCode(parseInt(v,10));break;case"d":case"i":v=parseInt(v,10);break;case"j":v=JSON.stringify(v,null,m.width?parseInt(m.width):0);break;case"e":v=m.precision?parseFloat(v).toExponential(m.precision):parseFloat(v).toExponential();break;case"f":v=m.precision?parseFloat(v).toFixed(m.precision):parseFloat(v);break;case"g":v=m.precision?String(Number(v.toPrecision(m.precision))):parseFloat(v);break;case"o":v=(parseInt(v,10)>>>0).toString(8);break;case"s":v=String(v),v=m.precision?v.substring(0,m.precision):v;break;case"t":v=String(!!v),v=m.precision?v.substring(0,m.precision):v;break;case"T":v=Object.prototype.toString.call(v).slice(8,-1).toLowerCase(),v=m.precision?v.substring(0,m.precision):v;break;case"u":v=parseInt(v,10)>>>0;break;case"v":v=v.valueOf(),v=m.precision?v.substring(0,m.precision):v;break;case"x":v=(parseInt(v,10)>>>0).toString(16);break;case"X":v=(parseInt(v,10)>>>0).toString(16).toUpperCase();break}e.json.test(m.type)?f+=v:(e.number.test(m.type)&&(!c||m.sign)?(b=c?"+":"-",v=v.toString().replace(e.sign,"")):b="",w=m.pad_char?m.pad_char==="0"?"0":m.pad_char.charAt(1):" ",_=m.width-(b+v).length,l=m.width&&_>0?w.repeat(_):"",f+=m.align?b+v+l:w==="0"?b+l+v:l+b+v)}return f}var t=Object.create(null);function h(s){if(t[s])return t[s];for(var i=s,x,p=[],v=0;i;){if((x=e.text.exec(i))!==null)p.push(x[0]);else if((x=e.modulo.exec(i))!==null)p.push("%");else if((x=e.placeholder.exec(i))!==null){if(x[2]){v|=1;var f=[],d=x[2],o=[];if((o=e.key.exec(d))!==null)for(f.push(o[1]);(d=d.substring(o[0].length))!=="";)if((o=e.key_access.exec(d))!==null)f.push(o[1]);else if((o=e.index_access.exec(d))!==null)f.push(o[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");x[2]=f}else v|=2;if(v===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");p.push({placeholder:x[0],param_no:x[1],keys:x[2],sign:x[3],pad_char:x[4],align:x[5],width:x[6],precision:x[7],type:x[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");i=i.substring(x[0].length)}return t[s]=p}typeof M<"u"&&(M.sprintf=a,M.vsprintf=n),typeof window<"u"&&(window.sprintf=a,window.vsprintf=n)})()},{}],302:[function(g,S,M){S.exports=s;var e=g("ndarray-extract-contour"),a=g("zero-crossings"),n={"2d":function(i,x,p){var v=i({order:x,scalarArguments:3,getters:p==="generic"?[0]:void 0,phase:function(d,o,m,l){return d>l|0},vertex:function(d,o,m,l,w,_,c,b,u,L,T,k,P){var z=(c<<0)+(b<<1)+(u<<2)+(L<<3)|0;if(!(z===0||z===15))switch(z){case 0:T.push([d-.5,o-.5]);break;case 1:T.push([d-.25-.25*(l+m-2*P)/(m-l),o-.25-.25*(w+m-2*P)/(m-w)]);break;case 2:T.push([d-.75-.25*(-l-m+2*P)/(l-m),o-.25-.25*(_+l-2*P)/(l-_)]);break;case 3:T.push([d-.5,o-.5-.5*(w+m+_+l-4*P)/(m-w+l-_)]);break;case 4:T.push([d-.25-.25*(_+w-2*P)/(w-_),o-.75-.25*(-w-m+2*P)/(w-m)]);break;case 5:T.push([d-.5-.5*(l+m+_+w-4*P)/(m-l+w-_),o-.5]);break;case 6:T.push([d-.5-.25*(-l-m+_+w)/(l-m+w-_),o-.5-.25*(-w-m+_+l)/(w-m+l-_)]);break;case 7:T.push([d-.75-.25*(_+w-2*P)/(w-_),o-.75-.25*(_+l-2*P)/(l-_)]);break;case 8:T.push([d-.75-.25*(-_-w+2*P)/(_-w),o-.75-.25*(-_-l+2*P)/(_-l)]);break;case 9:T.push([d-.5-.25*(l+m+-_-w)/(m-l+_-w),o-.5-.25*(w+m+-_-l)/(m-w+_-l)]);break;case 10:T.push([d-.5-.5*(-l-m+-_-w+4*P)/(l-m+_-w),o-.5]);break;case 11:T.push([d-.25-.25*(-_-w+2*P)/(_-w),o-.75-.25*(w+m-2*P)/(m-w)]);break;case 12:T.push([d-.5,o-.5-.5*(-w-m+-_-l+4*P)/(w-m+_-l)]);break;case 13:T.push([d-.75-.25*(l+m-2*P)/(m-l),o-.25-.25*(-_-l+2*P)/(_-l)]);break;case 14:T.push([d-.25-.25*(-l-m+2*P)/(l-m),o-.25-.25*(-w-m+2*P)/(w-m)]);break;case 15:T.push([d-.5,o-.5]);break}},cell:function(d,o,m,l,w,_,c,b,u){w?b.push([d,o]):b.push([o,d])}});return function(f,d){var o=[],m=[];return v(f,o,m,d),{positions:o,cells:m}}}};function r(i,x){var p=i.length+"d",v=n[p];if(v)return v(e,i,x)}function t(i,x){for(var p=a(i,x),v=p.length,f=new Array(v),d=new Array(v),o=0;o<v;++o)f[o]=[p[o]],d[o]=[o];return{positions:f,cells:d}}var h={};function s(i,f){if(i.dimension<=0)return{positions:[],cells:[]};if(i.dimension===1)return t(i,f);var p=i.order.join()+"-"+i.dtype,v=h[p],f=+f||0;return v||(v=h[p]=r(i.order,i.dtype)),v(i,f)}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(g,S,M){(function(e){(function(){S.exports=h;var a=g("vectorize-text"),n=window||e.global||{},r=n.__TEXT_CACHE||{};n.__TEXT_CACHE={};function t(s){for(var i=s.cells,x=s.positions,p=new Float32Array(i.length*6),v=0,f=0,d=0;d<i.length;++d)for(var o=i[d],m=0;m<3;++m){var l=x[o[m]];p[v++]=l[0],p[v++]=l[1]+1.4,f=Math.max(l[0],f)}return{data:p,shape:f}}function h(s,i,p){var p=p||{},v=r[s];v||(v=r[s]={" ":{data:new Float32Array(0),shape:.2}});var f=v[i];if(!f)if(i.length<=1||!/\d/.test(i))f=v[i]=t(a(i,{triangles:!0,font:s,textAlign:p.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var d=i.split(/(\d|\s)/),o=new Array(d.length),m=0,l=0,w=0;w<d.length;++w)o[w]=h(s,d[w]),m+=o[w].data.length,l+=o[w].shape,w>0&&(l+=.02);for(var _=new Float32Array(m),c=0,b=-.5*l,w=0;w<o.length;++w){for(var u=o[w].data,L=0;L<u.length;L+=2)_[c++]=u[L]+b,_[c++]=u[L+1];b+=o[w].shape+.02}f=v[i]={data:_,shape:l}}return f}}).call(this)}).call(this,g("_process"))},{_process:5,"vectorize-text":311}],304:[function(g,S,M){var e=g("parse-unit");S.exports=t;var a=96;function n(h,s){var i=e(getComputedStyle(h).getPropertyValue(s));return i[0]*t(i[1],h)}function r(h,s){var i=document.createElement("div");i.style["font-size"]="128"+h,s.appendChild(i);var x=n(i,"font-size")/128;return s.removeChild(i),x}function t(h,s){switch(s=s||document.body,h=(h||"px").trim().toLowerCase(),(s===window||s===document)&&(s=document.body),h){case"%":return s.clientHeight/100;case"ch":case"ex":return r(h,s);case"em":return n(s,"font-size");case"rem":return n(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return a;case"cm":return a/2.54;case"mm":return a/25.4;case"pt":return a/72;case"pc":return a/6}return 1}},{"parse-unit":265}],305:[function(g,S,M){S.exports=d;var e=g("filtered-vector"),a=g("gl-mat4/invert"),n=g("gl-mat4/rotate"),r=g("gl-vec3/cross"),t=g("gl-vec3/normalize"),h=g("gl-vec3/dot");function s(o,m,l){return Math.sqrt(Math.pow(o,2)+Math.pow(m,2)+Math.pow(l,2))}function i(o){return Math.min(1,Math.max(-1,o))}function x(o){var m=Math.abs(o[0]),l=Math.abs(o[1]),w=Math.abs(o[2]),_=[0,0,0];m>Math.max(l,w)?_[2]=1:l>Math.max(m,w)?_[0]=1:_[1]=1;for(var c=0,b=0,u=0;u<3;++u)c+=o[u]*o[u],b+=_[u]*o[u];for(var u=0;u<3;++u)_[u]-=b/c*o[u];return t(_,_),_}function p(o,m,l,w,_,c,b,u){this.center=e(l),this.up=e(w),this.right=e(_),this.radius=e([c]),this.angle=e([b,u]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(o,m),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var v=p.prototype;v.setDistanceLimits=function(o,m){o>0?o=Math.log(o):o=-1/0,m>0?m=Math.log(m):m=1/0,m=Math.max(m,o),this.radius.bounds[0][0]=o,this.radius.bounds[1][0]=m},v.getDistanceLimits=function(o){var m=this.radius.bounds[0];return o?(o[0]=Math.exp(m[0][0]),o[1]=Math.exp(m[1][0]),o):[Math.exp(m[0][0]),Math.exp(m[1][0])]},v.recalcMatrix=function(o){this.center.curve(o),this.up.curve(o),this.right.curve(o),this.radius.curve(o),this.angle.curve(o);for(var m=this.computedUp,l=this.computedRight,w=0,_=0,c=0;c<3;++c)_+=m[c]*l[c],w+=m[c]*m[c];for(var b=Math.sqrt(w),u=0,c=0;c<3;++c)l[c]-=m[c]*_/w,u+=l[c]*l[c],m[c]/=b;for(var L=Math.sqrt(u),c=0;c<3;++c)l[c]/=L;var T=this.computedToward;r(T,m,l),t(T,T);for(var k=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],z=this.computedAngle[1],I=Math.cos(P),D=Math.sin(P),R=Math.cos(z),O=Math.sin(z),F=this.computedCenter,N=I*R,G=D*R,K=O,W=-I*O,Y=-D*O,re=R,ue=this.computedEye,j=this.computedMatrix,c=0;c<3;++c){var q=N*l[c]+G*T[c]+K*m[c];j[4*c+1]=W*l[c]+Y*T[c]+re*m[c],j[4*c+2]=q,j[4*c+3]=0}var H=j[1],U=j[5],$=j[9],ne=j[2],X=j[6],Q=j[10],ie=U*Q-$*X,se=$*ne-H*Q,ae=H*X-U*ne,oe=s(ie,se,ae);ie/=oe,se/=oe,ae/=oe,j[0]=ie,j[4]=se,j[8]=ae;for(var c=0;c<3;++c)ue[c]=F[c]+j[2+4*c]*k;for(var c=0;c<3;++c){for(var u=0,be=0;be<3;++be)u+=j[c+4*be]*ue[be];j[12+c]=-u}j[15]=1},v.getMatrix=function(o,m){this.recalcMatrix(o);var l=this.computedMatrix;if(m){for(var w=0;w<16;++w)m[w]=l[w];return m}return l};var f=[0,0,0];v.rotate=function(o,m,l,w){if(this.angle.move(o,m,l),w){this.recalcMatrix(o);var _=this.computedMatrix;f[0]=_[2],f[1]=_[6],f[2]=_[10];for(var c=this.computedUp,b=this.computedRight,u=this.computedToward,L=0;L<3;++L)_[4*L]=c[L],_[4*L+1]=b[L],_[4*L+2]=u[L];n(_,_,w,f);for(var L=0;L<3;++L)c[L]=_[4*L],b[L]=_[4*L+1];this.up.set(o,c[0],c[1],c[2]),this.right.set(o,b[0],b[1],b[2])}},v.pan=function(o,m,l,w){m=m||0,l=l||0,w=w||0,this.recalcMatrix(o);var _=this.computedMatrix;Math.exp(this.computedRadius[0]);var c=_[1],b=_[5],u=_[9],L=s(c,b,u);c/=L,b/=L,u/=L;var T=_[0],k=_[4],P=_[8],z=T*c+k*b+P*u;T-=c*z,k-=b*z,P-=u*z;var I=s(T,k,P);T/=I,k/=I,P/=I;var D=T*m+c*l,R=k*m+b*l,O=P*m+u*l;this.center.move(o,D,R,O);var F=Math.exp(this.computedRadius[0]);F=Math.max(1e-4,F+w),this.radius.set(o,Math.log(F))},v.translate=function(o,m,l,w){this.center.move(o,m||0,l||0,w||0)},v.setMatrix=function(o,m,l,w){var _=1;typeof l=="number"&&(_=l|0),(_<0||_>3)&&(_=1);var c=(_+2)%3;m||(this.recalcMatrix(o),m=this.computedMatrix);var b=m[_],u=m[_+4],L=m[_+8];if(w){var k=Math.abs(b),P=Math.abs(u),z=Math.abs(L),I=Math.max(k,P,z);k===I?(b=b<0?-1:1,u=L=0):z===I?(L=L<0?-1:1,b=u=0):(u=u<0?-1:1,b=L=0)}else{var T=s(b,u,L);b/=T,u/=T,L/=T}var D=m[c],R=m[c+4],O=m[c+8],F=D*b+R*u+O*L;D-=b*F,R-=u*F,O-=L*F;var N=s(D,R,O);D/=N,R/=N,O/=N;var G=u*O-L*R,K=L*D-b*O,W=b*R-u*D,Y=s(G,K,W);G/=Y,K/=Y,W/=Y,this.center.jump(o,ge,me,Ee),this.radius.idle(o),this.up.jump(o,b,u,L),this.right.jump(o,D,R,O);var re,ue;if(_===2){var j=m[1],q=m[5],H=m[9],U=j*D+q*R+H*O,$=j*G+q*K+H*W;ie<0?re=-Math.PI/2:re=Math.PI/2,ue=Math.atan2($,U)}else{var ne=m[2],X=m[6],Q=m[10],ie=ne*b+X*u+Q*L,se=ne*D+X*R+Q*O,ae=ne*G+X*K+Q*W;re=Math.asin(i(ie)),ue=Math.atan2(ae,se)}this.angle.jump(o,ue,re),this.recalcMatrix(o);var oe=m[2],be=m[6],ce=m[10],de=this.computedMatrix;a(de,m);var ye=de[15],ge=de[12]/ye,me=de[13]/ye,Ee=de[14]/ye,Pe=Math.exp(this.computedRadius[0]);this.center.jump(o,ge-oe*Pe,me-be*Pe,Ee-ce*Pe)},v.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},v.idle=function(o){this.center.idle(o),this.up.idle(o),this.right.idle(o),this.radius.idle(o),this.angle.idle(o)},v.flush=function(o){this.center.flush(o),this.up.flush(o),this.right.flush(o),this.radius.flush(o),this.angle.flush(o)},v.setDistance=function(o,m){m>0&&this.radius.set(o,Math.log(m))},v.lookAt=function(o,m,l,w){this.recalcMatrix(o),m=m||this.computedEye,l=l||this.computedCenter,w=w||this.computedUp;var _=w[0],c=w[1],b=w[2],u=s(_,c,b);if(!(u<1e-6)){_/=u,c/=u,b/=u;var L=m[0]-l[0],T=m[1]-l[1],k=m[2]-l[2],P=s(L,T,k);if(!(P<1e-6)){L/=P,T/=P,k/=P;var z=this.computedRight,I=z[0],D=z[1],R=z[2],O=_*I+c*D+b*R;I-=O*_,D-=O*c,R-=O*b;var F=s(I,D,R);if(!(F<.01&&(I=c*k-b*T,D=b*L-_*k,R=_*T-c*L,F=s(I,D,R),F<1e-6))){I/=F,D/=F,R/=F,this.up.set(o,_,c,b),this.right.set(o,I,D,R),this.center.set(o,l[0],l[1],l[2]),this.radius.set(o,Math.log(P));var N=c*R-b*D,G=b*I-_*R,K=_*D-c*I,W=s(N,G,K);N/=W,G/=W,K/=W;var Y=_*L+c*T+b*k,re=I*L+D*T+R*k,ue=N*L+G*T+K*k,j=Math.asin(i(Y)),q=Math.atan2(ue,re),H=this.angle._state,U=H[H.length-1],$=H[H.length-2];U=U%(2*Math.PI);var ne=Math.abs(U+2*Math.PI-q),X=Math.abs(U-q),Q=Math.abs(U-2*Math.PI-q);ne<X&&(U+=2*Math.PI),Q<X&&(U-=2*Math.PI),this.angle.jump(this.angle.lastT(),U,$),this.angle.set(o,q,j)}}}};function d(o){o=o||{};var m=o.center||[0,0,0],l=o.up||[0,1,0],w=o.right||x(l),_=o.radius||1,c=o.theta||0,b=o.phi||0;if(m=[].slice.call(m,0,3),l=[].slice.call(l,0,3),t(l,l),w=[].slice.call(w,0,3),t(w,w),"eye"in o){var u=o.eye,L=[u[0]-m[0],u[1]-m[1],u[2]-m[2]];r(w,L,l),s(w[0],w[1],w[2])<1e-6?w=x(l):t(w,w),_=s(L[0],L[1],L[2]);var T=h(l,L)/_,k=h(w,L)/_;b=Math.acos(T),c=Math.acos(k)}return _=Math.log(_),new p(o.zoomMin,o.zoomMax,m,l,w,_,c,b)}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(g,S,M){S.exports=a;var e=+(Math.pow(2,27)+1);function a(n,r,t){var h=n*r,s=e*n,i=s-n,x=s-i,p=n-x,v=e*r,f=v-r,d=v-f,o=r-d,m=h-x*d,l=m-p*d,w=l-x*o,_=p*o-w;return t?(t[0]=_,t[1]=h,t):[_,h]}},{}],307:[function(g,S,M){S.exports=e;function e(a,n,r){var t=a+n,h=t-a,s=t-h,i=n-h,x=a-s;return r?(r[0]=x+i,r[1]=t,r):[x+i,t]}},{}],308:[function(g,S,M){(function(e){(function(){var a=g("bit-twiddle"),n=g("dup"),r=g("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])});var t=typeof Uint8ClampedArray<"u",h=typeof BigUint64Array<"u",s=typeof BigInt64Array<"u",i=e.__TYPEDARRAY_POOL;i.UINT8C||(i.UINT8C=n([32,0])),i.BIGUINT64||(i.BIGUINT64=n([32,0])),i.BIGINT64||(i.BIGINT64=n([32,0])),i.BUFFER||(i.BUFFER=n([32,0]));var x=i.DATA,p=i.BUFFER;M.free=function(D){if(r.isBuffer(D))p[a.log2(D.length)].push(D);else{if(Object.prototype.toString.call(D)!=="[object ArrayBuffer]"&&(D=D.buffer),!D)return;var R=D.length||D.byteLength,O=a.log2(R)|0;x[O].push(D)}};function v(I){if(I){var D=I.length||I.byteLength,R=a.log2(D);x[R].push(I)}}function f(I){v(I.buffer)}M.freeUint8=M.freeUint16=M.freeUint32=M.freeBigUint64=M.freeInt8=M.freeInt16=M.freeInt32=M.freeBigInt64=M.freeFloat32=M.freeFloat=M.freeFloat64=M.freeDouble=M.freeUint8Clamped=M.freeDataView=f,M.freeArrayBuffer=v,M.freeBuffer=function(D){p[a.log2(D.length)].push(D)},M.malloc=function(D,R){if(R===void 0||R==="arraybuffer")return d(D);switch(R){case"uint8":return o(D);case"uint16":return m(D);case"uint32":return l(D);case"int8":return w(D);case"int16":return _(D);case"int32":return c(D);case"float":case"float32":return b(D);case"double":case"float64":return u(D);case"uint8_clamped":return L(D);case"bigint64":return k(D);case"biguint64":return T(D);case"buffer":return z(D);case"data":case"dataview":return P(D);default:return null}return null};function d(D){var D=a.nextPow2(D),R=a.log2(D),O=x[R];return O.length>0?O.pop():new ArrayBuffer(D)}M.mallocArrayBuffer=d;function o(I){return new Uint8Array(d(I),0,I)}M.mallocUint8=o;function m(I){return new Uint16Array(d(2*I),0,I)}M.mallocUint16=m;function l(I){return new Uint32Array(d(4*I),0,I)}M.mallocUint32=l;function w(I){return new Int8Array(d(I),0,I)}M.mallocInt8=w;function _(I){return new Int16Array(d(2*I),0,I)}M.mallocInt16=_;function c(I){return new Int32Array(d(4*I),0,I)}M.mallocInt32=c;function b(I){return new Float32Array(d(4*I),0,I)}M.mallocFloat32=M.mallocFloat=b;function u(I){return new Float64Array(d(8*I),0,I)}M.mallocFloat64=M.mallocDouble=u;function L(I){return t?new Uint8ClampedArray(d(I),0,I):o(I)}M.mallocUint8Clamped=L;function T(I){return h?new BigUint64Array(d(8*I),0,I):null}M.mallocBigUint64=T;function k(I){return s?new BigInt64Array(d(8*I),0,I):null}M.mallocBigInt64=k;function P(I){return new DataView(d(I),0,I)}M.mallocDataView=P;function z(I){I=a.nextPow2(I);var D=a.log2(I),R=p[D];return R.length>0?R.pop():new r(I)}M.mallocBuffer=z,M.clearCache=function(){for(var D=0;D<32;++D)i.UINT8[D].length=0,i.UINT16[D].length=0,i.UINT32[D].length=0,i.INT8[D].length=0,i.INT16[D].length=0,i.INT32[D].length=0,i.FLOAT[D].length=0,i.DOUBLE[D].length=0,i.BIGUINT64[D].length=0,i.BIGINT64[D].length=0,i.UINT8C[D].length=0,x[D].length=0,p[D].length=0}}).call(this)}).call(this,typeof A<"u"?A:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(g,S,M){S.exports=e;function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var r=0;r<n;++r)this.roots[r]=r,this.ranks[r]=0}var a=e.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}}),a.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},a.find=function(n){for(var r=n,t=this.roots;t[n]!==n;)n=t[n];for(;t[r]!==n;){var h=t[r];t[r]=n,r=h}return n},a.link=function(n,r){var t=this.find(n),h=this.find(r);if(t!==h){var s=this.ranks,i=this.roots,x=s[t],p=s[h];x<p?i[t]=h:p<x?i[h]=t:(i[h]=t,++s[t])}}},{}],310:[function(g,S,M){function e(r,t){for(var h=1,s=r.length,i=r[0],x=r[0],p=1;p<s;++p)if(x=i,i=r[p],t(i,x)){if(p===h){h++;continue}r[h++]=i}return r.length=h,r}function a(r){for(var t=1,h=r.length,s=r[0],i=r[0],x=1;x<h;++x,i=s)if(i=s,s=r[x],s!==i){if(x===t){t++;continue}r[t++]=s}return r.length=t,r}function n(r,t,h){return r.length===0?r:t?(h||r.sort(t),e(r,t)):(h||r.sort(),a(r))}S.exports=n},{}],311:[function(g,S,M){S.exports=r;var e=g("./lib/vtext"),a=null,n=null;typeof document<"u"&&(a=document.createElement("canvas"),a.width=8192,a.height=1024,n=a.getContext("2d"));function r(t,h){return(typeof h!="object"||h===null)&&(h={}),e(t,h.canvas||a,h.context||n,h)}},{"./lib/vtext":312}],312:[function(g,S,M){S.exports=T,S.exports.processPixels=L;var e=g("surface-nets"),a=g("ndarray"),n=g("simplify-planar-graph"),r=g("clean-pslg"),t=g("cdt2d"),h=g("planar-graph-to-polyline"),s="b",i="b|",x="i",p="i|",v="sup",f="+",d="+1",o="sub",m="-",l="-1";function w(k,P,z,I){for(var D="<"+k+">",R="</"+k+">",O=D.length,F=R.length,N=P[0]===f||P[0]===m,G=0,K=-F;G>-1&&(G=z.indexOf(D,G),!(G===-1||(K=z.indexOf(R,G+O),K===-1)||K<=G));){for(var W=G;W<K+F;++W)if(W<G+O||W>=K)I[W]=null,z=z.substr(0,W)+" "+z.substr(W+1);else if(I[W]!==null){var Y=I[W].indexOf(P[0]);Y===-1?I[W]+=P:N&&(I[W]=I[W].substr(0,Y+1)+(1+parseInt(I[W][Y+1]))+I[W].substr(Y+2))}var re=G+O,ue=z.substr(re,K-re),j=ue.indexOf(D);j!==-1?G=j:G=K+F}return I}function _(k,P,z){for(var I=P.textAlign||"start",D=P.textBaseline||"alphabetic",R=[1<<30,1<<30],O=[0,0],F=k.length,N=0;N<F;++N)for(var G=k[N],K=0;K<2;++K)R[K]=Math.min(R[K],G[K])|0,O[K]=Math.max(O[K],G[K])|0;var W=0;switch(I){case"center":W=-.5*(R[0]+O[0]);break;case"right":case"end":W=-O[0];break;case"left":case"start":W=-R[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+I+"'")}var Y=0;switch(D){case"hanging":case"top":Y=-R[1];break;case"middle":Y=-.5*(R[1]+O[1]);break;case"alphabetic":case"ideographic":Y=-3*z;break;case"bottom":Y=-O[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+D+"'")}var re=1/z;return"lineHeight"in P?re*=+P.lineHeight:"width"in P?re=P.width/(O[0]-R[0]):"height"in P&&(re=P.height/(O[1]-R[1])),k.map(function(ue){return[re*(ue[0]+W),re*(ue[1]+Y)]})}function c(k,P,z,I,D,R){z=z.replace(/\n/g,""),R.breaklines===!0?z=z.replace(/\<br\>/g,`
`):z=z.replace(/\<br\>/g," ");var O="",F=[];for(U=0;U<z.length;++U)F[U]=O;R.bolds===!0&&(F=w(s,i,z,F)),R.italics===!0&&(F=w(x,p,z,F)),R.superscripts===!0&&(F=w(v,d,z,F)),R.subscripts===!0&&(F=w(o,l,z,F));var N=[],G="";for(U=0;U<z.length;++U)F[U]!==null&&(G+=z[U],N.push(F[U]));var K=G.split(`
`),W=K.length,Y=Math.round(D*I),re=I,ue=I*2,j=0,q=W*Y+ue;k.height<q&&(k.height=q),P.fillStyle="#000",P.fillRect(0,0,k.width,k.height),P.fillStyle="#fff";var H,U,$,ne,X,Q=0,ie="";function se(){if(ie!==""){var Ee=P.measureText(ie).width;P.fillText(ie,re+$,ue+ne),$+=Ee}}function ae(){return""+Math.round(X)+"px "}function oe(Ee,Pe){var Ue=""+P.font;if(R.subscripts===!0){var we=Ee.indexOf(m),ke=Pe.indexOf(m),Xe=we>-1?parseInt(Ee[1+we]):0,Ve=ke>-1?parseInt(Pe[1+ke]):0;Xe!==Ve&&(Ue=Ue.replace(ae(),"?px "),X*=Math.pow(.75,Ve-Xe),Ue=Ue.replace("?px ",ae())),ne+=.25*Y*(Ve-Xe)}if(R.superscripts===!0){var Ie=Ee.indexOf(f),De=Pe.indexOf(f),Ye=Ie>-1?parseInt(Ee[1+Ie]):0,vt=De>-1?parseInt(Pe[1+De]):0;Ye!==vt&&(Ue=Ue.replace(ae(),"?px "),X*=Math.pow(.75,vt-Ye),Ue=Ue.replace("?px ",ae())),ne-=.25*Y*(vt-Ye)}if(R.bolds===!0){var Dt=Ee.indexOf(i)>-1,Kt=Pe.indexOf(i)>-1;!Dt&&Kt&&(Ft?Ue=Ue.replace("italic ","italic bold "):Ue="bold "+Ue),Dt&&!Kt&&(Ue=Ue.replace("bold ",""))}if(R.italics===!0){var Ft=Ee.indexOf(p)>-1,Mt=Pe.indexOf(p)>-1;!Ft&&Mt&&(Ue="italic "+Ue),Ft&&!Mt&&(Ue=Ue.replace("italic ",""))}P.font=Ue}for(H=0;H<W;++H){var be=K[H]+`
`;for($=0,ne=H*Y,X=I,ie="",U=0;U<be.length;++U){var ce=U+Q<N.length?N[U+Q]:N[N.length-1];O===ce?ie+=be[U]:(se(),ie=be[U],ce!==void 0&&(oe(O,ce),O=ce))}se(),Q+=be.length;var de=Math.round($+2*re)|0;j<de&&(j=de)}var ye=j,ge=ue+Y*W,me=a(P.getImageData(0,0,ye,ge).data,[ge,ye,4]);return me.pick(-1,-1,0).transpose(1,0)}function b(k,P){var z=e(k,128);return P?n(z.cells,z.positions,.25):{edges:z.cells,positions:z.positions}}function u(k,P,z,I){var D=b(k,I),R=_(D.positions,P,z),O=D.edges,F=P.orientation==="ccw";if(r(R,O),P.polygons||P.polygon||P.polyline){for(var N=h(O,R),G=new Array(N.length),K=0;K<N.length;++K){for(var W=N[K],Y=new Array(W.length),re=0;re<W.length;++re){for(var ue=W[re],j=new Array(ue.length),q=0;q<ue.length;++q)j[q]=R[ue[q]].slice();F&&j.reverse(),Y[re]=j}G[K]=Y}return G}else return P.triangles||P.triangulate||P.triangle?{cells:t(R,O,{delaunay:!1,exterior:!1,interior:!0}),positions:R}:{edges:O,positions:R}}function L(k,P,z){try{return u(k,P,z,!0)}catch{}try{return u(k,P,z,!1)}catch{}return P.polygons||P.polyline||P.polygon?[]:P.triangles||P.triangulate||P.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}function T(k,P,z,I){var D=64,R=1.25,O={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};I&&(I.size&&I.size>0&&(D=I.size),I.lineSpacing&&I.lineSpacing>0&&(R=I.lineSpacing),I.styletags&&I.styletags.breaklines&&(O.breaklines=!!I.styletags.breaklines),I.styletags&&I.styletags.bolds&&(O.bolds=!!I.styletags.bolds),I.styletags&&I.styletags.italics&&(O.italics=!!I.styletags.italics),I.styletags&&I.styletags.subscripts&&(O.subscripts=!!I.styletags.subscripts),I.styletags&&I.styletags.superscripts&&(O.superscripts=!!I.styletags.superscripts)),z.font=[I.fontStyle,I.fontVariant,I.fontWeight,D+"px",I.font].filter(function(N){return N}).join(" "),z.textAlign="start",z.textBaseline="alphabetic",z.direction="ltr";var F=c(P,z,k,D,R,O);return L(F,I,D)}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(g,S,M){(function(){if(typeof ses<"u"&&ses.ok&&!ses.ok())return;function a(L){L.permitHostObjects___&&L.permitHostObjects___(a)}typeof ses<"u"&&(ses.weakMapPermitHostObjects=a);var n=!1;if(typeof WeakMap=="function"){var r=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var t=new r,h=Object.freeze({});if(t.set(h,1),t.get(h)!==1)n=!0;else{S.exports=WeakMap;return}}}var s=Object.getOwnPropertyNames,i=Object.defineProperty,x=Object.isExtensible,p="weakmap:",v=p+"ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var f=new ArrayBuffer(25),d=new Uint8Array(f);crypto.getRandomValues(d),v=p+"rand:"+Array.prototype.map.call(d,function(L){return(L%36).toString(36)}).join("")+"___"}function o(L){return!(L.substr(0,p.length)==p&&L.substr(L.length-3)==="___")}if(i(Object,"getOwnPropertyNames",{value:function(T){return s(T).filter(o)}}),"getPropertyNames"in Object){var m=Object.getPropertyNames;i(Object,"getPropertyNames",{value:function(T){return m(T).filter(o)}})}function l(L){if(L!==Object(L))throw new TypeError("Not an object: "+L);var T=L[v];if(T&&T.key===L)return T;if(x(L)){T={key:L};try{return i(L,v,{value:T,writable:!1,enumerable:!1,configurable:!1}),T}catch{return}}}(function(){var L=Object.freeze;i(Object,"freeze",{value:function(z){return l(z),L(z)}});var T=Object.seal;i(Object,"seal",{value:function(z){return l(z),T(z)}});var k=Object.preventExtensions;i(Object,"preventExtensions",{value:function(z){return l(z),k(z)}})})();function w(L){return L.prototype=null,Object.freeze(L)}var _=!1;function c(){!_&&typeof console<"u"&&(_=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}var b=0,u=function(){this instanceof u||c();var L=[],T=[],k=b++;function P(R,O){var F,N=l(R);return N?k in N?N[k]:O:(F=L.indexOf(R),F>=0?T[F]:O)}function z(R){var O=l(R);return O?k in O:L.indexOf(R)>=0}function I(R,O){var F,N=l(R);return N?N[k]=O:(F=L.indexOf(R),F>=0?T[F]=O:(F=L.length,T[F]=O,L[F]=R)),this}function D(R){var O=l(R),F,N;return O?k in O&&delete O[k]:(F=L.indexOf(R),F<0?!1:(N=L.length-1,L[F]=void 0,T[F]=T[N],L[F]=L[N],L.length=N,T.length=N,!0))}return Object.create(u.prototype,{get___:{value:w(P)},has___:{value:w(z)},set___:{value:w(I)},delete___:{value:w(D)}})};u.prototype=Object.create(Object.prototype,{get:{value:function(T,k){return this.get___(T,k)},writable:!0,configurable:!0},has:{value:function(T){return this.has___(T)},writable:!0,configurable:!0},set:{value:function(T,k){return this.set___(T,k)},writable:!0,configurable:!0},delete:{value:function(T){return this.delete___(T)},writable:!0,configurable:!0}}),typeof r=="function"?function(){n&&typeof Proxy<"u"&&(Proxy=void 0);function L(){this instanceof u||c();var T=new r,k=void 0,P=!1;function z(O,F){return k?T.has(O)?T.get(O):k.get___(O,F):T.get(O,F)}function I(O){return T.has(O)||(k?k.has___(O):!1)}var D;n?D=function(O,F){return T.set(O,F),T.has(O)||(k||(k=new u),k.set(O,F)),this}:D=function(O,F){if(P)try{T.set(O,F)}catch{k||(k=new u),k.set___(O,F)}else T.set(O,F);return this};function R(O){var F=!!T.delete(O);return k&&k.delete___(O)||F}return Object.create(u.prototype,{get___:{value:w(z)},has___:{value:w(I)},set___:{value:w(D)},delete___:{value:w(R)},permitHostObjects___:{value:w(function(O){if(O===a)P=!0;else throw new Error("bogus call to permitHostObjects___")})}})}L.prototype=u.prototype,S.exports=L,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),S.exports=u)})()},{}],314:[function(g,S,M){var e=g("./hidden-store.js");S.exports=a;function a(){var n={};return function(r){if((typeof r!="object"||r===null)&&typeof r!="function")throw new Error("Weakmap-shim: Key must be object");var t=r.valueOf(n);return t&&t.identity===n?t:e(r,n)}}},{"./hidden-store.js":315}],315:[function(g,S,M){S.exports=e;function e(a,n){var r={identity:n},t=a.valueOf;return Object.defineProperty(a,"valueOf",{value:function(h){return h!==n?t.apply(this,arguments):r},writable:!0}),r}},{}],316:[function(g,S,M){var e=g("./create-store.js");S.exports=a;function a(){var n=e();return{get:function(r,t){var h=n(r);return h.hasOwnProperty("value")?h.value:t},set:function(r,t){return n(r).value=t,this},has:function(r){return"value"in n(r)},delete:function(r){return delete n(r).value}}}},{"./create-store.js":314}],317:[function(g,S,M){function e(){return function(s,i,x,p,v,f){var d=s[0],o=x[0],m=[0],l=o;p|=0;var w=0,_=o;for(w=0;w<d;++w){{var c=i[p]-f,b=i[p+l]-f;c>=0!=b>=0&&v.push(m[0]+.5+.5*(c+b)/(c-b))}p+=_,++m[0]}}}function a(){return e()}var n=a;function r(s){var i={};return function(p,v,f){var d=p.dtype,o=p.order,m=[d,o.join()].join(),l=i[m];return l||(i[m]=l=s([d,o])),l(p.shape.slice(0),p.data,p.stride,p.offset|0,v,f)}}function t(s){return r(n.bind(void 0,s))}function h(s){return t({funcName:s.funcName})}S.exports=h({funcName:"zeroCrossings"})},{}],318:[function(g,S,M){S.exports=a;var e=g("./lib/zc-core");function a(n,r){var t=[];return r=+r||0,e(n.hi(n.shape[0]-1),t,r),t}},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof Ao<"u"?Ao:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)})})(V0);(function(no){Object.defineProperty(no,"__esModule",{value:!0}),no.default=void 0;var rl=ee(Vv),y=ee(kh);function ee(g){return g&&g.__esModule?g:{default:g}}var te=(0,rl.default)(y.default),A=te;no.default=A})(Hv);const Y0=F0(Hv);export{Y0 as P,jc as c,Sh as p};
