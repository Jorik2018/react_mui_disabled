import{s as v,r as x,i as B,l as L,m as Y,k as U,n as G,j as e,o as J,B as b,C as S,q as T}from"./index-98cf31d0.js";import{T as o,t as w,a as f,d as K,b as Q,A as V,c as X,e as Z,f as ee,g as te,h as se}from"./Edit-0166362f.js";import{T as ae}from"./TableContainer-77b3fa50.js";import{F as ie,T as h}from"./TextField-4e8958de.js";import"./MenuItem-21f050f2.js";import"./createSvgIcon-0e2d6dd8.js";const r=v(o)(({theme:g})=>({[`&.${w.head}`]:{backgroundColor:g.palette.common.black,textAlign:"center",color:g.palette.common.white},[`&.${w.body}`]:{fontSize:14},"& > span":{display:"table-cell",verticalAlign:"middle",height:70,width:1e3},"& .MuiFormControl-root":{padding:0,marginTop:"5px !important"}})),ne=v(f)(({theme:g})=>({"&:nth-of-type(odd)":{backgroundColor:g.palette.action.hover},"&:last-child td, &:last-child th":{border:0}})),ge=()=>{const g=x.useRef(),j=B(),y=L(),[c,C]=x.useState({page:0,rowsPerPage:50}),[l,R]=x.useState({size:0,data:[]}),[n,m]=x.useState([]),D=t=>n.indexOf(t)!==-1,W=Y(t=>t.networkStatus),q=t=>{if(t.target.checked){const s=l.data.map(a=>p(a));m(s);return}m([])},z=(t,s)=>{const a=n.indexOf(s);console.log(t);let i=[];a===-1?i=i.concat(n,s):a===0?i=i.concat(n.slice(1)):a===n.length-1?i=i.concat(n.slice(0,-1)):a>0&&(i=i.concat(n.slice(0,a),n.slice(a+1))),m(i)},F=(t,s)=>{console.log(t),C({...c,page:s})},I=t=>{C({...c,rowsPerPage:t.target.value})},k=()=>{m([]),P(c.page)},P=async t=>{var s={data:[]};if(W.connected){const a=await T.get("/api/minsa/disabled-quiz/"+t+"/"+c.rowsPerPage+"?"+new URLSearchParams(N).toString());s.size=a.size,s.data=s.data.concat(a.data)}R(s)};U(({height:t,width:s})=>{const a=document.querySelector(".MuiToolbar-root"),i=document.querySelector(".MuiTableContainer-root"),u=document.querySelector("nav"),O=document.querySelector(".Toolbar-table"),$=document.querySelector(".MuiTablePagination-root");i&&(i.style.width=s-u.offsetWidth+"px",i.style.height=t-a.offsetHeight-O.offsetHeight-$.offsetHeight+"px")},g),x.useEffect(()=>{j({type:"title",title:"Registro Discapacidad"}),P(c.page)},[c.page,c.rowsPerPage]);const[N,{defaultProps:d}]=G(x.useState,{}),_=()=>{y("/register/create")},E=()=>{y("/register/"+n[0]+"/edit")},H=()=>{j({type:"confirm",msg:"Esta seguro de eliminar el registro seleccionado?",cb:t=>{t&&T.delete("/api/minsa/disabled-quiz/"+n.join(",")).then(s=>{console.log(s),j({type:"snack",msg:"Registro"+(n.length>1?"s":"")+" eliminado!"}),k()})}})};function A(t){var s=new Date,a=new Date(t),i=s.getFullYear()-a.getFullYear(),u=s.getMonth()-a.getMonth();return(u<0||u===0&&s.getDate()<a.getDate())&&i--,i}const p=t=>t._id&&t._id.$oid?t._id.$oid:t.id,M=l.data&&l.data.length;return e.jsxs(e.Fragment,{children:[e.jsxs(J,{className:"Toolbar-table",children:[e.jsx(b,{disabled:!n.length,startIcon:e.jsx(K,{}),onClick:E,children:"Editar"}),e.jsx(b,{disabled:!n.length,startIcon:e.jsx(Q,{}),onClick:H,children:"Eliminar"}),e.jsx(b,{onClick:k,endIcon:e.jsx(V,{})})]}),e.jsxs(ae,{sx:{maxHeight:"100%"},ref:g,children:[e.jsx(ie,{color:"primary","aria-label":"add",onClick:_,style:{position:"absolute",bottom:72,right:24},children:e.jsx(X,{})}),e.jsxs(Z,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(ee,{children:e.jsxs(f,{children:[e.jsx(r,{padding:"checkbox",children:e.jsx(S,{style:{color:"white"},indeterminate:n.length>0&&n.length<l.data.length,checked:l&&l.data.length>0&&n.length===l.data.length,onChange:q,inputProps:{"aria-label":"select all desserts"}})}),e.jsxs(r,{style:{minWidth:80},children:[e.jsx("span",{children:"DNI"}),e.jsx(h,{...d("code")})]}),e.jsxs(r,{style:{minWidth:260},children:[e.jsx("span",{children:"Nombre Completo"}),e.jsx(h,{...d("fullName")})]}),e.jsxs(r,{style:{minWidth:80},children:[e.jsx("span",{children:"Edad"}),e.jsx(h,{...d("age")})]}),e.jsxs(r,{style:{minWidth:260},children:[e.jsx("span",{children:"DirecciÃ³n"}),e.jsx(h,{...d("address")})]}),e.jsxs(r,{style:{minWidth:100},children:[e.jsx("span",{children:"Telefono"}),e.jsx(h,{...d("mainPhone")})]}),e.jsxs(r,{style:{minWidth:130},children:[e.jsx("span",{children:"Cuenta con certificado de discapacidad?"}),e.jsx(h,{...d("disability_certificate")})]}),e.jsxs(r,{style:{minWidth:260},children:[e.jsx("span",{children:"Provincia"}),e.jsx(h,{...d("province")})]}),e.jsxs(r,{style:{minWidth:260},children:[e.jsx("span",{children:"Distrito"}),e.jsx(h,{...d("district")})]})]})}),e.jsxs(te,{children:[(l&&l.data&&l.data.length?l.data:[]).map((t,s)=>{const a=D(p(t));return e.jsxs(ne,{style:{backgroundColor:""},hover:!0,onClick:i=>z(i,p(t)),role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,children:[e.jsx(o,{padding:"checkbox",children:e.jsx(S,{color:"primary",checked:a})}),e.jsx(o,{style:{width:80},align:"center",children:t.code}),e.jsxs(o,{style:{width:260},children:[t.surnames," ",t.names]}),e.jsx(o,{style:{width:80},align:"center",children:A(t.birthdate)}),e.jsx(o,{style:{width:260},children:t.address}),e.jsx(o,{style:{width:100},children:t.mainPhone}),e.jsx(o,{style:{width:30},align:"center",children:t.disability_certificate}),e.jsx(o,{style:{width:260},children:t.provinceName}),e.jsxs(o,{style:{width:260},children:[t.district,": ",t.districtName]})]},s+" "+p(t))}),!M&&e.jsx(f,{style:{height:53},children:e.jsx(o,{colSpan:7,children:"No data"})})]})]})]}),e.jsx(se,{rowsPerPageOptions:[10,20,50],component:"div",count:l.size,rowsPerPage:c.rowsPerPage,page:c.page,onPageChange:F,onRowsPerPageChange:I})]})};export{ge as default};
