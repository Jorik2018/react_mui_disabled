import{s as R,i as H,l as W,r,m as B,k as L,n as M,j as e,o as U,B as u,C as S,p as G,q as T}from"./index-98cf31d0.js";import{T as d,t as w,a as f,d as J,b as K,A as Q,c as V,e as X,f as Y,g as Z,h as ee}from"./Edit-0166362f.js";import{d as te}from"./dayjs.min-423e3b9e.js";import{T as ae}from"./TableContainer-77b3fa50.js";import{F as se,T as b}from"./TextField-4e8958de.js";import"./MenuItem-21f050f2.js";import"./createSvgIcon-0e2d6dd8.js";const g=R(d)(({theme:c})=>({[`&.${w.head}`]:{backgroundColor:c.palette.common.black,textAlign:"center",color:c.palette.common.white},[`&.${w.body}`]:{fontSize:14}})),ne=R(f)(({theme:c})=>({"&:nth-of-type(odd)":{backgroundColor:c.palette.action.hover},"&:last-child td, &:last-child th":{border:0}})),ge=()=>{const c=H(),y=W(),[o,j]=r.useState({page:0,rowsPerPage:50}),[l,v]=r.useState({size:0,data:[]}),[n,p]=r.useState([]),E=t=>n.indexOf(t)!==-1,k=r.useRef(),z=B(t=>t.networkStatus),I=t=>{if(t.target.checked){const i=l.data.map(a=>x(a));p(i);return}p([])},_=(t,i)=>{console.log(t);const a=n.indexOf(i);let s=[];a===-1?s=s.concat(n,i):a===0?s=s.concat(n.slice(1)):a===n.length-1?s=s.concat(n.slice(0,-1)):a>0&&(s=s.concat(n.slice(0,a),n.slice(a+1))),p(s)},D=l.data&&l.data.length,$=(t,i)=>{console.log(t),j({...o,page:i})},q=t=>{j({...o,rowsPerPage:t.target.value})},C=()=>{p([]),P(o.page)},P=async t=>{var i=await G.disabled.toArray(),a={data:i||[]};if(z.connected){const s=await T.get("/api/minsa/disabled-quiz/"+t+"/"+o.rowsPerPage+"?"+new URLSearchParams(N).toString());a.size=s.size,a.data=a.data.concat(s.data),a.data.forEach(h=>{h.birthdate&&(h.age=-te(h.birthdate).diff(new Date,"year"))})}v(a)};L(({height:t,width:i})=>{const a=document.querySelector(".MuiTableContainer-root"),s=document.querySelector(".Toolbar-table"),h=document.querySelector(".MuiTablePagination-root");a&&(s.style.width=i+"px",a.style.width=i+"px",a.style.height=t-s.offsetHeight-h.offsetHeight+"px")},k),r.useEffect(()=>{c({type:"title",title:"EvaluaciÃ³n Discapacidad"}),P(o.page)},[o.page,o.rowsPerPage]);const[N,{defaultProps:m}]=M(r.useState,{}),O=()=>{y("/create")},A=()=>{y("/"+n[0]+"/edit")},F=()=>{c({type:"confirm",msg:"Esta seguro de eliminar el registro seleccionado?",cb:t=>{t&&T.delete("/api/minsa/disabled-quiz/"+n.join(",")).then(()=>{c({type:"snack",msg:"Registro"+(n.length>1?"s":"")+" eliminado!"}),C()})}})},x=t=>t._id&&t._id.$oid?t._id.$oid:t.id;return e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"Toolbar-table",children:e.jsxs("div",{style:{float:"none",marginLeft:"auto",marginRight:"auto"},children:[e.jsx(u,{disabled:!n.length,startIcon:e.jsx(J,{}),onClick:A,children:"Editar"}),e.jsx(u,{disabled:!n.length,startIcon:e.jsx(K,{}),onClick:F,children:"Eliminar"}),e.jsx(u,{onClick:C,endIcon:e.jsx(Q,{})})]})}),e.jsxs(ae,{sx:{maxHeight:"100%"},ref:k,children:[e.jsx(se,{color:"primary","aria-label":"add",onClick:O,style:{position:"absolute",bottom:72,right:24},children:e.jsx(V,{})}),e.jsxs(X,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(Y,{children:e.jsxs(f,{children:[e.jsx(g,{padding:"checkbox",children:e.jsx(S,{style:{color:"white"},indeterminate:n.length>0&&n.length<l.data.length,checked:l&&l.data.length>0&&n.length===l.data.length,onChange:I,inputProps:{"aria-label":"select all desserts"}})}),e.jsxs(g,{style:{minWidth:80},children:["DNI",e.jsx(b,{...m("code"),style:{padding:0,marginTop:"5px !important"}})]}),e.jsxs(g,{style:{minWidth:260},children:["Nombre Completo",e.jsx(b,{...m("fullName"),style:{padding:0,marginTop:"5px !important"}})]}),e.jsxs(g,{style:{minWidth:80},children:["Edad",e.jsx(b,{...m("age"),style:{padding:0,marginTop:"5px !important"}})]}),e.jsxs(g,{style:{minWidth:260},children:["Direccion",e.jsx(b,{...m("address"),style:{padding:0,marginTop:"5px !important"}})]})]})}),e.jsxs(Z,{children:[(l&&l.data&&l.data.length?l.data:[]).map((t,i)=>{const a=E(x(t));return e.jsxs(ne,{style:{backgroundColor:t._id&&t._id.$oid?"":i%2===0?"#f1f19c":"#ffffbb"},hover:!0,onClick:s=>_(s,x(t)),role:"checkbox","aria-checked":a,tabIndex:-1,selected:a,children:[e.jsx(d,{padding:"checkbox",children:e.jsx(S,{color:"primary",checked:a})}),e.jsx(d,{style:{width:80},align:"center",children:t.code}),e.jsxs(d,{style:{width:260},children:[t.surnames," ",t.names]}),e.jsx(d,{style:{width:80},align:"center",children:t.age}),e.jsx(d,{style:{width:260},children:t.address})]},i+" "+x(t))}),!D&&e.jsx(f,{style:{height:53},children:e.jsx(d,{colSpan:5,children:"No data"})})]})]})]}),e.jsx(ee,{rowsPerPageOptions:[10,20,50],component:"div",count:l.size,rowsPerPage:o.rowsPerPage,page:o.page,onPageChange:$,onRowsPerPageChange:q})]})};export{ge as default};
