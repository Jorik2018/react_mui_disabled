import{i as U,m as K,v as Q,r as n,l as X,n as g,p as Z,q as v,k as $,z as ee,j as e,x as S,D as re,I as te,A as y,C as ae,y as se,B as A}from"./index-98cf31d0.js";import{F as I,a as p,V as C,R as x}from"./useToken-eab832c7.js";import{L as ie,A as ne,M as oe}from"./index-01fdcdf3.js";import{A as ce,a as le}from"./AccordionDetails-b2f633b0.js";import{A as de}from"./AccordionSummary-b7f1a4a9.js";import{T as s,F as ue}from"./TextField-4e8958de.js";import{I as pe,S as me}from"./InputAdornment-867b3a31.js";import{M as o}from"./MenuItem-21f050f2.js";import{S as xe,a as he}from"./Stack-ad058a13.js";import"./dayjs.min-423e3b9e.js";const Re=()=>{const m=U(),j=K(r=>r.networkStatus),{pid:l}=Q(),d=n.createRef(),u=X(),[E,D]=n.useState([]),[R,P]=n.useState([]),[k,O]=n.useState([]);n.useState(null);const[_,N]=n.useState([]),[F,T]=n.useState([]),[i,{defaultProps:a,handleChange:M,bindEvents:je,validate:L,set:h}]=g(n.useState,{houseAccess:"",instructionGrade:"",maritalStatus:"",typeInsurance:"",belongsAssociation:"",carerRequired:""}),[f,fe]=g(n.useState,{});n.useState(!0),n.useEffect(()=>{m({type:"title",title:(l?"Editar":"Registrar")+" Registro"}),[["red",N],["microred",T],["region",D],["province",P],["district",O]].forEach(async r=>{r[1](await Z[r[0]].toArray())})},[]),n.useEffect(()=>{if(l)j.connected&&v.get("/api/minsa/disabled-quiz/"+l).then(c=>{h(c)});else try{var r=localStorage.getItem("setting");if(r){r=JSON.parse(r);var t={};t.red=r.red,t.microred=r.microred,t.region=r.region,t.province=r.province,t.district=r.district,t.establishment=r.establishment,h({...i,...t})}}catch(c){console.log(c)}},[l]),$(({width:r,height:t})=>{if(d.current){const[c,b]=d.current.children,H=document.querySelector("nav");c.style.height=t-b.offsetHeight+"px",c.style.width=r+"px",b.style.width=r-H.offsetWidth+"px"}},d);const q=()=>{u(-1)},w=()=>{},B=async()=>{u("/register/create",{replace:!0})};function G(r){var t=i.age;r&&(t=-r.diff(new Date,"year")),h(c=>({...c,birthdate:r,age:t}),()=>{console.log("after set")})}const z=async()=>{const r=d.current;if(r!=null&&L(r)){var t=JSON.parse(JSON.stringify(i));j.connected?v.post("/api/minsa/disabled-quiz/",t).then(async c=>{m({type:"snack",msg:"Registro grabado!"}),t._id||(console.log(t),c.id?u("/register/"+c.id+"/edit",{replace:!0}):u(-1))}):(t.id||(t.tmpId=1*new Date,t.id=-t.tmpId,u("/"+t.id+"/edit",{replace:!0})),m({type:"snack",msg:"Registro grabado!"}))}else m({type:"alert",msg:"Falta campos por completar!"})},V=r=>console.log(r),W=ee({components:{MuiInput:{defaultProps:{required:!0}}}});function Y(){return e.jsxs(e.Fragment,{children:[e.jsx(A,{onClick:q,color:"primary",children:"Cancelar"}),e.jsx(A,{disabled:i.old&&!i.confirm,onClick:z,color:"primary",endIcon:e.jsx(he,{}),children:"Grabar"})]})}function J(){return e.jsx(ie,{dateAdapter:ne,children:e.jsx(re,{theme:W,children:e.jsxs("form",{ref:d,onSubmit:V,style:{textAlign:"left"},children:[e.jsx(S,{style:{overflow:"auto"},children:e.jsxs(ce,{expanded:!0,children:[e.jsx(de,{component:"div",children:"DATOS DE IDENTIFICACION"}),e.jsxs(le,{children:[e.jsx(s,{type:"number",label:"DNI",inputProps:{maxLength:8,style:{textAlign:"center"}},...a("code",{InputProps:{endAdornment:e.jsx(pe,{position:"end",children:e.jsx(te,{"aria-label":"Obtener Coordenadas",onClick:w,color:"primary",children:e.jsx(me,{})})})},onBlur:()=>{!l&&i.code&&i.search!=i.code}})}),f.id&&e.jsxs(y,{severity:"success",children:["Esta persona tiene certificado de discapacidad con codigo ",e.jsx("b",{children:f.id}),".",e.jsx(I,{})]}),i.old&&e.jsxs(y,{severity:"warning",children:["Esta persona ya se encuentra registrada, desea confirmar cambiar el registro con los datos actuales?.",e.jsx(I,{children:e.jsx(p,{control:e.jsx(ae,{name:"confirm",checked:i.confirm??!1,onChange:M}),label:"Confirmar"})})]}),e.jsx(s,{label:"Nombres",...a("names"),inputProps:{maxLength:"50"}}),e.jsx(s,{label:"Apellidos",...a("surnames"),inputProps:{maxLength:"50"}}),e.jsx(oe,{inputFormat:"DD/MM/YYYY",label:"Fecha Nacimiento",value:i.birthdate||"",onChange:G,renderInput:r=>e.jsx(s,{...r})}),e.jsx(s,{multiline:!0,label:"Dirección",...a("address"),inputProps:{maxLength:250}}),e.jsx(s,{select:!0,label:"Región",...a("region"),children:E.map((r,t)=>e.jsx(o,{value:r.code,children:r.name},"region_"+t))}),i.region!=null&&e.jsx(s,{select:!0,label:"Provincia",...a("province"),children:R.filter(r=>r.code.startsWith(i.region)).map((r,t)=>e.jsx(o,{value:r.code,children:r.name},"province_"+t))}),i.province!=null&&e.jsx(s,{select:!0,label:"Distrito",...a("district"),children:k.filter(r=>r.code.startsWith(i.province)).map((r,t)=>e.jsx(o,{value:r.code,children:r.name},"district_"+t))}),e.jsx(s,{select:!0,label:"Red",...a("red"),children:_.map((r,t)=>e.jsx(o,{value:r.code,children:r.name},"red_"+t))}),i.red!=null&&e.jsx(s,{select:!0,label:"Microred",...a("microred"),children:F.filter(r=>r.code.startsWith(i.red)).map((r,t)=>e.jsx(o,{value:r.code,children:r.name},"microred_"+t))}),e.jsx(s,{select:!0,label:"Acceso a la vivienda",...a("houseAccess"),children:["Facil","Accidentado","Otro"].map((r,t)=>e.jsx(o,{value:r,children:r},"houseAccess_"+t))}),e.jsx(s,{...a("occupation"),label:"Ocupación"}),e.jsx(s,{select:!0,...a("instructionGrade"),label:"Grado de Instrucción",children:["Inicial","Primaria","Secundaria","Técnico","Superior","PRITE","CEBE","CEBA","Educación Inclusiva","Analfabeto","Otro"].map((r,t)=>e.jsx(o,{value:r,children:r},"instructionGrade_"+t))}),e.jsx(s,{select:!0,...a("maritalStatus"),label:"Estado Civil",children:["Soltero/a","Casado/a","Divorciado/a","Conviviente","Viudo/a"].map((r,t)=>e.jsx(o,{value:r,children:r},"maritalStatus_"+t))}),e.jsx(s,{select:!0,...a("typeInsurance"),label:"Tipo de Seguro",children:["SIS","ESSALUD","Otro","No tiene"].map((r,t)=>e.jsx(o,{value:r,children:r},"typeInsurance_"+t))}),e.jsx(s,{...a("medicalReport"),label:"Informe Medico",multiline:!0}),e.jsxs(C,{...a("disability_certificate"),label:"¿Tiene certificado de discapacidad?",children:[e.jsx(p,{value:"SI",control:e.jsx(x,{}),label:"SI"}),e.jsx(p,{value:"NO",control:e.jsx(x,{}),label:"NO"})]}),i.disability_certificate==="SI"&&e.jsx(s,{...a("nro_certificate"),label:"Numero certificado"}),e.jsx(s,{select:!0,...a("belongsAssociation"),label:"Pertenece a alguna asociación",children:["SI","NO"].map((r,t)=>e.jsx(o,{value:r,children:r},"belongsAssociation_"+t))}),i.belongsAssociation==="SI"&&e.jsx(s,{...a("association"),label:"Especifique cuál asociación",multiline:!0}),e.jsx(s,{...a("mainPhone"),label:"Teléfono fijo / Celular"}),e.jsx(s,{...a("otherPhone"),label:"Teléfono fijo / Celular"}),e.jsxs(C,{...a("carerRequired"),label:"¿Requiere cuidador?",children:[e.jsx(p,{value:"SI",control:e.jsx(x,{}),label:"SI"}),e.jsx(p,{value:"NO",control:e.jsx(x,{}),label:"NO"})]}),i.carerRequired==="SI"&&e.jsxs(e.Fragment,{children:[e.jsx(s,{...a("carer"),label:"Nombre de la persona cuidadora"}),e.jsx(s,{...a("carerPhone"),label:"Teléfono de la persona cuidadora"}),e.jsx(s,{...a("carerMail"),label:"Correo Electrónico"})]}),e.jsx(s,{select:!0,...a("type"),label:"Tipo discapacidad",children:["ALTA","MODERADA","LEVE"].map((r,t)=>e.jsx(o,{value:r,children:r},"severity_"+t))}),e.jsx(s,{...a("other_type"),label:"Otro tipo",multiline:!0}),e.jsx(s,{select:!0,...a("severity"),label:"Severidad",children:["ALTA","MODERADA","LEVE"].map((r,t)=>e.jsx(o,{value:r,children:r},"severity_"+t))}),e.jsx(s,{...a("devices"),label:"Dispositivos requeridos",multiline:!0})]})]})}),e.jsx(xe,{direction:"row",justifyContent:"center",style:{padding:"10px",backgroundColor:"#1976d2"},alignItems:"center",spacing:1,children:Y()}),(i._id||i.id)&&e.jsx(ue,{color:"primary","aria-label":"add",onClick:B,style:{position:"absolute",bottom:80,right:24},children:e.jsx(se,{})})]})})})}return e.jsx(e.Fragment,{children:e.jsx(S,{style:{textAlign:"left"},children:J()})})};export{Re as Form};
